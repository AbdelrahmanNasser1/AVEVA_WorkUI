function BoxObject(){this.x=0;this.y=0;this.width=0;this.height=0}function Selection(a,b){this._document=a;this._selection=b;this.toString=function(){return this._selection.toString()};this.collapse=function(){return this._selection.collapse()};this.collapseToEnd=function(){return this._selection.collapseToEnd()};this.collapseToStart=function(){return this._selection.collapseToStart()};this.empty=function(){return this._selection.empty()};this.setBaseAndExtent=function(c,d,e,f){return this._selection.setBaseAndExtent(c,d,e,f)};this.setPosition=function(c,d){return this._selection.setPosition(c,d)};this.modify=function(c,d,e){return this._selection.modify(c,d,e)};this.getRangeAt=function(c){return this._selection.getRangeAt(c)};this.createRange=function(){return this._document.createRange()}}var OperaEngine={Emulate:function(){OperaEngine._EmulateDocumentModel();OperaEngine._EmulateHTMLElement();OperaEngine._EmulateSelection();OperaEngine._EmulateStyles();OperaEngine._EmulateFocusManager();OperaEngine._EmulateXmlDocument();OperaEngine._EmulateStyleSheet()},_EmulateDocumentModel:function(){var a=HTMLDocument.prototype;a.getBoxObjectFor=function(c){var b=new BoxObject();b.x=ISPosLib.getLeft(c);b.y=ISPosLib.getTop(c);b.width=ISPosLib.getWidth(c);b.height=ISPosLib.getHeight(c);return b};a.__defineGetter__("selection",function(){var b=window.getSelection();return new Selection(window.document,b)})},_EmulateHTMLElement:function(){var a=HTMLElement.prototype;a.__defineGetter__("innerTextEx",function(){var b=this.innerText;if(b!=""){return b}else{if(this.textContent){return this.textContent}}return b});a=HTMLInputElement.prototype;a.createTextRange=function(){var b;if(this.tagName=="INPUT"){b=document.createRange();b.setStart(this,0);b.setEnd(this,0)}return b}},_EmulateSelection:function(){var a=Selection.prototype},_EmulateRange:function(){var a=Range.prototype;a.moveStart=function(c,b){if(b==null||isNaN(b)){return}}},_EmulateStyles:function(){},_EmulateXmlDocument:function(){var a=XMLDocument.prototype;a._readyState=4;a._fp=null;a.load=function(c){this.readyState=0;if(!this._xml){this._xml=new XMLHttpRequest()}this._xml.abort();this._xml.open("GET",c,false);this._xml.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var b=this;this._xml.onreadystatechange=function(){OperaEngine._OnXmlReadyStateChange(b)};this._xml.send("")};a.__defineSetter__("onreadystatechange",function(b){this._fp=b});a.__defineGetter__("onreadystatechange",function(){return this._fp});a.__defineGetter__("XMLDocument",function(){return this});a.removeNode=function(b){var c=this.XMLDocument;while(c.childNodes.length>0){c.removeChild(c.childNodes[0])}}},_OnXmlReadyStateChange:function(a){if(a._xml.readyState==4){a.loadXML(a._xml.responseXML.xml)}a.readyState=a._xml.readyState;if(a.onreadystatechange!=null){a.onreadystatechange()}},_EmulateFocusManager:function(){document.body.attachEvent("focus",OperaEngine._OnFocus,true);document.body.attachEvent("mousedown",OperaEngine._OnMouseDown)},_OnFocus:function(){if(document.focusChanging){return}OperaEngine._ChangeFocus(event.srcElement)},_OnMouseDown:function(){OperaEngine._ChangeFocus(event.srcElement)},_ChangeFocus:function(h){var d=document.focusedElement;var b=h;var a=null;var e=false;if(b!=null&&b!=d){var g=b.tagName.toLowerCase();switch(g){case"input":case"select":case"textarea":case"button":a=b;break}if(a==null&&b.getAttribute("focusable")=="true"){a=b;e=true}else{if(a==null){a=OperaEngine._GetFocusableParent(b);e=true}}}if(a!=null){if(d!=null){if(d.contains(a)){a=null}if(a!=null){var c=document.createEvent("HTMLEvents");c.initEvent("blur",true,true);d.dispatchEvent(c)}}if(a!=null){document.focusedElement=a;if(e){var c=document.createEvent("HTMLEvents");c.initEvent("focus",true,true);document.focusChanging=true;a.dispatchEvent(c);document.focusChanging=false}}}},_GetFocusableParent:function(a){while(a!=null&&a.tagName!="BODY"&&typeof(a.getAttribute)=="function"){if(a.getAttribute("focusable")=="true"){return a}a=a.parentElement}return null},_EmulateStyleSheet:function(){var a=HTMLStyleElement.prototype;a.addRule=function(b,d){var c=this.sheet;c.insertRule(b+" { "+d+" } ",0)}},Escape:function(a){if(a!=null&&typeof(a)!="undefined"){a=a.replace(new RegExp("\\\\2n","g"),"-");a=a.replace(new RegExp("\\\\5p","g"),"_");return a}return""}};OperaEngine.Emulate();if(typeof(Sys)!="undefined"){Sys.Application.notifyScriptLoaded()};