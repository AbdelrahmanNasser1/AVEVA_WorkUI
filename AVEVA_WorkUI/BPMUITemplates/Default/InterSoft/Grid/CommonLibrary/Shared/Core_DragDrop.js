function ISDragableObject(){this.Element=null;this.OffsetElement=null;this.GrabX=0;this.GrabY=0;this.AdjustTop=0;this.Enabled=true;this.OnDragStart="";this.OnDragEnd="";this.OnShadowCreate="";this.TransparentShadow=false;this.SimpleIndicator=false;this.HideOnDrop=false;this.ShadowElement=null;this.IsDragged=false;this.AllowCrossFrame=false;this.TopLevelDragDrop=false;this.TopLevelDragDropHandled=false;this.SpecificCoord=null;this.Owner=null;this.MoveCount=0}function ISDropableObject(a,e,b,c,d){this.Element=null;this.Coord=null;this.Enabled=true;this.OnDragOver="";this.OnDragDrop="";this.OnDragEnter="";this.OnDragLeave="";this.SubObjects=null;this._SubObjects=null;this.IsSubObject=false;this.ParentObject=null;this.OverTimeoutID=0;this.IsTooltipShown=false;this.Owner=null;this.SubObjectContext=null;this.EnableCaching=true;if(a){this.Element=a}if(e){this.OnDragOver=e}if(b){this.OnDragDrop=b}if(c){this.OnDragEnter=c}if(d){this.OnDragLeave=d}this.SetSubObjects=function(f){ISDragDrop.SetSubObjects(this,f)}}function ISDragEventArgs(){this.DragObject=null;this.AllowedEffects=0;this.Data=null;this.Effect=0;this.EffectText="";this.KeyState=0;this.X=0;this.Y=0;this.CursorX=0;this.CursorY=0;this.IsInTargetFrame=false;this.SourceFrame=null;this.SourceChildFrame=null;this.TargetFrame=null;this.TargetFrameCoord=null;this.TargetFrameDrop=null;this.ShiftedTop=0;this.GetDataPresent=function(c,a){var b=true;if(typeof(a)=="string"){b=(this.Data.GetType()==a)}if(typeof(this.Data)==c&&b){return true}return false}}var ISDragDropEffects={None:0,All:1,Copy:4,Link:16,Move:64,NotAllowed:256,Scroll:1024,Remove:4096};var ISKeyState={Ctrl:8,Alt:32,Shift:4};function CustomDropInterfaceBase(a){this.Type="";this.Owner=a;this.Properties=a.AdvancedProperties;this.OnInitialize=function(){};this.AddDropControl=function(b){};this.RemoveDropControl=function(){};this.OnDragEnter=function(c,b){};this.OnDragOver=function(c,b){};this.OnDragDrop=function(c,b){};this.OnDragLeave=function(b){}}function CustomSubDropInterfaceBase(a){this.Element=a;this.GetElement=function(){return this.Element}}function ComplexControlDropInterface(a){CustomDropInterfaceBase.call(this,a);this.LastDrop=null;this.OnDragEnter=function(c,b){if(b.IsSubObject){if(this.LastDrop!=null&&this.LastDrop!=b){this.OnDragLeave(this.LastDrop)}this.LastDrop=b}};this.OnDragOver=function(c,b){if(!b.IsSubObject){if(this.LastDrop!=null){this.OnDragLeave(this.LastDrop);this.LastDrop=null}c.Effect=ISDragDropEffects.NotAllowed}else{ISDragDropEngine.CommonDragEnter(c,b);if(b!=this.LastDrop){this.OnDragEnter(c,b)}else{this.OnDragQuery(c,b)}}};this.OnDragLeave=function(b){if(b.IsSubObject){ISDragDropEngine.ClearTooltip(b);this.OnDragLeaveInternal(b)}else{if(this.LastDrop!=null){this.OnDragLeave(this.LastDrop);this.LastDrop=null}}};this.OnDragDrop=function(c,b){if(b.IsSubObject){if(this.LastDrop!=null){this.OnDragLeave(this.LastDrop);this.LastDrop=null}}};this.OnDragLeaveInternal=function(b){}}var ISDragDropEngine={Object:null,IsMouseDown:false,Event:null,DragData:null,Dropables:new Array(),SuspendedDropables:new Array(),DropObject:null,LastDropObject:null,Count:0,CursorElement:null,TooltipElement:null,UseCssFramework:false,Initialize:function(){var a=document.body;Listener.Add(a,"onmousemove",ISDragDropEngine.OnMouseMove);Listener.Add(a,"onmousedown",ISDragDropEngine.OnMouseDown);Listener.Add(a,"onmouseup",ISDragDropEngine.OnMouseUp);if(IS.RuntimeObjects.length>0){if(IS.RuntimeObjects[0].UseCssFramework){ISDragDropEngine.UseCssFramework=true}}},Dispose:function(){Listener.Unload(document.body);ISDragDropEngine.Object=null;ISDragDropEngine.Event=null;window.detachEvent("onload",ISDragDropEngine.Initialize);window.detachEvent("onunload",ISDragDropEngine.Dispose)},OnMouseMove:function(){if(ISDragDropEngine.IsMouseDown&&ISDragDropEngine.Object!=null){var obj=ISDragDropEngine.Object;if(obj.Enabled){var dragData=ISDragDropEngine.DragData;if(obj.TopLevelDragDrop){dragData.SourceChildFrame=window;ISDragDropFrameEngine.DelegateDragDrop(obj,dragData);return}else{if(obj.TopLevelDragDropHandled&&window==dragData.SourceChildFrame){ISDragDropFrameEngine.DelegateDragDrop(obj,dragData);return}}var evnt=(ISDragDropEngine.Event!=null?ISDragDropEngine.Event:event);var el=obj.Element;var drops=ISDragDropEngine.Dropables;var matchedDrop=null;var x=evnt.clientX-obj.GrabX;var y=evnt.clientY-obj.GrabY-(obj.OffsetElement?ISPosLib.getHeight(obj.OffsetElement):0)+obj.AdjustTop;var sX=ISDragDropEngine.GetXPos(evnt);var sY=ISDragDropEngine.GetYPos(evnt);var _sX=sX;var _sY=sY;var _x=x;var _y=y;var currentDrop=ISDragDropEngine.DropObject;if(!obj.IsDragged){if(obj.MoveCount<5){if(!obj.Element.selectStartInitialized){Listener.Add(obj.Element,"onselectstart",ISDragDropEngine.OnSelectStart);obj.Element.selectStartInitialized=true}obj.MoveCount++;evnt.cancelBubble=true;evnt.returnValue=false;return}if(ISEvent.Raise(obj.OnDragStart,obj)){obj.IsDragged=true;if(obj.AllowCrossFrame){ISDragDropFrameEngine.RegisterCrossFrameEvents(obj)}}else{return}}else{obj.MoveCount=0}if(evnt){ISDragDropEngine.ClientX=evnt.clientX;ISDragDropEngine.ClientY=evnt.clientY}if(obj.TransparentShadow){if(el.ShadowId){obj.ShadowElement=document.getElementById(el.ShadowId)}if(obj.ShadowElement==null||obj.AlwaysRecreateShadow){var shadow=document.createElement("div");var firstChild=null;ISDragDropEngine.Count++;if(obj.OnShadowCreate!=""){ISEvent.Raise(obj.OnShadowCreate,obj);if(obj.ShadowElement){shadow=obj.ShadowElement}}if(obj.OnShadowCreate==""||obj.ShadowElement==null){if(!obj.SimpleIndicator){var html=el.outerHTML.replace(new RegExp('id\\="\\w+"',"g"),"");if(el.tagName=="TD"){html="<table class='"+el.parentElement.parentElement.parentElement.className+"' cellspacing=0 cellpadding=0><tr>"+html+"</tr></table>"}shadow.innerHTML=html}else{shadow.innerHTML="<div></div><div style='display: none; border: gray 2px solid; position: relative; top: 5px; left: 15px; font-size: 1px; height: 10px; width: 15px'></div>";shadow.children[0].style.cssText="width: 20px; height: 20px";if(IS.ie){shadow.children[0].style.backgroundColor="white"}}}else{}shadow.id="_Shadow"+ISDragDropEngine.Count;firstChild=shadow.children[0];firstChild.style.position="";firstChild.style.left="";firstChild.style.top="";firstChild.id="";firstChild.onmousedown=null;firstChild.style.cursor="";firstChild.title="";el.ShadowId=shadow.id;firstChild.style.opacity=0.5;document.body.insertAdjacentElement("afterBegin",shadow);obj.ShadowElement=shadow}el=obj.ShadowElement}with(el.style){position="absolute";if(obj.SimpleIndicator){left=sX-10+"px";top=sY-10+"px"}else{if(!el.IsCustomShadow||el.UseDefaultPosition){left=_x+"px";top=_y+"px"}else{left=sX-(ISPosLib.getWidth(el)/2)+"px";var elHeight=ISPosLib.getHeight(el);var adjTop=0;if(el.AdjustTop){adjTop=el.AdjustTop}if(el.AdjustLeft){left=posLeft-el.AdjustLeft+"px"}if(elHeight<21){top=sY-elHeight+5+"px"}else{top=sY-(elHeight/2)-adjTop+"px"}}}zIndex=255;display=""}if(dragData.IsInTargetFrame){drops=dragData.TargetFrame.ISDragDropEngine.Dropables;sX-=dragData.TargetFrameCoord.X;sY-=dragData.TargetFrameCoord.Y}for(var i=0;i<drops.length;i++){var drop=drops[i];var dragResult=ISDragDropEngine.IsInDragArea(drop,sX,sY);if(typeof(dragResult)=="boolean"&&dragResult){matchedDrop=drop;break}else{if(typeof(dragResult)=="object"){matchedDrop=dragResult;break}}}if(matchedDrop!=null){dragData.X=x;dragData.Y=y;dragData.CursorX=sX;dragData.CursorY=sY;dragData.KeyState=(evnt.ctrlKey?ISKeyState.Ctrl:0)|(evnt.altKey?ISKeyState.Alt:0)|(evnt.shiftKey?ISKeyState.Shift:0);if((currentDrop!=null&&currentDrop!=matchedDrop)&&(matchedDrop.IsSubObject?(currentDrop!=matchedDrop.ParentObject):true)){if(dragData.IsInTargetFrame&&currentDrop!=null&&currentDrop.Element.tagName=="IFRAME"){}else{ISEvent.Raise(currentDrop.OnDragLeave,currentDrop)}}if(currentDrop==matchedDrop||(matchedDrop.IsSubObject&&currentDrop==matchedDrop.ParentObject)){if(!matchedDrop.IsSubObject){ISEvent.Raise(currentDrop.OnDragOver,ISDragDropEngine.DragData,matchedDrop)}else{ISEvent.Raise(matchedDrop.ParentObject.OnDragOver,ISDragDropEngine.DragData,matchedDrop)}}else{if(!dragData.IsInTargetFrame||(dragData.IsInTargetFrame&&matchedDrop!=null&&matchedDrop.Element.tagName!="IFRAME")){ISEvent.Raise(matchedDrop.OnDragEnter,ISDragDropEngine.DragData,matchedDrop)}}ISDragDropEngine.LastDropObject=ISDragDropEngine.DropObject;ISDragDropEngine.DropObject=matchedDrop;if(dragData.Effect==0){dragData.Effect=ISDragDropEffects.All}if(dragData.EffectText!=""&&matchedDrop.OverTimeoutID==0){matchedDrop.OverTimeoutID=setTimeout(function(){ISDragDropEngine.SetTooltipText(matchedDrop,dragData.EffectText,true)},700)}}else{if(currentDrop!=null&&!dragData.IsInTargetFrame){if(currentDrop.IsSubObject){ISEvent.Raise(currentDrop.ParentObject.OnDragLeave,currentDrop)}else{ISEvent.Raise(currentDrop.OnDragLeave,currentDrop)}ISDragDropEngine.ClearTooltip(currentDrop)}if(dragData.IsInTargetFrame){var tfDrop=dragData.TargetFrameDrop;if(!ISDragDropEngine.IsInDragArea(tfDrop,_sX,_sY)){dragData.IsInTargetFrame=false}else{if(currentDrop!=null&&currentDrop.Element.tagName!="IFRAME"){tfDrop=currentDrop}else{tfDrop=null}}if(tfDrop!=null){ISEvent.Raise(tfDrop.OnDragLeave,tfDrop);ISDragDropEngine.ClearTooltip(tfDrop)}}dragData.Effect=0;ISDragDropEngine.DropObject=null}ISDragDropEngine.SetCursor(el,dragData.Effect);if(IS.ie&&ISDragDropEngine.WorkaroundImage(obj)){if(typeof(obj.Element.initialCursor)=="undefined"){obj.Element.initialCursor=obj.Element.style.cursor}ISDragDropEngine.SetCursor(obj.Element,dragData.Effect)}if(matchedDrop!=null){if(matchedDrop.IsSubObject){if(dragData.EffectText!=""){ISDragDropEngine.SetTooltipText(matchedDrop,dragData.EffectText)}else{ISDragDropEngine.ClearTooltip(matchedDrop)}}else{if(dragData.EffectText==""){ISDragDropEngine.ClearTooltip(matchedDrop)}else{ISDragDropEngine.SetTooltipText(matchedDrop,dragData.EffectText)}}}else{if(drop!=null){ISDragDropEngine.SetTooltipText(drop,dragData.EffectText)}}evnt.returnValue=false;evnt.cancelBubble=true;ISDragDropEngine.Event=null}else{if(event){event.returnValue=false;event.cancelBubble=true}}}},OnSelectStart:function(){if(event){event.cancelBubble=true;event.returnValue=false}return false},OnMouseDown:function(){if(!ISEvent.IsLeftButton(event.button)){return}if(ISDragDropEngine.IsMouseDown){ISDragDropEngine.OnMouseUp()}ISDragDropEngine.IsMouseDown=true;if(IS.moz&&ISDragDropEngine.Object!=null){event.returnValue=false;event.cancelBubble=true}},OnMouseUp:function(){if(ISDragDropEngine.Object){var c=ISDragDropEngine.Object;if(c.IsDragged){if(!c.TransparentShadow){ISDragDropEngine.SetCursor(c.Element,-1)}else{ISDragDropEngine.SetCursor(c.ShadowElement,-1)}if(IS.ie&&ISDragDropEngine.WorkaroundImage(c)){if(c.Element.initialCursor){c.Element.style.cursor=c.Element.initialCursor}else{ISDragDropEngine.SetCursor(c.Element,-1)}}if(c.TransparentShadow){c.ShadowElement.style.display="none"}else{if(!c.TransparentShadow&&c.HideOnDrop){c.Element.style.display="none"}}c.IsDragged=false;Listener.Remove(c.Element,"onselectstart",ISDragDropEngine.OnSelectStart);c.Element.selectStartInitialized=false;var b=ISDragDropEngine.DragData;ISEvent.Raise(c.OnDragEnd,c)}else{c.GrabX=0;c.GrabY=0}}var a=ISDragDropEngine.DropObject;if(a!=null){if(!b){b=ISDragDropEngine.DragData}ISDragDropEngine.ClearTooltip(a);if(!a.IsSubObject){ISEvent.Raise(a.OnDragDrop,b,a)}else{ISEvent.Raise(a.ParentObject.OnDragDrop,b,a)}}if(!b){b=ISDragDropEngine.DragData}if(c!=null&&c.TopLevelDragDropHandled&&b.SourceChildFrame!=null){b.SourceChildFrame.ISDragDropEngine.ClearEngineState();b.SourceChildFrame.parent.ISDragDropEngine.ClearEngineState()}ISDragDropEngine.ClearEngineState()},WorkaroundImage:function(a){if(a.ShadowElement!=null&&a.ShadowElement.children[0].tagName=="IMG"){return true}else{if(a.SimpleIndicator&&a.Element.tagName=="IMG"){return true}}return false},ClearEngineState:function(){ISDragDropEngine.IsMouseDown=false;ISDragDropEngine.DropObject=null;ISDragDropEngine.DragData=null;ISDragDropEngine.Object=null;ISDragDropEngine.Event=null},SetCursor:function(el,effect,cursorStyleOnly){var es=el.style;switch(effect){case -1:es.cursor="";break;case ISDragDropEffects.None:es.cursor="not-allowed";break;default:es.cursor="default";break}if(cursorStyleOnly){return}var cursorEl=ISDragDropEngine.GetCursorElement(effect);if(effect>ISDragDropEffects.All){var dragData=ISDragDropEngine.DragData;if(event!=null){with(cursorEl.style){position="absolute";left=ISDragDropEngine.GetXPos(event)+12+"px";top=ISDragDropEngine.GetYPos(event)+15+"px";zIndex=257;display=""}}}else{if(cursorEl){cursorEl.style.display="none"}if(ISDragDropEngine.Object.SimpleIndicator){var el=ISDragDropEngine.Object.ShadowElement;if(el!=null&&el.children.length==2){if(effect==ISDragDropEffects.All){el.children[1].style.display=""}else{if(effect==-1||effect==ISDragDropEffects.None){el.children[1].style.display="none"}}}}}},SetTooltipText:function(drop,effectText,isInitial){if((isInitial||drop.IsTooltipShown)&&effectText!=""&&drop.OverTimeoutID>0&&ISDragDropEngine.IsMouseDown){if(ISDragDropEngine.TooltipElement==null){var div=document.createElement("div");if(!ISDragDropEngine.UseCssFramework){div.style.paddingRight="4px";div.style.paddingLeft="18px";div.style.paddingBottom="1px";div.style.backgroundColor="#F1F2F7";div.style.border="#767676 1px solid";div.style.fontFamily="Segoe UI, Tahoma";div.style.fontSize="9pt";div.style.filter="progid:DXImageTransform.Microsoft.Shadow(color=Gray,direction=135, strength=2)"}div.className="common-drag-tooltip";document.body.insertAdjacentElement("afterBegin",div);ISDragDropEngine.TooltipElement=div}var ttEl=ISDragDropEngine.TooltipElement;ttEl.innerHTML=effectText;ttEl.setAttribute("effect",ISDragDropEngine.DragData.Effect);if(!ISDragDropEngine.UseCssFramework){if(ISDragDropEngine.DragData.Effect==ISDragDropEffects.All){ttEl.style.paddingLeft="4px"}else{ttEl.style.paddingLeft="18px"}}if(event!=null&&(IS.moz?!isInitial:true)){with(ttEl.style){position="absolute";left=ISDragDropEngine.TestLeftCoord(ttEl,ISDragDropEngine.GetXPos(event)+9)+"px";top=ISDragDropEngine.GetYPos(event)+12+"px";zIndex=256;display=""}}else{if(isInitial){var imgEl=ISDragDropEngine.CursorElement;if(imgEl==null){return}with(ttEl.style){position="absolute";if(imgEl.style.display!="none"){left=ISDragDropEngine.TestLeftCoord(ttEl,ISPosLib.getLeft(imgEl)-3)+"px";top=ISPosLib.getTop(imgEl)-3+"px"}else{left=ISDragDropEngine.TestLeftCoord(ttEl,ISDragDropEngine.ClientX+9)+"px";top=ISDragDropEngine.ClientY+12+"px"}zIndex=256;display=""}}}if(isInitial){drop.IsTooltipShown=true}}},TestLeftCoord:function(a,b){if(b+(ISPosLib.getWidth(a))>document.body.clientWidth){b=document.body.clientWidth-ISPosLib.getWidth(a);b-=4}return b},ClearTooltip:function(a){if(a.OverTimeoutID>0){clearTimeout(a.OverTimeoutID);a.OverTimeoutID=0}if(ISDragDropEngine.TooltipElement!=null){var b=ISDragDropEngine.TooltipElement;if(b.style.display!="none"){b.style.display="none"}}a.IsTooltipShown=false},GetCursorElement:function(b){if(ISDragDropEngine.CursorElement==null){var c=new Image();c.className="common-drag-cursor";document.body.insertAdjacentElement("afterBegin",c);ISDragDropEngine.CursorElement=c}var a=ISDragDropEngine.CursorElement;a.setAttribute("effect",b);switch(b){case ISDragDropEffects.Copy:a.src=ISDragDropEngine.GetCursorImage("cursor_copy.gif");break;case ISDragDropEffects.Move:a.src=ISDragDropEngine.GetCursorImage("cursor_move.gif");break;case ISDragDropEffects.Link:a.src=ISDragDropEngine.GetCursorImage("cursor_link.gif");break;case ISDragDropEffects.Remove:a.src=ISDragDropEngine.GetCursorImage("cursor_remove.gif");break;case ISDragDropEffects.None:case ISDragDropEffects.NotAllowed:a.src=ISDragDropEngine.GetCursorImage("cursor_notallowed.gif");break}return a},GetCursorImage:function(b){var d=ISDragDropEngine.Object;if(d){if(d.Owner){var a=d.Owner;if(!a.ImagesDirectory||!a.ResolveImagePath){a=a.Parent}if(a){return a.ResolveImagePath(a.ImagesDirectory,b)}else{return"ISRes.axd?F/"+b}}else{if(d.ImagesDirectory&&d.ResolveImagePath){return d.ResolveImagePath(d.ImagesDirectory,b)}else{return"ISRes.axd?F/"+b}}}},IsInDragArea:function(e,n,o,a){if(e.Element!=null&&e.Enabled){if(e.Coord==null||!e.EnableCaching){var f=e.Element;if(!a){a=0}e.Coord=new Rectangle(ISPosLib.getLeft(f),ISPosLib.getTop(f)+a,ISPosLib.getWidth(f),ISPosLib.getHeight(f))}var j=e.Coord.X;var l=e.Coord.Y;var k=e.Coord.X+e.Coord.Width;var m=e.Coord.Y+e.Coord.Height;var g=null;if(n>j&&n<k&&o>l&&o<m){if(e.Owner!=null&&e.Owner.Parent!=null){var b=e.Owner.Parent;if(b.GlobalCoordResolver!=null){g=b.GlobalCoordResolver.GetExcludedCoords(e)}if(ISDragDropEngine.MatchExcludedCoords(n,o,g)){return false}}if(e._SubObjects==null){return true}else{var d=ISDragDrop.GetLastDragData();for(var h=0;h<e._SubObjects.length;h++){if(ISDragDropEngine.IsInDragArea(e._SubObjects[h],n,o+d.ShiftedTop,d.ShiftedTop)){return e._SubObjects[h]}}return true}}}return false},MatchExcludedCoords:function(j,k,b){if(b!=null){for(var d=0;d<b.length;d++){var a=b[d];var e=a.X;var g=a.Y;var f=a.X+a.Width;var h=a.Y+a.Height;if(j>e&&j<f&&k>g&&k<h){return true}}}return false},GetXPos:function(a){var b=0;if(IS.ie){b=a.clientX+ISDragDropEngine.GetScrollLeft()}else{b=a.pageX}return b},GetYPos:function(a){var b=0;if(IS.ie){b=a.clientY+ISDragDropEngine.GetScrollTop()}else{b=a.pageY}return b},GetScrollLeft:function(){var a=0;if(window.pageXOffset){a=window.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollLeft){a=document.documentElement.scrollLeft}else{if(document.body&&document.body.scrollLeft){a=document.body.scrollLeft}}}return a},GetScrollTop:function(){var a=0;if(window.pageYOffset){a=window.pageYOffset}else{if(document.documentElement&&document.documentElement.scrollTop){a=document.documentElement.scrollTop}else{if(document.body&&document.body.scrollTop){a=document.body.scrollTop}}}return a},CommonDragEnter:function(g,f){var c=g.DragObject.Owner;var d=f.Owner;var b=f.Owner.Parent;if(c._Type=="WebDragControl"){g.EffectText=c.Get("EffectText");g.Effect=c.Get("Effect");g.AllowedEffects=c.AllowedEffects;g.Data=c.DragData}if(d._Type=="WebDropControl"){if(d.Get("AcceptDataType")!="All"){var i=d.Get("AcceptDataType");var h=false;switch(i){case"String":h=g.GetDataPresent("string");break;case"Number":h=g.GetDataPresent("number");break;case"Boolean":h=g.GetDataPresent("boolean");break;case"DateTime":h=g.Data instanceof Date;break;case"Array":h=g.Data instanceof Array;break;case"Object":h=g.GetDataPresent("object");break}if(!h){g.Effect=ISDragDropEffects.NotAllowed}}if(g.Effect!=ISDragDropEffects.NotAllowed&&d.Get("AcceptDragSourceControls")!=""){var a=d.Get("AcceptDragSourceControls");if(a.indexOf(c.ControlID)==-1){g.Effect=ISDragDropEffects.NotAllowed}}}}};var ISDragDrop={_Obj:null,_isRegisterOnMouseMove:false,DoDragDrop:function(i,f,e,l,m,o,n,p){var h=new ISDragableObject();var g=new ISDragEventArgs();var j=0;var k=0;j=ISPosLib.getLeft(i);k=ISPosLib.getTop(i);if(j<1){j=i.offsetLeft}if(k<1){k=i.offsetTop}if(p!=null){var q=event.clientX;var r=event.clientY;var a=p.X;var b=p.X+p.Width;var c=p.Y;var d=p.Y+p.Height;if(q>a&&q<b&&r>c&&r<d){pass=true}else{return new Object()}}h.Element=i;h.GrabX=event.clientX-j;h.GrabY=event.clientY-k;if(l){h.TransparentShadow=true}if(m){h.HideOnDrop=true}if(o){h.OnDragStart=o}if(n){h.OnDragEnd=n}g.DragObject=h;g.AllowedEffects=e;g.Data=f;ISDragDropEngine.Object=h;ISDragDropEngine.DragData=g;return h},RegisterDropable:function(a){if(a.SubObjects!=null){ISDragDrop.SetSubObjects(a,a.SubObjects)}ISDragDropEngine.Dropables.push(a)},SetSubObjects:function(c,d){c.SubObjects=d;c._SubObjects=null;c._SubObjects=new Array();for(var a=0;a<d.length;a++){var b=null;if(d[a].tagName){b=new ISDropableObject(d[a])}else{b=new ISDropableObject(d[a].GetElement());b.SubObjectContext=d[a]}b.IsSubObject=true;b.ParentObject=c;b.Owner=c.Owner;c._SubObjects.push(b)}},GetLastDropable:function(){return ISDragDropEngine.LastDropObject},GetLastDragData:function(){return ISDragDropEngine.DragData}};window.attachEvent("onload",ISDragDropEngine.Initialize);window.attachEvent("onunload",ISDragDropEngine.Dispose);