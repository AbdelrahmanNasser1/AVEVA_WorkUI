function ISSilverlightControl(a){ISControl.call(this,a)}function ISBrushSettings(){this._Type="ISBrushSettings";ISObject.call(this);this.Mode="SolidColorBrush";this.SolidColorBrush=new ISSolidColorBrush();this.LinearGradientBrush=new ISLinearGradientBrush();this.RadialGradientBrush=new ISRadialGradientBrush()}function ISBrush(){this._Type="ISBrush";ISObject.call(this);this.Opacity=1}function ISSolidColorBrush(){this._Type="ISSolidColorBrush";ISBrush.call(this);this.Color="#FFFFFFFF"}function ISLinearGradientBrush(){this._Type="ISSolidColorBrush";ISBrush.call(this);this.EndPoint=new ISPoint();this.EndPoint.X=1;this.EndPoint.Y=0.5;this.GradientStops="";this.SpreadMode="Pad";this.StartPoint=new ISPoint();this.StartPoint.X=0;this.StartPoint.Y=0.5}function ISPoint(){this._Type="ISPoint";ISObject.call(this);this.X=0;this.Y=0}function ISRadialGradientBrush(){this._Type="ISRadialGradientBrush";ISBrush.call(this);this.Center=new ISPoint();this.Center.X=0.5;this.Center.Y=0.5;this.GradientOrigin=new ISPoint();this.GradientOrigin.X=0.5;this.GradientOrigin.Y=0.5;this.GradientStops="";this.RadiusX=0.5;this.RadiusY=0.5;this.SpreadMode="Pad"}function ISFont(){this._Type="ISFont";ISObject.call(this);this.UseCustomFont=false;this.CustomFontFamily="";this.FontSource="";this.FontFamily="Verdana";this.FontSize=10;this.FontStretch="Normal";this.FontStyle="Normal";this.FontWeight="Normal";this.TextDecorations="None";this.Foreground=new ISBrushSettings()}function ISPadding(){this._Type="ISPadding";ISObject.call(this);this.All=-1;this.Top=0;this.Bottom=0;this.Left=0;this.RIght=0}function DownloaderParameter(){this.Direction="Horizontal";this.Position=64;this.Modifier=1;this.Width=400}function SilverlightResources(){this.Control=null;this.Downloader=null;this.TotalSourcesDownloaded=0;this.Sources=new Array();this.TextBlockElement=null;this.DownloadProgressElement=null;this.CurrentData=null;this.Add=function(b,c){var a=new SilverlightSourceData();a.Element=b;a.FileName=c;this.Sources[this.Sources.length]=a};this.Clear=function(){this.Sources=new Array()};this.PerformDownload=function(a,b){a.DownloadResourceCompleted=false;this.Control=a;a.HideElement();this.CreateDownloadUI(a,b);this.DownloadProgress();this.CreateDownloader(a);ISCoreSilverlightEngine.ResourceObject=this;var c=this;if(IS.moz){window.setTimeout(function(){c.DownloadSource()},1500)}else{c.DownloadSource()}};this.CreateDownloader=function(a){var c=a.SilverlightHost;var b=c.createObject("downloader");b.addEventListener("completed",this.OnSilverlightResourcesCompleted);b.addEventListener("downloadfailed",this.OnSilverlightDownloadFailed);this.Downloader=b};this.CreateDownloadUI=function(a,b){var d=a.SilverlightHost;var c=ISCoreSilverlightEngine.CreateDownloadProgress(a,b);this.DownloadProgressElement=c[0];this.TextblockElement=c[1]};this.DownloadProgress=function(){var a=this.TotalSourcesDownloaded/this.Sources.length*100;a=Math.round(a);this.TextblockElement.Text=a+"% Completed";this.TextblockElement["Canvas.Top"]=(this.DownloadProgressElement.Height-this.TextblockElement.actualHeight)/2;this.TextblockElement["Canvas.Left"]=(this.DownloadProgressElement.Width-this.TextblockElement.actualWidth)/2};this.Reset=function(){this.TotalSourcesDownloaded=0;this.Sources=new Array();this.CurrentData=null};this.DownloadSource=function(){if(this.TotalSourcesDownloaded<this.Sources.length){var b=this.Sources[this.TotalSourcesDownloaded++];this.DownloadProgress();this.DownloadedElement=b.Element;if(b.FileName!=null&&b.FileName!=""){this.Downloader.open("GET",b.FileName);this.Downloader.send();this.CurrentData=b}else{this.DownloadSource()}}else{var a=this.Control;a.ShowElement();a.OnAfterDownloadResource();a.SilverlightRootElement.children.remove(this.DownloadProgressElement);a.DownloadResourceCompleted=true;this.CurrentData=null;if(!IS.moz){this.Downloader.removeEventListener("completed",this.OnSilverlightResourcesCompleted);this.Downloader.removeEventListener("downloadfailed",this.OnSilverlightDownloadFailed)}}};this.OnSilverlightResourcesCompleted=function(e,b){var c=e.getHost();var d=c.id;var a=ISGetObject(d);a.SilverlightResources.DownloadedElement.setSource(e,"");a.SilverlightResources.DownloadSource()};this.OnSilverlightDownloadFailed=function(f,c){var d=f.getHost();var e=d.id;var a=ISGetObject(e);var b=a.SilverlightResources;alert("Error downloading resource '"+b.CurrentData.FileName+"'");b.DownloadSource()}}function SilverlightSourceData(){this.Element=null;this.FileName=null}var ISCoreSilverlightEngine={StringBuilder:function(){this.Data=new Array();this.Append=function(a){this.Data.push(a)};this.Clear=function(){this.Data=null;this.Data=new Array()};this.ToString=function(){return this.Data.join("")}}};