function BoxObject(){this.x=0;this.y=0;this.width=0;this.height=0}function Selection(a,b){this._document=a;this._selection=b;this.toString=function(){return this._selection.toString()};this.collapse=function(){return this._selection.collapse()};this.collapseToEnd=function(){return this._selection.collapseToEnd()};this.collapseToStart=function(){return this._selection.collapseToStart()};this.empty=function(){return this._selection.empty()};this.setBaseAndExtent=function(c,d,e,f){return this._selection.setBaseAndExtent(c,d,e,f)};this.setPosition=function(c,d){return this._selection.setPosition(c,d)};this.modify=function(c,d,e){return this._selection.modify(c,d,e)};this.getRangeAt=function(c){return this._selection.getRangeAt(c)};this.createRange=function(){return this._document.createRange()}}var SafariEngine={Emulate:function(){SafariEngine._EmulateDocumentModel();SafariEngine._EmulateHTMLElement();SafariEngine._EmulateSelection();SafariEngine._EmulateStyles();SafariEngine._EmulateFocusManager();SafariEngine._EmulateXmlDocument();SafariEngine._EmulateStyleSheet()},_EmulateDocumentModel:function(){var a=HTMLDocument.prototype;a.getBoxObjectFor=function(c){var b=new BoxObject();b.x=ISPosLib.getLeft(c);b.y=ISPosLib.getTop(c);b.width=ISPosLib.getWidth(c);b.height=ISPosLib.getHeight(c);return b};a.__defineGetter__("selection",function(){var b=window.getSelection();return new Selection(window.document,b)})},_EmulateHTMLElement:function(){var a=HTMLElement.prototype;a.__defineGetter__("innerTextEx",function(){var b=this.innerText;if(b!=""){return b}else{if(this.textContent){return this.textContent}}return b});a.createTextRange=function(){var b;if(this.tagName=="INPUT"){b=document.createRange();b.setStart(this,0);b.setEnd(this,0)}return b}},_EmulateSelection:function(){var a=Selection.prototype},_EmulateStyles:function(){var a=CSSStyleDeclaration.prototype;a.__defineGetter__("borderLeft",function(){return this.borderLeftColor+" "+this.borderLeftWidth+" "+this.borderLeftStyle})},_EmulateXmlDocument:function(){var a=XMLDocument.prototype;a._readyState=4;a._fp=null;a.load=function(c){this.readyState=0;this.ReadyState=0;if(!this._xml){this._xml=new XMLHttpRequest()}this._xml.abort();this._xml.open("GET",c,false);this._xml.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var b=this;this._xml.onreadystatechange=function(){SafariEngine._OnXmlReadyStateChange(b)};this._xml.send("")};a.GetReadyState=function(){if(typeof(this.readyState)!="undefined"){return this.readyState}else{if(typeof(this.ReadyState)!="undefined"){return this.ReadyState}else{return -1}}};a.__defineSetter__("ReadyState",function(b){this._readyState=b});a.__defineGetter__("ReadyState",function(){return this._readyState});a.__defineGetter__("XMLDocument",function(){return this});a.removeNode=function(b){var c=this.XMLDocument;while(c.childNodes.length>0){c.removeChild(c.childNodes[0])}};a.__defineGetter__("documentElement",function(){if(this.XMLDocument!=null){if(IS.chrome||(IS.safari&&IS.GetSafariVersion()>=10)){return this.XMLDocument.firstChild}else{var b=this.XMLDocument.xml;this.XMLDocument=ISXml.CreateXmlDocument();this.XMLDocument.loadXML(b);return this.XMLDocument.documentElement}}else{return null}})},_OnXmlReadyStateChange:function(a){if(a._xml.ReadyState==4||a._xml.readyState==4){a.loadXML(a._xml.responseXML.xml)}a.ReadyState=a._xml.readyState;a.readyState=a._xml.readyState;if(a.onreadystatechange!=null){a.onreadystatechange()}},_EmulateFocusManager:function(){document.addEventListener("focus",SafariEngine._OnFocus,true);document.addEventListener("mousedown",SafariEngine._OnMouseDown)},_OnFocus:function(){if(document.focusChanging){return}SafariEngine._ChangeFocus(event.srcElement)},_OnMouseDown:function(){SafariEngine._ChangeFocus(event.srcElement)},_ChangeFocus:function(h){var d=document.focusedElement;var b=h;var a=null;var e=false;if(b!=null&&!b.tagName){b=document.body}if(b!=null&&b!=d){var g="";if(b.tagName){g=b.tagName.toLowerCase()}switch(g){case"input":case"select":case"textarea":case"button":a=b;break}if(a==null&&b.getAttribute("focusable")=="true"){a=b;e=true}else{if(a==null){a=SafariEngine._GetFocusableParent(b);e=true}}}if(a!=null){if(d!=null){if(d.contains(a)){a=null}if(a!=null){var c=document.createEvent("HTMLEvents");c.initEvent("blur",true,true);d.dispatchEvent(c)}}if(a!=null){document.focusedElement=a;if(e){var c=document.createEvent("HTMLEvents");c.initEvent("focus",true,true);document.focusChanging=true;a.dispatchEvent(c);document.focusChanging=false}}}},_GetFocusableParent:function(a){while(a!=null&&a.tagName!="BODY"&&typeof(a.getAttribute)=="function"){if(a.getAttribute("focusable")=="true"){return a}a=a.parentElement}return null},_EmulateStyleSheet:function(){var a=HTMLStyleElement.prototype;a.addRule=function(b,d){var c=this.sheet;c.insertRule(b+" { "+d+" } ",0)}}};SafariEngine.Emulate();if(typeof(Sys)!="undefined"){Sys.Application.notifyScriptLoaded()};