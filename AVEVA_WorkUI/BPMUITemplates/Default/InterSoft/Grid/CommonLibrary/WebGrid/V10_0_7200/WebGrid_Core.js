var WG40={COLHEADER:"CH",COLFOOTER:"CF",BODY:"TB",COLHEADERGROUP:"CHG",COLFOOTERGROUP:"CFG",COLGROUP:"CG",GROUPBYBOX:"GBB",GROUPBYBOXLABEL:"GBBInfo",STATUSBOX:"Status",STATUSBAR:"Stat",STATUSBARRIGHT:"Stat2",SLIDERBAR:"Slider",STATUSICON:"StatIcon",STATUSBARCOMMAND:"Stat3",FREEZEBAR:"Freeze",HTMLDIV:"dv",HTMLTABLE:"tb",HTMLCELL:"td",HTMLROW:"tr",CONTAINER:"CNT",ROW:"ROW"};function WebGrid(a){this.ClassName="WebGrid";this.Version="10.0.7200";this.BuildNumber="10";this.MajorVersion="10.0";this.RequiredFrameworkVersion="3.0.5000.18";this.XmlNamespace="isnet.webui.webgrid";this.InitializeControlData=function(){WG50Engine._InitializeControlData(this)};ISControl.call(this,a);IFlyPostBack.call(this,"WebGridRequest");if(typeof(IClientBinding)=="function"){IClientBinding.call(this);this.ClientBindingSettings.PreloadGroupTotals=false;this.ClientBindingSettings.EnableGroupRowPaging=false;this.ClientBindingSettings.GroupRowPageSize=50}this.LayoutSettings=new WebGridLayoutSet();this.FlyPostBackSettings=new FlyPostBackSettings();this.BrowserPrintSettings=new BrowserPrintSettings();this.RootTable=new WebGridTable();this.StateRestorationLevel="High";this.CustomEditors=null;this.UtilizedCustomEditors=new ISArray();if(IS_ReleaseType=="Beta"){this.ScriptDirectory="/CommonLibraryBeta/WebGrid/V10_0_7200/"}else{if(IS_ReleaseType=="Debug"){this.SharedScriptDirectory="/CommonLibraryTemp/Shared-Branch-1.2/";this.ScriptDirectory="/CommonLibraryTemp/WebGrid/V10_0_7200/"}else{this.ScriptDirectory="/CommonLibrary/WebGrid/V10_0_7200/"}}this.WebDesktopScriptDirectory="/CommonLibrary/WebDesktop/V5_0_7200/";this.GridLines="Both";this.Enabled=true;this.Visible=true;this.Height=null;this.Width=null;this.Name=a;this.WebCombos=new ISArray();this.TotalLoadedRows=0;this.TotalRows=0;this.GBBLabelClass="";this.RowClass="";this.LostFocusClass="";this.EditFocusClass="";this.CultureInfo=null;this.CustomStateString="";this.EnableV3XAPISupport=false;this.IsPreviewMode=false;this.LanguageXml=null;this.ExportTitle=null;this.LastAutoFitWidth=-1;this.IsLoaded=false;this.Tables=new Array();this.DraggerStyle="position: absolute; z-index: 299; cursor:default; display: none; background-color: RoyalBlue; color: White; filter: Alpha(Style=1, Opacity=90); vertical-align: middle";this.ResizerStyle="position: absolute; z-index: 299; width:2px; background-color:gray; display: none;";this.SelectedHeaderBackColor="black";this.SelectedHeaderForeColor="white";this.IsOnBlur=false;this.NeedFocus=false;this.TempResizeID=0;this.GlobalResizeID=0;this.HidePadColumn=false;this.CustomEditors=new Array();this.CustomRequestData=null;this.XmlHttp=null;this.XmlResp=null;this.XmlReq=null;this.NeedHeightResize=false;this.NeedWidthResize=false;this.CacheTBodyHeight=null;this.CacheTBodyWidth=null;this.CacheFrameHeight=null;this.CacheFrameWidth=null;this.Resizer=null;this.ColPointer=null;this.IsInProgress=false;this.LastRequestObj=null;this.TempLRO=null;this.LastSelObj=null;this.ActiveEditCell=null;this.NeedUpdate=false;this.NeedAdd=false;this.UpdatesXml=null;this.IsInEditMode=false;this.LastEditObj=null;this.TBObj=null;this.TBMLObj=null;this.LastAction="";this.ValEngine=null;this.CalDDObj=null;this.ExportTypeList=new Array("HTML","PDF","XML","EXCEL","TIFF","RTF","TEXT");this.ExportWndAttr="toolbar=no, menubar=yes, scrollbars=yes, resizable=yes";this.IsExitingEdit=false;this.LastError="";this.EditCtlTopAdj=0;this.EditCtlLeftAdj=0;this.NextQueue=null;this.LastChkBox=null;this.FromContextMenu=false;this.PosLibVer=1;this.PosRelativeTo=null;this.CheckedRowContext=null;this.HeaderContext=null;this.ExportContext=null;this.EditControls=new Array();this.ChildHeaderContainer=null;this.NeedAutoFitOnLoad=false;this.FreezeConfig=null;this.FreezePaneActive=false;this.SkipFreezeLayout=false;this.FreezeScrollId=0;this.FrozenColumns=null;this.CacheFrozenWidth=0;this.FreezeScrollImmediate=false;this.LastFreezeScroll=0;this.WebResourceIdentifier="G";this.CurrentRowImage=null;this.BuiltInDropDown=true;this.IsStatusLocked=false;this.UseDefaultStyle=false;this.DefaultStyleMode="Standard";this.CurrentPageIndex=0;this.TotalPages=0;this.CurrentViewMode="GridView";this.ChartMode="InteractiveUI";if(typeof(ChartInteractiveUI)!="undefined"){this.ChartInteractiveUI=new ChartInteractiveUI();this.ChartSettings=new ChartSettings()}else{this.ChartInteractiveUI=null;this.ChartSettings=null}this.ChartDataCollection=new ISArray();this.ChartFilterCollection=new ISArray();this.ChartCategoryCollection=new ISArray();this.ChartSeriesCollection=new ISArray();this.CachePivotFilterCollection=new ISArray();this.CachePivotFilterInfoCollection=new ISArray();this.AllowPivotCharting=false;this.ChartContainer=null;this.EnableSection508Standards=false;this.DataSource=null;this.DataSourceInternal=null;this.SerializeTagToClient=false;this.IsLoaded=false;this.ActionElement=null;this.ActionBoxShown=false;this.ColumnActionContext=null;this.ScrollBarSize=19;this.MinHeight=40;this.ReviewDialogBox=null;this.AutoIntegrateToDesktopManager=true;this.FoundValidDesktopManagerInstance=false;this.OnInitialize=function(){if(this.IsPreviewMode){WGUIEngine.HideNoDataBox(this);return}if(this.FlyPostBackSettings!=null){this.PostViewState=this.FlyPostBackSettings.PostViewState;this.PostHiddenFields=this.FlyPostBackSettings.PostHiddenFields;this.PostInputControls=this.FlyPostBackSettings.PostInputControls}ISEvent.Raise(this.LayoutSettings.ClientSideEvents.OnInitialize,this.Id);this.ValEngine=IS.GetValidationEngine();this.LayoutSettings.ScriptDirectory=this.ScriptDirectory;this.CustomEditors=new Array();for(var h=0;h<this.UtilizedCustomEditors.length;h++){this.CustomEditors[this.UtilizedCustomEditors[h].Name]=this.UtilizedCustomEditors[h]}if(typeof(ISGetCultureInfo)=="function"){this.CultureInfo=ISGetCultureInfo(this.LayoutSettings.Culture,false)}if(this.CultureInfo==null){WG50Engine.LoadDefaultCulture(this)}this.SetStatus1("","ready","CommonText/Ready");if(!this.LayoutSettings.StatusBarVisible&&IS.moz){var d=this.GetString("Ready")}var m=this.TotalLoadedRows;var n=this.TotalRows;if(n<m){m=n;this.TotalLoadedRows=m}if(this.IsClassicPaging()){m=this.GetCurrentPage();n=this.GetTotalPages()}this.SetStatus2("","loaded",m,n);WG50Engine.ReflectNoDataStatus(this);var l=["FocusCell","AddedRow","ModifiedRow","DeletedRow"];for(var h=0;h<l.length;h++){var k=ISXml.GetNode(this.LayoutSettings.XmlNode,"//"+l[h]+"Style");if(k!=null){this.LayoutSettings.XmlNode.removeChild(k)}else{this.LayoutSettings.XmlNode.removeAttribute(l[h]+"Style")}}var e=this.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);if(e&&e.style.display=="none"&&!e.forceHide){e.style.display="block"}if(this.LayoutSettings.AllowContextMenu&&typeof(WebContextMenu)=="undefined"&&!this.IsInPreview){this.LayoutSettings.AllowContextMenu=false;alert("Context menu feature is disabled because menu runtime system can't be loaded.\nEnsure you have registered SmartWebResources in this web application.")}if(this.IsElegantDefaultStyle()||this.UseCssFramework){this.BuiltInDropDown=false;this.CalDDImg="wg5_calendar.gif"}var f=this.FrameObj;if(IS.ie&&!this.UseCssFramework){var g=f.currentStyle;var j=f.parentElement.style;var b=parseFloat(g.borderTopWidth);if(g.position!="absolute"&&b>0){j.borderRightWidth=g.borderRightWidth;j.borderRightStyle=g.borderRightStyle;j.borderRightColor=g.borderRightColor;j.borderLeftWidth=g.borderLeftWidth;j.borderLeftStyle=g.borderLeftStyle;j.borderLeftColor=g.borderLeftColor;j.borderTopWidth=g.borderTopWidth;j.borderTopStyle=g.borderTopStyle;j.borderTopColor=g.borderTopColor;j.borderBottomWidth=g.borderBottomWidth;j.borderBottomStyle=g.borderBottomStyle;j.borderBottomColor=g.borderBottomColor;f.style.border="none 0px"}}WGUIEngine.AssignInitialHeight(this);WG50Engine.InitializeClientStorage(this);if(this.BindingOperationMode=="ClientBinding"){var c=this.ClientBindingSettings.DataSourceType;if(c!="ServerDataSource"){if(c=="WebService"||c=="WcfService"){this.ClientProvider=new WebServiceDataSourceProvider(this)}else{if(c=="AdoDataService"){this.ClientProvider=new AstoriaDataSourceProvider(this)}}}}WGUIEngine.RealignSortIndicators(this.RootTable);if(this.UseCssFramework){this.DraggerStyle="";this.ResizerStyle="";this.ImagesDirectory=this.GetImagesFolder()}if(this.CustomEditorServerIDs){this.CustomEditorServerIDs=this.CustomEditorServerIDs.split(",")}ISEvent.Raise(this.LayoutSettings.ClientSideEvents.OnAfterInitialize,this.Id);e=null};this.OnUnload=function(){WG50Engine.UnregisterBehaviour(this);Listener.Unload(this.FrameObj);Listener.Unload(this.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV));Listener.Unload(this.RootTable.GetElement(WG40.BODY,WG40.HTMLTABLE));for(var c in this.Tables){if(c!=null&&typeof(c)=="string"){var b=this.Tables[c];if(typeof(b)!="function"&&b!=null){b.OnUnload()}}}if(this.ChartContainer&&this.ChartInteractiveUI){this.ChartInteractiveUI.OnUnload()}};this.ResolveImagePathEx=function(b){return this.ResolveImagePath(this.GetImagesFolder(),b)};this.__getter=function(b){switch(b){case"Visible":return(this.FrameObj.style.display=="")}};this.ShouldReturnJson=function(){return this.ClientBindingSettings!=null};this.ReBindingPostBackData=function(b){WG50Engine.SetLastSelectedObject(this);WG50Engine.SetCheckedRowsData(this);WG50Engine.SetClientStorageData(this,b)};this.PrepareAdditionalPostBackData=function(){WG50Engine.UpdateState(this)};this.OnResponseError=function(b){WG50Engine.OnResponseError(this,b)};this.OnResponse=function(c,b){WG50Engine.OnResponse(this,c,b)};this.IsRightToLeft=function(){var b=this.FrameObj.currentStyle.direction;return b=="rtl"};this.EnsureActiveEditCellFocus=function(){if(typeof(WGEditEngine)!="undefined"){WGEditEngine.EnsureActiveEditCellFocus(this)}};this.EditKeyboardHandler=function(b){WGEditEngine.EditControlKeyboardHandler(this,b)};this.GetRootTable=function(){return this.RootTable};this.GetMaxWidth=function(){var e=this.GetRootTable().GetElement(WG40.BODY,WG40.HTMLTABLE).offsetWidth;var b=e;var c;for(c in this.Tables){var d=this.Tables[c];if(typeof(d)!="function"){b=Math.max(b,d.GetMaxWidth())}}return b};this.GetRootTableWidth=function(){var c=this.GetRootTable().GetElement(WG40.COLHEADER,WG40.HTMLTABLE);var b=c.rows[0].cells[c.rows[0].cells.length-1];return c.offsetWidth-b.offsetWidth};this.GetPreferredRootTableWidth=function(){var c=this.GetRootTable().GetElement(WG40.COLHEADER,WG40.HTMLTABLE);var b=c.rows[0].cells[c.rows[0].cells.length-1];if(b.style.width.indexOf("%")>0){return c.offsetWidth-b.offsetWidth}else{return c.offsetWidth}};this.FixPadColumnWidth=function(){if(this.GetMaxWidth()>this.GetRootTableWidth()){var f=this.GetMaxWidth()-this.GetRootTableWidth()+50;var e=this.GetRootTable();var b=e.GetElement(WG40.COLGROUP);var d=b.childNodes[b.childNodes.length-1];d.width=f;var c=parseInt(d.width);if(WG50Engine.HasVSBar(this.GetRootTable().GetElement(WG40.BODY,WG40.HTMLDIV))){c+=17}b=e.GetElement(WG40.COLHEADER,WG40.HTMLTABLE);d=b.rows[0].cells[b.rows[0].cells.length-1];WG50Engine.SetColHeaderPaddingWidth(e,d,c);d.locked=true}};this.GetColumnByElement=function(b){return WG50Engine.GetColumnByElement(b)};this.GetCellByElement=function(b){return WG50Engine.GetCellByElement(b)};this.GetRowByElement=function(b){return WG50Engine.GetRowByElement(b)};this.GetElement=function(b,c){if(c==WG40.HTMLROW){var d=this.GetElement(b,WG40.HTMLCELL);return d.parentElement}else{return document.getElementById(c+b+"_"+this.Name)}};this.GetFreezeTableElement=function(){return this.GetElement(WG40.FREEZEBAR,WG40.HTMLTABLE)};this.GetFreezeOuterDivElement=function(){var d=this.GetFreezeTableElement();var b=d.rows[0].cells[0];var c=b.children[0];return c};this.GetFreezeDivElement=function(){var b=this.GetFreezeOuterDivElement();return b.children[0]};this.SetStatus1=function(j,c,f,g){if(this.LayoutSettings.StatusBarVisible){if(f!=""&&!this.IsPreviewMode){var k=this.LayoutSettings.TextSettings.TextItems.GetItemByProperty("TextItem",f);if(k){j=k.TextValue}if(j!=""){if(j=="none"){j=""}}else{j=this.GetString(f);if(typeof(j)=="undefined"||j==null){var b=this;setTimeout(function(){b.SetStatus1("",c,f,g)},100);return}}}if(typeof(g)!="undefined"){j=j.replace("{0}",g)}var d=this.GetElement(WG40.STATUSBAR,WG40.HTMLCELL).children[0];var h=d.parentElement;var e=0;var i=0;i=ISPosLib.getWidth(h);d.innerText=j;e=d.scrollWidth;d.style.visibility="hidden";if(i<e){d.style.width=(i-4)+"px"}else{d.style.width=""}d.style.visibility="visible";if(IS.ie){d.style.display="inline"}else{d.style.display="inline-block"}}};this.SetStatus2=function(h,c,f,g,e){if(this.LayoutSettings.StatusBarVisible){if(this.IsClassicPaging()&&!e){WGPageEngine.SynchronizeUI(this)}if(c=="loaded"){h=this.GetLoadedText(c,f,g);if(typeof(h)=="undefined"){var b=this;setTimeout(function(){b.SetStatus2(h,c,f,g,true)},100);return}}else{var d=this.GetString(c);if(d!=""){h=d}}this.GetElement(WG40.STATUSBARRIGHT,WG40.HTMLCELL).innerText=h}};this.SendCustomRequest=function(){WG50Engine.ExecuteFlyPostback(this.Name,"Custom")};this.ClearSelectedObject=function(c){if(c&&this.LastSelObj!=null){WGEventEngine.HighlightRow(this.LastSelObj.element,"","","Clear");var b=wgGetRowHeader(this.LastSelObj.element);if(b){b.innerHTML="&nbsp"}}this.LastSelObj=null};this.GetSelectedObject=function(){return this.LastSelObj};this.GetDefaultLanguageXml=function(){return ISXml.GetElementById("WGLang_default")};this.GetLanguageXml=function(){if(!IS.ie&&this.LanguageXml!=null){return this.LanguageXml}var b=this.GetDefaultLanguageXml();var c=this.LayoutSettings.TextSettings.Language;if(c=="UseCulture"){var d=ISXml.GetElementById("WGLang_"+this.LayoutSettings.Culture);if(!d){return b}else{return d}}else{if(c=="UseCustom"){var d=ISXml.GetElementById("WGLang_"+this.LayoutSettings.TextSettings.UseLanguage);if(!d){return b}else{return d}}}return b};this.GetString=function(b){var e="";if(this.IsPreviewMode){return b}var f=this.LayoutSettings.TextSettings.TextItems.GetItemByProperty("TextItem",b);if(f){e=f.TextValue}if(e==""){var c=this.GetLanguageXml();if(!IS.ie&&!this.LanguageXml){c=ISMoz.ConvertToXmlObject(c);this.LanguageXml=c}if((!IS.ie&&(c.xml==""||(c.XMLDocument&&c.XMLDocument.documentElement.nodeName=="root")))||(IS.ie&&!ISXml.IsReady(c))){return null}var d=ISXml.GetNode(c,"//"+b);if(d){e=d.text}}return e};this.GetLoadedText=function(b,g,h){var i="";var f=false;try{if(this.IsClassicPaging()){i=this.GetString("CommonText/PagingStatus")}else{i=this.GetString("CommonText/Loaded")}if(i==null||i==""){f=true}}catch(c){f=true}if(f){var d=this;setTimeout(function(){d.GetLoadedText(b,g,h)},100);return}if(this.IsClassicPaging()){i=i.replace("{0}",g).replace("{1}",h);g=this.TotalLoadedRows;h=this.TotalRows}else{i=i.replace("[n]",g);i=i.replace("[total]",h)}if(g==0||h==0){WGUIEngine.ShowNoDataBox(this)}else{WGUIEngine.HideNoDataBox(this)}return i};this.Refresh=function(){wgRefresh(this.Name)};this.RefreshAll=function(){wgRefresh(this.Name,true)};this.HasFocus=function(){return wgGetActiveGrid()==this.Name};this.GetCssMenuFile=function(){return this.LayoutSettings.ScriptDirectory+this.LayoutSettings.MenuCssFile};this.HasGroup=function(){var b=false;for(tbl in this.Tables){var c=this.Tables[tbl];if(typeof(c)!="function"&&c.GroupedColumns.length>0){b=true;break}}return b};this.ActivateEditMode=function(b){return WGEditEngine.ActivateEditMode(this,b)};this.ExitEditMode=function(b){if(typeof(WGEditEngine)!="undefined"){return WGEditEngine.ExitEditMode(this.LastEditObj,b)}};this.ValidateRow=function(b){return WGEditEngine.ValidateRow(this,b)};this.ExitEdit=function(d,b,c){return WGEditEngine.ExitEdit(this,d,b,c)};this.UpdateState=function(){};this.ShowGroupByBox=function(){var d=this.GetElement(WG40.GROUPBYBOX,WG40.HTMLTABLE);if(d){var e=d.parentElement;this.NeedHeightResize=true;e.style.display="";var b=this.GetRootTable().GetElement(WG40.COLHEADER,WG40.HTMLDIV);if(b){b.setAttribute("groupbox-visible","true")}this.FrameObj.setAttribute("groupbox-visible","true");if(!IS.ie){var c=this;window.setTimeout(function(){WGMozEngine.OnTableResize(c)},1)}else{WG50Engine._OnResize(true,false)}}};this.HideGroupByBox=function(){var d=this.GetElement(WG40.GROUPBYBOX,WG40.HTMLTABLE);if(d){var e=d.parentElement;this.NeedHeightResize=true;e.style.display="none";var b=this.GetRootTable().GetElement(WG40.COLHEADER,WG40.HTMLDIV);if(b){b.setAttribute("groupbox-visible","false")}this.FrameObj.setAttribute("groupbox-visible","false");if(!IS.ie){var c=this;window.setTimeout(function(){WGMozEngine.OnTableResize(c)},1)}else{WG50Engine._OnResize(true,false)}}};this.IsGroupByBoxShown=function(){var b=this.GetElement(WG40.GROUPBYBOX,WG40.HTMLTABLE);if(b){var c=b.parentElement;return c.style.display==""}return false};this.ShowFilterBar=function(){var b=this.GetRootTable().GetFilterRow();var c=new Array();if(wgIsColumnSetRow(b)){c=wgGetColumnSetRows(b)}else{c[0]=b}this.LayoutSettings.Set("FilterBarVisible",true,true);for(var e=0;e<c.length;e++){c[e].style.display=""}if(!IS.ie){var d=this;window.setTimeout(function(){WGMozEngine.OnTableResize(d);WGMozEngine.FixFilterColumns(d.GetRootTable())},50)}};this.HideFilterBar=function(){var b=this.GetRootTable().GetFilterRow();var c=new Array();if(wgIsColumnSetRow(b)){c=wgGetColumnSetRows(b)}else{c[0]=b}this.LayoutSettings.Set("FilterBarVisible",false,true);for(var e=0;e<c.length;e++){c[e].style.display="none"}if(!IS.ie){var d=this;window.setTimeout(function(){WGMozEngine.OnTableResize(d)},50)}};this.IsVisible=function(){return this.Get("Visible")};this.SetBusy=function(){if(this.LayoutSettings.StatusBarVisible){this.SetStatusIcon("InProgress")}if(this.LayoutSettings.InProgressUIBehavior=="ChangeCursorToHourGlass"){var b=document.getElementById(this.Name+"_ImgB");if(!b){b=document.createElement("IMG");b.id=this.Name+"_ImgB";b.style.cssText="z-index: 299; left: 0px; top: 0px; opacity: 0; filter2:alpha(opacity=0); position:absolute; height:50px; width:50px;";b.src=this.ResolveImagePathEx("wg_blank.gif");document.body.appendChild(b)}b.style.display="";b.style.cursor="wait";this.FrameObj.onmousemove=function(){WG50Engine.OnFrameMouseMove(b)}}};this.SetIdle=function(){if(this.LayoutSettings.StatusBarVisible&&!this.IsStatusLocked){this.HideStatusIcon()}if(this.LayoutSettings.InProgressUIBehavior=="ChangeCursorToHourGlass"){var b=document.getElementById(this.Name+"_ImgB");if(b!=null){b.style.cursor="default";b.style.display="none";this.FrameObj.onmousemove=null}}};this.ResetStatus=function(b){if(this.IsStatusLocked||b){this.IsStatusLocked=false;this.IsUnhandledError=false;this.SetIdle();this.SetStatus1("","ready","CommonText/Ready");if(b){WGUIEngine.ShowNoDataBox(this)}}};this.ClearChildTables=function(g){if(g){var h=this.Tables[g].GetChildTables();for(var d=0;d<h.length;d++){var j=this.Tables[h[d].Id];j.SubTableIds=new Array()}}else{var f=this.GetRootTable();var b=f.GetElement(WG40.COLHEADER,WG40.HTMLTABLE);var c=f.GetElement(WG40.COLHEADER,WG40.HTMLDIV);if(!this.IsRightToLeft()){c.scrollLeft=0}else{c.scrollLeft=c.scrollWidth}var e=b.rows[0].cells[b.rows[0].cells.length-1];e.locked=false;for(childTbl in this.Tables){if(typeof(this.Tables[childTbl])!="function"){this.Tables[childTbl].SubTableIds=new Array()}}}};this.GetBlurRowStyle=function(){var b=this.LayoutSettings.LostFocusClass;if(b==""){return"background-color: gainsboro"}else{return IS.GetCssValues(this.Id,b)}};this.GetEditFocusStyle=function(){var b=this.LayoutSettings.EditFocusClass;if(b==""){return"background-color: white;"}else{return IS.GetCssValues(this.Id,b)}};this.GetXml=function(){return this.XmlDt};this.MarkEdit=function(){WGEditEngine.MarkEdit(this)};this.GetCurSelImage=function(){return this.ResolveImagePathEx(this.LayoutSettings.ImageSettings.CurrentRowImage)};this.Show=function(){if(IS.ie){this.FrameObj.parentElement.style.display=""}this.FrameObj.style.display="";WGUIEngine.AutoFitColumns(this.Name);if(this.NeedFocus){WG50Engine.FocusGrid(this,true)}};this.SetFocus=function(){WG50Engine.FocusGrid(this,true)};this.Hide=function(){if(IS.ie){this.FrameObj.parentElement.style.display="none"}else{this.FrameObj.style.display="none"}};this.ExportGrid=function(e,b,c,d){WG50Engine.ExecuteFlyPostback(this.Name,"Export",new Array(e,b,c,d))};this.GetActiveEditCell=function(){return this.ActiveEditCell};this.GetLastEditObject=function(){return this.LastEditObj};this.SetHeight=function(b){WGUIEngine.SetHeight(this,b)};this.FreezePane=function(b){if(typeof(b)=="number"){if(this.LayoutSettings.RowHeaders=="No"){b++}this.LayoutSettings.FreezePaneSettings.ActiveFrozenColumns=b}WGUIEngine.InvalidateFreezeContainer(this);WGUIEngine.FreezePane(this,true)};this.UnfreezePane=function(){WGUIEngine.UnfreezePane(this)};this.GetLastFrozenColumn=function(){if(this.FrozenColumns!=null){return this.FrozenColumns[this.FrozenColumns.length-1]}return null};this.GetLastHiddenColumnWidth=function(){if(this.FreezeConfig!=null&&this.FreezeConfig[0].length>0){return this.FreezeConfig[0][this.FreezeConfig[0].length-1].GetWidth()}return 0};this.GetImagesFolder=function(){return this.LayoutSettings.ImageSettings.Folder};this.HideStatusIcon=function(){if(this.LayoutSettings.StatusBarVisible){var b=document.getElementById("tdStatIcon_"+this.Name).childNodes[0];b.style.visibility="hidden";b.parentElement.setAttribute("state","")}};this.SetStatusIcon=function(d,c){if(this.LayoutSettings.StatusBarVisible){var b=document.getElementById("tdStatIcon_"+this.Name).childNodes[0];if(c){b.src=d;b.parentElement.setAttribute("state","custom-image")}else{var e=this.ResolveImagePathEx(this.LayoutSettings.ImageSettings[d+"Image"]);if(b.src!=""&&b.src.indexOf(e)==-1){b.src=this.ResolveImagePathEx(this.LayoutSettings.ImageSettings[d+"Image"])}b.parentElement.setAttribute("state",d.toLowerCase())}b.style.visibility="visible"}};this.ClearSelection=function(){this.ClearSelectedObject(true)};this.IsClassicPaging=function(){return(this.LayoutSettings.PagingMode=="ClassicPaging")};this.ClearClientStorage=function(){for(var c in this.Tables){var b=this.Tables[c];if(typeof(b)=="object"){b.Storage.Clear()}}};this.EnableBatchUpdate=function(){this.LayoutSettings.AllowBatchUpdate=true;this.LayoutSettings.BatchUpdateSettings=new WebGridBatchUpdateSettings()};this.PreventLoadMore=function(){this.HaltLoadMore=true;var b=this;setTimeout(function(){b.HaltLoadMore=false},10)};this.IsClientBinding=function(c){var b=this.ClientBindingSettings;if(!c){c="ClientService"}if(this.BindingOperationMode=="ClientBinding"){if(c=="ClientService"&&(b.DataSourceType=="WebService"||b.DataSourceType=="WcfService"||b.DataSourceType=="AdoDataService")){return true}else{if(c=="Client"&&b.DataSourceType=="ClientDataSource"){return true}else{if(c=="Server"&&b.DataSourceType=="ServerDataSource"){return true}}}}return false};this.GetAllTables=function(){var b=[];b.push(this.RootTable.Name);return this.GetTableRecursive(b,this.RootTable.ChildTables)};this.GetTableRecursive=function(d,b){for(var c=0;c<b.length;c++){d.push(b[c].Name);if(b[c].ChildTables.length>0){this.GetTableRecursive(d,b[c].ChildTables)}}return d};this.IsElegantDefaultStyle=function(){return(this.UseDefaultStyle&&this.DefaultStyleMode!="Standard")};this.GetColumnActionElement=function(){if(this.ActionElement!=null){return this.ActionElement}var b=document.createElement("div");b.style.cssText="position: absolute; width: 16px; display:none";b.innerHTML='<div style="background: url('+this.ResolveImagePathEx(this.LayoutSettings.ImageSettings.ColumnActionImage)+') no-repeat center center; width: 100%;height: 100%"></div>';if(this.UseCssFramework){b.children[0].style.background="";b.style.width=""}Listener.Add(b,"onmouseover",WGUIEngine.OnActionOver,this);Listener.Add(b,"onmouseout",WGUIEngine.OnActionOut,this);Listener.Add(b,"onmouseup",WGUIEngine.OnActionUp,this);this.FrameObj.appendChild(b);this.ActionElement=b;return this.ActionElement};this.ClearActionElement=function(b){if(this.ActionElement!=null){this.ActionElement.style.display="none";this.ActionContext=null;this.ActionBoxShown=false}if(b){this.ActionElement=null}};this.ApplyDefaultStyleBorder=function(c){if(this.IsElegantDefaultStyle()){var b=IS.GetCssObject(null,this.LayoutSettings.TextBoxClass);if(b!=null){c.border=b.border}}};this.CopyMultipleRows=function(){return WGEditEngine.CopyMultipleRows(this.RootTable)};this.PasteMultipleRows=function(){var c=this.GetSelectedObject();if(c!=null){var b=this.GetSelectedObject().ToRowObject();return WGBatchEngine.AddNewRowsFromClipboard(this.RootTable,b.RowElement)}else{return null}}}function WebGridFreezePaneSettings(){this._Type="WebGridFreezePaneSettings";ISObject.call(this);this.MaxFrozenColumns=2;this.ActiveFrozenColumns=0;this.SplitterLineColor="Black";this.SplitterLineWidth=1;this.ShowSplitterLine=true;this.ShowInContextMenu=false;this.AbsoluteScrolling=false;this.SuppressErrorMessage=false}function WebGridClientEvents(){this._Type="ClientEvents";ISObject.call(this);this.OnBeforeRequest="";this.OnResponse="";this.OnColumnMove="";this.OnColumnResize="";this.OnColumnChanged="";this.OnRowSelect="";this.OnCellSelect="";this.OnCellClick="";this.OnCellDblClick="";this.OnGroupExpand="";this.OnGroupCollapse="";this.OnChildRowExpand="";this.OnChildRowCollapse="";this.OnKeyDown="";this.OnKeyUp="";this.OnRowSelectorClick="";this.OnEnterEditMode="";this.OnExitEditMode="";this.OnBeforeAdd="";this.OnAfterAdd="";this.OnBeforeUpdate="";this.OnAfterUpdate="";this.OnBeforeDelete="";this.OnAfterDelete="";this.OnAfterResponseProcess="";this.OnUnhandledError="";this.OnRowValidate="";this.OnCalendarSelect="";this.OnInitialize="";this.OnRowContextMenu="";this.OnEditKeyDown="";this.OnFocus="";this.OnLostFocus="";this.OnButtonClick="";this.OnCheckBoxClick="";this.OnActionDispatched="";this.OnSelfRefRowExpand="";this.OnSelfRefRowCollapse="";this.OnColumnGroup="";this.OnColumnUngroup="";this.OnColumnGroupChange="";this.OnColumnSort="";this.OnColumnFilter="";this.OnBeforeRowSelect="";this.OnBeforePrint="";this.OnAfterPrint="";this.OnScroll="";this.OnAfterInitialize="";this.OnUndoChanges="";this.OnUndoAllChanges="";this.OnAcceptAllChanges="";this.OnAddPendingChanges="";this.OnRemovePendingChanges="";this.OnBatchUpdateSuccess="";this.OnSynchronizeChangesUI="";this.OnCustomAggregate="";this.OnInitializeRow="";this.OnInitializeCell="";this.OnSynchronizeRow="";this.OnSynchronizeCell="";this.OnDataBound="";this.OnDataSourceChanged="";this.OnPreRender="";this.OnPostRender="";this.OnAfterExitEditMode="";this.OnBeginRowEditing="";this.OnEndRowEditing="";this.OnCancelRowEditing="";this.OnInitializeCustomEditor="";this.OnColumnContextMenu="";this.OnExportContextMenu="";this.OnBatchUpdateError="";this.OnColumnAction="";this.OnComboItemCheck=""}function ColumnSetSettings(){this._Type="ColumnSetSettings";ISObject.call(this);this.ShowHeaders="Default";this.RowCount=2;this.GridLines="None";this.GridLineColor="";this.GridLineStyle="NotSet"}function FocusStyle(){this._Type="FocusStyle";ISObject.call(this);this.BorderStyle="NotSet";this.BorderWidth=null;this.BorderColor="";this.CssClass="";this.GetStyleText=function(){var a=this.BorderStyle;if(a=="NotSet"){a=""}a=a.toLowerCase();if(this.CssClass==""){if(this.BorderColor==""){this.BorderColor="transparent"}if(this.BorderWidth==null){this.BorderWidth="0"}if(this.BorderStyle=="NotSet"){this.BorderStyle="none"}return"border: "+this.BorderColor+" "+this.BorderWidth+"px "+a}else{var b=IS.GetCssObject(null,this.CssClass);if(b){if(b.borderColor==""){b.borderColor="transparent"}if(b.borderWidth==""){b.borderWidth="0"}if(b.borderStyle==""){b.borderStyle="none"}return"border: "+b.borderLeftColor+" "+b.borderLeftWidth+" "+b.borderLeftStyle}else{return""}}}}function GroupByBoxObject(){this._Type="GroupByBoxObject";ISObject.call(this);this.InfoText="Drag a column header here to group by that column.";this.ConnectorLineColor="White";this.ConnectorLineStyle="Solid";this.ContextMenu=true}function WebGridImageSettings(){this._Type="ImageSettings";ISObject.call(this);if(IS_ReleaseType=="Beta"){this.Folder="/CommonLibraryBeta/Images/"}else{this.Folder="/CommonLibrary/Images/"}this.CollapseImage="wg_minus.gif";this.ExpandImage="wg_plus.gif";this.FilterImage="wg_filter.gif";this.NewRowImage="wg_newrow.gif";this.SortAscImage="";this.SortDescImage="";this.InProgressImage="wg5_progress_std.gif";this.EditImage="wg_edit.gif";this.GotoImage="wg_goto.gif";this.CurrentRowImage="wg_currow.gif";this.ColumnPointerImage="wg_colptr.gif";this.MoreDataImage="wg5_more.gif";this.RefreshImage="wg5_refresh.gif";this.ExportImage="wg5_export.gif";this.PreviewRowCollapseImage="wg_prcol.gif";this.PreviewRowExpandImage="wg_prexp.gif";this.HelpImage="wg5_help.gif";this.FilteredImage="wg5_filtered.gif";this.UnfilteredImage="wg5_unfiltered.gif";this.RequiredImage="wg5_required.gif";this.SuccessImage="wg5_success.gif";this.WarningImage="wg5_warning.gif";this.FailedImage="wg5_failed.gif";this.ReadOnlyImage="wg5_locked.gif";this.SliderThumbImage="wg5_sliderthumb.gif";this.AddedRowIndicator="wg7_added.gif";this.ModifiedRowIndicator="wg7_edited.gif";this.DeletedRowIndicator="wg7_deleted.gif";this.PendingChangesImage="wg7_reviewchanges.gif";this.ColumnActionImage="wg7_options.gif";this.StatusBarSeparatorImage="wg5_sep_std.gif"}function WebGridLayoutSet(){this._Type="LayoutSet";ISObject.call(this);this.VirtualLoadMode="Default";this.AllowContextMenu=true;this.Culture=null;this.EditOnClick=false;this.EditFocusCellStyle=null;this.EditTextboxStyle=null;this.ButtonStyle=null;this.AllowGrouping="No";this.VirtualPageSize=50;this.ClientSideEvents=new WebGridClientEvents();this.SizeHeightBy=0;this.SizeWidthBy=0;this.AllowAddNew="No";this.AllowColumnSizing="Yes";this.AllowColumnMove="No";this.AllowEdit="No";this.MenuCssFile="ISMenu.css";this.AllowDelete="No";this.AllowFilter="No";this.AllowSelectColumns="No";this.AllowSorting="No";this.AutoWidth=false;this.AutoHeight=false;this.AlternatingColors=true;this.CellClickAction="RowSelect";this.PagingMode="None";this.CellPaddingDefault=4;this.CellSpacingDefault=0;this.ColumnHeaders="Yes";this.ColumnFooters="No";this.GridLines="Both";this.GridLineColor=null;this.GridLineStyle=null;this.HeaderClickAction="SortSingle";this.GroupByBoxVisible=false;this.GroupByBox=new GroupByBoxObject();this.GroupRowInfoFormatDefault="[caption]: [value]";this.GroupRowInfoStyle=null;this.AlternatingRowStyle=null;this.RowHeaders="Yes";this.FocusCellStyle=new FocusStyle();this.Hierarchical=false;this.ImageSettings=new WebGridImageSettings();this.RowHeaderWidth=18;this.RowHeightDefault=20;this.HideColumnsWhenGrouped="Yes";this.Grid=null;this.StatusBarVisible=true;if(IS_ReleaseType=="Beta"){this.ScriptDirectory="/CommonLibraryBeta/WebGrid/V9_0_7200/"}else{if(IS_ReleaseType=="Debug"){this.ScriptDirectory="/CommonLibraryTemp/WebGrid/V9_0_7200/"}else{this.ScriptDirectory="/CommonLibrary/WebGrid/V9_0_7200/"}}this.AlwaysShowHelpButton=true;this.NewRowLostFocusAction="NeverUpdate";this.RowLostFocusAction="AlwaysUpdate";this.TextSettings=new WebGridTextSettings();this.AllowExport="No";this.AllowPrint="No";this.ChildRowEmptyAction="ShowChildContent";this.AlwaysUseCachedDataOnFirstLoad=false;this.CustomFilterString="";this.ResetNewRowValuesOnError=true;this.InProgressUIBehavior="DisplayMessageBox";this.ColumnSetHeaders="Yes";this.PreviewRowStyle=null;this.LostFocusRowStyle=null;this.CheckedRowStyle=null;this.FilterRowStyle=null;this.QuickFilterBarStyle=null;this.SortedColumnStyle=null;this.RowHeaderStyle=null;this.TreeLines=true;this.ChildTableSpacing=4;this.HyperlinkStyle=null;this.ShowRefreshButton=true;this.AutoFitColumns=false;this.AutoFitColumnsBuffering=true;this.FilterBarVisible=true;this.ClientVisible=true;this.AutoColMinWidth=100;this.ScrollBarStyle=null;this.PromptBeforeDelete=false;this.ApplyFiltersKey="ShiftEnter";this.SelectedRowClass="";this.CheckedRowClass="";this.TextBoxClass="";this.StatusBarCommandStyle=null;this.HelpURL="";this.PersistRowChecker=false;this.UseRelativePositioning=true;this.AllowColumnFreezing="No";this.FreezePaneSettings=new WebGridFreezePaneSettings();this.AutoFilterSuggestion=false;this.RowHighlightType="EntireRow";this.ShowFilterStatus=false;this.VerboseEditingInformation=false;this.DisplayDetailsOnUnhandledError=true;this.RowChangedAction="None";this.FocusNewRowOnLastCell=false;this.PagingSize=25;this.PagingStyleUI="FirstPrevNextLast";this.PagingDetectPartialGroupRows=false;this.PagingSliderWidth=120;this.PagingLatencyOnSlide=500;this.InitialView="GridView";this.ChartDisplayPosition="Top";this.ChartCustomContainerId="";this.MarkDefaultValuesAsDirty=true;this.AllowMultipleSelection="No";this.RestoreRowSelection="Disabled";this.ContextMenuAnimation=true;this.RestoreExpandedChildRows=false;this.AllowBatchUpdate=false;this.BatchUpdateSettings=null;this.AddedRowStyle=null;this.ModifiedRowStyle=null;this.DeletedRowStyle=null;this.SelectFirstCellOnAdd=false;this.AlternatingRowClass="";this.GroupRowInfoClass="";this.FooterClass="";this.RowClass="";this.PersistValueListOnCopy=false;this.ShowColumnAction=false;this.GroupRowHeight="";this.OnPropertiesInitialized=function(){if(this.AllowBatchUpdate){this.BatchUpdateSettings=new WebGridBatchUpdateSettings()}}}function PreviewRowSettings(){this._Type="PreviewRowSettings";ISObject.call(this);this.Style=null;this.Indentation=18;this.Height=null;this.DataMember="";this.Expandable=true;this.DefaultExpanded=true;this.LoadOnDemand=false}function SelfReferencingSettings(){this._Type="SelfReferencingSettings";ISObject.call(this);this.Enabled=false;this.FitColumnOnExpand=false;this.ChildDataMember="";this.ParentDataMember="";this.Table=null;this.ExpandColumnMember="";this.ParentRootMode="UseParentRootValue";this.ParentRootValue=null;this.TreatOrphanRecordsAsRoot=true;this.LoadOnDemand=false;this.IsTreeViewSelectionMode=false;this.ExpandColumnInnerTextPadding=0}function WebGridTextSettings(){this._Type="TextSettings";ISObject.call(this);this.LocalizationFolder="/CommonLibrary/WebGrid/V9_0_7200/Localization/";if(IS_ReleaseType=="Beta"){this.LocalizationFolder="/CommonLibraryBeta/WebGrid/V9_0_7200/Localization/"}this.Language="UseDefault";this.UseLanguage="";this.TextItems=new ISArray()}function WebGridCell(a){this._Type="WebGridCell";ISObject.call(this);this.Position=0;this.Text="";this.CustomAttributes="";this.CustomObjectAttributes="";this.Tag="";this.Value=null;this.Column=null;this.DataChanged=false;this.Image="";this.TooltipText="";this.ForceNoEdit=false;this.Name="";this._UIState="Unchanged";this.CellElement=null;this.Row=a;this.Table=null;this.SubTable=null;this.Grid=null;this.IsPrimaryKey=false;this.IsForeignKey=false;this.Modified=false;this.OldValue="";this.OldText="";this.ContentMode="Text";this.ButtonImage="";this.GetImage=function(){if(this.Image==""){if(!this.Column.Table.Grid.IsClientBinding()){if(this.Column.Bound){return this.Text}else{return this.Column.CellImage}}else{return this.Column.CellImage}}else{return this.Image}}}var pCell=WebGridCell.prototype;pCell.GetRow=function(){if(this.Row!=null){return this.Row}else{return wgGetRowByElement(WG50Engine.GetTR(this.GetElement()))}};pCell.Setup=function(h){if(h!=null){WG50Engine.EmulateAttributes(h)}if(h==null){return}this.CellElement=h;this.Table=this.Row.Table;this.SubTable=this.Row.SubTable;this.Grid=this.Table.Grid;var b=WG50Engine.GetColumnNameByCell(this.Table,h);this.Column=this.Table.GetColumn(b);this.Name=b;if(h.contentMode){this.ContentMode=h.contentMode}var i=h.innerText;var g=this.RowElement;if(IS.safari||IS.chrome){i=h.textContent}if(this.ContentMode=="HTML"){var a=WGEventEngine.GetContentSpan(h);if(a){i=a.innerHTML}else{i=h.innerHTML}if(i!=""){var f=new RegExp("\r\n","g");i=i.replace(f,"")}}if(WG50Engine.IsWhitespace(i)){i=""}if(this.Column.ColumnType=="ImageAndText"&&i!=null&&WG50Engine.IsWhitespace(i.substring(0,1))){i=i.substring(1)}this.Text=i;if(this.Column.ColumnType=="ImageAndText"){var a=WGEventEngine.GetContentSpan(h);if(a&&a.children.length>0){if(a.children[0].tagName=="SPAN"){this.Image=a.children[0].children[0].src}else{if(a.children[0].tagName=="IMG"){this.Image=a.children[0].src}}}}if(this.Column.ColumnType!="CheckBox"){if(h.cellValue){this.Value=h.cellValue}else{this.Value=this.Text}if(typeof(this.Value)=="string"&&this.Column.DataType=="System.DateTime"){try{this.Value=new Date(this.Value)}catch(c){}}}else{this.Value=h.cellValue;if(typeof(this.Value)!="boolean"&&h.children.length>0){this.Value=h.children[0].checked}}if(g!=null&&wgIsNewRow(g)){if(this.Value==" "){this.Value=""}if(this.Text==" "){this.Text=""}}if(h.noEdit){this.ForceNoEdit=true}if(h.cellModified){this.Modified=true}var d=(h.oldCellValue!=""&&typeof(h.oldCellValue)!="undefined");this.OldText=(h.oldText?h.oldText:"");this.OldValue=(d?h.oldCellValue:"");this.DataChanged=(h.cellModified==true||(d&&this.Value!=this.OldValue))};pCell.SetDataChanged=function(){this.DataChanged=this.Modified=true;this.CellElement.cellModified=true};pCell.Synchronize=function(){this.Setup(this.CellElement)};pCell.GetElement=function(){return this.CellElement};pCell.GetParentKeyName=function(){return(this.Column.ParentKeyName||this.Column.Name)};pCell.IsForeignColumn=function(c){if(this.SubTable){if(!c){c=this.SubTable.GetConstraintXml()}var b=ISXml.GetNodes(c,"//DataColumn");for(var a=0;a<b.length;a++){if(ISXml.GetAttribute(b[a],"name")==this.GetParentKeyName()){return true}}}return false};pCell.IsActive=function(){if(this.Grid.ActiveEditCell){if(this.Grid.ActiveEditCell.rowElement==this.CellElement){return true}}return false};pCell.ActivateEdit=function(){this.Select();this.Grid.ActivateEditMode()};pCell.GetParentKeyValue=function(a){if(this.IsForeignColumn(a)){if(!a){a=this.SubTable.GetConstraintXml()}return ISXml.GetNodeText(a,"//DataColumn[@name='"+this.GetParentKeyName()+"']")}return null};pCell.SetImage=function(a){this.Image=a;var b=this.GetElement().childNodes[0].childNodes[0];if(b!=null){if(b.tagName!="IMG"){b=b.children[0]}b.src=a}};pCell.SetCustomContent=function(a){this.GetElement().innerHTML=a};pCell.SetText=function(j,k,g){if(this.Column.IsRowChecker||(this.Column.EditType=="NoEdit"&&!g)){return}if(this.OldText==""||this.OldText==null){this.OldText=this.Text}this.Text=j;if(k){this.SetValue(j)}if(this.Row._UIState!="Added"&&this.Column.ColumnType!="Template"){var b=this.CellElement;var f=b.innerHTML.toLowerCase().indexOf("nobr")>0;var c=WGEventEngine.GetContentSpan(b);var h="";if(c){f=c.innerHTML.toLowerCase().indexOf("nobr")>0}if(this.Column.ColumnType=="ImageAndText"&&this.Row.Type=="Record"){try{h=b.childNodes[0].childNodes[0].outerHTML}catch(d){}}var i=(f?"<NOBR>":"")+h+(j==""?"&nbsp;":_FixAmpChar(j))+(f?"</NOBR>":"");if(this.Column.ColumnType=="CheckBox"){var a=false;j=j.replace("\n","");if(typeof(j)=="string"&&j.toLowerCase()=="true"){a=true}if(typeof(j)=="boolean"&&j==true){a=true}b.cellValue=a;b.children[0].checked=a}else{if(c){c.innerHTML=i}else{b.innerHTML=i}}b.oldText=this.OldText;b.cellModified=true}this.DataChanged=true;this.Row.SetDataChanged()};pCell.SetValue=function(b,a){if(this.OldValue==""||this.OldValue==null){if(this.Value!=""&&this.Value!=null){this.OldValue=this.Value}else{this.OldValue=this.OldText}}this.Value=b;this.Modified=true;if(this.Row._UIState!="Added"){if(a){if(this.Column.ColumnType=="CheckBox"){if(b==true||b=="true"||b=="True"){this.CellElement.children[0].checked=b}}}this.CellElement.oldCellValue=this.OldValue;this.CellElement.cellValue=b;this.CellElement.cellModified=true}this.Row.SetDataChanged()};pCell.SetForceNoEdit=function(a){if(typeof(a)=="undefined"){a=true}if(a){this.ForceNoEdit=true;this.CellElement.noEdit="True"}else{this.ForceNoEdit=false;this.CellElement.removeAttribute("noEdit")}if(this.Column.ColumnType=="CheckBox"){this.GetElement().children[0].disabled=a}};pCell.Select=function(d,g){if(!d){WGEditEngine.HighlightEditCell(this.CellElement)}else{var h=this.Column.Table;var b=h.Grid;var e=h.GetSelRowStyle();var a=h.GetFocusCellStyle();var f=b.GetSelectedObject();if(f==null||f.GetRowElement()==null||(!wgIsSameRow(f.GetRowElement(),this.Row.GetElement()))){var c=b.ResolveImagePathEx(b.LayoutSettings.ImageSettings.CurrentRowImage);WGEventEngine.SelectRow(this.Row.GetElement(),c)}WGEventEngine.HighlightCell(this.CellElement,e,a,"",g);WGEventEngine.EnsureCellVisible(b,this.CellElement)}};pCell.ToXml=function(){if(this.DataChanged){if(this.SubTable){var a=this.SubTable.GetConstraintXml();if(this.IsForeignColumn(a)){var c=this.GetParentKeyValue(a);if(c){this.Text=this.Value=c}}}var b=this.OldText;if(b!=""){b=b.replace(/<BR>/g,"\n")}var e=this.Value;if(typeof(e)=="boolean"){e=(e)?"True":"False"}if(this.Modified&&this.Column!=null&&this.Column.DataType=="System.Boolean"&&e==""){e="False"}var d="<cell ";d+="modified='"+this.Modified+"' colName='"+ISXml.EncodeStringValueText(this.Column.Name)+"'>";d+="<text>"+ISXml.EncodeStringValueText(this.Text)+"</text>";d+="<value>"+ISXml.EncodeStringValueText(e)+"</value>";d+="<oldtext>"+ISXml.EncodeStringValueText(b)+"</oldtext>";d+="<oldvalue>"+ISXml.EncodeStringValueText(this.OldValue)+"</oldvalue>";d+="</cell>";return d}return""};pCell.GetAttribute=function(b){var c=this.GetElement();var a=c.attributes[b];if(a!=null){return a.value}return""};pCell.IsEditable=function(){return WG50Engine.IsCellEditable(this.Column,this.GetElement())};pCell=null;function WebValueList(){this._Type="WebValueList";ISObject.call(this);this.DataTextField="";this.DataValueField="";this.DataMember="";this.DataRetrieved=false;this.IsValid=function(){if(this.DataTextField==""){return false}return true}}function WebGridColumn(){this._Type="WebGridColumn";ISObject.call(this);this.WebComboID="";this.Name="";this.Table=null;this.AggregateFunction="None";this.ButtonText="";this.AllowGrouping="Default";this.AllowSizing="Default";this.AllowSorting="Default";this.Bound=true;this.DataMember="";this.DefaultValue="";this.Caption="";this.GroupEmptyString="(none)";this.GroupRowValueFormatString="";this.GroupRowInfoFormat="";this.EditType="TextBox";this.GroupInterval="Value";this.HeaderImage="";this.ColumnType="Text";this.HeaderTooltip="";this.CellImage="";this.NullText="";this.ShowInSelectColumns="Yes";this.IsGrouped=false;this.IsSorted=false;this.Position=0;this.SortKeyField="";this.FilterKeyField="";this.SortOrder="None";this.Visible=true;this.DefaultVisible=true;this.Width=100;this.DataType="System.String";this.TextboxMaxlength=0;this.FooterText="";this.FilterText="";this.FilterType="NotSet";this.AllowMultiLine=false;this.DataFormatString="";this.DefaultText="";this.IsRowChecker=false;this.IsAutoWidth=false;this.FilterEditType="SameAsEditType";this.HyperlinkTarget="Blank";this.ButtonAutoPostback=false;this.ButtonPostbackMode="OnTheFly";this.HiddenDataMember="";this.MaxHeight=null;this.ImageFormatString="";this.HyperlinkDisplayText="";this.HyperlinkFormatString="";this.CustomEditorName="";this.CustomEditorServerId="";this.CustomEditorServerID="";this.CustomEditorProperties="";this.ForceVisible=false;this.AltElement=null;this.IsFrozen=false;this.HiddenFromView=false;this.HiddenReason="";this.ColGroupElement=null;this.ColGroupHeaderElement=null;this.ColGroupFooterElement=null;this.NewRowEditType="SameAsEditType";this.UseValueListForSorting="Default";this.HasValueList=false;this.InputRequired=false;this.InputRequiredErrorText="";this.EditInfoText="";this.EditInfoImage="";this.ShowInChartFieldList=true;this.CanAddToChartSeries=true;this.CanAddToChartFilter=true;this.CanAddToChartCategories=true;this.CanAddToChartData=true;this.TreatMarkupAsLiteralText=false;this.DefaultFilterType="NotSet";this.IsAutoIncrement=false;this.CellClass="";this.ButtonImage="";this.ValueList=new WebValueList();this.ParentKeyName="";this.PreserveWhitespace=false;this.ClipboardCopyMode="Text";this.UseValueListForFilter="Default";this.CellTemplate="";this.OnPropertiesInitialized=function(b){if(b=="OnInitialize"){this.Table=this.Parent;this.DefaultVisible=this.Visible;if(this.Table.Grid.BindingOperationMode=="ClientBinding"&&this.ColumnType=="Template"){var a=ISXml.GetNode(this.XmlNode,"ClientCellTemplate");if(a!=null){this.CellTemplate=a.text;this.XmlNode.removeChild(a)}}}};this.GetDefault=function(a){if(this[a]=="Default"){if(a=="AllowSizing"){a="AllowColumnSizing"}return this.Table.GetDefault(a)}else{return this[a]}};this.__getter=function(a){switch(a){case"AllowSorting":case"AllowGrouping":case"AllowSizing":case"UseValueListForSorting":case"UseValueListForFilter":return this.GetDefault(a);break}};this.__setter=function(d,f,a){switch(d){case"Width":var c=null;try{c=this.GetElement()}catch(b){}if(c){WGUIEngine.ResizeColumn(this.Table,c,f)}break}};this.GetGrid=function(){return this.Table.GetGrid()};this.GetElement=function(f){if(!this.Table.IsRootTable&&!f){if(this.GetGrid().HeaderContext!=null){f=WG50Engine.GetTR(this.GetGrid().HeaderContext)}if(!f){try{f=this.Table.SubTableIds[0].GetElement(WG40.COLHEADER,WG40.HTMLTABLE)}catch(b){}}}var h=this.Table.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,f);if(h){var c=h.rows[0];if(this.Table.IsUseColumnSet){var d=this.Table.GetRowLayoutByColName(this.Name);var g=d.Row;if(this.Table.IsColumnSetHeaderVisible()){g++}c=h.rows[g]}var a=wgGetCellByName(c,this.Name);if(!a&&this.AltElement){return this.AltElement}return a}return null};this.Resize=function(c){var a=this.GetElement();if(!a){return}var b=a.parentElement;WGUIEngine.ResizeColumn(this.Table,a,c,!this.Table.IsRootTable,true);if(!this.Table.IsUseColumnSet){WGUIEngine.ReorderColumn(this.Table,b)}WGUIEngine.FitColumns(this.Table,"Resize",a,c)};this.ResizeBestFit=function(){WGUIEngine.ResizeBestFit(this.GetElement())};this.GetFilterEditType=function(){var a=this.FilterEditType;if(a=="SameAsEditType"){a=this.EditType}return a};this.GetWidth=function(){var a=this.GetElement();if(a&&a.style.display=="none"){return parseFloat(this.Width)}if(a&&a.offsetWidth>0){return a.offsetWidth}else{return parseFloat(this.Width)}};this.HideFromView=function(o,n){var b=this.GetElement();var r=this.Table;var c=r.GetElement(WG40.COLGROUP,WG40.HTMLTABLE);if(b==null){return}var d=WG50Engine.GetRealCellIndex(b);if(!n){n=new WebGridPartOption(true)}if(n.Header&&!r.Grid.EnableSection508Standards){b.style.display="none";if(!IS.ie){var j=r.GetElement(WG40.COLHEADERGROUP);if(j!=null){this.ColGroupHeaderElement=j.removeChild(j.children[this.GetViewVisiblePosition()])}}}if(n.Body){if(IS.ie&&!IS.IsXHTMLDocType()){c.children[d].style.display="none"}else{var s=r.GetElement(WG40.BODY,WG40.HTMLTABLE);var q=s.rows;this.ColGroupElement=c.removeChild(c.children[this.GetViewVisiblePosition()]);for(var k=0;k<q.length;k++){var p=q[k];WG50Engine.EmulateAttributes(p);if(wgIsRecordRow(p)||p.type=="GroupTotalRow"){p.cells[d].style.display="none"}}}}if(n.Footer){if(r.Get("ColumnFooters")=="Yes"){var f=r.GetElement(WG40.COLFOOTERGROUP,null);if(IS.ie&&!IS.IsXHTMLDocType()){f.children[d].style.display="none"}else{var g=this.GetViewVisiblePosition();var h=r.GetElement(WG40.COLFOOTER,WG40.HTMLTABLE);var a=h.rows[1].cells[d].style;this.ColGroupFooterElement=f.removeChild(f.children[g]);a.visibility="hidden";a.display="none"}}}if(n.FilterBar&&!r.Grid.EnableSection508Standards){if(r.Get("AllowFilter")=="Yes"){var p=r.GetFilterRow();if(p){var e=p.cells[d];e.style.display="none"}}}if(n.AddNewRow&&!r.Grid.EnableSection508Standards){if(r.Get("AllowAddNew")=="Yes"){var m=r.GetNewRow();if(m&&m.cells.length>d){var l=m.cells[d];l.style.display="none"}}}this.HiddenFromView=true;this.HiddenReason=o};this.HideFrozen=function(a){this.HideFromView("FreezePaneScroll",a)};this.Show=function(m){var b=this.GetElement();var p=this.Table;var c=p.GetElement(WG40.COLGROUP,WG40.HTMLTABLE);var d=WG50Engine.GetRealCellIndex(b);this.HiddenFromView=false;this.HiddenReason="";if(!m){m=new WebGridPartOption(true)}if(m.Header){b.style.display="";if(!IS.ie){var h=p.GetElement(WG40.COLHEADERGROUP);if(h!=null&&this.ColGroupHeaderElement!=null){h.insertBefore(this.ColGroupHeaderElement,h.children[this.GetViewVisiblePosition()])}}}if(m.Body){if(IS.ie&&!IS.IsXHTMLDocType()){c.children[d].style.display=""}else{var q=p.GetElement(WG40.BODY,WG40.HTMLTABLE);var o=q.rows;c.insertBefore(this.ColGroupElement,c.children[this.GetViewVisiblePosition()]);for(var j=0;j<o.length;j++){var n=o[j];WG50Engine.EmulateAttributes(n);if(wgIsRecordRow(n)||n.type=="GroupTotalRow"){n.cells[d].style.display=""}}if(IS.ie){q.style.display="none";q.style.display=""}}}if(m.Footer){if(p.Get("ColumnFooters")=="Yes"){var f=p.GetElement(WG40.COLFOOTERGROUP,null);if(IS.ie&&!IS.IsXHTMLDocType()){f.children[d].style.display=""}else{f.insertBefore(this.ColGroupFooterElement,f.children[this.GetViewVisiblePosition()]);var g=p.GetElement(WG40.COLFOOTER,WG40.HTMLTABLE);var a=g.rows[1].cells[d].style;a.visibility="visible";a.display=""}}}if(m.FilterBar){if(p.Get("AllowFilter")=="Yes"){var n=p.GetFilterRow();if(n){var e=n.cells[d];e.style.display=""}}}if(m.AddNewRow){if(p.Get("AllowAddNew")=="Yes"){var l=p.GetNewRow();if(l&&l.cells.length>d){var k=l.cells[d];k.style.display=""}}}};this.GetViewPosition=function(){var h=this.Table;var c=h.Grid;if(c.FreezePaneActive){var b=h.Columns;var f=c.GetLastFrozenColumn().Position;var g=WG50Engine.GetPreviousVisibleColumn(h,c.GetLastFrozenColumn());var a=0;var e=0;if(g!=null){e=g.GetElement().cellIndex}if(h.Get("RowHeaders")=="Yes"){a++}a+=h.GroupedColumns.length;for(var d=f;d<this.Position;d++){if(!b[d].HiddenFromView&&b[d].Visible){e++}}if(this.Position<f){return this.GetElement().cellIndex}else{if(this.Position==f){if(this.HiddenFromView){return -1}else{return e+a}}}return e+a}else{if(this.GetElement()!=null){return this.GetElement().cellIndex}else{return -1}}};this.GetViewVisiblePosition=function(){var d=this.Table.Grid;var f=d.GetLastFrozenColumn().Position;var g=this.GetViewPosition();var c=0;for(var e=0;e<f;e++){var b=this.Table.Columns[e];if(!b.Visible&&b.Position>f){c++}}for(var e=f;e<g;e++){var a=this.Table.Columns[e];if(!a.Visible){c++}}return g-c};this.IsOutsideScrollView=function(){var b=this.GetScrollWidth();var a=this.Table.Grid.GetFreezeOuterDivElement();return(b>a.offsetWidth)};this.GetScrollWidth=function(){var c=this.Table.Grid;var b=c.GetFreezeOuterDivElement();var e=0;for(var d=0;d<=this.Position;d++){var a=this.Table.Columns[d];if(!a.HiddenFromView){e+=a.GetWidth()}}return e};this.GetNewRowEditType=function(){var a=this.NewRowEditType;if(a=="SameAsEditType"){a=this.EditType}return a};this.IsPrimaryKey=function(){var a=","+this.Table.DataKeyFields;if(a.indexOf(","+this.Name)>-1){return true}return false};this.ShowContextMenu=function(c){var a=this.GetElement(c);var b=new OffsetLocation(ISPosLib.getLeft(a),ISPosLib.getBottom(a));WGUIEngine.ProcessContextMenu(a,null,b)}}function WebGridPartOption(a){this.Header=false;this.ColHeaderGroup=false;this.Body=false;this.ColFooterGroup=false;this.Footer=false;this.AddNewRow=false;this.FilterBar=false;if(a){this.Header=this.ColHeaderGroup=this.Body=this.ColFooterGroup=this.Footer=this.AddNewRow=this.FilterBar=true}}function WebGridColumnSet(){this._Type="WebGridColumnSet";ISObject.call(this);this.Position=0;this.Caption="";this.CaptionImage="";this.ColumnCount=3;this.HeaderStyle=null;this.Visible=true;this.Width=null;this.AllowSizing="Yes";this.Name="";this.Layout=new ISArray();this.GetRowLayout=function(c,a){for(var b=0;b<this.Layout.length;b++){if(this.Layout[b].Row==c&&this.Layout[b].Col==a){return this.Layout[b]}}return null}}function WebGridCustomEditor(){this._Type="WebGridCustomEditor";ISObject.call(this);this.Name="";this.Index=0;this.ControlType="ServerControl";this.Persistence="GridLevel";this.JavascriptFiles="";this.JavascriptEncoded=false;this.ScriptFolder="";this.Behavior=new WebGridCustomEditorBehavior();this.ServerControlFullName="";this.DependencyFiles="";this.DependencyFolder="";this.Grid=null;this.DDObj=null;this.BaseEditorType="";this.HasDropdownButton=false;this.DropdownButtonWidth=16;this.DropdownButtonImageFile="";this.DropdownButtonType="Image";this.Tag="";this.ImplementationObject=null;this.baseEditor=null;this.OnPropertiesInitialized=function(){this.Grid=this.Parent;this.ScriptFolder=this.Grid.LayoutSettings.ScriptDirectory+"CustomEditors/"+this.ScriptFolder+"/";try{this.ImplementationObject=eval("new "+this.Name+"_Editor()")}catch(e){alert("Can't find implementation object for CustomEditor '"+this.Name+"'")}if(this.ImplementationObject!=null){this.ImplementationObject.Grid=this.Grid;this.ImplementationObject.CustomEditor=this;this.ImplementationObject.OnInitialize();ISEvent.Raise(this.Grid.LayoutSettings.ClientSideEvents.OnInitializeCustomEditor,this.Grid.Name,this.Name,this.ImplementationObject,this)}}}function WebGridCustomEditorBehavior(){this._Type="WebGridCustomEditorBehavior";ISObject.call(this);this.BaseEditorType="Textbox";this.HasDropdownButton=false;this.DropdownButtonWidth=16;this.DropdownButtonImageFile="";this.DropdownButtonType="Image";this.SupportElegantStyles=false;this.Tag="";this.OnPropertiesInitialized=function(){this.Parent.BaseEditorType=this.BaseEditorType;this.Parent.HasDropdownButton=this.HasDropdownButton;this.Parent.DropdownButtonWidth=this.DropdownButtonWidth;this.Parent.DropdownButtonImageFile=this.DropdownButtonImageFile;this.Parent.DropdownButtonType=this.DropdownButtonType}}function WebGridFilter(){this._Type="WebGridFilter";this._UIState="Unchanged";ISObject.call(this);this.FilterText="";this.FilterType="NotSet";this.Index=0;this.ColumnMember="";this.Table=null;this.Name="";this.FilterDisplayText="";this.FilterDateText=null;this.UseAdvancedFilter=false;this.AdvancedFilterKey="";this.AdvancedFilterExpression="";this.OnPropertiesInitialized=function(){this.Name=this.ColumnMember;this.Table=this.Parent;if(this.XmlNode!=null){this.FilterText=ISXml.GetNodeText(this.XmlNode,"FilterText")}};this.GetElementType=function(a){switch(a){case"FilterText":return"CDATA";default:return"Attribute"}};this.GetElement=function(){var a=this.Table.GetFilterRow();if(a){return wgGetCellByName(a,this.Name)}return null};this.GetTextElement=function(){var a=this.GetElement();if(a!=null){if(a.children[0].tagName=="SPAN"){return a.children[0]}else{return a.children[0].children[0]}}return null};this.GetImageElement=function(){var a=this.GetElement();if(a.children[0].tagName=="SPAN"){return a.children[1]}else{return a.children[0].children[1]}}}function WebGridFormatCondition(){this._Type="WebGridFormatCondition";ISObject.call(this);this.Name="";this.Index=0;this.ColumnMember="";this.Operator="EqualTo";this.Enabled=true;this.ConditionText="";this.CustomConditionText="";this.FormatStyle=null;this.TargetObject="Row";this.TargetColumnMember="";this.Column=null;this.TargetColumn=null;this.Collection=new ISArray()}function WebGridGroup(){this._Type="WebGridGroup";this._UIState="Unchanged";ISObject.call(this);this.GroupInterval="Default";this.GroupMode="Default";this.GroupRowValueFormatString="";this.SortOrder="None";this.Index=0;this.ColumnMember="";this.Table=null;this.Name="";this.Column=null;this.OnPropertiesInitialized=function(){this.Name=this.ColumnMember;this.Table=this.Parent;this.Column=this.Table.Columns.GetNamedItem(this.Name)};this.GetElement=function(){var d=WGUIEngine.GetGroupByBoxRow(this.Table.Grid.Id,this.Table.Name);var b=this.Table.Grid;if(d){var a=d.childNodes[0].childNodes[0].childNodes[0].childNodes[0];for(var c=0;c<a.cells.length;c++){WG50Engine.EmulateAttributes(a.cells[c]);if(a.cells[c].colName==this.ColumnMember&&a.cells[c].type=="GroupColumn"){return a.cells[c]}}}return null};this.GetGroupMode=function(){if(this.GroupMode=="Default"){return this.Table.GroupMode}else{return this.GroupMode}};this.GetGroupRowValueFormatString=function(){if(this.GroupRowValueFormatString==""){return this.Column.GroupRowValueFormatString}else{return this.GroupRowValueFormatString}}}function WebGridRow(b,a){this._Type="WebGridRow";ISObject.call(this);this.Table=b;this.SubTable=a;this.ParentTableRow=null;this.ParentRow=null;this.KeyValues=null;this.Cells=null;this.Children=null;this.SelfRefChildren=null;this.ChildrenLoaded=false;this.DataSourceIndex=0;this.ChildNotExpandable=false;this.Expanded=false;this.Grid=null;this.Parent=null;this.Position=0;this.Selected=false;this.Visible=true;this.Height=null;this.Type="Record";this.DataChanged=false;this.KeyValue=null;this.ForceNoEdit=false;this.Checked=false;this.Name="";this._UIState="Unchanged";this.Grid=null;this.GroupRowText="";this.ParentConstraints="";this.RowElement=null;this.ParentPos="";this.TblSubId=null;this.GroupExpanded=false;this.ChildExpanded=false;this.PreviewRowExpanded=false;this.ChildrenLoaded=false;this.IsSelfRefRow=false;this.SelfRefExpanded=false;this.SelfRefLevel=0;this.SelfRefChildCount=0;this.SelfRefParentValue=null;this.RelNames=null;this.DataRow=null;this.DataSourceIndex=-1;this.PreviewRowValue="";this.Group=null;this.UngroupedRows=null;this.ForceExpGroup=false;this.Style=null;this.ParentCollection=null;this.Tag=null;this.GroupTotalRendered=false}var pRow=WebGridRow.prototype;pRow.Setup=function(a){var d=this.Table;this.RowElement=a;this.Type=a.type;this.Grid=d.Grid;if(a.expanded&&a.expanded=="True"){this.GroupExpanded=true}if(this.Type!="GroupHeader"&&d.ChildTables.length>0){var b=wgGetHierRecord(a);if(b&&b.childrenLoaded&&b.childrenLoaded=="True"){this.ChildrenLoaded=true}}if(a.noEdit&&a.noEdit=="True"){this.ForceNoEdit=true}if(a.keyValue){this.KeyValue=a.keyValue}if(a.childExpanded&&a.childExpanded=="True"){this.ChildExpanded=true;this.ChildrenLoaded=true}if(a.isRowChecked){this.Checked=true}if(a.srLevel){this.SelfRefLevel=parseFloat(a.srLevel);this.IsSelfRefRow=true}if(a.srRC){this.SelfRefRowCount=parseFloat(a.srRC)}if(a.parentValue){this.SelfRefParentValue=a.parentValue}if(a.relNames){this.RelNames=a.relNames}if(d.HasMultiPrimaryKey){this.KeyValues=wgGetKeyValues(this.RowElement)}if(a.srExpanded&&a.srExpanded=="True"){this.SelfRefExpanded=true}if(typeof(a.srRC)!="undefined"){this.SelfRefChildCount=parseFloat(a.srRC)}this.ParentPos=WGUIEngine.GetParentIndex(this.RowElement);if(this.Type=="GroupHeader"){this.GroupRowText=a.innerText}if(this.Table.PreviewRowVisible){var c=WGUIEngine.GetPreviewRowExpandImageCell(a);if(c){if(c.expanded=="True"){this.PreviewRowExpanded=true}}}this.Position=parseFloat(a.position)};pRow.GetParentPos=function(){if(this.ParentPos!=""){return this.ParentPos}this.ParentPos=WGUIEngine.GetParentIndex(this.RowElement);return this.ParentPos};pRow.GetKeyValueString=function(){var a="";if(this.Table.HasMultiPrimaryKey){if(this.KeyValues!=null){a=this.KeyValues.join("\03")}}else{if(this.KeyValue!=null){a=this.KeyValue.toString()}}return a};pRow.IsSelected=function(){if(this.Grid.LastSelObj!=null){if(this.Grid.LastSelObj.GetRowElement()==this.RowElement){return true}}return false};pRow.GetElement=function(){return this.RowElement};pRow.Synchronize=function(){this.Setup(this.RowElement)};pRow.GetChildren=function(){if(this.Children==null){this.Children=new ISArray();this.Children.ParentRow=this}return this.Children};pRow.GetCells=function(){if((this._UIState=="Added"||this.Table.Grid.BindingOperationMode=="ClientBinding")&&this.Cells!=null){return this.Cells}var a=new ISArray();for(var d=0;d<this.Table.Columns.length;d++){var b=this.GetCell(this.Table.Columns[d].Name);a[a.length]=b}return a};pRow.GetCell=function(f,g){var a=null;var c=(g==true);if(this.Table.Grid.BindingOperationMode=="ClientBinding"&&this.Cells!=null){if(typeof(f)=="string"){a=this.Cells.GetNamedItem(f)}else{a=this.Cells[f]}if(a.CellElement==null){g=true}else{if(!c){return a}}}else{g=true}var e="";var d=-1;var b;if(typeof(f)=="string"){e=f}else{d=f}b=WG50Engine.GetCellEx(this.Table,this.RowElement,(e)?e:d);if(b){if(a==null){a=new WebGridCell(this)}if(g){a.Setup(b)}return a}return null};pRow.ExpandGroupRow=function(){this.GroupExpanded=true;wgExpandGroupRow(this.RowElement)};pRow.CollapseGroupRow=function(){this.GroupExpanded=false;wgCollapseGroupRow(this.RowElement)};pRow.ExpandChildRow=function(a){if(a){this.Grid.XmlHttp.Asynchronous=false}this.ChildExpanded=true;wgExpandChildRow(this.RowElement);this.Grid.XmlHttp.Asynchronous=true};pRow.CollapseChildRow=function(){this.ChildExpanded=false;wgCollapseChildRow(this.RowElement)};pRow.ExpandSelfRefRow=function(){if(!this.IsSelfRefRow){return}this.SelfRefExpanded=true;this.RowElement.srExpanded="False";WGUIEngine.ToggleSelfRefRow(null,this.RowElement,null,true)};pRow.CollapseSelfRefRow=function(){if(!this.IsSelfRefRow){return}this.SelfRefExpanded=false;this.RowElement.srExpanded="True";WGUIEngine.ToggleSelfRefRow(null,this.RowElement,null,true)};pRow.Select=function(a){if(typeof(a)=="undefined"){a=false}if(this.Table.IsRootTable){this.Table.SelectRow(this.RowElement,a)}else{this.SubTable.SelectRow(this.RowElement,a)}};pRow.GetChildRow=function(a,c){if(!this.RowElement){return}if(!c&&this.Table.ChildTables.length==0){return}this.Synchronize();if(!this.ChildrenLoaded){return}if(!c){c=this.Table.ChildTables[0].Name}var b=this.Grid.Tables[c];var d=b.GetSubIdByParentKey(this.RelNames);if(d){return d.GetRow(a)}};pRow.GetChildRows=function(h){if(!this.RowElement){return}if(!h&&this.Table.ChildTables.length==0){return}this.Synchronize();if(!this.ChildrenLoaded){return}if(!h){h=this.Table.ChildTables[0].Name}var g=this.Grid.Tables[h];var j=null;if(typeof(this.RelNames)=="string"){j=g.GetSubIdByParentKey(this.RelNames)}else{var b=wgGetHierRecord(this.RowElement);var f=b.cells[b.cells.length-1].children[0].children[0].children[0].subId;j=g.GetSubIdById(f)}if(j){var e=new Array();var d=j.GetRowsCount();for(var c=0;c<d;c++){var a=j.GetRow(c);if(a!=null){e[e.length]=a}}return e}};pRow.GetParentRow=function(){if(this.SubTable){var a=this.SubTable.GetParentRecordRow();if(this.Table.Parent.IsRootTable){if(this.Table.Parent.GroupedColumns.length>0){return this.Table.Parent.ToRowObject(a)}else{return this.Table.Parent.GetRow(parseFloat(a.position))}}else{var b=this.Table.Parent;var d=b.GetSubTableById(wg_getTableSubId(a));var c=new WebGridRow(b,d);c.Setup(a);return c}}return null};pRow.GetGroupChildRows=function(){var d=new Array();var f=this.RowElement;if(this.Type=="GroupHeader"){var b,c;var e;var a=this.Table;if(!this.Table.IsRootTable){a=this.SubTable}e=a.GetElement(WG40.BODY,WG40.HTMLTABLE);b=wgGetNextRow(e,f);if(b){c=b.type}else{c="GroupHeader"}if(c=="GroupHeader"){while(b&&(b.type=="GroupTotalRow"||(b.hasParent=="True"&&(parseFloat(b.groupIndex)-1==parseFloat(f.groupIndex))&&b.parentIndex==f.position))){d[d.length]=this.Table.ToRowObject(b);b=wgGetNextRow(e,b);while(b&&(b.type=="Record"||b.type=="PR"||b.type=="CSRecord"||(b.type=="GroupTotalRow"&&parseFloat(b.groupIndex)-1>parseFloat(f.groupIndex))||b.type=="HierRecord"||(b.type=="GroupHeader"&&parseFloat(b.groupIndex)-1>parseFloat(f.groupIndex)))){b=wgGetNextRow(e,b)}}}else{if(c=="Record"){while(b&&(b.type=="Record")){d[d.length]=this.Table.ToRowObject(b);b=wgGetNextRow(e,b)}}}return d}return null};pRow.GetNextRow=function(){var a=this.Position+1;if(this.Table.IsRootTable){return this.Table.GetRow(a)}else{return this.SubTable.GetRow(a)}};pRow.GetPreviousRow=function(){var a=this.Position-1;if(a<0){return}if(this.Table.IsRootTable){return this.Table.GetRow(a)}else{return this.SubTable.GetRow(a)}};pRow.Update=function(d){var c=this.Table;var a=c.Grid;if(typeof(wgUpdateRow)=="undefined"){alert("WebGrid_Edit's library is not loaded. Make sure the grid has AllowEdit enabled.");return}if(this._UIState=="Changed"&&a.BindingOperationMode=="ClientBinding"){if(this.Cells!=null){for(var b=0;b<this.Cells.length;b++){this.Cells[b].Setup(this.Cells[b].CellElement)}}}if(a.LayoutSettings.AllowBatchUpdate){if(this._UIState=="Changed"){c.AddPendingChanges("Modified",this.RowElement,true,true)}else{if(this._UIState=="Added"){c.AddPendingChanges("Added",this,true,true)}}return}if(a.IsClientBinding("ClientService")||a.IsClientBinding("Client")){if(a.IsClientBinding("ClientService")){WGServiceEngine.ExecuteCommand(a,this._UIState=="Changed"?"ClientService_Update":"ClientService_Insert",null,this)}return}if(d){this.Grid.XmlHttp.Asynchronous=false}if(this._UIState=="Changed"){wgUpdateRow(this)}else{if(this._UIState=="Added"){wgAddNewRow(this)}}this.Grid.XmlHttp.Asynchronous=true};pRow.Delete=function(c){var b=this.Table;var a=b.Grid;if(typeof(wgDeleteRow)=="undefined"){alert("WebGrid_Edit's library is not loaded. Make sure the grid has AllowEdit enabled.");return}if(a.LayoutSettings.AllowBatchUpdate){b.AddPendingChanges("Deleted",this,true);return}if(a.IsClientBinding("ClientService")||a.IsClientBinding("Client")){if(a.IsClientBinding("ClientService")){WGServiceEngine.ExecuteCommand(a,"ClientService_Delete",null,this)}return}if(c){this.Grid.XmlHttp.Asynchronous=false}wgDeleteRow(this);this.Grid.XmlHttp.Asynchronous=true};pRow.Validate=function(){return WGEditEngine.ValidateRow(this.Grid,this.RowElement)};pRow.IsDirty=function(){return wgIsRowDirty(this.RowElement)};pRow.SetDataChanged=function(){if(this.DataChanged){return}this.DataChanged=true;if(this._UIState=="Unchanged"){this._UIState="Changed";this.RowElement.setAttribute("dataChanged","True");this.RowElement.setAttribute("_UIState","Changed")}};pRow.IsMarkedEdit=function(){return(this.RowElement.markedEdit=="True")};pRow.CancelChanges=function(){return WGEditEngine.CancelChanges(this.RowElement)};pRow.AcceptChanges=function(){return WGEditEngine.AcceptChanges(this.RowElement)};pRow.BeginEdit=function(){return WGEditEngine.ProcessInitialEdit(this.RowElement)};pRow.SetForceNoEdit=function(a){if(typeof(a)=="undefined"){a=true}if(a){this.ForceNoEdit=true;this.RowElement.noEdit="True"}else{this.ForceNoEdit=false;this.RowElement.noEdit="False";this.RowElement.removeAttribute("noEdit")}};pRow.Check=function(){try{WGUIEngine.SetRowCheck(this.RowElement,true)}catch(a){}};pRow.Uncheck=function(){try{WGUIEngine.SetRowCheck(this.RowElement,false)}catch(a){}};pRow.ExpandPreviewRow=function(){if(!this.PreviewRowExpanded){WGUIEngine.TogglePreviewRow(this.RowElement)}};pRow.CollapsePreviewRow=function(){if(this.PreviewRowExpanded){WGUIEngine.TogglePreviewRow(this.RowElement)}};pRow.ToXml=function(){var c="";if(this.Table.HasMultiPrimaryKey){c=ISXml.EncodeString(this.KeyValues)}else{c=ISXml.EncodeString(this.KeyValue)}var d='<row keyValue="'+c+'">';var a=this.Cells;if(a==null){a=this.GetCells()}for(var b=0;b<a.length;b++){if(a[b]){d+=a[b].ToXml()}}d+="</row>";return d};pRow.GetSelfRefChildRows=function(){var f=new Array();var h=this.GetElement();var b=null;var g=this.Table.GetElement(WG40.BODY,WG40.HTMLTABLE,h);if(this.SelfRefChildCount>-1){b=wgGetNextRow(g,h);var d=false;var a=false;var c=false;var i=this.SelfRefLevel;while(b){WG50Engine.EmulateAttributes(b);if(b.type=="GroupHeader"||(b.srLevel==i&&(b.type!="HierRecord"&&b.type!="CSRecord"&&b.type!="PR"))){break}if((!c&&b.srLevel==i+1)){if(b.type=="HierRecord"&&b.expanded!="True"){}else{var e=this.Table.ToRowObject(b);f.push(e)}a=true}else{if(b.srLevel==i){if(a){d=true}}}if(d){break}b=wgGetNextRow(g,b)}}return f};pRow=null;function WebGridRowLayout(){this._Type="WebGridRowLayout";ISObject.call(this);this.Name="";this.Row=0;this.Col=0;this.ColumnMember="";this.Width=100;this.Height=20;this.Spanned="None";this.Column=null;this.RowSpan=1;this.ColSpan=1;this.Collection=new ISArray()}function IWebGridPersistence(){this.Type="IWebGridPersistence";ISObject.call(this);this.Remove=function(){};this.Add=function(){};this.Contains=function(){};this.IndexOf=function(){};this.SerializeToXml=function(){};this.Deserialize=function(){};this.RefreshUI=function(){};this.Clear=function(){}}function WebGridClientStorage(){this._Type="WebGridClientStorage";this.Grid=null;this.Table=null;ISObject.call(this);this.SelectedRows=new IWebGridPersistence();this.PendingChanges=new IWebGridPersistence();this.ExpandedChildRows=new IWebGridPersistence();this.Initialize=function(){if(typeof(WebGridPersistedRows)!="undefined"){this.SelectedRows=new WebGridPersistedRows();this.SelectedRows.Table=this.Table}if(typeof(WebGridPersistedChildRows)!="undefined"){this.ExpandedChildRows=new WebGridPersistedChildRows();this.ExpandedChildRows.Table=this.Table}if(typeof(WebGridBatchPendingChanges)!="undefined"){this.PendingChanges=new WebGridBatchPendingChanges();this.PendingChanges.Table=this.Table}};this.Clear=function(){this.SelectedRows.Clear()};this.SerializeToXml=function(a){var h=this.Grid.XmlDt;var g=this.Table.XmlNode;var d=ISXml.CreateNodeOnly(h,"Table","");var c=false;ISXml.SetAttribute(d,"Name",this.Table.Name);var f=this.SelectedRows.SerializeToXml();if(f!=null){c=true;d.appendChild(f)}var b=this.ExpandedChildRows.SerializeToXml();if(b!=null){c=true;d.appendChild(b)}if(a==1||a==2||a==3||this.Grid.LastAction=="BatchUpdate"){var e=this.PendingChanges.SerializeToXml();if(e!=null){c=true;d.appendChild(e)}}if(c){return d}else{return null}};this.Deserialize=function(d){var c=ISXml.GetNode(d,"SelectedRows");var a=ISXml.GetNode(d,"ChildRows");var b=ISXml.GetNode(d,"PendingChanges");if(c!=null){this.SelectedRows.Deserialize(c);this.SelectedRows.RefreshUI()}if(a!=null){this.ExpandedChildRows.Deserialize(a)}if(b!=null){this.PendingChanges.Deserialize(b);if(this.Table.IsRootTable){this.PendingChanges.RefreshUI()}this.Grid.UpdatePendingChangesStatus()}};this.RefreshUI=function(a){this.SelectedRows.RefreshUI(a);this.ExpandedChildRows.RefreshUI(a);this.PendingChanges.RefreshUI(a)}}function WebGridTable(){this._Type="WebGridTable";ISObject.call(this);this.Name="";this.Grid=null;this.IsRootTable=false;this.ParentTable=null;this.HasChildTable=false;this.TableLevel=null;this.Position=null;this.AllowAddNew="Default";this.ButtonStyle=null;this.AllowColumnSizing="Default";this.AllowColumnMove="Default";this.AllowEdit="Default";this.AllowDelete="Default";this.AllowFilter="Default";this.AllowSelectColumns="Default";this.AllowSorting="Default";this.AllowGrouping="Default";this.AutomaticSort=true;this.AutomaticFilter=true;this.CellClickAction="NotSet";this.CellPaddingDefault=-1;this.CellSpacingDefault=-1;this.ColumnHeaders="Default";this.ColumnFooters="Default";this.ColumnWidthDefault=100;this.GridLines="Default";this.GridLineColor="";this.GridLineStyle=null;this.HeaderClickAction="NotSet";this.GroupRowInfoFormatDefault="";this.GroupRowInfoStyle=null;this.RowHeaders="Default";this.FocusCellStyle=new FocusStyle();this.Caption="";this.DataKeyField="";this.DataMember="";this.CaptionImage="";this.NewRowInfoText="";this.GroupMode="Collapsed";this.RowStyle=null;this.SelectedRowStyle=null;this.HeaderStyle=null;this.FooterStyle=null;this.RowHeaderWidth=-1;this.RowHeightDefault=null;this.HideColumnsWhenGrouped="Default";this.NewRowStyle=null;this.ChildTables=new ISArray();this.Layout=null;this.Columns=new ISArray();this.Rows=null;this.TableHeaderStyle=null;this.TableHeaderVisible=false;this.GroupTotalVisible=false;this.GroupTotalStyle=null;this.GroupedColumns=new ISArray();this.SortedColumns=new ISArray();this.FilteredColumns=new ISArray();this.RowLayout="PlainColumn";this.PreviewRowSettings=new PreviewRowSettings();this.PreviewRowVisible=false;this.ColumnSets=new ISArray();this.FormatConditions=null;this.ColumnSetSettings=new ColumnSetSettings();this.SelfReferencingSettings=new SelfReferencingSettings();this.IsUseColumnSet=false;this.SelectedRowClass="";this.CheckedRowClass="";this.HasMultiPrimaryKey=false;this.DataKeyFields="";this.DataKeyFieldsCount=0;this.Id="";this.SubTableIds=new Array();this.Formulas=new Array();this.GridId="";this.FilterMenu=null;this.FilterMenus=null;this.ColumnMenu=null;this.LastFo=null;this.LastAECIndex=-1;this.IsEditing=false;this.IsAdding=false;this.SubTableUpdates=new Array();this.UniqueConstraints="";this.FilterState="NotSet";this._LastFilters=new ISArray();this.UseValueListForSorting="No";this.SelectedRows=new Array();this.AllowMultipleSelection="Default";this.Storage=new WebGridClientStorage();this.NewRowTemplate="";this.HeaderTemplate="";this.FilterTemplate="";this.FooterTemplate="";this.LastRowPosition=-1;this.UniqueKeySeed=0;this.HtmlTemplate=null;this.GroupTotalClass="";this.IsFilterDisabled=function(){if(this.FilteredColumns.length==0||this.FilterState=="Disabled"){return true}return false};this.UseValueListForFilter="No";this.GetGrid=function(){if(this.Grid==null){var a=this;do{a=a.Parent;if(a&&a.GetType()=="WebGrid"){this.Grid=a;break}}while(a!=null)}return this.Grid};this.OnPropertiesInitialized=function(){var c=this.GetGrid();c.Tables[this.Name]=this;this.Id=this.Name;this.GridId=this.Grid.Id;this.Layout=c.LayoutSettings;this.Storage.Grid=c;this.Storage.Table=this;this.Storage.SelectedRows.Table=this;if(this.Get("AllowAddNew")=="Yes"||c.BindingOperationMode=="ClientBinding"){var e=ISXml.GetNode(this.XmlNode,"NewRowTemplate");var d=ISXml.GetNode(this.XmlNode,"HeaderTemplate");var a=ISXml.GetNode(this.XmlNode,"FilterTemplate");var b=ISXml.GetNode(this.XmlNode,"FooterTemplate");if(e!=null){this.NewRowTemplate=e.text;this.XmlNode.removeChild(e)}if(d!=null){this.HeaderTemplate=d.text;this.XmlNode.removeChild(d)}if(a!=null){this.FilterTemplate=a.text;this.XmlNode.removeChild(a)}if(b!=null){this.FooterTemplate=b.text;this.XmlNode.removeChild(b)}}if(this.VirtualIdentity!=""){this.VirtualIdentity=ISJsonEngine.Parse(this.VirtualIdentity)}};this.GetDefault=function(a){if(this[a]=="Default"||this[a]=="NotSet"||this[a]==""||this[a]==-1){return this.Grid.LayoutSettings[a]}else{return this[a]}};this.__getter=function(a){switch(a){case"CellClickAction":case"AllowSelectColumns":case"AllowColumnSizing":case"AllowColumnMove":case"AllowSorting":case"AllowGrouping":case"ColumnFooters":case"AllowAddNew":case"AllowEdit":case"AllowDelete":case"HideColumnsWhenGrouped":case"HeaderClickAction":case"SelectedRowClass":case"RowHeaders":case"RowHeaderWidth":case"AllowMultipleSelection":return this.GetDefault(a);break;case"AllowFilter":if(this.IsRootTable){return this.GetDefault(a)}else{return this.AllowFilter}break}};this.OnUnload=function(){if(this.FilterMenu!=null){this.FilterMenu.Destroy()}if(this.ColumnMenu!=null){this.ColumnMenu.Destroy()}};this.HasNextSiblingGroupedColumns=function(){if(this.IsRootTable){return false}var d=parseFloat(this.Position);var c=this.GetParentTables();if(d>=c.length-1){return false}for(var b=d+1;b<c.length;b++){var a=c[b];if(parseFloat(a.GroupedColumns.length)>0){return true}}return false};this.HasChildTableGroupedColumns=function(){var a=this.GetChildTables();for(var b=0;b<a.length;b++){if(a[b].GroupedColumns.length>0){return true}if(a[b].HasChildTableGroupedColumns()){return true}}return false};this.GetParentTables=function(){var b=new Array();for(table in this.Grid.Tables){var a=this.Grid.Tables[table];if(typeof(a)!="function"&&!a.IsRootTable){if(a.Parent.Name==this.Parent.Name){b[b.length]=a}}}return b};this.GetChildTables=function(){var a=new Array();for(table in this.Grid.Tables){var b=this.Grid.Tables[table];if(typeof(b)!="function"&&b.Parent.Name==this.Name){a[a.length]=b}}return a};this.GetParentTreeStructure=function(){var b=this.Parent.Name;var a=new Array();while(b!=""){var c=this.Grid.Tables[b];if(!c){return a}if(c.HasNextSiblingGroupedColumns()){a[a.length]="Continuos"}else{a[a.length]="Last"}var b=c.Parent.Name;if(b!=""&&c.IsRootTable){break}}a.reverse();return a};this.GetColumnGroupHeadersWidth=function(){var a=0;if(!this.IsRootTable&&this.Parent.Get("RowHeaders")=="Yes"){a+=26}a+=(this.GroupedColumns.length*16);if(this.Grid.LayoutSettings.Hierarchical){a+=22}if(this.Get("RowHeaders")=="Yes"){a+=parseInt(this.Get("RowHeaderWidth"))}if(this.IsPreviewRowVisible&&this.PreviewRowSettings.Expandable){a+=parseInt(this.Get("RowHeaderWidth"))}return a};this.GetParentHeadersWidth=function(){var c=this;var d=0;while(c){var a=null;if(!c.IsRootTable){a=c.Parent.Name}var b;if(a!=""&&a){b=this.Grid.Tables[a];d+=b.GetColumnGroupHeadersWidth();if(b.Get("RowHeaders")=="Yes"){d-=parseInt(this.Get("RowHeaderWidth"))}c=b}else{c=null}}return d};this.GetElement=function(b,c,f){if(b==WG40.COLHEADER||b==WG40.COLFOOTER||b==WG40.BODY){if(c==WG40.HTMLDIV){if(this.IsRootTable){return document.getElementById(c+b+"_"+this.Grid.Id+"_"+this.Id)}else{return document.getElementById(c+b+"_"+this.Grid.Id+"_"+this.Id+"_"+WG50Engine.GetTableSubId(f))}}else{if(b==WG40.COLHEADER&&this.Grid.EnableSection508Standards){return this.GetElement(WG40.BODY,WG40.HTMLTABLE,f)}var a=this.GetElement(b,WG40.HTMLDIV,f);return a.childNodes[0]}}else{var e;if(b==WG40.COLGROUP){e=this.GetElement(WG40.BODY,WG40.HTMLTABLE,f)}else{if(b==WG40.COLHEADERGROUP){e=this.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,f)}else{if(b==WG40.COLFOOTERGROUP){e=this.GetElement(WG40.COLFOOTER,WG40.HTMLTABLE,f)}}}var d=e.childNodes[0];if(b==WG40.COLHEADERGROUP&&d!=null){if(d!=null&&d.tagName.toLowerCase()!="colgroup"){return null}}return d}};this.GetFilterRow=function(b){if(!this.IsRootTable){return this.Grid.RootTable.GetFilterRow()}var c=this.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,b);for(var a=0;a<c.rows.length;a++){WG50Engine.EmulateAttributes(c.rows[a]);if(c.rows[a].type&&c.rows[a].type=="FilterRow"){return c.rows[a]}}return null};this.GetNewRow=function(b){var c=this.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,b);for(var a=0;a<c.rows.length;a++){WG50Engine.EmulateAttributes(c.rows[a]);if(c.rows[a].type&&c.rows[a].type=="NewRow"){return c.rows[a]}}return null};this.GetSubTablePosById=function(b){for(var a=0;a<this.SubTableIds.length;a++){if(this.SubTableIds[a].SubId==b){return a}}return -1};this.GetMaxWidth=function(){var b=0;if(this.SubTableIds){for(var a=0;a<this.SubTableIds.length;a++){var c=this.SubTableIds[a];b=Math.max(b,c.Width)}}return b};this.GetContainer=function(c){var b=WG50Engine.GetTable(c);var a=WG50Engine.GetParentElement(b,2);return a};this.SelectRow=function(c,b){var d;var a=null;if(typeof(c)=="number"){if(this.Grid.EnableSection508Standards){var e=this.GetRow(c);if(e!=null){d=e.GetElement()}if(d==null){return}}else{d=this.GetElement(WG40.BODY,WG40.HTMLTABLE).rows[c]}}else{d=c}WG50Engine.EmulateAttributes(d);while(d.tagName==null){d=d.RowElement}if(wgIsRecordRow(d)||d.type=="FilterRow"){a=wgGetCellByPosition(d,0)}else{if(d.type=="NewRow"||d.type=="GroupHeader"){a=d.cells[d.cells.length-1]}}if(a){WGEventEngine.ProcessMouseEvents(a);if(!b){a.focus()}}};this.GetSelRowStyle=function(){var a=this.Get("SelectedRowClass");return IS.GetCssValues(this.Grid.Id,a)};this.GetFocusCellStyle=function(){if(this.FocusCellStyle.BorderStyle=="NotSet"){return this.Grid.LayoutSettings.FocusCellStyle.GetStyleText()}else{return this.FocusCellStyle.GetStyleText()}};this.GetCheckedRowStyle=function(){var a=this.CheckedRowClass;if(a==""){a=this.Grid.LayoutSettings.CheckedRowClass}if(a==""){return""}return IS.GetCssValues(this.Grid.Id,a)};this.GetColumn=function(c){var a=this.Columns.GetNamedItem(c);if(a==null){for(var b=0;b<this.Columns.length;b++){if(this.Columns[b].DataMember==c){a=this.Columns[b];break}}}return a};this.IsFilterRowVisible=function(){var a=this.GetFilterRow();return(a.style.display=="")};this.GetFilterEditType=function(a){return this.GetColumn(a).GetFilterEditType()};this.GetRowCheckerColumn=function(){var b=this.Columns;var a="";for(var c=0;c<b.length;c++){if(b[c].IsRowChecker){a=b[c].Name;break}}return a};this.AddSelectedRow=function(b,a){if(!b.isRowChecked){b.isRowChecked=true;if(a){WGEventEngine.RedrawSelectedRowBorder(b,"Clear")}this.SelectedRows.push(b)}};this.SelectedRowsContain=function(b){if(b==null||!b){return false}if(this.SelectedRows!=null){for(var a=0;a<this.SelectedRows.length;a++){if(this.SelectedRows[a]==b){return true}}}return false};this.RemoveSelectedRow=function(d,a){var c=this.GetCheckedRows();for(var b=0;b<c.length;b++){if(c[b]==d){d.isRowChecked=false;c.splice(b,1);if(this.Storage!=null&&this.Storage.SelectedRows!=null){this.Storage.SelectedRows.Remove(d)}if(a){WGEventEngine.HighlightRow(d,"","","Clear")}return}}};this.ClearSelectedRows=function(){if(this.SelectedRows==null){return}if(this.Storage!=null&&this.Storage.SelectedRows!=null){for(var a=0;a<this.SelectedRows.length;a++){var b=this.SelectedRows[a];if(b&&b.parentElement!=null&&b.parentElement.parentElement!=null){this.Storage.SelectedRows.Remove(b)}}}this.SelectedRows=null;this.SelectedRows=new Array()};this.GetCheckedRows=function(b){var f=this.GetRowCheckerColumn();if(this.Get("AllowMultipleSelection")=="Yes"&&!b){if(!f||(f&&this.SelectedRows.length>0)){return this.SelectedRows}}if(f){var g=new Array();var k=new Array();if(this.IsRootTable){k[0]=this.GetElement(WG40.BODY,WG40.HTMLTABLE)}else{for(var c=0;c<this.SubTableIds.length;c++){k[k.length]=this.SubTableIds[c].GetElement(WG40.BODY,WG40.HTMLTABLE)}}for(var d=0;d<k.length;d++){var h=k[d];for(var c=0;c<h.rows.length;c++){WG50Engine.EmulateAttributes(h.rows[c]);if(h.rows[c].type=="Record"){if(!b){if(h.rows[c].isRowChecked){g[g.length]=h.rows[c]}}else{var e=wgGetCellByName(h.rows[c],f);var a=e.getElementsByTagName("INPUT")[0];if(a.checked){g[g.length]=h.rows[c]}}}}}return g}};this.GetAutoWidthColumn=function(){var b=this.Columns;for(var c=0;c<b.length;c++){var a=b[c];if(a.IsAutoWidth){return a}}return null};this.GetSubTableById=function(b){for(var a=0;a<this.SubTableIds.length;a++){if(this.SubTableIds[a].SubId==b){return this.SubTableIds[a]}}return null};this.GetColNameByRowLayout=function(d,f,a){var b=this.ColumnSets[parseFloat(d)];var g=null;for(var e=0;e<b.Layout.length;e++){var h=b.Layout[e];if(h.Row==f&&h.Col==a){g=h;break}}if(g){return g.ColumnMember}return null};this.GetRowLayoutByColName=function(e){var b=this.ColumnSets;for(var c=0;c<b.length;c++){var a=b[c];for(var d=0;d<a.Layout.length;d++){if(a.Layout[d].ColumnMember==e){return a.Layout[d]}}}return null};this.GetRowLayoutByIndex=function(e,f,a){var b=this.ColumnSets[e];for(var d=0;d<b.Layout.length;d++){var g=b.Layout[d];if(g.Row==f&&g.Col==a){return g}}return null};this.GetColHeaderSpanCount=function(){var a=0;if(!this.IsRootTable){a++}a+=this.GroupedColumns.length;if(this.Layout.Hierarchical){a++}if(this.Layout.RowHeaders=="Yes"){a++}if(this.PreviewRowVisible&&this.PreviewRowSettings.Expandable){a++}return a};this.GetCSCellPosByIndex=function(d,k,a,j){var g=this.ColumnSets;var b=0;for(var h=0;h<d;h++){var e=g[h];if(e.Visible){b+=parseInt(e.ColumnCount)}}if(j){var l=this.GetRowLayoutByIndex(d,k,a);var f=l.ColSpan;if(f&&parseInt(f)>1){b+=parseInt(f)-1}}return b+parseInt(a)};this.GetCSHeaderCellPosByIndex=function(e){var d=this.ColumnSets;var a=0;var b=e.pos;for(var f=0;f<b;f++){var c=d[f];if(c.Visible){a+=parseInt(c.ColumnCount)}}return a};this.GetCSHeaderWidth=function(c){var a=this.ColumnSets[c];var e=0;for(var b=0;b<a.ColumnCount;b++){var d=this.GetRowLayoutByIndex(c,0,b);e+=parseInt(d.Width)}return e};this.GetColumnSetByPos=function(a){return this.ColumnSets[a]};this.UpdateRowLayoutWidth=function(d,a,h){var b=this.GetColumnSetByPos(d);var g=b.Layout;for(var e=0;e<g.length;e++){var f=g[e];if(f.Col==a){f.Set("Width",h,true)}}};this.GetParentRow=function(f){var c;try{var d=WG50Engine.GetTable(f);var b=WG50Engine.GetParentElement(d,4);d=WG50Engine.GetTable(b);c=wgGetPreviousRow(d,b);c=wgGetRootRow(c)}catch(a){c=null}return c};this.GetRecursiveParentRowPosition=function(d){var b=this.GetParentRow(d);var a=WGUIEngine.GetParentIndex(b);var c="";while(b!=null){WG50Engine.EmulateAttributes(b);c+=b.position+"_";b=this.GetParentRow(b);if(!b||!b.type){b=null}}if(c!=""){c=c.substring(0,c.length-1)}if(a!=""){c+="_"+a}return c};this.CreateFormula=function(a,c){var b=false;for(var d=0;d<this.Formulas.length;d++){if(this.Formulas[d].colName==a){b=true;break}}if(!b){this.Formulas[this.Formulas.length]=new wgFormula(this.GridId,this.Id,a,c)}else{alert("The formula for column '"+a+"' is already exist.")}};this.Refresh=function(){if(this.IsRootTable){this.GetGrid().Refresh()}else{WG50Engine.ExecuteFlyPostback(this.GetGrid().Name,"ChildTableRefresh",this.Id)}};this.GetDataKeyFieldsCount=function(){return this.DataKeyFieldsCount};this.GetTableElementRowsCount=function(b){var a=this.GetElement(WG40.BODY,WG40.HTMLTABLE,b);if(a){return a.rows.length}};this.GetRowsCount=function(){var b=this.GetTableElementRowsCount();var g=this.GetElement(WG40.BODY,WG40.HTMLTABLE);var c=this.Grid;if(b==0){return 0}var f=g.rows[b-1];var d=f;if(c.LayoutSettings.AllowBatchUpdate){var a=this.GetChanges("Added");if(a.length>0&&a[0].Element!=null){f=g.rows[a[0].Element.rowIndex-1]}}if(!f){f=d}var e=wgGetRootRow(f);var b=0;if(this.GroupedColumns.length==0){b=parseFloat(e.position)+1}else{if(c.BindingOperationMode=="ClientBinding"&&c.LayoutSettings.PagingMode=="VirtualLoad"){if(this.Rows.length>0){b=WGGroupingEngine.UngroupRows(this.Rows,new ISArray()).length}}else{b=parseFloat(e.recordIndex)+1}}if(isNaN(b)){b=0}return b};this.ToRowObject=function(b){var a=null;if(this.Grid.BindingOperationMode=="ClientBinding"){a=this.GetRowByElement(b)}if(a==null){a=new WebGridRow(this);a.Setup(b)}if(!this.IsRootTable){var c=WG50Engine.GetTableSubId(b);a.SubTable=this.GetSubTableById(c)}return a};this.GetRowByElement=function(a){if(this.Rows==null){return}var b=WG50Engine.GetRowByElement2(a,this.Rows);if(b){return b}return null};this.GetRow=function(c,a){if(this.IsRootTable){if(this.Grid.BindingOperationMode=="ClientBinding"){var e=this.UngroupedRows;if(e==null){e=this.Rows}if(e==null){return null}return e[c]}else{var f=null;if(this._tableCache){f=this._tableCache}else{f=this.GetElement(WG40.BODY,WG40.HTMLTABLE);this._tableCache=f}var d=wgGetRowByPositionExact(f,c,c,a);if(!d&&this.GroupedColumns.length>0){d=wgGetRowByPositionExact(f,c,c,false,true)}if(!d){return null}var b=new WebGridRow(this);b.Setup(d);return b}}return null};this.GetRowByKeyValue=function(b){if(this.IsRootTable){var g=this.GetElement(WG40.BODY,WG40.HTMLTABLE);var e=null;for(var a=0;a<g.rows.length;a++){var d=g.rows[a];WG50Engine.EmulateAttributes(d);if(wgIsRecordRow(d)&&d.keyValue==b){e=d;break}}if(!e){return null}var c=new WebGridRow(this);c.Setup(e);return c}else{var e=null;for(var a=0;a<this.SubTableIds.length;a++){var f=this.SubTableIds[a];var d=f.GetRowByKeyValue(b);if(d){return d}}}return null};this.GetRowByGroup=function(a,b,e){if(this.IsRootTable){var f=this.GetElement(WG40.BODY,WG40.HTMLTABLE);var d=wgGetRowByGroup(f,a,b,e);if(!d){return null}var c=new WebGridRow(this);c.Setup(d);return c}};this.GetSubIdByParentKey=function(b){for(var a=0;a<this.SubTableIds.length;a++){if(this.SubTableIds[a].RelNames==b){return this.SubTableIds[a]}}};this.GetSubIdById=function(b){for(var a=0;a<this.SubTableIds.length;a++){if(this.SubTableIds[a].SubId==b){return this.SubTableIds[a]}}};this.NewRow=function(e){var d=new WebGridRow(this,e);var b=new ISArray();for(var c=0;c<this.Columns.length;c++){var a=new WebGridCell(d);a.Name=this.Columns[c].Name;a.Column=this.Columns[c];b[b.length]=a}d.Cells=b;d._UIState="Added";d.Grid=this.Grid;return d};this.GetSelfRefParent=function(b){var a=this.GetElement(WG40.BODY,WG40.HTMLTABLE);return WGUIEngine.GetSelfRefParent(a,b)};this.GetGroupRows=function(){var d=this.GetElement(WG40.BODY,WG40.HTMLTABLE);var e=d.rows[0];var a=e;var c=new Array();if(d.rows.length==0){return null}WG50Engine.EmulateAttributes(a);while(a){if(a.type=="GroupHeader"&&a.groupIndex=="0"){var b=this.ToRowObject(a);c[c.length]=b}a=wgGetNextRow(d,a)}return c};this.UpdateUI=function(){WGUIEngine.UpdateUI(this)};this.IsColumnSetHeaderVisible=function(){var a=this.ColumnSetSettings.ShowHeaders;if(a=="Default"){a=this.Layout.ColumnSetHeaders}return a=="Yes"};this.GotoFilterRow=function(){var b=this.GetFilterRow();var a=WG50Engine.GetRowByElement(b);a.Select()};this.GotoNewRow=function(a){var c=this.GetNewRow(a);var b=WG50Engine.GetRowByElement(c);b.Select()};this.SetFilterStatus=function(a){WGUIEngine.ToggleFilter(this,a)};this.GetVisibleColumnNames=function(){var b=new Array();for(var a=0;a<this.Columns.length;a++){if(this.Columns[a].Visible){b.push(this.Columns[a].Name)}}return b};this.GetPrimaryKey=function(){if(this.DataKeyField!=""){return this.DataKeyField}else{if(this.DataKeyFields!=""&&this.DataKeyFields.indexOf(",")==-1){return this.DataKeyFields}}for(var a=0;a<this.Columns.length;a++){if(this.Columns[a].IsAutoIncrement){return this.Columns[a].DataMember}}return""}}function WebGridTextItem(){this._Type="WebGridTextItem";ISObject.call(this);this.Name="";this.TextItem="";this.TextValue="";this.Collection=new ISArray()}function WebComboEditor(){this._Type="WebComboEditor";ISObject.call(this);this.Id=""}function BrowserPrintSettings(){this._Type="BrowserPrintSettings";ISObject.call(this);this.GridLayout="AsDisplayedInBrowser";this.PrintStatusBar=true}function wgGetActiveGrid(){return wg_Global.ActiveGrid}function wgGetGridById(a){return ISGetObject(a)}function wg_getGridNameByRow(a){return WG50Engine.GetGridNameByRow(a)}function wg_getTableNameByRow(a){return WG50Engine.GetTableNameByRow(a)}function wg_getTableSubId(a){return WG50Engine.GetTableSubId(a)}function wg_getTable(a){return WG50Engine.GetTable(a)}function wgGetTable(a){return WG50Engine.GetTable(a)}function wgDoResize(a,b){if(!a){WG50Engine.OnResize(b)}else{WG50Engine._OnResize(b)}}function wgMouseCoord(a,b){this.x=a;this.y=b;return this}function wgHeaderInfo(){this.AllowLeftInsert=false;this.AllowRightInsert=false;this.PosLeft=0;this.PosRight=0;this.Type=null;this.Element=null;this.ProperPosition=null;this.PosTop=0;return this}function wgFormula(gridId,tblName,colName,formula){this.isValid=true;this.nonValidMsg=null;this.colName=colName;this.gridId=gridId;this.tblName=tblName;this.formula=formula;this.affectedColumns=new Array();this.skipErrorMessage=false;this.table=null;this.valueOnError=0;var fB=formula.indexOf("[");var lB=0;while(fB>=0){lB=formula.indexOf("]",fB);this.affectedColumns[this.affectedColumns.length]=formula.substring(fB+1,lB);fB=formula.indexOf("[",lB)}this.table=ISGetObject(this.gridId).Tables[this.tblName];for(var i=0;i<this.affectedColumns.length;i++){var colXml=this.table.GetColumn(this.affectedColumns[i]);if(!colXml||!colXml.Visible){this.isValid=false;break}}this.GetResult=function(row){if(this.isValid){var resFormula=this.formula;for(var i=0;i<this.affectedColumns.length;i++){var el=wgGetCellByName(row,this.affectedColumns[i]);var colXml=this.table.GetColumn(wgGetColNameByCell(el));var value=el.innerText;if(colXml.DataFormat!=""){value=wgGetUnMask(ISGetObject(this.gridId),colXml,el)}resFormula=resFormula.replace(new RegExp(this.affectedColumns[i],"g"),value)}resFormula=resFormula.replace(/[\[\]]/g,"");var result;try{result=eval(resFormula)}catch(e){result=this.valueOnError}return result}else{if(!this.skipErrorMessage){alert("Formula is not valid because one of the specified column is not exist or not visible.")}}return null};this.ProcessResult=function(row,cell){if(this.IsCellAccounted(cell)){var result=this.GetResult(row);var el=wgGetCellByName(row,this.colName);var colXml=this.table.GetColumn(wgGetColNameByCell(el));if(colXml.DataFormat!=""){el.cellValue=result;el.innerText=wgGetMask(ISGetObject(this.gridId),null,String(result),this.table,el)}}};this.IsCellAccounted=function(cell){var colName=wgGetColNameByCell(cell);for(var i=0;i<this.affectedColumns.length;i++){if(colName==this.affectedColumns[i]){return true}}return false};return this}function wgGetChildTableByRow(f,b){var g=WG50Engine.GetTable(f);var e=wgGetNextRow(g,f);var c=e.cells[e.cells.length-1];var d=c.childNodes[0];var a=document.getElementById("dvTB_"+d.gridId+"_"+b+"_"+d.subId).childNodes[0];return a}function wgMoveColArgs(d,a,b,f,c,e){this.table=d;this.c1=a;this.c2=b;this.tr=f;this.cdt=c;this.th=e;return this}function wgShowHelp(b){var a=ISGetObject(b);var c=a.LayoutSettings.HelpURL;if(c==""){c="http://www.intersoftpt.com/WebGrid/Help.aspx"}window.open(c,null,"toolbar=no, menubar=no, scrollbars=yes, resizable=yes")}function wgGetCellCount(d){if(d){var a;var c=0;if(d.tagName=="TR"){a=d.cells}else{if(d.tagName=="TD"){a=d}}for(var b=0;b<a.length;b++){WG50Engine.EmulateAttributes(a[b]);if(a[b].type=="Cell"||a[b].type=="GroupCell"||a[b].type=="FilterColumn"){c++}}}return c}function wgGetCellByPosition(d,e){if(d){var a;var c=-1;if(d.tagName=="TR"){a=d.cells}else{if(d.tagName=="TD"){a=d}}for(var b=0;b<a.length;b++){WG50Engine.EmulateAttributes(a[b]);if(a[b].type=="Cell"||a[b].type=="GroupCell"||a[b].type=="FilterColumn"){c++}if(e==c){return a[b]}}}return null}function wgGetCellByName(g,e,d){if(g){var a;var f=-1;var h;if(g.tagName=="TR"){a=g.cells;h=g}else{if(g.tagName=="TD"){h=g.parentElement;a=g}}var l=WG50Engine.GetTable(g);if(l&&l.gridId){var k=ISGetObject(l.gridId).Tables[l.tblName];if(k.IsUseColumnSet){return wgGetCSCellByName(h,e)}var j=k.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,g).rows[0];var b=-1;for(var c=0;c<j.cells.length;c++){a=j.cells;WG50Engine.EmulateAttributes(a[c]);if((a[c].type=="Column"||d)&&a[c].colName==e){b=c;break}}if(b>=0){return g.cells[b]}}}return null}function wgGetCellPosByName(e,a){if(e){var b;var d=-1;if(e.tagName=="TR"){b=e.cells}else{if(e.tagName=="TD"){b=e}}for(var c=0;c<b.length;c++){WG50Engine.EmulateAttributes(b[c]);if((b[c].type=="Cell"||b[c].type=="GroupCell")){if(b[c]==a){d++;return d}else{d++}}}}return null}function wgGetRowByPosition(b,a){return b.rows[a]}function wgGetRowByPositionExact(g,d,f,a,h){var e="position";if(h){e="recordIndex"}if(!f){f=0}for(var b=f;b<g.rows.length;b++){WG50Engine.EmulateAttributes(g.rows[b]);if(wgIsRecordRow(g.rows[b])&&g.rows[b][e]==d){var c=(typeof(g.rows[b].srLevel)=="string");if(!c){return g.rows[b]}else{if(!a){if(g.rows[b].srLevel=="0"){return g.rows[b]}}else{return g.rows[b]}}}}return null}function wgGetRootRow(a){if(!a){return}WG50Engine.EmulateAttributes(a);if(wgIsColumnSetRow(a)){return wgGetColumnSetRow(a)}else{if(a.type=="PR"){return wgGetPreviewRowParent(a)}else{if(a.type=="GroupTotalRow"){return wgGetPreviousRow(WG50Engine.GetTable(a),a)}else{return a}}}}function wgGetColNameByCell(a){var h=a.parentElement;var e=WG50Engine.GetTable(h);var d=ISGetObject(e.gridId);var j=d.Tables[e.tblName];var c=j.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,h).rows[0].cells;var g=false;if(!j.IsUseColumnSet){if(IS.ie&&j.IsRootTable&&d.FreezePaneActive&&d.FreezeConfig!=null&&(wgIsRecordRow(h)||a.style.display=="none")){g=true}for(var f=0;f<c.length;f++){var b=c[f].cellIndex;var k=a.cellIndex;WG50Engine.EmulateAttributes(c[f]);if(g){b=WG50Engine.GetRealCellIndex(c[f])}if(a.style.display=="none"){k=WG50Engine.GetRealCellIndex(a)}if(c[f].type=="Column"&&b==k){return c[f].colName}}}else{if(typeof(a.cs)=="undefined"){return null}return j.GetColNameByRowLayout(a.cs,a.r,a.c)}}function wgExpandGroupRow(c,b){if(b){_wgExpAllGR(c);return}if(c.type=="GroupHeader"&&c.expanded=="False"){var a=ISGetObject(WG50Engine.GetTable(c).gridId);WGUIEngine.ChangeImage(a,wgGetCellByPosition(c,0).childNodes[0],c.expanded);WGUIEngine.ToggleGroupRow(null,c)}}function _wgExpAllGR(c){wgExpandGroupRow(c);var b=WG50Engine.GetTable(c);var a=wgGetNextRow(b,c);while(a){if(a.groupIndex==c.groupIndex&&a.style.display==""&&a.childrenLoaded!="False"){wgExpandGroupRow(a)}a=wgGetNextRow(b,a)}}function wgCollapseGroupRow(c,b){if(b){_wgColAllGR(c);return}if(c.type=="GroupHeader"&&c.expanded=="True"){var a=ISGetObject(WG50Engine.GetTable(c).gridId);WGUIEngine.ChangeImage(a,wgGetCellByPosition(c,0).childNodes[0],c.expanded);WGUIEngine.ToggleGroupRow(null,c)}}function _wgColAllGR(c){wgCollapseGroupRow(c);var b=WG50Engine.GetTable(c);var a=wgGetNextRow(b,c);while(a){if(a.groupIndex==c.groupIndex){wgCollapseGroupRow(a)}a=wgGetNextRow(b,a)}}function wgExpandChildRow(c){var a=ISGetObject(WG50Engine.GetTable(c).gridId);var b=WGHierEngine.GetCellExpander(c);if(c.childNotExpandable!="True"){WGHierEngine.ChangeImage(a,b,"False");WGHierEngine.ToggleRow(null,c)}}function wgCollapseChildRow(c){var a=ISGetObject(WG50Engine.GetTable(c).gridId);var b=WGHierEngine.GetCellExpander(c);WGHierEngine.ChangeImage(a,b,"True");WGHierEngine.ToggleRow(null,c)}function wgRefreshHierPosition(a,j,h,g,b){if(b){WGHierEngine.RefreshHierPosition(a,j,h,g)}else{if(!h){return}var f=h.rowIndex;var d=g;var k=a.Tables[j.tblName];for(var c=f;c<j.rows.length;c++){var e=j.rows[c];if(e.type=="Record"){e.position=e.recordIndex=g;g++}}}}function wgGetSelectedObjectFromEvent(c){if(c){var b=c.srcElement;if(b.tagName!="TD"){origEl=b;b=_wgGetTDElement(b)}if(!b){return null}var h=b.parentElement;var e=WG50Engine.GetTable(h);var d=ISGetObject(e.gridId);var g=d.Tables[e.tblName];var a=g.Get("CellClickAction");var f;if(a=="RowSelect"){f=new SelectedObject(e.tblName,e.gridId,b);f.type="Row";f.rowIndex=h.rowIndex}else{if(a=="CellSelect"){f=new SelectedObject(e.tblName,e.gridId,b);f.type="Cell";f.rowIndex=h.rowIndex;f.cellIndex=wgGetCellPosByName(h,b)}}return f}return null}function wgIsColumnSetRow(a){if(typeof(a.csRowPos)!="undefined"){return true}return false}function wgGetPreviewRow(c){var a=WG50Engine.GetTable(c);var b=wgGetNextRow(a,c);while(b&&b.type!="PR"){b=wgGetNextRow(a,b)}return b}function wgGetPreviewRowCell(b){for(var a=0;a<b.cells.length;a++){if(b.cells[a].type=="PRCell"||b.cells[a].getAttribute("type")=="PRCell"){return b.cells[a]}}return null}function wgIsValidCell(a){if(!a){return false}if(a.type=="Cell"||a.type=="GroupCell"||a.type=="ECell"||a.type=="PRExp"||a.type=="PRCell"||a.type=="FilterColumn"){return true}return false}function wgIsValidClickableCell(a){if(!a){return false}if(a.type=="RowSelector"||wgIsValidCell(a)){return true}return false}function wgIsValidRow(a){if(!a){return false}if(a.type=="NewRow"||a.type=="PR"||a.type=="CSRecord"||a.type=="Record"||a.type=="FilterRow"){return true}return false}function wgGetPreviewRowParent(b){if(b.type!="PR"){return b}var d=WG50Engine.GetTable(b);var a=wgGetGridById(d.gridId);var c=a.Tables[d.tblName];if(!c.IsUseColumnSet){return wgGetPreviousRow(d,b)}else{return wgGetColumnSetRow(wgGetPreviousRow(d,b))}return null}function wgIsSameRow(b,c){if((b==null&&c!=null)||(b!=null&&c==null)){return false}var e=WG50Engine.GetTable(b);var f=WG50Engine.GetTable(c);if(e==f){var a=wgGetGridById(e.gridId);var d=a.Tables[e.tblName];if(!d.IsUseColumnSet){if(!d.PreviewRowVisible){return b==c}else{return wgGetPreviewRowParent(b)==wgGetPreviewRowParent(c)}}else{if(!d.PreviewRowVisible){return wgIsSameColumnSetRow(b,c)}else{return wgIsSameColumnSetRow(wgGetPreviewRowParent(b),c)}}}else{return false}return false}function wgIsSameColumnSetRow(e,f){if(e.type=="PR"){var c=WG50Engine.GetTable(e);e=wgGetPreviousRow(c,e)}if(f.type=="PR"){var d=WG50Engine.GetTable(f);f=wgGetPreviousRow(d,f)}var a=wgGetColumnSetRow(e);var b=wgGetColumnSetRow(f);if(a==b){return true}return false}function wgIsRecordRow(a){if(a.type=="Record"||a.type=="CSRecord"){return true}return false}function wgGetHierRecord(e){var g=WG50Engine.GetTable(e);var a=wgGetGridById(g.gridId);var f=a.Tables[g.tblName];var d=0;if(f.IsUseColumnSet){d+=f.ColumnSetSettings.RowCount-1}if(f.PreviewRowVisible){d+=1}d+=1;var b=wgGetRootRow(e);for(var c=0;c<d;c++){b=wgGetNextRow(g,b)}if(b&&b.type=="HierRecord"){return b}return null}function wgGetRowByGroup(g,a,b,f){var e=0;if(f){e=f.rowIndex}for(var c=e;c<g.rows.length;c++){var d=g.rows[c];WG50Engine.EmulateAttributes(d);if(d.type=="GroupHeader"&&d.groupIndex==a&&d.position==b){return d}}return null}function wgSetSelectedObject(j,l){var u=ISXml.CreateXmlDocument();u.loadXML(l);var k=u.selectSingleNode("//Object");var m=k.getAttribute("parentIndex");var f=wgGetGridById(j);var r=f.Tables[k.getAttribute("tblName")];var h=null;var s;if(r.IsRootTable){s=r.GetElement(WG40.BODY,WG40.HTMLTABLE)}else{var p=k.getAttribute("tblSubId");var q=r.GetSubTableById(p);s=q.GetElement(WG40.BODY,WG40.HTMLTABLE)}if(m!=""){var a=m.split("_");for(var g=0;g<a.length;g++){var e=wgGetRowByGroup(s,g,a[g],h);if(e){if(e.childrenLoaded=="True"){wgExpandGroupRow(e)}}h=e}}var d=null;if(f.BindingOperationMode=="ClientBinding"&&h==null){var t=r.GetRowByKeyValues(k.getAttribute("keyValue"));if(t!=null){d=t.GetElement();if(r.GroupedColumns.length>0){t.ExpandGroupRowsToThisRow()}}}if(d==null){d=wgGetRowByPositionExact(s,parseFloat(k.getAttribute("pos")),(h?h.rowIndex+1:null),true)}if(d){var b=null;if(d.srLevel){if(d.currentStyle.display=="none"){var o=WG50Engine.GetRecordRow(wgGetPreviousRow(s,d));var n=new Array();var c=d.srLevel;while(o){if(o.srRC>0&&o.srLevel<c){n[n.length]=o;c--}o=WG50Engine.GetRecordRow(wgGetPreviousRow(s,o));if(!o){break}if(o.srLevel==0){n[n.length]=o;break}}n=n.reverse();for(var g=0;g<n.length;g++){WGUIEngine.ToggleSelfRefRow(WGUIEngine.GetSelfRefImage(r,n[g]))}}}if(r.Get("CellClickAction")=="RowSelect"){b=wgGetCellByPosition(d,0)}else{if(r.Get("CellClickAction")=="CellSelect"){if(!r.IsUseColumnSet){if(r.LastAECIndex!=-1){b=d.cells[r.LastAECIndex]}else{b=wgGetCellByPosition(d,0)}}else{if(r.LastCSIndex){b=wgGetCSCellByPosition(d,r.LastCSIndex[0],r.LastCSIndex[1],r.LastCSIndex[2])}}if(b==null){b=wgGetCellByPosition(d,0)}}}if(b){WGEventEngine.ProcessMouseEvents(b,true);WGEventEngine.EnsureCellVisible(f,b)}}}function wgExpandSelfRefRow(b){var a=WG50Engine.GetTable(b);var c=wgGetGridById(a.gridId).Tables[a.tblName];b.srExpanded="False";WGUIEngine.ToggleSelfRefRow(WGUIEngine.GetSelfRefImage(c,b))}function wgCollapseSelfRefRow(b){var a=WG50Engine.GetTable(b);var c=wgGetGridById(a.gridId).Tables[a.tblName];b.srExpanded="True";WGUIEngine.ToggleSelfRefRow(WGUIEngine.GetSelfRefImage(c,b))}function wgToggleSelfRefRow(a){if(a.srExpanded=="True"){wgCollapseSelfRefRow(a)}else{wgExpandSelfRefRow(a)}}function wgGetKeyValues(h){var f=WG50Engine.GetTable(h);var e=wgGetGridById(f.gridId);var j=e.Tables[f.tblName];if(j.HasMultiPrimaryKey){var d=j.GetDataKeyFieldsCount();var b=new Array();for(var g=0;g<d;g++){b[b.length]=h.getAttribute("keyValue"+g)}return b}return null}function wgIsFilterRow(a){return a.type=="FilterRow"}function wgIsNewRow(a){return a.type=="NewRow"}function wgRemoveRow(f,e){var b=wgGetHierRecord(e);var d=null;if(f.PreviewRowVisible){d=wgGetPreviewRow(e)}if(b&&b.type!="HierRecord"){b=null}if(wgIsColumnSetRow(e)){var a=wgGetColumnSetRows(e);for(var c=0;c<a.length;c++){a[c].removeNode(true)}}else{e.removeNode(true)}if(d){d.removeNode(true)}if(b){b.removeNode(true)}}function wgGetGridByElement(a){return WG50Engine.GetGridByElement(a)}function wgGetTableByElement(a){return WG50Engine.GetTableByElement(a)}function wgGetColumnByElement(a){return WG50Engine.GetColumnByElement(a)}function wgGetCellByElement(a){return WG50Engine.GetCellByElement(a)}function wgGetRowByElement(a){WG50Engine.EmulateAttributes(a);return WG50Engine.GetRowByElement(a)}var WG50Engine={Initialized:false,Create:function(b){var a=new WebGrid(b);WG50Engine.AssignProperties(a);WG50Engine.RegisterBehaviour(a);WG50Engine.InitializeMozilla(a);setTimeout(function(){WG50Engine.PostInitialize(a)},0);a.IsInit=true;return a},AssignProperties:function(a){if(a==null){return}if(!a.IsInit){var b=ISXml.GetNode(a.XmlDt,"//WebGrid");if(b==null){b=a.XmlDt.documentElement}if(b!=null){IS.SetPropertiesRecursive(a,b);a.LayoutSettings.StatusBarCommandStyle=DynamicStyleEngine.Assign(ISXml.GetNode(a.XmlDt,"//StatusBarCommandStyle"));a.LayoutSettings.ColumnActionStyle=DynamicStyleEngine.Assign(ISXml.GetNode(a.XmlDt,"//ColumnActionStyle"))}}},RegisterBehaviour:function(b){window.attachEvent("onload",function(){WG50Engine.OnGridLoad(b)});window.attachEvent("onunload",function(){if(WG50Engine!=null){WG50Engine.OnWindowUnload(b)}});if(b.LayoutSettings.AllowBatchUpdate){window.attachEvent("onbeforeunload",function(){WGBatchEngine.OnBeforeUnload(b)})}if(!WG50Engine.Initialized){var a=document.body;Listener.Add(a,"onresize",WG50Engine.OnResize);window.attachEvent("onload",WG50Engine.OnWindowLoad);window.attachEvent("onbeforeprint",WG50Engine.OnBeforePrint);window.attachEvent("onafterprint",WG50Engine.OnAfterPrint);window.attachEvent("onscroll",WG50Engine.OnWindowScroll);a.attachEvent("onmousemove",WG50Engine.OnBodyMouseMove);a.attachEvent("onmouseup",WG50Engine.OnBodyMouseUp);a.attachEvent("onmousedown",WG50Engine.OnBodyMouseDown);WG50Engine.Initialized=true}WG50Engine.RegisterFrameBehaviour(b);WG50Engine.RegisterRootTableBehaviour(b);WG50Engine.RegisterStatusBarBehaviour(b);b.XmlHttp=ISXmlHttpEngine.Create(b,function(){WG50Engine.OnResponse(b)})},RegisterStatusBarBehaviour:function(a){if(a.LayoutSettings.StatusBarVisible){var b=a.GetElement(WG40.STATUSBOX,WG40.HTMLDIV);WG50Engine.RegisterStatusBarCommandBehavior(a,b)}},RegisterStatusBarCommandBehavior:function(a,b){Listener.Add(b,"onmouseover",function(){WGUIEngine.OnStyleChanged(a)});Listener.Add(b,"onmouseout",function(){WGUIEngine.OnStyleChanged(a)});Listener.Add(b,"onmousedown",function(){WGUIEngine.OnStyleChanged(a)});Listener.Add(b,"onmouseup",function(){WGUIEngine.OnStyleChanged(a)})},RegisterFrameBehaviour:function(a){a.FrameObj.attachEvent("onbeforedeactivate",function(){if(WG50Engine!=null){WG50Engine.OnBeforeDeactivate(a.Id)}});a.FrameObj.attachEvent("onactivate",function(){WG50Engine.OnActivate(a.Id)});a.FrameObj.attachEvent("onmouseover",function(){WG50Engine.OnFrameMouseOver(a)});a.FrameObj.attachEvent("onfocus",function(){WG50Engine.OnFrameFocus(a)});a.FrameObj.attachEvent("oncontextmenu",function(){WG50Engine.OnFrameMouseUp(a)});a.FrameObj.attachEvent("onmouseup",function(){WG50Engine.OnFrameMouseUp(a)});if(IS.ie){Listener.Add(a.FrameObj,"onresize",WGUIEngine.OnGridResize,a)}},InitializeMozilla:function(b){if(!IS.ie){b.FrameObj.style.MozUserFocus="normal";b.FrameObj.attachEvent("onblur",function(){WGMozEngine.OnBlur(b)});var a=b.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);WG50Engine.EmulateAttributes(a.childNodes[0]);window.attachEvent("onresize",function(){WG50Engine.OnResize()});b.FrameObj.style.overflowY="hidden";if(typeof(WebPaneManager)=="undefined"){WGMozEngine.OnResize(b,true)}WGMozEngine.FormatRootTable(b);WGMozEngine.PreloadImages(b);if(IsGecko30()&&typeof(WGEditEngine)=="object"){WGEditEngine.PreloadCalendar(b)}}else{WG50Engine.InitializeIE7XHTML(b);if(IS.ie9){var a=b.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);WG50Engine.EmulateAttributes(a.childNodes[0])}}},InitializeIE7XHTML:function(b){if((IS.GetIEVersion()<8&&IS.IsXHTMLDocType())){var c=b.RootTable.GetElement(WG40.BODY,WG40.HTMLTABLE);var a=b.RootTable.GetElement(WG40.COLHEADER,WG40.HTMLTABLE);c.cellPadding=0;a.cellPadding=0;c.style.paddingLeft="1px";if(b.RootTable.GroupedColumns.length>0){WG50Engine.InitializeIE7XHTML_Table(b.RootTable)}}if(IS.IsXHTMLDocType()){var c=b.RootTable.GetElement(WG40.BODY,WG40.HTMLTABLE);c.style.width="99%"}},InitializeIE7XHTML_Table:function(g,f){var c=null;if(f){c=f.GetElement(WG40.COLGROUP,null)}else{c=g.GetElement(WG40.COLGROUP,null)}for(var e=0;e<g.Columns.length;e++){var b=g.Columns[e];var d=b.GetElement();if(b.Visible&&d!=null){var a=WG50Engine.GetColGroupIndex(g,d);c.children[a].width=parseFloat(b.Width)+2}}},PostInitialize:function(a){if(a.LayoutSettings.AllowColumnFreezing=="Yes"){if(a.RootTable.IsUseColumnSet){a.LayoutSettings.FreezePaneSettings.ActiveFrozenColumns=0}WGUIEngine.DetermineScrollBarSize(a);WGUIEngine.InvalidateFreezeContainer(a);WGUIEngine.FreezePane(a,true)}else{if(IS.safari){a.ScrollBarSize=0}}},ReflectNoDataStatus:function(a){var b=a.TotalLoadedRows;var c=a.TotalRows;if(c<b){b=c}if(!a.LayoutSettings.StatusBarVisible){if(b==0||c==0){WGUIEngine.ShowNoDataBox(a)}else{WGUIEngine.HideNoDataBox(a)}}},RegisterRootTableBehaviour:function(c){var d=c.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);Listener.Add(d,"onresize",function(){WG50Engine.OnTableResize(d)});Listener.Add(d,"onscroll",function(){WG50Engine.OnTableScroll(c)});if(!IS.ie){Listener.Add(c.RootTable.GetElement(WG40.BODY,WG40.HTMLTABLE),"onfocus",function(){WG50Engine.OnTableFocus(c)})}if(c.IsInProgress){var b=c.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);WG50Engine.EmulateAttributes(b.childNodes[0]);if(!IS.ie){WGMozEngine.OnTableResize(c)}}if(c.LayoutSettings.AllowColumnFreezing=="Yes"){var a=c.GetFreezeOuterDivElement();Listener.Add(a,"onscroll",WGUIEngine.OnFreezeScroll,c)}},UnregisterGrid:function(b){b.FrameObj.detachEvent("onbeforedeactivate",function(){WG50Engine.OnBeforeDeactivate(b.Id)});b.FrameObj.detachEvent("onactivate",function(){WG50Engine.OnActivate(b.Id)});b.FrameObj.detachEvent("onmouseover",function(){WG50Engine.OnFrameMouseOver(b)});b.FrameObj.detachEvent("onfocus",function(){WG50Engine.OnFrameFocus(b)});b.FrameObj.detachEvent("oncontextmenu",function(){WG50Engine.OnFrameMouseUp(b)});b.FrameObj.detachEvent("onmouseup",function(){WG50Engine.OnFrameMouseUp(b)});if(IS.ie){Listener.Unload(b.FrameObj.parentElement)}Listener.Unload(b.FrameObj);Listener.Unload(b.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV));if(b.LayoutSettings.StatusBarVisible){var c=b.GetElement(WG40.STATUSBARCOMMAND,WG40.HTMLCELL);Listener.Unload(c);var a=b.GetElement(WG40.STATUSBOX,WG40.HTMLDIV);Listener.Unload(a)}if(IS.moz){b.FrameObj.detachEvent("onblur",function(){WGMozEngine.OnBlur(b)})}if(b.ActionElement!=null){Listener.Unload(b.ActionElement)}},UnregisterGridBody:function(b){Listener.Unload(b.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV));b.RootTable._tableCache=null;b.RootTable._colIndexCache=null;b.RootTable._colIndexCache2=null;b.RootTable._headerRowCache=null;if(b.LayoutSettings.AllowColumnFreezing=="Yes"){var a=b.GetFreezeOuterDivElement();if(a!=null){Listener.Unload(a)}}},UnregisterBehaviour:function(a){WG50Engine.UnregisterGrid(a)},OnGridLoad:function(a){if(!IS.ie){var b=a.FrameObj.style.height;a.FrameObj.style.height="0px";a.FrameObj.style.height=b;WGMozEngine.OnTableResize(a);if(a.LayoutSettings.AllowColumnFreezing=="Yes"){WGUIEngine.InvalidateFreezeContainer(a)}}a.IsLoaded=true;WG50Engine._OnResize(true,true)},OnOuterFrameResize:function(){},EmulateAttributes:function(a){if(IS.w3cs||IS.ie9s||!IS.ie){WG50Engine._EmulateAttributes(a)}},_EmulateAttributes:function(b){if(b._attrInit){return}if(typeof(b.attributes)!="undefined"){for(var c=0;c<b.attributes.length;c++){var a=b.attributes[c].name.toLowerCase();var e=new Array("gridId","tblName","subId","tblLevel","colName","noEdit","keyValue","relNames","recordIndex","parentGroupIndex","hasParent","isGrouped","isSorted","groupIndex","sortOrder","parentIndex","childrenLoaded","fullPath","filterText","filterType","oldText","oldCellValue","srRC","srLevel","parentValue","csRowPos","rowChecker","cellValue","isRowChecked","childNotExpandable");for(var d=0;d<e.length;d++){if(e[d].toLowerCase()==a){a=e[d];break}}var f=b[a];if(typeof(f)=="undefined"){b[a]=b.attributes[c].value}}}b._attrInit=true},SetMenuCssFile:function(b,a){if(typeof(Menu)!="undefined"){b.cssFile=a}},OnBeforePrint:function(){var e=WG50Engine.GetWebGrids();for(var d in e){var c=e[d];if(typeof(c)=="function"){continue}var a=c.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);if(ISEvent.Raise(c.LayoutSettings.ClientSideEvents.OnBeforePrint,c.Id)){a.style.display="";if(c.BrowserPrintSettings.GridLayout=="AsDisplayedInBrowser"){a.style.overflow="hidden"}else{a.style.overflow="visible"}if(!c.BrowserPrintSettings.PrintStatusBar){var b=c.GetElement(WG40.STATUSBOX,WG40.HTMLDIV);if(b){b.style.display="none"}}}}},OnAfterPrint:function(){var e=WG50Engine.GetWebGrids();for(var d in e){var c=e[d];if(typeof(c)=="function"){continue}var a=c.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);if(ISEvent.Raise(c.LayoutSettings.ClientSideEvents.OnAfterPrint,c.Id)){a.style.overflow="auto";if(!c.BrowserPrintSettings.PrintStatusBar){var b=c.GetElement(WG40.STATUSBOX,WG40.HTMLDIV);if(b){b.style.display=""}}}}},OnFrameMouseUp:function(b){if(event.type=="contextmenu"||event.button==2){var a=event.srcElement;if(a&&a.tagName){if(a.tagName=="INPUT"||a.tagName=="IMG"||a.tagName=="SELECT"||a.tagName=="TEXTAREA"){return true}}var c=b.GetElement(WG40.STATUSBOX,WG40.HTMLDIV);if(c&&c.contains(a)){return false}event.cancelBubble=true;event.returnValue=false;return false}},OnBeforeDeactivate:function(h,g,j,k){var d=ISGetObject(h);if(d.IsOnBlur){return}try{var i=event?event.srcElement:null;var a=event?event.toElement:null;if(!i){i=j}if(!a){a=k}if((i.tagName=="DIV"&&(i.id==h+IS.FRAMESUFFIX)&&a.tagName=="BODY")||(a.tagName=="BODY"&&i.tagName=="TD")){window.setTimeout(function(){d.EnsureActiveEditCellFocus()},200);return}var b=d.FrameObj;if(IS.ie){if(i.tagName=="IFRAME"&&a.tagName=="BODY"&&WGUIEngine.IsWebGridElement(d,i)){return}else{if(i.tagName=="DIV"&&b.contains(i)&&a.tagName=="BODY"){return}}}if(!b.contains(a)){var f=WGUIEngine.IsWebGridElement(d,a);if(!f){WG50Engine.OnBlur(d,a);wg_Global.ActiveGrid=null}}}catch(c){}},OnActivate:function(b){var a=wgGetActiveGrid();if(!a||b!=a){wg_Global.ActiveGrid=b;WG50Engine.FocusGrid(ISGetObject(b))}},OnWindowLoad:function(){var c=WG50Engine.GetWebGrids();for(var d=0;d<c.length;d++){var f=c[d];var b=f.FrameObj;if(f.NeedFocus){WG50Engine.FocusGrid(f,true);f.NeedFocus=false}if(IsGecko30()){WG50Engine.InitializeMozilla(f)}for(var e=0;e<f.WebCombos.length;e++){if(typeof(wcGetComboById)!="function"){break}f.WebCombos[e].Id=f.WebCombos[e].Id.replace(/\$/g,"_");var a=wcGetComboById(f.WebCombos[e].Id);if(a){a.FrameObj.style.display="none";b.insertAdjacentElement("beforeEnd",a.FrameObj);if(parseFloat(a.MajorVersion)>=4&&typeof(WGEditEngine)=="object"){WGEditEngine.ApplyWebCombo40ElegantStyle(f,a)}}}if(f.LayoutSettings.AutoFitColumns){WGUIEngine.AutoFitColHeaders(f)}if(f.IsClassicPaging()&&f.LayoutSettings.PagingStyleUI=="Slider"){WGPageEngine.CreateSliderBar(f)}if(f.LayoutSettings.InitialView=="PivotChartView"||f.LayoutSettings.InitialView=="PivotChartViewExclusive"){f.SwitchToPivotChartView()}else{if(f.LayoutSettings.InitialView=="Both"){WGChartEngine.SetChartElementVisibility(f,true,true)}}setTimeout(function(){if(f.CurrentViewMode=="PivotChartView"){WGChartEngine.SetGridElementVisibility(f,false,true)}},100);if(f.BindingOperationMode=="ClientBinding"){WGBindingEngine.PrepareTemplate(f);if(f.ClientBindingSettings.FetchDataOnPageLoad&&f.TotalRows==0){f.LoadData()}}WG50Engine.DeserializeClientStorage(f)}WG50Engine.OnResize()},OnWindowScroll:function(){if(WG50Engine.LockScrollTop){WG50Engine.LockScrollTop=false;document.body.scrollTop=WG50Engine.LastScrollTop}},OnWindowUnload:function(b){var a=document.body;a.onresize=null;window.detachEvent("onscroll",WG50Engine.OnWindowScroll);window.detachEvent("onload",WG50Engine.OnWindowLoad);window.detachEvent("onload",function(){WG50Engine.OnGridLoad(b)});window.detachEvent("onresize",function(){WG50Engine.OnResize()});if(b.LayoutSettings!=null&&b.LayoutSettings.AllowBatchUpdate){window.detachEvent("onbeforeunload",function(){WGBatchEngine.OnBeforeUnload(b)})}a.detachEvent("onmousemove",WG50Engine.OnBodyMouseMove);a.detachEvent("onmouseup",WG50Engine.OnBodyMouseUp);a.detachEvent("onmousedown",WG50Engine.OnBodyMouseDown)},OnBodyMouseMove:function(){WGUIEngine.OnBodyMouseMove()},OnBodyMouseUp:function(){WGUIEngine.OnBodyMouseUp()},OnBodyMouseDown:function(){WGUIEngine.OnBodyMouseDown()},OnFrameMouseMove:function(a){a.style.left=plGetCurX()-25+"px";a.style.top=plGetCurY()-25+"px"},OnFrameMouseOver:function(){if(event.button==0){var a=event.srcElement;if(a&&((a.tagName=="TD"&&a.currentStyle.textOverflow=="ellipsis")||a.tagName=="NOBR"||(a.tagName=="SPAN"&&typeof(a.content)!="undefined"))){if(wg_Global.TTId!=0){clearTimeout(wg_Global.TTId)}wg_Global.TTId=setTimeout(function(){WGUIEngine.ShowToolTip(a)},wg_Global.ToolTipDelay)}}},OnFrameFocus:function(c){if(c.IsOnBlur){return}if(!IS.ie){if(!c.HasFocus()){WG50Engine.FocusGrid(c,true)}}if(!c.LastSelObj){if(IS.safari||IS.moz){return}var d=c.GetRootTable();if(d.GetElement(WG40.BODY,WG40.HTMLTABLE).rows.length>0){d.SelectRow(0)}}else{if(c.ActiveEditCell){c.EnsureActiveEditCellFocus()}else{try{if(c.LastSelObj.type=="Row"){var a=wgGetCellByPosition(c.LastSelObj.element,0);a.setActive()}else{c.LastSelObj.element.setActive()}}catch(b){}}}},OnTableFocus:function(b){var c=ISPosLib.getScrollTop(document);var a=b.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);WG50Engine.LockScrollTop=true;WG50Engine.LastScrollTop=c;WG50Engine.LastTableScrollTop=a.scrollTop;setTimeout(function(){if(WG50Engine.LockScrollTop){WG50Engine.LockScrollTop=false}},20)},OnTableResize:function(a){var b=ISGetObject(a.childNodes[0].gridId);if(b.LayoutSettings.AutoWidth){WG50Engine.ResizeTable(a.childNodes[0])}if(b.FreezePaneActive&&!b.IsInProgress){var c=WGUIEngine.GetFreezeVisibleColumnOffset(b,0);if(c>0){WGUIEngine.SetFreezeScrollBarPosition(b,c,true);if(WGUIEngine.GetFreezeScrollBarPosition(b)!=c){setTimeout(function(){WGUIEngine.SetFreezeScrollBarPosition(b,c,true)},100)}}}if(IS.moz){WGMozEngine.OnResize(b)}},OnTableScroll:function(i,f,h,l){var c=i.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);var k=c.scrollTop+c.offsetHeight;WG50Engine.EmulateAttributes(c.childNodes[0]);var j=ISGetObject(c.childNodes[0].gridId);var n=j.Tables[c.childNodes[0].tblName];var b=n.GetElement(WG40.COLHEADER,WG40.HTMLDIV);if(j.LayoutSettings.AutoFitColumns){b.scrollLeft=0}if(j.HaltLoadMore){j.HaltLoadMore=false;return}if(WG50Engine.LockScrollTop){WG50Engine.LockScrollTop=false;c.scrollTop=WG50Engine.LastTableScrollTop}if(b.scrollLeft!=c.scrollLeft||f){if(j.LayoutSettings.Hierarchical){b.childNodes[0].style.width=(c.scrollWidth+j.ScrollBarSize)+"px"}var m=c.scrollLeft;if(f){m=h}WG50Engine.ResizeTable(c.childNodes[0]);b.scrollLeft=m;if(n.Get("ColumnFooters")=="Yes"){var a=n.GetElement(WG40.COLFOOTER,WG40.HTMLDIV);a.scrollLeft=m}}if(j.LastEditObj){var d=j.LastEditObj.element;j.ExitEditMode()}if(j.ActionElement!=null){j.ClearActionElement()}if(!ISEvent.Raise(j.LayoutSettings.ClientSideEvents.OnScroll,j.Id)){return}if(c.scrollSource!="_OnFreezeScroll"){if(j.LayoutSettings.AllowColumnFreezing=="Yes"&&!j.FreezePaneActive){c.scrollSource="OnTableScroll";WGUIEngine.SetFreezeScrollBarPosition(j,c.scrollLeft);setTimeout(function(){c.scrollSource=null},10)}}var e=(WG50Engine.HasVSBar(c)&&!IS.opera?17:0)+c.scrollHeight;if(c.scrollHeight<c.offsetHeight){return}if(!IS.ie&&c.scrollHeight<=c.offsetHeight){return}if(k+2>=e){if(n.GroupedColumns.length>0){return}if(!j.IsInProgress&&j.LayoutSettings.PagingMode=="VirtualLoad"&&!l){WG50Engine.ExecuteFlyPostback(c.childNodes[0].gridId,"More")}}},OnResize:function(b){if(WG40.ForceBogusResize){WG50Engine._OnResize(b)}if(wg_Global.GlobalResizeID!=0){clearTimeout(wg_Global.GlobalResizeID);wg_Global.GlobalResizeID=0}else{WG50Engine._OnResize(b)}var a=(b?"true":"false");wg_Global.GlobalResizeID=setTimeout("WG50Engine._OnResize("+a+")",50)},_OnResize:function(e,d){var b=WG50Engine.GetWebGrids();for(var c=0;c<b.length;c++){var f=b[c];if(IS.ie){if(f.LayoutSettings.AutoHeight){f.NeedHeightResize=true;WGUIEngine.GetGridHeight(f.FrameObj.parentElement);if(IS.ie&&IS.IsXHTMLDocType()){WGUIEngine.OnGridResize(f)}}else{if(f.FrameObj.style.height!=""){if(f.FrameObj.style.height.indexOf("%")>0){f.CacheTBodyHeight=null}}}if(f.LayoutSettings.AutoWidth){f.NeedWidthResize=true;WGUIEngine.GetGridWidth(f.FrameObj.parentElement)}var a=f.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);if(a!=null&&a.scrollLeft>(a.scrollWidth-a.clientWidth-17)){WG50Engine.OnTableScroll(f,null,null,true)}if(f.LayoutSettings.Hierarchical&&f.FrameObj.style.width.indexOf("%")>-1){WG50Engine.ResizeTable(f.RootTable.GetElement(WG40.BODY,WG40.HTMLTABLE))}}else{WGMozEngine.OnTableResize(f);WGMozEngine.OnResize(f)}if(f.LayoutSettings.AutoFitColumns&&f.FrameObj.style.width.indexOf("%")>=0){if(f.TempResizeID!=0){clearTimeout(f.TempResizeID)}setTimeout("WGUIEngine.AutoFitColumns('"+f.Name+"')",500)}if(f.LayoutSettings.AllowColumnFreezing=="Yes"){WGUIEngine.InvalidateFreezeContainer(f)}if(e&&f.CacheTBodyHeight==null){WGUIEngine.GetTableBodyHeight(f.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV),(IS.ie&&IS.IsXHTMLDocType()))}}},OnPreFlyPostback:function(b){if((b.LastEditObj||b.ActiveEditCell)&&!b.IsExitingEdit){var d=b.LastEditObj;var c=b.ActiveEditCell;var f=b.Tables[((d)?d.tblName:c.tblName)];var a=f.Get("AllowEdit")=="Yes";var e;if(d){e=d.cellElement.parentElement}else{e=c.rowElement}if(a&&e.type=="Record"){if(d){WGEditEngine.ExitEditMode(d)}}}},OnPostFlyPostback:function(a){a.IsInProgress=true;a.SetBusy()},FocusGrid:function(e,d){var f=e.LastSelObj;if(e.IsOnBlur){return}if(!e.Get("Visible")){return}if(!ISEvent.Raise(e.LayoutSettings.ClientSideEvents.OnFocus,e.Id)){return}if(d){wg_Global.ActiveGrid=e.Name}if(WG50Engine.IsSelectedObjectValid(f)){var h=e.Tables[f.tblName];var c=h.Get("CellClickAction");if(f.type=="Row"||c=="RowSelect"){WGEventEngine.RedrawSelectedRowBorder(f.GetRowElement(),"");var a=e.ActiveEditCell;if(a&&wgIsSameRow(a.rowElement,f.GetRowElement())){WGEditEngine.HighlightEditCell(a.element,"Redraw");e.EnsureActiveEditCellFocus()}else{var b=wgGetCellByPosition(f.element,0);if(b!=null){b.setActive()}}}else{var h=e.Tables[f.tblName];WGEventEngine.HighlightCell(f.element,h.GetSelRowStyle(),h.GetFocusCellStyle(),"",true);f.element.setActive()}}else{if(d){wg_Global.ActiveGrid=e.Name;var i=e.GetRootTable().GetElement(WG40.BODY,WG40.HTMLTABLE);if(i.rows.length>0){if(IS.safari){return}if(wgIsRecordRow(i.rows[0])){WGEventEngine.ProcessMouseEvents(wgGetCellByPosition(i.rows[0],0),true);wgGetCellByPosition(i.rows[0],0).setActive()}}}}},GetWebGrids:function(){var b=new Array();for(var c=0;c<IS.RuntimeObjects.length;c++){var a=IS.RuntimeObjects[c];if(typeof(a)=="object"&&a.ClassName=="WebGrid"&&a.Version=="10.0.7200"){b[b.length]=a}}return b},GetGridByElement:function(a){var c=WG50Engine.GetGridNameByRow(a);var b=ISGetObject(c);return b},GetTableByElement:function(e){var d=WG50Engine.GetTableNameByRow(e);var b=WG50Engine.GetGridNameByRow(e);var a=ISGetObject(b);var c=a.Tables[d];return c},GetColumnByElement:function(b){var a=wgGetColNameByCell(b);var d=b.parentElement;if(a){var c=ISGetObject(WG50Engine.GetGridNameByRow(d));var e=c.Tables[WG50Engine.GetTableNameByRow(d)];return e.Columns.GetNamedItem(a)}return null},GetCellByElement:function(b){var d=WG50Engine.GetTR(b);if(d){var c=WG50Engine.GetRowByElement(d);if(c){var a=wgGetColNameByCell(b);return c.GetCell(a)}}return null},GetRowByElement:function(a){var f=WG50Engine.GetTR(a);if(f){var e=WG50Engine.GetTableNameByRow(f);var c=WG50Engine.GetGridNameByRow(f);var b=ISGetObject(c);var d=b.Tables[e];if(d.IsUseColumnSet){f=wgGetRootRow(f)}return d.ToRowObject(f)}return null},GetRowByElement2:function(a,d){for(var b=0;b<d.length;b++){if(d[b].RowElement==a){return d[b]}if(d[b].Children!=null){var c=WG50Engine.GetRowByElement2(a,d[b].Children);if(c){return c}}}},IsSelectedObjectValid:function(c){if(c){if(c.element){try{var d=c.GetRowElement();var b=c.element;if(c.type=="Row"){if(d.rowIndex!=-1){return true}}else{if(b.cellIndex!=-1&&b.parentElement!=null){return true}}}catch(a){return false}}}return false},GetTableSubId:function(a){if(a!=null){WG50Engine.EmulateAttributes(a)}if(a.tagName=="TR"||a.tagName=="TD"){return WG50Engine.GetTable(a).subId}else{if(a.tagName=="TABLE"){return a.subId}}},GetGridNameByRow:function(a){return WG50Engine.GetTable(a).gridId},GetTableNameByRow:function(a){return WG50Engine.GetTable(a).tblName},GetTable:function(b){var a=b.parentElement;while(a&&a.tagName!="TABLE"){a=a.parentElement}if(a!=null){WG50Engine.EmulateAttributes(a)}return a},ResizeTable:function(l,a){if(l!=null){WG50Engine.EmulateAttributes(l)}var g=ISGetObject(l.gridId);var j=g.Tables[l.tblName];var m=j.GetElement(WG40.COLHEADER,WG40.HTMLTABLE);var b=m.rows[0].cells[m.rows[0].cells.length-1];if(l.parentElement==null){return}if(WG50Engine.HasVSBar(l.parentElement)||(g.LayoutSettings.AllowColumnFreezing=="Yes"&&WGUIEngine.IsFreezeContainerValid(g))){if(!g.IsRightToLeft()){if(!b.locked){WG50Engine.SetColHeaderPaddingWidth(j,b,(!IS.w3cs?"17px":"30px"))}}}else{if(!b.locked){WG50Engine.SetColHeaderPaddingWidth(j,b,"100%");if(IS.moz){WG50Engine.SetColHeaderPaddingWidth(j,b,"99%");setTimeout(function(){WG50Engine.SetColHeaderPaddingWidth(j,b,"100%")},10)}}}if(IS.ie&&!a){if(g.FrameObj.style.width.indexOf("%")>-1){setTimeout(function(){WG50Engine.ResizeTable(l,true)},10)}}if(g.LayoutSettings.Hierarchical){if(g.GetMaxWidth()>g.FrameObj.offsetWidth){if(!b.locked){g.FixPadColumnWidth()}}else{var i=g.GetRootTable();var c=i.GetElement(WG40.COLGROUP);var h=c.childNodes[c.childNodes.length-1];h.width="100%";WG50Engine.SetColHeaderPaddingWidth(j,b,"100%");b.locked=false}if(g.LayoutSettings.Hierarchical&&g.FrameObj.style.width.indexOf("%")>-1){var d=j.GetElement(WG40.COLHEADER,WG40.HTMLDIV);var f=j.GetElement(WG40.BODY,WG40.HTMLDIV);var e=d.children[0];if(d.offsetWidth>f.scrollWidth+g.ScrollBarSize){e.style.width="100%"}else{var k=f.scrollWidth+g.ScrollBarSize;if(k>e.offsetWidth){e.style.width=k+"px"}}}}},FindTBody:function(a,e){var c=a.RootTable.GetElement(WG40.BODY,WG40.HTMLTABLE);var d=c.getElementsByTagName("tbody");for(var b=0;b<d.length;b++){if(d[b].id==e.id){return d[b]}}return null},GetCommandElement:function(c,f,e){var h=c.GetElement(WG40.STATUSBOX,WG40.HTMLDIV);if(h==null){return}var j=h.children[0];var b=j.rows[0].cells;for(var d=0;d<b.length;d++){var a=b[d];if(IS.GetAttr(a,"type")==f){return a.children[0].rows[0].cells[e]}}return null},ToBoolString:function(a){return(a?"True":"False")},LoadDefaultCulture:function(a){if(typeof(ISCultureInfo)=="function"){a.CultureInfo=CultureInfoEngine.GetDefaultCulture();return a.CultureInfo}return null},HasVSBar:function(a){if(a.offsetHeight!=a.clientHeight){return true}else{return false}},HasHSBar:function(a){if(a.offsetWidth!=a.clientWidth){return true}else{return false}},SetColHeaderPaddingWidth:function(d,c,e){if((typeof(e)=="string"&&e.length==parseInt(e).toString().length)||typeof(e)=="number"){e=parseInt(e)+"px"}var b=d.GetElement(WG40.COLHEADERGROUP);if(b){var a=b.childNodes[b.childNodes.length-1];a.width=e}c.style.width=e;if(d.Get("ColumnFooters")=="Yes"){var b=d.GetElement(WG40.COLFOOTERGROUP);var a=b.childNodes[b.childNodes.length-1];a.width=e}},GetTD:function(b){if(!b){return null}while(b.tagName!="TD"){try{b=b.parentElement;if(!b){return null}}catch(a){return null}}return b},GetTDorTH:function(b){if(!b){return null}while(b.tagName!="TD"&&b.tagName!="TH"){try{b=b.parentElement;if(!b){return null}}catch(a){return null}}return b},GetTR:function(a){while(a&&a.tagName!="TR"){a=a.parentElement}return a},GetFirstRecordRowIndex:function(b){var a=b.rows[0];while(a!=null&&a.type!="Record"){a=b.rows[a.rowIndex+1]}if(a!=null){return a.rowIndex}else{return -1}},GetColGroupIndex:function(c,a){var b=c.Grid;if(b.FreezePaneActive){if(IS.ie){cellIndex=WG50Engine.GetRealCellIndex(a)}else{if(b.FreezeConfig!=null){cellIndex=a.cellIndex-b.FreezeConfig[0].length}else{cellIndex=a.cellIndex}}}else{cellIndex=a.cellIndex}return cellIndex},GetParentElement:function(c,a){var d=c.parentElement;for(var b=0;b<a-1;b++){d=d.parentElement}return d},GetNextRow:function(c,b){if(b.rowIndex==c.rows.length-1){return null}var a=c.rows[b.rowIndex+1];if(a){WG50Engine.EmulateAttributes(a)}return a},GetPreviousRow:function(c,b){if(b.rowIndex==0){return null}var a=c.rows[b.rowIndex-1];if(a){WG50Engine.EmulateAttributes(a)}return a},GetChildNodes:function(c,a){var d=c.childNodes[0];for(var b=0;b<a-1;b++){d=d.childNodes[0]}return d},ExecuteFlyPostback:function(g,a,d,e){var f=ISGetObject(g);var j=f.XmlHttp;var b="";var h=g;if(f.IsPreviewMode){alert("Not supported in Preview mode!");return}f.XmlReq=ISXmlHttpEngine.CreateRequestXml(f.GetType());WG50Engine.OnPreFlyPostback(f);var k=ISXml.GetNode(f.XmlReq,"//request");f.RequestId=0;if(f.IsInProgress){if(a=="More"&&f.LastAction=="AddRow"){return}if((a=="UpdateRow"&&f.LastAction=="LoadChild")||(a=="RowChanged"&&f.LastAction=="UpdateRow")){f.NextQueue=[a,d];return}if(f.LayoutSettings.InProgressUIBehavior=="DisplayMessageBox"){alert(f.GetString("MessageBoxText/InProgress"))}return}if(!ISEvent.Raise(f.LayoutSettings.ClientSideEvents.OnBeforeRequest,h,a,d)){return}k.setAttribute("id",h);f.TempLRO=d;if(f.BindingOperationMode=="ClientBinding"){var i=f.ClientBindingSettings.DataSourceType;if(f.EnableSection508Standards){WGBindingEngine.PrepareTemplate(f,true)}if(i=="ClientDataSource"){WGBindingEngine.HandleClientOperation(f,a,e,d);return}else{if(i=="WebService"||i=="WcfService"||i=="AdoDataService"){if(a!="Custom"){WGServiceEngine.PrepareCommand(f,a,e,d);return}}}}if(f.AllowPivotCharting&&f.LayoutSettings.InitialView!="PivotChartViewExclusive"&&f.LayoutSettings.InitialView!="Both"){if(f.CurrentViewMode=="PivotChartView"&&!f.RequireInvalidateFreezeContainer){switch(a){case"ColumnSort":case"Group":case"Ungroup":case"ChangeGroup":case"ColumnFilter":case"LoadData":case"PagingNext":case"PagingPrev":case"PagingTo":case"BatchUpdate":f.SwitchToGridView();break}}}switch(a){case"More":if(!WGDataEngine.PrepareMore(f,k,h)){return false}break;case"LoadGroup":if(!WGDataEngine.PrepareLoadGroup(f,k,h,d,e)){return false}break;case"ColumnSort":if(!WGDataEngine.PrepareColumnSort(f,k,h,d)){return false}break;case"Group":if(!WGDataEngine.PrepareGroup(f,k,h,d,"Group")){return false}break;case"Ungroup":if(!WGDataEngine.PrepareGroup(f,k,h,d,"Ungroup")){return false}break;case"ChangeGroup":if(!WGDataEngine.PrepareGroup(f,k,h,d,"ChangeGroup")){return false}break;case"ColumnFilter":if(!WGDataEngine.PrepareFilter(f,k,h,d)){return false}break;case"LoadChild":if(!WGHierEngine.PrepareLoadChild(f,k,h,d)){return false}break;case"ColumnChange":if(!WGDataEngine.PrepareColumnChange(f,k,h,d)){return false}break;case"LoadData":if(!WGBindingEngine.PrepareLoadData(f,k,h)){return false}break;case"Refresh":if(!WGDataEngine.PrepareRefresh(f,k,h)){return false}break;case"RefreshAll":if(!WGDataEngine.PrepareRefreshAll(f,k,h)){return false}break;case"Custom":if(!WGDataEngine.PrepareCustomAction(f,k,h)){return false}break;case"AddRow":if(!WGEditEngine.PrepareAddRow(f,k,h,d)){return false}break;case"UpdateRow":if(!WGEditEngine.PrepareUpdateRow(f,k,h,d)){return false}break;case"DeleteRow":if(!WGEditEngine.PrepareDeleteRow(f,k,h,d)){return false}break;case"Export":if(!WGDataEngine.PrepareExport(f,k,h,d)){return false}break;case"ButtonClick":if(!WGDataEngine.PrepareButtonClick(f,k,h,d)){return false}break;case"ChildTableRefresh":if(!WGHierEngine.PrepareRefreshChildTable(f,k,d)){return false}break;case"LoadSelfRefChild":if(!WGDataEngine.PrepareLoadSelfReferencingChild(f,k,h,d)){return false}break;case"LoadPreviewRow":if(!WGDataEngine.PrepareLoadPreviewRow(f,k,h,d)){return false}break;case"RowChanged":if(!WGDataEngine.PrepareRowChanged(f,k,h,d)){return false}break;case"PagingNext":case"PagingPrev":case"PagingTo":if(!WGPageEngine.PreparePaging(f,k,h,a,d)){return false}break;case"Charting":if(!WGChartEngine.PrepareCharting(f,k,h,d)){return false}break;case"RetrievePivotData":if(!WGChartEngine.PreparePivotDataRetrieval(f,k,h,d)){return false}break;case"BatchUpdate":if(!WGBatchEngine.PrepareBatchUpdate(f,k,h,d)){return false}break}f.LastRequestObj=d;f.LastAction=a;if(k!=null&&f.IsClassicPaging()){k.setAttribute("totalPages",f.GetTotalPages())}var c=f.XmlHttp.Asynchronous;j.Send();if(c){WG50Engine.OnPostFlyPostback(f)}},OnResponseError:function(c,d){c.LastError=d;if(!ISEvent.Raise(c.LayoutSettings.ClientSideEvents.OnUnhandledError,c.Name,c.LastAction,c.LastRequestObj,c.LastError)){return}var b=d;var e=c.XmlHttp.XmlHttp;if(b.indexOf("Server Error")>=0||b.indexOf("Stack Trace")>=0||(e!=null&&e.status==500)){if(c.LayoutSettings.DisplayDetailsOnUnhandledError){WGUIEngine.DisplayErrorBox(c,d,c.GetString("MessageBoxText/UnhandledError"))}}else{if(b!=""){var a=IS.GetFormAction(b);window.location=a;return}else{c.LastError="Unable to communicate with server.";if(c.LayoutSettings.DisplayDetailsOnUnhandledError){WGUIEngine.DisplayErrorBox(c,c.LastError,"Unhandled exception.")}}}c.IsInProgress=false;c.SetIdle();c.SetStatus1("","readyerror","CommonText/ReadyError");c.SetStatusIcon("Failed");c.IsStatusLocked=true;c.IsUnhandledError=true},OnResponse:function(g,s,isJson){var xr=g.XmlResp;var status;var errorMessage;if(isJson){status=s.status;errorMessage=s.error}else{status=ISXml.GetNodeText(xr,"//status");errorMessage=ISXml.GetNodeText(xr,"//error")}if(!ISEvent.Raise(g.LayoutSettings.ClientSideEvents.OnResponse,g.Id,status)){return}if(status=="Error"){alert(errorMessage.replace(/\\n/ig,"\n"));WG50Engine.HandleCommonError(g);g.SetStatus1("","ready","CommonText/Ready");g.SetIdle();g.IsInProgress=false;return}if(isJson){if(g.ClientBindingSettings.DataSourceType=="ServerDataSource"){xr=WGBindingEngine.MapJsonToXml(g,s)}else{WGServiceEngine.OnResponse(g,s);return}}var action=ISXml.GetNodeText(xr,"//action");if(!ISEvent.Raise(g.LayoutSettings.ClientSideEvents.OnActionDispatched,g.Id,action)){return}switch(action){case"More":WGDataEngine.ResponseMore(g,xr);break;case"LoadGroup":WGDataEngine.ResponseLoadGroup(g,xr);break;case"ColumnSort":WGDataEngine.ResponseColumnSort(g,xr);break;case"Group":case"Ungroup":case"ChangeGroup":case"ColumnChange":WGDataEngine.ResponseGroup(g,xr);break;case"ColumnFilter":WGDataEngine.ResponseFilter(g,xr);break;case"LoadChild":WGHierEngine.ResponseLoadChild(g,xr);break;case"Refresh":case"LoadData":WGDataEngine.ResponseRefresh(g,xr);break;case"RefreshAll":WGDataEngine.ResponseRefreshAll(g,xr);break;case"Custom":if(typeof(wgCustomActionResponse)=="function"){wgCustomActionResponse(g,xr)}break;case"AddRow":WGEditEngine.ResponseAddRow(g,xr);break;case"UpdateRow":WGEditEngine.ResponseUpdateRow(g,xr);break;case"DeleteRow":WGEditEngine.ResponseDeleteRow(g,xr);break;case"Export":WGDataEngine.ResponseExport(g,xr);break;case"ButtonClick":WGDataEngine.ResponseButtonClick(g,xr);break;case"ChildTableRefresh":WGHierEngine.ResponseRefreshChildTable(g,xr);break;case"LoadSelfRefChild":WGDataEngine.ResponseLoadSelfReferencingChild(g,xr);break;case"LoadPreviewRow":WGDataEngine.ResponseLoadPreviewRow(g,xr);break;case"Paging":WGPageEngine.ResponsePaging(g,xr);break;case"Charting":case"RetrievePivotData":WGChartEngine.ResponseCharting(g,xr);break;case"BatchUpdate":WGBatchEngine.ResponseBatchUpdate(g,xr);break}g.IsInProgress=false;WG50Engine.ReflectNoDataStatus(g);var xScr=xr.selectSingleNode("//clientScripts");if(xScr){var scripts=xScr.text;if(scripts!=""){var aScr=scripts.split(");");for(var i=0;i<aScr.length;i++){if(aScr[i]!=""){var scrToEval=aScr[i];if(scrToEval.indexOf("(")>=0){scrToEval+=")"}eval(scrToEval)}}}}if(!ISEvent.Raise(g.LayoutSettings.ClientSideEvents.OnAfterResponseProcess,g.Name,action,g.LastRequestObj,xr)){return}g.LastRequestObj=null;g.TempLRO=null;g.IsUnhandledError=false;g.IsStatusLocked=false;g.SetIdle();if(g.NextQueue){WG50Engine.ExecuteFlyPostback(g.Name,g.NextQueue[0],g.NextQueue[1]);g.NextQueue=null}},OnBlur:function(d,a){var g=d.LastSelObj;d.IsOnBlur=true;if(!ISEvent.Raise(d.LayoutSettings.ClientSideEvents.OnLostFocus,d.Name)){return}if((d.LastEditObj||d.ActiveEditCell)&&!d.IsExitingEdit){var h=d.LastEditObj;var f=d.ActiveEditCell;var j;if(h){j=h.cellElement.parentElement}else{j=f.rowElement}if(wgIsRowDirty(j)||wgIsRowMarkedEdit(j)){var i=d.ExitEdit(3)[2];if(!i){if(j.type=="NewRow"){WGEditEngine.HighlightEditCell(f.element,"Clear",f.element);WGEditEngine.InitializeNewRow(d,j)}WGEventEngine.SelectRow(j,d.GetCurSelImage())}try{a.focus()}catch(b){}}else{d.ExitEditMode(true)}}if(g){if(g.type=="Row"){WGEventEngine.RedrawSelectedRowBorder(g.GetRowElement(),"",true)}else{WGEventEngine.HighlightCell(g.element,d.GetBlurRowStyle(),"0px","",true)}}if(d.LayoutSettings.AllowBatchUpdate){if(d.LayoutSettings.BatchUpdateSettings.NotifyOnLostFocus&&d.GetChangesCount()>0){WGBatchEngine.ShowCalloutNotification(d)}}var c=function(){d.IsOnBlur=false};window.setTimeout(c,50)},RemoveAttribute:function(c,a){for(var b=0;b<c.attributes.length;b++){if(a.indexOf(c.attributes[b].name)==-1){c.removeAttribute(c.attributes[b].name);b--}}},SetLastSelectedObject:function(c){var l=c.XmlDt;var a=l.documentElement;var f=c.LastSelObj;if(f&&f.element){var h=ISXml.GetNode(l,"//selectedObject");if(h){a.removeChild(h)}var b=l.createNode(1,"selectedObject","");var g=f.GetRowElement();if(!g||g.rowIndex==-1||g.type=="NewRow"||g.type=="FilterRow"){return}g=wgGetRootRow(g);b.setAttribute("tblName",f.tblName);b.setAttribute("type",g.type=="Record"?"Row":g.type);b.setAttribute("rowIndex",g.position);b.setAttribute("cellIndex",f.cellIndex==null?"0":f.cellIndex);b.setAttribute("parentIndex",WGUIEngine.GetParentIndex(g));ISXml.CreateCDATA(l,b,"keyValue",(g.keyValue?g.keyValue:""));var j=c.Tables[f.tblName];if(j.HasMultiPrimaryKey&&g.type=="Record"){var k=wgGetKeyValues(g);b.setAttribute("keyCount",k.length);for(var e=0;e<k.length;e++){ISXml.CreateCDATA(l,b,"keyValue"+e,k[e])}}a.appendChild(b)}else{ISXml.RemoveNode(a,"selectedObject")}},UpdateState:function(c){var o=c.StateRestorationLevel;var p=c.GetXml().xml;if(o!="High"){var l=ISXml.CreateXmlDocument();ISXml.LoadXml(l,c.XmlDt.xml);var h=ISXml.GetNode(l,"//LayoutSettings");var d="TotalLoadedRows,TotalRows,CurrentPageIndex,TotalPages";for(var f=0;f<h.childNodes.length;f++){h.removeChild(h.childNodes[f]);f--}if(o=="Low"){var r="Name,DataMember,IsRootTable,DataKeyField";var k="FilterBarVisible,Culture,Hierarchical";var b="Name,IsGrouped,IsSorted,Visible,Width,EditType,WebComboID,ColumnType,FilterEditType";var n=["BrowserPrintSettings","FlyPostBackSettings","UtilizedCustomEditors","WebCombos"];var s=["PreviewRowSettings","ColumnSetSettings","SelfReferencingSettings","FocusCellStyle"];WG50Engine.RemoveAttribute(l.documentElement,d);WG50Engine.RemoveAttribute(h,k);for(sTbl in c.Tables){var q=c.Tables[sTbl];var t=null;if(typeof(q)=="function"){continue}if(q.IsRootTable){t=l.selectSingleNode("//RootTable")}else{t=l.selectSingleNode("//WebGridTable[@Name='"+q.Id+"']")}WG50Engine.RemoveAttribute(t,r);for(var u in s){ISXml.RemoveNode(t,s[u])}var a=t.selectNodes("Columns/WebGridColumn");for(var g=0;g<a.length;g++){WG50Engine.RemoveAttribute(a[g],b)}}for(var m in n){ISXml.RemoveNode(l.documentElement,n[m])}}p=l.xml;l=null}c.CustomStateString=p;var e=document.getElementById(c.xmlInputHiddenUniqueID);if(e==null){e=document.getElementById(c.xmlInputHiddenUniqueID.replace(/:/g,"_"))}if(e==null){e=document.getElementById(c.xmlInputHiddenUniqueID.replace(/\$/g,"_"))}if(e!=null){e.value=escape(p)}},HandleCommonError:function(b){switch(b.LastAction){case"AddRow":case"Insert":var d=b.LayoutSettings.ResetNewRowValuesOnError;var c=b.LastSelObj.GetRowElement();var f=b.LastRequestObj.RowElement;if(d||(f&&!wgIsSameRow(c,f))){try{WGEditEngine.InitializeNewRow(b,f);if(wgIsSameRow(c,f)){WGEventEngine.SelectRow(f,b.GetCurSelImage())}}catch(a){}}break;case"UpdateRow":case"Update":var f=b.LastRequestObj;WGEditEngine.CancelChanges(f.RowElement);break}},SetCheckedRowsData:function(b){var n=b.XmlDt;for(table in b.Tables){var l=b.Tables[table];if(typeof(l)=="function"){continue}var f=l.GetRowCheckerColumn();if(f||l.Get("AllowMultipleSelection")=="Yes"){var h=b.LayoutSettings.RestoreRowSelection;var g=l.GetCheckedRows();if(g.length>0){var m=l.XmlNode;ISXml.RemoveNode(m,"checkedRows");var a=ISXml.GetNode(m,"checkedRows");if(!a){a=ISXml.CreateNodeOnly(n,"checkedRows","")}for(var c=0;c<g.length;c++){var k=ISXml.CreateNode(n,a,"rowKV","");if(l.HasMultiPrimaryKey){var e=wgGetKeyValues(g[c]);for(var d=0;d<e.length;d++){ISXml.CreateCDATA(n,k,"keyValue"+d,e[d])}}else{ISXml.CreateCDATA(n,k,"keyValue",g[c].keyValue)}if(h!="Disabled"){if((h=="RootTableOnly"&&l.IsRootTable)||(h=="ChildTableOnly"&&!l.IsRootTable)||h=="All"){if(!l.Storage.SelectedRows.Contains(g[c])){l.Storage.SelectedRows.Add(g[c])}}}}if(h=="Disabled"){m.appendChild(a)}}else{var m=l.XmlNode;ISXml.RemoveNode(m,"checkedRows")}}}},ReplaceXmlNode:function(f,g,a){var b=g.indexOf("<"+f+">");var c=g.indexOf("</"+f+">");if(b>=0&&c>=0&&c>b){var e=g.substring(0,b);var d=g.substring(c+f.length+3);return e+"<"+f+">"+a+"</"+f+">"+d}},OnViewChanged:function(k,a,h,g){var c=k.Grid;var e=false;if(c.LastClientAction){if(c.LastClientAction.indexOf("ClientService")==-1){e=true;a=c.LastClientAction;if(a.indexOf("Paging")>-1){a="Paging"}else{if(a=="Group"||a=="Ungroup"||a=="ColumnChange"){a="ColumnGroup"}}}}switch(a){case"ColumnSort":case"ColumnFilter":case"Refresh":case"BatchUpdate":if(k.IsRootTable){if(c.FreezePaneActive&&c.FrozenColumns!=null){if(!h){h=new WebGridPartOption();h.Body=true}if(c.RequireInvalidateFreezeContainer){WGUIEngine.InvalidateFreezeContainer(c);c.RequireInvalidateFreezeContainer=false}WGUIEngine.FormatFreezePane(c);WGUIEngine.ProcessFreezeLayout(c,true,h)}else{if(c.LayoutSettings.AllowColumnFreezing=="Yes"&&!c.FreezePaneActive){WGUIEngine.InvalidateFreezeContainer(c);WGUIEngine.SetFreezeScrollBarPosition(c,0,true,false,true)}else{WG50Engine.OnTableScroll(c,true,0,true)}}}c.NeedHeightResize=true;var f=c.FrameObj.parentElement;if(!IS.ie){f=c.FrameObj}if(f.style.height==""){WGUIEngine.AssignInitialHeight(c)}break;case"ColumnGroup":case"RefreshAll":case"Paging":case"LoadData":if(a=="RefreshAll"){WG50Engine.InitializeClientStorage(c);for(var d=0;d<c.UtilizedCustomEditors.length;d++){var b=c.UtilizedCustomEditors[d];if(b!=null){b.baseEditor=null;b.OnPropertiesInitialized()}}}if(typeof(g)=="undefined"){var j=false;if((IS.ie||a=="Paging")&&e){if(c.FreezePaneActive&&c.FrozenColumns!=null){j=true;h=new WebGridPartOption();h.Body=true;WGUIEngine.ProcessFreezeLayout(c,true,h);WGUIEngine.FormatFreezePane(c,true,k.GetElement(WG40.BODY,WG40.HTMLTABLE).rows)}}if(!j){if(c.FreezePaneActive&&c.FrozenColumns!=null){if(!h){h=new WebGridPartOption(true)}WGUIEngine.FreezePane(c,true);WGUIEngine.InvalidateFreezeContainer(c)}else{if(c.LayoutSettings.AllowColumnFreezing=="Yes"&&!c.FreezePaneActive){WGUIEngine.InvalidateFreezeContainer(c);WGUIEngine.SetFreezeScrollBarPosition(c,0,true,false,true)}}}if(!IS.ie&&c.BindingOperationMode=="ClientBinding"){if(c.FreezePaneActive&&c.FreezeConfig!=null){if(k.Get("ColumnFooters")=="Yes"){var l=k.GetElement(WG40.COLFOOTER,WG40.HTMLTABLE);WGUIEngine.RefreshColGroupWidth(k,l.children[0])}}}}else{if(g==0){}}c.NeedHeightResize=true;WGUIEngine.AssignInitialHeight(c);break;case"AddRow":case"UpdateRow":if(c.FreezePaneActive&&c.FrozenColumns!=null){if(!h){h=new WebGridPartOption();h.Footer=true}WGUIEngine.ProcessFreezeLayout(c,true,h)}}if(IsIE8StandardMode()){c.NeedHeightResize=true;WGUIEngine.OnGridResize(c)}if(IS.ie){WGUIEngine.RealignSortIndicators(k);WG50Engine.InitializeIE7XHTML(c);if(c.ClientBindingSettings){if(c.LayoutSettings.PagingMode=="VirtualLoad"&&c.ClientBindingSettings.DataLoadMode!="PagedData"){WG50Engine.FixGroupAlignment(k)}}}if(!k.IsRootTable&&g!=null&&(a=="ColumnGroup"||a=="ColumnSort")){WGUIEngine.RealignSortIndicators(g);WGHierEngine.AlignTableHeader(g);WGHierEngine.AdjRootWidth(g)}if(k.Get("AllowMultipleSelection")=="Yes"){WG50Engine.ClearAllTableSelection(c)}if(c.LayoutSettings.AllowBatchUpdate){WGBatchEngine.UpdateNewRowTemplate(k,c.XmlResp);WGBatchEngine.InvalidateChangesCascade(k,g)}if(c.BindingOperationMode=="ClientBinding"){WGBindingEngine.SynchronizeElements(k)}if(k.Storage!=null){k.Storage.RefreshUI(g)}},FixGroupAlignment:function(g,f){if(IS.ie&&IS.GetIEVersion()>=9&&IS.IsXHTMLDocType()){if(g.GroupedColumns.length>0){var a=f!=null?f:g;var h=a.GetElement(WG40.BODY,WG40.HTMLTABLE);var b=a.GetElement(WG40.COLHEADERGROUP,null,null);for(var c=0;c<h.rows.length;c++){var e=h.rows[c];if(e.isGroupWorkaround){return}}var d=h.insertRow();d.isGroupWorkaround=true;if(b!=null&&b.children.length>0&&b.children[0].cells!=null){for(var c=0;c<b.children[0].cells.length;c++){d.insertCell(-1)}}}}},OnOperationCompleted:function(f,a,e,b){var c=f.Grid;switch(a){case"More":break;case"LoadGroup":var d=b[0];var g=b[1];var h=b[2];if(d!=""&&!isNaN(d)){WGGroupingEngine.SetGroupRowStatus(f,h,d,g)}break;case"AddRow":break}if(c.BindingOperationMode=="ClientBinding"){WGBindingEngine.SynchronizeElements(f,f._PartialRows,e);if(f.Storage!=null){f.Storage.RefreshUI(e)}}else{if(c.LayoutSettings.AllowBatchUpdate&&a=="More"&&f.GroupedColumns.length==0){WGBatchEngine.MoveNewRowsToBottom(f)}}f._PartialRows=null},ClearAllTableSelection:function(b){for(var c in b.Tables){if(c!=null&&typeof(c)=="string"){var a=b.Tables[c];if(typeof(a)!="function"&&a!=null){a.ClearSelectedRows()}}}},GetRealCellIndex:function(a){var d=a.parentElement;var c=0;for(var b=0;b<d.cells.length;b++){if(d.cells[b]==a){return c}c++}return -1},GetRealCellIndexToSetColumnWidth:function(a){var d=a.parentElement;var c=0;for(var b=0;b<d.cells.length;b++){if(d.cells[b]==a){return c}if(!IS.ie9){c++}else{if(d.cells[b].style.display!="none"){c++}}}return -1},GetCellEx:function(l,k,j){var m=l._tableCache;if(m==null){m=l.GetElement(WG40.BODY,WG40.HTMLTABLE,k)}var e=-1;var f=null;if(!m){return null}if(typeof(j)=="string"){if(l.IsUseColumnSet){return wgGetCSCellByName(k,j)}if(l.IsRootTable){if(l._colIndexCache&&typeof(l._colIndexCache[j])=="number"){e=l._colIndexCache[j]}else{if(l._headerRowCache){f=l._headerRowCache}else{f=l.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,k).rows[0];l._headerRowCache=f}}}else{f=l.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,k).rows[0]}if(f){var b=f.cells.length;for(var g=0;g<b;g++){a=f.cells[g];WG50Engine.EmulateAttributes(a);if((a.type=="Column")&&a.colName==j){if(!l._colIndexCache){l._colIndexCache=[]}l._colIndexCache[j]=g;e=g;break}}}}else{var c=k.cells;var h=-1;for(var g=0;g<c.length;g++){var a=c[g];var d="";WG50Engine.EmulateAttributes(a);d=a.type;WG50Engine.EmulateAttributes(a);if(d=="Cell"||d=="GroupCell"||d=="FilterColumn"){h++}if(j==h){e=g;break}}}if(e>=0){return k.cells[e]}return null},GetColumnNameByCell:function(k,b){var j=b.parentElement;var e=k.Grid;var f=null;var h=false;if(!k.IsUseColumnSet){var d=null;var l=b.cellIndex;if(IS.ie&&k.IsRootTable&&e.FreezePaneActive&&e.FreezeConfig!=null&&(wgIsRecordRow(j)||b.style.display=="none")){h=true}if(k.IsRootTable){if(!h&&k._colIndexCache2&&typeof(k._colIndexCache2["index"+l])=="string"){return k._colIndexCache2["index"+l]}else{if(k._headerRowCache){f=k._headerRowCache}else{f=k.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,j).rows[0];k._headerRowCache=f}}}else{f=k.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,j).rows[0]}if(f){d=f.cells}for(var g=0;g<d.length;g++){var a=d[g];var c=a.cellIndex;WG50Engine.EmulateAttributes(a);if(h){c=WG50Engine.GetRealCellIndex(a)}if(b.style.display=="none"){l=WG50Engine.GetRealCellIndex(b)}if(a.type=="Column"&&c==l){if(!h){if(!k._colIndexCache2){k._colIndexCache2=[]}k._colIndexCache2["index"+l]=a.colName}return a.colName}}}else{if(typeof(b.cs)=="undefined"){return null}return k.GetColNameByRowLayout(b.cs,b.r,b.c)}},IsCellEditable:function(d,a,b){if(!a){return false}var f=a.parentElement;var c=false;if(typeof(b)=="number"){c=true}var e=d.Table.Grid;if(e.LayoutSettings.AllowBatchUpdate&&d.IsAutoIncrement){return false}if(wgIsFilterRow(f)){return d.GetFilterEditType()!="NoEdit"}else{if(wgIsRecordRow(f)){return d.EditType!="NoEdit"&&(a.noEdit!="true"&&a.noEdit!="True")&&(!c||(c&&b<f.cells.length))}else{if(wgIsNewRow(f)){return d.GetNewRowEditType()!="NoEdit"&&(a.noEdit!="true"&&a.noEdit!="True")}}}return false},SetClientStorageData:function(b,a){var h=b.XmlDt;var d=ISXml.CreateNodeOnly(h,"Storage","");var c=false;for(var f in b.Tables){var e=b.Tables[f];if(typeof(e)=="object"){var g=e.Storage.SerializeToXml(a);if(g!=null){c=true;d.appendChild(g)}}}ISXml.RemoveNode(b.XmlNode,"Storage");if(c){b.XmlNode.appendChild(d)}},InitializeClientStorage:function(a){for(var c in a.Tables){var b=a.Tables[c];if(typeof(b)=="object"){b.Storage.Initialize()}}},DeserializeClientStorage:function(a){var b=ISXml.GetNode(a.XmlDt,"//Storage");if(b!=null){for(var d in a.Tables){var c=a.Tables[d];if(typeof(c)=="object"){var e=ISXml.GetNode(b,"//Table[@Name='"+d+"']");if(e!=null){c.Storage.Deserialize(e)}}}}},FindNearestRootGroupRow:function(g,e,a,c){var f=e.GetElement(WG40.BODY,WG40.HTMLTABLE,a);var b=g;var d=new Array();if(f.rows.length==0){return null}while(b){if(b.type=="GroupHeader"&&b.groupIndex=="0"){return b}else{if(b.type=="GroupHeader"&&c){wgExpandGroupRow(b)}}b=wgGetPreviousRow(f,b)}return null},GetPreviousVisibleColumn:function(h,a,g){if(a.Position==0){return null}for(var e=a.Position-1;e>-1;e--){var f=h.Columns[e];var c=false;var d=false;var b=f.GetElement(g);if(f.IsGrouped&&h.Grid.LayoutSettings.HideColumnsWhenGrouped=="Yes"){c=true}if(b!=null&&b.style.display=="none"&&!IS.ie){d=true}if(f!=null&&f.Visible&&!c&&!d){return f}}return null},GetKeyValueString:function(b,c){var a="";if(b.HasMultiPrimaryKey){a=wgGetKeyValues(c).join("\03")}else{a=c.keyValue}if(typeof(a)=="undefined"){a=""}return a},CompareExact:function(c,d){if(c==d){return true}var a=c.replace("\r","").replace("\n","");var b=d.replace("\r","").replace("\n","");if(a==b){return true}return false},GetRecordRow:function(b){var a=wgGetRootRow(b);if(a.type=="HierRecord"){return WG50Engine.GetPreviousRow(WG50Engine.GetTable(a),a)}},IsWhitespace:function(a){if(a==" "||escape(a)=="%A0"||escape(a)=="%A0%0A"){return true}if(a){a=a.replace(/\s/g,"")}if(a==""){return true}return false},GetSimpleType:function(b,a){if(b.HasValueList&&b.Get("UseValueListForSorting")=="Yes"){return"Text"}if(b.HasValueList&&b.Get("UseValueListForFilter")=="Yes"){return"Text"}switch(b.DataType){case"System.String":return"Text";case"System.Int16":case"System.UInt16":case"System.UInt32":case"System.Int64":case"System.UInt64":case"System.Int32":case"System.Single":case"System.Double":case"System.Byte":case"System.SByte":case"System.Decimal":return"Number";case"System.DateTime":return"Date";case"System.Boolean":return"Bool";case"System.Guid":if(a){return"Guid"}}return"Text"},_InitializeControlData:function(a){var d=a.XmlDt.selectNodes("//WebGridFilter");var k=a.XmlDt.selectNodes("//WebGridTable");var m=["NewRowTemplate","HeaderTemplate","FilterTemplate","FooterTemplate"];for(var f=0;f<d.length;f++){var b=d[f];var e=ISXml.GetAttribute(b,"FilterText");if(e!=""&&e!=null){b.removeAttribute("FilterText");ISXml.CreateCDATA(a.XmlDt,b,"FilterText",e)}}for(var f=0;f<k.length;f++){var h=k[f];for(var g=0;g<m.length;g++){var l=m[g];var n=ISXml.GetAttribute(h,l);if(n!=""&&n!=null){h.removeAttribute(l);ISXml.CreateCDATA(a.XmlDt,h,l,n)}}}}};var wg_Global={Resizer:null,Dragger:null,IsHeaderDragged:false,MouseMoved:false,MouseCoord:null,TargetHeader:null,ColSizeTarget:null,ColDragTarget:null,ColPointer:null,MoveColEventArgs:null,IsMouseDown:false,ToolTipDelay:50,TTId:0,SortAscImage:"wg5_sortasc.gif",SortDescImage:"wg5_sortdesc.gif",SelectColumnImage:"wg5_selectcolumns.gif",GroupImage:"wg5_groupby.gif",GroupByBoxImage:"wg5_gbb.gif",EditImage:"wg5_edit.gif",CopyImage:"wg5_copy.gif",DeleteImage:"wg5_deleterow.gif",UpdateImage:"wg5_updaterow.gif",CancelImage:"wg5_cancel.gif",FilterRowImage:"wg5_filterbar.gif",FreezePaneImage:"wg5_freeze.gif",RemoveColumnImage:"wg5_removecolumn.gif",BestFitImage:"wg5_bestfit.gif",ApplyFilterImage:"wg5_applyfilter.gif",ClearFilterImage:"wg5_clearfilter.gif",ShowChildImage:"wg5_drillinto.gif",HideChildImage:"wg5_drillout.gif",NewRowImage:"wg5_newrow.gif",PasteImage:"wg5_paste.gif",RefreshImage:"wg5_refresh.gif",ExportImage:"wg5_export.gif",HelpImage:"wg5_help.gif",LoadMoreImage:"wg5_more.gif",UndoChangesImage:"wg7_undochanges.gif",UndoAllChangesImages:"wg7_undoallchanges.gif",AcceptAllChangesImage:"wg7_acceptallchanges.gif",ReviewChangesImage:"wg7_reviewchanges.gif",ColumnContext:null,RowContext:null,ExportContext:null,EventContext:null,LastSelObj:null,SelectorObj:null,CalDDImg:"CalendarDD.gif",CalFile:"ISCalendar.htm",CalPopObj:null,CalFrObj:null,LastValRowObj:null,LastRowCtx:null,NoDisplayUpdate:false,PendingUpdates:null,ActiveGrid:null,TempResizeID:0,IsResizing:false,FilterType:new Array(["NotSet",0],["GTET",1],["GT",2],["ET",3],["NET",9],["LTET",4],["LT",5],["Like",6],["NotLike",11],["Contain",16],["NotContain",17],["Between",7],["NotBetween",10],["IsNull",12],["NotIsNull",13],["IsEmpty",14],["NotIsEmpty",15]),FilterTypeEnum:new Array("NotSet","GreaterThanOrEqualTo","GreaterThan","EqualTo","LessThanOrEqualTo","LessThan","Like","Between","NoFilter","NotEqualTo","NotBetween","NotLike","IsNull","NotIsNull","IsEmpty","NotIsEmpty","Contain","NotContain"),ErrorBox:null,LastKeyDownProcessed:false,IsDragObjectValid:false,GlobalResizeID:0};function InitWG60(b,c){var a=WG50Engine.Create(b);a.NeedFocus=c;a.IsLoaded=true;a.OnInitialize();if(IS.OnAJAXInitialization){if(a.WebCombos.length>0||a.IsClassicPaging()){setTimeout(WG50Engine.OnWindowLoad,50)}if(!IS.ie){WG50Engine.OnGridLoad(a)}}}var posLib2={getLeftAbs:function(a,b){if(!IS.ie){var c=ISPosLib.getLeftNonIE(a);if(b){if(b.PosRelativeTo){c+=ISPosLib.getLeftNonIE(b.PosRelativeTo)}}return c}if(b&&b.LayoutSettings.UseRelativePositioning){return ISPosLib.getLeft(a)}var c=a.style.posLeft;var d=a.parentElement;c+=ISPosLib.getBorderLeftWidth(a);if(d){if(d.style.position.toLowerCase()=="absolute"){c+=d.style.posLeft}}if(b){if(b.PosRelativeTo){c+=ISPosLib.getLeft(b.PosRelativeTo)}}return c},getTopAbs:function(a,b){if(!IS.ie){var c=ISPosLib.getTopNonIE(a);if(IS.moz&&IS.w3cf){c=ISPosLib.getTop(a)}if(b){if(b.LayoutSettings.UseRelativePositioning){return c}if(b.PosRelativeTo){c+=ISPosLib.getTopNonIE(b.PosRelativeTo)}if(b.FrameObj.style.position!="absolute"){return 0}}if(a.style.position=="absolute"||a.style.position=="relative"){return c}else{return 0}}if(b&&b.LayoutSettings.UseRelativePositioning){return ISPosLib.getTop(a)}var c=a.style.posTop;var d=a.parentElement;c+=ISPosLib.getBorderTopWidth(a);if(d){if(d.style.position.toLowerCase()=="absolute"){c+=d.style.posTop}}if(b){if(b.PosRelativeTo){c+=ISPosLib.getLeft(b.PosRelativeTo)}}return c}};function _FixAmpChar(a){a=a.replace(/&/g,"&amp;");return a}function WebGridCoreDestructor(){wg_Global=null;delete wg_Global;delete WG50Engine;window.detachEvent("onunload",WebGridCoreDestructor);IS.RegisterUnloadVariables("WG50Engine")}window.attachEvent("onunload",WebGridCoreDestructor);if(typeof(Sys)!="undefined"){Sys.Application.notifyScriptLoaded()};