function ChartInteractiveUI(){this._Type="ChartInteractiveUI";ISObject.call(this);this.ChartAutoRefresh=true;this.ChartTypeRibbon=new ChartTypeRibbonSettings();this.FilterAndSortRibbon=new ChartFilterAndSortRibbonSettings();this.ShowOrHideRibbon=new ChartShowOrHideRibbonSettings();this.TitleRibbon=new ChartTitleRibbonSettings();this.RibbonState="Shown";this.LastPivotInfo=null;this.ResizeTimeoutID=0;this.ResizeQueue=0;this.ResponseTimeoutID=0;this.GetChartContainer=function(){return document.getElementById(this.Parent.Id+"_ChartContainer")};this.GetChartInnerContainer=function(){return document.getElementById(this.Parent.Id+"_ChartInnerContainer")};this.GetChartImageElement=function(){return document.getElementById(this.Parent.Id+"_ChartImage")};this.GetChartStatusElement=function(){return document.getElementById(this.Parent.Id+"_ChartStatus")};this.GetChartLoaderElement=function(){return document.getElementById(this.Parent.Id+"_ChartLoader")};this.GetChartUpdateElement=function(){return document.getElementById(this.Parent.Id+"_ChartUpdate")};this.GetDropFilterFieldsElement=function(){return document.getElementById(this.Parent.Id+"_ChartDropFilterFieldsArea")};this.GetDropDataFieldsElement=function(){return document.getElementById(this.Parent.Id+"_ChartDropDataFieldsArea")};this.GetDropXYDataFieldsElement=function(){return document.getElementById(this.Parent.Id+"_ChartDropXYDataFieldsArea")};this.GetDropBubbleDataFieldsElement=function(){return document.getElementById(this.Parent.Id+"_ChartDropBubbleDataFieldsArea")};this.GetDropStockHLCDataFieldsElement=function(){return document.getElementById(this.Parent.Id+"_ChartDropStockHLCDataFieldsArea")};this.GetDropStockOHLCDataFieldsElement=function(){return document.getElementById(this.Parent.Id+"_ChartDropStockOHLCDataFieldsArea")};this.GetDropPolarDataFieldsElement=function(){return document.getElementById(this.Parent.Id+"_ChartDropPolarDataFieldsArea")};this.GetDropSeriesFieldsElement=function(){return document.getElementById(this.Parent.Id+"_ChartDropSeriesFieldsArea")};this.GetDropCategoryFieldsElement=function(){return document.getElementById(this.Parent.Id+"_ChartDropCategoryFieldArea")};this.GetDropSecondaryCategoryFieldsElement=function(){return document.getElementById(this.Parent.Id+"_ChartDropSecondaryCategoryFieldsArea")};this.GetTableListElement=function(){return document.getElementById(this.Parent.Id+"_TableFieldList")};this.GetShowOrHideRibbonElement=function(){return document.getElementById(this.Parent.Id+"_ChartRibbon_ShowHide")};this.GetFilterAndSortRibbonElement=function(){return document.getElementById(this.Parent.Id+"_ChartRibbon_FilterSort")};this.GetChartTypeRibonElement=function(){return document.getElementById(this.Parent.Id+"_ChartRibbon_Chart")};this.GetChartTitleRibbonElement=function(){return document.getElementById(this.Parent.Id+"_ChartRibbon_Titles")};this.GetChartRibbonElement=function(){return document.getElementById(this.Parent.Id+"_ChartRibbon")};this.GetDropZoneSelectionElement=function(){return document.getElementById(this.Parent.Id+"_AddToSelection")};this.GetChartMap=function(){return document.getElementById(this.Parent.Id+"_ChartMap")};this.OnUnload=function(){Listener.Unload(this.GetChartContainer());for(var a=0;a<this.Parent.CachePivotFilterInfoCollection.length;a++){var b=this.Parent.CachePivotFilterInfoCollection[a];WGChartUIEngine.UnloadPivotInfo(b);WGChartUIEngine.UnloadPivotFilter(b.PivotObject)}WGChartUIEngine.UnloadTableFieldList(this.Parent);WGChartUIEngine.UnloadDropDataFields(this.Parent)};this.UnloadButtons=function(){var d="_FieldList,_DropZone,_Legend,_Filter,_Ascending,_Descending,_ChartType,_SwitchRowAndColumn,_Update,_AddTo";var b=d.split(",");for(var c=0;c<b.length;c++){var a=ISGetObject(this.Parent.Id+b[c]);if(a!=null){a.OnUnload()}}};this.ShowRibbon=function(){this.ShowLoaderImage();var c=this.GetChartRibbonElement();c.style.display="";c.parentElement.style.display="";if(IS.IsHTML5DocType()){var a=this;var d=this.GetChartImageElement();var e=this.GetChartInnerContainer();var b=e.children[0];d.style.display="none";e.style.height="auto";if(IS.ie){b.style.height="auto"}setTimeout(function(){WGChartEngine.SetChartContainerSize(a.Parent);a.RibbonState="Shown";a.RefreshChart()},1)}else{this.RibbonState="Shown";this.RefreshChart()}};this.HideRibbon=function(){this.ShowLoaderImage();var a=this.GetChartRibbonElement();a.style.display="none";a.parentElement.style.display="none";WGChartEngine.SetChartContainerSize(this.Parent);this.RibbonState="Hidden";this.RefreshChart()};this.IsRibbonShown=function(){var a=this.GetChartRibbonElement();return a.style.display!="none"};this.ShowLoaderImage=function(){var a=this.GetChartImageElement();var c=this.GetChartStatusElement();var b=this.GetChartLoaderElement();a.style.display="none";a.src=this.Parent.ResolveImagePathEx("wg_blank.gif");b.style.display="";c.style.display="";return true};this.HideLoaderImage=function(){var a=this.GetChartImageElement();var b=this.GetChartLoaderElement();b.style.display="none";a.style.display="";return true};this.ShowUpdateText=function(){var a=this.GetChartImageElement();var b=this.GetChartStatusElement();var c=this.GetChartUpdateElement();a.style.display="none";a.src=this.Parent.ResolveImagePathEx("wg_blank.gif");c.style.display="";b.style.display=""};this.HideUpdateText=function(){var a=this.GetChartImageElement();var b=this.GetChartUpdateElement();b.style.display="none";a.style.display="";return true};this.ShowChartTypeMenu=function(){var b=ISGetObject(this.Parent.Id+"_ChartMenu");var a=ISGetObject(this.Parent.Id+"_ChartType");b.Button=a;b.SetOffsetElement(a.FrameObj);b.Show();return true};this.SetChartType=function(b,c){this.ShowLoaderImage();var a=this.Parent.ChartSettings;a.ChartType=b;switch(a.ChartType){case"Column":a.SeriesColumnSettings.Type=c;break;case"Bar":a.SeriesBarSettings.Type=c;break;case"Line":a.SeriesLineSettings.Type=c;break;case"SmoothLine":a.SeriesSmoothLineSettings.Type=c;break;case"StepLine":a.SeriesStepLineSettings.Type=c;break;case"Pie":a.SeriesPieSettings.Type=c;break;case"XYScatter":a.SeriesXYSettings.Type=c;break;case"Bubble":a.SeriesBubbleSettings.Type=c;break;case"Area":a.SeriesAreaSettings.Type=c;break;case"Doughnut":a.SeriesDoughnutSettings.Type=c;break;case"Radar":a.SeriesRadarSettings.Type=c;break;case"Stock":a.SeriesStockSettings.Type=c;break;case"Polar":a.SeriesPolarSettings.Type=c;break}WGChartUIEngine.SetDropZone(this.Parent,true);WGChartUIEngine.ClearDataCollection(this.Parent);WGChartUIEngine.SynchronizeDataCollection(this.Parent);this.RefreshChart();return true};this.ShowFieldList=function(){if(this.ChartAutoRefresh){this.ShowLoaderImage()}else{this.ShowUpdateText()}WGChartUIEngine.SetFieldList(this.Parent,true);this.ShowOrHideRibbon.ShowFieldList=true;this.PerformAutoRefresh();return true};this.HideFieldList=function(){if(this.ChartAutoRefresh){this.ShowLoaderImage()}else{this.ShowUpdateText()}WGChartUIEngine.SetFieldList(this.Parent,false);this.ShowOrHideRibbon.ShowFieldList=false;this.PerformAutoRefresh();return true};this.IsFieldListShown=function(){var a=this.GetTableListElement();return a.style.display!="none"};this.SetFieldListVisibility=function(a){if(a){this.ShowFieldList()}else{this.HideFieldList()}return true};this.ShowDropZone=function(){if(this.ChartAutoRefresh){this.ShowLoaderImage()}else{this.ShowUpdateText()}this.ShowOrHideRibbon.ShowDropZone=true;WGChartUIEngine.SetDropZone(this.Parent,true);this.PerformAutoRefresh();return true};this.HideDropZone=function(){if(this.ChartAutoRefresh){this.ShowLoaderImage()}else{this.ShowUpdateText()}this.ShowOrHideRibbon.ShowDropZone=false;WGChartUIEngine.SetDropZone(this.Parent,false);this.PerformAutoRefresh();return true};this.IsDropZoneShown=function(){return this.ShowOrHideRibbon.ShowDropZone};this.SetDropZoneVisibility=function(a){if(a){this.ShowDropZone()}else{this.HideDropZone()}return true};this.ShowLegend=function(){if(this.ChartAutoRefresh){this.ShowLoaderImage()}else{this.ShowUpdateText()}WGChartUIEngine.SetLegend(this.Parent,true);this.Parent.ChartSettings.LegendSettings.Mode="Automatic";this.PerformAutoRefresh();return true};this.HideLegend=function(){if(this.ChartAutoRefresh){this.ShowLoaderImage()}else{this.ShowUpdateText()}WGChartUIEngine.SetLegend(this.Parent,false);this.Parent.ChartSettings.LegendSettings.Mode="Disabled";this.PerformAutoRefresh();return true};this.IsLegendShown=function(){if(this.Parent.ChartSettings.LegendSettings.Mode=="Automatic"){return true}else{return false}};this.SetLegendVisibility=function(a){if(a){this.ShowLegend()}else{this.HideLegend()}return true};this.EnableAutoFilter=function(){if(this.ChartAutoRefresh){this.ShowLoaderImage()}else{this.ShowUpdateText()}WGChartUIEngine.EnableAutoFilter(this.Parent,true);this.FilterAndSortRibbon.ChartAutoFilter=true;this.PerformAutoRefresh();return true};this.DisableAutoFilter=function(){if(this.ChartAutoRefresh){this.ShowLoaderImage()}else{this.ShowUpdateText()}WGChartUIEngine.EnableAutoFilter(this.Parent,false);this.FilterAndSortRibbon.ChartAutoFilter=false;this.PerformAutoRefresh();return true};this.IsAutoFilter=function(){return this.FilterAndSortRibbon.ChartAutoFilter};this.SetAutoFilterEnabled=function(a){if(a){this.EnableAutoFilter()}else{this.DisableAutoFilter()}return true};this.SwitchRowAndColumn=function(){WGChartUIEngine.SwitchRowAndColumn(this.Parent);this.PerformAutoRefresh();return true};this.SynchronizeRibbonDisplay=function(){if(this.Parent.ChartMode=="InteractiveUI"){var b=this.GetChartRibbonElement();var a=b.parentElement;if(this.RibbonState=="Shown"){b.style.display="";a.style.display=""}else{b.style.display="none";a.style.display="none"}}};this.SynchronizeShowOrHideRibbonDisplay=function(){if(this.Parent.ChartMode=="InteractiveUI"){var b=this.GetShowOrHideRibbonElement();var a=b.parentElement;if(this.ShowOrHideRibbon.Visible){b.style.display="";a.style.display="";if(this.ShowOrHideRibbon.ShowFieldList){WGChartUIEngine.SetFieldList(this.Parent,true)}else{WGChartUIEngine.SetFieldList(this.Parent,false)}if(this.ShowOrHideRibbon.ShowDropZone){WGChartUIEngine.SetDropZone(this.Parent,true)}else{WGChartUIEngine.SetDropZone(this.Parent,false)}if(this.Parent.ChartSettings.LegendSettings.Mode=="Automatic"){WGChartUIEngine.SetLegend(this.Parent,true)}else{WGChartUIEngine.SetLegend(this.Parent,false)}}else{b.style.display="none";a.style.display="none"}}return true};this.SynchronizeFilterAndSortRibbonDisplay=function(){if(this.Parent.ChartMode=="InteractiveUI"){var b=this.GetFilterAndSortRibbonElement();var a=b.parentElement;if(this.FilterAndSortRibbon.Visible){b.style.display="";a.style.display="";if(this.FilterAndSortRibbon.ChartAutoFilter){WGChartUIEngine.EnableAutoFilter(this.Parent,true)}else{WGChartUIEngine.EnableAutoFilter(this.Parent,false)}}else{b.style.display="none";a.style.display="none"}WGChartUIEngine.EnableSortButton(this.Parent,false)}return true};this.SynchronizeChartTypeRibbonDisplay=function(){if(this.Parent.ChartMode=="InteractiveUI"){var b=this.GetChartTypeRibonElement();var a=b.parentElement;if(this.ChartTypeRibbon.Visible){b.style.display="";a.style.display=""}else{b.style.display="none";a.style.display="none"}}return true};this.SynchronizeChartTitleDisplay=function(){if(this.Parent.ChartMode=="InteractiveUI"){var b=this.GetChartTitleRibbonElement();var a=b.parentElement;if(this.TitleRibbon.Visible){b.style.display="";a.style.display=""}else{b.style.display="none";a.style.display="none"}}return true};this.UpdateChartUI=function(){this.SynchronizeRibbonDisplay();this.SynchronizeShowOrHideRibbonDisplay();this.SynchronizeFilterAndSortRibbonDisplay();this.SynchronizeChartTypeRibbonDisplay();this.SynchronizeChartTitleDisplay()};this.UpdateChanges=function(){WGChartUIEngine.ChartUI_UpdateChanges(this)};this.PerformAutoRefresh=function(){if(this.ChartAutoRefresh&&!this.Parent.IsInProgress){this.RefreshChart()}};this.RefreshChart=function(){if(this.ResponseTimeoutID>0){return}this.HideUpdateText();this.ShowLoaderImage();var b=this.Parent.ChartSettings;var a=this.GetChartImageElement();var d=a.parentElement;var c=parseInt(d.currentStyle.marginLeft);if(isNaN(c)){c=0}b.Height=d.offsetHeight-c;b.Width=d.offsetWidth-c;WG50Engine.ExecuteFlyPostback(this.Parent.Id,"Charting")}}function ChartFilterAndSortRibbonSettings(){this._Type="ChartFilterAndSortRibbonSettings";ISObject.call(this);this.ChartAutoFilter=true;this.Visible=true}function ChartShowOrHideRibbonSettings(){this._Type="ChartShowOrHideRibbonSettings";ISObject.call(this);this.ShowDropZone=true;this.ShowFieldList=false;this.Visible=true}function ChartTitleRibbonSettings(){this._Type="ChartTitleRibbonSettings";ISObject.call(this);this.AllowEditXTitle=true;this.AllowEditYTitle=true;this.AllowEditZTitle=true;this.Visible=true}function ChartTypeRibbonSettings(){this._Type="ChartTypeRibbonSettings";ISObject.call(this);this.AreaType=new ChartAreaTypeSettings();this.BarType=new ChartBarTypeSettings();this.ColumnType=new ChartColumnTypeSettings();this.DoughnutType=new ChartDoughnutTypeSettings();this.LineType=new ChartLineTypeSettings();this.PieType=new ChartPieTypeSettings();this.SmoothLineType=new ChartSmoothLineTypeSettings();this.StepLineType=new ChartStepLineTypeSettings();this.Visible=true}function ChartAreaTypeSettings(){this._Type="ChartAreaTypeSettings";ISObject.call(this);this.Enabled=true;this.EnableStackedAreaType=true;this.EnableStackedPercentageAreaType=true;this.EnableBasic3DAreaType=true;this.EnableStacked3DAreaType=true;this.EnableStackedPercentage3DAreaType=true}function ChartColumnTypeSettings(){this._Type="ChartColumnTypeSettings";ISObject.call(this);this.Enabled=true;this.EnableClusteredColumnType=true;this.EnableStackedColumnType=true;this.EnableStackedPercentageColumnType=true;this.EnableBasic3DColumnType=true;this.EnableClustered3DColumnType=true;this.EnableStacked3DColumnType=true;this.EnableStackedPercentage3DColumnType=true}function ChartBarTypeSettings(){this._Type="ChartBarTypeSettings";ISObject.call(this);this.Enabled=true;this.EnableClusteredBarType=true;this.EnableStackedBarType=true;this.EnableStackedPercentageBarType=true;this.EnableBasic3DBarType=true;this.EnableClustered3DBarType=true;this.EnableStacked3DBarType=true;this.EnableStackedPercentage3DBarType=true}function ChartDoughnutTypeSettings(){this._Type="ChartDoughnutTypeSettings";ISObject.call(this);this.Enabled=true;this.EnableDoughnutType=true;this.EnableExplodedDoughnutType=true;this.EnableBasic3DDoughnutType=true;this.EnableExploded3DDoughnutType=true}function ChartPieTypeSettings(){this._Type="ChartPieTypeSettings";ISObject.call(this);this.Enabled=true;this.EnablePieType=true;this.EnableExplodedPieType=true;this.EnableBasic3DPieType=true;this.EnableExploded3DPieType=true}function ChartLineTypeSettings(){this._Type="ChartLineTypeSettings";ISObject.call(this);this.Enabled=true;this.EnableOverlappedLineType=true;this.EnableOverlappedLineWithMarkersType=true;this.EnableStackedLineType=true;this.EnableStackedLineWithMarkersType=true;this.EnableStackedPercentageLineType=true;this.EnableStackedPercentageLineWithMarkersType=true;this.EnableBasic3DLineType=true;this.EnableBasic3DLineWithMarkersType=true;this.EnableOverlapped3DLineType=true;this.EnableOverlapped3DLineWithMarkersType=true;this.EnableStacked3DLineType=true;this.EnableStacked3DLineWithMarkersType=true;this.EnableStackedPercentage3DLineType=true;this.EnableStackedPercentage3DLineWithMarkersType=true}function ChartSmoothLineTypeSettings(){this._Type="ChartSmoothLineTypeSettings";ISObject.call(this);this.Enabled=false;this.EnableOverlappedSmoothLineType=true;this.EnableOverlappedSmoothLineWithMarkersType=true}function ChartStepLineTypeSettings(){this._Type="ChartLineTypeSettings";ISObject.call(this);this.Enabled=false;this.EnableOverlappedStepLineType=true;this.EnableOverlappedStepLineWithMarkersType=true;this.EnableBasic3DStepLineType=true;this.EnableBasic3DStepLineWithMarkersType=true}function ChartPivotFilterInfo(){this.Name="";this.WebGrid=null;this.PivotInfoElement=null;this.PivotState="Not In";this.PivotStateCollection=new ISArray();this.PivotOriginalStateCollection=new ISArray();this.PivotObject=null;this.LastFilterExpression="";this.OKButtonElement=null;this.CancelButtonElement=null;this.GetContentDataElement=function(){return WGChartUIEngine.GetChildren(this.PivotInfoElement,[2,0],[1,1],[2,0])};this.GetLoaderElement=function(){return WGChartUIEngine.GetChildren(this.PivotInfoElement,[2,0],[1,2],[2,0])};this.GetFilterExpressionElement=function(){return WGChartUIEngine.GetChildren(this.PivotInfoElement,[2,0],[1,3],[1,0],[1,2])};this.HasFilter=function(){return((this.GetFilterExpressionElement().value!=null&&this.GetFilterExpressionElement().value!="")||this.TotalChecked>0)};this.GetContentData=function(){return WGChartUIEngine.GetChildren(this.PivotInfoElement,[2,0],[1,1],[4,0]).children};this.GetTotalData=function(){return this.GetContentData().length};this.GetCheckedData=function(){var a=new Array();var c=0;var b=this.GetContentData();for(var e=0;e<b.length;e++){var d=b[e];var f=WGChartUIEngine.GetChildren(d,[2,0]);if(f.checked){a[c++]=f.value}}return a};this.IsAllChecked=function(){var a=WGChartUIEngine.GetChildren(this.PivotInfoElement,[2,0],[1,1],[7,0]);if(a.checked){return true}};this.TotalChecked=-1}function ChartPivotStateInfo(){this.Name="";this.Element=null;this.Checked=null}var WGChartUIEngine={OnChartContainerClick:function(){var c=this;var b=c.ChartInteractiveUI;var a=b.GetChartContainer();var d=a.attributes.pivotClicked;if(d!=null&&d.value=="false"&&b.LastPivotElement!=null){b.LastPivotElement.className="WG5CE-CPS";WGChartUIEngine.EnableSortButton(c,false)}a.setAttribute("pivotClicked","false");return true},OnChartContainerContextMenu:function(){var e=this;var b=e.ChartInteractiveUI;var a=b.GetChartContainer();var d=event.srcElement;if(d.tagName!="IMG"){if(!b.ContextMenu){var c=new WebContextMenu(e.Id+"_ChartContextMenu");c.WebGrid=e;WGChartUIEngine.ApplyContextMenuStyle(c);c.Items.Add(new WebMenuCheckBoxItem("mnuShowRibbon","Show Ribbon","",WGChartUIEngine.ShowHideRibbon));c.Items.Add(new WebMenuCheckBoxItem("mnuFieldList","Show Field List","",WGChartUIEngine.ShowHideFieldList));c.Items.Add(new WebMenuCheckBoxItem("mnuDropZone","Show Drop Zone","",WGChartUIEngine.ShowHideDropDownZone));c.Items.Add(new WebMenuCheckBoxItem("mnuLegend","Show Legend","",WGChartUIEngine.ShowHideLegend));c.Items.Add(new WebMenuCheckBoxItem("mnuAutoFilter","Auto Filter","",WGChartUIEngine.AutoFilter));b.ContextMenu=c}var c=b.ContextMenu;c.Items[0].SetChecked(b.IsRibbonShown(),true);c.Items[1].SetChecked(b.IsFieldListShown(),true);c.Items[2].SetChecked(b.IsDropZoneShown(),true);c.Items[3].SetChecked(b.IsLegendShown(),true);c.Items[4].SetChecked(b.IsAutoFilter(),true);c.Show(event.clientX+(IS.moz?window.screenLeft:0),event.clientY+(IS.moz?window.screenTop:0));return false}},ShowHideRibbon:function(){var b=this.OwnerMenu.MenuControl;var c=b.WebGrid;var a=c.ChartInteractiveUI;if(a.IsRibbonShown()){a.HideRibbon()}else{a.ShowRibbon()}},ShowHideFieldList:function(){var b=this.OwnerMenu.MenuControl;var c=b.WebGrid;var a=c.ChartInteractiveUI;if(a.IsFieldListShown()){a.HideFieldList()}else{a.ShowFieldList()}},ShowHideDropDownZone:function(){var b=this.OwnerMenu.MenuControl;var c=b.WebGrid;var a=c.ChartInteractiveUI;if(a.IsDropZoneShown()){a.HideDropZone()}else{a.ShowDropZone()}},ShowHideLegend:function(){var b=this.OwnerMenu.MenuControl;var c=b.WebGrid;var a=c.ChartInteractiveUI;if(a.IsLegendShown()){a.HideLegend()}else{a.ShowLegend()}},AutoFilter:function(){var b=this.OwnerMenu.MenuControl;var c=b.WebGrid;var a=c.ChartInteractiveUI;if(a.IsAutoFilter()){a.DisableAutoFilter()}else{a.EnableAutoFilter()}},GetChildren:function(){var a=arguments[0];for(var d=1;d<arguments.length;d++){var c=arguments[d];var b=c[0];var e=c[1];for(var f=0;f<b;f++){a=a.children[e]}}return a},UnloadPivotCheckBox:function(d){if(d.PivotInfoElement!=null){var a=d.GetContentDataElement();if(a.children!=null&&a.children.length>0){var f=WGChartUIEngine.GetChildren(a,[2,0]).children;for(var b=0;b<f.length;b++){var e=f[b];var c=WGChartUIEngine.GetChildren(e,[2,0]);Listener.Unload(c)}}}return true},UnloadPivotInfo:function(c){if(c.PivotInfoElement!=null){WGChartUIEngine.UnloadPivotCheckBox(c);var a=WGChartUIEngine.GetChildren(c.PivotInfoElement,[4,0]);var d=a.children[0];var e=a.children[1];Listener.Unload(d);Listener.Unload(e);var b=c.GetFilterExpressionElement();Listener.Unload(b);Listener.Unload(c.OKButtonElement);Listener.Unload(c.CancelButtonElement)}return true},UnloadPivotFilter:function(b){var a=b.PivotElement;if(a!=null){Listener.Unload(a.children[0]);Listener.Unload(a.children[1])}},UnloadTableFieldList:function(d){var b=d.ChartInteractiveUI;var c=b.GetTableListElement();var h=c.children[0];var j=WGChartUIEngine.GetChildren(h,[3,0]);var g=WGChartUIEngine.GetChildren(h,[1,0],[1,1],[4,0]).children;for(var e=0;e<g.length;e++){var f=g[e];var a=f.children[0];Listener.Unload(a)}return true},UnloadDropDataFields:function(w){var a=w.ChartInteractiveUI;var g=a.GetDropDataFieldsElement();var f=WGChartUIEngine.GetChildren(g,[4,0]).children;WGChartUIEngine.UnloadDropDataPointerElement(f);var u=a.GetDropXYDataFieldsElement();var t=WGChartUIEngine.GetChildren(u,[4,0]).children;var v=WGChartUIEngine.GetChildren(u,[3,0],[1,1]).children;WGChartUIEngine.UnloadDropDataPointerElement(t);WGChartUIEngine.UnloadDropDataPointerElement(v);var c=a.GetDropBubbleDataFieldsElement();var d=WGChartUIEngine.GetChildren(c,[4,0]).children;var e=WGChartUIEngine.GetChildren(c,[3,0],[1,1]).children;var b=WGChartUIEngine.GetChildren(c,[3,0],[1,2]).children;WGChartUIEngine.UnloadDropDataPointerElement(d);WGChartUIEngine.UnloadDropDataPointerElement(e);WGChartUIEngine.UnloadDropDataPointerElement(b);var p=a.GetDropStockHLCDataFieldsElement();var i=WGChartUIEngine.GetChildren(p,[4,0]).children;var j=WGChartUIEngine.GetChildren(p,[3,0],[1,1]).children;var h=WGChartUIEngine.GetChildren(p,[3,0],[1,2]).children;WGChartUIEngine.UnloadDropDataPointerElement(i);WGChartUIEngine.UnloadDropDataPointerElement(j);WGChartUIEngine.UnloadDropDataPointerElement(h);var q=a.GetDropStockOHLCDataFieldsElement();var n=WGChartUIEngine.GetChildren(q,[4,0]).children;var l=WGChartUIEngine.GetChildren(q,[3,0],[1,1]).children;var m=WGChartUIEngine.GetChildren(q,[3,0],[1,2]).children;var k=WGChartUIEngine.GetChildren(q,[3,0],[1,3]).children;WGChartUIEngine.UnloadDropDataPointerElement(n);WGChartUIEngine.UnloadDropDataPointerElement(l);WGChartUIEngine.UnloadDropDataPointerElement(m);WGChartUIEngine.UnloadDropDataPointerElement(k);var r=a.GetDropPolarDataFieldsElement();var o=WGChartUIEngine.GetChildren(r,[4,0]).children;var s=WGChartUIEngine.GetChildren(r,[3,0],[1,1]).children;WGChartUIEngine.UnloadDropDataPointerElement(o);WGChartUIEngine.UnloadDropDataPointerElement(s);return true},UnloadDropDataPointerElement:function(a){for(var c=0;c<a.length;c++){var b=a[c];var d=b.children[1];Listener.Unload(d)}return true},RetrivePivotDataResponse:function(j,n){if(n!=null){var s=ISXml.CreateXmlDocument();ISXml.LoadXml(s,n.childNodes[0].text);var f=s.childNodes[0].childNodes;var o=j.ChartInteractiveUI.LastPivotInfo;o.TotalData=f.length;if(o.FilterExpressionElement!=null){o.FilterExpressionElement.value=o.OriginalFilterExpression}var h=o.GetContentDataElement();WGChartUIEngine.UnloadPivotCheckBox(o);h.innerHTML="";h.style.display="none";var l=o.GetLoaderElement();l.style.display="";var r=document.createElement("table");r.className="WG5CE-CPFI";r.style.width="100%";r.cellPadding=0;r.cellSpacing=0;h.appendChild(r);var q=r.insertRow(-1);var b=q.insertCell(-1);var e=document.createElement("input");e.type="checkbox";e.value="(all)";e.defaultChecked=true;b.appendChild(e);Listener.Add(e,"onclick",WGChartUIEngine.OnPivotDataCheckBoxAllClick,o);WGChartUIEngine.StoreOriginalPivotState(o,e,e.checked);var c=q.insertCell(-1);c.style.paddingLeft="2px";c.style.width="100%";c.innerHTML="<NOBR>(all)</NOBR>";for(var k=0;k<f.length;k++){var g=f[k].attributes[0].text;var m=null;if(g.indexOf("|")>=0){m=g.split("|")}else{m=g.split(",")}var p=r.insertRow(-1);var a=p.insertCell(-1);var d=document.createElement("input");d.type="checkbox";d.value=m[2];d.defaultChecked=true;Listener.Add(d,"onclick",WGChartUIEngine.OnPivotDataCheckBoxClick,o);a.appendChild(d);a=p.insertCell(-1);a.style.paddingLeft="2px";a.style.width="100%";a.innerHTML="<NOBR>"+m[1]+"</NOBR>"}j.ChartInteractiveUI.LastPivotInfo.TotalChecked=f.length;o.PivotInfoElement.TotalChecked=o.TotalChecked;h.style.display="";l.style.display="none"}return true},OnPivotDataCheckBoxAllClick:function(){var a=window.event.srcElement;var e=this;WGChartUIEngine.StoreOriginalPivotState(e,a,!a.checked);var c=e.GetContentData();for(var d=1;d<c.length;d++){var b=WGChartUIEngine.GetChildren(c[d],[2,0]);WGChartUIEngine.StoreOriginalPivotState(e,b,b.checked);b.checked=a.checked}if(a.checked){e.PivotState="Not In";e.TotalChecked=c.length-1}else{e.PivotState="In";e.TotalChecked=0}if(!e.HasFilter()){e.OKButtonElement.disabled=true}else{e.OKButtonElement.disabled=false}e.PivotStateCollection.Clear();return true},OnPivotDataCheckBoxClick:function(){var a=window.event.srcElement;var e=this;var b=e.GetContentData();var d=WGChartUIEngine.GetChildren(b[0],[2,0]);if(a.checked){e.TotalChecked++}else{e.TotalChecked--}if(e.TotalChecked==e.TotalData){d.checked=true}else{d.checked=false}if(!e.HasFilter()){e.OKButtonElement.disabled=true}else{e.OKButtonElement.disabled=false}var c=e.PivotStateCollection.IndexOf(a.value);if(c!=-1){e.PivotStateCollection.RemoveAt(c)}else{e.PivotStateCollection.Add(a.value)}WGChartUIEngine.StoreOriginalPivotState(e,a,!a.checked);return true},ApplyComplexImages:function(a,f){var b=a.Id;var d=b.substring(0,b.lastIndexOf("_"));var c=ISGetObject(d);var e=new Object();var g=(f?"l":"");var h="";switch(c.DefaultStyleMode){case"Win7":h="chart.w7.";break;case"Silver":h="chart.s.";break;case"Black":h="chart.b.";break}e.ButtonLeftInactive=h+"button"+g+"_inactive.gif";e.ButtonCenterInactive=h+"button"+g+"_inactive.gif";e.ButtonRightInactive=h+"button"+g+"_inactive.gif";e.ButtonLeftActive=h+"button"+g+"_left_active.gif";e.ButtonCenterActive=h+"button"+g+"_center_active.gif";e.ButtonRightActive=h+"button"+g+"_right_active.gif";e.ButtonLeftOver=h+"button"+g+"_left_over.gif";e.ButtonCenterOver=h+"button"+g+"_center_over.gif";e.ButtonRightOver=h+"button"+g+"_right_over.gif";a.Grid=c;a.BorderType="ComplexImages";a.WebResourcesIdentifier="G";a.ImagesSettings=e;a.DesktopManager=new ISControl("Dummy");a.DesktopManager.ResolveImagePath=WGChartUIEngine.RibbonButton_ResolveImagePath;a.DesktopManager.Ribbon=a},CreateUpdateButton:function(b,c){var a=new WebButton(b);a.ButtonStyle=new DynamicStyle("WG5CE-CUBS","WG5CE-CUBOS","WG5CE-CUBAS");a.DisabledStyle="WG5CE-CRDS";a.Height="100%";a.Width=50;a.Text=c;if(WGChartUIEngine.IsUsingElegantStyle(b)){WGChartUIEngine.ApplyComplexImages(a,true)}return a},IsUsingElegantStyle:function(a){var c=a.substring(0,a.lastIndexOf("_"));var b=ISGetObject(c);return b.UseDefaultStyle&&b.DefaultStyleMode!="Standard"},CreateRibbonButton:function(b,c,e,d,f){if(f==null){f=100}var a=new WebButton(b);a.DisplayMode="TextAndImage";a.Image=c;a.Text=e;a.CustomAttributes={size:"small"};a.ButtonStyle=new DynamicStyle("WG5CE-CRBS","WG5CE-CRBOS","WG5CE-CRBAS");a.DisabledStyle="WG5CE-CRDS";a.Width=f;a.Height=22;a.IsToggleButton=d;if(WGChartUIEngine.IsUsingElegantStyle(b)){WGChartUIEngine.ApplyComplexImages(a)}return a},CreateRibbonButtonL:function(b,d,c){var a=new WebButton(b);a.CustomAttributes={size:"large"};a.ButtonStyle=new DynamicStyle("WG5CE-CRFBS","WG5CE-CRFBOS","WG5CE-CRFBAS");a.DisabledStyle="WG5CE-CRDS";a.Height=66;a.Width=50;a.Text=d;a.IsToggleButton=c;if(WGChartUIEngine.IsUsingElegantStyle(b)){WGChartUIEngine.ApplyComplexImages(a,true)}return a},RibbonButton_ResolveImagePath:function(a){return this.Ribbon.Grid.ResolveImagePathEx(a)},CreateChartRibbon:function(i,w,f){if(w.ChartMode=="InteractiveUI"){var v=w.GetString("Charting/FieldListButton");var s=w.GetString("Charting/DropZoneButton");var y=w.GetString("Charting/LegendButton");var e=w.GetString("Charting/AutoFilterButton");var b=w.GetString("Charting/AscendingButton");var k=w.GetString("Charting/DescendingButton");var h=w.GetString("Charting/ChartTypeButton");var C=w.GetString("Charting/SwitchRowColumnButton");var O=w.GetString("Charting/UpdateButton");if(w.UseCssFramework){e=e.replace("<br/>"," ");h=h.replace("<br/>"," ")}var o=WGChartUIEngine.GetChildren(f,[5,0]);var p=WGChartUIEngine.GetChildren(o,[5,0]);var J=WGChartUIEngine.GetChildren(p,[4,0]);var I=WGChartUIEngine.GetChildren(p,[3,0],[1,1],[4,0]);var K=WGChartUIEngine.GetChildren(p,[3,0],[1,1],[2,0],[1,1],[1,0]);var n=WGChartUIEngine.GetChildren(o,[3,0],[1,1],[1,0]);var F=WGChartUIEngine.GetChildren(n,[4,0]);var E=WGChartUIEngine.GetChildren(n,[3,0],[1,1],[4,0]);var H=WGChartUIEngine.GetChildren(n,[3,0],[1,1],[2,0],[1,1],[1,0]);var m=WGChartUIEngine.GetChildren(o,[3,0],[1,2],[1,0]);var G=WGChartUIEngine.GetChildren(m,[4,0]);var L=WGChartUIEngine.GetChildren(m,[3,0],[1,1],[4,0]);var q=WGChartUIEngine.GetChildren(o,[3,0],[1,4],[1,0]);var M=WGChartUIEngine.GetChildren(q,[4,0]);v='<img src="'+w.ResolveImagePathEx("wg6_fieldlist.gif")+'"/> <br/>'+v;var u=WGChartUIEngine.CreateRibbonButtonL(i+"_FieldList",v,true);u.WebGrid=w;CreateWebButton(u,{Host:J});Listener.Add(u.GetElement(),"onclick",WGChartUIEngine.OnFieldListClick,u);var t=w.ResolveImagePathEx("wg6_dropzone.gif");var r=WGChartUIEngine.CreateRibbonButton(i+"_DropZone",t,s,true);r.WebGrid=w;CreateWebButton(r,{Host:I});Listener.Add(r.GetElement(),"onclick",WGChartUIEngine.OnDropZoneClick,r);var z=w.ResolveImagePathEx("wg6_legend.gif");var x=WGChartUIEngine.CreateRibbonButton(i+"_Legend",z,y,true);x.WebGrid=w;CreateWebButton(x,{Host:K});Listener.Add(x.GetElement(),"onclick",WGChartUIEngine.OnLegendClick,x);e='<img src="'+w.ResolveImagePathEx("wg6_chartfilter.gif")+'"/> <br/>'+e;var d=WGChartUIEngine.CreateRibbonButtonL(i+"_Filter",e,true);CreateWebButton(d,{Host:F});d.WebGrid=w;Listener.Add(d.GetElement(),"onclick",WGChartUIEngine.OnAutoFilterClick,d);var c=w.ResolveImagePathEx("wg5_sortasc.gif");var a=WGChartUIEngine.CreateRibbonButton(i+"_Ascending",c,b,true);a.WebGrid=w;CreateWebButton(a,{Host:E});var l=w.ResolveImagePathEx("wg5_sortdesc.gif");var j=WGChartUIEngine.CreateRibbonButton(i+"_Descending",l,k,true);j.WebGrid=w;CreateWebButton(j,{Host:H});var A=new Array();A[0]=a;A[1]=j;Listener.Add(a.GetElement(),"onclick",WGChartUIEngine.OnAscendingClick,A);Listener.Add(j.GetElement(),"onclick",WGChartUIEngine.OnDescendingClick,A);h='<img src="'+w.ResolveImagePathEx("wg6_chart.gif")+'"/> <br/>'+h;var g=WGChartUIEngine.CreateRibbonButtonL(i+"_ChartType",h,true);CreateWebButton(g,{Host:G});Listener.Add(g.GetElement(),"onclick",WGChartUIEngine.OnChartTypeClick,w);var D=w.ResolveImagePathEx("wg6_autofilter.gif");var B=WGChartUIEngine.CreateRibbonButton(i+"_SwitchRowAndColumn",D,C,false,150);CreateWebButton(B,{Host:L});Listener.Add(B.GetElement(),"onclick",WGChartUIEngine.OnSwitchRowColumnClick,w);O='<img src="'+w.ResolveImagePathEx("wg6_updatechart.gif")+'"/> <br/>'+O;var N=WGChartUIEngine.CreateRibbonButtonL(i+"_Update",O,false);N.WebGrid=w;CreateWebButton(N,{Host:M});Listener.Add(N.GetElement(),"onclick",WGChartUIEngine.OnUpdateChartClick,N);u.RenderComplexImages();r.RenderComplexImages();x.RenderComplexImages();d.RenderComplexImages();a.RenderComplexImages();j.RenderComplexImages();g.RenderComplexImages();B.RenderComplexImages();N.RenderComplexImages()}return true},OnChartTypeMenuClosed:function(){var a=ISGetObject(this.WebGrid.Id+"_ChartType");a.SetPushed(false)},OnFieldListClick:function(){var a=this;var b=a.WebGrid;b.ChartInteractiveUI.SetFieldListVisibility(a.IsPushed);return true},OnDropZoneClick:function(){var a=this;var b=a.WebGrid;b.ChartInteractiveUI.SetDropZoneVisibility(a.IsPushed);return true},OnLegendClick:function(){var a=this;var b=a.WebGrid;b.ChartInteractiveUI.SetLegendVisibility(a.IsPushed);return true},OnAutoFilterClick:function(){var a=this;var b=a.WebGrid;b.ChartInteractiveUI.SetAutoFilterEnabled(a.IsPushed);return true},OnAscendingClick:function(){var a=this[0];var b=this[1];var d=a.WebGrid;var c=d.ChartInteractiveUI;if(c.ChartAutoRefresh){c.ShowLoaderImage()}else{c.ShowUpdateText()}a.SetPushed(true);b.SetPushed(false);a.PivotData.SortOrder="Ascending";d.ChartInteractiveUI.PerformAutoRefresh();return true},OnDescendingClick:function(){var a=this[0];var b=this[1];var d=a.WebGrid;var c=d.ChartInteractiveUI;if(c.ChartAutoRefresh){c.ShowLoaderImage()}else{c.ShowUpdateText()}a.SetPushed(false);b.SetPushed(true);a.PivotData.SortOrder="Descending";d.ChartInteractiveUI.PerformAutoRefresh();return true},OnChartTypeClick:function(){var a=this;a.ChartInteractiveUI.ShowChartTypeMenu();return true},OnSwitchRowColumnClick:function(){var a=this;a.ChartInteractiveUI.SwitchRowAndColumn();return true},OnUpdateChartClick:function(){var a=this;var b=a.WebGrid;b.ChartInteractiveUI.ShowLoaderImage();var c=document.getElementById(b.Id+"_TitleXAxis");var d=document.getElementById(b.Id+"_TitleYAxis");var e=document.getElementById(b.Id+"_TitleZAxis");if(c!=null){b.ChartSettings.XAxis.Title.Text=c.value}if(d!=null){b.ChartSettings.YAxis.Title.Text=d.value}if(e!=null){b.ChartSettings.ZAxis.Title.Text=e.value}b.ChartInteractiveUI.RefreshChart()},CreateAddToButton:function(c,e,b){var d=null;var f=null;if(e.ChartMode=="InteractiveUI"){d=WGChartUIEngine.GetChildren(b,[2,0],[1,3],[6,0])}else{d=WGChartUIEngine.GetChildren(b,[2,0],[1,2],[6,0])}f=WGChartUIEngine.GetChildren(d,[2,0],[1,2],[1,0]);var a=new WebButton(c+"_AddTo");a.ButtonStyle=new DynamicStyle("WG5CE-CATBS","WG5CE-CATBOS","WG5CE-CATBAS");a.Text="Add To";a.WebGrid=e;CreateWebButton(a,{Host:f});Listener.Add(a.GetElement(),"onclick",WGChartUIEngine.AddDropPivot,e)},CreateChartUI:function(M){var ar=ISGetObject(M);var at=ar.LayoutSettings.ImageSettings;var x=M+"_ChartMap";var c=M+"_ChartContainer";var t=M+"_ChartInnerContainer";var y=M+"_ChartRibbon";var B=M+"_ChartRibbon_ShowHide";var A=M+"_ChartRibbon_FilterSort";var z=M+"_ChartRibbon_Chart";var C=M+"_ChartRibbon_Titles";var aE=M+"_TitleXAxis";var aG=M+"_TitleYAxis";var aI=M+"_TitleZAxis";var D=M+"_ChartRibbon_Update";var l=M+"_ChartDropFilterFieldsArea";var g=M+"_ChartDropDataFieldsArea";var r=M+"_ChartDropXYDataFieldsArea";var e=M+"_ChartDropBubbleDataFieldsArea";var p=M+"_ChartDropStockHLCDataFieldsArea";var q=M+"_ChartDropStockOHLCDataFieldsArea";var m=M+"_ChartDropPolarDataFieldsArea";var ay=M+"_TableFieldList";var a=M+"_AddToSelection";var s=M+"_ChartImage";var I=M+"_ChartStatus";var v=M+"_ChartLoader";var K=M+"_ChartUpdate";var o=M+"_ChartDropSeriesFieldsArea";var n=M+"_ChartDropSecondaryCategoryFieldsArea";var f=M+"_ChartDropCategoryFieldArea";var d="WG5CE-CCS";var G="WG5CE-CRFS";var E="WG5CE-CRCS";var u="WG5CE-CIS";var J="WG5CE-CTB";var j="WG5CE-CDFSA";var k="WG5CE-CDFIS";var h="WG5CE-CDDFAS";var i="WG5CE-CDDFIS";var aC="WG5CE-TFLS";var az="WG5CE-TFLDS";var b="WG5CE-ATSS";var w="WG5CE-CLS";var aB="WG5CE-TFLHS";var Z="";if(ar.ChartInteractiveUI.RibbonState=="Hidden"){Z="none"}var aa="none";var Y="none";var N="none";var ac="none";var R="none";var Q="none";var X="none";var O="none";var V="none";var W="none";var S="none";var ab="none";var U="none";var T="none";var P="none";var av=ar.GetString("Charting/Loading");var aL=ar.GetString("Charting/Update");var aK=ar.GetString("Charting/UpdateLinkText");var au=document.createElement("img");au.src=ar.ResolveImagePathEx("wg6_updatechart.gif");if(aK!=null&&aK.indexOf("{UpdateImage}")>=0){aK=aK.replace("{UpdateImage}",au.outerHTML)}var ax='<span style="text-decoration: underline; cursor:pointer;" onclick="wgChart_Refresh(\''+M+"')\">"+aK+"</span>";if(aL!=null&&aL.indexOf("{UpdateLink}")>=0){aL=aL.replace("{UpdateLink}",ax)}var ah=ar.GetString("Charting/DropFilterField");var ag=ar.GetString("Charting/DropDataField");var am=ar.GetString("Charting/DropSeriesField");var ae=ar.GetString("Charting/DropCategoryField");var ao=ar.GetString("Charting/DropXData");var ap=ar.GetString("Charting/DropYData");var ad=ar.GetString("Charting/DropBubbleData");var ai=ar.GetString("Charting/DropHighData");var aj=ar.GetString("Charting/DropLowData");var ak=ar.GetString("Charting/DropOpenData");var af=ar.GetString("Charting/DropCloseData");var an=ar.GetString("Charting/DropThetaData");var al=ar.GetString("Charting/DropRadiusData");var aw=ar.GetString("Charting/ShowHideRibbon");var aq=ar.GetString("Charting/FilterSortRibbon");var H=ar.GetString("Charting/ChartRibbon");var aD=ar.GetString("Charting/TitlesRibbon");var aF=ar.GetString("Charting/TitleXAxis");var aH=ar.GetString("Charting/TitleYAxis");var aJ=ar.GetString("Charting/TitleZAxis");var aA=ar.ResolveImagePathEx("wg6_bg_l.gif");var L=ar.ResolveImagePathEx("wg6_close_s.gif");var F="";if(ar.ChartMode=="InteractiveUI"){F='<tr><td><div id="'+y+'" style="display:'+Z+'"><table><tr><td><div id="'+B+'" style="display:'+aa+'"><table class="'+G+'" cellpadding="0" cellspacing="0"><tr><td style="padding: 4px 0px 0px 4px"></td><td><table><tr><td></td></tr><tr><td></td></tr></table></td></tr><tr><td class="'+E+'" colspan="2">'+aw+'</td></tr></table></div></td><td><div id="'+A+'" style="display:'+Y+'"><table class="'+G+'" cellpadding="0" cellspacing="0"><tr><td style="padding: 4px 0px 0px 4px"></td><td><table><tr><td></td></tr><tr><td></td></tr></table></td></tr><tr><td class="'+E+'" colspan="2">'+aq+'</td></tr></table></div></td><td><div id="'+z+'" style="display:'+N+'"><table class="'+G+'" cellpadding="0" cellspacing="0"><tr><td style="padding: 4px 0px 0px 4px"></td><td><table><tr><td></td></tr></table></td></tr><tr><td class="'+E+'" colspan="2">'+H+'</td></tr></table></div></td><td><div id="'+C+'" style="display:'+ac+'"> <table class="'+G+'" cellpadding="0" cellspacing="0"><tr style="height: 24px"><td class="'+u+'" style="padding-left: 4px; height: 22px"><nobr>'+aF+'&nbsp;</nobr></td><td style="width: 100%"><nobr><input id="'+aE+'" type="text" class="'+J+'" value="'+ar.ChartSettings.XAxis.Title.Text+'" />&nbsp;</nobr></td></tr><tr style="height: 20px"><td class="'+u+'" style="padding-left: 4px; height: 22px"><nobr>'+aH+'&nbsp;</nobr></td><td style="width: 100%"><nobr><input id="'+aG+'" type="text" class="'+J+'" value="'+ar.ChartSettings.YAxis.Title.Text+'" />&nbsp;</nobr></td></tr><tr style="height: 24px"><td class="'+u+'" style="padding-left: 4px; height: 22px"><nobr>'+aJ+'&nbsp;</nobr></td><td style="width: 100%"><nobr><input id="'+aI+'" type="text" class="'+J+'" value="'+ar.ChartSettings.ZAxis.Title.Text+'" />&nbsp;</nobr></td></tr><tr><td class="'+E+'" colspan="2">'+aD+'</td></tr></table></div></td><td><div id="'+D+'"><table class="'+G+'" cellpadding="0" cellspacing="0"><tr><td style="height: 90px; padding-left: 2px; padding-right: 2px"></td></tr></table></div></td></tr></table></div></td></tr>'}var aM='<div id="'+c+'" class="'+d+'"><table cellspacing="0" cellpadding="0" style="width: 100%; height: 100%">'+F+'<tr><td style="padding: 0px 2px 0px 2px"><div id="'+l+'" style="display:'+R+'"><table cellpadding="0" cellspacing="0" width="100%" class="'+j+'"><tr><td style="width: 100%;" class="'+k+'">'+ah+'</td></tr></table></div></td></tr><tr><td style="padding: 2px 2px 0px 2px"><div id="'+g+'" style="display:'+Q+'"><table cellpadding="0" cellspacing="0" width="100%" class="'+h+'"><tr><td style="width: 100%;" class="'+i+'">'+ag+'</td></tr></table></div><div id="'+r+'" style="display:'+X+'"><table border="1" cellpadding="0" cellspacing="0" width="100%" class="'+h+'"><tr><td style="width: 50%;" class="'+i+'">'+ao+'</td><td style="width: 50%;" class="'+i+'">'+ap+'</td></tr></table></div><div id="'+e+'" style="display:'+O+'"><table border="1" cellpadding="0" cellspacing="0" width="100%" class="'+h+'"><tr><td style="width: 33%;" class="'+i+'">'+ao+'</td><td style="width: 33%;" class="'+i+'">'+ap+'</td><td style="width: 34%;" class="'+i+'">'+ad+'</td></tr></table></div><div id="'+p+'" style="display:'+V+'"><table border="1" cellpadding="0" cellspacing="0" width="100%" class="'+h+'"><tr><td style="width: 33%;" class="'+i+'">'+ai+'</td><td style="width: 33%;" class="'+i+'">'+aj+'</td><td style="width: 34%;" class="'+i+'">'+af+'</td></tr></table></div><div id="'+q+'" style="display:'+W+'"><table border="1" cellpadding="0" cellspacing="0" width="100%" class="'+h+'"><tr><td style="width: 25%;" class="'+i+'">'+ak+'</td><td style="width: 25%;" class="'+i+'">'+ai+'</td><td style="width: 25%;" class="'+i+'">'+aj+'</td><td style="width: 25%;" class="'+i+'">'+af+'</td></tr></table></div><div id="'+m+'" style="display:'+S+'"><table border="1" cellpadding="0" cellspacing="0" width="100%" class="'+h+'"><tr><td style="width: 50%;" class="'+i+'">'+al+'</td><td style="width: 50%;" class="'+i+'">'+an+'</td></tr></table></div></td></tr><tr style="height:100%"><td id="'+t+'" style="padding: 2px 2px 0px 2px; height: 100%; width: 100%"><table style="height: 100%; width: 100%" cellpadding="0" cellspacing="0"><tr><td><div id="'+ay+'" style="margin-right: 2px; cursor: default; display:'+ab+"; background-repeat: repeat-x; background-image: url("+aA+')"><table class="'+aC+'" style="width: auto"><tbody><tr><th colspan="2"><table class="'+aB+'" cellspacing="0" cellpadding="0"><tr><td width="100%"></td><td><img title="Close" align="absmiddle" style="cursor: pointer" src="'+L+'" /></td></tr></table></th></tr><tr><td colspan="2"><div style="height: 190px; overflow-y: auto"><table class="'+az+'" style="width: 100%"></table></div></td></tr><tr><td></td><td><select id="'+a+'" class= "'+b+'"></select></td></tr></tbody></table></div></td><td style="height: 100%; width: 100%"><div style="height: 100%; width: 100%" ui-part="chartimage-container"><img id="'+s+'" style="display:none" border="0"/><table style="height: 100%; width: 100%" cellpadding="0" cellspacing="0" class="'+w+'" id="'+I+'"><tr id="'+v+'"><td><img alt="Loading" src="'+ar.ResolveImagePathEx(at.InProgressImage)+'" /><br />'+av+'</td></tr><tr style="display:none" id="'+K+'"><td>'+aL+'</td></tr></table></div></td><td><div id="'+o+'" style="margin-left: 2px; display:'+U+'"><table cellpadding="0" cellspacing="0" class="'+j+'"><tr><td class="'+k+'">'+am+'</td></tr></table></div><div id="'+n+'" style="margin-left: 2px; display:'+T+'"><table cellpadding="0" cellspacing="0" class="'+j+'"><tr><td class="'+k+'">'+ae+'</td></tr></table></div></td></tr></table></td></tr><tr><td style="padding: 2px 2px 2px 2px;"><div id="'+f+'" style="display:'+P+'"><table cellpadding="0" cellspacing="0" width="100%" class="'+j+'"><tr><td style="width: 100%;" class="'+k+'">'+ae+'</td></tr></table></div></td></tr></table><div id="'+x+'"></div></div>';return aM},InsertOption:function(a,d,e,b,c){a.options[b].text=d;a.options[b].value=e;a.options[b].selected=c;return true},EnableSortButton:function(d,c){var a=ISGetObject(d.Id+"_Ascending");var b=ISGetObject(d.Id+"_Descending");if(!c){if(a.Enabled){a.Disable()}if(b.Enabled){b.Disable()}if(a.IsPushed){a.SetPushed(false)}if(b.IsPushed){b.SetPushed(false)}}else{a.Enable();b.Enable()}return true},ClearDataCollection:function(e){var d=e.GetString("Charting/DropDataField");var a=e.ChartInteractiveUI;e.ChartDataCollection.Clear();switch(e.ChartSettings.ChartType){case"Column":case"Bar":case"Line":case"SmoothLine":case"StepLine":case"Area":case"Radar":case"Pie":case"Doughnut":var b=a.GetDropDataFieldsElement();var c=WGChartUIEngine.GetChildren(b,[4,0]);c.innerText=d;break;case"XYScatter":break;case"Bubble":break;case"Stock":break;case"Polar":break}return true},GetPivotObjectText:function(a){if(a.Caption==""){return a.DataMember}else{return a.Caption}},InitializeFieldListData:function(l){var f=l.ChartInteractiveUI;var k=f.GetTableListElement();var q=k.children[0];var t=WGChartUIEngine.GetChildren(q,[3,0],[4,0]);var g=t.parentElement.cells[1].children[0];var r=WGChartUIEngine.GetChildren(q,[1,0],[1,1],[3,0]);var n=l.RootTable.Name;if(n==null||n==""){n=l.RootTable.Caption}t.innerHTML="Chart Field List<br/> [ "+n+" ]";for(var m=0;m<l.RootTable.Columns.length;m++){var h=l.RootTable.Columns[m];var s=WGChartUIEngine.GetPivotObjectText(h);var j=h.DataMember;var p=h.ShowInChartFieldList;var a=h.CanAddToChartCategories;var b=h.CanAddToChartData;var c=h.CanAddToChartFilter;var d=h.CanAddToChartSeries;if(p){var o=r.insertRow(-1);var e=o.insertCell(-1);e.innerText=s;e.setAttribute("PivotType","Field");e.setAttribute("DateInterval","Years");e.setAttribute("DataMember",j);e.setAttribute("Name",j);WGChartUIEngine.InitializeFieldListRowData(l,f,e,a,b,c,d);if(h.DataType=="System.DateTime"){o=r.insertRow(-1);e=o.insertCell(-1);e.innerText=s+" (Years)";e.setAttribute("DateInterval","Years");e.setAttribute("PivotType","ByMonth");e.setAttribute("DataMember",j);e.setAttribute("Name",j+"Y");WGChartUIEngine.InitializeFieldListRowData(l,f,e,a,b,c,d);o=r.insertRow(-1);e=o.insertCell(-1);e.innerText=s+" (Quarters)";e.setAttribute("DateInterval","Quarters");e.setAttribute("PivotType","ByMonth");e.setAttribute("DataMember",j);e.setAttribute("Name",j+"Q");WGChartUIEngine.InitializeFieldListRowData(l,f,e,a,b,c,d);o=r.insertRow(-1);e=o.insertCell(-1);e.innerText=s+" (Months)";e.setAttribute("DateInterval","Months");e.setAttribute("PivotType","ByMonth");e.setAttribute("DataMember",j);e.setAttribute("Name",j+"M");WGChartUIEngine.InitializeFieldListRowData(l,f,e,a,b,c,d);o=r.insertRow(-1);e=o.insertCell(-1);e.innerText=s+" (Weeks)";e.setAttribute("DateInterval","Weeks");e.setAttribute("PivotType","ByWeek");e.setAttribute("DataMember",j);e.setAttribute("Name",j+"W");WGChartUIEngine.InitializeFieldListRowData(l,f,e,a,b,c,d)}}}if(g!=null){Listener.Add(g,"onclick",WGChartUIEngine.OnTableFieldListClose,f)}return true},InitializeFieldListRowData:function(g,f,e,a,b,c,d){e.className="WG5CE-TFDS";if(b!=null&&!b){e.setAttribute("canAddToChartData","false")}else{e.setAttribute("canAddToChartData","true")}if(a!=null&&!a){e.setAttribute("canAddToChartCategories","false")}else{e.setAttribute("canAddToChartCategories","true")}if(c!=null&&!c){e.setAttribute("canAddToChartFilter","false")}else{e.setAttribute("canAddToChartFilter","true")}if(d!=null&&!d){e.setAttribute("canAddToChartSeries","false")}else{e.setAttribute("canAddToChartSeries","true")}Listener.Add(e,"onclick",WGChartUIEngine.OnTableFieldListItemClick,f);Listener.Add(e,"ondblclick",WGChartUIEngine.AddDropPivot,g)},OnTableFieldListClose:function(){this.HideFieldList();this.PerformAutoRefresh()},OnTableFieldListItemClick:function(){var a=this;var c=a.LastSelectedFieldElement;var b=window.event.srcElement;if(c!=null){c.className="WG5CE-TFDS"}b.className="WG5CE-TFDSR";a.LastSelectedFieldElement=b},ApplyContextMenuStyle:function(a){var b=a.MenuStyleSettings;a.MenuWindowType="Normal";a.MenuAnimation=true;a.MenuDropShadow=true;a.SkipAlpha=true;a.DrawImageBackground=true;a.AnimationInterval=20;a.UseCssFramework=a.WebGrid.UseCssFramework;if(a.UseCssFramework){b.FrameStyle="common-menu";b.ItemStyle=new DynamicStyle("common-menu-item","common-menu-item hover");b.DisabledItemStyle=new DynamicStyle("common-menu-item disabled","common-menu-item disabled hover");b.CheckedItemStyle=new DynamicStyle("common-menu-checkeditem","common-menu-checkeditem hover");b.SeparatorStyle="common-menu-separator";b.BackgroundStripStyle="common-menu-strip";b.BackgroundStripColor="";b.BackgroundStripColor2="";a.MenuDropShadow=false}else{b.FrameStyle="Menu-FrameStyle";b.ItemStyle=new DynamicStyle("Menu-ItemStyle-Normal","Menu-ItemStyle-Over");b.DisabledItemStyle=new DynamicStyle("Menu-DisabledItemStyle-Normal","Menu-DisabledItemStyle-Over");b.CheckedItemStyle=new DynamicStyle("Menu-CheckedItemStyle-Normal","Menu-CheckedItemStyle-Over");b.SeparatorStyle="Menu-Separator";b.BackgroundStripStyle="Menu-Strip";b.BackgroundStripColor="E9EEEE";b.BackgroundStripColor2=""}},InitializeAutoCalcType:function(b){var a=new WebContextMenu(b.Id+"_AutoCalcMenu");a.WebGrid=b;WGChartUIEngine.ApplyContextMenuStyle(a);a.ClientSideEvents.OnMenuItemClick="wgChart_OnAutoCalcItemClick";a.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Sum","Sum",""));a.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Count","Count",""));a.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Min","Min",""));a.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Max","Max",""));a.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Avg","Average",""));a.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StDev","Standard Deviation",""));a.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Var","Variance",""));var d=new WebMenuItem();d.Type="Separator";d.Name="Separator";var c=new WebMenuItem();c.Name="Remove";c.Text="Remove";a.Items.Add(d);a.Items.Add(c);return true},InitializeChartMenuItem:function(d,e,b,a,f){var c=new WebMenuItem();c.Text=e;c.Name=d;c.ImageURL=b;c.Type="Radio";c.ChartType=a;if(b&&f){c.ImageClass="webui-icon webui-chart-"+b;c.ImageURL=IS.TransparentImage}return c},InitializeChartType:function(k){var j=k.ChartInteractiveUI;var f=new WebContextMenu(k.Id+"_ChartMenu");f.WebGrid=k;WGChartUIEngine.ApplyContextMenuStyle(f);f.ClientSideEvents.OnMenuItemClick="wgChart_OnChartMenuItemClick";f.OnRootMenuClosed=WGChartUIEngine.OnChartTypeMenuClosed;var l=k.UseCssFramework?"column":k.ResolveImagePathEx("ChartColumn.gif");if(j.ChartTypeRibbon.ColumnType.Enabled){var c=WGChartUIEngine.InitializeChartMenuItem("menuColumn","Column",l,null,k.UseCssFramework);if(j.ChartTypeRibbon.ColumnType.EnableClusteredColumnType){c.Items.Add(WGChartUIEngine.InitializeChartMenuItem("ClusteredColumn","Clustered Column","","Column"))}if(j.ChartTypeRibbon.ColumnType.EnableStackedColumnType){c.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedColumn","Stacked Column","","Column"))}if(j.ChartTypeRibbon.ColumnType.EnableStackedPercentageColumnType){c.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedPercentageColumn","100% Stacked Column","","Column"))}if(j.ChartTypeRibbon.ColumnType.EnableBasic3DColumnType){c.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Basic3DColumn","3D Column","","Column"))}if(j.ChartTypeRibbon.ColumnType.EnableClustered3DColumnType){c.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Clustered3DColumn","Clustered 3D Column","","Column"))}if(j.ChartTypeRibbon.ColumnType.EnableStacked3DColumnType){c.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Stacked3DColumn","Stacked 3D Column","","Column"))}if(j.ChartTypeRibbon.ColumnType.EnableStackedPercentage3DColumnType){c.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedPercentage3DColumn","Stacked Percentage 3D Column","","Column"))}f.Items.Add(c)}l=k.UseCssFramework?"bar":k.ResolveImagePathEx("ChartBar.gif");if(j.ChartTypeRibbon.BarType.Enabled){var b=WGChartUIEngine.InitializeChartMenuItem("menuBar","Bar",l,null,k.UseCssFramework);if(j.ChartTypeRibbon.BarType.EnableClusteredBarType){b.Items.Add(WGChartUIEngine.InitializeChartMenuItem("ClusteredBar","Clustered Bar","","Bar"))}if(j.ChartTypeRibbon.BarType.EnableStackedBarType){b.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedBar","Stacked Bar","","Bar"))}if(j.ChartTypeRibbon.BarType.EnableStackedPercentageBarType){b.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedPercentageBar","100% Stacked Bar","","Bar"))}if(j.ChartTypeRibbon.BarType.EnableBasic3DBarType){b.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Basic3DBar","3D Bar","","Bar"))}if(j.ChartTypeRibbon.BarType.EnableClustered3DBarType){b.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Clustered3DBar","Clustered 3D Bar","","Bar"))}if(j.ChartTypeRibbon.BarType.EnableStacked3DBarType){b.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Stacked3DBar","Stacked 3D Bar","","Bar"))}if(j.ChartTypeRibbon.BarType.EnableStackedPercentage3DBarType){b.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedPercentage3DBar","Stacked Percentage 3D Bar","","Bar"))}f.Items.Add(b)}l=k.UseCssFramework?"line":k.ResolveImagePathEx("ChartLine.gif");if(j.ChartTypeRibbon.LineType.Enabled){var e=WGChartUIEngine.InitializeChartMenuItem("menuLine","Line",l,null,k.UseCssFramework);if(j.ChartTypeRibbon.LineType.EnableOverlappedLineType){e.Items.Add(WGChartUIEngine.InitializeChartMenuItem("OverlappedLine","Overlapped Line","","Line"))}if(j.ChartTypeRibbon.LineType.EnableOverlappedLineWithMarkersType){e.Items.Add(WGChartUIEngine.InitializeChartMenuItem("OverlappedLineWithMarkers","Overlapped Line With Markers","","Line"))}if(j.ChartTypeRibbon.LineType.EnableStackedLineType){e.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedLine","Stacked Line","","Line"))}if(j.ChartTypeRibbon.LineType.EnableOverlappedLineWithMarkersType){e.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedLineWithMarkers","Stacked Line With Markers","","Line"))}if(j.ChartTypeRibbon.LineType.EnableStackedPercentageLineType){e.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedPercentageLine","Stacked Percentage Line","","Line"))}if(j.ChartTypeRibbon.LineType.EnableStackedPercentageLineWithMarkersType){e.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedPercentageLineWithMarkers","Stacked Percentage Line With Markers","","Line"))}if(j.ChartTypeRibbon.LineType.EnableBasic3DLineType){e.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Basic3DLine","Basic 3D Line","","Line"))}if(j.ChartTypeRibbon.LineType.EnableBasic3DLineWithMarkersType){e.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Basic3DLineWithMarkers","Basic 3D Line With Markers","","Line"))}if(j.ChartTypeRibbon.LineType.EnableOverlapped3DLineType){e.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Overlapped3DLine","Overlapped 3D Line","","Line"))}if(j.ChartTypeRibbon.LineType.EnableOverlapped3DLineWithMarkersType){e.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Overlapped3DLineWithMarkers","Overlapped 3D Line With Markers","","Line"))}if(j.ChartTypeRibbon.LineType.EnableStacked3DLineType){e.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Stacked3DLine","Stacked 3D Line","","Line"))}if(j.ChartTypeRibbon.LineType.EnableStacked3DLineWithMarkersType){e.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Stacked3DLineWithMarkers","Stacked 3D Line With Markers","","Line"))}if(j.ChartTypeRibbon.LineType.EnableStackedPercentage3DLineType){e.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedPercentage3DLine","Stacked Percentage 3D Line","","Line"))}if(j.ChartTypeRibbon.LineType.EnableStackedPercentage3DLineWithMarkersType){e.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedPercentage3DLineWithMarkers","Stacked Percentage 3D Line With Markers","","Line"))}f.Items.Add(e)}l=k.UseCssFramework?"smoothline":k.ResolveImagePathEx("ChartSmoothLine.gif");if(j.ChartTypeRibbon.SmoothLineType.Enabled){var h=WGChartUIEngine.InitializeChartMenuItem("menuSmoothLine","Smooth Line",l,null,k.UseCssFramework);if(j.ChartTypeRibbon.SmoothLineType.EnableOverlappedSmoothLineType){h.Items.Add(WGChartUIEngine.InitializeChartMenuItem("OverlappedSmoothLine","Overlapped Smooth Line","","SmoothLine"))}if(j.ChartTypeRibbon.SmoothLineType.EnableOverlappedSmoothLineWithMarkersType){h.Items.Add(WGChartUIEngine.InitializeChartMenuItem("OverlappedSmoothLineWithMarkers","Overlapped Smooth Line With Markers","","SmoothLine"))}f.Items.Add(h)}l=k.UseCssFramework?"stepline":k.ResolveImagePathEx("ChartStepLine.gif");if(j.ChartTypeRibbon.StepLineType.Enabled){var i=WGChartUIEngine.InitializeChartMenuItem("menuStepLine","Step Line",l,null,k.UseCssFramework);if(j.ChartTypeRibbon.StepLineType.EnableOverlappedStepLineType){i.Items.Add(WGChartUIEngine.InitializeChartMenuItem("OverlappedStepLine","Overlapped Step Line","","StepLine"))}if(j.ChartTypeRibbon.StepLineType.EnableOverlappedStepLineWithMarkersType){i.Items.Add(WGChartUIEngine.InitializeChartMenuItem("OverlappedStepLineWithMarkers","Overlapped Step Line With Markers","","StepLine"))}if(j.ChartTypeRibbon.StepLineType.EnableBasic3DStepLineType){i.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Basic3DStepLine","Basic 3D Step Line","","StepLine"))}if(j.ChartTypeRibbon.StepLineType.EnableBasic3DStepLineWithMarkersType){i.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Basic3DStepLineWithMarkers","Basic 3D Step Line With Markers","","StepLine"))}f.Items.Add(i)}l=k.UseCssFramework?"pie":k.ResolveImagePathEx("ChartPie.gif");if(j.ChartTypeRibbon.PieType.Enabled){var g=WGChartUIEngine.InitializeChartMenuItem("menuPie","Pie",l,null,k.UseCssFramework);if(j.ChartTypeRibbon.PieType.EnablePieType){g.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Pie","Pie","","Pie"))}if(j.ChartTypeRibbon.PieType.EnableExplodedPieType){g.Items.Add(WGChartUIEngine.InitializeChartMenuItem("ExplodedPie","Exploded Pie","","Pie"))}if(j.ChartTypeRibbon.PieType.EnableBasic3DPieType){g.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Basic3DPie","Basic 3D Pie","","Pie"))}if(j.ChartTypeRibbon.PieType.EnableBasic3DPieType){g.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Exploded3DPie","Exploded 3D Pie","","Pie"))}f.Items.Add(g)}l=k.UseCssFramework?"doughnut":k.ResolveImagePathEx("ChartDoughnut.gif");if(j.ChartTypeRibbon.DoughnutType.Enabled){var d=WGChartUIEngine.InitializeChartMenuItem("menuDoughnut","Doughnut",l,null,k.UseCssFramework);if(j.ChartTypeRibbon.DoughnutType.EnableDoughnutType){d.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Doughnut","Doughnut","","Doughnut"))}if(j.ChartTypeRibbon.DoughnutType.EnableExplodedDoughnutType){d.Items.Add(WGChartUIEngine.InitializeChartMenuItem("ExplodedDoughnut","Exploded Doughnut","","Doughnut"))}if(j.ChartTypeRibbon.DoughnutType.EnableBasic3DDoughnutType){d.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Basic3DDoughnut","Basic 3D Doughnut","","Doughnut"))}if(j.ChartTypeRibbon.DoughnutType.EnableBasic3DDoughnutType){d.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Exploded3DDoughnut","Exploded 3D Doughnut","","Doughnut"))}f.Items.Add(d)}l=k.UseCssFramework?"area":k.ResolveImagePathEx("ChartArea.gif");if(j.ChartTypeRibbon.AreaType.Enabled){var a=WGChartUIEngine.InitializeChartMenuItem("menuArea","Area",l,null,k.UseCssFramework);if(j.ChartTypeRibbon.AreaType.EnableAreaType){a.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Area","Area","","Area"))}if(j.ChartTypeRibbon.AreaType.EnableStackedAreaType){a.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedArea","Stacked Area","","Area"))}if(j.ChartTypeRibbon.AreaType.EnableStackedPercentageAreaType){a.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedPercentageArea","Stacked Percentage Area","","Area"))}if(j.ChartTypeRibbon.AreaType.EnableBasic3DAreaType){a.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Basic3DArea","Basic 3D Area","","Area"))}if(j.ChartTypeRibbon.AreaType.EnableStacked3DAreaType){a.Items.Add(WGChartUIEngine.InitializeChartMenuItem("Stacked3DArea","Stacked 3D Area","","Area"))}if(j.ChartTypeRibbon.AreaType.EnableStackedPercentage3DAreaType){a.Items.Add(WGChartUIEngine.InitializeChartMenuItem("StackedPercentage3DArea","Stacked Percentage 3D Area","","Area"))}f.Items.Add(a)}return true},SynchronizeChartType:function(b){var a=ISGetObject(b.Id+"_ChartMenu");var h="menu"+b.ChartSettings.ChartType;var f=null;switch(b.ChartSettings.ChartType){case"Column":f=b.ChartSettings.SeriesColumnSettings.Type;break;case"Bar":f=b.ChartSettings.SeriesBarSettings.Type;break;case"Line":f=b.ChartSettings.SeriesLineSettings.Type;break;case"SmoothLine":f=b.ChartSettings.SeriesSmoothLineSettings.Type;break;case"StepLine":f=b.ChartSettings.SeriesStepLineSettings.Type;break;case"Pie":f=b.ChartSettings.SeriesPieSettings.Type;break;case"Doughnut":f=b.ChartSettings.SeriesDoughnutSettings.Type;break;case"Area":f=b.ChartSettings.SeriesAreaSettings.Type;break}for(var c=0;c<a.Items.length;c++){var e=a.Items[c];if(e.Name==h){for(var d=0;d<e.Items.length;d++){var g=e.Items[d];if(g.Name==f){g.SetChecked(true,true);a.PreviousMenuItem=g;break}}break}}return true},SynchronizePivotObject:function(b,c){var a=b.RootTable.Columns.GetNamedItem(c.DataMember);var d=WGChartUIEngine.GetPivotObjectText(a);if(c.PivotType=="Field"){c.Text=d}else{if(c.PivotType=="ByMonth"){if(c.DateInterval=="Years"){c.Text=d+" (Years)"}if(c.DateInterval=="Quarters"){c.Text=d+" (Quarters)"}if(c.DateInterval=="Months"){c.Text=d+" (Months)"}}else{if(c.PivotType=="ByWeek"){if(c.DateInterval=="Years"){c.Text=d+" (Years)"}if(c.DateInterval=="Weeks"){c.Text=d+" (Weeks)"}}}}},SynchronizeSeriesCollection:function(c){var a=c.ChartSeriesCollection.length;for(var d=0;d<a;d++){var e=c.ChartSeriesCollection[d];WGChartUIEngine.SynchronizePivotObject(c,e);var b=WGChartUIEngine.AddDropSeriesElement(c,e);var f=WGChartUIEngine.AddPivotFilterInfo(c,e);e.PivotElement=b;e.PivotInfo=f;c.CachePivotFilterCollection.Add(e)}return true},SynchronizeCategoryCollection:function(c){var a=c.ChartCategoryCollection.length;for(var d=0;d<a;d++){var e=c.ChartCategoryCollection[d];WGChartUIEngine.SynchronizePivotObject(c,e);var b=WGChartUIEngine.AddDropCategoryElement(c,e);var f=WGChartUIEngine.AddPivotFilterInfo(c,e);e.PivotElement=b;e.PivotInfo=f;c.CachePivotFilterCollection.Add(e)}return true},SynchronizeFilterCollection:function(c){var a=c.ChartFilterCollection.length;for(var d=0;d<a;d++){var e=c.ChartFilterCollection[d];WGChartUIEngine.SynchronizePivotObject(c,e);var b=WGChartUIEngine.AddDropFilterElement(c,e);var f=WGChartUIEngine.AddPivotFilterInfo(c,e);e.PivotElement=b;e.PivotInfo=f;c.CachePivotFilterCollection.Add(e)}return true},SynchronizeDataCollection:function(d){var a=d.ChartInteractiveUI;switch(d.ChartSettings.ChartType){case"Column":case"Bar":case"Line":case"SmoothLine":case"StepLine":case"Area":case"Radar":case"Pie":case"Doughnut":if(d.ChartDataCollection.length==0){d.ChartDataCollection.CopyFrom(a.MasterDataCollection)}var c=d.ChartDataCollection.length;for(var e=0;e<c;e++){var f=a.Parent.ChartDataCollection[e];var b=d.RootTable.Columns.GetNamedItem(f.DataMember);var g=WGChartUIEngine.GetPivotObjectText(b);f.Text=g;WGChartUIEngine.AddDropDataElement(d,f)}break;case"XYScatter":break;case"Bubble":break;case"Stock":break;case"Polar":break}return true},SynchronizeDropZone:function(e){var b=e.ChartInteractiveUI;var a=e.ChartSettings;var d=b.GetDropZoneSelectionElement();if(b.ShowOrHideRibbon.ShowDropZone){b.GetDropFilterFieldsElement().style.display="";switch(a.ChartType){case"Column":case"Bar":case"Line":case"SmoothLine":case"StepLine":case"Area":case"Radar":b.GetDropDataFieldsElement().style.display="";b.GetDropXYDataFieldsElement().style.display="none";b.GetDropBubbleDataFieldsElement().style.display="none";b.GetDropStockHLCDataFieldsElement().style.display="none";b.GetDropStockOHLCDataFieldsElement().style.display="none";b.GetDropPolarDataFieldsElement().style.display="none";b.GetDropSeriesFieldsElement().style.display="";b.GetDropCategoryFieldsElement().style.display="";b.GetDropSecondaryCategoryFieldsElement().style.display="none";var c=0;d.options.length=4;WGChartUIEngine.InsertOption(d,"Series Area","Series",c++);WGChartUIEngine.InsertOption(d,"Category Area","Category",c++);WGChartUIEngine.InsertOption(d,"Filter Area","Filter",c++);WGChartUIEngine.InsertOption(d,"Data Area","Data",c++,true);break;case"Pie":case"Doughnut":b.GetDropDataFieldsElement().style.display="";b.GetDropXYDataFieldsElement().style.display="none";b.GetDropBubbleDataFieldsElement().style.display="none";b.GetDropStockHLCDataFieldsElement().style.display="none";b.GetDropStockOHLCDataFieldsElement().style.display="none";b.GetDropPolarDataFieldsElement().style.display="none";b.GetDropSeriesFieldsElement().style.display="none";b.GetDropCategoryFieldsElement().style.display="none";b.GetDropSecondaryCategoryFieldsElement().style.display="";var c=0;d.options.length=3;WGChartUIEngine.InsertOption(d,"Category Area","Category",c++);WGChartUIEngine.InsertOption(d,"Filter Area","Filter",c++);WGChartUIEngine.InsertOption(d,"Data Area","Data",c++,true);break;case"XYScatter":b.GetDropDataFieldsElement().style.display="none";b.GetDropXYDataFieldsElement().style.display="";b.GetDropBubbleDataFieldsElement().style.display="none";b.GetDropStockHLCDataFieldsElement().style.display="none";b.GetDropStockOHLCDataFieldsElement().style.display="none";b.GetDropPolarDataFieldsElement().style.display="none";b.GetDropSeriesFieldsElement().style.display="";b.GetDropCategoryFieldsElement().style.display="";b.GetDropSecondaryCategoryFieldsElement().style.display="none";var c=0;d.options.length=5;WGChartUIEngine.InsertOption(d,"Series Area","Series",c++);WGChartUIEngine.InsertOption(d,"Category Area","Category",c++);WGChartUIEngine.InsertOption(d,"Filter Area","Filter",c++);WGChartUIEngine.InsertOption(d,"X Data Area","XData",c++,true);WGChartUIEngine.InsertOption(d,"Y Data Area","YData",c++);break;case"Bubble":b.GetDropDataFieldsElement().style.display="none";b.GetDropXYDataFieldsElement().style.display="none";b.GetDropBubbleDataFieldsElement().style.display="";b.GetDropStockHLCDataFieldsElement().style.display="none";b.GetDropStockOHLCDataFieldsElement().style.display="none";b.GetDropPolarDataFieldsElement().style.display="none";b.GetDropSeriesFieldsElement().style.display="";b.GetDropCategoryFieldsElement().style.display="";b.GetDropSecondaryCategoryFieldsElement().style.display="none";var c=0;d.options.length=6;WGChartUIEngine.InsertOption(d,"Series Area","Series",c++);WGChartUIEngine.InsertOption(d,"Category Area","Category",c++);WGChartUIEngine.InsertOption(d,"Filter Area","Filter",c++);WGChartUIEngine.InsertOption(d,"X Data Area","XData",c++,true);WGChartUIEngine.InsertOption(d,"Y Data Area","YData",c++);WGChartUIEngine.InsertOption(d,"Bubble Data Area","BubbleData",c++);break;case"Stock":b.GetDropDataFieldsElement().style.display="none";b.GetDropXYDataFieldsElement().style.display="none";b.GetDropBubbleDataFieldsElement().style.display="none";b.GetDropPolarDataFieldsElement().style.display="none";b.GetDropSeriesFieldsElement().style.display="";b.GetDropCategoryFieldsElement().style.display="";b.GetDropSecondaryCategoryFieldsElement().style.display="none";if(a.SeriesStockSettings.Type=="HighLowClose"){b.GetDropStockHLCDataFieldsElement().style.display="";b.GetDropStockOHLCDataFieldsElement().style.display="none";var c=0;d.options.length=6;WGChartUIEngine.InsertOption(d,"Series Area","Series",c++);WGChartUIEngine.InsertOption(d,"Category Area","Category",c++);WGChartUIEngine.InsertOption(d,"Filter Area","Filter",c++);WGChartUIEngine.InsertOption(d,"High Data Area","HighData",c++,true);WGChartUIEngine.InsertOption(d,"Low Data Area","LowData",c++);WGChartUIEngine.InsertOption(d,"Close Data Area","CloseData",c++)}else{b.GetDropStockHLCDataFieldsElement().style.display="none";b.GetDropStockOHLCDataFieldsElement().style.display="";var c=0;d.options.length=7;WGChartUIEngine.InsertOption(d,"Series Area","Series",c++);WGChartUIEngine.InsertOption(d,"Category Area","Category",c++);WGChartUIEngine.InsertOption(d,"Filter Area","Filter",c++);WGChartUIEngine.InsertOption(d,"Open Data Area","OpenData",c++,true);WGChartUIEngine.InsertOption(d,"High Data Area","HighData",c++);WGChartUIEngine.InsertOption(d,"Low Data Area","LowData",c++);WGChartUIEngine.InsertOption(d,"Close Data Area","CloseData",c++)}break;case"Polar":b.GetDropDataFieldsElement().style.display="none";b.GetDropXYDataFieldsElement().style.display="none";b.GetDropBubbleDataFieldsElement().style.display="none";b.GetDropStockHLCDataFieldsElement().style.display="none";b.GetDropStockOHLCDataFieldsElement().style.display="none";b.GetDropPolarDataFieldsElement().style.display="";b.GetDropSeriesFieldsElement().style.display="";b.GetDropCategoryFieldsElement().style.display="";b.GetDropSecondaryCategoryFieldsElement().style.display="none";var c=0;d.options.length=5;WGChartUIEngine.InsertOption(d,"Series Area","Series",c++);WGChartUIEngine.InsertOption(d,"Category Area","Category",c++);WGChartUIEngine.InsertOption(d,"Filter Area","Filter",c++);WGChartUIEngine.InsertOption(d,"Radius Data Area","RadiusData",c++,true);WGChartUIEngine.InsertOption(d,"Theta Data Area","ThetaData",c++);break}}else{b.GetDropFilterFieldsElement().style.display="none";b.GetDropDataFieldsElement().style.display="none";b.GetDropXYDataFieldsElement().style.display="none";b.GetDropBubbleDataFieldsElement().style.display="none";b.GetDropStockHLCDataFieldsElement().style.display="none";b.GetDropStockOHLCDataFieldsElement().style.display="none";b.GetDropPolarDataFieldsElement().style.display="none";b.GetDropSeriesFieldsElement().style.display="none";b.GetDropCategoryFieldsElement().style.display="none";b.GetDropSecondaryCategoryFieldsElement().style.display="none"}WGChartEngine.SetChartContainerSize(e);return true},AddDropPivot:function(b,c,a){var n=null;if(b&&b.ClassName=="WebGrid"){n=b}else{n=this}var h=n.ChartInteractiveUI;var r=h.GetDropZoneSelectionElement();var u=null;var m=null;if(c){u=c}else{u=r.options[r.selectedIndex].value}if(a){m=a}else{m=h.LastSelectedFieldElement}if(!m){alert("Please select a field to be added into "+u+" Area.");return}var j=m.attributes.DataMember.value;var q=m.attributes.PivotType.value;var k=m.attributes.DateInterval.value;var o=m.attributes.Name.value;var t=m.innerText;var i=n.RootTable.Columns.GetNamedItem(j);if(m!=null&&m.innerText!=""){var d=m.attributes.canAddToChartCategories.value;var e=m.attributes.canAddToChartData.value;var f=m.attributes.canAddToChartFilter.value;var g=m.attributes.canAddToChartSeries.value;switch(u){case"Data":if(e=="true"){var p=new ChartPivotDataConfig();p.DataMember=i.DataMember;p.DataType=i.DataType;p.Name=i.DataMember;p.WebGrid=n;p.Text=t;var s=WGChartUIEngine.AddDropPivotData(n,p);if(!s){return false}}else{var l=n.GetString("Charting/ErrorAddToData");alert(l);return false}break;case"Series":if(g=="true"){if(h.ChartAutoRefresh){h.ShowLoaderImage()}else{h.ShowUpdateText()}WGChartUIEngine.AddDropPivotSeries(n,j,q,k,o,t)}else{var l=n.GetString("Charting/ErrorAddToSeries");alert(l);return false}break;case"Category":if(d=="true"){if(h.ChartAutoRefresh){h.ShowLoaderImage()}else{h.ShowUpdateText()}WGChartUIEngine.AddDropPivotCategory(n,j,q,k,o,t)}else{var l=n.GetString("Charting/ErrorAddToCategory");alert(l);return false}break;case"Filter":if(f=="true"){if(h.ChartAutoRefresh){h.ShowLoaderImage()}else{h.ShowUpdateText()}WGChartUIEngine.AddDropPivotFilter(n,j,q,k,o,t)}else{var l=n.GetString("Charting/ErrorAddToFilter");alert(l);return false}break}}h.PerformAutoRefresh();return true},AddDropPivotData:function(c,d){if(c.ChartDataCollection.GetNamedItem(d.DataMember)!=null){var b=c.GetString("Charting/ErrorDuplicateData");alert(b);return false}var a=c.ChartInteractiveUI;if(a.ChartAutoRefresh){a.ShowLoaderImage()}else{a.ShowUpdateText()}a.MasterDataCollection.Add(d);c.ChartDataCollection.Add(d);switch(c.ChartSettings.ChartType){case"Column":case"Bar":case"Line":case"SmoothLine":case"StepLine":case"Area":case"Radar":case"Pie":case"Doughnut":WGChartUIEngine.AddDropDataElement(c,d);break;case"XYScatter":break;case"Bubble":break;case"Stock":break;case"Polar":break}return true},AddDropPivotSeries:function(g,c,n,d,k,o){var a=g.ChartInteractiveUI;var b=g.RootTable.Columns.GetNamedItem(c);var j=g.ChartSeriesCollection.GetNamedItem(k);var h=g.ChartCategoryCollection.GetNamedItem(k);var i=g.ChartFilterCollection.GetNamedItem(k);if(j==null){var l=g.CachePivotFilterCollection.GetNamedItem(k);if(l==null){var l=new ChartPivotFilterConfig();l.DataMember=b.DataMember;l.DataType=b.DataType;l.Name=k;l.PivotType=n;l.DateInterval=d;l.Text=o;l.WebGrid=g;g.CachePivotFilterCollection.Add(l)}var m=g.CachePivotFilterInfoCollection.GetNamedItem(k);if(m!=null){var f=a.GetDropSeriesFieldsElement();var e=WGChartUIEngine.GetDropPivotElement(f);e.appendChild(m.PivotObject.PivotElement);WGChartUIEngine.CssFloat(m.PivotObject.PivotElement,"");if(h!=null){l=h;WGChartUIEngine.RemoveDropCategoryField(g,l)}if(i!=null){l=i;WGChartUIEngine.RemoveDropFilterField(g,l)}}else{l.PivotElement=WGChartUIEngine.AddDropSeriesElement(g,l);WGChartUIEngine.AddPivotFilterInfo(g,l)}g.ChartSeriesCollection.Add(l);g.ChartSeriesCollection.UpdateChanges()}},AddDropPivotCategory:function(i,c,q,d,m,r){var a=i.ChartInteractiveUI;var b=i.RootTable.Columns.GetNamedItem(c);var l=i.ChartSeriesCollection.GetNamedItem(m);var j=i.ChartCategoryCollection.GetNamedItem(m);var k=i.ChartFilterCollection.GetNamedItem(m);if(j==null){var n=i.CachePivotFilterCollection.GetNamedItem(m);if(n==null){var n=new ChartPivotFilterConfig();n.DataMember=b.DataMember;n.DataType=b.DataType;n.Name=m;n.PivotType=q;n.DateInterval=d;n.Text=r;n.WebGrid=i;i.CachePivotFilterCollection.Add(n)}var o=i.CachePivotFilterInfoCollection.GetNamedItem(m);if(o!=null){var g=a.GetDropCategoryFieldsElement();var e=WGChartUIEngine.GetDropPivotElement(g);WGChartUIEngine.CssFloat(o.PivotObject.PivotElement,"left");e.appendChild(o.PivotObject.PivotElement);var p=n.PivotElement.pivotSecondary;if(p!=null){var h=a.GetDropSecondaryCategoryFieldsElement();var f=WGChartUIEngine.GetDropPivotElement(h);f.appendChild(p)}if(l!=null){n=l;WGChartUIEngine.RemoveDropSeriesField(i,n)}if(k!=null){n=k;WGChartUIEngine.RemoveDropFilterField(i,n)}}else{n.PivotElement=WGChartUIEngine.AddDropCategoryElement(i,n);WGChartUIEngine.AddPivotFilterInfo(i,n)}i.ChartCategoryCollection.Add(n);i.ChartCategoryCollection.UpdateChanges()}},AddDropPivotFilter:function(g,c,n,d,k,o){var a=g.ChartInteractiveUI;var b=g.RootTable.Columns.GetNamedItem(c);var j=g.ChartSeriesCollection.GetNamedItem(k);var h=g.ChartCategoryCollection.GetNamedItem(k);var i=g.ChartFilterCollection.GetNamedItem(k);if(i==null){var l=g.CachePivotFilterCollection.GetNamedItem(k);if(l==null){var l=new ChartPivotFilterConfig();l.DataMember=b.DataMember;l.DataType=b.DataType;l.Name=k;l.PivotType=n;l.DateInterval=d;l.Text=o;l.WebGrid=g;g.CachePivotFilterCollection.Add(l)}var m=g.CachePivotFilterInfoCollection.GetNamedItem(k);if(m!=null){var f=a.GetDropFilterFieldsElement();var e=WGChartUIEngine.GetDropPivotElement(f);e.appendChild(m.PivotObject.PivotElement);WGChartUIEngine.CssFloat(m.PivotObject.PivotElement,"left");if(j!=null){l=j;WGChartUIEngine.RemoveDropSeriesField(g,l)}if(h!=null){l=h;WGChartUIEngine.RemoveDropCategoryField(g,l)}}else{l.PivotElement=WGChartUIEngine.AddDropFilterElement(g,l);WGChartUIEngine.AddPivotFilterInfo(g,l)}g.ChartFilterCollection.Add(l);g.ChartFilterCollection.UpdateChanges()}},AddPivotFilterInfo:function(a,b){var c=new ChartPivotFilterInfo();c.Name=b.Name;c.PivotObject=b;c.WebGrid=a;a.CachePivotFilterInfoCollection.Add(c);return c},AddDropDataElement:function(d,e){var a=d.ChartInteractiveUI;var f=WGChartUIEngine.CreatePivotDataElement(d,e);var c=a.GetDropDataFieldsElement();var b=WGChartUIEngine.GetDropPivotElement(c);b.appendChild(f);e.PivotElement=f;return f},AddDropSeriesElement:function(d,e){var a=d.ChartInteractiveUI;var f=WGChartUIEngine.CreatePivotFilterElement(d,e,false);var c=a.GetDropSeriesFieldsElement();var b=WGChartUIEngine.GetDropPivotElement(c);b.appendChild(f);return f},AddDropCategoryElement:function(f,g){var a=f.ChartInteractiveUI;var h=WGChartUIEngine.CreatePivotFilterElement(f,g,true);var d=a.GetDropCategoryFieldsElement();var b=WGChartUIEngine.GetDropPivotElement(d);b.appendChild(h);var i=WGChartUIEngine.CreatePivotFilterElement(f,g,false);var e=a.GetDropSecondaryCategoryFieldsElement();var c=WGChartUIEngine.GetDropPivotElement(e);c.appendChild(i);h.pivotSecondary=i;return h},AddDropFilterElement:function(d,e){var a=d.ChartInteractiveUI;var f=WGChartUIEngine.CreatePivotFilterElement(d,e,true);var c=a.GetDropFilterFieldsElement();var b=WGChartUIEngine.GetDropPivotElement(c);b.appendChild(f);return f},GetDropPivotElement:function(b){var a=WGChartUIEngine.GetChildren(b,[4,0]);if(a.children.length==0){a.innerHTML="";a.style.padding="0px"}return a},CreatePivotDataElement:function(c,d){var a=c.ChartInteractiveUI;if(d.WebGrid==null){d.WebGrid=c}var b=document.createElement("div");b.className="WG5CE-CPS";WGChartUIEngine.CssFloat(b,"left");var f=document.createElement("span");f.innerText=d.GetText();b.appendChild(f);var e=document.createElement("span");e.innerHTML='<img align="absmiddle" src="'+c.ResolveImagePathEx("wg_arrow.gif")+'" />';e.style.marginLeft="2px";e.style.cursor="pointer";e.setAttribute("MenuId",c.Id+"_AutoCalcMenu");b.appendChild(e);Listener.Add(e,"onclick",WGChartUIEngine.OnPivotDataClick,d);Listener.Add(f,"onmousedown",WGChartUIEngine.OnPivotItemMouseDown,d);return b},CreatePivotFilterElement:function(c,f,d){if(f.WebGrid==null){f.WebGrid=c}var a=c.ChartInteractiveUI;var b=document.createElement("div");b.className="WG5CE-CPS";b.type="PivotItem";b.Name=f.Name;if(d){WGChartUIEngine.CssFloat(b,"left")}var e=document.createElement("nobr");b.appendChild(e);var h=document.createElement("span");h.innerText=f.Text;h.style.cursor="pointer";e.appendChild(h);Listener.Add(h,"onclick",WGChartUIEngine.OnPivotFilterTextElementClick,f);Listener.Add(h,"onmousedown",WGChartUIEngine.OnPivotItemMouseDown,f);var g=document.createElement("span");g.innerHTML='<img align="absmiddle" src="'+c.ResolveImagePathEx("wg_arrow.gif")+'" />';g.style.marginLeft="2px";g.style.cursor="pointer";e.appendChild(g);Listener.Add(g,"onclick",WGChartUIEngine.OnPivotFilterPointerElementClick,f);return b},GetListElement:function(b,e){var c=b.GetTableListElement();var f=c.children[0];var g=WGChartUIEngine.GetChildren(f,[1,0],[1,1],[3,0]);for(var d=0;d<g.rows.length;d++){var a=g.rows[d].cells[0];if(IS.GetAttr(a,"Name")==e){return a}}return null},OnPivotItemMouseDown:function(){WGChartDragDropEngine.OnPivotItemMouseDown(this)},OnPivotFilterTextElementClick:function(){var g=this;var e=window.event.srcElement;var h=e.parentElement.parentElement;var f=g.WebGrid;var d=g.WebGrid.ChartInteractiveUI;var c=d.GetChartContainer();if(d.LastPivotElement!=null){d.LastPivotElement.className="WG5CE-CPS"}c.setAttribute("pivotClicked","true");d.LastPivotElement=h;h.className="WG5CE-CPSC";if(!IS.moz&&h.style.styleFloat==""){h.style.padding="2px 4px 2px 3px"}else{if(IS.moz&&h.style.cssFloat==""){h.style.padding="2px 4px 2px 3px"}else{h.style.padding=""}}var a=ISGetObject(f.Id+"_Ascending");var b=ISGetObject(f.Id+"_Descending");a.PivotData=g;b.PivotData=g;a.Enable();b.Enable();if(g.SortOrder=="Ascending"){a.SetPushed(true);b.SetPushed(false)}if(g.SortOrder=="Descending"){a.SetPushed(false);b.SetPushed(true)}return true},OnPivotFilterPointerElementClick:function(){var v=true;var o=window.event.srcElement;var k=o.parentElement.parentElement.parentElement;var x=this;var r=x.WebGrid;var s=r.LayoutSettings.ImageSettings;var g=r.ChartInteractiveUI;var y=r.CachePivotFilterInfoCollection.GetNamedItem(x.Name);if(y.TotalChecked>-1){if(y.IsAllChecked()){y.TotalChecked=y.GetCheckedData().length-1}else{y.TotalChecked=y.GetCheckedData().length}}if(y!=null){g.LastPivotInfo=y;x.PivotInfo=y;if(y.PivotInfoElement==null){v=false;var m=document.createElement("div");m.style.backgroundColor="white";m.style.display="";m.setAttribute("ui-part","chartfilter-container");y.PivotInfoElement=m;var J=document.createElement("table");J.cellPadding=0;J.cellSpacing=0;J.style.border="solid 1px black";J.style.width="180px";J.className="WG5CE-CPFI";m.appendChild(J);var F=J.insertRow(-1);var q=r.ResolveImagePathEx("wg6_bg_s.gif");F.style.padding="2px";var f=F.insertCell(-1);f.style.cssText="background-image:url("+q+"); background-repeat: repeat-x;border-bottom: solid 1px black; text-align: right; cursor: move";f.title="Drag to move";f.className="WG5CE-CPFIH";Listener.Add(f,"onmousedown",WGChartDragDropEngine.OnPivotHeaderMove,m);var A=WGChartUIEngine.CreatePivotRefreshButton(r,y);f.appendChild(A);var j=WGChartUIEngine.CreatePivotDeleteButton(r,x);f.appendChild(j);var G=J.insertRow(-1);cellPivotPanel=G.insertCell(-1);cellPivotPanel.style.borderBottom="solid 1px black";cellPivotPanel.style.padding="2px 2px 2px 2px";cellPivotPanel.className="WG5CE-CPFIBRD";var n=document.createElement("div");n.style.width="100%";n.style.height="140px";n.style.overflow="auto";n.style.display="none";cellPivotPanel.appendChild(n);var C=J.insertRow(-1);cellLoaderContainer=C.insertCell(-1);cellLoaderContainer.style.borderBottom="solid 1px black";cellLoaderContainer.style.padding="2px 2px 2px 2px";cellLoaderContainer.className="WG5CE-CPFIBRD";var l=document.createElement("div");l.style.width="100%";l.style.height="140px";l.style.overflow="auto";cellLoaderContainer.appendChild(l);var I=document.createElement("table");I.style.width="100%";I.style.height="100%";I.className="WG5CE-CPFI";var B=I.insertRow(-1);var d=B.insertCell(-1);d.style.textAlign="center";var t=document.createElement("img");t.src=r.ResolveImagePathEx(s.InProgressImage);d.appendChild(t);d.innerHTML=d.innerHTML+"<br/>Loading ...";l.appendChild(I);var E=J.insertRow(-1);var e=E.insertCell(-1);e.style.borderBottom="solid 1px black";e.style.padding="5px 2px 5px 2px";e.className="WG5CE-CPFIBRD";var H=document.createElement("span");H.innerText="Filter Expression:";var a=document.createElement("br");var u=document.createElement("input");u.type="text";u.className="WG5CE-CPFI";u.style.width="100%";Listener.Add(u,"onkeyup",WGChartUIEngine.OnFilterExpressionKeyUp,y);e.appendChild(H);e.appendChild(a);e.appendChild(u);var D=J.insertRow(-1);cellPivotButton=D.insertCell(-1);cellPivotButton.style.textAlign="center";cellPivotButton.style.height="30px";var c=WGChartUIEngine.CreatePivotOKButton(r,y);cellPivotButton.appendChild(c);var b=WGChartUIEngine.CreatePivotCancelButton(r,y);b.style.marginLeft="4px";cellPivotButton.appendChild(b);var K=new WindowInfo();K.DisplayPosition="Bottom";K.DisplayType="Normal";var L=new WindowPopup(K);K.Popup=L;y.Popup=L;L.Init();L.PivotInfo=y;L.OnClosed=WGChartUIEngine.OnWindowPopUpClosed;L._e.style.filter="progid:DXImageTransform.Microsoft.Shadow(color='Gray', Direction=135, Strength=2)";L._e.appendChild(m);WG50Engine.ExecuteFlyPostback(r.Id,"RetrievePivotData",null)}}var z=y.Popup;if(z._e.moved){y.Popup.show(z._e.style.posLeft,z._e.style.posTop)}else{var i=WGChartUIEngine.GetElementPositionForPopup(k,y.Popup);y.Popup.show(i.X,i.Y)}var p=y.PivotInfoElement.childNodes[0].childNodes[0].childNodes[3].childNodes[0].childNodes[2];if(y.PivotObject!=null){y.OriginalFilterExpression=y.LastFilterExpression;p.value=y.LastFilterExpression}y.FilterExpressionElement=p;if(v){y.PivotInfoElement.TotalChecked=y.TotalChecked;var h=y.GetContentData();var w=WGChartUIEngine.GetChildren(h[0],[2,0]);WGChartUIEngine.StoreOriginalPivotState(y,w,w.checked)}return true},OnFilterExpressionKeyUp:function(){var b=this;var a=window.event.srcElement;if(!b.HasFilter()){b.OKButtonElement.disabled=true}else{b.OKButtonElement.disabled=false}},CreatePivotOKButton:function(b,c){var a=document.createElement("input");a.type="button";a.value="OK";a.className="WG5CE-CPFI WG5CE-CPFIB";a.style.width="45%";c.OKButtonElement=a;Listener.Add(a,"onclick",WGChartUIEngine.OnPivotOKButtonClick,c);return a},OnPivotOKButtonClick:function(){var h=this;var d=h.WebGrid;h.Popup.hide();var g=h.PivotStateCollection.length;switch(h.PivotObject.PivotType){case"Field":var c=h.GetFilterExpressionElement().value;if(c==""){if(g!=0){var j="";var f="";for(var e=0;e<g;e++){var b=h.PivotStateCollection[e];if(h.PivotObject.DataType=="System.String"){b="'"+b+"'"}j+=b;if(e!=h.PivotStateCollection.length-1){j+=","}if(b=="'(blank)'"){f=" or "+h.PivotObject.DataMember+" IS NULL"}}j="["+h.PivotObject.DataMember+"] "+h.PivotState+" ("+j+")"+f;h.PivotObject.FilterExpression=j}else{h.PivotObject.FilterExpression=""}}else{h.PivotObject.FilterExpression=c}h.LastFilterExpression=c;break;case"ByMonth":case"ByWeek":var c=h.GetFilterExpressionElement().value;if(c==""){var a="";for(var e=0;e<g;e++){var b=h.PivotStateCollection[e];if(e>0){a+="|"}a+=b}if(h.PivotState=="Not In"&&a.length>0){a="!"+a}h.PivotObject.FilterCriterias=a;h.PivotObject.FilterExpression=""}else{h.PivotObject.FilterCriterias="";h.PivotObject.FilterExpression=c}h.LastFilterExpression=c;break}h.PivotOriginalStateCollection.Clear();d.ChartInteractiveUI.PerformAutoRefresh();return true},CreatePivotCancelButton:function(b,c){var a=document.createElement("input");a.type="button";a.value="Cancel";a.className="WG5CE-CPFI WG5CE-CPFIB";a.style.width="45%";c.CancelButtonElement=a;Listener.Add(a,"onclick",WGChartUIEngine.OnPivotCancelButtonClick,c);return a},OnPivotCancelButtonClick:function(){var b=this;b.Popup.hide();for(var a=0;a<b.PivotOriginalStateCollection.length;a++){var c=b.PivotOriginalStateCollection[a];c.Element.checked=c.Checked}b.FilterExpressionElement.value=b.OriginalFilterExpression;b.TotalChecked=b.PivotInfoElement.TotalChecked;b.PivotOriginalStateCollection.Clear();return true},OnWindowPopUpClosed:function(c){var b=c.PivotInfo;c.hide();for(var a=0;a<b.PivotOriginalStateCollection.length;a++){var d=b.PivotOriginalStateCollection[a];d.Element.checked=d.Checked}b.FilterExpressionElement.value=b.OriginalFilterExpression;b.TotalChecked=b.PivotInfoElement.TotalChecked;b.PivotOriginalStateCollection.Clear();return true},CreatePivotDeleteButton:function(a,c){var b=document.createElement("img");b.src=a.ResolveImagePathEx("wg_Delete.gif");b.setAttribute("command","delete");b.style.cursor="pointer";b.alt="Delete";b.title="Delete";Listener.Add(b,"onclick",WGChartUIEngine.OnPivotDeleteButtonClick,c);return b},OnPivotDeleteButtonClick:function(){var g=this;var b=g.WebGrid;var a=g.DataMember;var f=g.Name;var e=b.ChartSeriesCollection.GetNamedItem(f);var c=b.ChartCategoryCollection.GetNamedItem(f);var d=b.ChartFilterCollection.GetNamedItem(f);if(e){WGChartUIEngine.RemoveDropSeriesField(this.WebGrid,g)}if(c){WGChartUIEngine.RemoveDropCategoryField(this.WebGrid,g)}if(d){WGChartUIEngine.RemoveDropFilterField(this.WebGrid,g)}g.PivotInfo.Popup.hide();g.PivotInfo.Popup._e.moved=false;g.WebGrid.ChartInteractiveUI.RefreshChart();return true},CreatePivotRefreshButton:function(a,c){var b=document.createElement("img");b.src=a.ResolveImagePathEx("wg5_refresh.gif");b.style.cursor="pointer";b.alt="Refresh Data";b.title="Refresh Data";b.setAttribute("command","refresh");Listener.Add(b,"onclick",WGChartUIEngine.OnPivotRefreshButtonClick,c);return b},OnPivotRefreshButtonClick:function(){var f=this;var c=f.WebGrid;var b=f.GetContentDataElement();var e=f.GetLoaderElement();b.style.display="none";e.style.display="";c.ChartInteractiveUI.LastPivotInfo=f;var a=f.GetContentData();var d=WGChartUIEngine.GetChildren(a[0],[2,0]);WGChartUIEngine.StoreOriginalPivotState(f,d,d.checked);WG50Engine.ExecuteFlyPostback(c.Id,"RetrievePivotData",null);return true},OnPivotDataClick:function(){var f=this;var a=window.event.srcElement;if(a.tagName=="IMG"){a=a.parentElement}var e=a.attributes.MenuId.value;var d=ISGetObject(e);d.LastPivotDataElement=a;d.PivotData=f;d.SetOffsetElement(a.parentElement);for(var b=0;b<d.Items.length;b++){var c=d.Items[b];if(c.Name==f.AutoCalc){c.SetChecked(true)}if(c.Name=="Separator"||c.Name=="Remove"){c.Enable();continue}if((f.DataType=="System.String"||f.DataType=="System.DateTime")&&c.Name!="Count"){c.Disable()}else{c.Enable()}}d.Show()},GetElementPositionForPopup:function(a,b){var c=ISPosLib.getLeft(a)+document.body.scrollLeft;var d=ISPosLib.getTop(a)+ISPosLib.getHeight(a)+document.body.scrollTop;return new WGUIEngine.ApplyIntelligentPosition(new OffsetLocation(c,d),b._e,a)},RemoveDropSeriesField:function(e,f){e.ChartSeriesCollection.Remove(f);var c=e.GetString("Charting/DropSeriesField");var a=e.ChartInteractiveUI;var d=a.GetDropSeriesFieldsElement();var b=WGChartUIEngine.GetChildren(d,[4,0]);if(b.contains(f.PivotElement)){b.removeChild(f.PivotElement)}if(b.children.length==0){b.style.padding="";b.innerText=c}},RemoveDropCategoryField:function(e,f){e.ChartCategoryCollection.Remove(f);var c=e.GetString("Charting/DropCategoryField");var a=e.ChartInteractiveUI;var d=a.GetDropCategoryFieldsElement();var b=WGChartUIEngine.GetChildren(d,[4,0]);if(b.contains(f.PivotElement)){b.removeChild(f.PivotElement)}if(b.children.length==0){b.style.padding="";b.innerText=c}var h=a.GetDropSecondaryCategoryFieldsElement();var g=WGChartUIEngine.GetChildren(h,[4,0]);if(f.PivotElement.pivotSecondary&&g.contains(f.PivotElement.pivotSecondary)){g.removeChild(f.PivotElement.pivotSecondary)}if(g.children.length==0){g.style.padding="";g.innerText=c}},RemoveDropFilterField:function(e,f){e.ChartFilterCollection.Remove(f);var c=e.GetString("Charting/DropFilterField");var a=e.ChartInteractiveUI;var d=a.GetDropFilterFieldsElement();var b=WGChartUIEngine.GetChildren(d,[4,0]);if(b.contains(f.PivotElement)){Listener.Unload(f.PivotElement);b.removeChild(f.PivotElement)}if(b.children.length==0){b.style.padding="";b.innerText=c}},RemoveDataField:function(d,e){var c=d.GetString("Charting/DropDataField");var a=d.ChartInteractiveUI;var b=e.PivotElement.parentElement;Listener.Unload(e.PivotElement);b.removeChild(e.PivotElement);d.ChartDataCollection.Remove(e);d.ChartInteractiveUI.MasterDataCollection.Remove(e);if(b.children.length==0){b.innerText=c;b.style.padding=""}},SetFieldList:function(d,c){var b=d.ChartInteractiveUI;var a=ISGetObject(b.Parent.Id+"_FieldList");a.SetPushed(c);b.ShowOrHideRibbon.ShowFieldList=c;if(c){b.GetTableListElement().style.display=""}else{b.GetTableListElement().style.display="none"}},SetDropZone:function(d,c){var b=d.ChartInteractiveUI;var a=ISGetObject(b.Parent.Id+"_DropZone");a.SetPushed(c);b.ShowOrHideRibbon.ShowDropZone=c;WGChartUIEngine.SynchronizeDropZone(d)},EnableAutoFilter:function(d,c){var b=d.ChartInteractiveUI;var a=ISGetObject(d.Id+"_Filter");a.SetPushed(c);b.FilterAndSortRibbon.ChartAutoFilter=c},SetLegend:function(d,c){var b=d.ChartInteractiveUI;var a=ISGetObject(d.Id+"_Legend");a.SetPushed(c);if(c){b.Parent.ChartSettings.LegendSettings.Mode="Automatic"}else{b.Parent.ChartSettings.LegendSettings.Mode="Disabled"}},SwitchRowAndColumn:function(m){var j=m.GetString("Charting/DropSeriesField");var h=m.GetString("Charting/DropCategoryField");var e=m.ChartInteractiveUI;if(e.ChartAutoRefresh){e.ShowLoaderImage()}else{e.ShowUpdateText()}for(var n=0;n<m.ChartCategoryCollection.length;n++){var o=m.ChartCategoryCollection[n];var k=e.GetDropSeriesFieldsElement();var f=WGChartUIEngine.GetDropPivotElement(k);f.appendChild(o.PivotElement);WGChartUIEngine.CssFloat(o.PivotElement,"");var p=o.PivotElement.pivotSecondary;if(p!=null){var l=e.GetDropSecondaryCategoryFieldsElement();var g=WGChartUIEngine.GetDropPivotElement(l);g.removeChild(p)}}for(var n=0;n<m.ChartSeriesCollection.length;n++){var o=m.ChartSeriesCollection[n];var k=e.GetDropCategoryFieldsElement();var f=WGChartUIEngine.GetDropPivotElement(k);f.appendChild(o.PivotElement);WGChartUIEngine.CssFloat(o.PivotElement,"left");var p=WGChartUIEngine.CreatePivotFilterElement(m,o,false);var l=e.GetDropSecondaryCategoryFieldsElement();var g=WGChartUIEngine.GetDropPivotElement(l);g.appendChild(p);WGChartUIEngine.CssFloat(p,"left");o.PivotElement.pivotSecondary=p}var s=new ISArray();s.CopyFrom(m.ChartCategoryCollection);m.ChartCategoryCollection.Clear();m.ChartCategoryCollection.CopyFrom(m.ChartSeriesCollection);m.ChartSeriesCollection.Clear();m.ChartSeriesCollection.CopyFrom(s);var q=e.GetDropSeriesFieldsElement();var r=WGChartUIEngine.GetChildren(q,[4,0]);if(m.ChartSeriesCollection.length==0){r.style.padding="";r.innerText=j}var a=e.GetDropCategoryFieldsElement();var b=WGChartUIEngine.GetChildren(a,[4,0]);var c=e.GetDropSecondaryCategoryFieldsElement();var d=WGChartUIEngine.GetChildren(c,[4,0]);if(m.ChartCategoryCollection.length==0){b.style.padding="";b.innerText=h;d.style.padding="";d.innerText=h}},AutoCalcMenuItemClick:function(b,g){var f=b.LastPivotDataElement;var d=f.parentElement;var i=d.children[0];var h=b.PivotData;var c=h.DataMember;var a=b.WebGrid.RootTable.Columns.GetNamedItem(c);if(g.Name=="Remove"){var e=d.parentElement;Listener.Unload(d.children[1]);e.removeChild(d);b.WebGrid.ChartDataCollection.Remove(h);b.WebGrid.ChartInteractiveUI.MasterDataCollection.Remove(h);if(e.children.length==0){e.innerText=b.WebGrid.GetString("Charting/DropDataField");e.style.padding=""}}else{h.AutoCalc=g.Name;h.DataMember=a.DataMember;h.DataType=a.DataType;i.innerText=h.GetText();d.setAttribute("DataMember",h.DataMember);d.setAttribute("DataType",h.DataType);d.setAttribute("AutoCalc",h.AutoCalc);d.setAttribute("Type",h.Type)}b.WebGrid.ChartInteractiveUI.RefreshChart()},StoreOriginalPivotState:function(d,b,a){var c=d.PivotOriginalStateCollection.GetNamedItem(b.value);if(c==null){var e=new ChartPivotStateInfo();e.Name=b.value;e.Element=b;e.Checked=a;d.PivotOriginalStateCollection.Add(e)}},ChartUI_UpdateChanges:function(a){IS.SetModifiedPropertiesToXml(a,a.XmlNode,true)},GetScreenPosition:function(b){var a=curtop=0;if(b.offsetParent){a=b.offsetLeft;curtop=b.offsetTop;while(b=b.offsetParent){a+=b.offsetLeft;curtop+=b.offsetTop}}return[a,curtop]},CssFloat:function(a,b){if(IS.moz){a.style.cssFloat="left"}else{if(IS.safari){a.style["float"]="left"}else{a.style.styleFloat="left"}}},GuidValue:function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)},GenerateGuid:function(){return WGChartUIEngine.GuidValue()+WGChartUIEngine.GuidValue()+"-"+WGChartUIEngine.GuidValue()+"-"+WGChartUIEngine.GuidValue()+"-"+WGChartUIEngine.GuidValue()+"-"+WGChartUIEngine.GuidValue()+WGChartUIEngine.GuidValue()+WGChartUIEngine.GuidValue()}};function ChartDragData(c,a,b){this.Type=c;this.Element=a;this.Object=b}var WGChartDragDropEngine={InitializeDropZones:function(d){var c=new Array();var a=d.ChartInteractiveUI;c.push(a.GetDropFilterFieldsElement());c.push(a.GetDropDataFieldsElement());c.push(a.GetDropSeriesFieldsElement());c.push(a.GetDropCategoryFieldsElement());c.push(a.GetDropSecondaryCategoryFieldsElement());c.push(a.GetChartContainer());for(var e=0;e<c.length;e++){var b=c[e];var f=new ISDropableObject(b,WGChartDragDropEngine.OnDragOver,WGChartDragDropEngine.OnDragDrop,WGChartDragDropEngine.OnDragEnter,WGChartDragDropEngine.OnDragLeave);f.Owner=d;f.EnableCaching=false;ISDragDrop.RegisterDropable(f)}},InitializeDragList:function(b){var a=b.ChartInteractiveUI.GetTableListElement();var c=a.children[0];var d=WGChartUIEngine.GetChildren(c,[1,0],[1,1],[3,0]);Listener.Add(d,"onmousedown",WGChartDragDropEngine.OnDragMouseDown,["FieldList",b])},OnDragMouseDown:function(){var e=this[0];var f=this[1];var a=f.ChartInteractiveUI;var c=event.srcElement;if(e=="FieldList"){if(c.tagName=="TD"&&c!=a.LastSelectedFieldElement){var g=a.LastSelectedFieldElement;if(g!=null){g.className="WG5CE-TFDS"}c.className="WG5CE-TFDSR";a.LastSelectedFieldElement=c}var b=ISDragDrop.DoDragDrop(c,new ChartDragData("FieldItem",a.LastSelectedFieldElement),ISDragDropEffects.Copy,true,null,WGChartDragDropEngine.OnDragStart);b.Owner=f;b.OnShadowCreate=WGChartDragDropEngine.OnShadowCreate}},OnPivotItemMouseDown:function(h){var f=window.event.srcElement;var i=f.parentElement.parentElement;var g=h.WebGrid;var b=h.WebGrid.ChartInteractiveUI;var a=b.GetChartContainer();var e=WGChartDragDropEngine.GetZoneType(i);if(e!="Container"){var c=ISDragDrop.DoDragDrop(i,new ChartDragData("PivotItem",i,h),ISDragDropEffects.Move,true,null,WGChartDragDropEngine.OnDragStart);c.Owner=g;c.OnShadowCreate=WGChartDragDropEngine.OnShadowCreate}},OnShadowCreate:function(d){var c=d.Owner;var a=c.ChartInteractiveUI;if(!a.DragShadow){var e=document.createElement("div");e.innerHTML='<div class="WG5CE-DD"></div>';e.IsCustomShadow=true;a.DragShadow=e}var e=a.DragShadow;var b=ISDragDrop.GetLastDragData();e.children[0].innerHTML=b.Data.Element.innerText;d.ShadowElement=a.DragShadow},OnDragStart:function(a){},OnDragOver:function(g,f){var i=WGChartDragDropEngine.GetZoneType(f.Element);var b=g.Data;var c=b.Type;var h=WGChartDragDropEngine.GetVerboseZoneType(i);if(c=="FieldItem"){if(i=="Container"){g.Effect=ISDragDropEffects.NotAllowed;g.EffectText=""}else{g.Effect=ISDragDropEffects.Copy;g.EffectText="Add <i>"+g.Data.Element.innerText+"</i> to "+h}}else{if(c=="PivotItem"){if(i=="Container"){g.Effect=ISDragDropEffects.Remove;g.EffectText=""}else{var a=WG50Engine.GetTable(g.Data.Element).parentElement;var d=WGChartDragDropEngine.GetZoneType(a);if(d==i){g.Effect=ISDragDropEffects.NotAllowed;g.EffectText="Cannot place to the same zone"}else{if(d=="DataZone"){g.Effect=ISDragDropEffects.NotAllowed;g.EffectText=""}else{g.Effect=ISDragDropEffects.Move;g.EffectText="Move <i>"+g.Data.Element.innerText+"</i> to "+h}}}}}},OnDragDrop:function(g,f){var h=f.Owner;var j=WGChartDragDropEngine.GetZoneType(f.Element);var d="";if(g.Data.Type=="FieldItem"){if(j!="Container"){WGChartUIEngine.AddDropPivot(h,WGChartDragDropEngine.GetShortZoneType(j))}}else{if(g.Data.Type=="PivotItem"){var a=false;if(g.Effect==ISDragDropEffects.Remove){var b=WG50Engine.GetTable(g.Data.Element).parentElement;d=WGChartDragDropEngine.GetShortZoneType(WGChartDragDropEngine.GetZoneType(b));if(d=="Series"){WGChartUIEngine.RemoveDropSeriesField(h,g.Data.Object)}else{if(d=="Category"){WGChartUIEngine.RemoveDropCategoryField(h,g.Data.Object)}else{if(d=="Filter"){WGChartUIEngine.RemoveDropFilterField(h,g.Data.Object)}else{if(d=="Data"){WGChartUIEngine.RemoveDataField(h,g.Data.Object)}}}}a=true}else{if(g.Effect==ISDragDropEffects.Move){var c=g.Data.Element;var i=WGChartUIEngine.GetListElement(h.ChartInteractiveUI,c.Name);WGChartUIEngine.AddDropPivot(h,WGChartDragDropEngine.GetShortZoneType(j),i);a=true}}if(a){h.ChartInteractiveUI.PerformAutoRefresh()}}}},OnDragEnter:function(b,a){},OnDragLeave:function(a){},GetZoneType:function(a){var b=a.id;var c="";if(b.indexOf("ChartDropDataFieldsArea")>-1){c="DataZone"}else{if(b.indexOf("ChartDropSeriesFieldsArea")>-1){c="SeriesZone"}else{if(b.indexOf("ChartDropCategoryFieldArea")>-1){c="BottomCategoryZone"}else{if(b.indexOf("ChartDropSecondaryCategoryFieldsArea")>-1){c="RightCategoryZone"}else{if(b.indexOf("ChartDropFilterFieldsArea")>-1){c="FilterZone"}else{if(b.indexOf("ChartContainer")>-1){c="Container"}}}}}}return c},GetVerboseZoneType:function(a){switch(a){case"DataZone":return"Data Zone";case"SeriesZone":return"Series Zone";case"BottomCategoryZone":case"RightCategoryZone":return"Category Zone";case"FilterZone":return"Filter Zone"}},GetShortZoneType:function(a){switch(a){case"DataZone":return"Data";case"SeriesZone":return"Series";case"BottomCategoryZone":case"RightCategoryZone":return"Category";case"FilterZone":return"Filter"}},OnPivotHeaderMove:function(){var a=this.parentElement;ISDragDrop.DoDragDrop(a,"",ISDragDropEffects.Move);a.moved=true;event.returnValue=false}};function wgChart_Refresh(a){var b=ISGetObject(a);b.ChartInteractiveUI.RefreshChart()}function wgChart_OnAutoCalcItemClick(b,c){var a=ISGetObject(b);WGChartUIEngine.AutoCalcMenuItemClick(a,c);return true}function wgChart_OnChartMenuItemClick(b,c){var a=ISGetObject(b);if(a.PreviousMenuItem!=null){a.PreviousMenuItem.SetChecked(false,true)}a.PreviousMenuItem=c;a.WebGrid.ChartInteractiveUI.SetChartType(c.ChartType,c.Name);return true};