var WGUI={CM:function(){WGUIEngine.OnColumnHeaderContextMenu()},MU:function(){WGUIEngine.OnColumnHeaderMouseUp()},MM:function(){WGUIEngine.OnColumnHeaderMouseMove()},DBLCL:function(){WGUIEngine.OnColumnHeaderDblClick()},CL:function(){WGUIEngine.OnColumnHeaderClick();event.cancelBubble=true},MD:function(){WGUIEngine.OnColumnHeaderMouseDown()},KD:function(){WGUIEngine.OnColumnHeaderKeyDown()},MOV:function(){},MOU:function(){WGUIEngine.OnColumnHeaderMouseOut()},GH:function(a){return WGUIEngine.GetGridHeight(a)},GW:function(a){return WGUIEngine.GetGridWidth(a)},GBBCL:function(a){WGUIEngine.OnColumnHeaderClick(a)},GBBMM:function(){WGUIEngine.OnColumnHeaderMouseMove()},GBBMD:function(){WGUIEngine.OnGBBMouseDown()},TBGH:function(a){return WGUIEngine.GetTableBodyHeight(a)},TBRS:function(a){return WG50Engine.ResizeTable(a)},TBKD:function(){if(IS.ie){return WGEventEngine.ProcessKeyboardEvents()}else{var a=new Object();var c=event.srcElement;var b=ISGetObject(c.getAttribute("gridId"));if(!b){b=WG50Engine.GetGridByElement(c)}a.srcElement=b.LastSelObj.element;a.keyCode=event.keyCode;a.ctrlKey=event.ctrlKey;a.shiftKey=event.shiftKey;a.altKey=event.altKey;return WGEventEngine.ProcessKeyboardEvents(a)}},TBKP:function(){return WGEventEngine.OnKeyPress()},TBDBLCL:function(a){return WGEventEngine.ProcessDoubleClick(a)},TBKDMZ:function(){return WGMozEngine.OnEditKeyDown()},TBKPMZ:function(){return WGMozEngine.OnEditKeyPress()},TBKU:function(){return WGEventEngine.OnKeyUp()},TGROW:function(a){return WGUIEngine.ToggleGroupRow(a)},WCIS:function(b,a){return WGEditEngine.WebComboItemSelected(b,a)},WCIC:function(b,a){return WGEditEngine.WebComboItemChecked(b,a)},TGCALDD:function(b,a){return WGEditEngine.ToggleCalendarDropDown(b,a)},TGCEDD:function(c,b,a){return WGEditEngine.ToggleCEDropDown(c,b,a)},TGPR:function(a){return WGUIEngine.TogglePreviewRow(a)},TGHIER:function(a){return WGHierEngine.ToggleRow(a)},TGSRR:function(a){return WGUIEngine.ToggleSelfRefRow(a)},LMGR:function(a,b){return WGGroupingEngine.LoadMoreGroupRows(a,b)}};var WGUIEngine={AutoFitColumns:function(b,c){var a=ISGetObject(b);if(!a.Get("Visible")&&!a.NeedAutoFitOnLoad){return}if(a.LastAutoFitWidth!=-1&&a.LastAutoFitWidth==a.FrameObj.offsetWidth){return}if(c){a.NeedAutoFitOnLoad=true}for(tableName in a.Tables){var d=a.Tables[tableName];if(d.IsRootTable){if(a.NeedAutoFitOnLoad){a.FrameObj.style.display="none"}WGUIEngine.FitColumns(d)}else{if(d.SubTableIds.length==0){WGUIEngine.FitColumns(d)}else{for(tableId in d.SubTableIds){WGUIEngine.FitColumns(d,"SubTable",null,null,null,d.SubTableIds[tableId])}}}}a.LastAutoFitWidth=a.FrameObj.offsetWidth;a.TempResizeID=0},SetHeight:function(b,c){var a=b.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);b.NeedHeightResize=true;b.FrameObj.style.height=c;if(IS.ie){b.FrameObj.parentElement.style.height=c}var d=WGUIEngine.GetTableBodyHeight(a);if(!isNaN(d)){a.style.height=d+"px"}if(IS.moz){WGMozEngine.OnResize(b);WGMozEngine.OnTableResize(b)}},OnGridResize:function(c){if(!c){c=this}if(c.NeedHeightResize||c.NeedWidthResize){var b=c.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);c.CacheTBodyHeight=null;var a=WGUIEngine.GetTableBodyHeight(b);if(!isNaN(a)&&a>0){b.style.height=a+"px"}}},AssignInitialHeight:function(c){var a=c.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);if(IS.ie){if(IS.GetIEVersion()<8||!IS.IsXHTMLDocType()){try{if(c.FrameObj.parentElement.style.height!=""){a.style.setExpression("height","WGUI.TBGH(this)")}}catch(b){c.NeedHeightResize=true;WGUIEngine.OnGridResize(c)}}else{if(c.LayoutSettings.AutoHeight){c.FrameObj.parentElement.style.height="100%"}c.NeedHeightResize=true;WGUIEngine.OnGridResize(c)}}},GetTableBodyHeight:function(b,d){var f;var g=false;var a=false;var c=false;if(b.childNodes.length==0){return}var e=ISGetObject(b.childNodes[0].gridId);if(!e){return}if(d){e.CacheTBodyHeight=null;g=true}if(e.CacheTBodyHeight!=null){if(e.NeedHeightResize){e.CacheTBodyHeight=null;return}f=e.CacheTBodyHeight}else{var i=e.FrameObj.parentElement;if(!IS.ie){i=e.FrameObj}if(b.style.display=="none"&&e.CurrentViewMode=="GridView"){b.style.display="block"}f=parseFloat(i.style.height);if(i.gridHeight){f=i.gridHeight}if(i.style.height!=""){if(i.style.height.indexOf("%")>0){if(!e.IsLoaded){return}b.style.height="10px";f=parseFloat(i.offsetHeight);if(IS.moz&&f==0){return 0}g=true}}else{if(isNaN(f)){a=true;f=b.offsetHeight;if(!IS.ie){var j=b.children[0];if(j.offsetHeight>f){f=j.offsetHeight;a=false;c=true}}}}if(ISPosLib.getTop(b)<0||isNaN(f)||g){if(e.CurrentViewMode=="PivotChartView"){e.NeedHeightResize=false;e.CacheTBodyHeight=f;WGChartEngine.AutoResize(e,f);return}if(isNaN(f)){return}}if(!c){f-=ISPosLib.getTop(b)-ISPosLib.getTop(e.FrameObj)+(!e.UseCssFramework?2:1);if(e.LayoutSettings.StatusBarVisible){f-=document.getElementById("dvStatus_"+e.Name).offsetHeight}if(e.GetRootTable().Get("ColumnFooters")=="Yes"){f-=e.GetRootTable().GetElement(WG40.COLFOOTER,WG40.HTMLDIV).offsetHeight}if(e.LayoutSettings.AllowColumnFreezing=="Yes"){f-=19}}if(a){if(f<1){if(e.MinHeight>0){f=e.MinHeight}else{return}}else{return}}e.CacheTBodyHeight=f;e.NeedHeightResize=false}if(isNaN(f)||f<=0){e.NeedHeightResize=true}if(g&&f>0){b.style.height=parseFloat(f)+"px"}return f},GetGridHeight:function(b){if(IS.ie){b=b.children[0]}if(!b||typeof(b)=="undefined"){return}var d;var c=ISGetObject(b.id.substring(0,b.id.length-2));if(!c){return}if(c.CacheFrameHeight!=null){if(c.NeedHeightResize){c.CacheFrameHeight=null;return}d=c.CacheFrameHeight}else{var a=Number(parseFloat(b.currentStyle.borderTopWidth));if(isNaN(a)){a=0}d=document.body.clientHeight-ISPosLib.getTop(b)+c.LayoutSettings.SizeHeightBy-(a*2);c.CacheFrameHeight=d}if(d<=0){c.NeedHeightResize=true}return d},GetGridWidth:function(a){if(IS.ie){a=a.children[0]}if(!a||typeof(a)=="undefined"){return}var c;var b=ISGetObject(a.id.substring(0,a.id.length-2));if(!b){return}if(b.CacheFrameWidth!=null){if(b.NeedWidthResize){b.CacheFrameWidth=null;return}c=b.CacheFrameWidth}else{c=document.body.clientWidth-ISPosLib.getLeft(a)+b.LayoutSettings.SizeWidthBy-WGUIEngine.GetHzScrollBarWidth();b.CacheFrameWidth=c;b.NeedWidthResize=false}return c},GetPaddingWidth:function(a){var b=parseFloat(a.currentStyle.paddingLeft);var c=parseFloat(a.currentStyle.paddingRight);var d=b+c;if(isNaN(d)){d=0}return d},GetHzScrollBarWidth:function(){if(document.body.style.overflow=="hidden"||document.body.scroll=="no"||IS.moz){return 0}else{return 0}},ShowToolTip:function(a){if(a&&(a.tagName=="TD"||a.tagName=="SPAN"||a.tagName=="NOBR")&&a.getAttribute("hasTooltip")!="true"){if(a.tagName=="NOBR"){a=WG50Engine.GetTDorTH(a);if(!a){wg_Global.TTId=0;return}}if(a.hasTooltip||((IS.moz||IS.ie9||IS.chrome||IS.safari)&&a.attributes.hasTooltip!=null)){return}var b=false;if(a.innerText!=""&&a.innerText!=" "&&a.scrollWidth>a.offsetWidth&&a.childNodes.length<3){b=true}else{if(a.tagName=="SPAN"&&typeof(a.content)!="undefined"){if(a.scrollHeight>a.offsetHeight){b=true}else{var c=WG50Engine.GetTD(a);if(!c){return}if(c.innerText!=""&&c.scrollWidth>c.offsetWidth){b=true}}}}if(b){a.title=a.innerText}else{a.title=""}}wg_Global.TTId=0},ShowNoDataBox:function(c){var a=c.GetRootTable().GetElement(WG40.BODY,WG40.HTMLDIV);var d=document.getElementById(c.Name+"_ND");if(!d){d=document.createElement("DIV");d.id=c.Name+"_ND";d.className=c.RowClass;d.style.cssText="position:relative; width:100%; text-align: center; background: transparent";a.insertAdjacentElement("beforeEnd",d)}var h=a.offsetHeight;if(h==0){h=c.FrameObj.offsetHeight}if(h==0){if(c.FrameObj.offsetWidth==0&&c.ShowNoDataBoxTryCount==5){return}if(typeof(c.ShowNoDataBoxTryCount)=="undefined"){c.ShowNoDataBoxTryCount=0}else{c.ShowNoDataBoxTryCount++}setTimeout(function(){WGUIEngine.ShowNoDataBox(c)},100);return}var f="";try{f=c.GetString("CommonText/NoData")}catch(b){setTimeout(function(){WGUIEngine.ShowNoDataBox(c)},100);return}d.innerText=f;d.style.top="40%";d.style.display=""},HideNoDataBox:function(a){var b=document.getElementById(a.Name+"_ND");if(b){b.style.display="none"}},RemoveSortIcon:function(a){var b=a.childNodes[1];b.innerHTML="";WGUIEngine.SetColumnLabelWidth(a)},ClearGroupByBoxRow:function(a){return a.parentElement.parentElement.parentElement.parentElement.removeNode(true)},ClearGroupByBoxRowSeparator:function(a){return a.parentElement.parentElement.parentElement.parentElement.previousSibling.removeNode(true)},CreateGroupByBoxRowSeparator:function(f,e){var c=f.Grid;var g=c.GetElement(WG40.GROUPBYBOX,WG40.HTMLTABLE);if(!f.IsRootTable){if(e){tr=g.insertRow(e)}else{tr=g.insertRow()}tr.id="trGBBRowSep_"+c.Id+"_"+f.Name;var b=tr.insertCell(-1);b.innerHTML="<table tblName='"+f.Name+"' gridId='"+c.Id+"' cellSpacing=0 cellPadding=1 border=0 style='cursor: default'"+(IS.moz?";table-layout:fixed":"")+"><tbody><tr></tr></tbody></table>";var h=b.childNodes[0].childNodes[0].childNodes[0];var j=f.GetParentTreeStructure();for(var d=1;d<=parseFloat(f.TableLevel);d++){var a=h.insertCell(-1);a.style.cssText="width:25px; height: 3px; margin: 0; padding:0";if(d==parseFloat(f.TableLevel)||j[d]=="Continuos"){a.innerHTML=WGHierEngine.RenderTreeStructure(c,"I")}}}},CreateGroupByBoxRow:function(j,h){var e=j.Grid;var k=e.GetElement(WG40.GROUPBYBOX,WG40.HTMLTABLE);if(h){tr=k.insertRow(h)}else{tr=k.insertRow()}tr.id="trGBB_"+e.Id+"_"+j.Name;var b=tr.insertCell(-1);b.innerHTML="<table tblName='"+j.Name+"' gridId='"+e.Id+"' cellSpacing=0 cellPadding=1 border=0 style='cursor: default"+(IS.moz?";table-layout:fixed":"")+"'><tbody><tr></tr></tbody></table>";var m=b.childNodes[0].childNodes[0].childNodes[0];if(!j.IsRootTable){var n=j.GetParentTreeStructure();for(var f=1;f<parseFloat(j.TableLevel);f++){var a=m.insertCell(-1);a.style.cssText="width:25px; height: 15px; margin: 0; padding:0";if(f==parseFloat(j.TableLevel)||n[f]=="Continuos"){a.innerHTML=WGHierEngine.RenderTreeStructure(e,"I")}}var l=j.GetParentTables().length;var a=m.insertCell(-1);a.style.cssText="width:25px; height: 100%; margin: 0; padding:0";a.align="right";a.vAlign="top";if(l==1||l>1&&!j.HasNextSiblingGroupedColumns()){a.innerHTML=WGHierEngine.RenderTreeStructure(e,"Last")}else{a.innerHTML=WGHierEngine.RenderTreeStructure(e,"Continous")}}var c=m.insertCell(-1);var d=j.CaptionImage;c.className=e.GBBLabelClass;if(d!=""){var g="";if(d.substring(0,1)=="/"||d.substring(0,1)=="."){g=d}else{g=e.ResolveImagePathEx(d)}c.innerHTML="<img align='absmiddle' src='"+g+"'>&nbsp;"}c.innerHTML+=j.Caption;return tr},RenderGroupRowHeader:function(c){var a="";for(var b=0;b<c.GroupedColumns.length;b++){a+="<td style='width:16px' ";if(c.IsUseColumnSet||c.PreviewRowVisible){a+="rowspan="+WGUIEngine.GetRowSpan(c)}a+=">&nbsp;</td>"}return a},GetRowSpan:function(b){var a=1;if(b.IsUseColumnSet&&b.Get("ColumnSetHeaders")=="Yes"){a++}if(b.IsUseColumnSet){a+=b.ColumnSetSettings.Count;a--}if(b.PreviewRowVisible){a++}return a},SetColumnSortOrder:function(h,d){var g=d.currentStyle.fontSize;if(g==""){g="8pt"}var i=d.childNodes[1];var c="5";var f="6";WGUIEngine.SetColumnLabelWidth(d);if(IS.moz){c="<font face='Webdings'>5</font>";f="<font face='Webdings'>6</font>"}if(!d.sortOrder){d.sortOrder=d.getAttribute("sortOrder")}d.setAttribute("sortOrder",d.sortOrder);if(d.sortOrder=="Ascending"){var b=h.LayoutSettings.ImageSettings.SortAscImage;var a="";if(h.EnableSection508Standards){a=" alt='Sorted in ascending order' "}if(b==""&&!h.UseCssFramework){i.innerHTML="<span class='DefSIcon"+(IS.IsHTML5DocType()?"5":"")+"' style='font-size:"+g+"; color: black'"+a+">"+c+"</span>"}else{i.innerHTML="<img src='"+h.ResolveImagePathEx(b)+"'"+a+">"}}else{if(d.sortOrder=="Descending"){var e=h.LayoutSettings.ImageSettings.SortDescImage;var a="";if(h.EnableSection508Standards){a=" alt='Sorted in descending order' "}if(e==""&&!h.UseCssFramework){i.innerHTML="<span class='DefSIcon"+(IS.IsHTML5DocType()?"5":"")+"' style='font-size:"+g+"; color: black'"+a+">"+f+"</span>"}else{i.innerHTML="<img src='"+h.ResolveImagePathEx(e)+"'"+a+">"}}else{WGUIEngine.RemoveSortIcon(d)}}},CreateDragger:function(b){var c;var a=ISGetObject(b.gridId);c=document.createElement("DIV");c.onselectstart=function(){return false};c.style.cssText=a.DraggerStyle+"; width:"+b.offsetWidth+"px; height:"+b.offsetHeight+"px;";c.className=b.className+" grid-header-dragged";c.innerHTML=b.innerHTML;if(a){a.FrameObj.appendChild(c)}else{document.body.appendChild(c)}return c},CreatePointer:function(a){var b;b=document.createElement("IMG");b.src=a.ResolveImagePathEx(a.LayoutSettings.ImageSettings.ColumnPointerImage);b.style.cssText="position: absolute; display: none;";b.className="grid-drag-pointer";if(a){a.FrameObj.appendChild(b)}else{document.body.appendChild(b)}return b},CreateResizer:function(a){var b;b=document.createElement("DIV");b.onselectstart=function(){return false};b.onmouseup=WGUIEngine.OnColumnHeaderMouseUp;b.className="grid-column-resizer";b.style.cssText=a.ResizerStyle;b.style.display="block";if(a){a.FrameObj.appendChild(b)}else{document.body.appendChild(b)}return b},CreateGroupHeaderInfo:function(f,a){var e=new wgHeaderInfo();var d=ISGetObject(a.gridId);var b=posLib2.getLeftAbs(d.FrameObj,d);var c=posLib2.getTopAbs(d.FrameObj,d);e.AllowRightInsert=true;e.PosLeft=ISPosLib.getLeft(f)-5-b;e.PosRight=e.PosLeft+f.offsetWidth;e.PosTop=ISPosLib.getTop(f)-11-c;e.Type="GroupInfo";e.Element=f;e.ProperPosition=e.PosRight;return e},GetLatestGroupColumn:function(b){var a=b.childNodes[0].childNodes[0].childNodes[0].childNodes[0];return a.cells[a.cells.length-1]},GetFirstGroupColumn:function(c){var a=c.childNodes[0].childNodes[0].childNodes[0].childNodes[0];for(var b=0;b<a.cells.length;b++){if(a.cells[b].type=="GroupColumn"){return a.cells[b]}}return null},GetGroupByBoxRow:function(a,b){var c=document.getElementById("trGBB_"+a+"_"+b);return(c)},IsGroupColumnUIExist:function(c,e,b){var f=WGUIEngine.GetGroupByBoxRow(c,e);if(f){var a=f.childNodes[0].childNodes[0].childNodes[0].childNodes[0].cells;for(var d=0;d<a.length;d++){if(a[d].type=="GroupColumn"){if(a[d].colName==b){return true}}}}return false},CreateCommonHeaderInfo:function(h,a,b){var f=new wgHeaderInfo();var e=ISGetObject(b.gridId);var c=posLib2.getLeftAbs(e.FrameObj,e);var d=posLib2.getTopAbs(e.FrameObj,e);f.AllowRightInsert=true;f.PosLeft=ISPosLib.getLeft(h)-c;f.PosRight=f.PosLeft+h.offsetWidth;f.PosTop=ISPosLib.getTop(h)-d;f.Type="Unknown";f.Element=h;if(h.type=="Column"||h.type=="GroupColumn"){f.Type=h.type;if(h.type=="GroupColumn"){f.PosLeft-=5;f.PosRight-=5;f.PosTop-=10}var g=(f.PosRight-f.PosLeft)/2;if(a>=f.PosLeft+c&&a<=g+f.PosLeft+c){f.ProperPosition=f.PosLeft}else{f.ProperPosition=f.PosRight}}return f},GetHeaderInfo:function(f,g,a){var h=g.getAttribute("elLeft");var i=g.getAttribute("elTop");var b=event.clientX;var c=event.clientY;var s=null;if(IS.ie){s=document.elementFromPoint(b,c)}else{s=event.srcElement}if(s){WG50Engine.EmulateAttributes(s);if(s.id.indexOf("GBB")>=0||s.id.indexOf("GBB")>=0||(s.tagName=="TD"&&s.className.indexOf("Header")&&s.type=="GroupColumn")||((s.tagName=="SPAN"||s.tagName=="IMG")&&s.parentElement.type=="GroupColumn")){var j=ISGetObject(g.gridId);var p=j.Tables[g.tblName];var q=g.parentElement;var e=j.GetElement(WG40.GROUPBYBOX,WG40.HTMLTABLE);var o,m;var l=j.HasGroup();g.groupExist=false;if(!l){if(e.style.display==""){o=e.rows[0].cells[0]}m=WGUIEngine.CreateGroupHeaderInfo(o,g)}else{if(s.tagName=="SPAN"){s=s.parentElement}if(s.tagName=="DIV"){var k=WGUIEngine.GetGroupByBoxRow(j.Name,p.Id);g.groupExist=(k!=null);if(k){var n=WGUIEngine.GetLatestGroupColumn(k);o=n;m=WGUIEngine.CreateGroupHeaderInfo(o,g)}else{k=WGUIEngine.GetGroupByBoxRow(j.Name,j.RootTable.Name);var n=WGUIEngine.GetLatestGroupColumn(k);o=n;m=WGUIEngine.CreateGroupHeaderInfo(o,g)}}else{if(s.tagName=="TD"&&s.type=="GroupColumn"){if(s.type=="GroupColumn"&&g.type=="GroupColumn"){if(s.tblName!=g.tblName){var r=new wgHeaderInfo();r.Type="Unknown";return r}}o=s;m=WGUIEngine.CreateCommonHeaderInfo(o,b,g)}}}return m}else{var m=new wgHeaderInfo();m.Type="Unknown";if((s.tagName=="SPAN")||s.tagName=="NOBR"){s=WG50Engine.GetTDorTH(s)}if(s&&(s.tagName=="TD"||s.tagName=="TH")){var j=ISGetObject(g.gridId);var p=j.Tables[g.tblName];var q=g.parentElement;if(p.Id!=WG50Engine.GetTableNameByRow(s.parentElement)){return m}else{if(q!=s.parentElement&&g.type!="GroupColumn"){return m}}return WGUIEngine.CreateCommonHeaderInfo(s,b,g)}else{if(!a){return m}else{return m}}}}return false},MoveObject:function(a,c,b){var d=(b)?"afterEnd":"beforeBegin";a.removeNode(true);c.insertAdjacentElement(d,a)},MoveColumn:function(t){var u=wg_Global.MoveColEventArgs;var B=u.table;var m=ISGetObject(B.GridId);var E=u.tr;var C=B.GetElement(WG40.BODY,WG40.HTMLTABLE,E);var c=u.cdt;var D=u.th;var a=u.c1;var b=u.c2;var k=B.GetElement(WG40.COLGROUP,null,E);var e=k.childNodes[a];var f=k.childNodes[b];var q=0;var v=0;WGUIEngine.MoveObject(c,D.Element,a>b);if(m.FreezePaneActive&&m.FreezeConfig!=null){if(IS.ie){q=m.FreezeConfig[0].length;a+=q;b+=q;e=k.children[a];f=k.children[b]}else{v=m.FreezeConfig[0].length;e=k.children[a-v];f=k.children[b-v]}}if(B.IsRootTable&&B.Get("AllowFilter")=="Yes"){var l=B.GetFilterRow(E);WGUIEngine.MoveObject(l.cells[b],l.cells[a],a>b)}if(B.Get("AllowAddNew")=="Yes"){var w=B.GetNewRow(E);var n=false;var d=w.cells;for(var s=0;s<d.length;s++){if(d[s].type=="NewRowInfoCell"){n=true;break}}if(!n){WGUIEngine.MoveObject(w.cells[b],w.cells[a],a>b)}}WGUIEngine.MoveObject(f,e,a>b);WGUIEngine.SynchronizeClientTemplate(B,"Move",[a,b]);if(WGUIEngine.HasColGroup(B,E)){var j=WGUIEngine.GetHeaderColGroup(B,E);var o=j.children[a];var p=j.children[b];WGUIEngine.MoveObject(p,o,a>b)}var A=B.GetElement(WG40.BODY,WG40.HTMLTABLE,E).rows;for(var s=0;s<A.length;s++){var y=A[s];WG50Engine.EmulateAttributes(y);if(y.type=="Record"||y.type=="GroupTotalRow"){WGUIEngine.MoveObject(y.cells[b],y.cells[a],a>b)}}if(B.Get("ColumnFooters")=="Yes"){var g=B.GetElement(WG40.COLFOOTERGROUP,null,E).childNodes[a-v];var h=B.GetElement(WG40.COLFOOTERGROUP,null,E).childNodes[b-v];var z=B.GetElement(WG40.COLFOOTER,WG40.HTMLTABLE,E).rows[1];WGUIEngine.MoveObject(h,g,a>b);WGUIEngine.MoveObject(z.cells[b-v],z.cells[a-v],a>b)}if(!t){if(!B.IsRootTable){WGHierEngine.MoveSubTableColumn()}WGUIEngine.ReorderColumn(B,E);if(m.LastSelObj){var x=m.LastSelObj.element;if(x){if(x.tagName=="TR"){WGEventEngine.RedrawSelectedRowBorder(x,"Redraw")}else{WGEventEngine.ProcessMouseEvents(x)}}}wg_Global.MoveColEventArgs=null;m.SetStatus1("","ready","CommonText/Ready")}},ResizeColumn:function(s,k,h,n,o){var t=k.parentElement;if(s.IsUseColumnSet){if(k.type=="Column"){var c=s.GetElement(WG40.COLHEADERGROUP,null,t);var q=s.GetColHeaderSpanCount()+s.GetCSCellPosByIndex(k.cs,k.r,k.c);var r=s.GetColHeaderSpanCount()+s.GetCSCellPosByIndex(k.cs,k.r,k.c,true);var j=h;if(q!=r){var a=0;for(var m=q;m<r;m++){a+=parseFloat(c.childNodes[m].width)}j-=a}if(j<20){j=20}WGUIEngine.ResizeColumnGroup(s,t,c,r,j);if(!n){s.UpdateRowLayoutWidth(k.cs,parseFloat(k.c)+(r-q),j)}k.estWidth=h}else{if(k.type=="CSHeader"){var c;if(t){c=s.GetElement(WG40.COLHEADERGROUP,null,t)}var f=s.GetColumnSetByPos(k.pos);var q=s.GetColHeaderSpanCount()+s.GetCSHeaderCellPosByIndex(k);var r=q+parseInt(f.ColumnCount);var g=0;if(t){g=wgGetCSHeaderWidth(s,k)}else{g=s.GetCSHeaderWidth(k.pos)}var p=0;for(var m=q;m<r;m++){var u=0;if(c){u=parseInt(c.childNodes[m].width)}else{u=parseInt(s.GetRowLayoutByIndex(k.pos,0,p).Width)}var y=(u/g)*100;var v=parseInt((y/100)*h);if(!isNaN(v)){if(c){WGUIEngine.ResizeColumnGroup(s,t,c,m,v)}if(!n){s.UpdateRowLayoutWidth(k.pos,p,v)}}p++}k.estWidth=h}}}else{var b=WG50Engine.GetColGroupIndex(s,k);var l=s.Grid;var x=0;var c=s.GetElement(WG40.COLHEADERGROUP,null,t);if((IsGecko30()||IS.chrome)&&l.FreezePaneActive){var e=WG50Engine.GetColumnByElement(k);if(e!=null&&e.Position<l.LayoutSettings.FreezePaneSettings.ActiveFrozenColumns){b=WG50Engine.GetRealCellIndex(k)}}k.oldWidth=k.offsetWidth;if(IS.chrome&&l.LayoutSettings.AutoFitColumns){for(var m=0;m<k.children.length;m++){k.children[m].style.display="table-cell"}}IS.SetWidth(k,h);WGUIEngine.SetColumnLabelWidth(k,h);WGUIEngine.SynchronizeClientTemplate(s,"Resize",[b,h]);if(WGUIEngine.HasColGroup(s,t)){WGUIEngine.ResizeColumnGroup(s,t,c,b,h)}if((IS.GetIEVersion()<8&&IS.ie)&&IS.IsXHTMLDocType()&&s.GroupedColumns.length>0){x=2}if(IS.ie9&&IS.IsHTML5DocType()){b=WG50Engine.GetRealCellIndexToSetColumnWidth(k);s.GetElement(WG40.COLGROUP,null,t).childNodes[b].width=h+x;b=WG50Engine.GetRealCellIndex(k)}else{s.GetElement(WG40.COLGROUP,null,t).childNodes[b].width=h+x}if(!IS.ie){WGMozEngine.FixColumnWidth(s,k,WG40.BODY);if(s.IsRootTable){WG50Engine.ResizeTable(s.GetElement(WG40.BODY,WG40.HTMLTABLE))}}if(s.Get("ColumnFooters")=="Yes"){var d=s.GetElement(WG40.COLFOOTERGROUP,null,t);d.childNodes[b].width=h;if(!IS.ie){WGMozEngine.FixColumnWidth(s,k,WG40.COLFOOTER,(IS.safari?h:null))}}WGUIEngine.ResizeFilterColumn(s,t,k,h)}wg_Global.ColSizeTarget=k;if(!n){if(!s.IsRootTable){if(!s.IsUseColumnSet){WGHierEngine.AdjustParentTableWidth(k)}WGHierEngine.ResizeSubTableColumn()}if(!s.IsUseColumnSet&&!o){WGUIEngine.ReorderColumn(s,t)}if(!o){WGUIEngine.FitColumns(s,"Resize",k,h)}if(k.type=="CSHeader"){wgFlushUpdates()}}if(s.Grid.LayoutSettings.AllowColumnFreezing=="Yes"){WGUIEngine.InvalidateFreezeContainer(s.Grid)}},SynchronizeClientTemplate:function(d,a,b){var c=d.Grid;if(c.BindingOperationMode=="ClientBinding"&&d.HtmlTemplate!=null){WGBindingEngine.SynchronizeTemplate(d.HtmlTemplate,a,b)}else{if(c.LayoutSettings.AllowBatchUpdate){WGBatchEngine.SynchronizeNewRowTemplate(d,a,b)}}},ResizeColumnGroup:function(d,e,a,c,b){a.childNodes[c].oldWidth=a.childNodes[c].width;a.childNodes[c].width=b;d.GetElement(WG40.COLGROUP,null,e).childNodes[c].width=b;if(d.Get("ColumnFooters")=="Yes"){d.GetElement(WG40.COLFOOTERGROUP,null,e).childNodes[c].width=b}},ResizeFilterColumn:function(i,k,d,b){if(i.Grid.UseCssFramework){return}if(i.IsUseColumnSet){if(i.Get("AllowFilter")=="Yes"){var h=i.GetFilterRow(k);if(h){try{var f=wgGetCSCellByPosition(h,d.r,d.c,d.cs);var j=f.childNodes[0];if(b-18>0){j.style.width=(b-18)+"px"}else{j.style.width="18px"}if(!IS.ie){WGMozEngine.ResizeFilterColumn(f,b)}}catch(c){}}}}else{if(i.Get("AllowFilter")=="Yes"){var h=i.GetFilterRow(k);if(h){try{var a=(IS.ie?WG50Engine.GetColGroupIndex(i,d):d.cellIndex);var f=h.cells[a];var j=f.childNodes[0];var g=parseFloat(f.currentStyle.paddingLeft)+parseFloat(f.currentStyle.paddingRight);if(!g){g=0}if(b-18-g>0){j.style.width=(b-18-g)+"px"}else{j.style.width="18px"}if(!IS.ie){WGMozEngine.ResizeFilterColumn(f,b)}}catch(c){}}}}},ResizeBestFit:function(e){var b=e;var o=b.parentElement;var h=WG50Engine.GetTable(o);var f=ISGetObject(h.gridId);var m=f.Tables[h.tblName];var n=m.GetElement(WG40.BODY,WG40.HTMLTABLE,o);var g=b.scrollWidth;var k=g;if(m.IsUseColumnSet){for(var j=0;j<n.rows.length;j++){var l=n.rows[j];WG50Engine.EmulateAttributes(l);if(wgIsRecordRow(l)){var a=wgGetCellByName(l,e.colName);var d=a.scrollWidth;if(IS.moz){d=a.childNodes[0].offsetWidth}if(a&&l.csRowPos==o.csRowPos&&d>k){k=d}}}}else{for(var j=0;j<n.rows.length;j++){WG50Engine.EmulateAttributes(n.rows[j]);if(n.rows[j].type=="Record"){var d=n.rows[j].cells[b.cellIndex].scrollWidth;if(IS.moz){d=n.rows[j].cells[b.cellIndex].childNodes[0].offsetWidth}if(d>k){k=d}}}}if(IS.moz&&k!=g){k+=4}if(IS.IsXHTMLDocType()&&k!=g){k+=8}if(k-b.offsetWidth==4){return}var c=WG50Engine.GetColumnByElement(b);if(!ISEvent.Raise(f.LayoutSettings.ClientSideEvents.OnColumnResize,f.Name,m.Id,c,k)){return}WGUIEngine.ResizeColumn(m,b,k);if(m.IsUseColumnSet){if(!m.IsRootTable){WGHierEngine.ResizeSubTableColumnBestFit(b,k)}}else{if(!m.IsRootTable){WGHierEngine.AdjustParentTableWidth(b);WGHierEngine.ResizeSubTableColumnBestFit(b)}WGUIEngine.ReorderColumn(m,o);WGUIEngine.FitColumns(m,"Resize",b,k)}},SetColumnLabelWidth:function(a,b){a.setAttribute("issorted",a.sortOrder=="None"?"False":"True");if(a.sortOrder=="None"){a.childNodes[0].style.width="auto";a.children[0].style.display=""}else{var d;if(a.style.width==""){a.style.width=a.offsetWidth+"px"}if(b){d=b}else{d=a.clientWidth+"px"}if(a.parentElement==null){return}var f=parseFloat(d);var g=a.children[0].scrollWidth;var e=a.children[1].offsetWidth;if(e==0){e=17}if(f==0||isNaN(f)){setTimeout(function(){WGUIEngine.SetColumnLabelWidth(a,b)},10);return}if(a.currentStyle.paddingLeft!=""){f-=parseInt(a.currentStyle.paddingLeft)}if(a.currentStyle.paddingRight!=""){f-=parseInt(a.currentStyle.paddingRight)}if(g>f-e){f-=20}else{f="auto"}if(typeof(f)=="number"&&f<1){f=1}if(f=="auto"){a.children[0].style.width="auto"}else{a.children[0].style.width=f+"px";a.children[0].style.display="inline-block"}}},RealignSortIndicators:function(h){var g=null;if(h._Type=="WebGridSubTables"){g=h;h=g.GetTable()}var b=h.SortedColumns.concat(h.GroupedColumns);for(var d=0;d<b.length;d++){var f=b[d];var a=h.Columns.GetNamedItem(f.ColumnMember);if(!a.Visible){continue}if(h.IsRootTable){var c=a.GetElement();if(c!=null){WGUIEngine.SetColumnLabelWidth(c)}}else{if(g!=null){var c=a.GetElement(g.GetElement(WG40.COLHEADER,WG40.HTMLTABLE));if(c!=null){WGUIEngine.SetColumnLabelWidth(c)}}else{for(var e=0;e<h.SubTableIds.length;e++){var c=a.GetElement(h.SubTableIds[e].GetElement(WG40.COLHEADER,WG40.HTMLTABLE));if(c!=null){WGUIEngine.SetColumnLabelWidth(c)}}}}}},HasColGroup:function(b,a){return WGUIEngine.GetHeaderColGroup(b,a)!=null},GetHeaderColGroup:function(c,b){var d=null;if(c.IsRootTable){d=c.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,b)}else{d=c.SubTableIds[0].GetElement(WG40.COLHEADER,WG40.HTMLTABLE)}var a=d.getElementsByTagName("colgroup");if(a.length>0){return a[0]}else{return null}},ReorderColumn:function(n,m){var h=ISGetObject(n.GridId);var f;if(n.IsRootTable){if(!h.EnableSection508Standards&&!WGUIEngine.HasColGroup(n,m)){f=n.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,m).childNodes[0].childNodes[0]}else{f=n.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,m).rows[0]}}else{try{if(!h.EnableSection508Standards&&!WGUIEngine.HasColGroup(n,m)){f=n.SubTableIds[0].GetElement(WG40.COLHEADER,WG40.HTMLTABLE).childNodes[0].childNodes[0]}else{f=n.SubTableIds[0].GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0]}}catch(g){return}}var d=0;var j=n.Get("HideColumnsWhenGrouped");var c=new ISArray();for(var k=0;k<f.cells.length;k++){WG50Engine.EmulateAttributes(f.cells[k]);if(f.cells[k].type=="Column"){var a=n.Columns.GetNamedItem(f.cells[k].colName);a.Position=d;if(IS.ie){a.Width=f.cells[k].style.width}else{if(f.cells[k].offsetWidth>0){a.Width=f.cells[k].offsetWidth}else{a.Width=parseFloat(f.cells[k].style.width)+4}}c.Add(a);d++}}if(j=="Yes"){for(var k=0;k<n.GroupedColumns.length;k++){var a=n.Columns.GetNamedItem(n.GroupedColumns[k].ColumnMember);a.Position=d;a.Visible=false;a.IsGrouped=true;c.Add(a);d++}}for(var k=0;k<n.GroupedColumns.length;k++){var b=n.GroupedColumns[k].ColumnMember;var a=c.GetNamedItem(b);if(!a){a=n.GetColumn(b);a.Position=d;c.Add(a);d++}}for(var k=0;k<n.Columns.length;k++){var a=n.Columns[k];var l=false;if(!a.Visible&&!a.IsGrouped){a.Position=d;l=true}if(a.ForceVisible){a.Visible=true;if(c.IndexOf(a)==-1){a.Position=d;l=true}}if(l){c.Add(a);d++}}c.InitializeFrom(n.Columns);n.Columns=c;n.Columns.UpdateChanges();h.UpdateState()},UpdateUI:function(a){WGUIEngine.ProcessGroupedColumns(a);WGUIEngine.ProcessSortedColumns(a);WGUIEngine.ProcessFilteredColumns(a)},ProcessGroupedColumns:function(m,o){var n=null;var j=m.Grid;if(j.HeaderContext){n=j.HeaderContext.parentElement}for(var l=0;l<m.GroupedColumns.length;l++){var h=m.GroupedColumns[l];var a=m.Columns.GetNamedItem(h.ColumnMember);if(m.Get("HideColumnsWhenGrouped")=="No"){var b=null;var f=true;try{b=a.GetElement()}catch(d){f=false}finally{if(b==null){f=false}}if(f){switch(h._UIState){case"Added":case"PositionChanged":case"Changed":b.isGrouped="True";break;case"Removed":b.isGrouped="False";break}}}if(h._UIState=="Added"){WGUIEngine.CreateGroupColumnUI(a)}else{if(h._UIState=="PositionChanged"){WGUIEngine.MoveGroupColumnUI(h)}else{if(h._UIState=="Changed"){var k=h.GetElement();k.sortOrder=a.SortOrder;WGUIEngine.RemoveSortIcon(k);WGUIEngine.SetColumnSortOrder(j,k);if(m.IsUseColumnSet||j.LayoutSettings.HideColumnsWhenGrouped=="No"){var b=null;var f=true;try{b=a.GetElement()}catch(d){f=false}if(f){b.sortOrder=a.SortOrder;WGUIEngine.RemoveSortIcon(b);WGUIEngine.SetColumnSortOrder(j,b)}}}else{if(h._UIState=="Removed"){m.GroupedColumns.Remove(h);WGUIEngine.RemoveGroupColumnUI(h,o);l--}}}}h._UIState="Unchanged"}if(!m.IsUseColumnSet){WGUIEngine.ReorderColumn(m,n)}if(!m.IsRootTable){WGHierEngine.RefreshGroupByBoxTreeStructure(j)}m.GroupedColumns.UpdateChanges()},ProcessSortedColumns:function(h){var j=null;var e=h.Grid;if(e.HeaderContext){j=e.HeaderContext.parentElement}for(var f=0;f<h.SortedColumns.length;f++){var d=h.SortedColumns[f];var a=h.Columns.GetNamedItem(d.ColumnMember);var b=a.GetElement();if(b==null){b=d.GetElement()}a.IsSorted=true;a.SortOrder=d.SortOrder;if(b){b.sortOrder=a.SortOrder}if(d._UIState=="Added"){}else{if(d._UIState=="Changed"){if(d.SortOrder=="None"){h.SortedColumns.Remove(d,true)}}}if(d._UIState=="Removed"){h.SortedColumns.Remove(d);a.IsSorted=false;a.SortOrder="None";if(b){b.sortOrder="None"}f--}if(b){WGUIEngine.SetColumnSortOrder(e,b)}d._UIState="Unchanged"}h.SortedColumns.UpdateChanges()},ProcessFilteredColumns:function(m,k,l){var n=null;var h=m.Grid;if(h.HeaderContext){n=h.HeaderContext.parentElement}if(typeof(k)=="undefined"){m._LastFilters.Clear()}if(!h.LayoutSettings.ShowFilterStatus||!h.LayoutSettings.StatusBarVisible){k=true}for(var j=0;j<m.FilteredColumns.length;j++){var f=m.FilteredColumns[j];var a=m.Columns.GetNamedItem(f.ColumnMember);var b=a.GetElement();var d=f.GetElement();var e=f.GetTextElement();if(d&&(f._UIState=="Added"||f._UIState=="Changed")){d.oldCellValue=d.cellValue=d.filterText=f.FilterText;d.filterType=WGMenuEngine.GetFilterTypeInt(f.FilterType);if(e!=null){e.value=f.FilterText}if(a.GetFilterEditType()=="Checkbox"){if(l=="FilterSuggestClick"){WGEditEngine.GetCheckBoxCell(d).checked=(f.FilterText=="true")}else{WGEditEngine.GetCheckBoxCell(d).checked=(d.cellValue==true||d.cellValue=="true")}f.FilterText=f.FilterText.toString()}else{if(a.GetFilterEditType()=="WebComboNET"||a.GetFilterEditType()=="DropdownList"){if(f.FilterDisplayText!=""&&e!=null){e.innerText=f.FilterDisplayText}}else{if(e!=null){e.innerText=d.cellValue}}}if(f.FilterDisplayText==""&&e!=null&&f.FilterText!=e.innerText){f.FilterDisplayText=e.innerText}if(m.UseValueListForFilter=="Yes"||a.UseValueListForFilter=="Yes"){f.FilterText=e.innerText}if(f.FilterText!=""){f.FilterText=f.FilterText.replace(/[\n]/g,"")}}if(f._UIState=="Removed"){if(d){d.oldCellValue=d.cellValue=e.value=d.filterText="";d.filterType="0";if(a.GetFilterEditType()=="Checkbox"){WGEditEngine.GetCheckBoxCell(d).checked=false}else{e.innerText=""}}m.FilteredColumns.Remove(f);j--}if(IS.moz&&d){WGMozEngine.ResizeFilterColumn(d,d.offsetWidth)}f._UIState="Unchanged"}if(!k){if(m.FilteredColumns.length==0){m.FilterState="Disabled";WGUIEngine.SetFilterStatusIndicator(h,"Disabled",m._LastFilters.length==0)}else{m.FilterState="Enabled";WGUIEngine.SetFilterStatusIndicator(h,"Enabled",false)}}m.FilteredColumns.UpdateChanges()},GetCellIndexByRowElement:function(d,c){var b=WGUIEngine.GetFirstGroupColumn(d);var a=-1;if(!b){a=WGUIEngine.GetLatestGroupColumn(d)}else{a=b.cellIndex+(c*2)}return a},CreateNewGroupColumn:function(b,d){var a=WG50Engine.GetColumnByElement(b);a.IsGrouped=true;if(a.SortOrder=="None"){a.SortOrder="Ascending"}var c=new WebGridGroup();c.ColumnMember=c.Name=a.Name;c.SortOrder=a.SortOrder;if(typeof(d)=="undefined"){a.Table.GroupedColumns.Add(c)}else{a.Table.GroupedColumns.InsertAt(c,d)}return c},CreateGroupColumnUI:function(d,t){var u=WGUIEngine.GetGroupByBoxRow(d.GetGrid().Id,d.Table.Id);var m=false;var l=false;if(u){if(!WGUIEngine.IsGroupColumnUIExist(d.GetGrid().Id,d.Table.Id,d.Name)){l=true}}else{m=true;l=true}if(!m&&!l){return false}var i=d.GetGrid();var s=d.Table;var h=i.FrameObj.style.posLeft;if(m){var q=-1;if(!s.IsRootTable){WGHierEngine.CreateParentGroupByBoxRow(d);q=WGHierEngine.GetPreviousGroupByBoxRow(d,s.Parent.Name);WGUIEngine.CreateGroupByBoxRowSeparator(s,q+1);i.NeedHeightResize=true}u=WGUIEngine.CreateGroupByBoxRow(s,q+2)}if(l){var f=u.childNodes[0].childNodes[0].childNodes[0].childNodes[0];var n=null;var e=null;var p=null;var v=i.GetElement(WG40.GROUPBYBOXLABEL,WG40.HTMLROW);if(v.style.display==""){v.style.display="none"}if(!s.IsRootTable&&i.HeaderContext){p=i.HeaderContext.parentElement;if(p.tagName!="TD"&&p.tagName!="TR"){p=WG50Engine.GetTD(p)}}e=d.GetElement(p);e.tblName=s.Id;var j=s.GroupedColumns.GetNamedItem(d.Name);if(j.Index<s.GroupedColumns.length-1){var o=j.Index;if(o<0){o=0}n=WGUIEngine.GetCellIndexByRowElement(u,o)-1}if(n){var g=WGUIEngine.GetFirstGroupColumn(u);if(g){if(n<g.cellIndex){n=g.cellIndex-1}}}var a;if(n&&!m){a=f.insertCell(n)}else{a=f.insertCell(-1)}a.style.cssText="width: 16px; padding: 0px";var k=i.LayoutSettings.GroupByBox.ConnectorLineColor;a.innerHTML="<hr size=1 style='border-color: "+k+" ; border-style: "+i.LayoutSettings.GroupByBox.ConnectorLineStyle+"' width='100%'>";if(i.UseCssFramework){a.children[0].style.cssText=""}var b;if(n&&!m){b=f.insertCell(n+1)}else{b=f.insertCell(-1)}b.innerHTML=e.innerHTML;b.mergeAttributes(e);if(b.style.borderRightStyle!=""){b.style.borderRightStyle=b.style.borderRightColor=b.style.borderRightWidth=""}if(IS.moz){b.style.cssText=e.style.cssText}b.style.backgroundColor="";b.style.color="";b.style.width=e.offsetWidth+"px";b.type="GroupColumn";b.gridId=i.Id;b.tblName=s.Id;b.className=b.className.replace(" grid-header-active","");var r=s.SortedColumns.GetNamedItem(d.Name);if(r){s.SortedColumns.Remove(r);s.SortedColumns.UpdateChanges();WGUIEngine.RemoveSortIcon(b)}else{b.sortOrder="Ascending";b.innerHTML+="&nbsp;"}WGUIEngine.SetColumnSortOrder(i,b);var c=s.Get("HideColumnsWhenGrouped")=="Yes";if(c&&!s.IsUseColumnSet){WGUIEngine.RemoveColumnUI(d,true)}else{e.sortOrder=b.sortOrder;WGUIEngine.RemoveSortIcon(e);WGUIEngine.SetColumnSortOrder(i,e)}WGUIEngine.FitColumns(s,"Group",e)}},MoveGroupColumnUI:function(b){var g=b.Table;var a=g.Grid;var h=g.GroupedColumns[b.Index+1];var c=false;var d=null;var e=null;d=b.GetElement();if(h){e=h.GetElement().previousSibling}else{tr=WGUIEngine.GetGroupByBoxRow(a.Id,g.Id);e=WGUIEngine.GetLatestGroupColumn(tr);c=true}if(d&&e){var f=d.previousSibling;WGUIEngine.MoveObject(f,e,c);WGUIEngine.MoveObject(d,f,true)}},RemoveGroupColumnUI:function(f,a,d){var k=f.Table;var e=k.Grid;var b=k.Columns.GetNamedItem(f.ColumnMember);var l=wg_Global.TargetHeader;var i=e.LayoutSettings.HideColumnsWhenGrouped;var g=f.GetElement();var j=g.parentElement;if(a){l=a}j.removeChild(g.previousSibling);j.removeChild(g);b.IsGrouped=false;b.SortOrder="None";if(d&&i=="Yes"){b.Visible=false}k.ColumnMenu=null;if(l&&l.Type=="Column"){if(i=="Yes"){b.Visible=b.ForceVisible=true;l.Element.insertAdjacentElement((l.ProperPosition==l.PosLeft?"beforeBegin":"afterEnd"),g);g.sortOrder="None";g.type="Column";g.setAttribute("sortOrder","None");WGUIEngine.RemoveSortIcon(g);WGUIEngine.SynchronizeClientTemplate(k,"Add",[b,g.cellIndex]);WGUIEngine.FitColumns(k,"UngroupRestore",g)}else{var c=b.GetElement();if(c!=null){c.sortOrder="None";c.setAttribute("sortOrder","None");c.setAttribute("isSorted","False");WGUIEngine.RemoveSortIcon(c)}WGUIEngine.FitColumns(k,"UngroupHide",l.Element.parentElement)}}else{if(l&&l.Type=="Unknown"){if(i=="Yes"){b.Visible=false}}else{if(i=="Yes"){b.Visible=false}}}var h=k.HasChildTableGroupedColumns();if(!h){if(k.GroupedColumns.length==0){if(!k.IsRootTable){WGHierEngine.RemoveParentGroupRow(k);WGUIEngine.ClearGroupByBoxRowSeparator(j)}WGUIEngine.ClearGroupByBoxRow(j);e.NeedHeightResize=true}}if(!e.HasGroup()){var m=e.GetElement(WG40.GROUPBYBOXLABEL,WG40.HTMLROW);m.style.display=""}},ProcessContextMenu:function(a,f,d){var e;wg_Global.IsMouseDown=false;if(a.tagName!="TD"&&a.tagName!="TH"){e=a;a=WG50Engine.GetTDorTH(a)}if(!a){return}else{if(a.type=="SubCell"){a=WG50Engine.GetTD(a.parentElement)}}if(!a.type){return}if(a.tagName=="TD"||a.tagName=="TH"){var h=a.parentElement;if((a.type=="Cell"||a.type=="GroupColumn"||a.type=="Column"||a.type=="GroupCell"||a.type=="FilterColumn")){var c=WG50Engine.GetTable(h);var b=ISGetObject(c.gridId);if(!b||!b.Enabled){return}if(e&&e.tagName=="IMG"&&h.type=="FilterRow"){return}var g=b.Tables[c.tblName];if(b.LayoutSettings.AllowContextMenu){event.cancelBubble=true;event.returnValue=false;WGMenuEngine.ShowContextMenu(b,a,f,a.type,null,d);return false}}}},OnGBBMouseMove:function(){var a=event.srcElement;if(wg_Global.IsHeaderDragged){return}if(a.tagName=="TD"||a.tagName=="TH"){var b=ISGetObject(WG50Engine.GetGridNameByRow(a.parentElement));if(!b){return}var c=b.Tables[WG50Engine.GetTableNameByRow(a.parentElement)];if(event.button==1){if(a.type=="GroupColumn"){a.tblName=c.Id;a.gridId=b.Name;wg_Global.ColDragTarget=a}}}},OnGBBMouseDown:function(){if(event.button==ISEvent.LEFT||(IS.w3cf&&event.buttons==ISEvent.LEFT)){wg_Global.IsDragObjectValid=true}},OnColumnHeaderContextMenu:function(){},OnColumnHeaderMouseUp:function(g){var a=wg_Global.ColSizeTarget;if(a&&a.cellIndex==-1){a=null}if(a!=null){var j=a.parentElement;var e=0;e=ISPosLib.getLeft(a);var f=ISGetObject(a.gridId);if(!f){return}if(typeof(g)=="object"){g=false}var i=f.Tables[a.tblName];if((!f.Resizer||f.Resizer.style.display=="none")&&!g){return}var b=WG50Engine.GetColumnByElement(a);if(!g){var d=f.Resizer.style.posLeft-e+posLib2.getLeftAbs(f.FrameObj,f);if(!ISEvent.Raise(f.LayoutSettings.ClientSideEvents.OnColumnResize,a.gridId,a.tblName,b,d)){return}if(a.type=="CSHeader"){wg_Global.NoDisplayUpdate=true}}var h=a.style.width;WGUIEngine.ResizeColumn(i,a,(g?a.EstWidth:d),g);if(i.IsRootTable){WG50Engine.OnTableScroll(f)}if(f.Resizer){f.Resizer.style.display="none"}if(event){event.cancelBubble=true;event.returnValue=false}wg_Global.ColSizeTarget=a}if(wg_Global.ColSizeTarget){wg_Global.ColSizeTarget.style.cursor=""}if(wg_Global.ColSizeTarget2){wg_Global.ColSizeTarget2.style.cursor=""}if(event!=null&&event.button==ISEvent.LEFT){wg_Global.IsDragObjectValid=false}wg_Global.IsMouseDown=false},OnColumnHeaderMouseMove:function(){var c=event.srcElement;if(wg_Global.IsHeaderDragged){return}if(c.tagName!="TD"&&c.tagName!="TH"){c=WG50Engine.GetTDorTH(c)}if(c&&(c.tagName=="TD"||c.tagName=="TH")){var n=c.parentElement;var h=ISGetObject(WG50Engine.GetGridNameByRow(n));if(!h){return}if(!h.Enabled){return}if(h.EnableSection508Standards&&c.tagName!="TH"&&c.type!="ColHeader"&&c.type!="GroupColumn"){return}var m=h.Tables[WG50Engine.GetTableNameByRow(n)];if(!m){return}var i=event.button==0;if(IS.ie11){i=event.button==0&&event.buttons==0}if(((!IS.ie&&!wg_Global.IsMouseDown)||IS.ie)&&(i||event.button==65535)){WG50Engine.EmulateAttributes(c);if(c.type!="Column"&&c.type!="CSHeader"){return}var a=null;if(c.type=="Column"){a=WG50Engine.GetColumnByElement(c);if(!a||a.IsAutoWidth){return}}else{if(c.type=="CSHeader"){a=m.ColumnSets[c.pos]}}var k=true;var f=ISPosLib.getLeft(c);var d=f+c.offsetWidth;var j=null;var g=5;if(!m.IsUseColumnSet){j=WG50Engine.GetPreviousVisibleColumn(m,a,n)}if(h.LayoutSettings.ShowColumnAction){g=-1}if((plGetCurX()>=d-g&&plGetCurX()<=d+3)||(j!=null&&plGetCurX()<=f+8)){var b=c;if(plGetCurX()<=f+8){a=j;c=j.GetElement(n);if(c==null){c=wgGetCellByName(n,j.Name)}}if(a.Get("AllowSizing")!="Yes"||h.IsInProgress){return}if(wg_Global.ColSizeTarget&&wg_Global.ColSizeTarget!=c&&wg_Global.ColSizeTarget.style){wg_Global.ColSizeTarget.style.cursor=""}b.style.cursor="e-resize";c.tblName=m.Id;c.gridId=h.Name;wg_Global.ColSizeTarget=c;if(c!=b){wg_Global.ColSizeTarget2=b}else{if(!h.ActionBoxShown&&h.ActionElement!=null){h.ClearActionElement()}}}else{if(wg_Global.ColSizeTarget){if(wg_Global.ColSizeTarget.style){wg_Global.ColSizeTarget.style.cursor=""}wg_Global.ColSizeTarget=null}if(wg_Global.ColSizeTarget2){if(wg_Global.ColSizeTarget2.style){wg_Global.ColSizeTarget2.style.cursor=""}wg_Global.ColSizeTarget2=null}WGUIEngine.OnColumnHeaderMouseOver()}}else{if(ISEvent.IsLeftButton(event)||wg_Global.IsMouseDown){if(wg_Global.ColSizeTarget!=null){if(m.Id!=wg_Global.ColSizeTarget.tblName){return}else{if(WG50Engine.GetTable(n)!=WG50Engine.GetTable(wg_Global.ColSizeTarget.parentElement)){return}}var l=h.Resizer;if(l==null){l=WGUIEngine.CreateResizer(h);h.Resizer=l}var e=ISPosLib.getLeft(wg_Global.ColSizeTarget);var n=wg_Global.ColSizeTarget.parentElement;if(h.ActionElement!=null){h.ClearActionElement()}if(plGetCurX()>e+10){if(h.LastEditObj){h.ExitEditMode()}l.style.left=plGetCurX()-2-posLib2.getLeftAbs(h.FrameObj,h)+"px";if(l.style.display!=""){l.style.height=m.GetElement(WG40.BODY,WG40.HTMLDIV,n).offsetHeight+m.GetElement(WG40.COLHEADER,WG40.HTMLDIV,n).offsetHeight+"px";l.style.top=ISPosLib.getTop(c)-posLib2.getTopAbs(h.FrameObj,h)+"px"}l.style.display="";l.style.cursor="e-resize"}k=true}else{if(c.type=="Column"||c.type=="GroupColumn"){c.tblName=m.Id;c.gridId=h.Name;wg_Global.ColDragTarget=c}}}}}},OnColumnHeaderDblClick:function(){var b=((event)?event.srcElement:wg_Global.EventContext);if(b.tagName!="TD"&&b.tagName!="TH"){b=WG50Engine.GetTDorTH(b)}if(!b){return}if(b.type=="Column"&&b.style.cursor=="e-resize"){var d=ISGetObject(WG50Engine.GetGridNameByRow(b.parentElement));var f=b;var h=b.parentElement;var c=ISPosLib.getLeft(b);if(d.LastEditObj){d.ExitEditMode()}if(plGetCurX()<=c+6){var g=d.Tables[WG50Engine.GetTableNameByRow(h)];var a=WG50Engine.GetColumnByElement(b);var e=WG50Engine.GetPreviousVisibleColumn(g,a);f=e.GetElement(h);if(f==null){f=wgGetCellByName(h,e.Name)}}WGUIEngine.ResizeBestFit(f);b.style.cursor="";if(d.ActionElement!=null){d.ClearActionElement()}return true}},OnColumnHeaderClick:function(o,r,s){var g=((event)?event.srcElement:wg_Global.EventContext);if(r){g=r}if(g.tagName!="TD"&&g.tagName!="TH"){g=WG50Engine.GetTDorTH(g)}if(!g){return}if(wg_Global.DragJustEnded){wg_Global.DragJustEnded=false;return}if(g.type=="Column"||g.type=="GroupColumn"){var k=ISGetObject(WG50Engine.GetGridNameByRow(g.parentElement));if(!k){return}var x=k.Tables[WG50Engine.GetTableNameByRow(g.parentElement)];var y=g.parentElement;var j=ISPosLib.getLeft(g)+g.offsetWidth;if((plGetCurX()>=j-5&&plGetCurX()<=j)||(wg_Global.ColSizeTarget||wg_Global.ColSizeTarget2)){if(wg_Global.ColSizeTarget){wg_Global.ColSizeTarget=null}if(wg_Global.ColSizeTarget2){wg_Global.ColSizeTarget2=null}return}g.tblName=x.Id;g.gridId=k.Name;var e=x.Columns.GetNamedItem(g.colName);if(g.isGrouped=="True"&&g.type=="Column"){var l=x.GroupedColumns.GetNamedItem(e.Name);WGUIEngine.OnColumnHeaderClick(true,l.GetElement(),g);return}if(!o){if(e.Get("AllowSorting")!="Yes"){return}if(!k.Enabled){return}}if(o){var l=x.GroupedColumns.GetNamedItem(e.Name);if(g.sortOrder=="None"){l.SortOrder="Ascending"}else{if(g.sortOrder=="Ascending"){l.SortOrder="Descending"}else{l.SortOrder="Ascending"}}e.SortOrder=l.SortOrder;l._UIState="Changed";WGUIEngine.ProcessGroupedColumns(x);WG50Engine.ExecuteFlyPostback(k.Name,"ChangeGroup",g);return}if((k.LastEditObj||k.ActiveEditCell)&&!k.IsExitingEdit){var q=k.LastEditObj;var p=k.ActiveEditCell;var f=k.Tables[((q)?q.tblName:p.tblName)];var c=f.Get("AllowEdit")=="Yes";var u;if(q){u=q.cellElement.parentElement}else{u=p.rowElement}if(u&&c&&(u.type=="Record"||u.type=="NewRow")){if(u.markedEdit){var t=WGEditEngine.ExitEdit(k,1)[0];return t}else{if(q){WGEditEngine.ExitEditMode(q)}}}}if(!event.shiftKey||x.Get("HeaderClickAction")=="SortSingle"){var b=g.parentElement;var v=new Array();if(x.IsUseColumnSet){v=wgGetColumnSetRows(b)}else{v[0]=b}for(var m=0;m<v.length;m++){var y=v[m];for(var n=0;n<y.cells.length;n++){var d=y.cells[n];if(d.colName==g.colName||d.isGrouped=="True"){continue}if(d.type=="Column"&&d.sortOrder!="None"){d.sortOrder="None";var a=x.SortedColumns.GetNamedItem(d.colName);if(a){x.SortedColumns.Remove(a,true)}}}}}var w=null;if(g.sortOrder=="None"){w=new WebGridGroup();w.ColumnMember=g.colName;w.SortOrder="Ascending";x.SortedColumns.Add(w)}else{var z=false;w=x.SortedColumns.GetNamedItem(g.colName);if(!w){var w=new WebGridGroup();w.ColumnMember=g.colName;w.SortOrder=g.sortOrder;x.SortedColumns.Add(w);z=true}if(!z){if(w.SortOrder=="Ascending"){w.SortOrder="Descending"}else{w.SortOrder="None"}}w._UIState="Changed"}if(ISEvent.Raise(k.LayoutSettings.ClientSideEvents.OnColumnSort,k.Id,w)){k.HeaderContext=g;WGUIEngine.ProcessSortedColumns(x);WG50Engine.ExecuteFlyPostback(k.Name,"ColumnSort",g)}}},OnColumnHeaderMouseDown:function(){if((event.button==ISEvent.LEFT||event.button==65535)&&!IS.ie){wg_Global.IsMouseDown=true;var a=event.srcElement;if(a.tagName=="SPAN"||a.tagName=="NOBR"){a=WG50Engine.GetTD(a)}if(a&&a.tagName=="TD"&&a.getAttribute("type")=="Column"){doHideWindowPopups();event.cancelBubble=true;event.returnValue=false}}if(ISEvent.IsLeftButton(event)){wg_Global.IsDragObjectValid=true}},OnColumnHeaderKeyDown:function(){return WGUI.TBKD()},OnColumnHeaderMouseOver:function(){var f=event.srcElement;if(wg_Global.IsHeaderDragged||wg_Global.ColSizeTarget!=null){return}if(f.tagName!="TD"&&f.tagName!="TH"){f=WG50Engine.GetTDorTH(f)}if(f&&(f.tagName=="TD"||f.tagName=="TH")){var j=f.parentElement;var g=ISGetObject(WG50Engine.GetGridNameByRow(j));if(!g){return}if(!g.Enabled){return}if(f.type!="Column"){return}var i=g.Tables[WG50Engine.GetTableNameByRow(j)];if(!i){return}if(!g.LayoutSettings.ShowColumnAction||g.ActionBoxShown){return}if(((!IS.ie&&!wg_Global.IsMouseDown)||IS.ie)&&(event.button==0||event.button==65535)){var a=g.GetColumnActionElement();var c=g.LayoutSettings.ColumnActionStyle;var d=i.Columns.GetNamedItem(f.colName);var k=0;if(g.ActionContext!=null&&g.ActionContext[1]==f){return}if(!d.Bound){return}var b=parseInt(a.style.width);if(isNaN(b)){if(g.UseCssFramework){var e=IS.GetCssValues("",c.Normal,false,true);b=parseInt(e.width);if(IS.ie){k=1}}else{b=17}}a.style.left=ISPosLib.getRight(f)-k-b-posLib2.getLeftAbs(g.FrameObj,g)+ISPosLib.getScrollLeft(document)+"px";if(!g.UseCssFramework){a.style.top=ISPosLib.getTop(f)-posLib2.getTopAbs(g.FrameObj,g)+ISPosLib.getScrollTop(document)+"px";a.style.height=ISPosLib.getHeight(f)-1+"px"}else{var h=0;if(!IS.safari||IS.edge){h=1}a.style.top="0px";a.style.height=(f.offsetHeight-h)+"px"}a.style.display="";a.gridId=g.Id;g.ActionContext=[d,f];if(c!=null&&c.Normal!=""){DynamicStyleEngine.SetToStyle(null,c,a)}}}},OnColumnHeaderMouseOut:function(){var b=event.srcElement;var e=event.toElement;if(wg_Global.IsHeaderDragged){return}if(b.tagName!="TD"&&b.tagName!="TH"){b=WG50Engine.GetTDorTH(b)}if(b&&(b.tagName=="TD"||b.tagName=="TH")){var f=b.parentElement;var c=ISGetObject(WG50Engine.GetGridNameByRow(f));if(!c){return}if(!c.Enabled){return}if(b.type!="Column"){return}if(e!=null&&b.contains(e)){return}var d=c.Tables[WG50Engine.GetTableNameByRow(f)];if(!d){return}if(!c.LayoutSettings.ShowColumnAction||c.ActionBoxShown){return}if(((!IS.ie&&!wg_Global.IsMouseDown)||IS.ie)&&(event.button==0||event.button==65535)){var a=c.GetColumnActionElement();if(a.contains(e)||a==e){return}c.ClearActionElement()}}},OnActionOver:function(){var a=this.LayoutSettings.ColumnActionStyle;if(this.ActionBoxShown){return}if(a!=null&&a.Over!=""){DynamicStyleEngine.SetToOverStyle(null,a,this.ActionElement)}},OnActionOut:function(){var a=this.LayoutSettings.ColumnActionStyle;var b=event.toElement;if(this.ActionBoxShown){return}if(a!=null&&a.Normal!=""){DynamicStyleEngine.SetToStyle(null,a,this.ActionElement)}if(b!=null&&this.ActionContext!=null&&!this.ActionElement.contains(b)){if(!this.ActionContext[1].contains(b)){this.ClearActionElement()}}},OnActionUp:function(){var b=this.LayoutSettings.ColumnActionStyle;var c=event.srcElement;var e=event.toElement;if(wg_Global.IsHeaderDragged){return}if(c.style.width=="100%"){c=c.parentElement}var d=ISGetObject(c.gridId);var a=d.ActionContext;if(d.ActionBoxShown){return}if(b!=null&&b.Active!=""){DynamicStyleEngine.SetToActiveStyle(null,b,this.ActionElement)}if(!ISEvent.Raise(d.LayoutSettings.ClientSideEvents.OnColumnAction,d.Id,d.ActionContext[0])){return}if(a[1].parentElement==null){a[1]=a[0].GetElement()}WGMenuEngine.ShowContextMenu(d,a[1],false,"Column",c);d.ActionBoxShown=true;setTimeout(function(){d.ActionBoxShown=true},1)},OnDivBodyResize:function(b,a){},OnBodyMouseDown:function(){wg_Global.ButtonState=1;var b=event.srcElement;if(!IS.ie||IS.ie9){var e=false;wg_Global.IsMouseDown=true;if(b.tagName=="TEXTAREA"||b.tagName=="SELECT"){e=true}else{if(b.tagName=="INPUT"&&b.type=="checkbox"&&b.className!="DefChkBox"){e=true}else{if(b.tagName=="INPUT"&&b.type=="text"){e=true}}}var a=wgGetActiveGrid();if(a){var c=ISGetObject(a);if(c){if(b!=null&&b.type!="checkbox"&&c.FrameObj.contains(b)&&!e){event.returnValue=true}}if(IsGecko30()||IS.safari||(IS.ie9&&IS.IsHTML5DocType())){var d=false;if(c.FrameObj.contains(b)){d=true}if(!d){d=WGUIEngine.IsWebGridElement(c,b)}if(!d){if(!IS.ie9){WGMozEngine.OnBlur(c)}else{WG50Engine.OnBlur(c,b);wg_Global.ActiveGrid=null}}else{if(e){return false}}}}}WGEventEngine.ProcessMouseEvents(b);if(event.button==ISEvent.RIGHT){WGUIEngine.ProcessContextMenu(b)}},OnBodyMouseUp:function(h,m){wg_Global.IsMouseDown=false;if(wg_Global.ColSizeTarget!=null){var k=ISGetObject(wg_Global.ColSizeTarget.gridId);if(k&&k.Resizer){k.Resizer.style.display="none"}}var r=wg_Global.TargetHeader;if(r&&!m){var d=wg_Global.ColDragTarget;var k=ISGetObject(d.gridId);var p=k.Tables[d.tblName];var s=d.parentElement;var i=posLib2.getLeftAbs(k.FrameObj,k);var j=posLib2.getTopAbs(k.FrameObj,k);if(r.Type=="Column"&&d.type=="Column"){if(p.Get("AllowColumnMove")=="Yes"&&!p.IsUseColumnSet){if(r.Element.cellIndex!=d.cellIndex&&r.ProperPosition+i!=ISPosLib.getLeft(d)){var b=r.Element.cellIndex;var c=d.cellIndex;if(r.ProperPosition==r.PosRight&&b+1<r.Element.parentElement.cells.length-1&&c>b){b++;r.Element=r.Element.parentElement.cells[b]}else{if(r.ProperPosition==r.PosLeft&&c<b&&b>0){b--;r.Element=r.Element.parentElement.cells[b]}}if(c!=b){if(ISEvent.Raise(k.LayoutSettings.ClientSideEvents.OnColumnMove,d.gridId,d.tblName,c,b,WG50Engine.GetColumnByElement(d),WG50Engine.GetColumnByElement(r.Element))){if(p.IsRootTable){p._colIndexCache=null;p._colIndexCache2=null}k.SetStatus1("","columnmove","CommonText/ColumnMove");wg_Global.MoveColEventArgs=new wgMoveColArgs(p,b,c,s,d,r);setTimeout("WGUIEngine.MoveColumn()",200)}}}}}else{if(r.Type=="GroupColumn"||r.Type=="GroupInfo"){var e=p.Columns.GetNamedItem(d.colName);if(e.Get("AllowGrouping")=="Yes"){var a="";k.HeaderContext=d;if(r.Type=="GroupInfo"){if(p.GroupedColumns.GetNamedItem(e.Name)==null){if(ISEvent.Raise(k.LayoutSettings.ClientSideEvents.OnColumnGroup,k.Id,e)){WGUIEngine.CreateNewGroupColumn(d);a="Group"}}}else{if(d.type=="Column"){var l=0;var q=p.GroupedColumns.GetNamedItem(r.Element.colName);if(q){l=q.Index+1;if(r.ProperPosition==r.PosLeft){l--}}if(ISEvent.Raise(k.LayoutSettings.ClientSideEvents.OnColumnGroup,k.Id,e)){WGUIEngine.CreateNewGroupColumn(d,l);a="Group"}}else{if(d!=r.Element){var o=p.GroupedColumns.GetNamedItem(d.colName);var q=p.GroupedColumns.GetNamedItem(r.Element.colName);if(o.Index!=q.Index){if(ISEvent.Raise(k.LayoutSettings.ClientSideEvents.OnColumnGroupChange,k.Id,e)){p.GroupedColumns.Move(o.Index,q.Index);a="ChangeGroup"}}}}}if(a!=""){if(a.indexOf("Group")!=-1){WGUIEngine.ProcessGroupedColumns(p)}WG50Engine.ExecuteFlyPostback(k.Name,a,d)}}}else{if(d.type=="GroupColumn"){var e=p.Columns.GetNamedItem(d.colName);var n=true;if(k.FreezePaneActive&&r.Type=="Column"&&r.Element!=null){var f=p.Columns.GetNamedItem(r.Element.colName);if(f.IsFrozen){alert("You cannot ungroup a column inside frozen columns area.");n=false}}if(n&&e.Get("AllowGrouping")=="Yes"){if(ISEvent.Raise(k.LayoutSettings.ClientSideEvents.OnColumnUngroup,k.Id,e)){p.GroupedColumns.Remove(p.GroupedColumns.GetNamedItem(d.colName),true);WGUIEngine.ProcessGroupedColumns(p);WG50Engine.ExecuteFlyPostback(k.Name,"Ungroup",d)}}}}}}if(wg_Global.IsHeaderDragged){var g=wg_Global.Dragger;if(g){var d=wg_Global.ColDragTarget;if(!k){k=ISGetObject(d.gridId)}g.style.display="none";g.removeNode(true);wg_Global.Dragger=null;if(!k.UseCssFramework){d.style.color="";d.style.backgroundColor=""}else{d.className=d.className.replace(" grid-header-active","")}d.removeAttribute("elLeft");d.removeAttribute("elTop");d=null;wg_Global.ColDragTarget=null;wg_Global.TargetHeader=null;wg_Global.IsDragObjectValid=false;if(k.ColPointer){k.ColPointer.style.display="none"}if(k.Resizer){k.Resizer.style.display="none"}}wg_Global.DragJustEnded=true}wg_Global.IsHeaderDragged=false;wg_Global.ButtonState=0;wg_Global.MouseCoord=null;wg_Global.MouseMoved=false},OnBodyMouseMove:function(){var l=true;if(IS.moz){if(!wg_Global.IsMouseDown){l=false}}if(ISEvent.IsLeftButton(event)&&l){if(wg_Global.ColSizeTarget){return false}if(!wg_Global.MouseMoved){var k=wg_Global.MouseCoord;if(!k){wg_Global.MouseCoord=new wgMouseCoord(event.x,event.y);wg_Global.MouseMoved=true;return}else{if(k.x!=event.x&&k.y!=event.y){wg_Global.MouseMoved=true}}return}else{if(wg_Global.ColDragTarget&&wg_Global.IsDragObjectValid){wg_Global.IsHeaderDragged=true}}if(wg_Global.IsHeaderDragged){var a=wg_Global.ColDragTarget;var i=ISGetObject(a.gridId);if(!i.Enabled){return}if(a){if(!i.UseCssFramework){a.style.backgroundColor=i.SelectedHeaderBackColor;a.style.color=i.SelectedHeaderForeColor}else{if(a.className.indexOf("grid-header-active")==-1){a.className+=" grid-header-active"}}var f=wg_Global.Dragger;if(f==null){f=WGUIEngine.CreateDragger(a);wg_Global.Dragger=f}if(i.ActionElement!=null){i.ClearActionElement()}var g;var h;if(!a.getAttribute("elLeft")){g=plGetCurX()-ISPosLib.getLeft(a);a.setAttribute("elLeft",g)}else{g=a.getAttribute("elLeft")}if(!a.getAttribute("elTop")){h=(plGetCurY())-ISPosLib.getTop(a);a.setAttribute("elTop",h)}else{h=a.getAttribute("elTop")}if(i.LastEditObj){i.ExitEditMode()}var d=plGetCurX()-g-posLib2.getLeftAbs(i.FrameObj,i);var e=plGetCurY()-posLib2.getTopAbs(i.FrameObj,i)+3;f.style.left=d+"px";f.style.top=e+"px";f.style.display="";var j=WGUIEngine.GetHeaderInfo(f,a);var m=i.Resizer;if(j){wg_Global.TargetHeader=j;var i=ISGetObject(a.gridId);var c=i.ColPointer;var n=i.Tables[a.tblName];var p=a.parentElement;var b=n.Columns.GetNamedItem(a.colName);if(j.Type=="Column"){if(n.Get("AllowColumnMove")!="Yes"||n.IsUseColumnSet){return}if(i.FreezePaneActive){var o=n.Columns.GetNamedItem(j.Element.colName);if(b.IsFrozen||(o&&o.IsFrozen)){wg_Global.TargetHeader=null;return}}if(m==null){m=WGUIEngine.CreateResizer(i);i.Resizer=m}m.style.left=j.ProperPosition+"px";m.style.height=f.offsetHeight+"px";m.style.top=j.PosTop+"px";m.style.display="";if(c){c.style.display="none"}}else{if(j.Type=="GroupInfo"||j.Type=="GroupColumn"){if(b.Get("AllowGrouping")!="Yes"){return}if(a.groupExist&&j.Type=="GroupColumn"&&a.tblName!=j.Element.tblName){return}if(c==null){c=WGUIEngine.CreatePointer(i);i.ColPointer=c}c.style.display="";c.style.left=j.ProperPosition+"px";c.style.top=j.PosTop+"px";if(m){m.style.display="none"}}else{if(j.Type=="Unknown"){if(c){c.style.display="none"}if(m){m.style.display="none"}if(event!=null&&event.srcElement!=null){if(!i.FrameObj.contains(event.srcElement)){WGUIEngine.OnBodyMouseUp(null,true)}}}}}}else{if(c){c.style.display="none"}if(m){m.style.display="none"}}}}}},GetParentIndex:function(g,c){var e=g;var b="";var a=new Array();for(var d=e.parentGroupIndex-1;d>=0;d--){var f=WGUIEngine.GetTRByGroupIndex(e,d,"previous");if(f!=null){a[a.length]=f.position}}a.reverse();b=a.join(";");if(!c){if(b!=""){b+=";"}if(typeof(g.parentIndex)!="undefined"){b+=g.parentIndex}}return b},GetGroupParentIndex:function(f){var d=f;var b="";var a=new Array();for(var c=d.groupIndex-1;c>=0;c--){var e=WGUIEngine.GetTRByGroupIndex(d,c,"previous");a[a.length]=e.position}a.reverse();b=a.join(";");return b},UpdateColumnFooter:function(i,k,j,h){if(h!=""){var a;var c=0;var b=0;if(k){try{a=k.GetElement(WG40.COLFOOTER,WG40.HTMLDIV);var f=k.GetElement(WG40.COLFOOTERGROUP);var d=f.childNodes[f.childNodes.length-1];c=d.width;b=a.scrollLeft}catch(g){}}else{a=j.GetElement(WG40.COLFOOTER,WG40.HTMLDIV)}if(a){a.outerHTML=h;if(k){var f=k.GetElement(WG40.COLFOOTERGROUP);var d=f.childNodes[f.childNodes.length-1];d.width=c;a=k.GetElement(WG40.COLFOOTER,WG40.HTMLDIV);if(b!=0){a.scrollLeft=b}}}}},ClearInvalidSelection:function(a,c){var b=WG50Engine.IsSelectedObjectValid(a.LastSelObj);if((b&&a.LastSelObj.GetRowElement().type!="NewRow"&&a.LastSelObj.GetRowElement().type!="FilterRow")||!b){if(b&&a.LastSelObj.tblName==c.Id||!b){a.ActiveEditCell=a.LastSelObj=null}}},SetTempContentVisibility:function(b){var a=document.getElementById("wgTempCnt");if(a){if(b){a.style.position="absolute";a.style.left="-500px";a.style.top="-500px"}a.style.display=b?"":"none"}},SetTempContent:function(a){var b=document.getElementById("wgTempCnt");if(!b){b=document.createElement("div");b.id="wgTempCnt";b.style.display="none"}b.innerHTML=a;document.body.appendChild(b)},ClearTempContent:function(){var a=document.getElementById("wgTempCnt");if(a){a.innerHTML=""}},GetTempContent:function(){var a=document.getElementById("wgTempCnt");if(a){return a.childNodes[0]}return null},GetTRByGroupIndex:function(g,b,c,h){if(typeof(h)=="undefined"){h="GroupHeader"}if(c=="previous"){var d=g;var f=WG50Engine.GetTable(d);while(d){WG50Engine.EmulateAttributes(d);if(d.groupIndex==b&&d.type==h){return d}try{d=wgGetPreviousRow(f,d)}catch(a){d=null}}return null}else{if(c=="next"){var d=g;var f=WG50Engine.GetTable(d);while(d){WG50Engine.EmulateAttributes(d);if(d.groupIndex==b&&d.type==h){return d}try{d=wgGetNextRow(f,d)}catch(a){d=null}}return null}}},GetLastCell:function(c){var a;for(var b=0;b<c.cells.length;b++){if(c.cells[b].type=="Cell"){a=c.cells[b]}}return a},RemoveColumn:function(a){var c=a.GetGrid();var d=a.Table;var b=a.GetElement();if(!ISEvent.Raise(c.LayoutSettings.ClientSideEvents.OnColumnChanged,c.Id,d.Id,a.Name,"Removed")){return}WGUIEngine.RemoveColumnUI(a);WGUIEngine.FitColumns(d,"Remove",b.parentElement);WGUIEngine.ReorderColumn(d,b.parentElement);WG50Engine.ExecuteFlyPostback(c.Name,"ColumnChange",b);if(d.ColumnMenu!=null){d.ColumnMenu.Destroy();d.ColumnMenu=null}},RemoveColumnUI:function(b,m){var f=b.GetGrid();var j=b.Table;var c=b.GetElement();if(c==null){return}var l=c.parentElement;var a=j.GetElement(WG40.COLGROUP,null,l);var k=j.GetElement(WG40.BODY,WG40.HTMLTABLE,l);var g=c.cellIndex;c.removeNode(true);c.tblName=j.Id;if(j.Get("AllowAddNew")=="Yes"){var h=j.GetNewRow(l);h.cells[h.cells.length-1].colSpan-=1;h.nextSibling.cells[j.IsRootTable?0:1].colSpan-=1}if(j.IsRootTable&&j.Get("AllowFilter")=="Yes"){var e=j.GetFilterRow(l);e.cells[g+WGUIEngine.GetFreezeAdjustment(f)].removeNode(true);e.nextSibling.cells[0].colSpan-=1}b.Visible=false;b.ForceVisible=false;WGUIEngine.SynchronizeClientTemplate(j,"Remove",[g]);if(!m){var i=j.SortedColumns.GetNamedItem(b.Name);if(i){j.SortedColumns.Remove(i)}var d=j.FilteredColumns.GetNamedItem(b.Name);if(d){j.FilteredColumns.Remove(d,true);WGUIEngine.ProcessFilteredColumns(j)}}},GetFreezeAdjustment:function(a){if(a.FreezePaneActive&&a.FreezeConfig!=null){if(IS.ie){return a.FreezeConfig[0].length}else{return 0-a.FreezeConfig[0].length}}return 0},ChangeImage:function(a,b,c){if(c=="False"||!c){b.src=a.ResolveImagePathEx(a.LayoutSettings.ImageSettings.CollapseImage)}else{b.src=a.ResolveImagePathEx(a.LayoutSettings.ImageSettings.ExpandImage)}},ToggleGroupRow:function(d,f,g){var i,c;if(d){i=d.parentElement.parentElement;c=ISGetObject(WG50Engine.GetGridNameByRow(i));if(i.expanded=="False"){d.src=c.ResolveImagePathEx(c.LayoutSettings.ImageSettings.CollapseImage)}else{d.src=c.ResolveImagePathEx(c.LayoutSettings.ImageSettings.ExpandImage)}}else{i=f;c=ISGetObject(WG50Engine.GetGridNameByRow(i))}var h=WG50Engine.GetTable(i);if(i.expanded=="False"){var a;var b;i.expanded="True";i.setAttribute("expanded","True");if(!g){if(!ISEvent.Raise(c.LayoutSettings.ClientSideEvents.OnGroupExpand,c.Name,h.tblName,i.groupIndex,i.position,i.rowIndex,i)){return}}a=wgGetNextRow(h,i);if(a){b=a.type;if(!b){b="GroupHeader"}}else{b="GroupHeader"}if(b=="GroupHeader"||b=="GroupTotalRow"){var e=false;if(b=="GroupHeader"){while(a&&((a.type=="GroupTotalRow"||a.type=="GroupStatusRow")||(a.hasParent=="True"&&(parseFloat(a.groupIndex)-1==parseFloat(i.groupIndex))&&a.parentIndex==i.position))){e=true;if(a.type!="GroupStatusRow"){a.style.display=""}if(a&&a.type=="GroupHeader"&&a.expanded=="True"){a.expanded="False";WGUIEngine.ToggleGroupRow(null,a)}a=wgGetNextRow(h,a);while(a&&(a.type=="Record"||a.type=="PR"||a.type=="CSRecord"||(a.type=="GroupTotalRow"&&parseFloat(a.groupIndex)-1>parseFloat(i.groupIndex))||a.type=="HierRecord"||(a.type=="GroupHeader"&&parseFloat(a.groupIndex)-1>parseFloat(i.groupIndex)))){a=wgGetNextRow(h,a)}}}if(!e){if(i.childrenLoaded=="False"){WG50Engine.ExecuteFlyPostback(c.Name,"LoadGroup",i);return}}}else{if(b=="Record"){while(a&&(a.type=="Record"||a.type=="PR"||a.type=="CSRecord"||a.type=="HierRecord"||a.type=="GroupStatusRow")){if(a.type=="Record"||a.type=="PR"||a.type=="CSRecord"||a.type=="GroupStatusRow"){if(typeof(a.srLevel)!="undefined"){if(a.srLevel=="0"){a.style.display="";if(a.srExpanded=="True"){if(a.currentStyle.display!="none"){a.srExpanded="False";WGUIEngine.ToggleSelfRefRow(null,a)}}else{if(a.type!="CSRecord"){a.srExpanded="True";WGUIEngine.ToggleSelfRefRow(null,a)}}}}else{a.style.display=""}if(a.currentStyle.display!="none"){if(a.childExpanded=="True"){a.childExpanded="False";WGHierEngine.ToggleRow(null,a)}}}a=wgGetNextRow(h,a)}}}}else{var a;var b;i.expanded="False";i.setAttribute("expanded","False");if(!ISEvent.Raise(c.LayoutSettings.ClientSideEvents.OnGroupCollapse,c.Name,h.tblName,i.groupIndex,i.position,i.rowIndex,i)){return}a=wgGetNextRow(h,i);while(a){if(a.type=="GroupTotalRow"){if(a.groupIndex==i.groupIndex){break}}else{if(a.type=="GroupStatusRow"){a.style.display="none"}}if(a.groupIndex==i.groupIndex&&a.position!=i.position){break}else{if(parseFloat(a.groupIndex)<parseFloat(i.groupIndex)){break}else{if(a.rowState=="Added"||a.isGroupWorkaround){a=wgGetNextRow(h,a)}else{a.style.display="none";a=wgGetNextRow(h,a)}}}}}},PreFilterCheck:function(b){if((b.getAttribute("filterType")=="7"||b.getAttribute("filterType")=="10")&&b.cellValue!=""){if(b.filterText){var a=b.filterText.indexOf("and");if(a<1){alert("Incorrect Between parameters.\nBetween parameter formats: @Criteria1 and @Criteria2.\ne.g.1 and 10");return false}}}return true},OnFilterKeyDown:function(d){var b=WG50Engine.GetGridNameByRow(d.parentElement.parentElement);var g=WG50Engine.GetTableNameByRow(d.parentElement.parentElement);var c=ISGetObject(b);var f=c.Tables[g];var e=d.parentElement;var a=event;if(a.keyCode==115){WGMenuEngine.ShowFilterMenus(d.nextSibling);f.FilterMenu.RootMenu.Items[0].Select();a.keyCode=0;a.cancelBubble=true;a.returnValue=false}else{e.setAttribute("changed","true");a.cancelBubble=true}return false},OnFilterBlur:function(g){var h=g.parentElement;var f=WG50Engine.GetTable(h.parentElement);var e=wgGetGridById(f.gridId);var i=e.Tables[f.tblName];var b=i.GetColumn(h.colName);var d=b.GetFilterEditType();WG50Engine.EmulateAttributes(h);if(h.filterType=="0"&&h.cellValue!=""){if(b.DefaultFilterType=="NotSet"){if(d=="Checkbox"){var a=WGEditEngine.GetCheckBoxCell(h);if(a.checked){h.filterType="3"}}else{if(b.DataType=="System.String"){h.filterType="6"}else{h.filterType="3"}}}else{h.filterType=WGMenuEngine.GetFilterTypeInt(b.DefaultFilterType)}}if(h.filterType!="0"){h.filterText=h.cellValue;if(d!="Checkbox"){if(h.filterText==""&&!(parseFloat(h.filterType)>=12&&parseFloat(h.filterType)<=15)){h.filterType="0"}}}if(h.filterType!="0"){var c=i.FilteredColumns.GetNamedItem(b.Name);if(!c){c=new WebGridFilter();c.Name=c.ColumnMember=b.Name;i.FilteredColumns.Add(c)}else{if(c._UIState!="Added"){c._UIState="Changed"}c.FilterDisplayText=""}c.FilterText=h.filterText;c.FilterType=wg_Global.FilterTypeEnum[parseFloat(h.filterType)]}else{var c=i.FilteredColumns.GetNamedItem(b.Name);if(c){i.FilteredColumns.Remove(c,true)}}WGUIEngine.PreFilterCheck(h)},CreateErrorBox:function(){var a=document.createElement("DIV");a.className="WG5E-Box grid-dialog-error";a.style.display="none";a.innerHTML='<table class="WG5E-Frame1" cellspacing="0" cellpadding="4" width="780" border="0"><tr><td class="WG5E-Caption">Intersoft WebGrid Enterprise</td></tr><tr><td><table class="WG5E-Frame2" cellspacing="0" cellpadding="4" width="100%" border="0"><tr><td style="width: 39px"><img id="img_wgError" height="32" /></td><td id="wg_uhemsg"></td></tr></table></td></tr><tr height="100%"><td><div id="wg_ErrorMsg" style="overflow: auto; width: 100%; height: 100%"></div></td></tr><tr><td align="right"><button class="WG5E-Btn" onclick="wgCopyToCB(wg_ErrorMsg.innerText)" >Copy</button>&nbsp;<button onclick="WGUIEngine.CloseErrorBox()" class="WG5E-Btn">Close</button></td></tr></table>';document.body.appendChild(a);wg_Global.ErrorBox=a},CloseErrorBox:function(){wg_Global.ErrorBox.style.display="none"},DisplayErrorBox:function(h,f,b){if(!wg_Global.ErrorBox){WGUIEngine.CreateErrorBox()}var e=wg_Global.ErrorBox;e.style.width=(document.body.offsetWidth-50)+"px";e.style.height=(document.body.offsetHeight-50)+"px";e.style.left=e.style.top="20px";var k=document.getElementById("wg_ErrorMsg");if(f!=""&&f.toLowerCase().indexOf("<html")>-1){var a=IS.GetHtmlElement(f);f=a.innerHTML}k.innerHTML=f;document.getElementById("img_wgError").src=h.ResolveImagePathEx("wg_Error.gif");if(b){document.getElementById("wg_uhemsg").innerHTML=b}wg_Global.ErrorBox.style.display="";if(IS.moz||IS.IsXHTMLDocType()){var j=e.children[0];var i=j.rows[0].offsetHeight;var d=j.rows[1].offsetHeight;var g=j.rows[3].offsetHeight;var c=parseInt(j.rows[2].cells[0].currentStyle.paddingTop);if(isNaN(c)){c=0}c*=2;e.style.height=(document.body.clientHeight-50)+"px";k.style.height=(e.clientHeight-i-d-g-c)+"px";if(!h.UseCssFramework){e.style.border="tan 1px solid"}}},AutoFitColHeaders:function(d){var l=d.GetRootTable();var b=l.GetElement(WG40.COLHEADER,WG40.HTMLTABLE);var k=new Array();if(l.IsUseColumnSet){var h=b.rows[0];if(!h.csRowPos){h=b.rows[1]}k=wgGetColumnSetRows(h)}else{k[0]=b.rows[0]}wg_Global.NoDisplayUpdate=true;wg_Global.IsResizing=true;for(var e=0;e<k.length;e++){if(!k[e]){continue}for(var f=0;f<k[e].cells.length;f++){var a=k[e].cells[f];if(a.type=="Column"){WGUIEngine.SetColumnLabelWidth(a,a.offsetWidth);WGUIEngine.ResizeFilterColumn(l,k[e],a,a.offsetWidth,true)}}}wg_Global.NoDisplayUpdate=false;wg_Global.PendingUpdates=null;setTimeout("wg_Global.IsResizing=false",100)},FitColumns:function(J,y,E,D,a,H){var q=J.GetGrid();var r=ISPosLib.getWidth(q.FrameObj);var w=0;var B=0;var x=0;var h=0;var f=0;var o=parseInt(J.ColumnWidthDefault);var G=true;var z=r;if(!q.LayoutSettings.AutoFitColumns){return}if(q.FrameObj.offsetWidth==0&&q.FrameObj.offsetHeight==0&&q.FitColumnRetryCount>5&&!q.NeedAutoFitOnLoad){return}if((r==0||q.FrameObj.offsetWidth==0)&&!y){if(q.NeedAutoFitOnLoad){if(q.LayoutSettings.AutoWidth||q.FrameObj.style.width.indexOf("%")>-1){r=q.FrameObj.parentElement.clientWidth}else{r=parseFloat(q.FrameObj.style.width)}if(isNaN(r)){r=0}if(r==0&&q.FrameObj.parentElement.tagName=="FORM"){r=q.FrameObj.parentElement.parentElement.clientWidth;r-=(parseFloat(document.body.leftMargin)+parseFloat(document.body.rightMargin))}if(r==0&&z>100){r=z}G=(r==0);if(q.FitColumnRetryCount>4&&G){q.FrameObj.style.display="";q.NeedAutoFitOnLoad=false}}if(G){if(typeof(q.FitColumnRetryCount)=="undefined"){q.FitColumnRetryCount=0}q.FitColumnRetryCount++;setTimeout(function(){WGUIEngine.FitColumns(J,y,E,D,a,H)},100);return}}q.FitColumnRetryCount=0;var F=false;if(!J.IsUseColumnSet){var j=J.Columns;var b=J.GetAutoWidthColumn();var d=q.LayoutSettings.AutoColMinWidth;var c=false;if(b&&!b.Visible){b=null}for(var t=0;t<j.length;t++){var g=j[t];var u=false;var v=false;var s=J.GroupedColumns.GetNamedItem(g.Name);if(s){if(s._UIState=="Unchanged"){u=true}else{if(s._UIState=="Added"&&y=="Group"){v=true}}}if(g.ColumnType!="CheckBox"&&(g.Visible||v)&&!(u&&J.Get("HideColumnsWhenGrouped")=="Yes")){if((y=="Resize"||y=="Group")&&g.Name==E.colName){g.dontResizeTemp=true}g.dontResize=null;h++;if(b&&b.Name==g.Name){w+=d}else{if(g.Width!=""){w+=parseInt(g.Width)}else{w+=o}}}else{if(g.ColumnType=="CheckBox"){if(g.Visible){f+=parseInt(g.Width);g.dontResize=true}}else{g.dontResize=true}}}B=r-J.GetColumnGroupHeadersWidth()-f-(!q.HidePadColumn?16:0);if(J.SelfReferencingSettings.Enabled&&J.SelfReferencingSettings.IsTreeViewSelectionMode){B+=16}if(J.PreviewRowVisible){B-=16}if(!J.IsRootTable){B-=J.GetParentHeadersWidth()}if(y=="Resize"){B-=parseInt(E.style.width);w-=parseInt(E.style.width)}else{if(y=="Group"){if(J.Get("HideColumnsWhenGrouped")=="Yes"){w-=parseInt(E.style.width)}B-=16}else{if(y=="UngroupRestore"||y=="UngroupHide"){}else{if(y=="UngroupRestoreContext"){B+=16}else{if(y=="ColumnChange"){if(b){for(xcol in a){if(a[xcol]==b){c=true}}}}}}}}if(w==B-10&&!y){F=true}if(!F){if(b){if(w<B){b.fixedWidth=B-w+d;for(var t=0;t<j.length;t++){if(j[t]!=b&&!j[t].dontResize&&!j[t].dontResizeTemp){j[t].dontResizeTemp=true}}}else{b.fixedWidth=d;if(!c){B-=parseInt(b.Width);w-=parseInt(b.Width)}else{B-=d;w-=d}}}var e=null;var L=0;if(J.IsRootTable){e=J.GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0]}for(var t=0;t<j.length;t++){var g=j[t];var A=0;var I=0;if(!g.dontResize&&!g.dontResizeTemp){var l;if(g.Width!=""){l=parseInt(g.Width)}else{l=o}if(g.fixedWidth){I=parseInt(g.fixedWidth);g.fixedWidth=null}else{A=(l/w)*100;I=parseInt((A/100)*B)}L+=I;if(t==j.length-1){var C=B-L;if(I+C-2>16){I-=2}}var p=null;if(y&&!J.IsRootTable){var K;if(y!="SubTable"){if(y=="Remove"||y=="UngroupHide"||y=="ColumnChange"){K=E}else{K=E.parentElement}e=J.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,K).rows[0]}else{e=H.GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0]}}if(e){p=wgGetCellByName(e,g.Name)}if(I>2){if(p){WGUIEngine.ResizeColumn(J,p,I,null,true);if(!J.IsRootTable&&y=="Resize"){WGHierEngine.FitColumnsChild(J,p,I)}}else{if(g){g.Set("Width",I,true)}}}}else{if(g.dontResizeTemp){g.dontResizeTemp=null}}}if(y=="Resize"||!y){WGUIEngine.ReorderColumn(J)}}}else{var k=J.ColumnSets;var L=0;for(var t=0;t<k.length;t++){var m=k[t];if(m.Visible){if((y=="Resize")&&m.Position==E.pos){m.dontResizeTemp=true}m.dontResize=null;h++;var n=J.GetCSHeaderWidth(t);w+=n}}B=r-J.GetColumnGroupHeadersWidth()-16;if(w==B-6&&!y){F=true}if(!F){if(!J.IsRootTable){B-=J.GetParentHeadersWidth()}if(y=="Resize"){B-=parseInt(E.estWidth);w-=parseInt(E.estWidth)}if(J.IsRootTable){e=J.GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0]}for(var t=0;t<k.length;t++){var m=k[t];var A=0;var I=0;if(!m.dontResize&&!m.dontResizeTemp){var n;n=J.GetCSHeaderWidth(t);if(m.fixedWidth){I=parseInt(m.fixedWidth);m.fixedWidth=null}else{A=(n/w)*100;I=parseInt((A/100)*B)}L+=I;if(t==m.length-1){var C=B-L;if(I+C-2>16){I+=C-2}}var p=null;if(y&&!J.IsRootTable){var K;if(y!="SubTable"){K=E.parentElement;e=J.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,K).rows[0]}else{e=H.GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0]}}if(!p){p=new Object();p.type="CSHeader";p.pos=t;p.parentElement=e}if(p){if(I>2){WGUIEngine.ResizeColumn(J,p,I,null,true);if(!J.IsRootTable&&y=="Resize"){for(tableId in J.SubTableIds){WGUIEngine.FitColumns(J,"SubTable",null,null,null,J.SubTableIds[tableId])}}}wg_Global.ColSizeTarget=null;wg_Global.ColSizeTarget2=null}}else{if(m.dontResizeTemp){m.dontResizeTemp=null}}}}}if(q.NeedAutoFitOnLoad){q.FrameObj.style.display="";q.NeedHeightResize=true;WGUIEngine.AssignInitialHeight(q);q.NeedAutoFitOnLoad=false}wg_Global.ColSizeTarget=null;wg_Global.ColSizeTarget2=null},GetRadioValue:function(b){for(var a=0;a<b.length;a++){if(b[a].checked){return b[a]}}return null},GetPreviewRowExpandImageCell:function(a){var c=null;for(var b=0;b<a.cells.length;b++){WG50Engine.EmulateAttributes(a.cells[b]);if(a.cells[b].type=="PRExp"){c=a.cells[b];break}}return c},TogglePreviewRow:function(e){var l=null;var j=null;var d=null;if(e.tagName=="IMG"){l=e.parentElement;j=l.parentElement;d=e}else{j=e;l=WGUIEngine.GetPreviewRowExpandImageCell(j);d=l.childNodes[0];if(d&&d.tagName!="IMG"){d=null}}var f=wgGetPreviewRow(j);var b=WG50Engine.GetTable(j);var a=wgGetGridById(b.gridId);var k=a.Tables[b.tblName];var h=f.cells[0];if(l.expanded=="True"){var g=wgGetPreviewRowCell(f);if(g){g.childNodes[0].style.display="none"}if(d){d.src=a.ResolveImagePathEx(a.LayoutSettings.ImageSettings.PreviewRowCollapseImage)}l.expanded="False";l.setAttribute("expanded","False");g.style.height="1px";if(!IS.ie&&!IS.IsXHTMLDocType()){f.style.lineHeight="1px"}if(IS.IsXHTMLDocType()||(IS.ie&&IS.IsXHTMLDocType())){h.style.lineHeight="0px";h.style.paddingTop="0px";h.style.paddingBottom="0px"}if(!k.IsRootTable){for(var c=0;c<f.cells.length;c++){if(f.cells[c].style.height=="100%"){f.cells[c].style.height="1px"}}}}else{var g=wgGetPreviewRowCell(f);if(k.PreviewRowSettings.LoadOnDemand&&!g.loaded){WG50Engine.ExecuteFlyPostback(a.Name,"LoadPreviewRow",g);return}if(g){g.childNodes[0].style.display=""}if(d){d.src=a.ResolveImagePathEx(a.LayoutSettings.ImageSettings.PreviewRowExpandImage)}if(g.style.display!=""){g.style.display=""}l.expanded="True";l.setAttribute("expanded","True");if(l.eHeight){g.style.height=l.eHeight}else{g.style.height=""}if(!IS.ie){f.style.lineHeight=""}if(IS.IsXHTMLDocType()||(IS.ie&&IS.IsXHTMLDocType())){h.style.lineHeight="";h.style.paddingTop="";h.style.paddingBottom=""}if(!k.IsRootTable){for(var c=0;c<f.cells.length;c++){if(f.cells[c].style.height=="1px"){f.cells[c].style.height="100%"}}}}},GetSelfRefImage:function(a,c){var b=wgGetCellByName(c,a.SelfReferencingSettings.ExpandColumnMember);return b.childNodes[0].childNodes[0].childNodes[0]},GetSelfRefParent:function(c,d){if(d.srLevel=="0"){return d}var a=parseFloat(d.srLevel)-1;var b=wgGetPreviousRow(c,d);while(b){if(b.srLevel==a){return b}b=wgGetPreviousRow(c,b)}return null},ToggleSelfRefRow:function(f,i,j,q){var o,e,k;if(f){o=WG50Engine.GetTR(f);e=ISGetObject(WG50Engine.GetGridNameByRow(o));if(!o.srExpanded){o.srExpanded="False"}if(o.srExpanded=="False"){f.src=e.ResolveImagePathEx(e.LayoutSettings.ImageSettings.CollapseImage)}else{f.src=e.ResolveImagePathEx(e.LayoutSettings.ImageSettings.ExpandImage)}}else{o=i;e=ISGetObject(WG50Engine.GetGridNameByRow(o));if(!o.srExpanded){o.srExpanded="False"}}var l=WG50Engine.GetTable(o);k=e.Tables[l.tblName];var d=k.SelfReferencingSettings.ExpandColumnMember;WG50Engine.EmulateAttributes(o);if(o.srExpanded=="False"){var c;var p=parseFloat(o.srLevel);if((o.srRC=="0"&&!k.SelfReferencingSettings.LoadOnDemand)||o.srRC==-1||(f&&f.parentElement.style.visibility=="hidden")){return}if(!ISEvent.Raise(k.Layout.ClientSideEvents.OnSelfRefRowExpand,e.Id,k.Id,o.rowIndex,o)){return}if(!f){var b=WGUIEngine.GetSelfRefImage(k,o);if(b){b.src=e.ResolveImagePathEx(e.LayoutSettings.ImageSettings.CollapseImage)}}if(k.SelfReferencingSettings.LoadOnDemand&&(f||q)&&o.srRC=="0"){WG50Engine.ExecuteFlyPostback(e.Name,"LoadSelfRefChild",o);return}o.srExpanded="True";c=wgGetNextRow(l,o);var h=false;var a=false;var g=false;if(typeof(event)=="object"&&event&&event.shiftKey){g=true}while(c){WG50Engine.EmulateAttributes(c);if(c.type=="GroupHeader"||(c.srLevel==p&&(c.type!="HierRecord"&&c.type!="CSRecord"&&c.type!="PR"))){break}if((!g&&c.srLevel==p+1)||(g&&c.srLevel>=p+1)){if(c.type=="HierRecord"&&c.expanded!="True"){}else{c.style.display="";if(g&&c.type=="Record"){var b=WGUIEngine.GetSelfRefImage(k,c);if(b){b.src=e.ResolveImagePathEx(e.LayoutSettings.ImageSettings.CollapseImage);c.srExpanded="True"}}}if(!g&&c.srExpanded=="True"){c.srExpanded="False";WGUIEngine.ToggleSelfRefRow(null,c)}a=true}else{if(c.srLevel==p){if(a){h=true}}}if(h){break}c=wgGetNextRow(l,c)}if(k.SelfReferencingSettings.FitColumnOnExpand){var n=k.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,o).rows[0];var m=wgGetCellByName(n,d);WGUIEngine.ResizeBestFit(m);if(f){WGUIEngine.AutoFitColumns(e.Name)}}}else{var c;var p=parseFloat(o.srLevel);o.srExpanded="False";if(!f&&q){var b=WGUIEngine.GetSelfRefImage(k,o);if(b){b.src=e.ResolveImagePathEx(e.LayoutSettings.ImageSettings.ExpandImage)}}if(!ISEvent.Raise(k.Layout.ClientSideEvents.OnSelfRefRowCollapse,e.Id,k.Id,o.rowIndex,o)){return}c=wgGetNextRow(l,o);while(c){WG50Engine.EmulateAttributes(c);if(c.type=="GroupHeader"||(c.srLevel==p&&c.type!="HierRecord"&&c.type!="CSRecord"&&c.type!="PR")){break}if(c.srLevel>=p+1){c.style.display="none"}c=wgGetNextRow(l,c)}}o.setAttribute("srExpanded",o.srExpanded)},RowCheckerClicked:function(f,c){if(f.tagName=="INPUT"&&f.type=="checkbox"&&!f.chkHandler){f.onclick=function(){WGUIEngine.RowCheckerChanged(null,f)}}var i=WG50Engine.GetTD(f);var j=i.parentElement;var h=WG50Engine.GetTable(j);var b=wgGetGridById(h.gridId);if(c){var g=0;var a=0;var d=b.LastChkBox;var e=0;if(d){e=WG50Engine.GetTD(d).parentElement.rowIndex}if(j.rowIndex>e){g=e;a=j.rowIndex}else{g=j.rowIndex+1;a=e}WGUIEngine.SetRowsCheck(h,g,a,!f.checked)}b.LastChkBox=f},SetRowCheck:function(h,a){var d=WG50Engine.GetTable(h);var c=wgGetGridById(d.gridId);var i=c.Tables[d.tblName];var g=i.GetRowCheckerColumn();var f=wgGetCellByName(h,g);var b=f.getElementsByTagName("INPUT")[0];if(typeof(a)=="undefined"){a=!b.checked}WGUIEngine.RowCheckerClicked(b);var e=b.checked;b.checked=a;WGUIEngine.RowCheckerChanged(c,b,e)},RowCheckerChanged:function(c,d,a){var b=WG50Engine.GetTD(d);var g=b.parentElement;var f=WG50Engine.GetTable(g);if(c==null){c=wgGetGridById(f.gridId)}var e=c.Tables[f.tblName];if(!d.disabled){g.isRowChecked=d.checked}if(c.LastSelObj&&!wgIsSameRow(c.LastSelObj.GetRowElement(),g)){WGEventEngine.RedrawSelectedRowBorder(g,d.checked?"CheckedRow":"Clear")}c.CheckedRowContext=g;if(c.LayoutSettings.RestoreRowSelection!="Disabled"){if(!d.checked){e.Storage.SelectedRows.Remove(g)}}if(!ISEvent.Raise(c.LayoutSettings.ClientSideEvents.OnCheckBoxClick,f.gridId,f.tblName,wgGetColNameByCell(b),d.checked,a)){return}},CheckBoxHeaderClick:function(b){var e=WG50Engine.GetTDorTH(b);var f=e.parentElement;var d=WG50Engine.GetTable(f);var a=wgGetGridById(d.gridId);var c=a.Tables[d.tblName];WGUIEngine.SetRowsCheck(c.GetElement(WG40.BODY,WG40.HTMLTABLE,f),0,null,b.checked);WG50Engine.SetCheckedRowsData(a)},SetRowsCheck:function(h,f,b,a){if(typeof(f)=="undefined"){f=0}if(h){WG50Engine.EmulateAttributes(h)}var c=wgGetGridById(h.gridId);var g=c.Tables[h.tblName];var d=h.rows[f];var e=g.GetRowCheckerColumn();while(d){WG50Engine.EmulateAttributes(d);if(d.type=="Record"){WGUIEngine.SetRowCheck(d,a)}d=wgGetNextRow(h,d);if(d&&b&&d.rowIndex==b){break}}},OnStyleChanged:function(b){var e=event.type;var a=event.srcElement;if(a.tagName=="IMG"){a=a.parentElement}if(a.tagName=="TD"&&IS.GetAttr(a,"type")=="Command"&&!a.disabled){if(!IS.ie&&typeof(a.disabled)=="undefined"&&IS.GetAttr(a,"disabled")=="disabled"){return}if(e=="mouseover"||e=="mouseup"){DynamicStyleEngine.SetToOverStyle(null,b.LayoutSettings.StatusBarCommandStyle,a)}else{if(e=="mouseout"){var d=IS.GetAttr(a,"istoggle");var c=IS.GetAttr(a,"pushed");if(d=="1"&&c=="1"){DynamicStyleEngine.SetToActiveStyle(null,b.LayoutSettings.StatusBarCommandStyle,a)}else{DynamicStyleEngine.SetToStyle(null,b.LayoutSettings.StatusBarCommandStyle,a)}}else{if(e=="mousedown"){DynamicStyleEngine.SetToActiveStyle(null,b.LayoutSettings.StatusBarCommandStyle,a)}}}}else{if(e=="mousedown"&&a.tagName=="TD"&&b.IsUnhandledError){WGUIEngine.DisplayErrorBox(b,b.LastError,b.GetString("MessageBoxText/UnhandledError"))}}},MoveWebCombosToBody:function(c){for(var b=0;b<c.WebCombos.length;b++){if(typeof(wcGetComboById)!="function"){break}c.WebCombos[b].Id=c.WebCombos[b].Id.replace(/\$/g,"_");var a=wcGetComboById(c.WebCombos[b].Id);if(a){a.FrameObj.style.display="none";document.body.insertAdjacentElement("beforeEnd",a.FrameObj)}}},MoveWebCombosToFrame:function(c){for(var b=0;b<c.WebCombos.length;b++){if(typeof(wcGetComboById)!="function"){break}c.WebCombos[b].Id=c.WebCombos[b].Id.replace(/\$/g,"_");var a=wcGetComboById(c.WebCombos[b].Id);if(a){a.FrameObj.style.display="none";c.FrameObj.insertAdjacentElement("beforeEnd",a.FrameObj)}}},UnfreezePane:function(b){if(b.FreezePaneActive&&b.FrozenColumns!=null){for(var c=0;c<b.FrozenColumns.length;c++){var a=b.FrozenColumns[c];if(a.IsFrozen){a.IsFrozen=false;a.ShowInSelectColumns=a.Original_ShowInSelectColumns;a.AllowGrouping=a.Original_AllowGrouping}}WGUIEngine.SetFreezeScrollBarPosition(b,0,null,null,true);WGUIEngine.FormatFreezePane(b,null,null,null,true);setTimeout(function(){b.FreezePaneActive=false;b.FrozenColumns=null;b.FreezeConfig=null;b.LayoutSettings.FreezePaneSettings.ActiveFrozenColumns=0},50)}},DetermineScrollBarSize:function(a){var b=null;WGUIEngine.SetTempContent("<div style='width:100px;height:100px;overflow:scroll'><div style='width:200px;height:200px'></div></div>");WGUIEngine.SetTempContentVisibility(true);b=WGUIEngine.GetTempContent();a.ScrollBarSize=b.offsetHeight-b.clientHeight+2;WGUIEngine.SetTempContentVisibility(false);WGUIEngine.ClearTempContent()},FreezePane:function(l,n,c,j){var h=l.LayoutSettings.FreezePaneSettings;var a=h.ActiveFrozenColumns;var d=l.RootTable.Columns;var k=[];var f=null;if(typeof(c)=="number"){a=c}if(n){f=l.GetFreezeOuterDivElement();if(a==0){return false}if(h.MaxFrozenColumns!=0&&a>h.MaxFrozenColumns){if(!h.SuppressErrorMessage){alert("Freeze Pane cannot be activated because it has exceeded the value specified in MaxFrozenColumns.")}h.ActiveFrozenColumns=0;return false}if(d[a]==null||d[a].GetScrollWidth()>(f.scrollWidth/2)){if(f.scrollWidth==0){setTimeout(function(){WGUIEngine.FreezePane(l,n,c,true)},50)}else{if(!h.SuppressErrorMessage){alert("Freeze Pane cannot be activated on this column because it has exceeded the maximum size of scrollable viewport.")}h.ActiveFrozenColumns=0;return false}}}if(a>0){for(var m=0;m<d.length;m++){var b=d[m];if(b.Visible){b.IsFrozen=true;b.Original_ShowInSelectColumns=b.ShowInSelectColumns;b.ShowInSelectColumns="No";if(l.LayoutSettings.HideColumnsWhenGrouped=="Yes"){b.Original_AllowGrouping=b.AllowGrouping;b.AllowGrouping="No"}k.push(b)}if(k.length==a){break}}}if(k.length>0){l.FrozenColumns=k}if(n){l.FreezeConfig=null;l.FreezePaneActive=false;if(j){WGUIEngine.InvalidateFreezeContainer(l)}if(f&&f.scrollLeft>0){l.SkipFreezeLayout=true;WGUIEngine.SetFreezeScrollBarPosition(l,0,true,null,true);l.SkipFreezeLayout=false}var e=l.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);if(e.scrollLeft>0){e.scrollLeft=0}if(IS.moz){for(var m=0;m<d.length;m++){var b=d[m];if(b.Visible&&b.HiddenFromView){b.HiddenFromView=false;b.HiddenReason=""}}}WGUIEngine.FormatFreezePane(l);WGUIEngine.RefreshFreezeConfig(l)}},FormatFreezePane:function(o,t,w,e,r){var n=o.LayoutSettings.FreezePaneSettings;var a=n.ActiveFrozenColumns;var u=false;var p="";var b="";if(typeof(e)=="number"){a=e}if(typeof(t)!="undefined"&&t!=null){u=t}if(!r){p="double 3px "+n.SplitterLineColor;b="solid "+n.SplitterLineWidth+"px "+n.SplitterLineColor}if(a>0){if(!u){var x=o.RootTable.GetElement(WG40.COLHEADER,WG40.HTMLTABLE);var d=o.GetLastFrozenColumn();var f=d.GetElement();var y=o.RootTable.GetElement(WG40.BODY,WG40.HTMLTABLE);if(f==null){return}var h=f.currentStyle;if(!r){if(!f.original_borderRight){f.original_borderRight=h.borderRightStyle+" "+h.borderRightWidth+" "+h.borderRightColor}}else{p=f.original_borderRight}f.style.borderRight=p;if(n.ShowSplitterLine){for(var q=0;q<y.rows.length;q++){var v=y.rows[q];WG50Engine.EmulateAttributes(v);if(wgIsRecordRow(v)){var c=v.cells[f.cellIndex];var k=c.currentStyle;if(!r){c.original_borderRight=k.borderRightStyle+" "+k.borderRightWidth+" "+k.borderRightColor}else{b=c.original_borderRight}c.style.borderRight=b}}}o.FreezePaneActive=true}else{var d=o.GetLastFrozenColumn();var f=d.GetElement();if(n.ShowSplitterLine){for(var q=0;q<w.length;q++){var v=w[q];WG50Engine.EmulateAttributes(v);if(wgIsRecordRow(v)){var c=v.cells[f.cellIndex];var k=c.currentStyle;if(!r){c.original_borderRight=k.borderRightStyle+" "+k.borderRightWidth+" "+k.borderRightColor}else{b=c.original_borderRight}c.style.borderRight=b}}}if(o.FreezePaneActive&&o.FreezeConfig!=null){if(!IS.ie){for(var q=0;q<w.length;q++){var v=w[q];for(var s=0;s<o.FreezeConfig[0].length;s++){var l=o.FreezeConfig[0][s];var m=l.GetElement().cellIndex;v.cells[m].style.display="none"}}}}}}},InvalidateFreezeContainer:function(f){if(f.LayoutSettings.AllowColumnFreezing=="Yes"&&f.CurrentViewMode=="GridView"){var e=f.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);var b=f.GetFreezeDivElement();var c=f.GetFreezeOuterDivElement();if(f.TotalRows==0){var d=f.RootTable.GetElement(WG40.COLHEADER,WG40.HTMLDIV);b.style.width=d.scrollWidth+"px"}else{var a=e.scrollWidth+WGUIEngine.GetFrozenHiddenTotalWidth(f);if(a!=0&&a>e.offsetWidth){b.style.width=a+"px"}else{b.style.width=""}}c.style.height=f.ScrollBarSize;if(IS.moz){b.style.height=f.ScrollBarSize+"px"}else{b.style.height="100%"}}},GetFrozenColumnsTotalWidth:function(d){var c=d.LayoutSettings.FreezePaneSettings;var a=d.GetLastFrozenColumn();var b=a.GetElement();return ISPosLib.getLeft(b)+b.offsetWidth},GetFrozenHiddenTotalWidth:function(a){if(a.FreezeConfig==null){return 0}var b=a.FreezeConfig[0];var d=0;for(var c=0;c<b.length;c++){d+=b[c].GetWidth()}return d},DetermineFreezeState:function(e){var f=[];var o=[];var b=e.GetFreezeOuterDivElement();var c=e.LayoutSettings.FreezePaneSettings;var k=b.scrollLeft;var d=WGUIEngine.GetFrozenColumnsTotalWidth(e);var n=d+k;var m=c.ActiveFrozenColumns;var a=e.RootTable.Columns;var h=false;while(d<n){var l=a[m];if(l==null){break}if(l.IsFrozen){m++;continue}if(!l.HiddenFromView&&l.Visible){f[f.length]=l}if(l.Visible){d+=l.GetWidth()}m++;h=true}for(var j=m;j<a.length;j++){var l=a[j];if(l.Visible&&l.HiddenFromView){o[o.length]=l}}return[f,o]},RefreshFreezeConfig:function(d){var b=d.RootTable.Columns;var e=[];var j=[];var c=d.LayoutSettings.FreezePaneSettings;var h=d.GetLastFrozenColumn();for(var f=h.Position+1;f<b.length;f++){var a=b[f];if(a.Visible){if(a.HiddenFromView){e[e.length]=a}else{j[j.length]=a}}}d.FreezeConfig=[e,j]},OnFreezeScroll:function(){var a=this;if(a.SkipFreezeLayout){return}if(a.FreezeScrollId>0){clearTimeout(a.FreezeScrollId);a.FreezeScrollId=0}if(a.FreezeScrollImmediate||a.LayoutSettings.FreezePaneSettings.ActiveFrozenColumns==0){WGUIEngine._OnFreezeScroll(a)}else{a.FreezeScrollId=setTimeout(function(){WGUIEngine._OnFreezeScroll(a)},50)}a.FreezeScrollImmediate=false},ProcessFreezeLayout:function(a,e,c,h){a.SkipFreezeLayout=true;var j=WGUIEngine.DetermineFreezeState(a);if(e){j=a.FreezeConfig}var b=j[0];var f=j[1];if(!e||(e&&c!=null)){for(var d=0;d<b.length;d++){b[d].HideFrozen(c)}}if(!e||(e&&h!=null)){for(var d=f.length-1;d>-1;d--){f[d].Show(h)}}WGUIEngine.RefreshFreezeConfig(a);a.SkipFreezeLayout=false},_OnFreezeScroll:function(e,c){var d=e.LayoutSettings.FreezePaneSettings;var h=WGUIEngine.GetFreezeScrollBarPosition(e);var b=e.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);if(e.SkipFreezeLayout&&!c){return}if(e.LastEditObj){e.ExitEditMode()}if(d.ActiveFrozenColumns==0){if(b.scrollSource!="OnTableScroll"){b.scrollSource="_OnFreezeScroll";b.scrollLeft=h;setTimeout(function(){b.scrollSource=null},10);if(e.TotalRows==0){WG50Engine.OnTableScroll(e,true,h)}}}else{WGUIEngine.ProcessFreezeLayout(e);if(c){e.SkipFreezeLayout=true}if(e.LayoutSettings.FreezePaneSettings.AbsoluteScrolling){var i=0;var a=h-e.LastFreezeScroll;var f=false;if((IS.ie&&((a>=7&&a<=10)||(a<=-7&&a>=-10)))||(IS.moz&&(a==10||a==-10))){f=true}else{if(IS.safari&&((a>=40&&a<=43)||(a<=-40&&a>=-43))){f=true}else{i=h}}if(f){if(a>0){i=WGUIEngine.GetFreezeVisibleColumnOffset(e,0)+10;WGUIEngine.SetFreezeScrollBarPosition(e,i,true)}else{i=WGUIEngine.GetFreezeVisibleColumnOffset(e,0)-WGUIEngine.GetFrozenHiddenTotalWidth(e)-2;WGUIEngine.ScrollFreezePaneToDirection(e,"Left")}}if(IS.safari&&i<0){i=e.LastFreezeScroll}e.LastFreezeScroll=i}if(!IS.ie){var j=e.RootTable.GetElement(WG40.BODY,WG40.HTMLTABLE);WG50Engine.ResizeTable(j,true)}ISEvent.Raise(e.LayoutSettings.ClientSideEvents.OnScroll,e.Id);if(h==0&&b.offsetWidth>b.scrollWidth&&(e.FreezeConfig==null||(e.FreezeConfig!=null&&e.FreezeConfig[0].length>0))){WGUIEngine.InvalidateFreezeContainer(e)}}},SetFreezeScrollBarPosition:function(c,f,h,e,d,a){var b=c.GetFreezeOuterDivElement();if(h){WGUIEngine.SkipFreezeLayout(c)}if(e){f+=WGUIEngine.GetFreezeScrollBarPosition(c)}if(d){c.FreezeScrollImmediate=true}b.scrollLeft=f;if(IS.safari){WGUIEngine._OnFreezeScroll(c)}if(a){WGUIEngine._OnFreezeScroll(c,true)}},SkipFreezeLayout:function(a,b){if(!b){b=5}a.SkipFreezeLayout=true;setTimeout(function(){a.SkipFreezeLayout=false},b)},GetFreezeScrollBarPosition:function(b){var a=b.GetFreezeOuterDivElement();return a.scrollLeft},IsFreezeContainerValid:function(b){var a=b.RootTable.GetElement(WG40.BODY,WG40.HTMLDIV);return a.scrollWidth>a.offsetWidth},GetFreezeVisibleColumnOffset:function(b,f){if(b.FreezePaneActive&&b.FreezeConfig!=null){var e=b.FreezeConfig[1];var c=WGUIEngine.GetFrozenHiddenTotalWidth(b);var h=0;if(e.length>f){for(var d=0;d<f;d++){var a=e[d];h+=a.GetWidth()}}if(c>0){c-=10}return c+h}return -1},FormatFreezeRows:function(b,c){if(b.FreezePaneActive&&b.FrozenColumns!=null){var a=null;if(typeof(c.length)!="undefined"){a=c}else{a=[c]}WGUIEngine.FormatFreezePane(b,true,a)}},ScrollChildView:function(c,e){for(var d=0;d<c.RootTable.ChildTables.length;d++){var a=c.RootTable.ChildTables[d];var f=a.SubTableIds[0];var b=f.GetContainer();b.style.position="relative";b.style.left=0-e}},ScrollFreezePaneToDirection:function(b,a){var d=WGUIEngine.GetFreezeVisibleColumnOffset(b,0);if(a=="Right"){d+=20}else{if(b.FreezeConfig[0].length>0){var c=b.FreezeConfig[0][b.FreezeConfig[0].length-1];d-=c.GetWidth()}}WGUIEngine.SetFreezeScrollBarPosition(b,d,false,false,true)},ScrollFreezePaneAbsolute:function(k,a){var c=wgGetColNameByCell(a);var n=k.RootTable;var b=n.Columns.GetNamedItem(c);if(b.HiddenFromView||b.IsOutsideScrollView()){var h=k.GetLastFrozenColumn();var j=0;var m=b.GetScrollWidth();var f=k.GetFreezeOuterDivElement();var e=m-(f.offsetWidth-WGUIEngine.GetFrozenHiddenTotalWidth(k));for(var l=h.Position+1;l<b.Position;l++){var d=n.Columns[l];j+=d.GetWidth();if(j>e){break}}WGUIEngine.SetFreezeScrollBarPosition(k,j,false,false,true)}},RefreshColGroupWidth:function(g,c){var h=g.GetElement(WG40.BODY,WG40.HTMLTABLE);var a=h.children[0];for(var e=0;e<c.childNodes.length;e++){var b=c.childNodes[e];b.width=a.childNodes[e].width}var d=c.parentElement;var f=d.style.width;d.style.width="90%";setTimeout(function(){d.style.width=f},10)},ToggleFilter:function(f,d){var b=f.Grid;var a=null;if(typeof(d)!="undefined"){a=d}else{a=!f.IsFilterDisabled()}if(!IS.ie&&WGUIEngine.IsCommandDisabled()){return}if(!a){f.FilterState="Enabled";f.FilteredColumns.Clear();f.FilteredColumns.CopyFrom(f._LastFilters);WGUIEngine.SetFilterStatusIndicator(b,"Enabled");WGUIEngine.ProcessFilteredColumns(f,true);WG50Engine.ExecuteFlyPostback(b.Id,"ColumnFilter",f.Name)}else{f.FilterState="Disabled";f._LastFilters.Clear();f._LastFilters.CopyFrom(f.FilteredColumns);WGUIEngine.SetFilterStatusIndicator(b,"Disabled");for(var c=0;c<f.FilteredColumns.length;c++){var e=f.FilteredColumns[c];f.FilteredColumns.Remove(e,true)}WGUIEngine.ProcessFilteredColumns(f,true);WG50Engine.ExecuteFlyPostback(b.Id,"ColumnFilter",f.Name)}},SetFilterStatusIndicator:function(c,e,a){var b=WG50Engine.GetCommandElement(c,"FilterStatus",0);var d=c.ResolveImagePath(c.GetImagesFolder(),(e=="Disabled"?c.LayoutSettings.ImageSettings.UnfilteredImage:c.LayoutSettings.ImageSettings.FilteredImage));var f=c.GetString("CommonText/"+(e=="Disabled"?"Unfiltered":"Filtered"));var h=c.GetString("Tooltip/"+(e=="Disabled"?"RestoreFilters":"RemoveFilters"));if(a){h=c.GetString("Tooltip/NoFilter")}b.pushed=(e=="Disabled"?"0":"1");if(b.pushed=="0"){DynamicStyleEngine.SetToStyle(null,c.LayoutSettings.StatusBarCommandStyle,b)}else{DynamicStyleEngine.SetToActiveStyle(null,c.LayoutSettings.StatusBarCommandStyle,b)}b.setAttribute("pushed",b.pushed);WGUIEngine.SetCommandAttribute(b,d,f,h,a)},SetCommandAttribute:function(a,d,f,g,e){if(a==null){return}var c=wgGetActiveGrid();var h=false;if(c!=null){var b=ISGetObject(c);h=b.UseCssFramework}if(d&&f){if(!h){a.innerHTML="<img src='"+d+"' align=absmiddle />"+(f?"&nbsp;"+f:"")}else{a.childNodes[1].textContent=" "+f}}else{if(f){a.innerHTML=(f?"&nbsp;"+f:"")}}if(g){a.title=g}if(typeof(e)!="undefined"){a.disabled=e;if(!IS.ie&&!e){a.removeAttribute("disabled")}if(e){if(a.pushed!="1"){var c=wgGetActiveGrid();if(c!=null){var b=ISGetObject(c);if(b!=null){DynamicStyleEngine.SetToStyle(null,b.LayoutSettings.StatusBarCommandStyle,a)}}}a.style.cursor="default"}else{a.style.cursor="pointer"}if(a.children.length>0&&a.children[0].tagName=="IMG"){if(e){a.children[0].style.cssText="filter: gray(); opacity: 0.5"}else{a.children[0].style.cssText=""}}}},SetCommandPushed:function(b,d,e,c){var a=WG50Engine.GetCommandElement(b,d,e);if(a==null){return}a.pushed=(c?"1":"0");a.setAttribute("pushed",a.pushed);if(a.pushed=="0"){DynamicStyleEngine.SetToStyle(null,b.LayoutSettings.StatusBarCommandStyle,a)}else{DynamicStyleEngine.SetToActiveStyle(null,b.LayoutSettings.StatusBarCommandStyle,a)}},IsCommandDisabled:function(a){if(!IS.ie){var b=a;if(!b){b=event.srcElement}if(b!=null&&b.tagName!="TD"){b=b.parentElement}if(b!=null&&typeof(b.disabled)!="undefined"&&IS.GetAttr(b,"disabled")=="disabled"){return true}else{if(b!=null&&typeof(b.disabled)=="boolean"&&b.disabled){return true}}}return false},UpdateDataStatus:function(a,g,f,b){var c=0;var e=0;var d=0;if(g){e=parseFloat(ISXml.GetNodeText(g,"//totalRows"));d=parseFloat(ISXml.GetNodeText(g,"//totalLoadedRows"))}else{if(b){c=d=b[0];e=b[1]}}if(a.LayoutSettings.PagingMode=="None"){c=e}else{c=parseFloat(a.LayoutSettings.VirtualPageSize)}if(f){c=d}if(e<c){c=e}a.Set("TotalLoadedRows",c,true);a.Set("TotalRows",e,true);if(a.IsClassicPaging()){WGPageEngine.InvalidatePagingArgs(a,g)}else{a.SetStatus2("","loaded",c,e)}},ApplyIntelligentPosition:function(b,a,c){return ISPosLib.ApplyIntelligentPosition(b,a,c)},IsWebGridElement:function(c,b){var f=false;for(var d=0;d<c.EditControls.length;d++){if(b==c.EditControls[d]||c.EditControls[d].contains(b)){f=true;break}}if(!f){for(var d=0;d<IS.RuntimeWindowPopups.length;d++){var a=IS.RuntimeWindowPopups[d]._e;if(a!=null&&a.contains(b)){f=true;break}}}return f}};var WGDataEngine={PrepareFilter:function(a,d,b,c){d.setAttribute("action","ColumnFilter");d.setAttribute("tblName",c);a.SetStatus1("","filtertext","CommonText/FilterText");return true},PrepareCustomAction:function(b,f,c){f.setAttribute("action","Custom");var d=true;try{d=wgPrepareCustomAction(b,f,c)}catch(a){}return d},PrepareLoadSelfReferencingChild:function(b,i,d,h){var c=WG50Engine.GetTable(h);var g;i.setAttribute("action","LoadSelfRefChild");i.setAttribute("tblName",c.tblName);i.setAttribute("parentValue",h.parentValue);try{var f=b.Tables[c.tblName].GetParentRow(h);g=WGHierEngine.PrepareXmlInfo(b,i,f)}catch(a){}b.SetStatus1("","loadsrchild","CommonText/LoadSelfRefChild");return true},PrepareButtonClick:function(c,h,e,f){var b=WG50Engine.GetTD(f);var g=b.parentElement;var d=WG50Engine.GetTable(g);var a=wgGetColNameByCell(b);h.setAttribute("action","ButtonClick");h.setAttribute("tblName",d.tblName);h.setAttribute("colName",a);h.setAttribute("keyValue",f.keyValue);return true},PrepareRowChanged:function(a,f,c,d){var e=d;var b=WG50Engine.GetTable(e);f.setAttribute("action","RowChanged");f.setAttribute("tblName",b.tblName);f.setAttribute("keyValue",e.keyValue);return true},PrepareRefresh:function(c,f,d){if(c.LastEditObj){c.ExitEditMode()}if(c.CurrentViewMode!="GridView"){setTimeout(function(){c.ChartInteractiveUI.RefreshChart()},10);return false}f.setAttribute("action","Refresh");f.setAttribute("tblName",c.GetRootTable().Id);if(IS.moz){if(!c.RootTable.IsUseColumnSet&&c.RootTable.Columns.length>0){var b=c.RootTable.Columns[0];try{b.Resize(b.Width)}catch(a){}}}c.SetStatus1("","refresh","CommonText/Refresh");return true},PrepareRefreshAll:function(a,c,b){c.setAttribute("action","RefreshAll");c.setAttribute("tblName",a.GetRootTable().Id);a.SetStatus1("","refreshall","CommonText/RefreshAll");return true},PrepareGroup:function(d,i,f,b,a){i.setAttribute("action",a);i.setAttribute("columnName",b.colName);i.setAttribute("tblName",b.tblName);var h="";var g=true;try{if(!b.gridId){b.gridId=d.Id}g=WGHierEngine.PrepareAction(b,i)}catch(c){}if(!g){return false}if(a=="Group"){h="Grouping"}else{if(a=="Ungroup"){h="Ungrouping"}else{if(a=="ChangeGroup"){h="Changing group"}}}d.SetStatus1("",a.toLowerCase(),"CommonText/"+a);d.LastRequestObj=b;return true},PrepareMore:function(a,e,c){var d=parseFloat(a.TotalRows);var b=parseFloat(a.TotalLoadedRows);if(b>=d){return false}e.setAttribute("action","More");e.setAttribute("startRow",b);e.setAttribute("count",a.LayoutSettings.VirtualPageSize);a.SetStatus1("","more","CommonText/More");return true},PrepareLoadGroup:function(b,g,c,f,e){var d=f;var a="";a=WGUIEngine.GetGroupParentIndex(f);g.setAttribute("action","LoadGroup");g.setAttribute("position",f.position);g.setAttribute("groupIndex",f.groupIndex);g.setAttribute("parentPos",a);if(e){g.setAttribute("startIndex",e)}b.SetStatus1("","loadgroup","CommonText/LoadGroup");return true},PrepareColumnSort:function(b,g,c,f){g.setAttribute("action","ColumnSort");g.setAttribute("columnName",f.colName);g.setAttribute("tblName",f.tblName);var d=true;try{if(!f.gridId){f.gridId=b.Id}d=WGHierEngine.PrepareAction(f,g)}catch(a){}if(!d){return false}b.SetStatus1("","sort","CommonText/Sort");return true},PrepareColumnChange:function(b,g,c,f){g.setAttribute("action","ColumnChange");g.setAttribute("columnName",f.colName);g.setAttribute("tblName",f.tblName);var d=true;try{if(!f.gridId){f.gridId=b.Id}d=WGHierEngine.PrepareAction(f,g)}catch(a){}if(!d){return false}b.SetStatus1("","columnchange","CommonText/ColumnChange");return true},PrepareExport:function(d,m,i,a){m.setAttribute("action","Export");var c="";var l="";var b="";var j=null;if(!a){var e=d.ExportContext.RootMenu;var g=e.GetSelectedItemByGroup("Target");var h=e.GetSelectedItemByGroup("Type");var f=e.GetSelectedItemByGroup("Orientation");if(g.Name=="mnuRoot"){l=d.GetRootTable().Name}else{l=e.MenuControl.Table.Name;j=d.Tables[l].GetParentRow(d.LastSelObj.GetRowElement())}c=h.Name.substring(8);b=f.Name.substring(3);a=[l,c,b,j]}l=a[0];c=a[1];b=a[2];var k=d.Tables[l];if(!k.IsRootTable){WGHierEngine.PrepareXmlInfo(d,m,a[3]);m.setAttribute("IsChildTable","True")}m.setAttribute("tblName",l);m.setAttribute("exportType",c);m.setAttribute("exportOrientation",b);d.SetStatus1("","export","CommonText/ExportText");return true},PrepareLoadPreviewRow:function(b,k,d,g){var j=wgGetRootRow(g.parentElement);var c=WG50Engine.GetTable(j);var i=b.Tables[c.tblName];var h=i.ToRowObject(j);k.setAttribute("action","LoadPreviewRow");k.setAttribute("position",h.Position);k.setAttribute("groupIndex",j.groupIndex);k.setAttribute("parentPos",h.ParentPos);k.setAttribute("tblName",c.tblName);try{var f=i.GetParentRow(j);result=WGHierEngine.PrepareXmlInfo(b,k,f)}catch(a){}b.SetStatus1("","loadpreviewrow","CommonText/LoadPreviewRow");return true},ResponseLoadPreviewRow:function(c,f){var a="";try{a=ISXml.GetNodeText(f,"//htmlString")}catch(b){}var d=c.LastRequestObj;d.loaded=true;d.children[0].innerHTML=a;WGUIEngine.TogglePreviewRow(wgGetRootRow(d.parentElement));c.SetStatus1("","ready","CommonText/Ready")},ResponseButtonClick:function(a,b){a.SetStatus1("","ready","CommonText/Ready")},ResponseLoadSelfReferencingChild:function(f,y){var c="";try{c=ISXml.GetNodeText(y,"//htmlString")}catch(d){}var l=f.Tables[ISXml.GetNodeText(y,"//tblName")];var s=f.LastRequestObj;var m=l.GetElement(WG40.BODY,WG40.HTMLTABLE,s);var n=m.tBodies[m.tBodies.length-1];if(c!=""){var x=parseFloat(ISXml.GetNodeText(y,"//totalRows"));WGUIEngine.SetTempContent("<table>"+c+"</table>");var k=WGUIEngine.GetTempContent();var a=0;if(l.PreviewRowVisible){s=wgGetPreviewRow(s)}if(l.RowLayout=="ColumnSet"){s=wgGetLowestColumnSetRow(s)}var v=k.rows.length;var w=parseFloat(s.srLevel);for(var g=0;g<v;g++){var j=n.appendChild(k.rows[0]);m.moveRow(j.rowIndex,s.rowIndex+g+1);WG50Engine.EmulateAttributes(j);if(w+1==j.srLevel){j.style.display=""}}s.srRC=x;if(l.SelfReferencingSettings.FitColumnOnExpand){var p=l.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,s).rows[0];var o=wgGetCellByName(p,l.SelfReferencingSettings.ExpandColumnMember);WGUIEngine.ResizeBestFit(o)}if(l.IsRootTable){if(!f.IsClassicPaging()){var q=parseFloat(f.TotalLoadedRows);var u=parseFloat(f.TotalRows);u+=x;q+=x;f.Set("TotalLoadedRows",q,true);f.Set("TotalRows",u,true);f.SetStatus2("","loaded",q,u)}}}else{var h=WGUIEngine.GetSelfRefImage(l,s);h.style.visibility="hidden";s.srRC=0}s.srExpanded="True";if(l.RowLayout=="ColumnSet"){var b=wgGetColumnSetRows(s);for(var g=0;g<b.length;g++){b[g].srExpanded="True";b[g].srRC=s.srRC}}f.SetStatus1("","ready","CommonText/Ready");WGUIEngine.ClearTempContent()},ResponseFilter:function(d,g){var a=ISXml.GetNodeText(g,"//htmlString");var f=d.Tables[ISXml.GetNodeText(g,"//tblName")];var b=f.GetElement(WG40.BODY,WG40.HTMLDIV);var e=new WebGridPartOption();if(ISXml.GetNodeText(g,"//isRootTable")=="True"){WG50Engine.UnregisterGridBody(d);e.Body=true;IS.SetOuterHTML(b,a);WG50Engine.RegisterRootTableBehaviour(d);var c=ISXml.GetNodeText(g,"//footerString");if(c!=""){WGUIEngine.UpdateColumnFooter(d,f,null,c);e.Footer=true}WGUIEngine.ClearInvalidSelection(d,f);WG50Engine.OnViewChanged(f,"ColumnFilter",e)}WGUIEngine.UpdateDataStatus(d,g);d.ClearChildTables();d.SetStatus1("","ready","CommonText/Ready")},ResponseRefresh:function(h,l){var k=h.Tables[ISXml.GetNodeText(l,"//tblName")];var a=ISXml.GetNodeText(l,"//action");var d=h.LastRequestObj;var j=new WebGridPartOption();if(ISXml.GetNodeText(l,"//isRootTable")=="True"){var f=k.GetElement(WG40.BODY,WG40.HTMLDIV);var c=k.GetElement(WG40.COLHEADER,WG40.HTMLDIV);var e=ISXml.GetNodeText(l,"//colHtmlString");var b=ISXml.GetNodeText(l,"//bodyHtmlString");WG50Engine.UnregisterGridBody(h);j.Body=true;IS.SetOuterHTML(f,b);WG50Engine.RegisterRootTableBehaviour(h);var g=ISXml.GetNodeText(l,"//footHtmlString");if(g!=""){WGUIEngine.UpdateColumnFooter(h,k,null,g);j.Footer=true}WG50Engine.OnViewChanged(k,a,j);WGUIEngine.UpdateDataStatus(h,l,true);var i=WG50Engine.IsSelectedObjectValid(h.LastSelObj);if((i&&h.LastSelObj.GetRowElement().type!="NewRow")||!i){h.ActiveEditCell=h.LastSelObj=null}h.ClearChildTables()}h.SetStatus1("","ready","CommonText/Ready")},ResponseRefreshAll:function(h,u){var t=ISXml.GetNodeText(u,"//tableXmlState");var q=h.RootTable;var l=new WebGridTable();var m=ISXml.CreateXmlDocument();var r="\\$~CD";var p=new RegExp(r,"g");t="<RootTable"+t.substring(13);t=t.substring(0,t.length-15)+"</RootTable>";ISXml.LoadXml(m,t.replace(p,"]]"));ISXml.RemoveNode(h.XmlNode,"RootTable");var n=ISXml.GetNode(m,"RootTable");if(IS.safari){n=n.cloneNode(true)}h.XmlNode.appendChild(n);h.Tables=[];l.XmlNode=n;l.Parent=h;IS.SetPropertiesRecursive(l,n);h.RootTable=l;h.UpdateState();if(h.AllowPivotCharting){if(h.ChartContainer!=null&&h.ChartInteractiveUI!=null){h.ChartInteractiveUI.OnUnload();h.ChartInteractiveUI.UnloadButtons()}h.ChartContainer=null}WGUIEngine.MoveWebCombosToBody(h);try{if(h.CustomEditors!=null){for(var k=0;k<q.Columns.length;k++){var c=q.Columns[k];if(c.EditType=="Custom"&&c.CustomEditorName=="WebInputNET"){h.CustomEditors.WebInputNET.ImplementationObject.OnRefresh(c.XmlNode.getAttribute("CustomEditorServerId"))}}for(var g in h.CustomEditors){var d=h.CustomEditors[g];if(d.Name=="WebInputNET"){d.ImplementationObject.OnUnload()}}}}catch(f){}WG50Engine.UnregisterGrid(h);var j=ISXml.GetNodeText(u,"//gridHtmlString");h.FrameObj.parentElement.outerHTML=j;h.FrameObj=document.getElementById(h.Name+IS.FrameSuffix);wg_Global.Resizer=null;wg_Global.Dragger=null;wg_Global.ColPointer=null;h.Resizer=null;h.ColPointer=null;h.TBObj=h.TBMLObj=h.LastEditObj=null;h.ActiveEditCell=h.LastSelObj=null;h.LastAutoFitWidth=-1;h.CalDDObj=null;h.ClearActionElement(true);if(h.LayoutSettings.AutoFitColumns){if(h.LayoutSettings.AutoFitColumnsBuffering){h.FrameObj.style.display="none";h.NeedAutoFitOnLoad=true;if(h.FrameObj.style.width.indexOf("%")==-1&&h.FrameObj.style.height.indexOf("%")==-1){wgAutoFitColumns(h.Id)}}else{wgAutoFitColumns(h.Id)}}WGUIEngine.MoveWebCombosToFrame(h);WG50Engine.RegisterFrameBehaviour(h);WG50Engine.RegisterRootTableBehaviour(h);WG50Engine.RegisterStatusBarBehaviour(h);WG50Engine.OnViewChanged(h.RootTable,"RefreshAll");if(h.AllowPivotCharting){var o=h.CurrentViewMode;h.ChartInitialized=false;h.CurrentViewMode="";setTimeout(function(){if(o=="PivotChartView"){h.SwitchToPivotChartView()}else{h.SwitchToGridView()}},10)}if(IS.moz){WGMozEngine.FormatRootTable(h)}if(h.IsClassicPaging()&&h.LayoutSettings.PagingStyleUI=="Slider"){WGPageEngine.SlideID=0;WGPageEngine.Tooltip=null;WGPageEngine.DestroySliderBar(h);WGPageEngine.CreateSliderBar(h)}var s=h.Tables[ISXml.GetNodeText(u,"//tblName")];var a=ISXml.GetNodeText(u,"//action");var b=h.LastRequestObj;if(ISXml.GetNodeText(u,"//isRootTable")=="True"){WGUIEngine.UpdateDataStatus(h,u);h.ClearChildTables()}h.NeedHeightResize=true;WG50Engine.OnResize();h.SetStatus1("","ready","CommonText/Ready")},ResponseGroup:function(n,s){var q=n.Tables[ISXml.GetNodeText(s,"//tblName")];var a=ISXml.GetNodeText(s,"//action");var g=n.LastRequestObj;if(ISXml.GetNodeText(s,"//isRootTable")=="True"){var r=g.parentElement;var k=q.GetElement(WG40.BODY,WG40.HTMLDIV,r);var d=q.GetElement(WG40.COLHEADER,WG40.HTMLDIV,r);var h=ISXml.GetNodeText(s,"//colHtmlString");var b=ISXml.GetNodeText(s,"//bodyHtmlString");var m=ISXml.GetNodeText(s,"//footHtmlString");WG50Engine.UnregisterGridBody(n);IS.SetOuterHTML(k,b);WG50Engine.RegisterRootTableBehaviour(n);if(a=="Group"||a=="Ungroup"||a=="ColumnChange"){if(h!=""){d.outerHTML=h}if(IS.moz){WGMozEngine.FormatRootTable(n)}try{var c=q.GetElement(WG40.COLFOOTER,WG40.HTMLDIV,r)}catch(l){}if(c&&m!=""){c.outerHTML=m}}WG50Engine.OnViewChanged(q,"ColumnGroup");WGUIEngine.UpdateDataStatus(n,s);n.ClearChildTables()}else{for(var o=0;o<q.SubTableIds.length;o++){var p=q.SubTableIds[o];var j=ISXml.GetNodeText(s,"//htmlString_"+p.SubId);var f=p.GetContainer();f.innerHTML=j;if(IS.moz){WGMozEngine.FormatChildTable(p)}WG50Engine.FixGroupAlignment(q,p);WG50Engine.OnViewChanged(q,"ColumnGroup",null,p)}n.ClearChildTables(q.Id)}if((q.IsRootTable||n.LastSelObj&&q.Id==n.LastSelObj.tblName)&&a!="ChangeGroup"){n.ActiveEditCell=n.LastSelObj=null}if(n.FromContextMenu){n.FromContextMenu=false;WGUIEngine.AutoFitColumns(n.Name)}n.SetStatus1("","ready","CommonText/Ready")},ResponseColumnSort:function(d,h){var g=d.Tables[ISXml.GetNodeText(h,"//tblName")];if(g.IsRootTable){var b=ISXml.GetNodeText(h,"//htmlString");var c=g.GetElement(WG40.BODY,WG40.HTMLDIV);if(ISXml.GetNodeText(h,"//isRootTable")=="True"){WG50Engine.UnregisterGridBody(d);IS.SetOuterHTML(c,b);WG50Engine.RegisterRootTableBehaviour(d);WG50Engine.OnViewChanged(g,"ColumnSort")}WGUIEngine.UpdateDataStatus(d,h);d.ClearChildTables()}else{for(var e=0;e<g.SubTableIds.length;e++){var f=g.SubTableIds[e];var b=ISXml.GetNodeText(h,"//htmlString_"+f.SubId);var a=f.GetContainer();a.innerHTML=b;WG50Engine.OnViewChanged(g,"ColumnSort",null,f);if(IS.moz){WGMozEngine.FormatChildTable(f)}WG50Engine.FixGroupAlignment(g,f)}d.ClearChildTables(g.Id)}WGUIEngine.ClearInvalidSelection(d,g);d.SetStatus1("","ready","CommonText/Ready")},ResponseMore:function(d,h){var b=ISXml.GetNodeText(h,"//htmlString");var f=d.Tables[ISXml.GetNodeText(h,"//tblName")];var g=f.GetElement(WG40.BODY,WG40.HTMLTABLE);WGUIEngine.SetTempContent("<table>"+b+"</table>");var e=WGUIEngine.GetTempContent();var a=0;var c=e.rows[0];if(d.FreezePaneActive&&d.FrozenColumns!=null){WGUIEngine.FormatFreezePane(d,true,e.rows)}g.appendChild(e.tBodies[0]);WG50Engine.OnOperationCompleted(f,"More",c);d.Set("TotalLoadedRows",parseFloat(ISXml.GetNodeText(h,"//endRow")),true);d.SetStatus2("","loaded",ISXml.GetNodeText(h,"//endRow"),ISXml.GetNodeText(h,"//totalRows"));d.SetStatus1("","ready","CommonText/Ready");WGUIEngine.ClearTempContent()},ResponseLoadGroup:function(c,q){var a=ISXml.GetNodeText(q,"//htmlString");var k=c.Tables[ISXml.GetNodeText(q,"//tblName")];var l=k.GetElement(WG40.BODY,WG40.HTMLTABLE);var p=c.LastRequestObj;var f=p.fullPath;if(f!=""){f+="_"}var h=document.getElementById("dvs_"+c.Id+"_"+f+p.position);if(h!=null){Listener.Unload(h.children[0]);h.parentElement.parentElement.removeNode(true)}WGUIEngine.SetTempContent("<table>"+a+"</table>");var j=WGUIEngine.GetTempContent();var b=j.rows[0];var m=document.getElementById("ty_"+c.Id+"_"+f+p.position);if(c.FreezePaneActive&&c.FrozenColumns!=null){WGUIEngine.FormatFreezePane(c,true,j.rows)}if(IS.ie&&IS.IsXHTMLDocType()){var o=j.tBodies[0].childNodes.length;for(var d=0;d<o;d++){m.appendChild(j.tBodies[0].childNodes[0])}for(var d=0;d<m.children.length;d++){var g=m.children[d];WG50Engine.EmulateAttributes(g);if(!g.type){m.removeChild(g);d--}}}else{m.appendChild(j.tBodies[0]);m.childNodes[m.childNodes.length-1].removeNode(false)}p.childrenLoaded="True";p.expanded="False";WGUIEngine.ToggleGroupRow(null,p,true);var e=ISXml.GetNodeText(q,"//loadedRows");var o=ISXml.GetNodeText(q,"//totalRows");WG50Engine.OnOperationCompleted(k,"LoadGroup",b,[e,o,p]);var n=parseFloat(ISXml.GetNodeText(q,"//count"))+parseFloat(c.TotalLoadedRows);var p=c.TotalRows;if(n>p){n=p}c.Set("TotalLoadedRows",n,true);c.SetStatus2("","loaded",n,p);c.SetStatus1("","ready","CommonText/Ready");WGUIEngine.ClearTempContent()},ResponseExport:function(c,i){var h=ISXml.GetNodeText(i,"//status");if(h=="Ok"){var b=ISXml.GetNodeText(i,"//outputFile");var e=ISXml.GetNodeText(i,"//htmlTitle");var g="The report window is currently blocked by the browser's pop-up blocker feature.\nPlease disable pop-up blocker for this site or click on the Information Bar and allow the file download.";if(b.indexOf(".xls")>0||b.indexOf(".tif")>0||b.indexOf(".rtf")>0){var f=window.open(null,null,c.ExportWndAttr);if(f){var a=f.document;a.open("text/html","replace");a.write("<html><title>"+(e==""?"WebGrid.NET Enterprise Report":e)+"</title><body style='margin:0' scroll='no'><iframe style='width:100%;height:100%' src='"+b+"'></iframe></body></html>");a.close()}else{alert(g)}}else{var f=window.open(b,null,c.ExportWndAttr);if(!f){alert(g)}}}c.SetStatus1("","ready","CommonText/Ready")}};function wgGetNextRow(b,a){return WG50Engine.GetNextRow(b,a)}function wgGetPreviousRow(b,a){return WG50Engine.GetPreviousRow(b,a)}function wgAutoFitColumns(a,b){return WGUIEngine.AutoFitColumns(a,b)}function wgFlushUpdates(){if(wg_Global.PendingUpdates){var e=wg_Global.PendingUpdates;for(var d=0;d<e.length;d++){var a=e[d];a.style.width=a.offsetWidth+"px";WGUIEngine.SetColumnLabelWidth(a);var g=a.parentElement;var c=WG50Engine.GetTable(g);var b=wgGetGridById(c.gridId);var f=b.Tables[c.tblName];WGUIEngine.ResizeFilterColumn(f,g,a,a.offsetWidth)}wg_Global.PendingUpdates=null}wg_Global.NoDisplayUpdate=false}function wgGetCSHeaderWidth(g,c){var j=c.parentElement;var b=g.GetColumnSetByPos(c.pos);var a=g.GetElement(WG40.COLHEADERGROUP,null,j);var e=g.GetColHeaderSpanCount()+g.GetCSHeaderCellPosByIndex(c);var f=e+parseInt(b.ColumnCount);var k=0;for(var d=e;d<f;d++){var h=a.childNodes[d].offsetWidth;if(h==0){h=a.childNodes[d].width}if(isNaN(h)){h=0}k+=parseInt(h)}return k}function plGetCurX(){if(event){return event.clientX+document.body.scrollLeft}}function plGetCurY(){if(event){return event.clientY+document.body.scrollTop}}function wgRefresh(a,c){var b=ISGetObject(a);if(!b.Enabled){return}if(!c){c=false}if(!c){WG50Engine.ExecuteFlyPostback(a,"Refresh")}else{WG50Engine.ExecuteFlyPostback(a,"RefreshAll")}}function wgLoadMore(a){var b=ISGetObject(a);if(!b.Enabled){return}var c=b.GetRootTable();if(c.GroupedColumns.length>0){alert(b.GetString("MessageBoxText/LoadMoreException"));return}WG50Engine.ExecuteFlyPostback(a,"More")}function wgExport(b){var a=ISGetObject(b);WGMenuEngine.ShowExportMenu(a)}function wgPrint(a){window.print()}function wgToggleFilter(b){var a=ISGetObject(b);WGUIEngine.ToggleFilter(a.RootTable)}function wgGetNextFocusableElement(d,b,c){var a=d.FrameObj;var e;var f=false;var g=false;if(IS.ie){a=a.parentElement}if(b){if(!c){e=document.all[a.sourceIndex-1]}else{e=document.all[c.sourceIndex-1]}}else{if(!c){e=a.nextSibling}else{e=document.all[c.sourceIndex+1]}}while(e){if((e.tagName=="DIV"&&e.id.substring(0,4)=="dvMF")||e.tagName=="INPUT"||e.tagName=="SELECT"||e.tagName=="TEXTAREA"||e.tagName=="BUTTON"){var h=false;if(e.tagName=="INPUT"&&e.type=="hidden"){h=true}if(e.disabled||e.style.display=="none"||e.style.visible=="hidden"){h=true}if(!h){return e}}if(!b){if(e.sourceIndex<(f?a.sourceIndex-1:document.all.length-1)){e=document.all[e.sourceIndex+1]}else{if(!f){f=true;e=document.all[0]}else{e=null}}}else{if(e.sourceIndex>(g?a.sourceIndex+1:1)){e=document.all[e.sourceIndex-1]}else{if(!g){g=true;e=document.all[document.all.length-1]}else{e=null}}}}return null}function wgGetPrevFocusableElement(a){return wgGetNextFocusableElement(a,true)}function wgCopyToCB(a){if(IS.ie){window.clipboardData.setData("Text",a)}else{WGMozEngine.CopyToClipboard(a)}}function wgDisplayErrorBox(c,b,a){WGUIEngine.DisplayErrorBox(c,b,a)}function wgCheckBoxHeaderClick(a){return WGUIEngine.CheckBoxHeaderClick(a)}function _wgCHResize(a){var b;if(a){b=a}else{b=event.srcElement}if(wg_Global.NoDisplayUpdate){if(b.tagName=="TD"&&b.type=="Column"&&b.isSorted=="False"){if(!wg_Global.PendingUpdates){wg_Global.PendingUpdates=new Array()}var g=wg_Global.PendingUpdates;var c=false;for(var f=0;f<g.length;f++){if(g[f]==b){c=true;break}}if(!c){g[g.length]=b}return}}if(b.tagName=="TD"&&b.type=="Column"&&!wg_Global.IsResizing){b.style.width=b.offsetWidth+"px";wg_Global.IsResizing=true;WGUIEngine.SetColumnLabelWidth(b);var j=b.parentElement;var e=wg_getTable(j);var d=wgGetGridById(e.gridId);var h=d.Tables[e.tblName];WGUIEngine.ResizeFilterColumn(h,j,b,b.offsetWidth);wg_Global.IsResizing=false}}function WebGridUIDestructor(){delete WGUIEngine;delete WGDataEngine;window.detachEvent("onunload",WebGridUIDestructor);IS.RegisterUnloadVariables("WGEventEngine");IS.RegisterUnloadVariables("WGDataEngine")}window.attachEvent("onunload",WebGridUIDestructor);if(typeof(Sys)!="undefined"){Sys.Application.notifyScriptLoaded()};