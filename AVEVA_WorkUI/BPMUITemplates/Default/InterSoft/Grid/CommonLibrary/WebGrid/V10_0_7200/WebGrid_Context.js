if(typeof(wg_Global)=="undefined"){wg_Global=new Array()}var ColumnHeaderStruct={SortAsc:[0,wg_Global.SortAscImage,"sortasc"],SortDesc:[1,wg_Global.SortDescImage,"sortdesc"],Sep0:[2],GroupByThisField:[3,wg_Global.GroupImage,"groupby"],GroupByBox:[4,wg_Global.GroupByBoxImage,"groupbybox"],Sep1:[5],RemoveColumn:[6,wg_Global.RemoveColumnImage,"removecolumn"],BestFit:[7,wg_Global.BestFitImage,"bestfit"],FilterBar:[8,wg_Global.FilterRowImage,"filterrow"],Sep2:[9],FreezePane:[10,wg_Global.FreezePaneImage,"freeze"],UnfreezePane:[11],Sep3:[12],ClearFilter:[13],FilterColumns:[14],Sep4:[15],SelectColumns:[16,wg_Global.SelectColumnImage,"selectcolumns"]};var RowStruct={AddNewRow:[wg_Global.NewRowImage,"newrow"],PasteToNewRow:[wg_Global.PasteImage,"paste"],Sep6:[],CopySelection:[wg_Global.CopyImage,"copy"],CopyCell:[wg_Global.CopyImage,"toolbar-copy"],CopyRow:[wg_Global.CopyImage,"toolbar-copy"],CopyTable:[wg_Global.CopyImage,"toolbar-copy"],PasteMultipleRows:[wg_Global.PasteImage,"paste"],Sep0:[],Update:[wg_Global.UpdateImage,"update"],Cancel:[wg_Global.CancelImage,"cancel"],UndoChanges:[wg_Global.UndoChangesImage,"undo"],UndoSelection:[wg_Global.UndoChangesImage,"undo"],Sep10:[],ReviewChanges:[wg_Global.ReviewChangesImage,"reviewchanges"],AcceptAllChanges:[wg_Global.AcceptAllChangesImage,"acceptallchanges"],UndoAllChanges:[wg_Global.UndoAllChangesImages,"undoallchanges"],Sep1:[],ShowChildRows:[wg_Global.ShowChildImage,"drillinto"],HideChildRows:[wg_Global.HideChildImage,"drillout"],Sep2:[],Edit:[wg_Global.EditImage,"edit"],Delete:[wg_Global.DeleteImage,"deleterow"],DeleteSelection:[wg_Global.DeleteImage,"deleterow"],Sep3:[],Expand:[],ExpandAll:[],Collapse:[],CollapseAll:[],Sep4:[],PerformAdd:[wg_Global.UpdateImage,"update"],CancelAdd:[wg_Global.DeleteImage,"cancel"],Sep5:[],ApplyFilter:[wg_Global.ApplyFilterImage,"applyfilter"],ClearFilter:[wg_Global.ClearFilterImage,"clearfilter"],Sep7:[],GotoFilterRow:[wg_Global.FilterRowImage,"filterrow"],ClearFilterCell:[wg_Global.ClearFilterImage,"clearfilter"],Sep8:[],Refresh:[wg_Global.RefreshImage,"grid-icon-refresh"],LoadMore:[wg_Global.LoadMoreImage,"more"],Export:[wg_Global.ExportImage,"export"],Sep9:[],Help:[wg_Global.HelpImage,"help"]};var WGMenuEngine={RegisterColumnContextMenu:function(p){var b=null;var f=p.GetGrid();var e=f.LayoutSettings.ImageSettings.Folder;var d=p.Columns;var o="";b=new WebContextMenu(f.Id+"_Header_"+p.Name);b.Grid=f;WGMenuEngine.ApplyDefaultStyle(b);var m=b.RootMenu.Items;var n=b.RootMenu;for(var r in ColumnHeaderStruct){var h=ColumnHeaderStruct[r];if(r.indexOf("Sep")>-1){m.Add(new WebMenuSeparatorItem("mnu"+r))}else{var l=new WebMenuItem("mnu"+r,f.GetString("ContextMenu/Column/"+r),f.ResolveImagePath(f.GetImagesFolder(),(h[1]?h[1]:"")),WGMenuEngine.ColumnMenuClick,null,"webui-icon webui-"+h[2]);if(r=="SortAsc"||r=="SortDesc"){l.Type="Radio"}else{if(r=="GroupByBox"||r=="FilterBar"){l.Type="CheckBox"}}m.Add(l)}m[m.length-1].IsBuiltIn=true}if(!f.LayoutSettings.FreezePaneSettings.ShowInContextMenu||!p.IsRootTable){m.Remove(n.GetItem("mnuSep2"));m.Remove(n.GetItem("mnuFreezePane"));m.Remove(n.GetItem("mnuUnfreezePane"))}if(!f.LayoutSettings.AutoFilterSuggestion||!p.IsRootTable){m.Remove(n.GetItem("mnuSep3"));m.Remove(n.GetItem("mnuClearFilter"));m.Remove(n.GetItem("mnuFilterColumns"))}var j=n.GetItem("mnuFilterColumns");if(j!=null){j.Items.Add(new WebMenuSeparatorItem())}var k=m.GetNamedItem("mnuSelectColumns");var c=k.Items;for(var g=0;g<d.length;g++){var q="";if(d[g].ShowInSelectColumns=="Yes"){o=d[g].Caption;if(o.indexOf("<")>=0&&o.indexOf(">")>=0){o=d[g].Name}var a=new WebMenuItem("mnuCol_"+d[g].Name,o);a.ColumnName=d[g].Name;a.Type="CheckBox";if(d[g].Visible){a.Checked=true}else{if(p.GroupedColumns.GetNamedItem(d[g].Name)!=null){a.Enabled=false}}c.Add(a)}}c.Add(new WebMenuSeparatorItem());c.Add(new WebMenuItem("mnuApplyChanges",f.GetString("ContextMenu/Column/ApplyChanges"),"",WGMenuEngine.ApplyColumnChange));c.Add(new WebMenuItem("mnuReset",f.GetString("ContextMenu/Column/Reset"),"",WGMenuEngine.ResetColumn));p.ColumnMenu=b},ColumnMenuClick:function(a){switch(a.Name){case"mnuSortAsc":WGMenuEngine.SortColumn(this,"ASC");break;case"mnuSortDesc":WGMenuEngine.SortColumn(this,"DESC");break;case"mnuGroupByThisField":WGMenuEngine.GroupColumn(this);break;case"mnuGroupByBox":WGMenuEngine.ToggleGroupByBox(this);break;case"mnuRemoveColumn":WGMenuEngine.RemoveColumn(this);break;case"mnuBestFit":WGMenuEngine.BestFitColumn(this);break;case"mnuFilterBar":WGMenuEngine.ToggleFilterBar(this);break;case"mnuFreezePane":WGMenuEngine.FreezePane(this);break;case"mnuUnfreezePane":WGMenuEngine.UnfreezePane(this);break;case"mnuClearFilter":WGMenuEngine.FilterMenuClearThis(a);break}},ApplyDefaultStyle:function(a){var c=a.MenuStyleSettings;var b=a.Grid;a.MenuWindowType="Normal";a.MenuAnimation=a.Grid.LayoutSettings.ContextMenuAnimation;a.MenuDropShadow=true;a.SkipAlpha=true;a.DrawImageBackground=true;a.AnimationInterval=20;a.OnRootMenuClosed=WGMenuEngine.MenuClosed;a.UseCssFramework=b.UseCssFramework;a.ImagesDirectory=a.Grid.LayoutSettings.ImageSettings.Folder;if(b.UseCssFramework){c.FrameStyle="common-menu";c.ItemStyle=new DynamicStyle("common-menu-item","common-menu-item hover");c.DisabledItemStyle=new DynamicStyle("common-menu-item disabled","common-menu-item disabled hover");c.CheckedItemStyle=new DynamicStyle("common-menu-checkeditem","common-menu-checkeditem hover");c.SeparatorStyle="common-menu-separator";c.BackgroundStripStyle="common-menu-strip";c.BackgroundStripColor="";c.BackgroundStripColor2="";a.MenuDropShadow=false}else{c.FrameStyle="Menu-FrameStyle";c.ItemStyle=new DynamicStyle("Menu-ItemStyle-Normal","Menu-ItemStyle-Over");c.DisabledItemStyle=new DynamicStyle("Menu-DisabledItemStyle-Normal","Menu-DisabledItemStyle-Over");c.CheckedItemStyle=new DynamicStyle("Menu-CheckedItemStyle-Normal","Menu-CheckedItemStyle-Over");c.SeparatorStyle="Menu-Separator";c.BackgroundStripStyle="Menu-Strip";c.BackgroundStripColor="E9EEEE";c.BackgroundStripColor2=""}c.UseSmartWebResources=a.Grid.UseWebResourcesForClient;c.Parent=a},MenuClosed:function(b){if(b){var a=b.MenuControl.Grid;if(a){WG50Engine.FocusGrid(a,true);if(a.ActionBoxShown){a.ClearActionElement();a.ActionBoxShown=false}}}},GetLocationX:function(a){return a.X+(!IS.ie&&parseInt(window.screenLeft)>0?window.screenLeft:0)+3},GetLocationY:function(a){return(!IS.ie&&parseInt(window.screenTop)>0?window.screenTop:0)+a.Y},GetLocation:function(a){return new OffsetLocation(WGMenuEngine.GetLocationX(a),WGMenuEngine.GetLocationY(a))},ShowContextMenu:function(d,c,g,i,f,a){var e=new OffsetLocation();var b=10;if(IS.moz){b=100}if(a){e=a}else{e.X=event.clientX;e.Y=event.clientY+(IS.safari?3:0)}doHideWindowPopups();if(event){d.HeaderContext=event.srcElement}if(!IS.ie||IS.ie10){var h=d.GetString("CommonText/Ready");if(h==""){setTimeout(function(){WGMenuEngine.ShowContextMenu(d,c,g,i,f,e)},10);return}}switch(i){case"Column":setTimeout(function(){WGMenuEngine.ShowColumnContextMenu(c,g,e,f)},b);break;case"GroupColumn":setTimeout(function(){WGMenuEngine.ShowColumnContextMenu(c,true,e,f)},b);break;case"Cell":case"GroupCell":case"FilterColumn":setTimeout(function(){WGMenuEngine.ShowRowMenus(null,null,c,e)},b);break}},ShowColumnContextMenu:function(e,m,n,B){var d;var k,F;if(m){k=ISGetObject(e.gridId);F=k.Tables[e.tblName];d=F.Columns.GetNamedItem(e.colName)}else{d=WG50Engine.GetColumnByElement(e);k=d.GetGrid();F=k.Tables[d.Table.Id]}if(F.ColumnMenu==null||F.ColumnMenu.Items.length==0){WGMenuEngine.RegisterColumnContextMenu(F)}if(k.LastEditObj){k.ExitEdit()}WGMenuEngine.ResetAndClearCustomMenus(F.ColumnMenu,true);var c=F.ColumnMenu;var C=c.RootMenu;var y=C.GetItem("mnuSortAsc");var z=C.GetItem("mnuSortDesc");var u=C.GetItem("mnuGroupByThisField");var t=C.GetItem("mnuGroupByBox");var q=C.GetItem("mnuFilterBar");var v=C.GetItem("mnuRemoveColumn");var w=C.GetItem("mnuSelectColumns");var o=C.GetItem("mnuBestFit");var x=C.GetItem("mnuSep2");var s=C.GetItem("mnuFreezePane");var A=C.GetItem("mnuUnfreezePane");var p=C.GetItem("mnuClearFilter");var r=C.GetItem("mnuFilterColumns");if(m&&!F.IsRootTable){d.AltElement=e}wg_Global.ColumnContext=d;wg_Global.EventContext=event;if(m||d.Get("AllowSorting")=="Yes"){y.Enable();z.Enable()}else{y.Disable();z.Disable()}y.SetText(k.GetString("ContextMenu/Column/SortAsc"+WG50Engine.GetSimpleType(d)));z.SetText(k.GetString("ContextMenu/Column/SortDesc"+WG50Engine.GetSimpleType(d)));if(m||d.Get("AllowGrouping")=="Yes"){u.Enable()}else{u.Disable()}if(d.IsGrouped||m){u.SetText(k.GetString("ContextMenu/Column/UngroupField"))}else{u.SetText(k.GetString("ContextMenu/Column/GroupByThisField"))}if(!k.LayoutSettings.GroupByBox.ContextMenu){t.Disable()}if(F.Get("AllowFilter")!="Yes"){q.Hide()}if(F.Get("AllowSelectColumns")=="Yes"&&!F.IsUseColumnSet){if(d.ShowInSelectColumns=="Yes"){v.Enable()}else{v.Disable()}w.Enable();for(var l=0;l<w.Items.length;l++){var D=w.Items[l];var g=F.Columns.GetNamedItem(D.ColumnName);if(g!=null){D.SetChecked(g.Visible,true)}}}else{v.Disable();w.Disable()}if(m){v.Disable();o.Disable();w.Disable()}if(k.LayoutSettings.AllowColumnFreezing=="Yes"&&k.LayoutSettings.FreezePaneSettings.ShowInContextMenu){if(F.IsRootTable){if(k.FreezePaneActive){s.Disable();A.Enable()}else{var b=true;var j=k.LayoutSettings.FreezePaneSettings;var f=k.RootTable.Columns;var a=d.GetViewPosition()-F.GroupedColumns.length;var h=k.GetFreezeOuterDivElement();if(j.MaxFrozenColumns!=0&&a>j.MaxFrozenColumns){b=false}else{if((f[a]==null||f[a].GetScrollWidth()>(h.scrollWidth/2))&&h.scrollWidth!=0){b=false}}if(b){s.Enable()}else{s.Disable()}A.Disable()}}}if(p!=null){var E=k.GetSelectedObject();if(!WG50Engine.IsSelectedObjectValid(E)){E=null}if(F.FilteredColumns.GetNamedItem(d.Name)==null){p.Disable()}else{p.Enable()}r.SetText(k.GetString("ContextMenu/Column/"+WG50Engine.GetSimpleType(d)+"Filters"));if(E!=null&&E.ToRowObject().Type!="GroupHeader"&&!m&&E.ToRowObject().Table.Name==F.Name){WGMenuEngine.RegisterFilterColumns(d,r);r.Enable()}else{r.Disable()}}if(m||d.Get("AllowSorting")=="Yes"){y.SetChecked(d.SortOrder=="Ascending",true);z.SetChecked(d.SortOrder=="Descending",true)}var G=k.GetElement(WG40.GROUPBYBOX,WG40.HTMLTABLE).parentElement;t.SetChecked(G.style.display=="",true);if(F.Get("AllowFilter")=="Yes"){q.SetChecked(F.GetFilterRow().style.display=="",true)}c.CurrentColumn=d;if(!ISEvent.Raise(k.LayoutSettings.ClientSideEvents.OnColumnContextMenu,k.Name,d,c,m,n)){return}if(B){c.RootMenu.OffsetElement=B;c.Show()}else{c.RootMenu.OffsetElement=null;c.Show(WGMenuEngine.GetLocation(n))}},RegisterFilterColumns:function(b,j){var k=j.SubMenu;var h=null;var d=b.GetGrid();var a=WGMenuEngine.GetBasicFilterColumns(b);k.Clear();h=k.Items;for(var e=0;e<a.length;e++){h.Add(a[e])}if(WG50Engine.GetSimpleType(b)=="Date"&&h.length>3){var c=["Tomorrow","Today","Yesterday","Sep0","NextWeek","ThisWeek","LastWeek","Sep1","NextMonth","ThisMonth","LastMonth","Sep2","Past","Future"];h.Add(new WebMenuSeparatorItem());for(var e=0;e<c.length;e++){var f=null;if(c[e].indexOf("Sep")==-1){f=new WebMenuItem("mnu"+c[e],d.GetString("ContextMenu/FilterSuggest/"+c[e]));f.SpecialDateFilter=true;f.OnClick=WGMenuEngine.FilterSuggestClick}else{f=new WebMenuSeparatorItem(c[e])}h.Add(f)}}},GetBasicFilterColumns:function(c){var d=c.GetGrid();var k=WG50Engine.GetSimpleType(c,true);var f=new Array();var j=d.GetSelectedObject();var h=j.ToRowObject();var a=h.GetCell(c.Name);var b="ContextMenu/FilterSuggest/";if(k!="Bool"){f.push(new WebMenuItem("mnuET"));f.push(new WebMenuItem("mnuNET"))}if(k=="Text"&&a!=null&&a.Text!=""){f.push(new WebMenuItem("mnuContain"));f.push(new WebMenuItem("mnuNotContain"))}else{if(k=="Number"&&a!=null&&a.Text!=""){f.push(new WebMenuItem("mnuLTET"));f.push(new WebMenuItem("mnuGTET"))}else{if(k=="Date"&&a!=null&&a.Text!=""){f.push(new WebMenuItem("mnuOnBefore"));f.push(new WebMenuItem("mnuOnAfter"))}else{if(k=="Bool"){f.push(new WebMenuItem("mnuChecked"));f.push(new WebMenuItem("mnuNotChecked"))}}}}for(var e=0;e<f.length;e++){f[e].OnClick=WGMenuEngine.FilterSuggestClick;f[e].Text=WGMenuEngine.GetTranslatedString(d.GetString(b+f[e].Name.substring(3)),c,f[e])}return f},GetTranslatedString:function(h,b,e){var c=b.GetGrid();var i=c.GetSelectedObject();var f=i.ToRowObject();var a=f.GetCell(b.Name);var k=WG50Engine.GetSimpleType(b);var j=a.Text;var d=false;if(b.ColumnType=="Custom"){j=a.Value}if(j==""){j=c.GetString("ContextMenu/FilterSuggest/Blank");d=true}else{if(j.length>30){j=j.substring(0,30)+"..."}}e.CellObject=a;e.FilterText=a.Text;if(b.GetFilterEditType()=="DropdownList"||b.GetFilterEditType()=="WebComboNET"){e.FilterValue=a.Value}return h.replace("{0}",(k=="Text"&&!d?"'":"")+j+(k=="Text"&&!d?"'":""))},FilterSuggestClick:function(h){var g=h.OwnerMenu.MenuControl;var f=g.Grid;var a=g.CurrentColumn;var i=a.Table;var e=h.Name.substring(3);if(e=="Checked"){e="ET";h.FilterText="true"}else{if(e=="NotChecked"){e="ET";h.FilterText="false"}else{if(e=="OnBefore"){e="LTET"}else{if(e=="OnAfter"){e="GTET"}}}}if(e=="ET"&&h.FilterText==""){e="IsEmpty"}else{if(e=="NET"&&h.FilterText==""){e="NotIsEmpty"}}if(h.SpecialDateFilter){if(e=="Past"){h.FilterText="{Past}";e="LTET"}else{if(e=="Future"){h.FilterText="{Future}";e="GTET"}else{h.FilterText="{"+e+"}";e="Between"}}}var d=WGMenuEngine.GetFilterTypePositionByName(e);var c=wg_Global.FilterTypeEnum[d];var b=null;if(!h.Checked){b=i.FilteredColumns.GetNamedItem(a.Name);if(b==null){b=new WebGridFilter();i.FilteredColumns.Add(b)}else{b._UIState="Changed"}b.Name=b.ColumnMember=a.Name;b.FilterType=c;b.FilterText=h.FilterText;if(typeof(h.FilterValue)!="undefined"){if(b.FilterText!=h.FilterValue){b.FilterDisplayText=b.FilterText}b.FilterText=h.FilterValue}WGUIEngine.ProcessFilteredColumns(i,null,"FilterSuggestClick");WG50Engine.ExecuteFlyPostback(f.Id,"ColumnFilter",i.Name)}},SortColumn:function(h,j){var a=wg_Global.ColumnContext;var m=a.Table;var l=(j=="ASC"?"Ascending":"Descending");var g=false;var b=null;var d=m.GroupedColumns.GetNamedItem(a.Name);if(d){g=true;a.SortOrder=d.SortOrder=l;d._UIState="Changed"}if(g){try{b=d.GetElement()}catch(c){return}b.tblName=m.Id;if(ISEvent.Raise(m.Grid.LayoutSettings.ClientSideEvents.OnColumnGroupChange,m.Grid.Id,d)){WGUIEngine.ProcessGroupedColumns(m);WG50Engine.ExecuteFlyPostback(m.Grid.Id,"ChangeGroup",b)}}else{var k=m.SortedColumns.GetNamedItem(a.Name);if(k){k.SortOrder=l;k._UIState="Changed"}else{if(m.Get("HeaderClickAction")=="SortSingle"){for(var f=0;f<m.SortedColumns.length;f++){m.SortedColumns.Remove(m.SortedColumns[f],true)}}k=new WebGridGroup();k.ColumnMember=a.Name;k.SortOrder=l;m.SortedColumns.Add(k)}try{b=a.GetElement()}catch(c){return}if(b==null){try{b=k.GetElement()}catch(c){return}}b.tblName=m.Id;if(ISEvent.Raise(m.Grid.LayoutSettings.ClientSideEvents.OnColumnSort,m.Grid.Id,a)){WGUIEngine.ProcessSortedColumns(m);WG50Engine.ExecuteFlyPostback(m.Grid.Id,"ColumnSort",b)}}},ToggleGroupByBox:function(c){var a=wg_Global.ColumnContext;var b=ISGetObject(a.GetGrid());if(b.IsGroupByBoxShown()){b.HideGroupByBox()}else{b.ShowGroupByBox()}},ToggleFilterBar:function(c){var a=wg_Global.ColumnContext;var b=a.GetGrid();b.NeedHeightResize=true;if(b.LayoutSettings.FilterBarVisible){b.HideFilterBar()}else{b.ShowFilterBar()}},GroupColumn:function(j){var a=wg_Global.ColumnContext;var f=a.GetGrid();var k=a.Table;var b=null;try{b=a.GetElement()}catch(d){var h=f.HeaderContext;f.HeaderContext=null;try{b=a.GetElement()}catch(d){if(h){b=WG50Engine.GetTD(h)}}}if(!b&&f.HeaderContext){b=WG50Engine.GetTD(f.HeaderContext)}if(b){b.tblName=k.Id}if(j.Text==f.GetString("ContextMenu/Column/GroupByThisField")){if(ISEvent.Raise(f.LayoutSettings.ClientSideEvents.OnColumnGroup,f.Id,a)){WGUIEngine.CreateNewGroupColumn(b);WGUIEngine.ProcessGroupedColumns(k);WG50Engine.ExecuteFlyPostback(f.Name,"Group",b)}}else{var g=k.GroupedColumns.GetNamedItem(a.Name);if(ISEvent.Raise(f.LayoutSettings.ClientSideEvents.OnColumnUngroup,f.Id,a)){var c=k.Columns.GetNamedItem(a.Name);var m=null;if(c){c.Visible=true;c.ForceVisible=true}k.GroupedColumns.Remove(g,true);if(b!=null){WGUIEngine.FitColumns(k,"UngroupRestoreContext",b)}if(f.BindingOperationMode=="ClientBinding"&&!k.IsUseColumnSet){var l=k.GetElement(WG40.COLHEADER,WG40.HTMLTABLE);var i=l.rows[0].cells[l.rows[0].cells.length-2];m=new wgHeaderInfo();m.Element=i;m.ProperPosition=1;m.PosLeft=0;m.Type="Column"}WGUIEngine.ProcessGroupedColumns(k,m);if(b){WG50Engine.ExecuteFlyPostback(f.Name,"Ungroup",b)}}}},RemoveColumn:function(b){var a=wg_Global.ColumnContext;WGUIEngine.RemoveColumn(a)},ApplyColumnChange:function(j){var h=j.OwnerMenu.Items;var b=wg_Global.ColumnContext;var c=b.GetElement();var n=c.parentElement;var e=b.GetGrid();var l=b.Table;var m=l.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,n);var k=false;c.tblName=l.Id;for(var f=0;f<h.length;f++){if(h[f].Type=="CheckBox"&&h[f].Checked){k=true;break}}if(!k){for(var f=0;f<l.Columns.length;f++){var d=l.Columns[f];if(d.Visible&&d.Get("ShowInSelectColumns")=="No"){k=true;break}}}if(!k){alert(e.GetString("MessageBoxText/SelectColumnException"));return}var a=new Array();for(var f=0;f<h.length;f++){var g=h[f];if(g.Type=="CheckBox"){var o=l.GetColumn(g.ColumnName);if(!g.Checked){if(o!=null&&o.Visible){if(!ISEvent.Raise(e.LayoutSettings.ClientSideEvents.OnColumnChanged,e.Id,l.Id,g.ColumnName,"Removed")){return}WGUIEngine.RemoveColumnUI(o);if(o.ForceVisible){o.ForceVisible=false}}}else{if(!o.Visible){if(l.GroupedColumns.GetNamedItem(g.ColumnName)==null){if(!ISEvent.Raise(e.LayoutSettings.ClientSideEvents.OnColumnChanged,e.Id,l.Id,g.ColumnName,"Added")){return}o.ForceVisible=true;a[a.length]=o}}}o.Visible=g.Checked}}if(a.length>0&&e.BindingOperationMode=="ClientBinding"){for(var f=0;f<a.length;f++){WGUIEngine.SynchronizeClientTemplate(l,"Add",[a[f],m.rows[0].cells.length-1,true])}}WGUIEngine.FitColumns(l,"ColumnChange",n,null,a);WGUIEngine.ReorderColumn(l,n);if(l.ColumnMenu!=null){l.ColumnMenu.Destroy();l.ColumnMenu=null}WG50Engine.ExecuteFlyPostback(e.Name,"ColumnChange",c)},FreezePane:function(d){var a=wg_Global.ColumnContext;var c=a.GetGrid();var e=a.Table;var b=0;if(e.Get("HideColumnsWhenGrouped")=="Yes"){b=e.GroupedColumns.length}if(c.LayoutSettings.Hierarchical&&e.ChildTables.length>0){b+=1}c.FreezePane(a.GetViewPosition()-b);if(e.Get("AllowSelectColumns")=="Yes"){e.ColumnMenu.Destroy();e.ColumnMenu=null}},UnfreezePane:function(c){var a=wg_Global.ColumnContext;var b=a.GetGrid();var d=a.Table;b.UnfreezePane();if(d.Get("AllowSelectColumns")=="Yes"){d.ColumnMenu.Destroy();d.ColumnMenu=null}},ResetColumn:function(h){var g=h.OwnerMenu.Items;var b=wg_Global.ColumnContext;var c=b.GetElement();var m=c.parentElement;var e=b.GetGrid();var k=b.Table;var l=k.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,m);var d=k.Columns;var a=new Array();c.tblName=k.Id;for(var f=0;f<d.length;f++){var n=d[f];var j=n.DefaultVisible;if(!j){if(n!=null){WGUIEngine.RemoveColumnUI(n)}}else{if(!n.Visible&&k.GroupedColumns.GetNamedItem(n.Name)==null){n.ForceVisible=true;a[a.length]=n}}n.Visible=j}if(a.length>0&&e.BindingOperationMode=="ClientBinding"){for(var f=0;f<a.length;f++){WGUIEngine.SynchronizeClientTemplate(k,"Add",[a[f],l.rows[0].cells.length-1,true])}}WGUIEngine.FitColumns(k,"ColumnReset",c);WGUIEngine.ReorderColumn(k,m);if(k.ColumnMenu!=null){k.ColumnMenu.Destroy();k.ColumnMenu=null}WG50Engine.ExecuteFlyPostback(e.Name,"ColumnChange",c)},BestFitColumn:function(a){WGUIEngine.ResizeBestFit(wg_Global.ColumnContext.GetElement())},RegisterFilterMenus:function(e,l){var f=ISGetObject(e);var c=new WebContextMenu(f.Id+"_Filter_"+l);var b=new Array();var a=wg_Global.FilterType;var h=c.RootMenu.Items;var d=f.GetImagesFolder();c.UseW3CPositioning=true;c.Grid=f;WGMenuEngine.ApplyDefaultStyle(c);for(var g=0;g<a.length;g++){var j=new WebMenuItem("mnu"+a[g][0],f.GetString("ContextMenu/Filter/"+a[g][0]),"",WGMenuEngine.FilterMenuClick);j.Type="Radio";j.FilterIndex=a[g][1];j.KeepMenuVisible=true;h.Add(j)}h.Add(new WebMenuSeparatorItem());h.Add(new WebMenuItem("mnuApplyAll",f.GetString("ContextMenu/Filter/ApplyAll"),f.ResolveImagePath(d,wg_Global.ApplyFilterImage),WGMenuEngine.FilterMenuApplyAll,null,"webui-icon webui-applyfilter"));h.Add(new WebMenuItem("mnuClear",f.GetString("ContextMenu/Filter/Clear"),"",WGMenuEngine.FilterMenuClearThis));h.Add(new WebMenuItem("mnuClearAll",f.GetString("ContextMenu/Filter/ClearAll"),f.ResolveImagePath(d,wg_Global.ClearFilterImage),WGMenuEngine.FilterMenuClearAll,null,"webui-icon webui-clearfilter"));var k=f.Tables[l];k.FilterMenu=c},GetFilterTypePosition:function(b){var a=wg_Global.FilterType;for(var c=0;c<a.length;c++){if(a[c][1]==parseFloat(b)){return c}}return -1},GetFilterTypePositionByName:function(c){var a=wg_Global.FilterType;for(var b=0;b<a.length;b++){if(a[b][0]==c){return a[b][1]}}return -1},GetFilterTypeInt:function(b){for(var a=0;a<wg_Global.FilterTypeEnum.length;a++){if(wg_Global.FilterTypeEnum[a]==b){return a}}return -1},ShowFilterMenus:function(o){var c=o.parentElement;var e=o.parentElement;if(c.tagName=="DIV"){c=c.parentElement;e=c}var f=wg_getGridNameByRow(c.parentElement);var r=wg_getTableNameByRow(c.parentElement);var g=ISGetObject(f);var q=g.Tables[r];var a=q.FilterMenu;var p=null;var b=q.Columns.GetNamedItem(e.colName);var k=null;if(a==null){WGMenuEngine.RegisterFilterMenus(f,r);a=q.FilterMenu}p=a.RootMenu;k=p.Items;for(var h=0;h<k.length;h++){var j=k[h];if(j.Type=="Radio"){j.SetChecked(false,true);j.Show()}}if(q.FilteredColumns.GetNamedItem(b.Name)==null){p.GetItem("mnuClear").Disable()}else{p.GetItem("mnuClear").Enable()}var s=WG50Engine.GetSimpleType(b,true);var l;if(s=="Text"){l=["LTET","LT","GTET","GT","Between","NotBetween"]}else{if(s=="Number"){l=["Like","NotLike","IsEmpty","NotIsEmpty","Contain","NotContain"]}else{if(s=="Date"){l=["Like","NotLike","IsEmpty","NotIsEmpty","Contain","NotContain"]}else{if(s=="Bool"||s=="Guid"){l=["LTET","LT","GTET","GT","Between","NotBetween","Like","NotLike","IsNull","NotIsNull","IsEmpty","NotIsEmpty","Contain","NotContain"]}}}}for(var h=0;h<l.length;h++){var n=p.GetItem("mnu"+l[h]);if(n!=null){n.Hide()}}var d=e.filterType;if(!d){d=e.getAttribute("filterType")}if(d=="0"&&b.DefaultFilterType!="NotSet"){d=WGMenuEngine.GetFilterTypeInt(b.DefaultFilterType)}if(WGMenuEngine.GetFilterTypePosition(d)!=-1){k[WGMenuEngine.GetFilterTypePosition(d)].SetChecked(true,true)}var m=new OffsetLocation(ISPosLib.getLeftW3C(o),ISPosLib.getTopW3C(o));q.LastFo=e;a.CurrentColumn=b;if(!ISEvent.Raise(g.LayoutSettings.ClientSideEvents.OnFilterContextMenu,g.Name,b,a,m)){return}a.Show(WGMenuEngine.GetLocation(m));event.returnValue=false},FilterMenuClick:function(i){var j=i.OwnerMenu;var h=j.MenuControl;var f=h.Grid;var b=h.CurrentColumn;var k=b.Table;var a=k.LastFo;var g=i.FilterIndex;var d=a.childNodes[0].innerText;if(b.GetFilterEditType()=="DropdownList"||b.GetFilterEditType()=="WebComboNET"){d=a.cellValue}else{if(b.GetFilterEditType()=="Checkbox"){d=a.children[0].children[0].checked.toString()}}a.setAttribute("filterType",g);a.setAttribute("filterText",d);if(IS.moz){a.filterType=g;a.filterText=a.childNodes[0].innerText}if(WGUIEngine.PreFilterCheck(a)){a.setAttribute("changed","true");a.cellModified=true;var c=wgGetColNameByCell(a);var e=k.FilteredColumns.GetNamedItem(c);if(!e){e=new WebGridFilter();e.Name=e.ColumnMember=c;k.FilteredColumns.Add(e)}else{e._UIState="Changed"}e.FilterType=wg_Global.FilterTypeEnum[g];e.FilterText=d;WGEditEngine.MarkEdit(f)}},FilterMenuApplyAll:function(c){var d=c.OwnerMenu;var b=d.MenuControl;var a=b.Grid;WGEditEngine.ExitEdit(a,0)},FilterMenuClearThis:function(e){var f=e.OwnerMenu;var d=f.MenuControl;var c=d.Grid;var a=d.CurrentColumn;var g=a.Table;if(ISEvent.Raise(c.LayoutSettings.ClientSideEvents.OnColumnFilter,c.Id,g,a.Name)){var b=g.FilteredColumns.GetNamedItem(a.Name);if(b){g.FilteredColumns.Remove(b,true);WGUIEngine.ProcessFilteredColumns(g)}WG50Engine.ExecuteFlyPostback(c.Id,"ColumnFilter",g.Name)}},FilterMenuClearAll:function(e){var g=e.OwnerMenu;var d=g.MenuControl;var b=d.Grid;var a=d.CurrentColumn;var h=a.Table;if(ISEvent.Raise(b.LayoutSettings.ClientSideEvents.OnColumnFilter,b.Id,h)){for(var c=0;c<h.FilteredColumns.length;c++){var f=h.FilteredColumns[c];h.FilteredColumns.Remove(f,true)}WGUIEngine.ProcessFilteredColumns(h);WG50Engine.ExecuteFlyPostback(b.Id,"ColumnFilter",h.Name)}},RegisterRowMenus:function(c){var a=new WebContextMenu(c.Id+"_Row");var b=c.GetImagesFolder();a.Grid=c;WGMenuEngine.ApplyDefaultStyle(a);var g=a.RootMenu.Items;var h=a.RootMenu;for(var i in RowStruct){var d=RowStruct[i];if(i.indexOf("Sep")>-1){var f=new WebMenuSeparatorItem("mnu"+i);f.IsBuiltIn=true;g.Add(f)}else{var e=new WebMenuItem("mnu"+i,c.GetString("ContextMenu/Row/"+i),c.ResolveImagePath(b,(d[0]?d[0]:"")),WGMenuEngine.RowMenuClick,null,"webui-icon webui-"+d[1]);e.IsBuiltIn=true;g.Add(e)}}wg_Global.RowContext=a},RowMenuClick:function(g){var m=g.OwnerMenu.MenuControl;switch(g.Name){case"mnuCopyCell":WGMenuEngine.CopyCell(m.Cell);break;case"mnuCopySelection":WGMenuEngine.CopySelection(m.Table);break;case"mnuCopyRow":WGMenuEngine.CopyRow(m.Table,m.Row);break;case"mnuCopyTable":WGMenuEngine.CopyTable(m.Table,m.Row);break;case"mnuUpdate":WGMenuEngine.Update(m.Grid,m.Row);break;case"mnuCancel":WGMenuEngine.Cancel(m.Grid,m.Row);break;case"mnuShowChildRows":WGMenuEngine.ShowChildRow(m.Row);break;case"mnuHideChildRows":WGMenuEngine.CollapseChildRow(m.Row);break;case"mnuEdit":WGMenuEngine.Edit(m.Grid,m.Row);break;case"mnuDelete":WGMenuEngine.Delete(m.Grid,m.Row);break;case"mnuExpand":WGMenuEngine.ExpandGroupRow(m.Row);break;case"mnuExpandAll":WGMenuEngine.ExpandGroupRowAll(m.Row);break;case"mnuCollapse":WGMenuEngine.CollapseGroupRow(m.Row);break;case"mnuCollapseAll":WGMenuEngine.CollapseGroupRowAll(m.Row);break;case"mnuPerformAdd":WGMenuEngine.Add(m.Grid,m.Row);break;case"mnuCancelAdd":WGMenuEngine.Cancel(m.Grid,m.Row);break;case"mnuApplyFilter":WGMenuEngine.FilterMenuApplyAll(g);break;case"mnuClearFilter":WGMenuEngine.FilterMenuClearAll(g);break;case"mnuGotoFilterRow":m.Table.GotoFilterRow();break;case"mnuClearFilterCell":WGMenuEngine.FilterMenuClearThis(g);break;case"mnuRefresh":m.Grid.Refresh();break;case"mnuLoadMore":wgLoadMore(m.Grid.Id);break;case"mnuExport":if(!m.Table.IsRootTable){var k=m.Table.ToRowObject(m.Row).GetParentRow().GetElement()}m.Grid.ExportGrid(m.Table.Name,m.Grid.ExportTypeList[0],"Portrait",k);break;case"mnuHelp":wgShowHelp(m.Grid.Id);break;case"mnuAddNewRow":m.Table.GotoNewRow(m.Row);break;case"mnuPasteToNewRow":var q=window.clipboardData.getData("Text");if(q==null||q==""){alert(e.GetString("MessageBoxText/ClipboardException"));return}var a=q.split("\t");var r=true;var p=m.Table;var e=m.Grid;if(a.length<1||a.length!=p.GetVisibleColumnNames().length){r=confirm(e.GetString("MessageBoxText/ClipboardDataUnmatch"))}if(r){var j=p.GetNewRow(m.Row);var h=p.ToRowObject(j);var d=h.GetCells();var o=0;if(e.LastEditObj){e.ExitEditMode()}for(var f=0;f<a.length;f++){if(f>p.Columns.length-1){break}var c=d[f];if(c){var q=a[f-o];var b=q.split("\03");c.SetText(b[0],true);if(b.length>1){c.SetValue(b[1])}if(c.Column.DataFormatString!=""&&WG50Engine.GetSimpleType(c.Column)=="Number"){c.SetValue(wgGetUnMask(e,c.Column,c.GetElement(),true,b[0]))}}else{o++}}e.MarkEdit()}break;case"mnuPasteMultipleRows":WGBatchEngine.AddNewRowsFromClipboard(m.Table,m.Row);break;case"mnuUndoChanges":var e=m.Grid;var n=m.Table.ToRowObject(m.Row);n.UndoChanges();break;case"mnuReviewChanges":var e=m.Grid;WGBatchUIEngine.LaunchReviewChanges(e);break;case"mnuUndoAllChanges":var e=m.Grid;var l=false;if(e.LayoutSettings.BatchUpdateSettings.PromptOnUndoAllChanges){if(confirm(e.GetString("MessageBoxText/UndoPendingChanges"))){l=true}}if(l){if(ISEvent.Raise(e.LayoutSettings.ClientSideEvents.OnUndoAllChanges,e.Id)){e.UndoAllChanges()}}break;case"mnuAcceptAllChanges":var e=m.Grid;if(ISEvent.Raise(e.LayoutSettings.ClientSideEvents.OnAcceptAllChanges,e.Id)){e.AcceptAllChanges()}break;case"mnuUndoSelection":WGMenuEngine.UndoSelection(m.Grid,m.Table);break;case"mnuDeleteSelection":WGMenuEngine.DeleteSelection(m.Grid,m.Table);break}},ResetAndClearCustomMenus:function(c,e){var d=c.RootMenu;for(var a=0;a<d.Items.length;a++){var b=d.Items[a];if(!b.IsBuiltIn){d.Items.Remove(b);a--}else{if(!e){d.Items[a].Hide()}}}},ShowRowMenus:function(k,ae,f,q){var aa=wgGetRootRow(f.parentElement);var ab=aa.type;var l=WG50Engine.GetTable(f);var k=ISGetObject(l.gridId);var ae=k.Tables[l.tblName];var h=k.GetImagesFolder();if(ab==""){return}if(!wg_Global.RowContext){WGMenuEngine.RegisterRowMenus(k)}WGMenuEngine.ResetAndClearCustomMenus(wg_Global.RowContext);var c=wg_Global.RowContext;var Z=c.RootMenu;var B=Z.GetItem("mnuCopySelection");var z=Z.GetItem("mnuCopyCell");var A=Z.GetItem("mnuCopyRow");var C=Z.GetItem("mnuCopyTable");var X=Z.GetItem("mnuUpdate");var t=Z.GetItem("mnuCancel");var V=Z.GetItem("mnuUndoChanges");var U=Z.GetItem("mnuUndoAllChanges");var r=Z.GetItem("mnuAcceptAllChanges");var S=Z.GetItem("mnuReviewChanges");var T=Z.GetItem("mnuShowChildRows");var L=Z.GetItem("mnuHideChildRows");var F=Z.GetItem("mnuEdit");var D=Z.GetItem("mnuDelete");var G=Z.GetItem("mnuExpand");var H=Z.GetItem("mnuExpandAll");var x=Z.GetItem("mnuCollapse");var y=Z.GetItem("mnuCollapseAll");var Q=Z.GetItem("mnuPerformAdd");var u=Z.GetItem("mnuCancelAdd");var s=Z.GetItem("mnuApplyFilter");var v=Z.GetItem("mnuClearFilter");var N=Z.GetItem("mnuAddNewRow");var O=Z.GetItem("mnuPasteToNewRow");var P=Z.GetItem("mnuPasteMultipleRows");var w=Z.GetItem("mnuClearFilterCell");var R=Z.GetItem("mnuRefresh");var M=Z.GetItem("mnuLoadMore");var I=Z.GetItem("mnuExport");var K=Z.GetItem("mnuHelp");var J=Z.GetItem("mnuGotoFilterRow");var W=Z.GetItem("mnuUndoSelection");var E=Z.GetItem("mnuDeleteSelection");var e=null;c.Row=aa;c.Table=ae;c.Grid=k;c.Cell=null;if(ab!="NewRow"&&ab!="FilterRow"){if(k.ActiveEditCell){z.Show();c.Cell=k.ActiveEditCell.element}else{if(k.LastSelObj&&k.LastSelObj.type=="Cell"){z.Show();c.Cell=k.LastSelObj.element}}A.Show();if(ae.GroupedColumns.length==0){C.Show()}if(ae.Get("AllowMultipleSelection")=="Yes"&&ae.GetCheckedRows().length>0){B.Show();if(ae.Get("AllowDelete")=="Yes"){E.Show()}if(k.LayoutSettings.AllowBatchUpdate&&k.LayoutSettings.BatchUpdateSettings.AllowUndoChanges){var ac=ae.GetCheckedRows();var ad=false;for(var o=0;o<ac.length;o++){if(ac[o].rowState){ad=true;break}}if(ad){W.Show()}}}}if(ab=="Record"){if(aa.markedEdit){X.Show();t.Show()}else{var Y=ae.ChildTables;if(Y.length>0){if(aa.childExpanded=="True"){T.Disable();L.Enable()}else{T.Enable();L.Disable()}if(aa.childNotExpandable=="True"){T.Hide();L.Hide()}else{T.Show();L.Show()}}if(aa.rowState!="Deleted"){if(ae.Get("AllowEdit")=="Yes"){F.Show()}if(ae.Get("AllowDelete")=="Yes"){D.Show()}}if(k.LayoutSettings.AllowBatchUpdate){var b=k.LayoutSettings.BatchUpdateSettings;if(aa.rowState&&b.AllowUndoChanges){if(!W.Visible){V.Show()}}if(k.GetChangesCount()>0){if(b.AllowUndoChanges){U.Show()}if(b.AllowReviewChanges){S.Show()}r.Show()}if(IS.ie&&ae.Get("AllowAddNew")=="Yes"){P.Show()}}}}else{if(ab=="GroupHeader"){G.Show();H.Show();x.Show();y.Show();if(aa.expanded=="True"){G.Disable();x.Enable()}else{G.Enable();x.Disable()}}else{if(ab=="NewRow"){if(aa.markedEdit){Q.Enable();u.Enable()}else{Q.Disable();u.Disable()}Q.Show();u.Show();O.Show()}else{if(ab=="FilterRow"){c.Cell=k.ActiveEditCell.element;s.Show();v.Show();if(c.Cell!=null){e=wgGetColNameByCell(c.Cell);c.CurrentColumn=ae.Columns.GetNamedItem(e)}}}}}if(k.LayoutSettings.CellClickAction=="CellSelect"){var p=k.LastSelObj;if(p!=null){c.Cell=p.element}}if(ae.Get("AllowAddNew")=="Yes"&&ab!="NewRow"){N.Show()}if(ae.Get("AllowFilter")=="Yes"&&ab!="FilterRow"){J.Show()}if(k.LayoutSettings.AutoFilterSuggestion&&ab!="NewRow"&&c.Cell!=null&&ae.IsRootTable){if(e==null){e=wgGetColNameByCell(c.Cell)}if(ab!="FilterRow"){w.Show();if(ae.FilteredColumns.GetNamedItem(e)==null){w.Disable()}else{w.Enable()}}if(c.Cell!=null){var d=ae.Columns.GetNamedItem(e);if(ab!="FilterRow"&&ab!="GroupHeader"){var a=WGMenuEngine.GetBasicFilterColumns(d);for(var m=0;m<a.length;m++){var g=a[m];Z.Items.InsertAt(g,w.Index+m+1)}}c.CurrentColumn=d}}if(k.LayoutSettings.PagingMode=="VirtualLoad"&&ae.IsRootTable){M.Show()}if(k.LayoutSettings.AllowExport=="Yes"){I.Show()}if(J!=null){if(k.LayoutSettings.FilterBarVisible&&ae.Get("AllowFilter")=="Yes"&&ab!="FilterRow"){J.Show()}else{J.Hide()}}R.Show();if(k.LayoutSettings.AlwaysShowHelpButton){K.Show()}wg_Global.LastRowCtx=aa;wg_Global.RowContext=c;WGMenuEngine.ShowSeparator(Z);if(!ISEvent.Raise(k.LayoutSettings.ClientSideEvents.OnRowContextMenu,k.Name,ab,aa,c,q)){return}c.Show(WGMenuEngine.GetLocation(q))},ShowSeparator:function(e){var f=false;var g=false;var d=false;var c=null;for(var a=0;a<e.Items.length;a++){var b=e.Items[a];if(b.Type!="Separator"){if(b.Visible){if(!d){f=true}else{if(f){f=true;c.Show();d=false;c=null}else{f=true}}}}else{if(b.Type=="Separator"){if(f){d=true;c=b}}}}},CopyCell:function(a){wgCopyToCB(a.innerText)},CopySelection:function(e){var d=e.GetCheckedRows();var b="";if(d.length>=0){for(var a=0;a<d.length;a++){var c=d[a];if(wgIsRecordRow(c)){b+=WGMenuEngine.CopyRow(e,c,true)}}wgCopyToCB(b)}},CopyRow:function(m,f,d){var g="";var k=new Array();var b=m.GetGrid();if(wgIsColumnSetRow(f)){k=wgGetColumnSetRows(f)}else{k[0]=f}for(var e=0;e<k.length;e++){var h=k[e];for(var c=0;c<h.cells.length;c++){var a=h.cells[c];if(a.type=="Cell"||a.type=="GroupCell"){var l=a.innerText;if(b.GetColumnByElement(a).ClipboardCopyMode=="Value"){l=a.cellValue}var n="";if(m.Grid.LayoutSettings.PersistValueListOnCopy){if(a.cellValue){n="\03"+a.cellValue}}if(l!=""&&l!=" "){g+=l+n+"\t"}else{if(a.children.length>0&&a.children[0].tagName=="INPUT"){if(a.children[0].type=="checkbox"){g+=a.children[0].checked+n+"\t"}else{g+=a.children[0].value+n+"\t"}}else{g+=l+n+"\t"}}}}if(g!=""){g=g.substring(0,g.length-1)}g+="\n"}if(d){return g}wgCopyToCB(g)},CopyTable:function(f,d){var g=f.GetElement(WG40.BODY,WG40.HTMLTABLE,d);var e=f.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,d).rows[0];var c="";if(e){for(var b=0;b<e.cells.length;b++){var a=e.cells[b];if(a.type=="Column"){c+=a.innerText+"\t"}}}if(c!=""){c=c.substring(0,c.length-1)+"\n"}for(var b=0;b<g.rows.length;b++){var d=g.rows[b];if(wgIsRecordRow(d)){c+=WGMenuEngine.CopyRow(f,d,true)}}wgCopyToCB(c)},ShowChildRow:function(a){wgExpandChildRow(a)},CollapseChildRow:function(a){wgCollapseChildRow(a)},ExpandGroupRow:function(a){wgExpandGroupRow(a)},ExpandGroupRowAll:function(a){wgExpandGroupRow(a,true)},CollapseGroupRow:function(a){wgCollapseGroupRow(a)},CollapseGroupRowAll:function(a){wgCollapseGroupRow(a,true)},Update:function(a,b){WGEditEngine.ExitEdit(a,0,false)},Add:function(a,b){WGEditEngine.ExitEdit(a,0,false)},Cancel:function(a,c){var b=WGEditEngine.ExitEdit(a,-1)[0];if(b){a.IsInEditMode=false}},Edit:function(a,b){a.ActivateEditMode()},UndoSelection:function(a,g){var c=false;if(a.LayoutSettings.BatchUpdateSettings.PromptOnUndoAllChanges){if(confirm(a.GetString("MessageBoxText/UndoSelectedPendingChanges"))){c=true}}if(c){var f=g.GetCheckedRows();for(var b=0;b<f.length;b++){var d=f[b];if(d.rowState){var e=g.ToRowObject(d);e.UndoChanges()}}}},Delete:function(b,c){var a=true;if(b.LayoutSettings.PromptBeforeDelete){a=confirm(b.GetString("MessageBoxText/DeleteRow"))}if(a){WGEditEngine.PrepareDeleteRowInfo(b,c)}},DeleteSelection:function(b,e){var a=true;if(b.LayoutSettings.PromptBeforeDelete){a=confirm(b.GetString("MessageBoxText/DeleteSelectedRows"))}if(a){var d=e.GetCheckedRows();for(var c=0;c<d.length;c++){WGEditEngine.PrepareDeleteRowInfo(b,d[c])}}},RegisterExportMenu:function(d){var a=new WebContextMenu(d.Id+"_Export");var g=a.RootMenu;var f=g.Items;var c=d.GetImagesFolder();var b=null;a.Grid=d;WGMenuEngine.ApplyDefaultStyle(a);f.Add(new WebMenuRadioItem("mnuRoot","Target",d.GetString("ContextMenu/Export/ExportRoot")));f.Add(new WebMenuRadioItem("mnuChild","Target",d.GetString("ContextMenu/Export/ExportChild")));f.Add(new WebMenuSeparatorItem());if(d.ExportTypeList.length>0){for(var e=0;e<d.ExportTypeList.length;e++){var h=d.ExportTypeList[e];var j=new WebMenuRadioItem("mnuType_"+h,"Type",h,d.ResolveImagePath(c,"wg5_"+h.toLowerCase()+".gif"));j.ImageClass="webui-icon webui-media-"+h.toLowerCase();if(e==0){j.Checked=true;b=j}f.Add(j)}}f.Add(new WebMenuSeparatorItem());f.Add(new WebMenuRadioItem("mnuPortrait","Orientation",d.GetString("ContextMenu/Export/Portrait")));f.Add(new WebMenuRadioItem("mnuLandscape","Orientation",d.GetString("ContextMenu/Export/Landscape")));f.Add(new WebMenuSeparatorItem());f.Add(new WebMenuItem("mnuExportNow",d.GetString("ContextMenu/Export/DoExport"),"",WGMenuEngine.DoExport));g.GetItem("mnuRoot").Checked=true;g.GetItem("mnuPortrait").Checked=true;for(var e=0;e<f.length;e++){f[e].IsBuiltIn=true}if(b!=null){b.Checked=true}else{if(g.GetItem("mnuType_HTML")!=null){g.GetItem("mnuType_HTML").Checked=true}}d.ExportContext=a},ShowExportMenu:function(c){var b=c.ExportContext;var g=null;var e=c.LastSelObj;var a=false;if(b==null){WGMenuEngine.RegisterExportMenu(c);b=c.ExportContext}WGMenuEngine.ResetAndClearCustomMenus(b,true);var f=b.RootMenu.GetItem("mnuChild");var g=c.RootTable;b.Grid=c;if(e){el=e.GetRowElement();g=c.Tables[wg_getTableNameByRow(el)];if(!g.IsRootTable){f.Enable();b.Table=g}else{a=true}}else{a=true}if(a){f.SetChecked(false,true);f.Disable();b.RootMenu.GetItem("mnuRoot").SetChecked(true,true)}var d=new OffsetLocation(event.clientX,event.clientY);if(!ISEvent.Raise(c.LayoutSettings.ClientSideEvents.OnExportContextMenu,c.Name,g,b,d)){return}b.Show(WGMenuEngine.GetLocation(d))},DoExport:function(c){var b=c.OwnerMenu.MenuControl;var a=b.Grid;WG50Engine.ExecuteFlyPostback(a.Name,"Export")}};function wgShowFilterMenus(a){WGMenuEngine.ShowFilterMenus(a)}function WebGridContextDestructor(){delete WGMenuEngine;window.detachEvent("onunload",WebGridContextDestructor);IS.RegisterUnloadVariables("WGMenuEngine")}window.attachEvent("onunload",WebGridContextDestructor);if(typeof(Sys)!="undefined"){Sys.Application.notifyScriptLoaded()};