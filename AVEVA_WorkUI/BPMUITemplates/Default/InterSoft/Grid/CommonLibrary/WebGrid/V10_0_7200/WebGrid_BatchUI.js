var WGBatchUIEngine={LaunchReviewChanges:function(d){if(!d.ReviewDialogBox){WGBatchUIEngine.CreateDialogBox(d)}var c=d.ReviewDialogBox;var a="";if(WGBatchUIEngine.IsDesktopManagerExisted(d)){a="&window="+window.name}c.UseCssFramework=d.UseCssFramework;c.ContentURL=d.ReviewChangesUrl+"?gridId="+d.Id+a;c.ShowDialog();c.Window.MinimumSize.Parse("450, 150");c.Window.SetCaption(d.GetString("CommonText/ReviewChangesCaption").replace("{0}",d.GetChangesCount()));c.Window.Grid=d;c.Window.DesktopManager.ClientSideEvents.OnWindowShown=WGBatchUIEngine.DialogBox_Shown;var b=null;if(IS.IsXHTMLDocType()){b=document.documentElement}else{b=document.body}if(b!=null&&b.scrollTop>0&&b.scrollHeight>b.offsetHeight){c.Window.MoveTo(c.Window.Location.X,c.Window.Location.Y+b.scrollTop)}},SetupDefaultDialogBoxSettings:function(b,a){if(WGBatchUIEngine.IsDesktopManagerExisted(b)){a.IntegratedToDesktopManager=true;a.ReuseIFrame=true}},CreateDialogBox:function(b){var a=CreateWebDialogBox(b.Id+"_dlgReview");a.Grid=b;a.Width="600px";a.Height="300px";a.ClientSideEvents.OnBeforeCreated=WGBatchUIEngine.DialogBox_BeforeCreated;a.ClientSideEvents.OnClosed=WGBatchUIEngine.DialogBox_Closed;a.WindowSettings.ContentMode="UseIFrame";a.WindowSettings.AllowResize="Yes";a.WindowSettings.WindowHeaderHeight=24;if(IS.IsHTML5DocType()){a.ClientSideEvents.OnCreated=WGBatchUIEngine.DialogBox_Created}WGBatchUIEngine.SetupDefaultDialogBoxSettings(b,a);b.ReviewDialogBox=a},DialogBox_Shown:function(b,c){var a=c.Grid;if(a==null){return}setTimeout(function(){if(typeof(a.InitializeChangesList)=="function"){a.InitializeChangesList()}},50)},DialogBox_Closed:function(a,b){},DialogBox_Created:function(f,e){var d=ISGetObject(f);var c=d.Window.GetWindowDivElement();if(parseFloat(d.MajorVersion)<4){var a=d.Window.GetCaptionBarCellElement().children[0].rows[0];var b=d.Window.GetContentDivElement();a.cells[0].children[0].style.display="block";a.cells[2].children[0].style.display="block";b.style.height=(parseFloat(d.Height)-26)+"px"}},DialogBox_BeforeCreated:function(id,dm){var imgSet=dm.ImagesSettings;var dlgBox=ISGetObject(id);var wndSet=dlgBox.WindowSettings;var grid=dlgBox.Grid;var _grid=grid;dlgBox.UseCssFramework=grid.UseCssFramework;if(grid.UseCssFramework){with(wndSet){TextAlignment="Center";IFrameAllowTransparency=false;ContainerStyle="common-dialog-container";WindowStyle=new DynamicStyle("common-dialog","B","common-dialog active");CaptionStyle=new DynamicStyle("common-dialog-caption","B","common-dialog-caption active");CaptionButtonStyle=new DynamicStyle("common-dialog-captionbutton","common-dialog-captionbutton hover","common-dialog-captionbutton active")}}else{with(wndSet){TextAlignment="Center";IFrameAllowTransparency=false;BorderType="ComplexImages";ContainerStyle="WG7-DB-ContainerStyle";WindowStyle=new DynamicStyle("WG7-DB-Window-N","B","WG7-DB-Window-A");CaptionStyle=new DynamicStyle("WG7-DB-Caption-N","B","WG7-DB-Caption-A");CaptionButtonStyle=new DynamicStyle("A","B","C")}dlgBox.EnableDropShadow=true}dlgBox.InProgressText=" ";dlgBox.UseWebResourcesForClient=true;dlgBox.EnableAnimation=true;if(!IS.moz){dlgBox.AnimationStyle="VistaStyleZoom"}dm.UseWebResourcesForClient=true;if(id.indexOf("Editing")>-1&&IS.moz){dm.ClientSideEvents.OnWindowResized=WGBatchUIEngine.OnWindowResized}if(dlgBox.ImagesSettings){imgSet=dlgBox.ImagesSettings}with(imgSet){InProgress=_grid.ResolveImagePathEx(_grid.LayoutSettings.ImageSettings.InProgressImage);CaptionCenterActive=CaptionCenterInactive="mac/center_active_light.gif";CaptionLeftActive=CaptionLeftInactive="mac/left_active_light.gif";CaptionRightActive=CaptionRightInactive="mac/right_active_light.gif";CloseActive="mac/general_inactive.gif";CloseDown="mac/close_over.gif";CloseInactive="mac/general_inactive.gif";CloseOver="mac/close_over.gif"}},OnWindowResized:function(a,e,c){if(c=="end"){var d=e.DialogBox.Grid;var b=e.GetWindowIFrameElement();b.style.height=e.Size.Height-30}},IsDesktopManagerExisted:function(c){var a=ISGetDesktopManager();var b=false;if(c.FoundValidDesktopManagerInstance){return true}if(a!=null&&a.Id!="Global"&&window.name!=""&&c.AutoIntegrateToDesktopManager){b=true}c.FoundValidDesktopManagerInstance=b;return b}};