function ChartInteractiveUI(){this._Type="ChartInteractiveUI";ISObject.call(this);this.ResizeTimeoutID=0;this.ResizeQueue=0;this.ResponseTimeoutID=0;this.GetChartContainer=function(){return document.getElementById(this.Parent.Id+"_ChartContainer")};this.GetChartInnerContainer=function(){return document.getElementById(this.Parent.Id+"_ChartInnerContainer")};this.GetChartImageElement=function(){return document.getElementById(this.Parent.Id+"_ChartImage")};this.GetChartLoaderElement=function(){return document.getElementById(this.Parent.Id+"_ChartLoader")};this.GetChartMap=function(){return document.getElementById(this.Parent.Id+"_ChartMap")};this.ShowLoaderImage=function(){var a=this.GetChartImageElement();var b=this.GetChartLoaderElement();a.style.display="none";a.src=this.Parent.ResolveImagePathEx("wg_blank.gif");b.style.display="";if(this.Parent.ChartMode=="InteractiveUI"){var c=this.GetChartStatusElement();c.style.display=""}return true};this.OnUnload=function(){Listener.Unload(this.GetChartContainer())};this.HideLoaderImage=function(){var a=this.GetChartImageElement();var b=this.GetChartLoaderElement();b.style.display="none";a.style.display="";return true};this.RefreshChart=function(){if(this.ResponseTimeoutID>0){return}if(this.Parent.ChartMode=="InteractiveUI"){this.HideUpdateText()}this.ShowLoaderImage();var b=this.Parent.ChartSettings;var a=this.GetChartImageElement();var d=a.parentElement;var c=parseInt(d.currentStyle.marginLeft);if(isNaN(c)){c=0}b.Height=d.offsetHeight-c;b.Width=d.offsetWidth-c;WG50Engine.ExecuteFlyPostback(this.Parent.Id,"Charting")}}function ChartPivotConfig(){this._Type="ChartPivotConfig";ISObject.call(this);this.WebGrid=null;this.DataMember="";this.DataType="System.String";this.PivotElement=null;this.Name=""}function ChartPivotDataConfig(){this.inheritFrom=ChartPivotConfig;this.inheritFrom();this._Type="ChartPivotDataConfig";ISObject.call(this);this.AutoCalc="Count";this.Type="Data";this.GetText=function(){return this.AutoCalc+" of "+this.Text}}function ChartPivotFilterConfig(){this.inheritFrom=ChartPivotConfig;this.inheritFrom();this._Type="ChartPivotFilterConfig";ISObject.call(this);this.PivotType="Field";this.DateInterval="Years";this.SortOrder="Ascending";this.FilterExpression="";this.FilterCriterias=new ISArray()}function ChartFilterDataCriteria(){this._Type="ChartFilterDataCriteria";ISObject.call(this);this.DataMember="";this.DateInterval="Years";this.DateValue=0}function ChartSettings(){this._Type="ChartSettings";ISObject.call(this);this.ChartType="Column";this.CacheSelectionRendering=true;this.Depth=50;this.Height=500;this.Width=760;this.Visible=true;this.LegendSettings=new ChartLegendSettings();this.SeriesAreaSettings=new ChartSeriesAreaSettings();this.SeriesBarSettings=new ChartSeriesBarSettings();this.SeriesColumnSettings=new ChartSeriesColumnSettings();this.SeriesBubbleSettings=new ChartSeriesBubbleSettings();this.SeriesDoughnutSettings=new ChartSeriesDoughnutSettings();this.SeriesLineSettings=new ChartSeriesLineSettings();this.SeriesPieSettings=new ChartSeriesPieSettings();this.SeriesPolarSettings=new ChartSeriesPolarSettings();this.SeriesRadarSettings=new ChartSeriesRadarSettings();this.SeriesSmoothLineSettings=new ChartSeriesSmoothLineSettings();this.SeriesStepLineSettings=new ChartSeriesStepLineSettings();this.SeriesStockSettings=new ChartSeriesStockSettings();this.SeriesXYSettings=new ChartSeriesXYSettings();this.XAxis=new ChartXAxisSettings();this.YAxis=new ChartYAxisSettings();this.ZAxis=new ChartZAxisSettings();this.ProjectionSettings=new ChartProjectionSettings();this.LightModelSettings=new ChartLightModelSettings();this.ImageFormat="";this.ImageFileServer="";this.LoaderImage="";this.ChartEngine="BuiltIn";this.UpdateChanges=function(){WGChartEngine.UpdateChanges(this)}}function ChartVector3DValue(){this._Type="ChartVector3DValue";ISObject.call(this);this.X=0;this.Y=0;this.Z=0}function ChartLightSourceSettings(){this._Type="ChartLightSourceSettings";ISObject.call(this);this.Ambient=null;this.ConstantAttenuation=1;this.Difuse=null;this.Direction=new ChartVector3DValue();this.LightSourceType="Positional";this.LinearAttenuation=0;this.Position=new ChartVector3DValue();this.QuadraticAttenuation=0;this.Specular=null;this.SpotCutoff=180;this.SpotExponent=0}function ChartLightModelSettings(){this._Type="ChartLightModelSettings";ISObject.call(this);this.EnableLighting=false;this.GlobalAmbientLight=null;this.LocalViewpointLighting=false;this.LightSources=new ISArray();this.LightModel="NorthernLights"}function ChartProjectionSettings(){this._Type="ChartProjectionSettings";ISObject.call(this);this.UsePredefinedProjection=true;this.PredefinedProjection="PerspectiveTilted";this.Direction=new ChartVector3DValue();this.Elevation=20;this.PerspectiveAngle=60;this.Rotation=30;this.ProjectionType="Perspective";this.Position=new ChartVector3DValue();this.ViewerRotation=0;this.XDepth=0.25;this.YDepth=0.25;this.Zoom=100}function ChartLegendSettings(){this._Type="ChartLegendSettings";ISObject.call(this);this.Mode="Automatic"}function ChartAxisSettings(){this._Type="ChartAxisSettings";ISObject.call(this);this.Title=new ChartScaleTitleStyle()}function ChartXAxisSettings(){this.inheritFrom=ChartAxisSettings;this.inheritFrom();this._Type="ChartXAxisSettings";ISObject.call(this)}function ChartYAxisSettings(){this.inheritFrom=ChartAxisSettings;this.inheritFrom();this._Type="ChartYAxisSettings";ISObject.call(this)}function ChartZAxisSettings(){this.inheritFrom=ChartAxisSettings;this.inheritFrom();this._Type="ChartZAxisSettings";ISObject.call(this)}function ChartScaleTitleStyle(){this._Type="ChartScaleTitleStyle";ISObject.call(this);this.Text=""}function ChartSeriesAreaSettings(){this._Type="ChartSeriesAreaSettings";ISObject.call(this);this.Type="Area"}function ChartSeriesBarSettings(){this._Type="ChartSeriesBarSettings";ISObject.call(this);this.Type="ClusteredBar"}function ChartSeriesBubbleSettings(){this._Type="ChartSeriesBubbleSettings";ISObject.call(this);this.Type="ClusteredBar"}function ChartSeriesColumnSettings(){this._Type="ChartSeriesColumnSettings";ISObject.call(this);this.Type="ClusteredColumn"}function ChartSeriesDoughnutSettings(){this._Type="ChartSeriesDoughnutSettings";ISObject.call(this);this.Type="Doughnut"}function ChartSeriesLineSettings(){this._Type="ChartSeriesLineSettings";ISObject.call(this);this.Type="OverlappedLine"}function ChartSeriesPieSettings(){this._Type="ChartSeriesPieSettings";ISObject.call(this);this.Type="Pie"}function ChartSeriesPolarSettings(){this._Type="ChartSeriesPolarSettings";ISObject.call(this);this.Type="Polar"}function ChartSeriesRadarSettings(){this._Type="ChartSeriesRadarSettings";ISObject.call(this);this.Type="Radar"}function ChartSeriesSmoothLineSettings(){this._Type="ChartSeriesSmoothLineSettings";ISObject.call(this);this.Type="OverlappedSmoothLine"}function ChartSeriesStepLineSettings(){this._Type="ChartSeriesStepLineSettings";ISObject.call(this);this.Type="OverlappedStepLine"}function ChartSeriesStockSettings(){this._Type="ChartSeriesStockSettings";ISObject.call(this);this.Type="HighLowClose"}function ChartSeriesXYSettings(){this._Type="ChartSeriesXYSettings";ISObject.call(this);this.Type="Scatter"}WebGrid.prototype.SwitchToGridView=function(){WGChartEngine.SwitchToView(this.Id,"GridView")};WebGrid.prototype.SwitchToPivotChartView=function(){WGChartEngine.SwitchToView(this.Id,"PivotChartView")};function wgShowGridView(a){WGChartEngine.SwitchToView(a,"GridView")}function wgShowPivotChartView(a){WGChartEngine.SwitchToView(a,"PivotChartView")}function InitializeWGChart(c){var e=ISGetObject(c);var b=e.ChartInteractiveUI;var d=document.createElement("div");var a;if(!e.GetString("Ready")){setTimeout(function(){InitializeWGChart(c)},10);return}if(e.ChartMode=="DisplayOnly"){a=WGChartEngine.CreateChartUI(c)}else{if(e.ChartMode=="InteractiveUI"){a=WGChartUIEngine.CreateChartUI(c)}}d.innerHTML=a;d=d.children[0];e.ChartContainer.appendChild(d);b.ShowLoaderImage();if(e.ChartMode=="InteractiveUI"){WGChartUIEngine.CreateChartRibbon(c,e,d);WGChartUIEngine.CreateAddToButton(c,e,d);Listener.Add(b.GetChartContainer(),"onclick",WGChartUIEngine.OnChartContainerClick,e);Listener.Add(b.GetChartContainer(),"oncontextmenu",WGChartUIEngine.OnChartContainerContextMenu,e);b.MasterDataCollection=new ISArray();b.MasterDataCollection.CopyFrom(e.ChartDataCollection);WGChartUIEngine.InitializeFieldListData(e);WGChartUIEngine.InitializeChartType(e);WGChartUIEngine.InitializeAutoCalcType(e);WGChartUIEngine.SynchronizeChartType(e);WGChartUIEngine.SynchronizeDataCollection(e);WGChartUIEngine.SynchronizeSeriesCollection(e);WGChartUIEngine.SynchronizeCategoryCollection(e);WGChartUIEngine.SynchronizeFilterCollection(e);WGChartDragDropEngine.InitializeDragList(e);WGChartDragDropEngine.InitializeDropZones(e);b.UpdateChartUI()}WGChartEngine.SetChartContainerSize(e,true);b.RefreshChart();e.ChartInitialized=true}var WGChartEngine={SwitchToView:function(b,g){var c=ISGetObject(b);var a=1;if(c.LayoutSettings.InitialView=="PivotChartViewExclusive"){a=0}if(c.CurrentViewMode!=g){c.ExitEditMode(true);if(g=="GridView"){WGChartEngine.SetGridElementVisibility(c,true);WGChartEngine.SetChartElementVisibility(c,false);WGUIEngine.SetCommandPushed(c,"ViewMode",0,true);WGUIEngine.SetCommandPushed(c,"ViewMode",1,false);c.NeedHeightResize=true}else{if(g=="PivotChartView"){var d=false;var e=c.FrameObj.offsetHeight;var f=c.FrameObj.clientWidth;if(c.RootTable.TableHeaderVisible){e-=20}if(c.EstimateChartHeight>0&&(c.EstimateChartHeight!=e||c.EstimateChartWidth!=f)){d=true}c.EstimateChartHeight=e;c.EstimateChartWidth=f;WGChartEngine.SetGridElementVisibility(c,false);WGChartEngine.SetChartElementVisibility(c,true);if(a==1){WGUIEngine.SetCommandPushed(c,"ViewMode",0,false);WGUIEngine.SetCommandPushed(c,"ViewMode",a,true)}else{WGUIEngine.SetCommandPushed(c,"ViewMode",a,true)}if(d){WGChartEngine.AutoResize(c,c.EstimateChartHeight,true)}}}c.CurrentViewMode=g;if(c.CurrentViewMode=="GridView"&&c.TotalLoadedRows>0&&c.RootTable.GetRowsCount()==0){c.RequireInvalidateFreezeContainer=true;c.Refresh()}}},SetGridElementVisibility:function(e,g,c){var a=(g?"":"none");var d=e.FrameObj;for(var f=0;f<d.children.length;f++){var b=d.children[f];if(b.tagName=="DIV"||b.tagName=="TABLE"){if((b.id!="")&&b.id.indexOf("dvStatus")==-1){if(a=="none"){if(!c){b.originalDisplay=b.style.display}b.style.display=a}else{if(typeof(b.originalDisplay)!="undefined"){b.style.display=b.originalDisplay}}}}}},SetChartElementVisibility:function(e,g,f){if(e.ChartContainer==null){var b=document.createElement("div");var i=e.GetElement(WG40.STATUSBOX,WG40.HTMLDIV);if(!f){if(i){i.insertAdjacentElement("beforeBegin",b)}else{e.FrameObj.appendChild(b)}}else{var a=e.LayoutSettings.ChartDisplayPosition;if(a=="Top"){e.FrameObj.insertAdjacentElement("afterBegin",b)}else{if(a=="Bottom"){e.FrameObj.appendChild(b)}else{if(a=="Custom"){var d=e.LayoutSettings.ChartCustomContainerId;var c=(d==""?null:document.getElementById(d));if(d==""||c==null){e.FrameObj.insertAdjacentElement("afterBegin",b)}else{c.appendChild(b)}}}}if(a=="Top"||a=="Bottom"){var h=null;if(IS.ie){h=e.FrameObj.parentElement}else{h=e.FrameObj}if(a=="Bottom"){h.gridHeight=ISPosLib.getHeight(h)}h.style.height=ISPosLib.getHeight(h)+e.ChartSettings.Height}e.EstimateChartHeight=e.ChartSettings.Height;e.EstimateChartWidth=e.FrameObj.clientWidth}e.ChartContainer=b}e.ChartContainer.style.display=(g?"":"none");if(!e.ChartInitialized){InitializeWGChart(e.Id)}},SetChartContainerSize:function(c,j){var d=c.EstimateChartHeight;var l=false;if(j&&c.LayoutSettings.InitialView=="Both"){l=true}if(c.LayoutSettings.StatusBarVisible&&!l){d-=document.getElementById("dvStatus_"+c.Name).offsetHeight}var b=c.ChartContainer.children[0];b.style.width="100%";if(d>0&&!isNaN(d)){b.style.height=d+"px"}if(IS.IsXHTMLDocType()){var g=c.ChartInteractiveUI.GetChartInnerContainer();var a=g.children[0];var k=WG50Engine.GetTR(g);var m=WG50Engine.GetTable(k);g.style.height="auto";if(IS.ie&&!c.UseCssFramework){if(IS.GetIEVersion()>=8){for(var f=0;f<m.rows.length;f++){if(m.rows[f]!=k){m.rows[f].style.height="1px"}}a.style.height=g.clientHeight+"px"}else{var e=0;for(var f=0;f<m.rows.length;f++){if(m.rows[f]!=k){e+=m.rows[f].clientHeight}}g.style.height=(d-e)+"px";a.style.tableLayout="fixed";setTimeout(function(){a.style.tableLayout=""},0)}}else{var e=0;for(var f=0;f<m.rows.length;f++){if(m.rows[f]!=k){e+=m.rows[f].clientHeight}}g.style.height=(d-e)+"px"}}b.style.overflow="hidden"},AutoResize:function(d,e,c){var a=d.ChartInteractiveUI;if(d.LayoutSettings.InitialView!="Both"&&a!=null){var b=a.GetChartContainer();if(b==null){return}var k=d.FrameObj.parentElement;var i=0;var j=0;var g=a.GetChartImageElement();var l=b.offsetHeight;var f=false;if(IS.moz){k=d.FrameObj}g.style.display="none";b.style.height=10;i=k.clientHeight;j=k.clientWidth;if(d.RootTable.TableHeaderVisible){i-=20}if(d.EstimateChartHeight!=i||d.EstimateChartWidth!=j||c){if(a.ResizeTimeoutID>0){clearTimeout(a.ResizeTimeoutID)}if(a.ResizeQueue==0){f=true;a.ResizeTimeoutID=setTimeout(function(){WGChartEngine.ResizeImage(a)},500)}else{a.ResizeQueue++;g.style.display=""}}else{if(a.ResizeTimeoutID==0){g.style.display=""}}if(f){d.EstimateChartHeight=i;d.EstimateChartWidth=j;WGChartEngine.SetChartContainerSize(d)}else{b.style.height=l}d.ResizedInGridView=false}},ResizeImage:function(a){var b=a.Parent;if(!b.IsInProgress){a.RefreshChart()}a.ResizeTimeoutID=0;a.ResizeQueue=0},CreateChartUI:function(h){var i=ISGetObject(h);var j=i.LayoutSettings.ImageSettings;var g=h+"_ChartMap";var a=h+"_ChartContainer";var d=h+"_ChartInnerContainer";var c=h+"_ChartImage";var e=h+"_ChartLoader";var b="WG5CE-CCS";var f="WG5CE-CLS";var k=i.GetString("Charting/Loading");var l='<div id="'+a+'" class="'+b+'"><table cellspacing="0" cellpadding="0" style="width: 100%; height: 100%"><tr style="height:100%"><td id="'+d+'" style="padding: 2px 2px 0px 2px; height: 100%; width: 100%"><table style="height: 100%; width: 100%" cellpadding="0" cellspacing="0"><tr><td style="height: 100%; width: 100%"><div style="height: 100%; width: 100%"><img id="'+c+'" style="display:none"/><table style="height: 100%; width: 100%" cellpadding="0" cellspacing="0" class="'+f+'" id="'+e+'"><tr><td><img alt="Loading" src="'+i.ResolveImagePathEx(j.InProgressImage)+'" border="0"/><br />'+k+'</td></tr></table></div></td></tr></table></td></tr></table></div><div id="'+g+'"></div>';return l},UpdateChanges:function(a){IS.SetModifiedPropertiesToXml(a,a.XmlNode,true);a.LightModelSettings.LightSources.UpdateChanges(true)},ChartingResponse:function(b,d,e){var a=b.ChartInteractiveUI;if(d!=null&&d!=""){var c=a.GetChartImageElement();c.src="ISChart.axd?imageId="+d+"&imageFileServer="+b.ImageFileServer+"&imageFormat="+b.ChartSettings.ImageFormat;if(typeof(e)!="undefined"){c.useMap="#"+e}a.HideLoaderImage();if(a.Parent.ChartMode=="InteractiveUI"){a.HideUpdateText();a.GetChartStatusElement().style.display="none"}}b.SetStatus1("","ready","CommonText/Ready");return true},PrepareCharting:function(b,d,c,a){if(b.ChartSettings.Width==0||b.ChartSettings.Height==0){return false}d.setAttribute("action","Charting");b.SetStatus1("","","Charting/Loading");b.ChartSettings.UpdateChanges();b.ChartDataCollection.UpdateChanges();b.ChartFilterCollection.UpdateChanges();b.ChartSeriesCollection.UpdateChanges();b.ChartCategoryCollection.UpdateChanges();if(b.ChartMode=="InteractiveUI"){b.ChartInteractiveUI.UpdateChanges()}return true},PreparePivotDataRetrieval:function(b,d,c,a){d.setAttribute("action","RetrievePivotData");d.setAttribute("PivotDataMember",b.ChartInteractiveUI.LastPivotInfo.PivotObject.Name);return true},ResponseCharting:function(c,m){var e=ISXml.GetNodeText(m,"//imageId");var f=ISXml.GetNodeText(m,"//imageMap");var b=c.ChartInteractiveUI.GetChartMap();b.innerHTML="";if(f!=null&&f!=""){var h=f.indexOf("<MAP");f=f.substring(h);var l=document.createElement("div");l.innerHTML=f;var j=l.children[0].name;var g=l.children[0];b.innerHTML=g.outerHTML;g=b.children[0];g.style.border="0px";for(var d=0;d<g.children.length;d++){var a=g.children[d];a.setAttribute("controlId",c.Id);if(a.attributes.cursor==null&&d==g.children.length-1){g.removeChild(a);continue}Listener.Unload(a);Listener.Add(a,"onclick",WGChartEngine.OnAreaClick,a);Listener.Add(a,"ondblclick",WGChartEngine.OnAreaDblClick,a);Listener.Add(a,"onmouseover",WGChartEngine.OnAreaMouseOver,a);Listener.Add(a,"onmouseout",WGChartEngine.OnAreaMouseOut,a)}}WGChartEngine.ChartingResponse(c,e,j);if(c.ChartMode=="InteractiveUI"){var k=ISXml.GetNode(m,"//ChartPivotDataCollection");WGChartUIEngine.RetrivePivotDataResponse(c,k)}c.ChartInteractiveUI.ResponseTimeoutID=setTimeout(function(){WGChartEngine.OnResponseLatency(c)},100);return true},OnAreaClick:function(){var a=this;var b="";if(a.attributes._onclick!=null){b=a.attributes._onclick.value}WGChartEngine.OnAreaEvent(a,b)},OnAreaDblClick:function(){var a=this;var b="";if(a.attributes._ondblclick!=null){b=a.attributes._ondblclick.value}WGChartEngine.OnAreaEvent(a,b)},OnAreaMouseOver:function(){var a=this;var b=a.attributes.controlId.value;var c="";if(a.attributes.cursor!=null){c=a.attributes.cursor.value}var e="";if(a.attributes._onmouseover!=null){e=a.attributes._onmouseover.value}WGChartEngine.OnAreaEvent(a,e);var d=ISGetObject(b);d.ChartInteractiveUI.GetChartImageElement().style.cursor=c},OnAreaMouseOut:function(){var a=this;var b=a.attributes.controlId.value;var d="";if(a.attributes._onmouseout!=null){d=a.attributes._onmouseout.value}WGChartEngine.OnAreaEvent(a,d);var c=ISGetObject(b);c.ChartInteractiveUI.GetChartImageElement().style.cursor="default"},OnAreaEvent:function(b,g){if(g!=null&&g!=""){var c=b.attributes.controlId.value;var f=b.attributes.label.value;var h=b.attributes.value.value;var e=b.attributes.index.value;var a=unescape(b.attributes.aggregate.value);var d=unescape(b.attributes.filterExpression.value);if(!ISEvent.Raise(g,c,f,h,e,a,d)){return}}},OnResponseLatency:function(a){a.ChartInteractiveUI.ResponseTimeoutID=0}};