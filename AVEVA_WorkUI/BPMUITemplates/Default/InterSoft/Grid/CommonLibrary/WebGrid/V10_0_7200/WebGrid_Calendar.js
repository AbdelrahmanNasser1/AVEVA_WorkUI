var isCAL={ntWeek:null,ntDay:null,isCalLoaded:false,dtObj:null,dtFunc:null,curSelDate:null,lastSelEl:null,curDoc:null,curGrid:null,curFormat:null,adjHeight:0,todayStyle:"todayStyle",selectedDayStyle:"selectedDayStyle"};function loadDatePicker(a,b){if(b.UseCssFramework){isCAL.selectedDayStyle="calendar-selected";isCAL.todayStyle="calendar-today"}if(!IS.ie){if(IS.IsHTML5DocType()){}else{if(IsGecko30()){a._e.style.backgroundColor="white"}else{if(IS.safari){a._e.children[0].style.backgroundColor="white"}else{a._e.childNodes[4].style.backgroundColor="white"}}}a._e.style.overflow="visible";a._e.style.mozUserFocus="none"}var c=new Date();isCAL.curDoc=a;isCAL.curGrid=b;fillYear();setDate(c);setImages(b);setupGlobalization();isCAL.isCalLoaded=true}function setImages(c){var b=c.ResolveImagePathEx("BtnPrev.gif");var a=c.ResolveImagePathEx("BtnNext.gif");isCAL.curDoc.getElementById("btnPrev").src=b;isCAL.curDoc.getElementById("btnNext").src=a}function setObject(b,a){isCAL.dtObj=b;isCAL.curGrid=a}function setFunction(a){isCAL.dtFunc=a}function addOption(b,f,e){var a=isCAL.curDoc.getElementById(b);var d=isCAL.curDoc.createElement("option");d.text=e;d.value=f;a.options.add(d)}function setStartYear(e){var b=new Date();var d=b.getFullYear()+20-e;var a=isCAL.curDoc.getElementById("cbYear");clearCombo(a);a.remove(0);for(var c=1;c<=d;c++){addOption("cbYear",e+c,e+c)}}function fillYear(){for(var a=1;a<=50;a++){addOption("cbYear",1980+a,1980+a)}}function selectIndex(c,d){var a=isCAL.curDoc.getElementById(c);var b=0;if(a!=null){for(i=0;i<a.options.length;i++){if(a.options[i].value==d){b=i}}a.selectedIndex=b}}function setDate(a,c){if(typeof(a)!="object"&&typeof(a)!="string"){return null}if(typeof(a)=="string"){a=new Date(Date.parse(a))}var d=a.getMonth()+1;var e=a.getFullYear();curSelDate=a;selectIndex("cbMonth",d.toString());selectIndex("cbYear",e.toString());if(c!=null){var b=getCalendar(isCAL.curDoc.getElementById("cbMonth").value,isCAL.curDoc.getElementById("cbYear").value,c);return b}else{getCalendar(isCAL.curDoc.getElementById("cbMonth").value,isCAL.curDoc.getElementById("cbYear").value)}}function ensureVisible(){setTimeout("_ensureVisible()",50)}function _ensureVisible(){if(isCAL.curGrid.UseCssFramework){wg_Global.CalPopObj.show(ISPosLib.getLeftW3C(isCAL.dtObj),ISPosLib.getTopW3C(isCAL.dtObj)+isCAL.dtObj.offsetHeight,null,null,null,true,true)}else{wg_Global.CalPopObj.show(ISPosLib.getScreenLeft(isCAL.dtObj),ISPosLib.getScreenTop(isCAL.dtObj)+isCAL.dtObj.offsetHeight,180,147+isCAL.adjHeight)}}function getCalendar(f,o,b){var h=new Array(7);var j=new Array(7);var k=new Array(7);var l=new Array(7);var m=new Array(7);var n=new Array(7);var c,p,d,q,r,g,e;r=new Date();q=new Date(o,f-1,1);d=getLastDay(f,o);p=q.getDay()+1;var a=isCAL.curDoc.getElementById("dpCalGrid");if(typeof(isCAL.ntDay)=="number"){a.rows[isCAL.ntWeek].cells[isCAL.ntDay].className="";isCAL.ntDay="undefined";isCAL.ntWeek="undefined"}if(isCAL.lastSelEl){isCAL.lastSelEl.className="";isCAL.lastSelEl=null}for(c=1;c<=d;c++){if(p<=7){h[p]=c;g=1;e=p}if(p>7&&p<=14){j[p-7]=c;g=2;e=p-7}if(p>14&&p<=21){k[p-14]=c;g=3;e=p-14}if(p>21&&p<=28){l[p-21]=c;g=4;e=p-21}if(p>28&&p<=35){m[p-28]=c;g=5;e=p-28}if(p>35&&p<=42){n[p-35]=c;g=6;e=p-35}if(c==r.getDate()&&f==r.getMonth()+1&&o==r.getFullYear()){if(b!=null){return a.rows[g-1].cells[e-1]}a.rows[g-1].cells[e-1].className=isCAL.todayStyle;isCAL.ntWeek=g-1;isCAL.ntDay=e-1}if(curSelDate){if(c==curSelDate.getDate()&&f==curSelDate.getMonth()+1&&o==curSelDate.getFullYear()){isCAL.lastSelEl=a.rows[g-1].cells[e-1];if(IS.IsHTML5DocType()&&IS.ie9&&!IS.ie11){window.setTimeout(function(){isCAL.lastSelEl.className=isCAL.selectedDayStyle},50)}else{isCAL.lastSelEl.className=isCAL.selectedDayStyle}}}p++}for(c=1;c<=7;c++){if(typeof(h[c])=="undefined"){h[c]=" "}if(typeof(j[c])=="undefined"){j[c]=" "}if(typeof(k[c])=="undefined"){k[c]=" "}if(typeof(l[c])=="undefined"){l[c]=" "}if(typeof(m[c])=="undefined"){m[c]=" "}if(typeof(n[c])=="undefined"){n[c]=" "}}for(c=1;c<=7;c++){a.rows[0].cells[c-1].innerText=h[c];a.rows[1].cells[c-1].innerText=j[c];a.rows[2].cells[c-1].innerText=k[c];a.rows[3].cells[c-1].innerText=l[c];a.rows[4].cells[c-1].innerText=m[c];a.rows[5].cells[c-1].innerText=n[c]}}function goPrev(){var c,d;var a=isCAL.curDoc.getElementById("cbMonth");var b=isCAL.curDoc.getElementById("cbYear");if(a.value==1){c=12;d=b.value-1}else{c=a.value-1;d=b.value}a.value=c;b.value=d;getCalendar(c,d)}function goNext(){var c,d;var a=isCAL.curDoc.getElementById("cbMonth");var b=isCAL.curDoc.getElementById("cbYear");if(a.value==12){c=1;d=parseInt(b.value)+1}else{c=parseInt(a.value)+1;d=b.value}a.value=c;b.value=d;getCalendar(c,d)}function dayClick(){var strDay;if(typeof(isCAL.dtObj)!="object"){alert("Object required !!");return}var evt=wg_Global.CalPopObj.document.parentWindow.event;var cbMonth=isCAL.curDoc.getElementById("cbMonth");var cbYear=isCAL.curDoc.getElementById("cbYear");if(evt.srcElement.innerText==" "){return null}strDay=evt.srcElement.innerText;if(strDay.length>2){strDay=strDay.substr(0,2)}if(isNaN(parseFloat(strDay))){return null}setResultDate(strDay,parseFloat(cbMonth.value)-1,cbYear.value);if(typeof(isCAL.dtFunc)=="string"){eval(isCAL.dtFunc)}if(IS.IsHTML5DocType()&&IS.ie9&&!IS.ie11){if(isCAL.lastSelEl){var today=new Date();if(today.getFullYear().toString()==cbYear.value){var todayEl=setDate(today,"highlightToday");todayEl.className=isCal.todayStyle}isCAL.lastSelEl.className="";isCAL.lastSelEl=null}}ISHideCal()}function setResultDate(d,e,f){if(isCAL.curFormat==""){isCAL.curFormat="d"}var a=new ISClientData(null,"datetime",isCAL.curFormat);var b=new ISDateData(d,e,f,0,0,0,0,0,0);ISEvent.Raise(isCAL.curGrid.LayoutSettings.ClientSideEvents.OnCalendarSelect,isCAL.curGrid.Name,isCAL.dtObj,f,e,d);a.DateData=b;a.MatchDateFormat=isCAL.curFormat;var c=new ISDateTimePattern(a,isCAL.curGrid.CultureInfo.DateTimeFormatInfo);c.CreatePattern();c.MaskData();isCAL.dtObj.value=a.FormattedValue;WGEditEngine.MarkEdit(isCAL.curGrid);isCAL.dtObj.isDirty=true}function setToday(){var a=new Date();setResultDate(a.getDate(),a.getMonth(),a.getFullYear());ISHideCal()}function setNone(){isCAL.dtObj.value="";WGEditEngine.MarkEdit(isCAL.curGrid);isCAL.dtObj.isDirty=true;ISHideCal()}function ISHideCal(){wg_Global.CalPopObj.hide();isCAL.dtObj.focus()}function __IsLeapYear(c){if(c!=null){if(c.toString().length==2){if(parseFloat(c)>=70){c="19"+c.toString()}else{c="20"+c.toString()}}}else{var a=new Date();c=a.getFullYear()}c=parseFloat(c);var b=false;if((c%4)==0){if((c%100)==0){if((c%400)==0){b=true}}else{b=true}}return b}function getLastDay(c,d){var a=new Array(31,28,31,30,31,30,31,31,30,31,30,31);var b;c=parseFloat(c);if(c+1>12){c=0}else{c--}if(__IsLeapYear(d)){a[1]=29}if(parseFloat(c)<12){b=a[parseFloat(c)]}else{b=32}return b}function calKBHandler(){var a=wg_Global.CalPopObj.document.parentWindow.event;if(a.keyCode==27){ISHideCal()}}function setupGlobalization(){var e=isCAL.curDoc.getElementById("cbMonth");var g=isCAL.curDoc.getElementById("trDayDesc");var b=isCAL.curGrid.CultureInfo.DateTimeFormatInfo.AbbreviatedMonthNames;for(var f=0;f<12;f++){e.options[f].text=b[f]}var a=isCAL.curGrid.CultureInfo.DateTimeFormatInfo.AbbreviatedDayNames;for(var f=0;f<7;f++){g.cells[f].innerText=a[f]}var d=isCAL.curDoc.getElementById("Button1");var c=isCAL.curDoc.getElementById("Button2");d.value=isCAL.curGrid.GetString("CommonText/CalendarToday");c.value=isCAL.curGrid.GetString("CommonText/CalendarNone")}if(typeof(Sys)!="undefined"){Sys.Application.notifyScriptLoaded()};