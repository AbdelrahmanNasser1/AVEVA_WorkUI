var WG5EditEngine={RTBEditHandler:function(a,b,f,e){var c=a.element;var d=ISGetObject(a.gridId);if(!d.RTBObj){var h=WG5EditEngine.CreateResizableTextbox(d);var j=h.children[0];j.attachEvent("onfocus",WGEditEngine.OnTextBoxFocus);j.onselectstart=function(){event.cancelBubble=true;return true};j.onkeydown=function(){WGEditEngine.EditControlKeyboardHandler(d)};j.attachEvent("onpaste",function(){WGEditEngine.EditControlPasteHandler(d)});d.RTBObj=h}var g=d.RTBObj;var i=g.children[0];wgDispObjGeneric(d,g,c,0,0,true,"ResizableTextbox");g.style.width=c.offsetWidth+(d.IsElegantDefaultStyle()?5:0)+"px";g.style.paddingLeft="0px";g.style.paddingTop="0px";g.style.overflow="visible";if(b.TextboxMaxlength){i.maxLength=b.TextboxMaxlength}i.value=(c.innerText==" "?"":c.innerText);if(e){g.isDirty=true}else{g.isDirty=false}i.focus();return g},CreateResizableTextbox:function(b){var a=document.createElement("div");var e=40;a.className=b.LayoutSettings.TextBoxClass;a.style.cssText="background-color:white; position:absolute; display:none; height:64px";if(b.IsElegantDefaultStyle()){e=(IS.moz?38:40)}else{a.style.border="darkgray 1px solid"}a.innerHTML="<textarea style='width:100%; height:"+e+"px; border:0px;'></textarea><div title='Drag to move' style='cursor:move; position:relative; width:100%; height:20px;border-top:darkgray 1px solid; background-color:white'><div title='Drag to resize' style='width:18px; background-image:url("+b.ResolveImagePathEx("wg5_resize.gif")+");background-repeat:no-repeat; cursor:se-resize; position:absolute; right:0px; height:17px'></div></div>";b.FrameObj.appendChild(a);var f=a.children[0];f.style.fontFamily=a.currentStyle.fontFamily;f.style.fontSize=a.currentStyle.fontSize;var c=new MovableObject();c.HandleElement=a.children[1];c.DragElement=a;c.OffsetElement=f;c.AdjustTop=-3;c.Initialize();var d=new ResizableObject();d.HandleElement=a.children[1].children[0];d.DragElement=a;d.OffsetElement=a.children[1];d.OnResize=WG5EditEngine.OnRTBResize;d.ObjectContext=b;d.Initialize();return a},OnRTBResize:function(e,f,d){var b=e.DragElement;var a=0;var c=e.ObjectContext;if(c.IsElegantDefaultStyle()){a=2}b.children[0].style.height=d-(IS.ie&&!IS.IsHTML5DocType()?10:24+a)+"px"}};function MovableObject(){this.HandleElement=null;this.DragElement=null;this.GrabX=0;this.GrabY=0;this.Type="MovableObject";this.OffsetElement=null;this.AdjustTop=0;this.Initialize=function(){GenericDragDrop.Objects.push(this)}}function ResizableObject(){this.HandleElement=null;this.DragElement=null;this.OffsetElement=null;this.GrabX=0;this.GrabY=0;this.Type="ResizableObject";this.Width=0;this.Height=0;this.OnResize=null;this.ObjectContext=null;this.Initialize=function(){GenericDragDrop.Objects.push(this)}}var GenericDragDrop={Objects:[],LastObjectContext:null,OnMouseDown:function(){var a=event.srcElement;for(var b=0;b<GenericDragDrop.Objects.length;b++){var c=GenericDragDrop.Objects[b];if(c.HandleElement==a){if(c.Type=="ResizableObject"){c.Width=c.DragElement.offsetWidth;c.Height=c.DragElement.offsetHeight;c.GrabX=event.clientX;c.GrabY=event.clientY}else{c.GrabX=event.clientX-ISPosLib.getLeft(a);c.GrabY=event.clientY-ISPosLib.getTop(a)}GenericDragDrop.LastObjectContext=c;break}}},OnMouseMove:function(){if(GenericDragDrop.LastObjectContext!=null){var c=GenericDragDrop.LastObjectContext;var a=c.DragElement;if(c.Type=="MovableObject"){a.style.position="absolute";a.style.left=(event.clientX-c.GrabX)+"px";a.style.top=event.clientY-c.GrabY-(c.OffsetElement?ISPosLib.getHeight(c.OffsetElement):0)+c.AdjustTop+"px"}else{var d=c.Width+event.clientX-c.GrabX;var b=c.Height+event.clientY-c.GrabY-(IS.ie&&!IS.IsHTML5DocType()?15:0);if(d<100||isNaN(d)){d=100}if(b<30||isNaN(b)){b=30}a.style.width=d+"px";a.style.height=b+"px";if(typeof(c.OnResize)=="function"){c.OnResize(c,d,b)}}event.returnValue=false;event.cancelBubble=true}},OnMouseUp:function(){GenericDragDrop.LastObjectContext=null},Dispose:function(){GenericDragDrop.Objects=null;document.body.detachEvent("onmousedown",GenericDragDrop.OnMouseDown);document.body.detachEvent("onmousemove",GenericDragDrop.OnMouseMove);document.body.detachEvent("onmouseup",GenericDragDrop.OnMouseUp)}};document.body.attachEvent("onmousedown",GenericDragDrop.OnMouseDown);document.body.attachEvent("onmousemove",GenericDragDrop.OnMouseMove);document.body.attachEvent("onmouseup",GenericDragDrop.OnMouseUp);window.attachEvent("onunload",GenericDragDrop.Dispose);if(typeof(Sys)!="undefined"){Sys.Application.notifyScriptLoaded()};