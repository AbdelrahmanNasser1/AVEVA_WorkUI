function WebGridSubTables(a,b,c){this._Type="WebGridSubTables";ISObject.call(this);this.SubId=b;this.TblName=c;this.GridId=a;this.Id=this.TblName+"_"+this.SubId;this.ParentPos="";this.Position=0;this.UniqueConstraints="";this.RelNames="";this.PositionUpdated=false;this.Width=0;this.LastRowPosition=-1;this.GetContainer=function(){return document.getElementById("dvCH_"+this.GridId+"_"+this.TblName+"_"+this.SubId).parentElement};this.GetElement=function(e,f){if(e==WG40.COLHEADER||e==WG40.COLFOOTER||e==WG40.BODY){if(f==WG40.HTMLDIV){return document.getElementById(f+e+"_"+this.GridId+"_"+this.TblName+"_"+this.SubId)}else{if(e==WG40.COLHEADER&&this.GetGrid().EnableSection508Standards){return this.GetElement(WG40.BODY,WG40.HTMLTABLE)}var d=this.GetElement(e,WG40.HTMLDIV);return d.childNodes[0]}}else{var g;if(e==WG40.COLGROUP){g=this.GetElement(WG40.BODY,WG40.HTMLTABLE)}else{if(e==WG40.COLHEADERGROUP){g=this.GetElement(WG40.COLHEADER,WG40.HTMLTABLE)}else{if(e==WG40.COLFOOTERGROUP){g=this.GetElement(WG40.COLFOOTER,WG40.HTMLTABLE)}}}return g.childNodes[0]}};this.GetParentRow=function(){return WG50Engine.GetParentElement(document.getElementById("dvCH_"+this.GridId+"_"+this.TblName+"_"+this.SubId),3)};this.GetParentRecordRow=function(){var d=this.GetParentRow();return wgGetRootRow(wgGetPreviousRow(wg_getTable(d),d))};this.GetFooterCellByName=function(e){var g=this.GetElement(WG40.COLFOOTER,WG40.HTMLTABLE);var h=this.GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0];var f=-1;for(var d=0;d<h.cells.length;d++){if(h.cells[d].colName==e){f=d;break}}return g.rows[1].cells[f]};this.GetRow=function(e){var h=this.GetElement(WG40.BODY,WG40.HTMLTABLE);var f=wgGetRowByPositionExact(h,e);var g=ISGetObject(this.GridId).Tables[this.TblName];if(!f){return null}var d=new WebGridRow(g,this);d.Setup(f);return d};this.GetRowByGroup=function(d,e,h){var j=this.GetElement(WG40.BODY,WG40.HTMLTABLE);var g=wgGetRowByGroup(j,d,e,h);var i=ISGetObject(this.GridId).Tables[this.TblName];if(!g){return null}var f=new WebGridRow(i,this);f.Setup(g);return f};this.GetRowByKeyValue=function(e){var j=this.GetElement(WG40.BODY,WG40.HTMLTABLE);var h=null;for(var d=0;d<j.rows.length;d++){var g=j.rows[d];WG50Engine.EmulateAttributes(g);if(wgIsRecordRow(g)&&g.keyValue==e){h=g;break}}if(!h){return null}var f=new WebGridRow(this.GetTable(),this);f.Setup(h);return f};this.SelectRow=function(e){var f;var d=null;if(typeof(e)=="number"){f=this.GetElement(WG40.BODY,WG40.HTMLTABLE).rows[e]}else{f=e}if(wgIsRecordRow(f)||f.type=="FilterRow"){d=wgGetCellByPosition(f,0)}else{if(f.type=="NewRow"){d=f.cells[f.cells.length-1]}}WGEventEngine.ProcessMouseEvents(d);d.focus()};this.GetRowsCount=function(){var g=this.GetElement(WG40.BODY,WG40.HTMLTABLE);var d=g.rows.length;if(d==0){return 0}var f=g.rows[d-1];var e=wgGetRootRow(f);if(e.type=="HierRecord"){e=wgGetPreviousRow(g,e)}return parseFloat(e.position)+1};this.GetConstraintXml=function(){var d=ISXml.CreateXmlDocument();ISXml.LoadXml(d,this.RelNames);return d};this.GetTable=function(){var d=ISGetObject(this.GridId);return d.Tables[this.TblName]};this.GetGrid=function(){return ISGetObject(this.GridId)};this.GetActualWidth=function(){var e=this.GetElement(WG40.COLHEADER,WG40.HTMLTABLE);var f=this.GetElement(WG40.BODY,WG40.HTMLTABLE);var g=e.offsetWidth;if(f.rows.length>0&&!this.GetTable().IsUseColumnSet){var d=wgGetRowByPositionExact(f,0);if(d){g-=d.cells[d.cells.length-1].offsetWidth}}return ISPosLib.getLeft(e)+g};return this}function wgProcessExpandedChilds(a){return WGHierEngine.ProcessExpandedChilds(a)}var WGHierEngine={CreateParentGroupByBoxRow:function(a){var b=a.GetGrid();var g=a.Table;var c=g.Parent.Id;var d=-1;while(c&&c!=""){var h=WGUIEngine.GetGroupByBoxRow(b.Id,c);if(h){d=h.rowIndex+1;break}var f=b.Tables[c];if(f.IsRootTable){c=null}else{c=f.Parent.Id}}c=g.Parent.Id;while(c&&c!=""){var h=WGUIEngine.GetGroupByBoxRow(b.Id,c);if(!h){var e=b.Tables[c];if(!e.IsRootTable){WGUIEngine.CreateGroupByBoxRowSeparator(e,d);d++}WGUIEngine.CreateGroupByBoxRow(e,d);d++}var f=b.Tables[c];if(f.IsRootTable){c=null}else{c=f.Parent.Id}}},RemoveParentGroupRow:function(f){var b=f.Grid;var c=f.Parent.Id;var d=-1;while(c&&c!=""){var g=WGUIEngine.GetGroupByBoxRow(b.Id,c);var a=b.Tables[c];if(g){if(a.GroupedColumns.length==0&&!a.HasChildTableGroupedColumns()){if(!a.IsRootTable){g.previousSibling.removeNode(true)}g.removeNode(true)}else{break}}var e=b.Tables[c];if(e.IsRootTable){c=null}else{c=e.Parent.Id}}},GetPreviousGroupByBoxRow:function(a,g){var m=WGUIEngine.GetGroupByBoxRow(a.GetGrid().Id,g).rowIndex;if(m>=0){var c=a.GetGrid();var o=a.Table;var h=o.Position;var k=c.Tables[g];var q=k.GetChildTables();var b=0;for(var d=0;d<h;d++){var p=q[d];var l=WGUIEngine.GetGroupByBoxRow(a.Grid.Id,p.Name);if(l){b+=2;var n=0;var f=this.GetParentTables();for(var e=0;e<f.length;e++){if(f[e].GroupedColumns.length>0){n++}}b+=(n*2)}}}return m+b},RenderTreeStructure:function(b,d){var a=b.LayoutSettings.GroupByBox.ConnectorLineColor+" 1px "+b.LayoutSettings.GroupByBox.ConnectorLineStyle;var c="";var e="50%";if(IS.moz){e="47%"}switch(d){case"Last":c="<table style='HEIGHT: 50%; FONT-SIZE: 1px; BORDER-LEFT: "+a+" ; BORDER-BOTTOM: "+a+"' cellSpacing=0 cellPadding=0 width='"+e+"' border=0><tr style='HEIGHT: 50%' height='50%'><td style='WIDTH: 50%' noWrap>&nbsp;</td></tr></table>";break;case"I":c="<table style='HEIGHT: 100%; FONT-SIZE: 1px;' cellSpacing=0 cellPadding=0 width=100% border=0><tr><td style='WIDTH: 50%' noWrap>&nbsp;</td><td style='BORDER-LEFT: "+a+"'>&nbsp;</td></tr></table>";break;case"Continuos":c="<table style='HEIGHT: 100%; FONT-SIZE: 1px; BORDER-LEFT: "+a+"' cellSpacing=0 cellPadding=0 width='"+e+"' border=0><tr style='HEIGHT: 50%' height='50%'><td style='WIDTH: 50%' noWrap>&nbsp;</td><td>&nbsp;</td></tr><tr style='HEIGHT: 50%'><td style='WIDTH: 50%; BORDER-TOP: "+a+"' noWrap>&nbsp;</td><td style='WIDTH: 50%; BORDER-TOP: "+a+"' noWrap>&nbsp;</td></tr></table>";break}return c},RefreshGroupByBoxTreeStructure:function(d){var m=d.GetElement(WG40.GROUPBYBOX,WG40.HTMLTABLE);for(var b=0;b<m.rows.length;b++){var h=m.rows[b];var j=h.id;var f=(j.indexOf("RowSep")!=-1);var l=j.substring(j.lastIndexOf("_")+1);if(l!=""){var k=d.Tables[l];if(k.IsRootTable){continue}var p=k.GetParentTreeStructure();var o=h.cells[0].childNodes[0].childNodes[0].childNodes[0];for(var e=1;e<parseFloat(k.TableLevel);e++){var c=o.cells[e-1];if(e==parseFloat(k.TableLevel)||p[e]=="Continuos"){c.innerHTML=WGHierEngine.RenderTreeStructure(d,"I")}else{c.innerHTML=""}}if(!f){var n=k.GetParentTables().length;var g=0;if(!k.IsRootTable){g=k.TableLevel-1}var c=o.cells[g];c.align="right";c.valign="middle";if(n==1||n>1&&!k.HasNextSiblingGroupedColumns()){c.innerHTML=WGHierEngine.RenderTreeStructure(d,"Last")}else{c.innerHTML=WGHierEngine.RenderTreeStructure(d,"Continuos")}}}}},AdjustParentTableWidth:function(c){var i=WG50Engine.GetColumnByElement(c);var f=i.GetGrid();var l=i.Table;var j=l.GetParentTables();var e=l.GetElement(WG40.BODY,WG40.HTMLDIV,c.parentElement).offsetWidth;var d=l.GetContainer(c.parentElement);var b=d.offsetWidth;if(e>b){var k=e-b+17;var h=f.GetRootTable();var a=h.GetElement(WG40.COLGROUP);var g=a.childNodes[a.childNodes.length-1];g.width=parseFloat(g.width)+k;a=h.GetElement(WG40.COLHEADER,WG40.HTMLTABLE);g=a.rows[0].cells[a.rows[0].cells.length-1];WG50Engine.SetColHeaderPaddingWidth(h,g,parseFloat(g.style.width)+parseFloat(k));g.locked=true}},MoveSubTableColumn:function(){var b=wg_Global.MoveColEventArgs;var d=b.table;var e=b.tr;var c=wg_getTableSubId(e);for(var a=0;a<d.SubTableIds.length;a++){if(d.SubTableIds[a].SubId!=c){wg_Global.MoveColEventArgs.th.Element=d.SubTableIds[a].GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0].cells[b.c1];wg_Global.MoveColEventArgs.cdt=d.SubTableIds[a].GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0].cells[b.c2];wg_Global.MoveColEventArgs.tr=d.SubTableIds[a].GetElement(WG40.COLHEADER,WG40.HTMLTABLE);WGUIEngine.MoveColumn(true)}}},ResizeSubTableColumn:function(){var a=wg_Global.ColSizeTarget;var h=a.parentElement;if(!h||a.type=="CSHeader"){return}var b=WG50Engine.GetGridByElement(h);var g=WG50Engine.GetTableByElement(h);var e=WG50Engine.GetTableSubId(h);for(var d=0;d<g.SubTableIds.length;d++){if(g.SubTableIds[d].SubId!=e){if(g.IsUseColumnSet){wg_Global.ColSizeTarget=g.SubTableIds[d].GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[h.rowIndex].cells[a.cellIndex];wg_Global.ColSizeTarget.EstWidth=a.estWidth}else{wg_Global.ColSizeTarget=g.SubTableIds[d].GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0].cells[a.cellIndex];wg_Global.ColSizeTarget.EstWidth=a.style.posWidth}wg_Global.ColSizeTarget.gridId=g.GridId;wg_Global.ColSizeTarget.tblName=g.Id;WGUIEngine.OnColumnHeaderMouseUp(true)}WGHierEngine.AlignTableHeader(g.SubTableIds[d])}if(g.SubTableIds.length>0){var f=g.SubTableIds[0];setTimeout(function(){WGHierEngine.AdjRootWidth(f)},1)}},ResizeSubTableColumnBestFit:function(a,f){var g=WG50Engine.GetColumnByElement(a);var d=g.GetGrid();var j=g.Table;var l=a.style.posWidth;var k=a.parentElement;var h=wg_getTableSubId(k);for(var e=0;e<j.SubTableIds.length;e++){if(j.SubTableIds[e].SubId!=h){if(j.IsUseColumnSet){var b=j.SubTableIds[e].GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[k.rowIndex].cells[a.cellIndex];WGUIEngine.ResizeColumn(j,b,f,true)}else{var b=j.SubTableIds[e].GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0].cells[a.cellIndex];WGUIEngine.ResizeColumn(j,b,l,true)}}}},ChangeImage:function(b,a,c){if(b.UseCssFramework){return}if(c=="False"){imgSrc=b.ResolveImagePathEx("min-xp.gif")}else{imgSrc=b.ResolveImagePathEx("plus-xp.gif")}td=a.childNodes[0].childNodes[0].rows[1].cells[0];td.style.backgroundImage="url("+imgSrc+")"},IsChildrenLoaded:function(b,c){var f=c.children[c.children.length-1];if(f.children.length>0){var a=f.children[0];var e=b.Tables[a.tblName];var d=e.GetSubTableById(a.subId);if(d){return true}}return false},ToggleRow:function(p,q){var d;var g;var j="";var a="";if(p){d=WGHierEngine.GetRecordRow(p);g=WGHierEngine.GetRow(p)}else{if(q){d=q;g=wgGetHierRecord(q);g.expanded=q.childExpanded}else{return}}if(typeof(g.expanded)=="undefined"){g.expanded="False"}var e=ISGetObject(wg_getGridNameByRow(d));var n=e.Tables[d.tblName];if(!n){n=e.Tables[wg_getTableNameByRow(d)]}if(g.expanded=="False"){j=e.ResolveImagePathEx("min-xp.gif")}else{j=e.ResolveImagePathEx("plus-xp.gif")}if(!e.UseCssFramework&&p){p.style.backgroundImage="url("+j+")"}var k=false;if(p){for(var h=0;h<d.cells.length;h++){WG50Engine.EmulateAttributes(d.cells[h]);if(d.cells[h].type=="Cell"){WGEventEngine.ProcessMouseEvents(d.cells[h],true);break}}}if(g.expanded=="False"){a="expand";if(!ISEvent.Raise(e.LayoutSettings.ClientSideEvents.OnChildRowExpand,e.Name,n.Id,d.rowIndex,d)){return}if(g.childrenLoaded=="True"||WGHierEngine.IsChildrenLoaded(e,g)){g.style.display="";k=true}else{d.tblName=wg_getTableNameByRow(d);WG50Engine.ExecuteFlyPostback(e.Name,"LoadChild",d)}if(e.LayoutSettings.RestoreExpandedChildRows){n.Storage.ExpandedChildRows.Add(d)}g.expanded="True"}else{a="collapse";if(!ISEvent.Raise(e.LayoutSettings.ClientSideEvents.OnChildRowCollapse,e.Name,n.Id,d.rowIndex,d)){return}g.style.display="none";g.expanded="False";k=true;if(e.LayoutSettings.RestoreExpandedChildRows){n.Storage.ExpandedChildRows.Remove(d)}}if(IS.moz||IS.opera){if(k&&!n.IsRootTable){var m=n.GetParentRow(d);while(m!=null){var o=wg_getTable(m);var l=wgGetNextRow(o,m);l.style.height="0px";l.style.height="";var b=l.cells[0];b.style.height="auto";setTimeout(function(){b.style.height="100%"},50);m=n.GetParentRow(m)}}var f=n.Grid;var c;if(a=="expand"&&IS.moz&&f.ForceFullColumnWidth&&g.childrenLoaded=="True"&&!g.FullColumnWidthInitialized){WGMozEngine.ForceFullColumnWidth(d,n);if(n.ChildTables.length>0){c=n.ToRowObject(d).GetChildRows();if(c!=null&&c.length>0){WGMozEngine.ForceFullColumnWidth(c[0].GetElement(),n.ChildTables[0])}}}}d.childExpanded=g.expanded;d.setAttribute("childExpanded",g.expanded)},GetRecordRow:function(a){if(a.tagName=="DIV"){return WG50Engine.GetParentElement(a,2)}else{return WG50Engine.GetParentElement(a,5)}},GetRow:function(a){return wgGetHierRecord(WGHierEngine.GetRecordRow(a))},PrepareXmlInfo:function(b,h,f){WG50Engine.EmulateAttributes(f);var a=WGUIEngine.GetParentIndex(f);var c="";if(!f.tblName){f.tblName=wg_getTableNameByRow(f)}var d=b.Tables[f.tblName];if(!d.IsRootTable){c=b.Tables[f.tblName].GetRecursiveParentRowPosition(f)}if(c!=""){a=c+"_"+a}h.setAttribute("position",f.position);h.setAttribute("parentPos",a);f.parentPos=a;f.uniqueConstraints=d.UniqueConstraints;h.setAttribute("uniqueConstraints",f.uniqueConstraints);WGHierEngine.CreateRelNames(b,h,f);if(!d.IsRootTable){var e=d.GetSubTableById(wg_getTableSubId(f));var g=e.GetParentRow();g=wgGetPreviousRow(b.Tables[wg_getTableNameByRow(g)].GetElement(WG40.BODY,WG40.HTMLTABLE,g),g);g=wgGetRootRow(g);WGHierEngine.CreateRelNames(b,h,g,"parentRelNames")}},CreateRelNames:function(a,f,c,b){var g=a.XmlReq;if(!b){b="relNames"}if(f.selectSingleNode("//"+b)){f.removeChild(f.selectSingleNode("//"+b))}WG50Engine.EmulateAttributes(c);var d=g.createNode(1,b,"");var e=g.createCDATASection(ISXml.EncodeAmpersand(c.relNames));d.appendChild(e);f.appendChild(d)},PrepareCustomRequestData:function(a){if(a.CustomRequestData){var e=a.XmlReq;var d=a.XmlReq.selectSingleNode("//request");if(d.selectSingleNode("//customReqData")){d.removeChild(d.selectSingleNode("//customReqData"))}var b=e.createNode(1,"customReqData","");var c=e.createCDATASection(a.CustomRequestData);b.appendChild(c);d.appendChild(b)}},PrepareLoadChild:function(a,d,b,c){WGHierEngine.PrepareXmlInfo(a,d,c);d.setAttribute("action","LoadChild");d.setAttribute("tblName",c.tblName);WGHierEngine.PrepareCustomRequestData(a);a.LastRequestObj=c;a.SetStatus1("","loadchild","CommonText/LoadChild");return true},GetChildContainer:function(a){return a.cells[a.cells.length-1]},AdjRootWidth:function(c,h,d,f,b){if(c.GetType()=="WebGridSubTables"){var g=c;c=c.GetGrid();h=g.GetParentRecordRow();d=g.GetParentRow();if(!f){f=g.GetActualWidth()}}var e=d.cells[d.cells.length-1];var a=ISPosLib.getLeft(e)+e.childNodes[0].offsetWidth;if(f>a+2){c.FixPadColumnWidth()}},ProcessExpandedChilds:function(l){var d=ISXml.CreateXmlDocument();d.loadXML(l);var e=wgGetGridById(d.documentElement.getAttribute("gridId"));var b=d.selectNodes("//ChildTable");for(var g=0;g<b.length;g++){var a=b[g];var h=a.getAttribute("fullSubId");var p=h.substring(0,h.indexOf("_"));var j=h.substring(h.indexOf("_")+1);var o=e.Tables[p];var k=new WebGridSubTables(e.Name,j,p);var q=k.GetParentRecordRow();var f=k.GetParentRow();k.ParentPos=a.getAttribute("parentPos");k.UniqueConstraints=o.UniqueConstraints;k.Position=q.position;k.RelNames=q.relNames;var m=o.GetSubTablePosById(j);if(m==-1){m=o.SubTableIds.length}o.SubTableIds[m]=k;var n=k.GetElement(WG40.COLHEADER,WG40.HTMLTABLE);var r=ISPosLib.getLeft(n)+n.offsetWidth;k.Width=r;WGHierEngine.AdjRootWidth(e,q,f,r);WGHierEngine.AdjRootWidth(e,q,f,r);if(IS.moz){WGMozEngine.FormatChildTable(k)}if(e.LayoutSettings.RestoreExpandedChildRows){WGHierEngine.ExpandAllRowsToRootPath(o,q)}if(o.Storage!=null){o.Storage.RefreshUI(k)}WGUIEngine.RealignSortIndicators(k)}},ResponseLoadChild:function(j,H){var d=ISXml.GetNodeText(H,"//htmlString");var F=j.LastRequestObj;var m=wg_getTable(F);var k=wgGetHierRecord(F);var r=j.Tables[F.tblName];var x=ISXml.GetNodeText(H,"//subIDs");var b=x.split(";");var c=j.LayoutSettings.ChildRowEmptyAction;var u=true;if(c!="ShowChildContent"){var v=ISXml.GetNodeText(H,"//rowCounts");var a=v.split(";");var o=true;for(var n=0;n<a.length;n++){if(parseFloat(a[n])>0){o=false;break}}if(o){if(c=="DisplayMessageBox"){msg=j.GetString("MessageBoxText/NoChildRow");alert(msg)}var p=WGHierEngine.GetCellExpander(F);var t=null;try{t=wgGetNextRow(m,F);t=wgGetNextRow(m,t)}catch(g){t=null}WGHierEngine.SetEmptyTree(j,p.childNodes[0],(t==null));u=false}}if(u){F=wgGetRootRow(F);for(var n=0;n<b.length-1;n++){var w=b[n];var D=w.substring(0,w.indexOf("_"));var y=w.substring(w.indexOf("_")+1);var C=j.Tables[D];var z=new WebGridSubTables(j.Name,y,D);z.ParentPos=F.parentPos;z.UniqueConstraints=F.uniqueConstraints;z.Position=F.position;z.RelNames=F.relNames;var A=C.GetSubTablePosById(y);if(A==-1){A=C.SubTableIds.length}C.SubTableIds[A]=z}var l=k.cells[k.cells.length-1];l.innerHTML=d;k.style.display="";var q=0;for(var n=0;n<b.length-1;n++){var w=b[n];var D=w.substring(0,w.indexOf("_"));var y=w.substring(w.indexOf("_")+1);var C=j.Tables[D];var z=C.GetSubTableById(y);var B=z.GetElement(WG40.COLHEADER,WG40.HTMLTABLE);var E=z.GetElement(WG40.BODY,WG40.HTMLTABLE);var f=B.parentElement;var G=B.offsetWidth;if(IS.moz){WGMozEngine.FormatChildTable(z)}else{if(IS.ie){WGHierEngine.InitializeIE7XHTML(z)}}if(E.rows.length>0&&!C.IsUseColumnSet){var h=wgGetRowByPositionExact(E,0);if(h){G-=h.cells[h.cells.length-1].offsetWidth}}z.Width=(ISPosLib.getLeft(l)-ISPosLib.getLeft(j.FrameObj))+G;if(G>q){q=G}WGHierEngine.AlignTableHeader(z);if(C.Storage!=null){C.Storage.RefreshUI(z)}WGUIEngine.RealignSortIndicators(z);WG50Engine.FixGroupAlignment(C,z)}setTimeout(function(){WGHierEngine.AdjRootWidth(j,F,k,z.Width)},1)}k.childrenLoaded="True";j.SetStatus1("","ready","CommonText/Ready")},AlignTableHeader:function(f){var g=f.GetElement(WG40.COLHEADER,WG40.HTMLTABLE);var a=g.parentElement;if(a.previousSibling!=null&&a.previousSibling.tagName=="TABLE"){var d=a.previousSibling;var c=g.rows[0];var b=0;for(var e=0;e<c.cells.length;e++){if(c.cells[e].getAttribute("type")){b+=c.cells[e].offsetWidth}}d.rows[0].children[1].children[0].style.width=b+1+"px"}},InitializeIE7XHTML:function(b){if(IS.GetIEVersion()<8&&IS.IsXHTMLDocType()){var c=b.GetElement(WG40.BODY,WG40.HTMLTABLE);var a=b.GetElement(WG40.COLHEADER,WG40.HTMLTABLE);if(c!=null){c.cellPadding=0;c.style.paddingLeft="1px"}if(a!=null){a.cellPadding=0}if(b.GetTable().GroupedColumns.length>0){WG50Engine.InitializeIE7XHTML_Table(b.GetTable(),b)}}},FitColumnsChild:function(h,a,d){var e=ISGetObject(a.gridId);var k=a.style.posWidth;var j=a.parentElement;var g=wg_getTableSubId(j);for(var f=0;f<h.SubTableIds.length;f++){if(h.SubTableIds[f].SubId!=g){if(h.IsUseColumnSet){var b=h.SubTableIds[f].GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[j.rowIndex].cells[a.cellIndex];WGUIEngine.ResizeColumn(h,b,d,true)}else{var b=h.SubTableIds[f].GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0].cells[a.cellIndex];WGUIEngine.ResizeColumn(h,b,k,true)}}}},PrepareAction:function(a,j){var b=ISGetObject(a.gridId);var f=b.Tables[a.tblName];if(!f.IsRootTable){j.setAttribute("subTblCount",f.SubTableIds.length);var e="";for(var c=0;c<f.SubTableIds.length;c++){var d=f.SubTableIds[c];e+="<row><data>"+d.SubId+"</data><data>"+d.ParentPos+"</data><data>"+d.UniqueConstraints+"</data><data>"+d.Position+"</data><data>"+d.RelNames+"</data></row>"}if(e==""){return false}var k=b.XmlReq;if(j.selectSingleNode("//childCollection")){j.removeChild(j.selectSingleNode("//childCollection"))}var g=k.createNode(1,"childCollection","");var h=k.createCDATASection("<root>"+e+"</root>");g.appendChild(h);j.appendChild(g)}return true},PrepareRefreshChildTable:function(c,g,f){g.setAttribute("action","ChildTableRefresh");g.setAttribute("tblName",f);var d=true;var a=new Object();a.gridId=c.Name;a.tblName=f;try{d=WGHierEngine.PrepareAction(a,g)}catch(b){}if(!d){return false}c.SetStatus1("","refreshchild","CommonText/RefreshChild");return true},ResponseRefreshChildTable:function(c,g){var f=c.Tables[ISXml.GetNodeText(g,"//tblName")];for(var d=0;d<f.SubTableIds.length;d++){var e=f.SubTableIds[d];var b=ISXml.GetNodeText(g,"//htmlString_"+e.SubId);var a=e.GetContainer();a.innerHTML=b;if(IS.moz){WGMozEngine.FormatChildTable(e)}}c.ClearChildTables(f.Id);WGUIEngine.ClearInvalidSelection(c,f);c.SetStatus1("","ready","CommonText/Ready")},RenderIStructure:function(b,a){var d=b.ResolveImagePathEx("I.gif");var c=a.offsetHeight;if(c==0){c="100%"}if(!b.LayoutSettings.TreeLines){d=b.ResolveImagePathEx("wg_Blank.gif")}var e="<TABLE style='TABLE-LAYOUT: fixed; WIDTH: 100%; HEIGHT: "+c+"' cellSpacing=0 cellPadding=0  border=0><TBODY><TR><TD ";e+="style='FONT-SIZE: 5px; BACKGROUND-IMAGE: url("+d+" ); WIDTH: 14px; BACKGROUND-REPEAT: repeat-y'></TD><TD style='FONT-SIZE: 5px; WIDTH: 5px'></TD></TR>";e+="</TBODY></TABLE>";a.innerHTML=e},SetNormalLTree:function(a,f,d){if(a.UseCssFramework){return}var b=a.ResolveImagePathEx("I.gif");var c=a.ResolveImagePathEx("ICont.gif");var e=f.rows[f.rows.length-1];if(!a.LayoutSettings.TreeLines){return}e.cells[0].style.backgroundImage="url("+b+")";if(d){f.rows[1].cells[0].style.backgroundImage="url("+c+")"}},SetLastTree:function(a,f,d){var b=a.ResolveImagePathEx("I.gif");var c=a.ResolveImagePathEx("I_.gif");var e=f.rows[f.rows.length-1];if(!a.LayoutSettings.TreeLines){return}e.cells[0].className="DefHF";e.cells[0].style.backgroundImage="";if(!d){f.rows[1].cells[0].className="DefHBEL"}},SetEmptyTree:function(a,d,c){var b=a.ResolveImagePathEx((c?"I_.gif":"ICont.gif"));if(!a.LayoutSettings.TreeLines){return}d.rows[1].cells[0].style.backgroundImage="url("+b+")";d.rows[1].cells[0].onclick=null;if(c){d.rows[2].cells[0].style.backgroundImage=""}},GetIStructCell:function(c){var b;for(var a=0;a<c.cells.length;a++){if(c.cells[a].getAttribute("type")=="IStruct"){b=c.cells[a]}}return b},GetCellExpander:function(b){for(var a=0;a<b.cells.length;a++){if(b.cells[a].getAttribute("type")=="CellExpander"){return b.cells[a]}}return null},RefreshHierPosition:function(e,u,r,q){if(!r){return}var p=r.rowIndex;var n=q;var v=e.Tables[u.tblName];for(var f=p;f<u.rows.length;f++){var o=u.rows[f];WG50Engine.EmulateAttributes(o);if(o.type=="Record"){o.position=o.recordIndex=q}else{if(o.type=="HierRecord"){var m=o.position;o.position=o.recordIndex=q;if(o.childrenLoaded=="True"){var b=v.GetChildTables();if(b&&b.length>0){for(var g=0;g<b.length;g++){var c=e.Tables[b[g].Name];var t=c.SubTableIds;for(var h=0;h<t.length;h++){var s=t[h];if(s.Position==m&&!s.PositionUpdated){s.Position=q;var l=s.SubId.lastIndexOf("_");var d=e.Name+"_"+c.Id+"_"+s.SubId;s.SubId=s.SubId.substring(0,l)+"_"+q;s.Id=s.TblName+s.SubId;var a=new Array();a[0]=d;a[1]=e.Name+"_"+c.Id+"_"+s.SubId;a[2]=s.SubId;c.SubTableUpdates[c.SubTableUpdates.length]=a;s.PositionUpdated=true}}}}}q++}}}var b=v.GetChildTables();if(b&&b.length>0){for(var g=0;g<b.length;g++){var c=e.Tables[b[g].Name];WGHierEngine.UpdateSubTablePos(c)}}},UpdateSubTablePos:function(l){var j=l.SubTableIds;for(var g=0;g<j.length;g++){var h=j[g];h.PositionUpdated=false}var m=l.SubTableUpdates;m.reverse();for(var f=0;f<m.length;f++){var a=m[f];var d=document.getElementById("dvCH_"+a[0]);var e=document.getElementById("dvTB_"+a[0]);var c=document.getElementById("dvCF_"+a[0]);if(d){d.id="dvCH_"+a[1];d.childNodes[0].subId=a[2]}if(e){e.id="dvTB_"+a[1];e.childNodes[0].subId=a[2];e.childNodes[0].id="tb_"+a[1];var b=e.parentElement;b.subId=a[2]}if(c){c.id="dvCF_"+a[1];c.childNodes[0].subId=a[2]}}l.SubTableUpdates=new Array()},ExpandAllRowsToRootPath:function(f,a){if(!f.IsRootTable){var d=a;while(d!=null){var e=f.Parent;if(e.GroupedColumns.length>0){var c=WG50Engine.FindNearestRootGroupRow(d,e,d,true);var b=e.ToRowObject(c);b.ExpandGroupRow(true)}d=f.GetParentRow(d)}}},SetChildLastTree:function(b,a){}};function WebGridHierDestructor(){var a=delete WGHierEngine}window.attachEvent("onunload",WebGridHierDestructor);if(typeof(Sys)!="undefined"){Sys.Application.notifyScriptLoaded()};