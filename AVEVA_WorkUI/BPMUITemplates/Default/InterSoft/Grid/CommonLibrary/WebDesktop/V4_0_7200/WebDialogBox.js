function WebDialogBox(a){this.ClassName="WebDialogBox";this.Version="2.5.2007";this.BuildNumber="0";this.MajorVersion="4.0";this.RequiredFrameworkVersion="2.0.5000.10";ISControl.call(this,a);this.ScriptDirectory="/CommonLibrary/WebDesktop/V3_0_7200/";this.WindowSettings=new WebDialogWindowSettings();this.Text="";this.Location=new OffsetLocation();this.ControlBoxImage="";this.ContentURL="";this.IntegratedToDesktopManager=false;this.ImagePosition="Left";this.CommandButtonAlignment="Center";this.DialogBoxImage="Question";this.CustomDialogBoxImage="";this.ImagesDirectory="/CommonLibrary/Images/WebDesktop/";this.ClientSideEvents=new WebDialogBoxClientSideEvents();this.InProgressText="";this.StartPosition="CenterParent";this.CommandButtonSize=new UnitSize(80,20);this.CommandButtonSpacing=4;this.CommandButtons=new ISArray();this.ViewStateStorage="PageCache";this.AccessKey="";this.Enabled=false;this.TabIndex=null;this.ToolTip="";this.Visible=false;this.ClientID=a;this.ID=a;this.UniqueID=a;this.Window=null;this.ParentWindow=null;this.Width="400px";this.Height="150px";this.Shadow=null;this.DialogResult=null;this.ContentScrollable=false;this.IsShown=false;this.WebResourceIdentifier="D";this.CreatedAtRuntime=false;this.RuntimeInitialized=false;this.DialogBoxImageVAlign="Middle";this.KeepVisibleOnScroll=false;this.ShadowColor="";this.ShadowOpacity=50;this.IsModal=true;this.AnimationStyle="ShrinkExpand";this.EnableAnimation=false;this.EnableDropShadow=false;this.ReuseIFrame=false;this.ShowOnLoad=false;this.CustomZIndex=-1;if(typeof(WebDesktopImagesSettings)!="undefined"){this.ImagesSettings=new WebDesktopImagesSettings()}this.OnInitialize=function(){this.RemoveDynamicStyle();if(this.CreateAtRuntime){this.CommandButtons.Parent=this}};this.RemoveDynamicStyle=function(){var d=[];var e=["Caption","CaptionButton","Window","CommandButton"];for(var b=0;b<d.length;b++){var c=this[d[b]+"Style"];if(c){ISXml.RemoveNode(this.XmlNode,d[b]+"Style")}}for(var b=0;b<e.length;b++){var c=this.WindowSettings[e[b]+"Style"];if(c){ISXml.RemoveNode(this.WindowSettings.XmlNode,e[b]+"Style")}}};this.OnPropertiesInitialized=function(){if(this.Events!=null){var b;for(b in this.Events){if(typeof(this.Events[b])=="string"){this.ClientSideEvents[b]=this.Events[b]}}}if(ISXml.GetAttribute(this.XmlNode,"Location")!=null){this.Location.Parse(ISXml.GetAttribute(this.XmlNode,"Location"))}};this.CloseDialog=function(){WebDialogBoxEngine.CloseDialogBox(this.Window)};this.BringToFront=function(){WebDialogBoxEngine.SetZIndex(this.Window)};this.OnUnload=function(){for(var f=0;f<this.CommandButtons.length;f++){var b=this.CommandButtons[f];var e=b.GetElement();if(e){Listener.Unload(e)}}if(this.IntegratedToDesktopManager){if(this.ParentWindow){var d=this;ISEvent.RemoveFunctionHandler(this.ParentWindow,"OnPrepareClosed",function(){WebDialogBoxEngine.OnParentWindowClosed(d)})}}else{if(this.KeepVisibleOnScroll){Listener.Unload(document.body)}}};this.Dispose=function(){this.OnUnload();if(this.Window){this.Window.IsDialogBox=false;this.Window.Close(false)}var b=this.GetContentElement();if(b){b.removeNode(true)}for(i in IS.RuntimeObjects){var c=IS.RuntimeObjects[i];if(c!=null&&typeof(c)=="object"&&c.Id==this.Id){IS.RuntimeObjects[i]=null}}IS.ActiveCtrl=null};this.Activate=function(){WebDialogBoxEngine.ActivateDialog(this)};this.ShowDialog=function(f,j){var p=this.Window;var g=10;this.DialogResult=null;if(p==null||p.GetWindowDivElement()==null||p._Type==null){WebDialogBoxEngine.CreateDialogBoxWindow(this);p=this.Window}p.DialogBoxShown=false;p.CurrentDialogBox=null;if(this.IsModal){WebDialogBoxEngine.MakeParentModal(this)}if((IS.ie11||IS.moz)&&this.ContentScrollable){var b=p.GetContentDivElement();if(b){if(IS.IsHTML5DocType()){var o=b.children[0].children[0].children[0];if(o!=null){var c=o.children[o.children.length-1].children[0];if(c){b.children[0].style.height="100%";c.style.display="none";c.style.overflow="auto";setTimeout(function(){c.style.height=c.parentElement.offsetHeight;c.style.display=""},0)}}}else{var o=b.children[0].children[0].children[0];if(o!=null){var c=o.rows[0].cells[o.rows[0].cells.length-1].children[0];if(c){b.children[0].style.height="100%";c.style.display="none";c.style.overflow="auto";setTimeout(function(){c.style.height=c.parentElement.offsetHeight;c.style.display=""},0)}}}}}if(!this.IntegratedToDesktopManager){var q=p.GetWindowDivElement();q.style.display="";p.Size=new UnitSize(q.offsetWidth,q.offsetHeight);q.style.display="none";if(this.CustomZIndex!=-1){WebDialogBoxEngine.SetZIndex(p,this.CustomZIndex)}if(this.StartPosition!="Custom"){if(IS.ie&&!IS.ie11){p.MoveToCenterDesktop()}else{p.MoveToCenterDesktopAbsolute()}}else{p.MoveTo(this.Location.X,this.Location.Y)}var h=p.DesktopManager;h.WindowSettings=this.WindowSettings;if(this.ImagesSettings&&!WebDialogBoxEngine.IsImageSettingsDefault(this)){h.ImagesSettings=this.ImagesSettings}}else{var e=ISGetDesktopManagerExact();e.Windows.push(p);if(this.StartPosition=="Custom"&&this.ParentWindow){p.MoveTo(this.Location.X,this.Location.Y)}else{if(this.StartPosition=="CenterParent"&&this.ParentWindow){var l=this.ParentWindow.Size;var k=this.ParentWindow.Location;var n=new OffsetLocation();n.X=(l.Width-p.Size.Width)/2;n.Y=(l.Height-p.Size.Height)/2;if(n.X<0){n.X=0}if(n.Y<0){n.Y=0}p.MoveTo(n.X+k.X,n.Y+k.Y)}else{p.MoveToCenterDesktop()}}if(this.ParentWindow){this.ParentWindow.DialogBoxShown=true;this.ParentWindow.CurrentDialogBox=this}if(this.HostWindow){this.HostWindow.DialogBoxWindows.push(p);this.HostWindow.CurrentDialogBox=this}}this.IsShown=true;if(this.EnableAnimation&&this.AnimationStyle=="VistaStyleZoom"){p.DesktopManager.EnableAnimation=true;p.DesktopManager.AnimationStyle="VistaStyleZoom";g=200}if(f&&j!=null){p.DesktopManager.EnableAnimation=true;p.Show(j,"black");return}else{p.Show()}if(this.CommandButtons.length>0&&this.WindowSettings.ContentMode=="UseInlineContent"){var d=this;setTimeout(function(){try{d.CommandButtons[0].GetElement().focus();if(IS.IsHTML5DocType){WebDialogBoxEngine.SetWindowSeparator(p);WebDialogBoxEngine.DivideContent(p.DialogBox,p)}}catch(r){}},g)}if(p.ContentMode=="UseIFrame"){var b=p.GetContentDivElement();b.style.overflow="hidden";b.style.overflowY="hidden";b.style.overflowX="hidden";if(p.IFrameLoaded){p.IFrameLoaded=false}}if(this.WindowSettings.AllowClose=="Yes"&&IS.IsHTML5DocType()){var m=setInterval(function(){WebDialogBoxEngine.SetWindowSeparator(p);if(p.GetWindowOptionsCellElement().parentElement.parentElement.style.width!="0px"){window.clearInterval(m)}},100)}};this.GetContentElement=function(){return document.getElementById("dvDlgCnt_"+this.Id)};this.GetContentTemplateElement=function(){var b=this.GetContentElement();if(IS.IsHTML5DocType()){return b.children[0]}else{return b.children[0].children[0]}};this.FindControl=function(d){if(this.IntegratedToDesktopManager){if(this.Window){var b=ISGetDesktopManager();var c=b.GetDocument();return c.getElementById(d)}else{return document.getElementById(d)}}else{return document.getElementById(d)}};this.SetContentURL=function(b){this.ContentURL=b;if(this.Window){this.Window.ContentURL=b;this.Window.ContentURLChanged=true}};this.SetContentTemplate=function(g){var e=this.GetContentElement();this.WindowSettings.ContentMode=="UseInlineContent";this.ContentTemplate=g;if(e==null){e=document.createElement("div");e.id="dvDlgCnt_"+this.Id;e.style.cssText="display:none; position:absolute";e.innerHTML=WebDialogBoxRuntimeEngine.RenderContentBar(this);document.body.appendChild(e)}else{var c=this.GetContentTemplateElement();if(c==null||c.children.length==0||this.Window!=null){var d=this.Window.GetContentDivElement();var f=d.children[0].children[0].children[0].rows[0];var b=1;if(f.cells.length==1){b=0}c=f.cells[b].children[0]}c.innerHTML=g}};this.SetZIndex=function(b){this.CustomZIndex=b;WebDialogBoxEngine.SetZIndex(this.Window,b)}}function WebDialogBoxButton(c,d,a,b){this._Type="WebDialogBoxButton";ISObject.call(this);this.AccessKey="";this.Text="";this.Enabled=true;this.Image="";this.DisplayMode="Text";this.ImagePosition="Left";this.Name="";this.Type="NotSet";this.Parameter=this;this.OnClientClick="WD25_OnButtonClick";this.Collection=new ISArray();this.BorderType="Simple";this.ImagesSettings=null;this.ImagesDirectory="";this.DesktopManager=null;this.ButtonStyle=null;this.Index=-1;if(typeof(c)!="undefined"){this.Name=c}if(typeof(d)!="undefined"){this.Text=d}if(typeof(a)!="undefined"){this.Type=a}if(typeof(b)!="undefined"){this.Image=b}this.GetElement=function(){if(this.Parent!=null){if(this.Parent.IntegratedToDesktopManager){var e=ISGetDesktopManager();if(e){return e.GetDocument().getElementById(this.Parent.Id+"_"+this.Name)}}else{if(document){return document.getElementById(this.Parent.Id+"_"+this.Name)}}}return null}}function WebDialogBoxClientSideEvents(){this._Type="WebDialogBoxClientSideEvents";ISObject.call(this);this.OnCreated="";this.OnClosed="";this.OnButtonClicked="";this.OnBeforeCreated="";this.OnSetContent=""}function WebDialogWindowSettings(){if(typeof(WebDesktopWindowSettings)=="undefined"){var a=ISGetDesktopManager();if(a){var b=a.GetContentWindow().WebDesktopWindowSettings;b.call(this)}else{alert("Integration Error: Can't find DesktopManager instance!");return}}else{WebDesktopWindowSettings.call(this)}this._Type="WebDialogWindowSettings";this.ControlBox="No";this.AllowMinimize="No";this.AllowMaximize="No";this.AllowResize="No"}function InitWebDialogBox(b){var a=WebDialogBoxEngine.Create(b);a.OnInitialize()}function CreateWebDialogBox(b){var a=WebDialogBoxEngine.Create(b,true);a.CreatedAtRuntime=true;a.RuntimeInitialized=false;a.OnInitialize();return a}var DialogResult={Abort:"Abort",Retry:"Retry",Ignore:"Ignore",OK:"OK",Cancel:"Cancel",Yes:"Yes",No:"No"};var WebDialogBoxEngine={Initialized:false,Create:function(b,d){var a=new WebDialogBox(b);WebDialogBoxEngine.AssignProperties(a,d);WebDialogBoxEngine.RegisterBehaviour(a);WebDialogBoxEngine.InitializeMozilla(a);WebDialogBoxEngine.InitializeIntegration(a);a.IsInit=true;return a},SetWindowSeparator:function(c){var g=c.GetWindowOptionsCellElement();var e=c.GetControlBoxCellElement();var h=c.GetCaptionBarTextCellElement();var f=c.GetWindowDivElement();var d=c.GetCaptionBarCellElement();var b=0;if(c.DesktopManager.WindowSettings.BorderType=="Simple"){if(g.offsetWidth!=0){for(var a=0;a<g.children.length;a++){b+=g.children[a].offsetWidth}if(b<10){b=14}g.parentElement.parentElement.style.width=(b+2)+"px";if(g.parentElement.parentElement.nextSibling!=null){g.parentElement.parentElement.nextSibling.style.left=(b+2)+"px"}else{if(g.parentElement.parentElement.previousSibling!=null){g.parentElement.parentElement.previousSibling.style.right=(b+2)+"px"}}if(c.DesktopManager.WindowSettings.MinimumSize.Width==null){if(e==null&&h==null){f.style.minWidth=(b+20)+"px"}else{if(e==null){f.style.minWidth=(b+h.offsetWidth+20)+"px"}else{if(h==null){f.style.minWidth=(b+e.offsetWidth+20)+"px"}else{f.style.minWidth=(b+e.offsetWidth+h.offsetWidth+20)+"px"}}}}}}else{if(g.offsetWidth!=0){for(var a=0;a<c.GetCaptionBarCellElement().children[0].children.length;a++){if(a==0){if(c.GetCaptionBarCellElement().children[0].children[a].children[0].nodeName=="IMG"){c.GetCaptionBarCellElement().children[0].children[a].style.width=c.GetCaptionBarCellElement().children[0].children[a].children[0].naturalWidth+"px";c.GetCaptionBarCellElement().children[0].children[a+1].style.left=c.GetCaptionBarCellElement().children[0].children[a].style.width}}else{if(a==c.GetCaptionBarCellElement().children[0].children.length-1){if(c.GetCaptionBarCellElement().children[0].children[a].children[0].nodeName=="IMG"){c.GetCaptionBarCellElement().children[0].children[a].style.width=c.GetCaptionBarCellElement().children[0].children[a].children[0].naturalWidth+"px";c.GetCaptionBarCellElement().children[0].children[a-1].style.right=c.GetCaptionBarCellElement().children[0].children[a].style.width}}}}for(var a=0;a<g.children.length;a++){b+=g.children[a].offsetWidth}g.parentElement.parentElement.style.width=(b)+"px";if(g.parentElement.parentElement.nextSibling!=null){g.parentElement.parentElement.nextSibling.style.left=(b)+"px"}else{if(g.parentElement.parentElement.previousSibling!=null){g.parentElement.parentElement.previousSibling.style.right=(b)+"px"}}if(c.DesktopManager.WindowSettings.MinimumSize.Width==null){if(e==null&&h==null){f.style.minWidth=(b+d.children[0].children[0].offsetWidth+d.children[0].children[2].offsetWidth+20)+"px"}else{if(e==null){f.style.minWidth=(b+h.offsetWidth+d.children[0].children[0].offsetWidth+d.children[0].children[2].offsetWidth+20)+"px"}else{if(h==null){f.style.minWidth=(b+e.offsetWidth+d.children[0].children[0].offsetWidth+d.children[0].children[2].offsetWidth+20)+"px"}else{f.style.minWidth=(b+e.offsetWidth+h.offsetWidth+d.children[0].children[0].offsetWidth+d.children[0].children[2].offsetWidth+20)+"px"}}}}}}},CreateWebDialogBoxXmlDoc:function(a){if(a.XmlDt==null){var b=document.createElement("XML");b.id=a.Id+"_x";b.innerHTML="<WebDialogBox />";document.body.appendChild(b);a.XmlDt=b;return b}return null},AssignProperties:function(a,d){if(a==null){return}if(!a.IsInit){var f=null;if(typeof(IS_ReleaseType)!="undefined"&&IS_ReleaseType=="Beta"){a.ScriptDirectory="/CommonLibraryBeta/WebDesktop/V3_0_7200/";a.ImagesDirectory="/CommonLibraryBeta/Images/WebDesktop/"}if(d){WebDialogBoxEngine.CreateWebDialogBoxXmlDoc(a)}try{f=ISXml.GetNode(a.XmlDt,"//WebDialogBox")}catch(b){}if(f==null){f=a.XmlDt.documentElement}if(f!=null){IS.SetPropertiesRecursive(a,f);if(!d){a.WindowSettings.CaptionButtonStyle=DynamicStyleEngine.Assign(ISXml.GetNode(a.WindowSettings.XmlNode,"//CaptionButtonStyle"));a.WindowSettings.CaptionStyle=DynamicStyleEngine.Assign(ISXml.GetNode(a.WindowSettings.XmlNode,"//CaptionStyle"));a.WindowSettings.WindowStyle=DynamicStyleEngine.Assign(ISXml.GetNode(a.WindowSettings.XmlNode,"//WindowStyle"));a.WindowSettings.CommandButtonStyle=DynamicStyleEngine.Assign(ISXml.GetNode(a.WindowSettings.XmlNode,"//CommandButtonStyle"))}}}},RegisterBehaviour:function(a){window.attachEvent("onresize",function(){WebDialogBoxEngine.OnWindowResize(a)});window.attachEvent("onload",function(){WebDialogBoxEngine.OnWindowLoad(a)});window.attachEvent("onunload",function(){WebDialogBoxEngine.OnWindowUnload(a)});if(a.KeepVisibleOnScroll){if(IS.IsHTML5DocType()){if(IS.safari){window.attachEvent("onscroll",function(){WebDialogBoxEngine.OnScroll(a)})}else{window.onscroll=function(){WebDialogBoxEngine.OnScroll(a)}}}else{if(IS.ie){Listener.Add(document.body,"onscroll",WebDialogBoxEngine.OnScroll,a)}else{window.attachEvent("onscroll",function(){WebDialogBoxEngine.OnScroll(a)})}}}},InitializeMozilla:function(a){if(IS.moz){}},InitializeIntegration:function(a){},InitializeWindowProperties:function(b,a,e){e.Text=a.Text;e.Name="wnd"+a.Id;e.DesktopManager=b;e.IsDialogBox=true;e.ShowInTaskBar=false;e.Index=b.Windows.length;e.ContentMode=a.WindowSettings.ContentMode;e.Size=new UnitSize(a.Width,a.Height);e.EnableDropShadow=a.EnableDropShadow;b.EnableAnimation=a.EnableAnimation;if(a.InProgressText!=""){b.TextSettings.InProgressText=a.InProgressText}if(a.ControlBoxImage!=""){e.ControlBoxImage=a.ControlBoxImage}if(e.ContentMode=="UseIFrame"){e.ContentURL=a.ContentURL}var d=function(){WebDialogBoxEngine.OnParentWindowClosed(a)};d.TargetObject=a;if(a.IntegratedToDesktopManager&&IS.ie){ISEvent.AddFunctionHandler(a.ParentWindow,"OnPrepareClosed",d)}},OnParentWindowClosed:function(a){if(a.Window){var b=a.Window;var d=b.GetWindowDivElement();a.OnUnload();Listener.Unload(d);d.removeNode(true);d=null;delete d;b=null;delete b}},OnWindowResize:function(a){if(a.IsShown&&a.IsModal){WebDialogBoxEngine.MakeParentModal(a)}},OnWindowLoad:function(a){if(a.ShowOnLoad&&!a.IsShown){a.ShowDialog()}},OnScroll:function(_c){var c=this;if(_c){c=_c}if(c.Window){var currentLoc=c.Window.Location;var div=c.Window.GetWindowDivElement();var originalLoc=c.Window.OriginalLocation;var y=currentLoc.Y;if(IS.IsHTML5DocType()){with(div.style){top=y+window.pageYOffset+"px"}}else{if(originalLoc!=null){y=originalLoc.Y}with(div.style){top=y+document.body.scrollTop+"px"}}if(!c.Window.OriginalLocation){c.Window.OriginalLocation=currentLoc}}},OnWindowUnload:function(a){if(a.IntegratedToDesktopManager){ISEvent.RemoveFunctionHandler(a.ParentWindow,"OnPrepareClosed",function(){WebDialogBoxEngine.OnParentWindowClosed(a)});if(a.Window){var b=a.Window;var d=b.GetWindowDivElement();if(d){d.removeNode(true);d=null;delete d;b=null;delete b}}}},CreateDialogBoxWindow:function(a,g){var j=null;a.Height=parseFloat(a.Height);a.Width=parseFloat(a.Width);if(a.IntegratedToDesktopManager){var b=ISGetDesktopManagerExact();var l=a.WindowSettings;var d=b.GetContentWindow();if(!b){alert("Integration Error: Can't find DesktopManager instance!");return}a.ParentWindow=ISGetCurrentWindow();if(!a.ParentWindow){a.ParentWindow=ISGetCurrentWindow(true)}if(a.ParentWindow!=null&&a.ParentWindow.GetType()!="WebDesktopWindow"){a.ParentWindow=null}if(!a.ParentWindow){a.ParentWindow=ISGetCurrentWindow(true,b)}if(!a.ParentWindow){a.ParentWindow=ISGetActiveWindow()}if(a.ParentWindow!=null&&a.ParentWindow.IsDialogBox){a.HostWindow=WebDialogBoxEngine.GetHostWindow(a.ParentWindow)}else{a.HostWindow=a.ParentWindow}j=b.CreateWindow();WebDialogBoxEngine.InitializeWindowProperties(b,a,j);j.AllowMinimize="No";j.AllowMaximize="No";j.AllowResize=l.AllowResize;j.ControlBox=l.ControlBox;j.AllowClose=l.AllowClose;j.ContentMode=l.ContentMode;j.DesktopManager=b;j.Collection=b.Windows;if(j.GetWindowDivElement()!=null){g=true}if(!g){d.WebDMEngine.CreateWindow(j);var k=j.GetContentDivElement();k.style.overflow=k.style.overflowX=k.style.overflowY="visible"}else{j.ReInitialize();j.DialogBox=a;j.CreatedAtRuntime=true;a.Window=j}}else{var b=null;j=new WebDesktopWindow();try{b=ISGetDesktopManager();var h=false;if(b!=null){if(b.GetContentWindow().location.pathname!=window.location.pathname){h=true}}if(!b||(b&&b.Id!="Global")||h){b=new WebDesktopManager("Global")}}catch(f){}if(!b){alert("Integration Error: Unable to create DesktopManager instance!");return}ISEvent.Raise(a.ClientSideEvents.OnBeforeCreated,a.Id,b);b.CreatedAtRuntime=true;b.Id="Global";b.FrameObj=document.body;b.WindowSettings=a.WindowSettings;b.UseWebResourcesForClient=a.UseWebResourcesForClient;if(a.ImagesSettings&&!WebDialogBoxEngine.IsImageSettingsDefault(a)){b.ImagesSettings=a.ImagesSettings}WebDialogBoxEngine.InitializeWindowProperties(b,a,j);WebDMEngine.CreateWindow(j);if(typeof(ISWinEngine)=="object"){ISWinEngine.Initialize(b.InteractiveObjects)}}WebDialogBoxEngine.SetContent(a,j);WebDialogBoxEngine.SetZIndex(j);WebDialogBoxEngine.InitializeButtons(a);j.ResizeTo(a.Width,a.Height);j.DialogBox=a;a.Window=j;ISEvent.Raise(a.ClientSideEvents.OnCreated,a.Id)},DivideContent:function(a,g){if(a.DialogBoxImage!="None"&&a.WindowSettings.ContentMode!="UseIFrame"){var e="";var b=g.GetContentDivElement().children[0].children[0];var d=b.children[0].children[0];var f=b.children[0].children[1];d.style.width=(d.children[0].children[0].naturalWidth+10)+"px";f.style.width=e+"calc(100% - "+(d.children[0].children[0].naturalWidth+10)+"px)"}return true},IsImageSettingsDefault:function(a){var b=null;if(typeof(WebDesktopImagesSettings)!="undefined"){b=new WebDesktopImagesSettings()}if(!b){return true}for(prop in b){if(prop.indexOf("Xml")==-1&&typeof(b[prop])!="function"){if(b[prop]!=a.ImagesSettings[prop]){return false}}}return true},GetHostWindow:function(a){while(a.IsDialogBox){a=a.DialogBox.ParentWindow}return a},OnButtonKeyDown:function(){var f=event;if(f==null){f=ISGetDesktopManager().GetContentWindow().event}var e=f.srcElement;var g=true;if(f.keyCode==9){var d=e.id.substring(0,e.id.indexOf("_"));var b=e.id.substring(e.id.indexOf("_")+1);var c=ISGetObject(d);if(c!=null){var a=c.CommandButtons.GetNamedItem(b);var h=null;if(f.shiftKey){g=false}if(g){h=c.CommandButtons[a.Index+1];if(h==null){h=c.CommandButtons[0]}}else{h=c.CommandButtons[a.Index-1];if(h==null){h=c.CommandButtons[c.CommandButtons.length-1]}}if(h){h.GetElement().focus()}if(IS.ie){f.keyCode=0}f.returnValue=false}}},OnShadowClick:function(a){if(a.CommandButtons.length>0&&a.WindowSettings.ContentMode=="UseInlineContent"){a.CommandButtons[0].GetElement().focus()}else{if(a.WindowSettings.ContentMode=="UseIFrame"){}}},OnShadowMouseDown:function(a){if(a.IntegratedToDesktopManager){var b=event;if(b==null){b=ISGetDesktopManager().GetContentWindow().event}if(b!=null){b.cancelBubble=true;b.returnValue=false}}},InitializeButtons:function(b){if(b.WindowSettings.ContentMode=="UseIFrame"){return}for(var e=0;e<b.CommandButtons.length;e++){var a=b.CommandButtons[e];var d=a.GetElement();WebButtonEngine.RegisterBehaviour(a);Listener.Add(d,"onkeydown",WebDialogBoxEngine.OnButtonKeyDown);a.IntegratedToDesktopManager=b.IntegratedToDesktopManager;a.ButtonStyle=new DynamicStyle();a.ButtonStyle.Normal=b.WindowSettings.CommandButtonStyle.Normal;a.ButtonStyle.Over=b.WindowSettings.CommandButtonStyle.Over;a.ButtonStyle.Active=b.WindowSettings.CommandButtonStyle.Active;a.ButtonStyle.Object=d;a.Index=e;if(a.IntegratedToDesktopManager){WebButtonEngine.InitializeIntegration(a)}}},SetContent:function(a,g){var b=g.GetContentDivElement();var e=b.children[0];var d=a.GetContentElement();if(a.WindowSettings.ContentMode=="UseInlineContent"){if(IS.IsHTML5DocType()){if(a.IntegratedToDesktopManager){e.innerHTML=d.children[0].outerHTML}else{e.appendChild(d.children[0])}}else{if(a.IntegratedToDesktopManager){e.innerHTML=d.children[0].children[0].outerHTML}else{e.appendChild(d.children[0].children[0])}}var f=e.children[0].children[0];f.style.fontFamily=b.currentStyle.fontFamily;f.style.fontSize=b.currentStyle.fontSize;f.style.color=b.currentStyle.color;f.style.cursor="default";ISEvent.Raise(a.ClientSideEvents.OnSetContent,a,g,e.children[0].children[0])}if(IS.IsHTML5DocType()){WebDialogBoxEngine.DivideContent(a,g)}},SetZIndex:function(b,c){if(!c){c=205}if(!b){return}var a=b.GetWindowDivElement();a.style.zIndex=c},CloseDialogBox:function(g){var a=g.DialogBox;var h=g.GetWindowDivElement();if(a.IsModal){WebDialogBoxEngine.MakeParentNonModal(a)}if(a.IntegratedToDesktopManager){var e=null;var c=a.HostWindow;g.Collection.Remove(g);if(c){var b=c.DialogBoxWindows;b.Remove(g);if(b.length>0){e=b[b.length-1]}if(e!=null){c.CurrentDialogBox=e.DialogBox}else{c.DialogBoxShown=false;c.CurrentDialogBox=null}}if(a.ParentWindow){if(e==null){a.ParentWindow.CurrentDialogBox=null}a.ParentWindow.DialogBoxShown=false;a.ParentWindow.DesktopManager.ActiveWindowIndex=-1;a.ParentWindow.Activate()}else{var f=g.DesktopManager.GetTopMostWindowBefore();if(f){g.DesktopManager.ActiveWindowIndex=-1;f.Activate()}}}if(a.DialogResult==null){a.DialogResult="Cancel"}var d=ISEvent.Raise(a.ClientSideEvents.OnClosed,a.Id,a.DialogResult);if(!d){return}if(g.EnableDropShadow&&g.DropShadow!=null){g.DropShadow.Hide()}h.style.display="none";a.IsShown=false;if(a.Id!=null){if(a.WindowSettings.ContentMode=="UseIFrame"&&a.IntegratedToDesktopManager&&!a.ReuseIFrame){WebDialogBoxEngine.UnloadIFrame(g)}}},UnloadIFrame:function(f){var b=f.DialogBox;var a=ISGetDesktopManager();var e=a.GetIFrameWindow(f.Name);if(e&&e.document){var d=e.document;if(e.onunload!=null){e.onunload()}if(e.ISCoreDestructor){e.ISCoreDestructor()}d.body.onunload=null;setTimeout(function(){try{d.open("text/html");d.write("");d.close()}catch(c){}},10);if(b.Window){b.Window.ContentURLChanged=true}}},CreateShadow:function(a,b,d){if(!d){d="afterBegin"}var e=document.createElement("DIV");e.hideFocus=true;if(IS.moz){e.style.cssText="width: 100px; height: 100px"}e.innerHTML="<img width=100% height=100% src='"+a.ResolveImagePath(a.ImagesDirectory,"blank.gif")+"' />";e.onclick=function(){WebDialogBoxEngine.OnShadowClick(a)};e.onmousedown=function(){WebDialogBoxEngine.OnShadowMouseDown(a)};e.onselectstart=function(){return false};b.insertAdjacentElement(d,e);a.Shadow=e;return e},MakeParentModal:function(c){if(c.IntegratedToDesktopManager){var sh=c.Shadow;var win=c.ParentWindow;if(sh==null){var dm=null;var winDiv=null;if(win){dm=win.DesktopManager;winDiv=win.GetWindowDivElement()}else{dm=ISGetDesktopManager();winDiv=dm.GetDesktopElement();dm.TaskBarLocked=true}sh=WebDialogBoxEngine.CreateShadow(c,winDiv,"beforeEnd")}with(sh.style){position="absolute";if(win){width=win.Size.Width;height=win.Size.Height}else{width=document.body.offsetWidth;height=document.body.offsetHeight}left=0;top=0;if(c.ShadowColor=="Transparent"||c.ShadowColor==""){backgroundColor="transparent"}else{if(c.ShadowColor.indexOf(",")>-1){backgroundColor="rgb("+c.ShadowColor+")"}else{backgroundColor=c.ShadowColor}filter="Alpha(Opacity="+c.ShadowOpacity+")";opacity=c.ShadowOpacity/100}display="";zIndex=150}}else{var sh=c.Shadow;if(sh==null){sh=WebDialogBoxEngine.CreateShadow(c,document.body)}with(sh.style){position="absolute";var leftMargin=parseFloat(document.body.currentStyle.marginLeft);var rightMargin=parseFloat(document.body.currentStyle.marginRight);var topMargin=parseFloat(document.body.currentStyle.marginTop);var bottomMargin=parseFloat(document.body.currentStyle.marginBottom);var targetWidth=0;var targetHeight=0;var _maxWidth=document.body.clientWidth;var _maxHeight=document.body.clientHeight;if(IS.IsXHTMLDocType()){_maxWidth=document.documentElement.clientWidth;_maxHeight=document.documentElement.clientHeight}if(isNaN(leftMargin)){leftMargin=0}if(isNaN(rightMargin)){rightMargin=0}if(isNaN(topMargin)){topMargin=0}if(isNaN(bottomMargin)){bottomMargin=0}if(document.body.scrollWidth>_maxWidth){targetWidth=document.body.scrollWidth}else{targetWidth=_maxWidth-leftMargin-rightMargin}if(document.body.scrollHeight>_maxHeight){targetHeight=document.body.scrollHeight}else{targetHeight=_maxHeight-topMargin-bottomMargin}width=targetWidth+"px";height=targetHeight+"px";if(IS.IsHTML5DocType()){overflow="hidden"}if(c.ShadowColor=="Transparent"||c.ShadowColor==""){backgroundColor="transparent"}else{if(c.ShadowColor.indexOf(",")>-1){backgroundColor="rgb("+c.ShadowColor+")"}else{backgroundColor=c.ShadowColor}filter="Alpha(Opacity="+c.ShadowOpacity+")";opacity=c.ShadowOpacity/100}display="";zIndex=150}}},MakeParentNonModal:function(a){var d=a.Shadow;d.style.display="none";if(a.IntegratedToDesktopManager){var b=ISGetDesktopManager();b.TaskBarLocked=false}else{}},ActivateDialog:function(a){var b=a.HostWindow;if(!b){b=a.ParentWindow}if(b){var d=b;if(!d.IsActiveWindow()){d.Activate()}}}};var WebDialogBoxRuntimeEngine={RenderContentBar:function(a){if(IS.IsHTML5DocType()){var d="";var f=a.WindowSettings;var b="";var e="<div style='height: 100%; width: 100%; position: relative;' class='";if(a.DialogBoxImage=="Custom"){b=a.CustomDialogBoxImage}else{b="isdialog_"+a.DialogBoxImage+".gif"}if(f.BorderType=="ComplexImages"){e+=f.WindowStyle.Normal}else{e+=f.ContainerStyle}e+="'>";if(a.CommandButtons.length>0){e+="<div style='position: relative; height: "+d+"calc(100% - "+(a.CommandButtonSize.Height+20)+"px); width: 100%;'>"}else{e+="<div style='position: relative; height: 100%; width: 100%;'>"}if(a.DialogBoxImage!="None"){e+="<div style='position: relative; height: 100%; width: 50px; float: left; display: table;'>";e+="<div style='display: table-cell; text-align: center; vertical-align: "+a.DialogBoxImageVAlign.toString().toLowerCase()+";'>";e+="<img src='"+a.ResolveImagePath(a.ImagesDirectory,b)+"'";if(a.DialogBoxImageVAlign.toString().toLowerCase().indexOf("top")!=-1){e+=" style='margin-top: 10px;'"}e+=" />";e+="</div>";e+="</div>"}if(a.DialogBoxImage!="None"){e+="<div style='position: relative; height: 100%; width: "+d+"calc(100% - 50px); float: left;'>"}else{e+="<div style='position: relative; height: 100%; width: 100%; float: left;'>"}e+="<div style='width:100%; height:100%; padding: 4px; float: left; ";e+=d+"box-sizing: border-box; ";if(a.ContentScrollable){if(IS.ie&&!IS.ie11){e+="overflow-y:auto;overflow-x:hidden;"}else{e+="overflow:auto;"}}e+="'>";e+=a.ContentTemplate;e+="</div></div></div>";a.CommandButtons.Parent=this;if(a.CommandButtons.length>0){e+="<div style='position: relative; height: "+(parseInt(a.CommandButtonSize.Height)+20)+"px; width: 100%; display: table;'>";e+=WebDialogBoxRuntimeEngine.RenderCommandButtons(a);e+="</div>"}e+="</div>";return e}else{var f=a.WindowSettings;var b="";var e="<div class='";if(a.DialogBoxImage=="Custom"){b=a.CustomDialogBoxImage}else{b="isdialog_"+a.DialogBoxImage+".gif"}if(f.BorderType=="ComplexImages"){e+=f.WindowStyle.Normal}else{e+=f.ContainerStyle}e+="'><div><table cellspacing=4 cellpadding=0 width=100% height=100%><tr height=100%><td valign="+a.DialogBoxImageVAlign+">";if(a.DialogBoxImage!="None"){e+="<img src='"+a.ResolveImagePath(a.ImagesDirectory,b)+"' /></td><td width=100%>"}e+="<div style='width:100%; height:100%;";if(a.ContentScrollable){if(IS.ie&&!IS.ie11){e+=";overflow-y:auto;overflow-x:hidden;"}else{e+=";overflow:auto;"}}e+="'>";e+=a.ContentTemplate;e+="</div></td></tr>";a.CommandButtons.Parent=this;if(a.CommandButtons.length>0){e+="<tr><td colspan=2 align="+a.CommandButtonAlignment;e+=" style='padding:"+a.WindowSettings.CommandBarPadding+"px'>";e+=WebDialogBoxRuntimeEngine.RenderCommandButtons(a);e+="</td></tr>"}e+="</table></div></div>";return e}},RenderCommandButtons:function(b){if(IS.IsHTML5DocType()){var e="<div style='display: table-cell; text-align: center; vertical-align: middle;'>";for(var d=0;d<b.CommandButtons.length;d++){var a=b.CommandButtons[d];a.Parent=b;e+=WebDialogBoxRuntimeEngine.RenderButton(b,a)}e+="</div>"}else{var e="<table cellspacing=0 cellpadding="+b.CommandButtonSpacing+">";e+="<tr>";for(var d=0;d<b.CommandButtons.length;d++){var a=b.CommandButtons[d];a.Parent=b;e+="<td>";e+=WebDialogBoxRuntimeEngine.RenderButton(b,a);e+="</td>"}e+="</tr>";e+="</table>";return e}},RenderButton:function(b,a){var d="<button id='"+b.ClientID+"_"+a.Name+"' ";d+="class="+b.WindowSettings.CommandButtonStyle.Normal+" ";d+="style='";d+="height:"+b.CommandButtonSize.Height+"px;";d+="width:"+b.CommandButtonSize.Width+"px;";d+="'";d+=">";d+=WebDialogBoxRuntimeEngine.RenderButtonInnerContent(a);d+="</button>";return d},RenderButtonInnerContent:function(a){var b="<div>";if(a.DisplayMode=="TextAndImage"&&a.ImagePosition=="Left"){b+="<img align=absmiddle src='"+a.Image+"' hspace=2 />&nbsp;"}b+=a.Text;if(a.DisplayMode=="TextAndImage"&&a.ImagePosition=="Right"){b+="&nbsp;<img align=absmiddle src='"+a.Image+"' hspace=2 />"}b+="</div>";return b}};function WD25_OnButtonClick(c,a){var b=a.Parent;var d=true;if(typeof(b.ClientSideEvents.OnButtonClicked)=="function"){b.ClientSideEvents.OnButtonClicked()}else{d=ISEvent.Raise(b.ClientSideEvents.OnButtonClicked,b.id,a)}if(d){if(event){event.cancelBubble=true;event.returnValue=false}b.DialogResult=a.Type;WebDialogBoxEngine.CloseDialogBox(b.Window)}}function WebDialogBoxDestructor(){var a=delete WebDialogBoxEngine}function ISGetDesktopManagerExact(){if(typeof(IS)=="object"){for(var a=0;a<IS.RuntimeObjects.length;a++){var b=IS.RuntimeObjects[a];if(b&&b.ClassName!=null&&b.GetType()=="WebDesktopManager"&&b.Id!="Global"){return b}}}while(window.parent!=null&&window!=window.parent){var c=window.parent;if(typeof(c.ISGetDesktopManager)=="function"){return c.ISGetDesktopManager()}}return null}window.attachEvent("onunload",WebDialogBoxDestructor);