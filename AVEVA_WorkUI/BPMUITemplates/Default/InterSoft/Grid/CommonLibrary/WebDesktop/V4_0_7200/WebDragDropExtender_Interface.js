function CustomDragInterfaceBase(a){this.Type="";this.Owner=a;this.Properties=a.AdvancedProperties;this.OnInitialize=function(){};this.OnMouseDown=function(){};this.OnPostMouseDown=function(b){};this.AddDragControl=function(){};this.RemoveDragControl=function(){};this.OnDragStart=function(b){};this.OnDragEnd=function(b){};this.OnDragEnter=function(c,b){};this.OnDragOver=function(c,b){};this.OnDragDrop=function(c,b){};this.OnShadowCreate=function(b){}}function WebGridDragData(){this.Type="WebGridDragData";ISObject.call(this);this.ItemType="Row";this.GridId=null;this.RowCount=0;this.Rows=null}function WebGridDragInterface(a){CustomDragInterfaceBase.call(this,a);this.Type="WebGrid";this.SupportedVersion="5.0";this.CurrentRows=null;this.AllowDragOnCheckedRows=false;this.ShadowWidthMode="Default";this.ShadowWidthValue=100;this.OnInitialize=function(){var b=this.Properties.split(",");for(var d=0;d<b.length;d++){var c=b[d].split("=");switch(c[0]){case"AllowDragOnCheckedRows":this.AllowDragOnCheckedRows=(c[1]=="True");break;case"ShadowWidthMode":this.ShadowWidthMode=c[1];break;case"ShadowWidthValue":this.ShadowWidthValue=parseFloat(c[1]);break}}};this.AddDragControl=function(){var b=this.Owner;var d=ISGetObject(b.ControlID);var e=d.RootTable.GetElement(WG40.BODY,WG40.HTMLTABLE);a.Element=e;Listener.Add(e,"onmousedown",WebDragDropEngine.OnMouseDown,b)};this.RemoveDragControl=function(){var b=this.Owner;var d=ISGetObject(b.ControlID);var e=null;if(d!=null){d.RootTable.GetElement(WG40.BODY,WG40.HTMLTABLE)}if(e!=null){Listener.Unload(e)}};this.OnMouseDown=function(){var e=ISGetObject(this.Owner.ControlID);var m=[];var l=[];if(e!=null){var n=e.GetSelectedObject();var k=null;if(n!=null){k=n.ToRowObject()}if(n!=null&&k!=null&&k.Type=="Record"){var q=e.Tables[n.tblName];var d=q.GetRowCheckerColumn();if(d==""||d==null||q.GetCheckedRows().length==0||!this.AllowDragOnCheckedRows){if(q.RowLayout=="PlainColumn"){m.push(n.GetRowElement())}else{m=n.GetColSetRowsElement()}l.push(k)}else{var c=q.GetCheckedRows();for(var g=0;g<c.length;g++){var b=c[g];if(q.RowLayout=="PlainColumn"){m.push(b)}else{var s=wgGetColumnSetRows(b);for(var f=0;f<s.length;f++){m.push(s[f])}}l.push(q.ToRowObject(b))}}}if(m.length>0){var o=ISDragDropEngine.GetXPos(event);var p=ISDragDropEngine.GetYPos(event);var h=false;for(var f=0;f<m.length;f++){var r=new ISDropableObject();r.Element=m[f];r.Enabled=true;if(ISDragDropEngine.IsInDragArea(r,o,p)){h=true;break}r=null}if(h){this.CurrentRows=l}return h}}return false};this.OnPostMouseDown=function(b){b.AlwaysRecreateShadow=true};this.OnShadowCreate=function(e){var g=ISGetObject(this.Owner.ControlID);var k=this.CurrentRows;var l="";var m=null;if(e.ShadowElement==null){var p=0;if(this.ShadowWidthMode=="FixedWidth"){p=this.ShadowWidthValue}m=document.createElement("div");m.IsCustomShadow=true;m.style.cssText="overflow: hidden";if(p>0){m.style.width=p}document.body.insertAdjacentElement("afterBegin",m);e.ShadowElement=m}else{m=e.ShadowElement}if(k!=null&&k.length==1){var p=(g.FrameObj.offsetWidth-20);l="<table cellspacing=0 cellpadding=0 border=0 width="+p;l+=" style='border: #b3d4ff 1px solid'>";for(var h=0;h<k.length;h++){var j=k[h];var f=j.GetElement();var n=j.Table;if(n.RowLayout=="PlainColumn"){l+=f.outerHTML}else{var o=wgGetColumnSetRows(j.GetElement());for(var h=0;h<o.length;h++){l+=o[h].outerHTML}}}l+="</table>";m.AdjustTop=10}else{var b=this.Owner.Parent;l="<div style='width: 110px; height: 110px; background-image:url("+b.ResolveImagePath("","drag_multiple_webgrid.gif")+")'>";l+="<span style='font-family: Segoe UI, Tahoma; font-size: 10pt; color: White; position:relative; top: 43px; left: 48px'>"+k.length+"</span>";l+="</div>";m.AdjustTop=20}m.innerHTML=l;var d=new WebGridDragData();d.Rows=k;d.RowCount=k.length;d.GridId=this.Owner.ControlID;e.Data=d};if(this.Properties!=""){this.OnInitialize()}}var WebDragDropInterfaceEngine={CreateDrag:function(b,a){switch(b){case"WebGrid":return new WebGridDragInterface(a)}return null},CreateDrop:function(b,a){switch(b){case"WebNavPane":return new WebNavPaneDropInterface(a);case"WebDesktopManager":return new WebDesktopManagerDropInterface(a);case"WebExplorerPane":return new WebExplorerPaneDropInterface(a)}return null}};function WebNavPaneDropInterface(a){ComplexControlDropInterface.call(this,a);this.Type="WebNavPane";this.SupportedVersion="2.0";this.DropableOnBar=false;this.DropableOnBarItem=false;this.BarItemOverStyle="border: dotted navy 1px; background-color: #c6e8fa";this.OnInitialize=function(){var b=this.Properties.split(",");for(var d=0;d<b.length;d++){var c=b[d].split("=");switch(c[0]){case"DropableOnBar":this.DropableOnBar=(c[1]=="True");break;case"DropableOnBarItem":this.DropableOnBarItem=(c[1]=="True");break;case"BarItemOverStyle":this.BarItemOverStyle=c[1];break}}};this.AddDropControl=function(e){var h=ISGetObject(this.Owner.ControlID);if(h!=null){var l=[];var d=this.Owner;var k=ISGetObject(d.ControlID);e.Element=h.FrameObj;if(this.DropableOnBar){for(var f=0;f<k.BarItems.length;f++){var b=k.BarItems[f];if(b.Visible&&b.Enabled){if(!b.Collapse){l.push(new WebNavPaneSubDrop(b.GetElement(),"WebNavBar",b))}else{l.push(new WebNavPaneSubDrop(b.GetFooterElement(),"WebNavBar",b))}}}}if(this.DropableOnBarItem){for(var f=0;f<k.BarItems.length;f++){var b=k.BarItems[f];if(b.Visible&&b.Enabled&&b.Get("ContentMode")=="UseItems"){for(var g=0;g<b.Items.length;g++){l.push(new WebNavPaneSubDrop(b.Items[g].GetElement(),"WebNavBarItem",b.Items[g]))}}}}if(l.length>0){e.SubObjects=l}}};this.OnDragQuery=function(c,b){if(this.BarItemOverStyle!=""&&b.SubObjectContext.ItemType=="WebNavBarItem"){var d=b.Element;if(!d.originalStyle){d.originalStyle=d.style.cssText}d.style.cssText=d.style.cssText+this.BarItemOverStyle}};this.OnDragLeaveInternal=function(b){if(this.BarItemOverStyle!=""&&b.SubObjectContext.ItemType=="WebNavBarItem"){var c=b.Element;c.style.cssText=""}};if(this.Properties!=""){this.OnInitialize()}}function WebNavPaneSubDrop(a,c,b){CustomSubDropInterfaceBase.call(this,a);this.Type="WebNavPaneSubDrop";this.ItemType=c;this.ItemObject=b}function WebDesktopManagerDropInterface(a){ComplexControlDropInterface.call(this,a);this.Type="WebDesktopManager";this.SupportedVersion="2.5";this.DropableOnShortcut=false;this.DropableOnWindow=false;this.ActivateWindowOnTaskBarOver=false;this.ShortcutIconOverStyle="border: solid #d8f0fa 1px; background-color: #eaf6fd";this.DetectOverlappingObject=false;this._OverTimeoutID=0;this.OnInitialize=function(){var b=this.Properties.split(",");for(var f=0;f<b.length;f++){var d=b[f].split("=");switch(d[0]){case"DropableOnShortcut":this.DropableOnShortcut=(d[1]=="True");break;case"DropableOnWindow":this.DropableOnWindow=(d[1]=="True");break;case"ActivateWindowOnTaskBarOver":this.ActivateWindowOnTaskBarOver=(d[1]=="True");break;case"ShortcutIconOverStyle":this.ShortcutIconOverStyle=d[1];break;case"DetectOverlappingObject":this.DetectOverlappingObject=(d[1]=="True");break}}if(this.DetectOverlappingObject){var e=this.Owner.Parent;if(e.GlobalCoordResolver==null){e.GlobalCoordResolver=new WebDesktopManagerCoordResolver(this)}}};this.AddDropControl=function(e){var d=ISGetObject(this.Owner.ControlID);if(d!=null){var h=[];var b=this.Owner;e.Element=d.FrameObj;if(this.DropableOnShortcut){for(var f=0;f<d.ShortcutIcons.length;f++){var g=d.ShortcutIcons[f];if(g.Visible&&g.Enabled){h.push(new WebDesktopManagerSubDrop(g.GetElement(),"WebDesktopShortcut",g))}}}if(this.ActivateWindowOnTaskBarOver){for(var f=0;f<d.Windows.length;f++){var k=d.Windows[f];if(k.ShowInTaskBar&&k.Initialized&&!k.IsClosed){var j=k.GetTaskBarButtonElement();if(j!=null){h.push(new WebDesktopManagerSubDrop(j,"WebDesktopTaskBarButton",k))}}}}if(h.length>0){e.SubObjects=h}}};this.OnDragQuery=function(c,b){var d=b.Element;var g="";switch(b.SubObjectContext.ItemType){case"WebDesktopShortcut":g=this.ShortcutIconOverStyle;break;case"WebDesktopTaskBarButton":var h=b.SubObjectContext.ItemObject;if(!h.IsActiveWindow()&&this._OverTimeoutID==0){var f=this;this._OverTimeoutID=setTimeout(function(){f.OnTaskBarOver(c,b)},1000)}break}if(g!=""&&d!=null){if(!d.originalStyle){d.originalStyle=d.style.cssText}d.style.cssText=d.style.cssText+";"+g}};this.OnTaskBarOver=function(f,d){var g=d.SubObjectContext.ItemObject;var b=d.Owner.Parent;g.Activate();b.ClearDropControlCache();b.GlobalCoordResolver.Cache=null;b.GlobalCoordResolver.GetExcludedCoords(d)};this.OnDragLeaveInternal=function(b){var c=b.Element;var d="";if(b.SubObjectContext.ItemType=="WebDesktopShortcut"){d=this.ShortcutIconOverStyle}if(this._OverTimeoutID>0){clearTimeout(this._OverTimeoutID);this._OverTimeoutID=0}if(d!=""&&c!=null){c.style.cssText=c.originalStyle}};if(this.Properties!=""){this.OnInitialize()}}function WebDesktopManagerSubDrop(a,c,b){CustomSubDropInterfaceBase.call(this,a);this.Type="WebDesktopManagerSubDrop";this.ItemType=c;this.ItemObject=b}function WebDesktopManagerCoordResolver(a){this.Type="WebDesktopManagerCoordResolver";this.Object=a;this.Cache=null;this.GetExcludedCoords=function(f){if(this.Cache!=null){return this.Cache}var g=f.Element;var d=this.Object.Owner;var e=ISGetObject(d.ControlID);if(e!=null){var p=null;var k=null;var l=false;var b=new Array();var j="Default";if(f.IsSubObject&&f.SubObjectContext!=null){if(f.SubObjectContext.ItemType=="WebDesktopShortcut"){p=e.Windows;j="All"}else{if(f.SubObjectContext.ItemType=="WebDesktopTaskBarButton"){return}}}else{if(g==e.FrameObj){return}var m=e.GetWindowListByZOrder();p=new Array();for(var h=m.length-1;h>=0;h--){p.push(m[h])}}for(var h=0;h<p.length;h++){var n=p[h];if(j=="Default"){if(n.Get("ContentMode")=="UseInlineContent"){var o=n.GetContentDivElement();if(o.contains(g)&&!l){k=n;l=true;if(n.WindowState=="Minimized"||!n.ClientVisible||n.IsClosed||o.parentElement==null||o.style.display=="none"){f.Enabled=false;ISDragDropEngine.SuspendedDropables.push(f)}}else{if(l){this.AddExclusion(n.GetWindowDivElement(),b)}}}}else{if(j=="All"){o=n.GetWindowDivElement();this.AddExclusion(o,b)}}}this.Cache=b;return b}};this.AddExclusion=function(d,b){var c=new Rectangle(null,null,ISPosLib.getWidth(d),ISPosLib.getHeight(d));c.X=ISPosLib.getLeft(d);c.Y=ISPosLib.getTop(d);if(c.X<0){return}b.push(c)}}function WebExplorerPaneDropInterface(a){ComplexControlDropInterface.call(this,a);this.Type="WebExplorerPane";this.SupportedVersion="2.0";this.DropableOnBar=false;this.DropableOnBarItem=false;this.BarItemOverStyle="border: dotted navy 1px; background-color: #c6e8fa";this.AllowInsertionOnBarItem=false;this.InsertIndicatorStyle="black solid 2px";this.OnInitialize=function(){var b=this.Properties.split(",");for(var d=0;d<b.length;d++){var c=b[d].split("=");switch(c[0]){case"DropableOnPane":this.DropableOnBar=(c[1]=="True");break;case"DropableOnPaneItem":this.DropableOnBarItem=(c[1]=="True");break;case"AllowInsertionOnPaneItem":this.AllowInsertionOnBarItem=(c[1]=="True");break;case"PaneItemOverStyle":this.BarItemOverStyle=c[1];break;case"InsertIndicatorStyle":this.InsertIndicatorStyle=c[1];break}}};this.AddDropControl=function(e){var f=ISGetObject(this.Owner.ControlID);if(f!=null){var k=[];var d=this.Owner;e.Element=f.FrameObj;if(this.DropableOnBar){for(var g=0;g<f.Panes.length;g++){var b=f.Panes[g];if(b.Visible&&b.Enabled){k.push(new WebExplorerPaneSubDrop(b.GetElement(),"WebExplorerPane",b))}}}if(this.DropableOnBarItem){for(var g=0;g<f.Panes.length;g++){var b=f.Panes[g];if(b.Visible&&b.Enabled&&!b.Collapse&&b.Get("ContentMode")=="UseItems"){for(var h=0;h<b.PaneItems.length;h++){k.push(new WebExplorerPaneSubDrop(b.PaneItems[h].GetElement(),"WebExplorerPaneItem",b.PaneItems[h]))}}}}if(k.length>0){e.SubObjects=k}}};this.OnDragQuery=function(c,b){if(this.BarItemOverStyle!=""&&b.SubObjectContext.ItemType=="WebExplorerPaneItem"){var d=b.Element;var i=true;var h="Top";if(this.AllowInsertionOnBarItem){var g=ISPosLib.getTop(d);var f=g+ISPosLib.getHeight(d);if(c.CursorY>g&&c.CursorY<g+7){h="Top";i=false;b.SubObjectContext.ItemInsertionPoint="Before"}else{if(c.CursorY>f-7&&c.CursorY<f){h="Bottom";i=false;b.SubObjectContext.ItemInsertionPoint="After"}else{b.SubObjectContext.ItemInsertionPoint="None"}}}if(typeof(d.originalStyle)=="undefined"){d.originalStyle=d.style.cssText}if(i){d.style.cssText=d.style.cssText+";"+this.BarItemOverStyle}else{if(h=="Top"){d.style.cssText=d.originalStyle+"; border-top:"+this.InsertIndicatorStyle}else{d.style.cssText=d.originalStyle+"; border-bottom:"+this.InsertIndicatorStyle}}}};this.OnDragLeaveInternal=function(b){if(this.BarItemOverStyle!=""&&b.SubObjectContext.ItemType=="WebExplorerPaneItem"){var c=b.Element;var d=true;if(d){c.style.cssText=""}}};if(this.Properties!=""){this.OnInitialize()}}function WebExplorerPaneSubDrop(a,c,b){CustomSubDropInterfaceBase.call(this,a);this.Type="WebExplorerPaneSubDrop";this.ItemType=c;this.ItemObject=b;this.ItemInsertionPoint="None"};