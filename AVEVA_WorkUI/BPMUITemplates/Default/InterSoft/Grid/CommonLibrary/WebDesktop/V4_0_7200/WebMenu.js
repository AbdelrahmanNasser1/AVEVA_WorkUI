function WebMenuControlBase(a){this.ClassName="WebMenuControlBase";this.Version="1.5.2006";this.BuildNumber="0";this.MajorVersion="1.5";this.RequiredFrameworkVersion="2.0.5000.18";ISControl.call(this,a);this.ScriptDirectory="/CommonLibrary/WebDesktop/V3_0_7200/";this.ImageSize=new UnitSize();this.IntegratedTo="None";this.MenuStyleSettings=new WebMenuStyles();this.Initialized=false;this.Id=this.ClientId=a;this.ShowDelay=500;this.TopAdjustment=0;this.LeftAdjustment=0;this.AutoPostBack="No";this.ImageSize.Width=16;this.ImageSize.Height=16;this.OnRootMenuClosed=null;this.MenuWindowType="Popup";this.MenuDropShadow=false;this.MenuAnimation=false;this.MenuAnimationMode="Fading";this.AnimatedObj=null;this.SkipAnimation=false;this.SkipAlpha=false;this.AnimationSpeed="Fast";this.AnimationInterval=10;this.DrawImageBackground=false;this.UseW3CPositioning=false;this.IsRightToLeft=false;this.GetStyleString=function(){return WebMenuEngine.GetStyleString(this)};this.CreateDefaultStyles=function(){WebMenuEngine.CreateDefaultStyles(this)};this.Destroy=function(){if(this.MenuWindowType=="Normal"){for(var b=0;b<this.RootMenu.Items.length;b++){var c=this.RootMenu.Items[b];if(c.HasSubMenu()&&c.SubMenu.Popup!=null){c.SubMenu.Destroy()}}this.RootMenu.Destroy()}};this.ApplyStyles=function(){};this.GetAllMenus=function(){};this.GetAllOpenMenus=function(){};this.SetIntegratedToDesktopManager=function(){WebMenuEngine.IntegrateToDesktopManager(this)};this.SetIntegratedToPlaceHolderManager=function(){WebMenuEngine.IntegrateToPlaceHolderManager(this)};this.CopyMenuSetting=function(b){this.MenuAnimation=b.MenuAnimation;this.MenuAnimationMode=b.MenuAnimationMode;this.MenuDropShadow=b.MenuDropShadow;this.MenuWindowType=b.MenuWindowType;this.AnimationSpeed=b.AnimationSpeed};this.GetLocation=function(c,d,b){return WebMenuEngine.GetLocation(new OffsetLocation(c,d),b)};this.GetEventLocation=function(){return WebMenuEngine.GetLocation(new OffsetLocation(event.clientX,event.clientY))}}function WebContextMenu(a){WebMenuControlBase.call(this,a);this.ClassName="WebContextMenu";this.RootMenu=new WebMenu();this.RootMenu.MenuControl=this;this.RootMenu.Direction="Vertical";this.RootMenu.OffsetAlignment="LeftBottom";this.Items=this.RootMenu.Items;this.ControlId="";this.ClientSideEvents=new WebContextMenuClientSideEvents();this.UseCustomContent=false;this.CustomContentElement=null;this.DisableFullHeightScrolling=false;this.AutoFocusActiveItem=true;this.OnUnload=function(){this.ClearAll()};this.OnPropertiesInitialized=function(){if(this.Events!=null){var b;for(b in this.Events){if(typeof(this.Events[b])=="string"){this.ClientSideEvents[b]=this.Events[b]}}}var c=ISXml.GetAttribute(this.XmlNode,"ImageSize");if(c!=""&&c!=null){this.ImageSize=new UnitSize();this.ImageSize.Parse(c)}};this.ClearAll=function(){WebMenuEngine.ClearMenu(this.RootMenu);this.RootMenu.MenuControl=this;this.Items=this.RootMenu.Items};this.IsAllItemsInvisible=function(c){for(var b=0;b<c.length;b++){if(c[b].Visible){return false}}return true};this.Show=function(c,d,b){if((this.Items.length==0||this.IsAllItemsInvisible(this.Items))&&!this.UseCustomContent){return}if(typeof(c)=="object"&&c!=null){d=c.Y;c=c.X}this.RootMenu.Show(c,d,b)};this.SetOffsetElement=function(b){this.RootMenu.OffsetElement=b};this.HideAll=function(){if(this.RootMenu.IsOpen()){this.RootMenu.Hide()}};this.RefreshStructure=function(){if(this.MenuStyleSettings!=null){this.MenuAnimation=this.MenuStyleSettings.MenuAnimation;this.MenuDropShadow=this.MenuStyleSettings.MenuDropShadow;this.MenuWindowType=this.MenuStyleSettings.MenuWindowType;this.MenuAnimationMode=this.MenuStyleSettings.MenuAnimationMode}WebMenuEngine.ReassignParent(this.Items,this)}}function WebContextMenuClientSideEvents(){this._Type="WebContextMenuClientSideEvents";ISObject.call(this);this.OnInitialize="";this.OnShowMenu="";this.OnMenuItemClick="";this.OnMenuItemSelect=""}function WebMenuStyles(){this._Type="WebMenuStyles";ISObject.call(this);this.ItemStyle=null;this.FrameStyle="";this.DisabledItemStyle=null;this.CheckedItemStyle=null;this.SeparatorStyle="";this.BackgroundStripWidth=23;this.HasBackgroundStrip=true;this.BackgroundStripColor="FFFFFF";this.BackgroundStripColor2="C4C3AC";this.ItemPadding=3;this.ContentPadding=7;this.MenuWindowType="Popup";this.MenuDropShadow=false;this.MenuAnimation=false;this.MenuAnimationMode="Fading";this.IconCellWidth=20;this.BackgroundStripImage="";this.HighlightMode="UseWebStyle";this.UseSmartWebResources=true;this.HighlightDisabledItem=false;this.ImagesSettings=new WebMenuImagesSettings();this.CustomStyle="";this.BackgroundStripStyle="";this.OnPropertiesInitialized=function(){this.Parent.MenuWindowType=this.MenuWindowType;this.Parent.MenuDropShadow=this.MenuDropShadow;this.Parent.MenuAnimation=this.MenuAnimation;this.Parent.MenuAnimationMode=this.MenuAnimationMode}}function WebMenuImagesSettings(){this._Type="WebMenuImagesSettings";ISObject.call(this);this.OverLeft="";this.OverCenter="";this.OverRight="";this.ActiveIconCell="";this.DisabledLeft="";this.DisabledCenter="";this.DisabledRight=""}function WebMenu(a){this._Type="WebMenu";ISObject.call(this);this.Name="";this.Items=new ISArray();this.ParentMenu=null;this.ParentMenuItem=null;this.MenuControl=null;this.DisplayMode="ImageAndText";this.IconViewMode=false;this.ActiveItemIndex=-1;this.ActiveItem=null;this.Direction="Horizontal";this.OffsetAlignment="RightTop";this.Width=null;this.Initialized=false;this.Element=null;this.Popup=null;this.OffsetElement=null;this.Items.Parent=this;this.ScrollInterval=-1;this.ScrollEnabled=false;this.RuntimeHeight=0;this._TempDiv=null;this._NeedSizeRecalc=false;this._CloseIntervalId=-1;if(a){this.ParentMenuItem=a}this.IsOpen=function(){if(this.Popup){return this.Popup.isOpen}else{return false}};this.IsRootMenu=function(){return(this.ParentMenuItem==null)};this.GetGroupItems=function(){var b=new Array();var c=null;for(var d=0;d<this.Items.length;d++){var e=this.Items[d];if((e.Text==null||e.Text==""||(e.Text!=""&&e.IconViewDisplayMode=="Image"))&&e.Type!="Separator"&&e.Type!="Custom"){if(c==null||(c!=null&&c.constructor!=Array)){c=new ISArray()}c.Add(e)}else{c=e}var f=this.Items[d+1];if(f&&(f.Type=="Separator"||f.ImageURL==""||f.ImageURL==null||(f.ImageURL!=""&&f.IconViewDisplayMode=="Text"))){b.push(c);c=null}else{if(!f){b.push(c)}}}return b};this.GetOpenSubMenu=function(){for(var b=0;b<this.Items.length;b++){var c=this.Items[b];if(c.HasSubMenu()&&c.Enabled&&c.IsSubMenuOpen()){return c}}return null};this.GetId=function(){var f=this.MenuControl.Id+"_";var g="";var d="";var e=this.ParentMenuItem;var b=new Array();while(e!=null){b.push(e.Name);e=e.OwnerMenu.ParentMenuItem}b.reverse();for(var c=0;c<b.length;c++){d=b[c]+"_"}g=f+d;return g};this.GetDocument=function(){if(this.Popup){try{return this.Popup.document}catch(b){return null}}else{return null}};this.GetElement=function(){return this.Element};this.GetMenuBodyElement=function(){var b=this.GetDocument();if(b){return b.getElementById(this.GetId()+"_body")}else{return null}};this.GetMenuContainerElement=function(){var b=this.GetDocument();if(b){return b.getElementById(this.GetId()+"_container")}else{return null}};this.GetScrollElement=function(c){var b=this.GetDocument();return b.getElementById(this.GetId()+"_scroll_"+c)};this.GetSelectedItemByGroup=function(b){for(var c=0;c<this.Items.length;c++){var d=this.Items[c];if(d.Type=="Radio"&&d.GroupName==b&&d.Checked){return d}}return null};this.Destroy=function(){var c=this.Element;if(c){Listener.Unload(c)}if(this.Popup){if(this.MenuControl.MenuWindowType=="Popup"){var b=this.GetDocument();b.open("text/plain","replace");b.write("");b.close();this.Popup=null}else{document.body.removeChild(this.Popup._e);ISDeleteObject(this.Popup)}}};this.Show=function(c,d,b){if(!this.Initialized){WebMenuEngine.InitializeMenu(this)}WebMenuEngine.ShowMenu(this,c,d,b)};this.Initialize=function(){if(!this.Initialized){WebMenuEngine.InitializeMenu(this)}};this.InstantiateIn=function(b){this.Initialize();if(this.MenuControl.MenuWindowType!="Normal"){alert("InstantiateIn method can only be used with Normal MenuWindowType");return}b.appendChild(this.Popup._e)};this.SetStaticVisibility=function(){this.Popup._e.style.cssText="";this.Popup._e.keepVisible=true;this.GetElement().style.position="";this.GetMenuBodyElement().parentElement.style.position="";this.GetMenuContainerElement().style.position=""};this.Hide=function(){if(!this.IsOpen()){return}if(this.Popup&&this.Popup.hide){this.Popup.hide()}if(!IS.ie||this.MenuControl.MenuWindowType=="Normal"){var c=this.GetOpenSubMenu();if(c){c.SubMenu.Hide()}}if(IS.ie&&this.MenuControl.AutoFocusActiveItem&&this.MenuControl.MenuWindowType=="Normal"){if(this.ParentMenu!=null){this.ParentMenu.SetActive()}}if(this.MenuControl.MenuAnimation){if(this.MenuControl.AnimatedObj!=null){var b=this.MenuControl.AnimatedObj.IntervalId;if(b>0){clearTimeout(b);this.MenuControl.AnimatedObj.IntervalId=-1}WebMenuEngine.RemoveFilter(this)}}};this.GetDocumentEvent=function(){return this.GetDocument().parentWindow.event};this.GetContentWindow=function(){return this.GetDocument().parentWindow};this.Invalidate=function(){};this.GetStripElement=function(){var c=this.MenuControl;var d=c.MenuStyleSettings;if(d.HasBackgroundStrip&&!this.IconViewMode){var b=this.GetDocument();if(b){return b.getElementById(this.GetId()+"_strip")}}return null};this.SetActive=function(){if(IS.ie){try{this.Element.setActive()}catch(b){}}};this.GetRootMenu=function(){var b=this.ParentMenu;if(b==null){return this}while(true){if(b.ParentMenu==null){return b}else{b=b.ParentMenu}}return null};this.SetDirty=function(){this._NeedSizeRecalc=true};this.GetItem=function(b){return this.Items.GetNamedItem(b)};this.Clear=function(){WebMenuEngine.ClearMenu(this)};this.SetHeight=function(c){var b=this.GetElement();b.style.height=c};this.RemoveAllItems=function(){var b=this.Items.length;for(var c=0;c<b;c++){this.Items.Remove(this.Items[0])}};this.PerformKeyboardNavigation=function(b){WebMenuEngine.OnKeyDown(this,b)};this.InvalidateUI=function(){WebMenuEngine.RefreshDimension(this)}}function WebMenuSeparatorItem(a){WebMenuItem.call(this);if(a){this.Name=a}this.Type="Separator"}function WebMenuRadioItem(d,b,g,c,e,f,a){WebMenuItem.call(this,d,g,c,e,f);this.Type="Radio";if(b){this.GroupName=b}if(a){this.Checked=a}}function WebMenuCheckBoxItem(c,f,b,d,e,a){WebMenuItem.call(this,c,f,b,d,e);this.Type="CheckBox";if(a){this.Checked=a}}function WebMenuItem(name,text,image,onClick,shortcut){this._Type="WebMenuItem";ISObject.call(this);this.Name="";this.Index=-1;this.Collection=null;this.ParentMenu=null;this.SubMenu=new WebMenu(this);this.OwnerMenu=null;this.Element=null;this.Items=this.SubMenu.Items;this.Type="Normal";this.Text="";this.ImageURL="";this.OnClick=null;this.KeepMenuVisible=false;this.Enabled=true;this.AccessKey="";this.Shortcut=new ShortcutKey();this.Tooltip="";this.Visible=true;this.TargetURL="";this.TargetFrame="blank";this.GroupName="";this.IconViewDisplayMode="Image";this.IconViewMode=false;this.UseFontImage=false;this.AutoPostBack="Default";this.Tag="";this.Selected=false;this.Checked=false;this.PredefinedId="";this.IsPredefinedItem=false;this.CustomElement=null;this.QueueId=-1;this.CloseQueueId=-1;if(name){this.Name=name}if(text){this.Text=text}if(image){this.ImageURL=image}if(onClick){this.OnClick=onClick}if(shortcut){this.Shortcut=shortcut}this.OnPropertiesInitialized=function(){if(this.Parent.GetType()=="WebContextMenu"){this.OwnerMenu=this.Parent.RootMenu}else{if(this.Parent.GetType()=="WebNotification"){this.OwnerMenu=this.Parent.ActionMenu}else{if(this.Parent.GetType()=="WebMenuItem"){this.OwnerMenu=this.Parent.SubMenu}else{if(this.Parent.GetType()=="WebMenu"){this.OwnerMenu=this.Parent}}}}this.Collection=this.OwnerMenu.Items;this.Index=this.Collection.length};this.OnAdd=function(){if(!this.OwnerMenu){this.OwnerMenu=this.Parent}this.Collection=this.OwnerMenu.Items;if(this.OwnerMenu.Element!=null){WebMenuEngine.AddMenuItem(this)}this.Collection.ReindexPosition()};this.OnInsert=function(pos){this.OwnerMenu=this.Parent;this.Collection=this.OwnerMenu.Items;if(this.OwnerMenu.Element!=null){WebMenuEngine.InsertMenuItem(this,pos)}this.Collection.ReindexPosition()};this.OnRemove=function(){if(this.OwnerMenu.Element!=null){WebMenuEngine.RemoveMenuItem(this)}this.Collection.ReindexPosition()};this.IsUsingImageIconViewMode=function(){if(this.OwnerMenu.IconViewMode){if(this.Text==null||this.Text==""||(this.Text!=""&&this.IconViewDisplayMode=="Image")){return true}}return false};this.ScrollIntoView=function(){var sc=this.OwnerMenu.GetMenuBodyElement().parentElement;var el=this.GetElement();var scrollTop=sc.scrollTop;var clientHeight=sc.clientHeight;var offsetTop=el.offsetTop;var offsetHeight=el.offsetHeight;if(offsetTop<scrollTop){sc.scrollTop=offsetTop}else{if(offsetTop+offsetHeight>scrollTop+clientHeight){sc.scrollTop=offsetTop+offsetHeight-clientHeight}}};this.GetElement=function(){if(!this.Element){var menuEl=this.OwnerMenu.GetMenuBodyElement();var menu=this.OwnerMenu;if(menuEl){if(menu.IconViewMode){for(var i=0;i<menuEl.rows.length;i++){var r=menuEl.rows[i];if(this.IsUsingImageIconViewMode()){if(IS.GetAttr(r,"type")=="GroupItem"){var cell=r.cells[1];for(var j=0;j<cell.children.length;j++){var sp=cell.children[j];if(IS.GetAttr(sp,"name")==this.Name){this.Element=sp;break}}}}else{if(IS.GetAttr(r,"name")==this.Name){this.Element=r;break}}}}else{for(var i=0;i<menuEl.rows.length;i++){var r=menuEl.rows[i];if(IS.GetAttr(r,"name")==this.Name){this.Element=r;break}}}}}return this.Element};this.HasSubMenu=function(){return(this.Items.length>0)};this.Click=function(){WebMenuEngine.ClickItem(this)};this.GetPreviousSelectableItem=function(){var prevIdx=this.Index-1;if(prevIdx<0){prevIdx=this.Collection.length-1}var target=this.Collection[prevIdx];if(target){if(target.Visible&&target.Type!="Separator"&&target.Type!="Custom"){return target}else{if(this.Index==0&&this.Collection.length==1){return null}else{return target.GetPreviousSelectableItem()}}}return null};this.GetNextSelectableItem=function(){var nextIdx=this.Index+1;if(nextIdx>(this.Collection.length-1)){nextIdx=0}var target=this.Collection[nextIdx];if(target){if(target.Visible&&target.Type!="Separator"&&target.Type!="Custom"){return target}else{if(this.Index==0&&this.Collection.length==1){return null}else{return target.GetNextSelectableItem()}}}return null};this.SetChecked=function(isChecked,fromCode){var el=this.GetElement();var cell;var sp;var spText;if(typeof(isChecked)=="undefined"){isChecked=true}if(this.Type=="Radio"&&isChecked){var lastOption=this.OwnerMenu.GetSelectedItemByGroup(this.GroupName);if(lastOption&&lastOption==this){return false}if(lastOption){lastOption.SetChecked(false)}}this.Checked=isChecked;if(!el){return}if(el.tagName=="TR"){cell=el.cells[0];sp=cell.children[0];if(IS.ie||IS.moz){spText=sp.children[0].children[0]}else{spText=sp.children[0]}}else{if(el.tagName=="SPAN"){sp=el;if(IS.ie||IS.moz){spText=sp.children[0].children[0]}else{spText=sp.children[0]}}}var styles=this.OwnerMenu.MenuControl.MenuStyleSettings;if(this.Checked){if(this.UseFontImage){spText.innerHTML=WebMenuEngine.GetSymbol(styles,this.Type=="CheckBox"?"a":this.Type=="Radio"?"=":"");if(IsGecko30()&&spText.tagName=="IMG"){spText.style.display=""}}if(styles.HighlightMode=="UseWebStyle"){if(!fromCode){DynamicStyleEngine.SetToOverStyle(null,styles.CheckedItemStyle,sp)}else{DynamicStyleEngine.SetToStyle(null,styles.CheckedItemStyle,sp)}}else{with(sp.style){backgroundImage="url("+WebMenuEngine.GetImage(styles,"ActiveIconCell",true)+")";backgroundRepeat="no-repeat";backgroundPosition="top left";marginTop="-1px";height="22px";if(IS.ie){paddingTop="3px";paddingRight="3px"}}}}else{if(this.UseFontImage){spText.innerHTML="";if(IsGecko30()&&spText.tagName=="IMG"){spText.style.display="none"}}sp.className="";sp.style.backgroundImage="none"}};this.Enable=function(){if(this.Enabled){return}var menuItemEl=this.GetElement();var itemStyle=this.OwnerMenu.MenuControl.MenuStyleSettings.ItemStyle;if(menuItemEl){if(this.OwnerMenu.IconViewMode){}else{for(var i=0;i<menuItemEl.cells.length;i++){var cell=menuItemEl.cells[i];cell.disabled=false;DynamicStyleEngine.SetToStyle(null,itemStyle,cell)}}if(this.ImageURL!=""){var imageEl=this.GetImageElement();imageEl.style.filter="";imageEl.style.backgroundColor=""}}this.Enabled=true};this.Disable=function(){if(!this.Enabled){return}var menuItemEl=this.GetElement();var ctrl=this.OwnerMenu.MenuControl;var itemStyle=this.OwnerMenu.MenuControl.MenuStyleSettings.DisabledItemStyle;if(menuItemEl){if(this.OwnerMenu.IconViewMode){}else{for(var i=0;i<menuItemEl.cells.length;i++){var cell=menuItemEl.cells[i];cell.disabled=true;DynamicStyleEngine.SetToStyle(null,itemStyle,cell)}}if(this.ImageURL!=""){var imageEl=this.GetImageElement();imageEl.style.filter=(this.OwnerMenu.MenuControl.SkipAlpha?"":"Alpha(Opacity=50),")+"Gray()";if(ctrl.DrawImageBackground){imageEl.style.backgroundColor=ctrl.MenuStyleSettings.BackgroundStripColor}}}this.Enabled=false};this.Show=function(){if(this.Visible){return}var menuItemEl=this.GetElement();if(menuItemEl){menuItemEl.style.display=""}this.Visible=true};this.Hide=function(){if(!this.Visible){return}var menuItemEl=this.GetElement();if(menuItemEl){menuItemEl.style.display="none"}this.Visible=false};this.GetContentElement=function(){var menuItemEl=this.GetElement();if(menuItemEl.tagName=="TR"){return menuItemEl.cells[1]}return null};this.SetText=function(text){var menuItemEl=this.GetElement();if(menuItemEl){if(menuItemEl.tagName=="TR"){var cellText=menuItemEl.cells[1];cellText.innerHTML=text}}this.Text=text};this.GetImageElement=function(){var menuItemEl=this.GetElement();if(menuItemEl){if(menuItemEl.tagName=="TR"){var cellText=menuItemEl.cells[0];return cellText.children[0].children[0]}else{if(menuItemEl.tagName=="SPAN"){return menuItemEl.children[0]}}}};this.SetImage=function(imageURL){var menuItemEl=this.GetElement();if(menuItemEl){if(menuItemEl.tagName=="TR"){var cellText=menuItemEl.cells[0];cellText.children[0].src=imageURL}else{if(menuItemEl.tagName=="SPAN"){menuItemEl.children[0].src=imageURL}}}this.ImageURL=imageURL};this.Destroy=function(){var menuItemEl=this.GetElement();if(menuItemEl){Listener.Unload(menuItemEl)}};this.Delete=function(){this.Collection.Remove(this)};this.Unselect=function(){if(this.Type=="Separator"){return}WebMenuEngine.UnSelectMenuItem(this)};this.IsSelected=function(){return(this.OwnerMenu.ActiveItem==this)};this.Select=function(unselectPreviousItem){if(this.Type=="Separator"){return}if(this.IsSelected()){return}if(typeof(unselectPreviousItem)=="undefined"){unselectPreviousItem=true}if(unselectPreviousItem){if(this.ActiveItem){WebMenuEngine.UnSelectMenuItem(this.ActiveItem)}}WebMenuEngine.SelectMenuItem(this)};this.IsSubMenuOpen=function(){return this.SubMenu.IsOpen()};this.HideSubMenuQueue=function(){if(this.HasSubMenu()&&this.IsSubMenuOpen()){var menu=this.SubMenu;this.CloseQueueId=setTimeout(function(){if(menu.ParentMenuItem.InHideQueue()){menu.Hide()}},this.OwnerMenu.MenuControl.ShowDelay)}};this.ShowSubMenu=function(autoSelectFirstRow){if(this.HasSubMenu()){var menu=this.SubMenu;menu.MenuControl=this.OwnerMenu.MenuControl;menu.ParentMenu=this.OwnerMenu;menu.OffsetElement=this.GetElement();menu.Show();if(autoSelectFirstRow){var nextItem=menu.Items[0];if(nextItem&&(nextItem.Type=="Custom"||nextItem.Type=="Separator")){nextItem=nextItem.GetNextSelectableItem()}if(nextItem){nextItem.Select()}}}};this.ShowSubMenuQueue=function(skipDelay,autoSelectFirstRow){if(this.HasSubMenu()){var menu=this.SubMenu;var delayTime=this.OwnerMenu.MenuControl.ShowDelay;menu.MenuControl=this.OwnerMenu.MenuControl;menu.ParentMenu=this.OwnerMenu;menu.OffsetElement=this.GetElement();if(skipDelay){delayTime=1}this.QueueId=setTimeout(function(){menu.Show();if(autoSelectFirstRow){var nextItem=menu.Items[0];if(nextItem&&(nextItem.Type=="Custom"||nextItem.Type=="Separator")){nextItem=nextItem.GetNextSelectableItem()}if(nextItem){nextItem.Select()}}},delayTime)}};this.CancelShow=function(){if(this.QueueId>0){clearTimeout(this.QueueId);this.QueueId=-1}};this.CancelHide=function(){if(this.CloseQueueId>0){clearTimeout(this.CloseQueueId);this.CloseQueueId=-1}};this.InShowQueue=function(){return this.QueueId>0};this.InHideQueue=function(){return this.CloseQueueId>0}}function InitWebContextMenu(d){var a=new WebContextMenu(d);var g=null;try{g=ISXml.GetNode(a.XmlDt,"//WebContextMenu")}catch(b){}if(g==null){g=a.XmlDt.documentElement}if(g!=null){IS.SetPropertiesRecursive(a,g);var f=["ItemStyle","DisabledItemStyle","CheckedItemStyle"];DynamicStyleEngine.AssignFromArray(a.MenuStyleSettings,a.MenuStyleSettings.XmlNode,f)}ISEvent.Raise(a.ClientSideEvents.OnInitialize,d);window.attachEvent("onload",function(){OnContextMenuLoad(a)});window.attachEvent("onunload",function(){OnContextMenuUnload(a)})}function OnContextMenuUnload(a){window.detachEvent("onload",function(){OnContextMenuLoad(a)});window.detachEvent("onunload",function(){OnContextMenuUnload(a)})}function OnContextMenuLoad(a){if(a.ControlId!=""){var d=null;if(a.ControlId=="Page"){d=document.body}else{d=ISGetObject(a.ControlId)}if(!d){d=document.getElementById(a.ControlId)}if(!d){d=document.getElementsByName(a.ControlId);if(d&&d.length>0){d=d[0]}}if(d&&d.tagName){if(a.ControlId!="Page"){a.SetOffsetElement(d)}Listener.Add(d,"oncontextmenu",function(){OnGenericControlContextMenu(a);return false})}else{if(d&&d.ClassName&&d.FrameObj){var b=d.FrameObj;Listener.Add(b,"oncontextmenu",function(){OnISControlContextMenu(a);return false})}}}if(a.IntegratedTo=="None"){a.CreateDefaultStyles()}else{if(a.IntegratedTo=="DesktopManager"){a.SetIntegratedToDesktopManager()}else{a.SetIntegratedToPlaceHolderManager()}}}function OnISControlContextMenu(a){event.cancelBubble=true;event.returnValue=false;var b=(IS.ie)?event.screenX:event.clientX+ISPosLib.getWindowScreenLeft();var d=(IS.ie)?event.screenY:event.clientY+ISPosLib.getWindowScreenTop();if(IS.ie&&a.MenuWindowType=="Normal"){b-=ISPosLib.getWindowScreenLeft();d-=ISPosLib.getWindowScreenTop()}a.Show(b,d)}function OnGenericControlContextMenu(a){event.cancelBubble=true;event.returnValue=false;var b=(IS.ie)?event.screenX:event.clientX+ISPosLib.getWindowScreenLeft();var d=(IS.ie)?event.screenY:event.clientY+ISPosLib.getWindowScreenTop();if(IS.ie&&a.MenuWindowType=="Normal"){b-=ISPosLib.getWindowScreenLeft();d-=ISPosLib.getWindowScreenTop()}if(a.ControlId=="Page"){a.Show(b,d)}else{a.Show()}}var WebMenuEngine={GetLocationX:function(a){return a.X+(IS.moz||IS.opera||IS.safari?ISPosLib.getWindowScreenLeft():0)},GetLocationY:function(a,b){return((IS.moz||IS.opera||IS.safari)?ISPosLib.getWindowScreenTop():0)+a.Y+(IS.safari&&!b?document.body.scrollTop:0)},GetLocation:function(a,b){return new OffsetLocation(WebMenuEngine.GetLocationX(a,b),WebMenuEngine.GetLocationY(a,b))},InitializeMenu:function(a){var b=WebMenuEngine.RenderMenu(a);WebMenuEngine.CreatePopup(a,b);WebMenuEngine.RegisterBehaviours(a);a.Initialized=true},RegisterBehaviours:function(c){var b=c.Element;var a=c.GetDocument();var e=window;if(b){if(!c.MenuControl.UseCustomContent){Listener.Add(b,"onmouseover",WebMenuEngine.OnMouseEvent,c);Listener.Add(b,"onmouseout",WebMenuEngine.OnMouseEvent,c);Listener.Add(b,"onmousedown",WebMenuEngine.OnMouseEvent,c);Listener.Add(b,"onmouseup",WebMenuEngine.OnMouseEvent,c);Listener.Add(b,"onmousewheel",WebMenuEngine.OnMouseWheel,c)}Listener.Add(b,"onselectstart",WebMenuEngine.OnSelectStart,c);Listener.Add(e,"onunload",WebMenuEngine.OnUnload,c);Listener.Add(b,"oncontextmenu",WebMenuEngine.OnContextMenu,c);if(c.MenuControl.MenuWindowType=="Popup"){Listener.Append(0,a,"onkeydown",WebMenuEngine.OnKeyDown,c)}else{Listener.Add(b,"onkeydown",WebMenuEngine.OnKeyDown,c)}}},TransferStyleRule:function(c,b){if(!IS.GetCssObject(null,b)){var a=c.GetCssObject(b);var d=IS.GetRuntimeStyleSheetExact();if(a){if(IS.ie){d.addRule(a.selectorText,a.style.cssText)}else{d.innerHTML+=a.selectorText+" { "+a.style.cssText+" }\n"}return true}}return false},DefaultFrameStyle:"border: #8A867A 1px solid; background-color: white",DefaultItemNormalStyle:"font-family: Tahoma; font-size: 8pt",DefaultItemOverStyle:"font-family: Tahoma; font-size: 8pt; border: #316AC5 1px solid; background-color: #C1D2EE;",DefaultCheckedNormalStyle:"border: #316AC5 1px solid; background-color: #E1E6E8",DefaultCheckedOverStyle:"border: #4B4B6F 1px solid; background-color: #316AC5",DefaultDisabledNormalStyle:"font-family: Tahoma; font-size: 8pt; color: Silver",DefaultDisabledOverStyle:"font-family: Tahoma; font-size: 8pt; border: Gray 1px solid; background-color:WhiteSmoke; color: Gray",DefaultSeparatorStyle:"border-top: #C4C3AC 1px solid",DefaultCustomStyle:"background-color: #dde7ee; border-bottom: #c5c5c5 solid 1px; color: #00156E; font-family: Segoe UI, Tahoma; font-size: 9pt; padding: 4px; font-weight: bold",CreateDefaultStyles:function(a){var b=a.MenuStyleSettings;IS.AddRuntimeCssStyle(b.FrameStyle,WebMenuEngine.DefaultFrameStyle);IS.AddRuntimeCssStyle(b.ItemStyle.Normal,WebMenuEngine.DefaultItemNormalStyle);IS.AddRuntimeCssStyle(b.ItemStyle.Over,WebMenuEngine.DefaultItemOverStyle);IS.AddRuntimeCssStyle(b.CheckedItemStyle.Normal,WebMenuEngine.DefaultCheckedNormalStyle);IS.AddRuntimeCssStyle(b.CheckedItemStyle.Over,WebMenuEngine.DefaultCheckedOverStyle);IS.AddRuntimeCssStyle(b.DisabledItemStyle.Normal,WebMenuEngine.DefaultDisabledNormalStyle);IS.AddRuntimeCssStyle(b.DisabledItemStyle.Over,WebMenuEngine.DefaultDisabledOverStyle);IS.AddRuntimeCssStyle(b.SeparatorStyle,WebMenuEngine.DefaultSeparatorStyle);if(b.CustomStyle!=""){IS.AddRuntimeCssStyle(b.CustomStyle,WebMenuEngine.DefaultCustomStyle)}},IntegrateToDesktopManager:function(a){var b=ISGetDesktopManager();if(!b){alert("Can't integrate to DesktopManager because no DesktopManager instance were found!");a.CreateDefaultStyles();return}if(!b.MenuStyles.Application){alert("Integration failed because ContextMenu is currently disabled in DesktopManager. Please set EnableContextMenu to true.");a.CreateDefaultStyles();return}a.MenuStyleSettings.CopyFrom(b.MenuStyles.Application);a.MenuStyleSettings.Parent=a;a.MenuStyleSettings.OnPropertiesInitialized();WebMenuEngine.PerformStyleTransfers(b,a.MenuStyleSettings)},IntegrateToPlaceHolderManager:function(a){var b=ISGetPlaceHolderManager();if(b){b.IntegrateMenuControl(a);WebMenuEngine.PerformStyleTransfers(b,a.MenuStyleSettings)}},PerformStyleTransfers:function(a,b){if(!WebMenuEngine.TransferStyleRule(a,b.FrameStyle)){IS.AddRuntimeCssStyle(b.FrameStyle,WebMenuEngine.DefaultFrameStyle)}if(!WebMenuEngine.TransferStyleRule(a,b.ItemStyle.Normal)){IS.AddRuntimeCssStyle(b.ItemStyle.Normal,WebMenuEngine.DefaultItemNormalStyle)}if(!WebMenuEngine.TransferStyleRule(a,b.ItemStyle.Over)){IS.AddRuntimeCssStyle(b.ItemStyle.Over,WebMenuEngine.DefaultItemOverStyle)}if(!WebMenuEngine.TransferStyleRule(a,b.CheckedItemStyle.Normal)){IS.AddRuntimeCssStyle(b.CheckedItemStyle.Normal,WebMenuEngine.DefaultCheckedNormalStyle)}if(!WebMenuEngine.TransferStyleRule(a,b.CheckedItemStyle.Over)){IS.AddRuntimeCssStyle(b.CheckedItemStyle.Over,WebMenuEngine.DefaultCheckedOverStyle)}if(!WebMenuEngine.TransferStyleRule(a,b.DisabledItemStyle.Normal)){IS.AddRuntimeCssStyle(b.DisabledItemStyle.Normal,WebMenuEngine.DefaultDisabledNormalStyle)}if(!WebMenuEngine.TransferStyleRule(a,b.DisabledItemStyle.Over)){IS.AddRuntimeCssStyle(b.DisabledItemStyle.Over,WebMenuEngine.DefaultDisabledOverStyle)}if(!WebMenuEngine.TransferStyleRule(a,b.SeparatorStyle)){IS.AddRuntimeCssStyle(b.SeparatorStyle,WebMenuEngine.DefaultSeparatorStyle)}if(!WebMenuEngine.TransferStyleRule(a,b.CustomStyle)){IS.AddRuntimeCssStyle(b.CustomStyle,WebMenuEngine.DefaultCustomStyle)}},OnSelectStart:function(){var c=this.GetDocumentEvent();var b=c.srcElement;var d=b.tagName;var a=true;switch(d){case"INPUT":case"SELECT":case"TEXTAREA":a=false}if(a){c.cancelBubble=true;c.returnValue=false}},OnContextMenu:function(){this.GetDocumentEvent().returnValue=false},OnKeyDown:function(q,g){var b=this;if(q!=window&&typeof(q)=="object"&&q.GetType){b=q}var f=b.GetDocumentEvent();if(g){f=g}var e=f.srcElement;var r=WebMenuEngine.GetObjectType(e);var m=f.keyCode;var h=false;if(b.IconViewMode){if(m==ISKeyboardKey.LEFT){m=ISKeyboardKey.UP}if(m==ISKeyboardKey.RIGHT){m=ISKeyboardKey.DOWN}}switch(m){case ISKeyboardKey.ESC:if(b.ActiveItem){b.ActiveItem.OwnerMenu.Hide()}break;case ISKeyboardKey.UP:var a=b.ActiveItem;if(!a&&b.Items.length>0){a=b.Items[0]}if(a){var s=a.GetPreviousSelectableItem();if(s){s.Select()}if(b.ScrollEnabled){s.ScrollIntoView();WebMenuEngine.FixScrollState(b)}h=true}break;case ISKeyboardKey.DOWN:var a=b.ActiveItem;if(!a&&b.Items.length>0){a=b.Items[b.Items.length-1]}if(a){var p=a.GetNextSelectableItem();if(p){p.Select()}if(b.ScrollEnabled){p.ScrollIntoView();WebMenuEngine.FixScrollState(b)}h=true}break;case ISKeyboardKey.LEFT:var a=b.ActiveItem;if(a){if(a.OwnerMenu.ParentMenu!=null){b.Hide();h=true}else{WebMenuEngine.HandleForWebMenuBarOnKeyDown(m,a)}}break;case ISKeyboardKey.RIGHT:var a=b.ActiveItem;if(a){if(a.Enabled&&a.Visible&&a.HasSubMenu()){a.OwnerMenu.MenuControl.SkipAnimation=true;a.ShowSubMenuQueue(true,true)}else{WebMenuEngine.HandleForWebMenuBarOnKeyDown(m,a)}}h=true;break;case ISKeyboardKey.ENTER:var a=b.ActiveItem;if(a){if(a.HasSubMenu()){a.ShowSubMenuQueue(true,true)}else{if(a.Enabled){a.Click()}}h=true}break;default:var d=String.fromCharCode(m).toLowerCase();var k=b.Items;var n=k.length;for(var j=0;j<n;j++){if(k[j].AccessKey==d&&k[j].Enabled&&k[j].Type!="Separator"&&k[j].Type!="Custom"){k[j].Select();k[j].Click();h=true;break}}}if(h){f.cancelBubble=true;f.returnValue=false}},HandleForWebMenuBarOnKeyDown:function(b,a){if(a.Parent!=null){var c=a.Parent.MenuControl;if(c&&c.ClassName=="WebMenuBar"){var d=c.OnMenuKeyDown;if(typeof(d)=="string"){ISEvent.Raise(d,b,a)}else{if(typeof(d)=="function"){d(b,a)}}}}},OnMouseWheel:function(d){var a=this;if(a.ScrollEnabled){var e=a.GetMenuBodyElement().parentElement;var b=a.GetDocumentEvent();if(d){b=d}e.scrollTop-=3*b.wheelDelta/120*20;WebMenuEngine.FixScrollState(a);b.cancelBubble=true;b.returnValue=false}},OnMouseEvent:function(j,f){var a=this;if(j!=window&&typeof(j)=="object"&&j.GetType){a=j}var e=a.GetDocumentEvent();if(f){e=f}var d=e.srcElement;var k=WebMenuEngine.GetObjectType(d);if(k==""){if(a.IconViewMode){var l=WebMenuEngine.GetSpan(d);if(l==null){d=WebMenuEngine.GetTD(d)}else{d=l}k=WebMenuEngine.GetObjectType(d)}else{d=WebMenuEngine.GetTD(d);k=WebMenuEngine.GetObjectType(d)}}if(k==""){if(d!=null&&a.GetElement().contains(d)){d.cancelBubble=true;e.cancelBubble=true;e.returnValue=false}return}switch(e.type){case"mouseover":if(k=="MenuItem"){var i=WebMenuEngine.GetItemNameByElement(d);var h=a.Items.GetNamedItem(i);if((!h.Enabled&&!a.MenuControl.MenuStyleSettings.HighlightDisabledItem)||h.Type=="Custom"){WebMenuEngine.CloseSubMenu(a,h);return}h.Select(false);if(h.HasSubMenu()&&!h.IsSubMenuOpen()&&!h.InShowQueue()&&h.Enabled){if(a.MenuControl.MenuWindowType=="Normal"){WebMenuEngine.CloseSubMenu(a,h)}h.OwnerMenu.MenuControl.SkipAnimation=false;h.ShowSubMenuQueue()}else{if(h.HasSubMenu()&&h.IsSubMenuOpen()){if(h.InHideQueue()){h.CancelHide()}}else{WebMenuEngine.CloseSubMenu(a,h)}}if(a.ParentMenuItem!=null){if(a.ParentMenuItem.InHideQueue()){a.ParentMenuItem.CancelHide()}}}else{if(k=="ScrollUp"){a.ScrollInterval=setInterval(function(){WebMenuEngine.ScrollMenu(a,"up")},100)}else{if(k=="ScrollDown"){a.ScrollInterval=setInterval(function(){WebMenuEngine.ScrollMenu(a,"down")},100)}}}break;case"mouseout":if(k=="MenuItem"){var i=WebMenuEngine.GetItemNameByElement(d);var h=a.Items.GetNamedItem(i);var m=e.toElement;var g=a.GetElement();if((!h.Enabled&&!a.MenuControl.MenuStyleSettings.HighlightDisabledItem)||h.Type=="Custom"){return}if(a.ActiveItem!=null&&a.ActiveItem!=h&&m!=null){a.ActiveItem.Unselect()}if(a.ActiveItem!=null&&a.ActiveItem.GetElement().contains(m)){return}if(g.contains(m)){h.Unselect()}if(h.HasSubMenu()&&h.InShowQueue()){h.CancelShow()}}else{if(k=="ScrollUp"){if(a.ScrollInterval>0){clearInterval(a.ScrollInterval)}}else{if(k=="ScrollDown"){if(a.ScrollInterval>0){clearInterval(a.ScrollInterval)}}}}break;case"mousedown":if(!IS.ie||a.MenuControl.MenuWindowType=="Normal"){e.srcElement.cancelBubble=true;e.cancelBubble=true;e.returnValue=false}a.IsMouseDown=true;break;case"mouseup":if(!a.IsMouseDown){return}a.IsMouseDown=false;if(k=="MenuItem"){var i=WebMenuEngine.GetItemNameByElement(d);var h=a.Items.GetNamedItem(i);var m=e.toElement;var g=a.GetElement();var b=a.MenuControl;if(!h.Enabled){return}if(b.MenuAnimation&&b.AnimatedObj!=null&&b.AnimatedObj.IntervalId>0){return}if(IS.moz){e.cancelBubble=true;e.returnValue=false}if(h.HasSubMenu()&&!h.IsSubMenuOpen()&&h.Enabled){if(h.InShowQueue()){h.CancelShow()}if(!h.IsSubMenuOpen()){h.ShowSubMenuQueue(true)}if(a.MenuControl.MenuWindowType=="Normal"){WebMenuEngine.CloseSubMenu(a,h,true)}}else{if(!h.HasSubMenu()){if(h.Type!="Custom"&&h.Type!="Separator"){h.Click()}}}}break}},CloseSubMenu:function(a,d,b){var e=a.GetOpenSubMenu();if(e&&e!=d){if(b){e.SubMenu.Hide()}else{e.HideSubMenuQueue()}}},GetObjectType:function(a){if(!a){return""}if(a.tagName=="TD"){var b=a.parentElement;if(IS.GetAttr(b,"type")=="MenuItem"){return"MenuItem"}}else{if(a.tagName=="DIV"||((a.tagName=="FONT"||a.tagName=="IMG")&&a.parentElement.tagName=="DIV")){if(a.tagName=="FONT"||a.tagName=="IMG"){a=a.parentElement}if(a.id.indexOf("scroll_up")>-1){return"ScrollUp"}else{if(a.id.indexOf("scroll_down")>-1){return"ScrollDown"}}}else{if(a.tagName=="SPAN"){if(IS.GetAttr(a,"name")!=""){return"MenuItem"}else{var b=a.parentElement;if(b&&b.tagName=="SPAN"&&IS.GetAttr(b,"name")!=""){return"MenuItem"}}}else{if(a.tagName=="IMG"){var b=a.parentElement;if(b&&b.tagName=="SPAN"&&IS.GetAttr(b,"name")!=""){return"MenuItem"}}}}}return""},GetItemNameByElement:function(a){if(a.tagName=="TD"){return IS.GetAttr(a.parentElement,"name")}else{if(a.tagName=="TR"){return IS.GetAttr(a,"name")}else{if(a.tagName=="SPAN"){if(IS.GetAttr(a,"type")=="MenuItem"){return IS.GetAttr(a,"name")}else{return IS.GetAttr(a.parentElement,"name")}}else{if(a.tagName=="IMG"&&a.parentElement.tagName=="SPAN"&&IS.GetAttr(a.parentElement,"name")!=""){return IS.GetAttr(a.parentElement,"name")}}}}},GetTD:function(a){if(!a){return}while(a&&a.tagName!="TD"){a=a.parentElement}if(a&&a.tagName=="TD"){return a}else{return null}},GetSpan:function(a){if(!a){return}while(a&&a.tagName!="SPAN"){a=a.parentElement}if(a&&a.tagName=="SPAN"){return a}else{return null}},UnSelectMenuItem:function(g){var f=g.GetElement();var h=g.OwnerMenu;var a=h.MenuControl;var k=a.MenuStyleSettings;var e=k.ItemStyle;if(!g.Enabled){e=k.DisabledItemStyle}if(h.IconViewMode&&f.tagName=="SPAN"){WebMenuEngine.UnSelectMenuIconItem(g);return}for(var d=0;d<f.cells.length;d++){var b=f.cells[d];if(k.HighlightMode=="UseWebStyle"){DynamicStyleEngine.SetToStyle(null,e,b)}else{b.style.backgroundImage="none"}if(d==0){b.style.padding="1px";if((g.Type=="Radio"||g.Type=="CheckBox")&&g.Checked){if(k.HighlightMode=="UseWebStyle"){var j=b.children[0];DynamicStyleEngine.SetToStyle(null,k.CheckedItemStyle,j)}}}else{if(d==3){b.style.padding=k.ItemPadding+"px"}else{b.style.paddingTop=b.style.paddingBottom=k.ItemPadding+"px"}}}g.Selected=false;g.OwnerMenu.ActiveItemIndex=-1;g.OwnerMenu.ActiveItem=null},UnSelectMenuIconItem:function(e){var d=e.GetElement();var a=e.OwnerMenu.MenuControl;var f=e.OwnerMenu;var g=a.MenuStyleSettings;var b=g.ItemStyle;if(e.Type=="Normal"){}else{if(e.Type=="Radio"||e.Type=="CheckBox"){if(e.Checked){b=g.CheckedItemStyle}}}DynamicStyleEngine.SetToStyle(null,b,d);e.Selected=false;f.ActiveItemIndex=-1;f.ActiveItem=null},SelectMenuIconItem:function(e){var d=e.GetElement();var a=e.OwnerMenu.MenuControl;var f=e.OwnerMenu;var g=a.MenuStyleSettings;var b=g.ItemStyle;if(e.Type=="Normal"){}else{if(e.Type=="Radio"||e.Type=="CheckBox"){if(e.Checked){b=g.CheckedItemStyle}}}DynamicStyleEngine.SetToOverStyle(null,b,d);f.ActiveItemIndex=e.Index;f.ActiveItem=e;e.Selected=true;if(f.ParentMenuItem!=null&&!f.ParentMenuItem.IsSelected()){f.ParentMenuItem.Select(false)}},SelectMenuItem:function(mi){var menuItemEl=mi.GetElement();var c=mi.OwnerMenu.MenuControl;var owner=mi.OwnerMenu;var styles=c.MenuStyleSettings;var itemStyle=styles.ItemStyle;if(owner.ActiveItemIndex>-1){owner.ActiveItem.Unselect()}if(owner.IconViewMode&&menuItemEl.tagName=="SPAN"){WebMenuEngine.SelectMenuIconItem(mi);return}if(!mi.Enabled){itemStyle=styles.DisabledItemStyle}for(var i=0;i<menuItemEl.cells.length;i++){var cell=menuItemEl.cells[i];if(styles.HighlightMode=="UseWebStyle"){DynamicStyleEngine.SetToOverStyle(null,itemStyle,cell)}else{var imgKey=new Array("OverLeft","OverCenter","OverCenter","OverRight");cell.style.backgroundImage="url("+WebMenuEngine.GetImage(styles,imgKey[i],true)+")";cell.style.backgroundRepeat="repeat-x";if(i==3){cell.style.backgroundPosition="top right"}}var borderWidth=parseFloat(cell.currentStyle.borderWidth);if(!IS.ie){borderWidth=parseFloat(cell.currentStyle.borderTopWidth)}if(isNaN(borderWidth)){borderWidth=0}if(borderWidth>0){var overPadding=styles.ItemPadding-borderWidth;if(i==0){var overIcon=1-borderWidth;with(cell.style){paddingLeft=paddingTop=paddingBottom=(overIcon+"px")}if((mi.Type=="Radio"||mi.Type=="CheckBox")&&mi.Checked){var span0=cell.children[0];if(styles.HighlightMode=="UseWebStyle"){DynamicStyleEngine.SetToOverStyle(null,styles.CheckedItemStyle,span0)}}}else{if(i==3){with(cell.style){paddingRight=paddingTop=paddingBottom=(overPadding+"px")}}else{with(cell.style){paddingTop=paddingBottom=(overPadding+"px")}}}}}if(c&&c.GetType()=="WebContextMenu"&&c.ClientSideEvents!=null){ISEvent.Raise(c.ClientSideEvents.OnMenuItemSelect,c.Id,owner,mi,owner.ActiveItem)}owner.ActiveItemIndex=mi.Index;owner.ActiveItem=mi;mi.Selected=true;if(owner.ParentMenuItem!=null&&!owner.ParentMenuItem.IsSelected()){owner.ParentMenuItem.Select(false)}},RefreshDimension:function(d){if(d!=null&&d.MenuControl.MenuWindowType=="Normal"&&d.Popup){if(d.ScrollEnabled){var a=d.GetMenuBodyElement().parentElement;var c=d.GetScrollElement("up");var b=d.GetScrollElement("down");c.style.display="none";b.style.display="none";a.style.height="auto"}d.Popup._e.style.width="auto";d.Popup._e.style.height="auto";d.RuntimeWidth=d.Popup._e.scrollWidth;d.RuntimeHeight=d.Popup._e.scrollHeight}},CreatePopup:function(f,k){var h=f.MenuControl;if(f.Popup==null){if(!IS.ie||h.MenuWindowType=="Popup"){if(f.ParentMenu==null){f.Popup=window.createPopup()}else{f.Popup=f.ParentMenu.GetDocument().parentWindow.createPopup()}}else{var n=new WindowInfo();n.DisplayPosition="Bottom";n.DisplayType="Normal";n.OffsetControlID=h.Id;var o=new WindowPopup(n);n.Popup=o;o.Init();f.Popup=o;o.document.parentWindow=window;c=o.document}}if(IS.ie&&h.MenuWindowType=="Popup"){var l=IS.GetTempIFrame();var c=l.contentWindow.document;c.open("text/html","replace");c.write(k);c.close();f.RuntimeWidth=c.body.scrollWidth;f.RuntimeHeight=c.body.scrollHeight}var j=f.GetDocument();j.open("text/html","replace");j.write(k);j.close();if(IS.ie&&h.MenuWindowType=="Popup"){f.Element=j.body.firstChild}else{f.Element=j._e.firstChild;f.RuntimeHeight=f.Popup._e.scrollHeight;f.RuntimeWidth=f.Popup._e.scrollWidth}for(var e=0;e<f.Items.length;e++){var g=f.Items[e];if(g.Type=="Template"){var m=document.getElementById("mi_View"+g.Name);if(m){var b=g.GetContentElement();b.innerHTML="";b.appendChild(m);m.style.display="";m.style.visibility="inherit";m.style.position=""}}}if(h.UseCustomContent&&h.CustomContentElement!=null){var a=f.GetMenuContainerElement();a.appendChild(h.CustomContentElement)}},OnMenuClosed:function(c){var b=c.Owner;var a=b.ActiveItem;if(a!=null&&IS.moz&&a.KeepMenuVisible){return false}return true},IsOnSecondMonitor:function(){if(window.screenLeft>window.screen.width){return true}return false},ShowMenu:function(f,p,q,e){var h="";var j=true;var c=f.MenuControl;var m=0;var n=0;if(f){h=f.OffsetAlignment}if(f.IsOpen()&&!e){return}if(IS.ie&&f&&f.OffsetElement){var l=ISPosLib.getScreenLeft(f.OffsetElement)+ISPosLib.getWidth(f.OffsetElement);if(!WebMenuEngine.IsOnSecondMonitor()&&l>window.screen.availWidth-10&&h.indexOf("Right")>-1){h=h.replace(/Right/ig,"Left")}}if(f.OffsetElement){if(!IS.ie||c.MenuWindowType=="Popup"){m=ISPosLib.getScreenLeft(f.OffsetElement);n=ISPosLib.getScreenTop(f.OffsetElement)}else{m=ISPosLib.getLeft(f.OffsetElement);n=ISPosLib.getTop(f.OffsetElement)}}if(c.MenuWindowType=="Normal"){WebMenuEngine.RefreshDimension(f)}if(!p){if(f.OffsetElement){if(f.Direction=="Horizontal"){if(h.indexOf("Right")>-1){p=m+ISPosLib.getWidth(f.OffsetElement)}else{if(h.indexOf("Left")>-1){p=m-f.RuntimeWidth}}}else{if(h.indexOf("Left")>-1){p=m}else{if(h.indexOf("Right")>-1){p=m+ISPosLib.getWidth(f.OffsetElement)}}}}if(c.IsRightToLeft&&IS.ie){p=ISPosLib.getCalcRtlLeft(f.OffsetElement,p)}}if(!q){if(f.OffsetElement){if(f.Direction=="Horizontal"){if(h.indexOf("Top")>-1){q=n}else{q=n+ISPosLib.getHeight(f.OffsetElement)}}else{if(h.indexOf("Bottom")>-1){q=n+ISPosLib.getHeight(f.OffsetElement)}else{q=n-f.RuntimeHeight;if(q<0){q=0}}}}}if(f.ActiveItem!=null){f.ActiveItem.Unselect()}if(f.ParentMenuItem!=null){if(f.ParentMenuItem.QueueId>0){f.ParentMenuItem.QueueId=-1}}if(f._NeedSizeRecalc){WebMenuEngine.RecalcSize(f);f._NeedSizeRecalc=false}if(!IS.ie||c.MenuWindowType=="Normal"){if(!IS.ie){if(f.ParentMenu!=null){var i=f.ParentMenu.GetOpenSubMenu();if(i){i.SubMenu.Hide()}}}if((!IS.ie||!f.OffsetElement)&&!c.UseW3CPositioning){if(!f.OffsetElement){if(IS.IsXHTMLDocType()){p+=ISPosLib.getScrollLeft(document);q+=ISPosLib.getScrollTop(document)}else{p+=document.body.scrollLeft;q+=document.body.scrollTop}}}var d=WebMenuEngine.ApplyIntelligentPosition(new OffsetLocation(p,q),f.Popup._e.firstChild,f.ParentMenu,IS.ie&&c.MenuWindowType=="Normal",c);p=d.X;if(!c.DisableFullHeightScrolling){q=d.Y}}var k=WebMenuEngine.CheckForScrolling(f,p,q);if(k){p=k.X;q=k.Y;f.RuntimeHeight=k.Height}if(IS.ie&&IS.GetIEVersion()<7){var o=f.GetStripElement();if(o&&f.RuntimeHeight>4){o.style.height=f.RuntimeHeight-4}}if(f.IsRootMenu()){if(f._CloseIntervalId==-1){f._CloseIntervalId=setInterval(function(){WebMenuEngine.CheckForClose(f)},100)}}if(c&&c.GetType()=="WebContextMenu"){j=ISEvent.Raise(c.ClientSideEvents.OnShowMenu,c.Id,f,p,q,f.RuntimeWidth,f.RuntimeHeight)}if(j){if(typeof(j)=="object"){p=j.X;q=j.Y}var a=f.IsOpen();if(IS.ie&&IS.GetIEVersion()==7&&IS.IsXHTMLDocType()){f.Popup.IsJustShown=true;setTimeout(function(){f.Popup.IsJustShown=false},5)}f.Popup.show(p,q,f.RuntimeWidth,f.RuntimeHeight);if(IS.ie&&c.AutoFocusActiveItem&&c.MenuWindowType=="Normal"){f.SetActive()}if(c.MenuAnimation&&!c.SkipAnimation&&!a){if(c.AnimatedObj==null){var b=new ISAnimatedObject();b.OnCompleted=WebMenuEngine.OnAnimationCompleted;b.Speed=c.AnimationSpeed;b.Type=(c.MenuAnimationMode=="Fading"?"FadeIn":"MenuSlideDown");b.StepInterval=c.AnimationInterval;c.AnimatedObj=b}var g=f.Element;WebMenuEngine.RemoveFilter(f);if(c.MenuAnimationMode=="Sliding"){if(!f.IsRootMenu()){c.AnimatedObj.Type="MenuSlideRight"}else{c.AnimatedObj.Type="MenuSlideDown"}g=g.parentElement;g.removeAttribute("OriginalLeft");g.removeAttribute("OriginalWidth");g.removeAttribute("OriginalTop");g.removeAttribute("OriginalHeight");if(!IS.ie){g.OriginalTop=0;g.OriginalWidth=0;g.OriginalLeft=0;g.OriginalHeight=0}}c.AnimatedObj.Owner=f;c.AnimatedObj.Element=g;c.AnimatedObj.Play()}else{WebMenuEngine.ApplyDropShadow(c,f)}}},OnAnimationCompleted:function(){var a=this.Owner;WebMenuEngine.RemoveFilter(a);WebMenuEngine.ApplyDropShadow(a.MenuControl,a);this.IntervalId=-1},ApplyDropShadow:function(a,b){if(a.MenuDropShadow){if(IS.IsHTML5DocType()){b.Element.style.boxShadow="2px 2px 2px rgba(0,0,0,0.3)"}else{b.Element.style.filter="progid:DXImageTransform.Microsoft.Shadow(color=Gray,direction=135, strength=2)"}}},RemoveFilter:function(a){a.Element.style.filter=""},CheckForClose:function(b){if(!b.IsOpen()){clearInterval(b._CloseIntervalId);b._CloseIntervalId=-1;var a=b.MenuControl;if(a.OnRootMenuClosed!=null){if(typeof(a.OnRootMenuClosed)=="string"){ISEvent.Raise(a.OnRootMenuClosed,b)}else{if(typeof(a.OnRootMenuClosed)=="function"){a.OnRootMenuClosed(b)}}}}},CheckForScrolling:function(h,j,k){var a=window.screen.availHeight;var i=h.RuntimeHeight;var g=0;var c=h.MenuControl;if(!IS.ie||c.MenuWindowType=="Normal"){if(IS.IsXHTMLDocType()&&document.documentElement.clientHeight>0){a=document.documentElement.clientHeight-4}else{a=document.body.clientHeight}}if(c.DisableFullHeightScrolling){i+=(k-(!IS.ie?window.screenTop:0))}if(i>a&&!c.UseCustomContent){var d=h.GetMenuBodyElement().parentElement;var f=h.GetScrollElement("up");var e=h.GetScrollElement("down");f.style.display="";e.style.display="";if(IS.safari){a-=8}var b=a-f.style.posHeight-e.style.posHeight-8;if(c.DisableFullHeightScrolling){b-=(k-(!IS.ie?window.screenTop:0))}if(b<0){b=5}d.style.height=b+"px";g=a-4;if(c.DisableFullHeightScrolling){i=k;g-=(k-(!IS.ie?window.screenTop:0)-(IS.safari?8:0))}else{i=2}h.ScrollEnabled=true;if(c.MenuWindowType=="Normal"){i+=document.body.scrollTop}return new Rectangle(j,i,null,g)}else{if(h.ScrollEnabled&&c.MenuWindowType=="Normal"){var d=h.GetMenuBodyElement().parentElement;var f=h.GetScrollElement("up");var e=h.GetScrollElement("down");f.style.display="none";e.style.display="none";d.style.height="auto";g=d.offsetHeight;if(IS.IsXHTMLDocType()){g=h.Popup._e.offsetHeight+8}h.ScrollEnabled=false;return new Rectangle(j,k,null,g)}}},ApplyIntelligentPosition:function(e,b,h,c,a){var i=e.Y;var d=e.X;if(!IS.ie||c){if(!c){i-=ISPosLib.getWindowScreenTop();d-=ISPosLib.getWindowScreenLeft()}var f=document.body.clientHeight+ISPosLib.getScrollTop(document);var g=document.body.clientWidth;if(IS.IsXHTMLDocType()){if(document.documentElement.clientHeight>0){f=document.documentElement.clientHeight+ISPosLib.getScrollTop(document)}if(document.documentElement.clientWidth>0){g=document.documentElement.clientWidth}}if(i+ISPosLib.getHeight(b)>f){i=((f)-ISPosLib.getHeight(b));if(c){i-=4}}if(d+(ISPosLib.getWidth(b))>g){if(!h){d=g-ISPosLib.getWidth(b)}else{d=ISPosLib.getLeft(h.Popup._e.firstChild)-ISPosLib.getWidth(b)}if(c){d-=4}}if(!c){i+=ISPosLib.getWindowScreenTop();d+=ISPosLib.getWindowScreenLeft()}else{if(i<0){i=2}}}return new OffsetLocation(d,i)},GetDocHeader:function(b){var a='<html><head><style type="text/css">'+b.MenuControl.GetStyleString()+"</style></head><body style='margin:0px;padding:0px;overflow:hidden;border:0px'>";if(IS.ie&&b.MenuControl.MenuWindowType=="Popup"){return a}else{return""}},GetDocFooter:function(b){var a="</body></html>";if(IS.ie&&b.MenuControl.MenuWindowType=="Popup"){return a}else{return""}},GetStyleString:function(b,e){if((b.GetType()=="WebContextMenu"&&b.IntegratedToBar)&&!e){var c;if(b.GetType()=="WebContextMenu"){c=b._MenuCommand!=null?b._MenuCommand._Bar:(b._ToolCommand!=null?b._ToolCommand._Bar:null)}if(c!=null){return c.GetCachedMenuStyleString(b)}else{if(b!=null){return b.GetCachedMenuStyleString(b)}}}var j=b.MenuStyleSettings;var a=new Array("ItemStyle","FrameStyle","DisabledItemStyle","SeparatorStyle","CheckedItemStyle","CustomStyle");var g="";for(var f=0;f<a.length;f++){var h=a[f];if(typeof(j[h])=="string"){if(j[h]!=""){g+=WebMenuEngine.GetCssStyleString(j[h])}}else{if(typeof(j[h])=="object"){var d=j[h];if(d.Normal!=""){g+=WebMenuEngine.GetCssStyleString(d.Normal)}if(d.Over!=""){g+=WebMenuEngine.GetCssStyleString(d.Over)}if(d.Active!=""){g+=WebMenuEngine.GetCssStyleString(d.Active)}}}}return g},GetCssStyleString:function(a){return IS.GetStyleText(null,a)},GetImage:function(d,c,b){var a=d;if(b){a=d.ImagesSettings}if(d.UseSmartWebResources){return"ISRes.axd?D/"+a[c]}else{return a[c]}},GetSymbol:function(d,c,a){if(IS.ie||(IS.moz&&!IsGecko30())){if(a){return c}else{return"<font face='Webdings' style='font-size: 8pt'>"+c+"</font>"}}else{var b="";if(c=="6"){b="arrow_down.gif"}else{if(c=="="){b="radio.gif"}else{if(c=="a"){b="checkbox.gif"}else{if(c=="4"){b="arrow_right.gif"}else{if(c=="5"){b="arrow_up.gif"}}}}}if(d.UseSmartWebResources){b="ISRes.axd?D/"+b}else{b=d.Parent.ImagesDirectory+b}return"<img valign='absmiddle' style='vertical-align: middle' height='16' src='"+b+" ' />"}},RenderMenu:function(d){var e=d.MenuControl;var g=e.MenuStyleSettings;var f="<table class='"+g.FrameStyle+"' border='0' cellpadding='1' cellspacing='0' style='position: relative;'>";f+="<tr>";f+="<td valign='top'>";f+="<div id='"+d.GetId()+"_container' style='position: relative;";if(d.IconViewMode){f+="width:"+d.Width+";"}f+="'>";if(e.GetType()=="WebContextMenu"&&e.UseCustomContent){f+="</div></td></tr></table>";return f}if(g.HasBackgroundStrip&&!d.IconViewMode){f+="<div id='"+d.GetId()+"_strip' style='position: absolute; left: 0px; top: 0px;";f+="width: "+g.BackgroundStripWidth+"px";if(IS.ie){if(IS.IsXHTMLDocType()){f+="; height: 100%"}else{if(IS.GetIEVersion()<7){f+=";height:auto"}else{f+=";height:expression(this.parentElement.offsetHeight)"}}}else{f+=";height:100%"}if(g.BackgroundStripColor2==""||g.BackgroundStripColor2=="000000"){f+=";background-color:#"+g.BackgroundStripColor}else{if(IS.ie){if(IS.ie10||IS.ie11){f+=";background-image:linear-gradient(to right,#"+g.BackgroundStripColor+" 0%,#"+g.BackgroundStripColor2+" 100%)"}else{f+=";filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#FF"+g.BackgroundStripColor+", endColorstr=#FF"+g.BackgroundStripColor2+", GradientType=1)"}}else{f+=";background-color:#"+g.BackgroundStripColor2}}if(g.BackgroundStripImage!=""){f+=";background-image: url("+WebMenuEngine.GetImage(g,"BackgroundStripImage")+"); background-repeat: repeat-y"}f+="'";if(g.BackgroundStripStyle!=""){f+=" class='"+g.BackgroundStripStyle+"'"}f+=">";f+="</div>"}f+="<div id='"+d.GetId()+"_scroll_up' align='center' disabled style='height:18px;position:relative;display:none;cursor:default'>";f+=WebMenuEngine.GetSymbol(g,"5");f+="</div>";f+="<div style='position: relative; overflow: hidden;'>";f+="<table id='"+d.GetId()+"_body' border='0' cellpadding='0' cellspacing='0' style='cursor:default; width:100%'>";if(d.IconViewMode){var b=d.GetGroupItems();for(var c=0;c<b.length;c++){var a=b[c];if(a.constructor==Array){f+=WebMenuEngine.RenderGroupItem(a)}else{f+=WebMenuEngine.RenderMenuItem(a)}}}else{for(var c=0;c<d.Items.length;c++){f+=WebMenuEngine.RenderMenuItem(d.Items[c])}}f+="</table>";f+="</div>";f+="<div id='"+d.GetId()+"_scroll_down' align=center style='height:18px;position:relative;display:none;cursor:default'>";f+=WebMenuEngine.GetSymbol(g,"6");f+="</div>";f+="</div>";f+="</td></tr></table>";return WebMenuEngine.GetDocHeader(d)+f+WebMenuEngine.GetDocFooter(d)},RenderGroupItem:function(b){var d=b[0].OwnerMenu;var a=d.MenuControl;var g=a.MenuStyleSettings;var f="<tr type='GroupItem'>";f+="<td>";f+="</td>";f+="<td colspan=3 width='"+d.Width+"'>";for(var c=0;c<b.length;c++){var e=b[c];f+=WebMenuEngine.RenderIconViewItem(e)}f+="</td>";f+="</tr>";return f},RenderIconViewItem:function(c){var d="<span type='MenuItem' name='"+c.Name+"' ";var b=c.OwnerMenu;var a=b.MenuControl;var e=a.MenuStyleSettings;if((c.Type=="Radio"||c.Type=="CheckBox")&&c.Checked){d+="class='"+e.CheckedItemStyle.Normal+"'"}if(c.Tooltip!=""){d+=" title='"+c.Tooltip+"'"}d+=" style='width:"+(a.ImageSize.Width+4)+"px; height:"+(a.ImageSize.Width+4)+"px;text-align:center;padding-top:1px;margin-top:2px;margin-right:2px;";if(IS.moz){d+="display:-moz-inline-box;"}else{if(!IS.ie){d+="display:block;"}}d+="'>";if((c.Type=="Radio"||c.Type=="CheckBox")&&c.ImageURL==""){c.UseFontImage=true}if(c.UseFontImage){d+="<span>";var f="";if(c.Type=="Radio"&&c.Checked){f="="}else{if(c.Type=="CheckBox"&&c.Checked){f="a"}else{d+="<font face=Webdings style='font-size: 8pt'>"+c.ImageURL+"</font>"}}if(f!=""){d+=WebMenuEngine.GetSymbol(e,f)}d+="</span>"}else{d+="<img align='absmiddle' width="+a.ImageSize.Width+" height="+a.ImageSize.Height+" ";if(c.ImageURL!=""){d+="src='"+c.ImageURL+"' ";if(!c.Enabled){d+="style='filter:Alpha(Opacity=50), Gray()'"}}else{d+="style='visibility: hidden'"}d+="/>"}if(c.HasSubMenu()){d+="<span>"+WebMenuEngine.GetSymbol(e,"6")+"</span>"}d+="</span>";return d},RenderMenuItem:function(e){var d=e.OwnerMenu;var a=d.MenuControl;var g=a.MenuStyleSettings;var f="";var c=g.ItemStyle.Normal;f+="<tr type='MenuItem' name='"+e.Name+"'";if(e.Tooltip!=""){f+=" title='"+e.Tooltip+"'"}if(!e.Visible){f+=" style='display: none'"}f+=">";if(!e.Enabled){c=g.DisabledItemStyle.Normal}if(e.Type=="Separator"){f+="<td></td>"}else{if(e.OwnerMenu.IconViewMode){f+="<td class='"+c+"' width=1 style='border-right-style: none; padding: 1px'><img style='visibility:hidden; width:1px; height:"+(a.ImageSize.Height+4)+"' /></td>"}else{if(e.Type=="Custom"){f+="<td class='"+g.CustomStyle+"' colSpan=4>";if(e.ImageURL!=""){f+="<img align='absmiddle' ";f+="src='"+e.ImageURL+"' ";f+="/> &nbsp;"}f+=e.Text+"</td>";return f+"</tr>"}else{f+="<td valign=absmiddle class='"+c+"' style='border-right-style: none; padding: 1px' ";if(!e.Enabled){f+="disabled "}f+=">";f+="<span ";if((e.Type=="Radio"||e.Type=="CheckBox")&&e.Checked){f+="class='"+(g.HighlightMode=="UseWebStyle"?g.CheckedItemStyle.Normal:"")+"'"}f+=" style='width:"+(g.IconCellWidth)+"px; height:"+(parseFloat(a.ImageSize.Width)+4)+"px; text-align:center; padding-top:1px; display:block;";if((e.Type=="Radio"||e.Type=="CheckBox")&&e.Checked&&g.HighlightMode=="UseComplexImages"){f+="background-image: url("+WebMenuEngine.GetImage(g,"ActiveIconCell",true)+");background-repeat: no-repeat; background-position: top left; margin-top: -1px; height: 22px;";if(IS.ie){f+="padding-top: 3px; padding-right: 3px"}}if(IS.moz){if(IsGecko30()){f+="display: inline-block;"}else{f+="display:-moz-inline-block;"}}else{if(IS.safari||IS.opera){f+="display:block;"}}f+="'>";if((e.Type=="Radio"||e.Type=="CheckBox")&&e.ImageURL==""){e.UseFontImage=true}if(e.UseFontImage){f+="<span>";var h="";if(e.Type=="Radio"&&e.Checked){h="="}else{if(e.Type=="CheckBox"&&e.Checked){h="a"}else{f+="<font face=Webdings style='font-size: 8pt'>"+e.ImageURL+"</font>"}}if(h!=""){f+=WebMenuEngine.GetSymbol(g,h)}f+="</span>"}else{var b="";if(a.DrawImageBackground){b="; background-color: "+g.BackgroundStripColor}f+="<img align='absmiddle' width="+a.ImageSize.Width+" height="+a.ImageSize.Height+" ";if(e.ImageURL!=""){f+="src='"+e.ImageURL+"' ";if(!e.Enabled){f+="style='filter:"+(a.SkipAlpha?"":"Alpha(Opacity=50),")+" Gray()"+b+"'"}}else{f+="style='visibility: hidden'"}f+="/>"}f+="</span>";f+="</td>"}}}if(e.Type=="Separator"){f+="<td colSpan=3 noWrap style='padding-left:2px; padding-bottom:0px;padding-right:0px;padding-top:2px'><div ";if(g.SeparatorStyle!=""){f+="class='"+g.SeparatorStyle+"' style='width:100%; font-size:0.01em;' "}else{f+="style='height:1px; width:100%; font-size:0.01em; border-top: gray 1px solid' "}f+="></div></td>"}else{f+="<td"+(e.Type=="Template"?"":" nowrap")+" class='"+c+"' style='border-left-style: none; padding-top: "+g.ItemPadding+"px; padding-bottom: "+g.ItemPadding+"px;";f+="border-right-style: none; padding-left: "+g.ContentPadding+"px; padding-right: "+g.ContentPadding+"px' ";if(!e.Enabled){f+="disabled "}if(e.Tooltip!=""){f+="title='"+e.Tooltip+"' "}f+=">";f+=WebMenuEngine.RenderText(e);f+="</td>";f+="<td align=right class='"+c+"' style='border-left-style: none; border-right-style: none; padding:"+g.ItemPadding+"px; padding-left:"+(g.ContentPadding+2)+"px' ";if(!e.Enabled){f+="disabled "}f+=">";f+=e.Shortcut.IsEmpty()?"&nbsp;":e.Shortcut.GetString();f+="</td>";f+="<td class='"+c+"' style='border-left-style: none; padding:"+g.ItemPadding+"px'>";if(e.SubMenu.Items.length>0){f+=WebMenuEngine.GetSymbol(g,d.IconViewMode?"6":"4")}else{f+="&nbsp;"}f+="</td>"}f+="</tr>";return f},RenderText:function(b){var d=b.Text;if(d==""){d="&nbsp;"}else{if(b.AccessKey!=""){var e=d.toLowerCase();var a=b.AccessKey.toLowerCase();if(e.indexOf(a)>-1){var c=e.indexOf(a);d=d.substring(0,c)+"<u>"+d.substring(c,c+1)+"</u>"+d.substring(c+1)}}}return d},ClickItem:function(b){var e=true;var a=b.OwnerMenu.MenuControl;if(!b.Enabled||a.ClassName==null){return false}if(b.Type=="CheckBox"){b.SetChecked(!b.Checked)}else{if(b.Type=="Radio"){b.SetChecked(true)}}if(b.OnClick!=null){if(typeof(b.OnClick)=="string"){e=ISEvent.Raise(b.OnClick,b)}else{if(typeof(b.OnClick)=="function"){e=b.OnClick(b)}}if(typeof(e)=="undefined"){e=true}if(!b.KeepMenuVisible){if(a.HideAll){a.HideAll()}else{if(!e){return}}}}if(e&&a.GetType()=="WebContextMenu"){e=ISEvent.Raise(a.ClientSideEvents.OnMenuItemClick,a.Id,b);if(a.ClientSideEvents.OnMenuItemClick!=""&&e){if(!b.KeepMenuVisible){if(a.HideAll){a.HideAll()}else{return}}}}if(e&&b.TargetURL!=""){if(b.TargetFrame==""){document.location.href=b.TargetURL}else{var f=b.TargetFrame;if(f=="Blank"||f=="Parent"||f=="Search"||f=="Self"||f=="Top"||f=="UseBase"){f="_"+f.toLowerCase()}window.open(b.TargetURL,f)}if(!b.KeepMenuVisible){b.OwnerMenu.MenuControl.HideAll()}}if((e||typeof(e)=="undefined")&&a.GetType()=="WebContextMenu"&&!a.IntegratedToBar){var d=b.AutoPostBack;if(d=="Default"){d=a.AutoPostBack}if(d=="Yes"){a.HideAll();__doPostBack(a.ServerUniqueID,"ItemClick:"+WebMenuEngine.GetSelectedMenuItemHierarchy(b))}}},GetSelectedMenuItemHierarchy:function(c){var a="";var b=c;while(b.Parent!=null&&b._Type=="WebMenuItem"){a=b.Name+";"+a;b=b.Parent}return a},OnUnload:function(c){if(c==null||c==window){c=this}var b=c.Element;if(!b){return}var a=c.GetDocument();if(!a||c.Popup==null){return}var e=c.GetContentWindow();Listener.Unload(b);Listener.Unload(a);Listener.Unload(e);Listener.Unload(window);if(c.Popup){a.open("text/plain","replace");a.write("");a.close()}c.Popup=null},ScrollMenu:function(c,a){var b=c.GetMenuBodyElement().parentElement;if(a=="down"){b.scrollTop+=20}else{b.scrollTop-=20}WebMenuEngine.FixScrollState(c)},FixScrollState:function(b){var a=b.GetMenuBodyElement().parentElement;if(a.scrollTop==0){b.GetScrollElement("up").disabled=true}else{b.GetScrollElement("up").disabled=false}if(a.scrollHeight-a.clientHeight<=a.scrollTop){b.GetScrollElement("down").disabled=true}else{b.GetScrollElement("down").disabled=false}},ClearMenu:function(b){for(var a=0;a<b.Items.length;a++){var c=b.Items[a];if(c.HasSubMenu()){WebMenuEngine.ClearMenu(c.SubMenu);ISDeleteObject(c.SubMenu)}}WebMenuEngine.OnUnload(b);b.Items=null;b.Items=new ISArray();b.Items.Parent=b;b.ActiveItem=b.Element=null;b.ActiveItemIndex=-1;b.Initialized=false},RecalcSize:function(b){if(IS.ie&&b.MenuControl.MenuWindowType=="Popup"){var e=IS.GetTempIFrame();var a=e.contentWindow.document;var c=b.GetDocument().body.parentElement.outerHTML;a.open("text/html","replace");a.write(c);a.close();b.RuntimeWidth=a.body.scrollWidth;b.RuntimeHeight=a.body.scrollHeight}},AddMenuItem:function(e){var b=e.OwnerMenu;var g=null;var f="";var c=b.GetMenuBodyElement();var a=b.GetDocument();if(!b._TempDiv){b._TempDiv=a.createElement("DIV")}g=b._TempDiv;if(b.IconViewMode&&e.IsUsingImageIconViewMode()){f=WebMenuEngine.RenderIconViewItem(e)}else{f=WebMenuEngine.RenderMenuItem(e)}g.innerHTML="<table>"+f+"</table>";el=g.children[0].rows[0];c.tBodies[0].appendChild(el);b._NeedSizeRecalc=true;return el},InsertMenuItem:function(b,c){var a=WebMenuEngine.AddMenuItem(b);var e=b.OwnerMenu.Items[c];b.Element=a;if(e!=null){var d=e.GetElement();if(d!=null&&a!=null){var f=a.parentElement.parentElement;f.moveRow(a.rowIndex,d.rowIndex)}}},RemoveMenuItem:function(c){var a=c.OwnerMenu;var b=c.GetElement();if(b){b.removeNode(true)}if(c.HasSubMenu()&&c.SubMenu.Popup!=null){c.SubMenu.Destroy()}a._NeedSizeRecalc=true},ReassignParent:function(a,e){var d=null;if(e.GetType()=="WebContextMenu"){d=e.RootMenu}else{if(e.GetType()=="WebMenuItem"){d=e.SubMenu}else{if(e.GetType()=="WebMenu"){d=e}}}for(var b=0;b<a.length;b++){var c=a[b];c.OwnerMenu=d;c.Collection=d.Items;c.Index=b;if(c.Items.length>0){WebMenuEngine.ReassignParent(c.Items,c)}}}};if(typeof(RegisterKeyboardHandler)=="function"){RegisterKeyboardHandler()}if(typeof(Sys)!="undefined"){Sys.Application.notifyScriptLoaded()};