var _nextId=0;var _sdl=new Array();var _mProg=null;var _st=new Array();var _fVBon=false;var xsi99="http://www.w3.org/1999/XMLSchema-instance";var xsi01="http://www.w3.org/2001/XMLSchema-instance";var xsd01="http://www.w3.org/2001/XMLSchema";var xsd99="http://www.w3.org/1999/XMLSchema";_st["int"]=0;_st.integer=0;_st["float"]=0;_st["double"]=0;_st["byte"]=0;_st.decimal=0;_st["long"]=0;_st["short"]=0;_st.unsignedByte=0;_st.unsignedInt=0;_st.unsignedShort=0;_st.unsignedLong=0;_st["boolean"]=0;_st.negativeInteger=0;_st["enum"]=1;_st.QName=1;_st.string=2;_st.timeInstant=3;_st.dateTime=3;_st.date=4;_st.time=5;_st.base64=6;var _b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ErrDetail(a,c,b){this.code=a;this.string=c;this.raw=b}var _errInvalArg=new ErrDetail("Client","Invalid argument",null);var _errNotReady=new ErrDetail("Client","Service unavailable",null);var _errInvalRes=new ErrDetail("Server","Invalid response",null);var _errUnsupFun=new ErrDetail("Client","Unsupported function",null);var _errUnknownS=new ErrDetail("Server","Unknown server error",null);var _errAcDenied=new ErrDetail("Server","Permission denied",null);var _errSoapUnav=new ErrDetail("Client","Soap not available",null);var _errHtcInter=new ErrDetail("Client","HTC internal error",null);var _errInvaPort=new ErrDetail("Client","Invalid active port",null);var _errInvaHead=new ErrDetail("Client","Invalid headers",null);var _aryError=new Array(_errInvalArg,_errNotReady,_errInvalRes,_errUnsupFun,_errUnknownS,_errAcDenied,_errSoapUnav,_errHtcInter,_errInvaPort,_errInvaHead);var WebServiceEngine={OnResult:null,OnServiceAvailable:null,Initialize:function(a){},_OnResult:function(){var b=arguments[0];var a=WebServiceEngine._GetResultedWebServiceFlyPostBackManager(b.id);if(a!=null){if(b.error==false){a.OnResponse(b)}else{a.OnResponseError(b)}}},_GetResultedWebServiceFlyPostBackManager:function(d){var e=WebServiceEngine._GetWebServiceFlyPostBackManagers();var a,c=false;for(var b=0;b<e.length;b++){a=e[b];for(key in a._MethodsData){if(a._MethodsData[key].Id==d){c=true;break}if(c){break}}if(c){break}a=null}if(!c){a=null}return a},_GetWebServiceFlyPostBackManagers:function(){var a=new Array();var b;for(key in IS.RuntimeObjects){b=IS.RuntimeObjects[key];if(b.GetType()=="WebFlyPostBackManager"){if(b.ServiceType=="WebService"){a[a.length]=b}}}return a},_GetMethodNameById:function(a,b){var c;for(key in a._MethodsData){if(a._MethodsData[key].Id==b){c=key;break}}return c},_GetMethodNameByResultObject:function(a,b){return WebServiceEngine._GetMethodNameById(a,b.id)},Invoke:function(a,b,c){if(a.Asynchronous){WebServiceEngine._InvokeAsynchronous(a,b,c)}else{return WebServiceEngine._InvokeSynchronous(a,b,c)}},_CreateCallOptionsForInvoke:function(b,c,d){var a=WebServiceEngine.CreateCallOptions();a.async=b.Asynchronous;a.WebFlyPostBackManagerId=b.Id;a.params=d;a.funcName=c;a.SOAPHeader=new Array();a.SOAPHeader[0]=new Object();return a},_GetServiceById:function(a){var b;for(s in WebServiceEngine){if(s==a){b=WebServiceEngine[s];break}}return b},_InvokeAsynchronous:function(b,c,d){var a=WebServiceEngine._CreateCallOptionsForInvoke(b,c,d);var e=WebServiceEngine._GetServiceById(b.Id);b._MethodsData[c].Id=e.CallService(WebServiceEngine._OnResult,a)},_InvokeSynchronous:function(b,c,d){var a=WebServiceEngine._CreateCallOptionsForInvoke(b,c,d);var f=WebServiceEngine._GetServiceById(b.Id);var e=f.CallService(WebServiceEngine._OnResult,a);b._MethodsData[c].Id=e.id;if(!e.error){b.OnResponse(e);if(b.Asynchronous==false&&e.ADOData!=null){return e.ADOData}return e.value}else{b.OnResponseError(e);return null}},OnResponse:function(a,b){if(a.ClientSideEvents!=null){return ISEvent.Raise(a.ClientSideEvents.OnResponse,a.Id,b)}else{return true}},OnResponseSuccess:function(a,c,b){var d=c.value;if(typeof(ISADONETMappingEngine)!="undefined"&&ISADONETMappingEngine.IsADONETXmlData(d)){d=ISADONETMappingEngine.GetXMLWithNamespaces(d);d=ISADONETMappingEngine.MappingToObject(d);if(a.Asynchronous==false){c.ADOData=d}}else{d=c.value}return a._RaiseOnResponseSuccessEvent(b,d)},OnResponseError:function(b,d,c){var a=typeof(d.errorDetail)=="object"?d.errorDetail:d;if(b.ClientSideEvents!=null){return ISEvent.Raise(b.ClientSideEvents.OnError,b.Id,c,a.string,a)}else{return true}},_OnServiceAvailable:function(){var b=arguments[0];var a=this;if(a.FullServiceURL==b.serviceUrl){if(b.serviceAvailable){a._OnMetadataRetrieved(arguments[1]);_sdl[arguments[0].serviceUrl].Metadata=arguments[1]}else{a.OnResponseError("WebServiceOnMetadataRetrieved",arguments[1])}}},RetrieveMetadata:function(b,d){Listener.Add(WebServiceEngine,"OnServiceAvailable",WebServiceEngine._OnServiceAvailable,b);var c=WebServiceEngine.BuildServiceUrl(b.ServiceUrl+"?WSDL");b.FullServiceURL=c;var a=WebServiceEngine.UseService(c,b.Id,null,b.Asynchronous,d);if(a!=null){b._OnMetadataRetrieved(a.Metadata)}},ClearMetadata:function(b){var g=b.Metadata;if(g!=null){var a=ISXml.GetNode(g,"wsdl:binding");if(a==null){return}var f=ISXml.GetNodes(a,"wsdl:operation");if(f==null){return}var e,d;for(var c=0;c<f.length;c++){e=f[c];if(e.nodeType!=1){continue}d=ISXml.GetAttribute(e,"name");b.DeleteMethod(d)}b.MetadataCollected=false}},MappingMetadata:function(b){var g=b.Metadata;if(g!=null){var a=g.selectSingleNode("wsdl:binding");if(a==null){return}var f=a.selectNodes("wsdl:operation");if(f==null){return}var e,d;for(var c=0;c<f.length;c++){e=f[c];if(e.nodeType!=1){continue}d=ISXml.GetAttribute(e,"name");b.CreateNewMethod(d)}b.MetadataCollecting=false;b.MetadataCollected=true}},_RegisterXmlHttpForCallMethod:function(d,c,e){var a=ISGetObject(d);if(a!=null){if(WebFlyPostBackManagerEngine.IsMethodExist(a,c)){var b=a._MethodsData[c].XmlHttp=e}}},OnUnload:function(a){Listener.Remove(WebServiceEngine,"OnServiceAvailable",WebServiceEngine._OnServiceAvailable);for(s in WebServiceEngine){if(typeof(WebServiceEngine[s])=="object"){WebServiceEngine[s]=null}}},UseService:function(e,h,c,a,i){if(e==null||e.length==0||h==null||h.length==0){throw ("Invalid arguments");return}var g=e;var b=WebServiceEngine.GetAttribute(h);if(b==null){WebServiceEngine[h]=new Object()}WebServiceEngine[h].CallService=function(){return WebServiceEngine.CallService(g,arguments)};if(_sdl[g]!=null&&_sdl[g].Metadata!=null){return _sdl[g]}var d;if(IS.ie){if(IS.ie10){d=ISXml.CreateXmlDocument()}else{d=document.createElement("XML");document.body.appendChild(d)}}else{if(IS.moz||IS.chrome){d=new MozillaXMLElement()}else{if(IS.opera){d=ISXml.CreateXmlDocument()}}}oS=new Object();oS.sXmlHttp=null;oS.aXmlHttp=null;oS.fPending=true;oS.nextCall=null;oS.lastCall=null;oS.url=g;if(c!=null){oS.fSeq=c.reuseConnection;oS.SOAPHeader=c.SOAPHeader}if(oS.fSeq==null){oS.fSeq=false}oS.fEscString=true;WebServiceEngine[h].setEscapeString=function(j){oS.fEscString=j};oS._oXml=d;_sdl[g]=oS;oS.userName=h;if(i==null){if(a==false){var f;if(IS.ie){f=new ActiveXObject("Microsoft.XMLHTTP")}else{f=new XMLHttpRequest()}f.open("GET",g,false);f.send();oS._oXml.loadXML(f.responseXML.xml);WebServiceEngine.GetSdl()}else{d.onreadystatechange=WebServiceEngine.GetSdl;d.load(g)}}else{oS._oXml.loadXML(i.xml);WebServiceEngine.GetSdl()}return},BuildServiceUrl:function(g){if(g.indexOf("://")>0||g.substring(0,1)!="."){return g}var a=document.URL;a=a.substr(0,a.lastIndexOf("/"));var f=g.split("/");var d=false;var e=g;var c=0;for(var b=0;b<f.length;b++){c=b;switch(f[b]){case"..":a=a.substr(0,a.lastIndexOf("/"));break;case".":d=true;break;case"":case"~":a=a.substr(7);if(a.indexOf("/")>-1){a=a.substr(0,a.indexOf("/"))}a="http://"+a;d=true;break;default:d=true;c--;break}if(d){break}}c++;for(var b=c;b<f.length;b++){a+="/"+f[b]}if(a.indexOf(".")<0){a+=a+".asmx?wsdl"}return a},GetAttribute:function(b){var a;for(var c in WebServiceEngine){if(c==b){a=WebServiceEngine[b];break}}return a},CallService:function(j,a){var g=WebServiceEngine.AllocCall();if(a.length<1){return WebServiceEngine.PostError(g,0)}var b=null;var e=0;if(typeof a[0]=="function"||typeof a[0]=="object"&&a[0].funcName==null){e=1;b=a[0]}var c,f;f=a;if(typeof a[e]=="string"){c=WebServiceEngine.CreateCallOptions(a[e])}else{c=WebServiceEngine.CloneObject(a[e]);f=new Array();for(var d=0;d<a.length;d++){f[f.length]=a[d]}for(var d=0;d<c.params.length;d++){f[f.length]=c.params[d]}}g.co=c;g.cb=b;g.service=j;g.args=f;if(c.async==null){c.async=true}if(c.funcName==null){return WebServiceEngine.PostError(g,0)}var h=_sdl[j];if(h==null){return WebServiceEngine.PostError(g,1)}if(c.async==false){return h.fPending?WebServiceEngine.ReturnError(g,1):WebServiceEngine._Invoke(g)}if(h.fSeq||h.fPending){if(h.lastCall!=null){h.lastCall.next=g}else{h.nextCall=g}h.lastCall=g}if(h.fPending){return g.id}if(!h.fSeq){WebServiceEngine._Invoke(g)}else{if(g==h.nextCall){WebServiceEngine.CallNext(h)}}return g.id},CreateCallOptions:function(b,e,a,g,h,f,c){var d=new Object();d.funcName=b;d.portName=e;d.async=a;d.timeout=g;d.userName=h;d.password=f;d.SOAPHeader=c;return d},CloneObject:function(a){var b=new Object();for(var c in a){b[c]=a[c]}return b},GetElementNodes:function(d){var a=new Array();var c;for(var b=0;b<d.childNodes.length;b++){c=d.childNodes[b];if(c.nodeType==1){a[a.length]=c}}return a},GetElementNode:function(d,b){var c;var f;var e=-1;for(var a=0;a<d.childNodes.length;a++){f=d.childNodes[a];if(f.nodeType==1){e++;if(e==b){c=f;break}}}return c},_Invoke:function(u,z){var H=u.service;var x=_sdl[H];var f=u.co;var I=null;if(x==null){return WebServiceEngine.PostError(u,1)}if(f.portName==null){f.portName=x.defPortName}if(x.soapPort[f.portName]==null){WebServiceEngine.CallNext(x);return WebServiceEngine.ReturnError(u,8)}I=WebServiceEngine.EnsureXmlHttp(f.async,x);if(I==null){WebServiceEngine.CallNext(x);return WebServiceEngine.ReturnError(u,6)}var a=u.args;var d=u.cb;var o=d==null?1:2;var v=WebServiceEngine.GetMsg(H,f,a,o);var F=null;if(v!=null){F=WebServiceEngine.EncodeArgs(v,H,a,o)}if(F==null){WebServiceEngine.CallNext(x);return WebServiceEngine.ReturnError(u,0)}u.fRpc=v.fRpc;u.fLiteral=v.fLiteral;u.response=v.response;var w=x.soapPort[f.portName];var h=null;var A=null;if(typeof(z)=="undefined"){z="Soap"}if(typeof(f.WebFlyPostBackManagerId)=="string"){h=ISGetObject(f.WebFlyPostBackManagerId);z=h.WebServiceResponseFormat;if(f.async){WebServiceEngine._RegisterXmlHttpForCallMethod(f.WebFlyPostBackManagerId,f.funcName,I)}}try{if(z=="Soap"){A=w.location}else{if(z=="Json"){A=w.location+"/"+f.funcName}}if(f.userName==null){I.open("POST",A,f.async)}else{I.open("POST",A,f.async,f.userName,f.password==null?"":f.password)}}catch(g){return WebServiceEngine.ReturnError(u,5)}var G="";if(z=="Soap"){var E=v.soapAction;var C="";if(E!=null&&E.length>0){I.setRequestHeader("SOAPAction",'"'+E+'"')}I.setRequestHeader("Content-Type","text/xml");for(var t in x.ns){C+=" xmlns"+(t==""?"":":")+t+'="'+x.ns[t]+'"'}szHeader="";var B=f.SOAPHeader==null?x.SOAPHeader:f.SOAPHeader;var m=(v.headers==null)?x.headers:v.headers;if(B!=null){fEncoded=false;if(typeof B=="string"){szHeader=B}else{if(typeof B!="object"){szHeader=""}else{if(B.xml!=null){szHeader=B.xml}else{if(m.length!=0){if(B.length==null){var l=m[0].type;if(l.elem!=null){l=WebServiceEngine.GetSchema(x,l).elems[l.elem]}szHeader=WebServiceEngine.EncodeVar(x,true,B,l)}else{for(var n=0;n<m.length;n++){if(B[n]==null){if(m[n].fRequired){return WebServiceEngine.ReturnError(u,9)}continue}var l=m[n].type;if(l.elem!=null){l=WebServiceEngine.GetSchema(x,l).elems[l.elem]}szHeader+=WebServiceEngine.EncodeVar(x,true,B[n],l)}}fEncoded=!m[0].fLiteral}}}}szHeader='<SOAP-ENV:Header xmlns="'+(fEncoded?"":x.targetns)+'">\n'+szHeader+"\n</SOAP-ENV:Header>\n"}G="<?xml version='1.0'?>\n<SOAP-ENV:Envelope SOAP-ENV:encodingStyle=\""+v.es+'" '+C+">\n"+szHeader+"<SOAP-ENV:Body>"+F+"\n</SOAP-ENV:Body>\n</SOAP-ENV:Envelope>\n"}else{if(z=="Json"){I.setRequestHeader("Content-Type","application/json");I.setRequestHeader("Accept","application/json");if(f.params!=null&&f.params.length>0){var c=new Object();var b=WebServiceEngine.GetParameterNames(v,H);for(var q=0;q<f.params.length;q++){c[b[q]]=f.params[q]}G=ISJsonEngine.Serialize(c)}}}if(f.async){u.oXmlHttp=I;I.onreadystatechange=function(){WebServiceEngine.GetResult(u)};try{I.send(G)}catch(g){return WebServiceEngine.PostError(u,5)}return u.id}try{I.send(G);if(f.async==false&&typeof(f.WebFlyPostBackManagerId)=="string"){WebServiceEngine._RegisterXmlHttpForCallMethod(f.WebFlyPostBackManagerId,f.funcName,I)}}catch(g){return WebServiceEngine.PostError(u,5)}if(I.responseXML!=null&&I.responseXML.parseError.errorCode!=0){WebServiceEngine._RegisterXmlHttpForCallMethod(f.WebFlyPostBackManagerId,f.funcName,I)}if(z=="Soap"){var D=I.responseXML.documentElement;if(D==null){return WebServiceEngine.ReturnError(u,4)}var y;try{y=WebServiceEngine.ProcessResult(u,D)}catch(g){return WebServiceEngine.ReturnError(u,7)}}else{if(z=="Json"){var p=I.getResponseHeader("jsonerror");if(p=="true"){return WebServiceEngine.ReturnError(u,I.status,ISJsonEngine.Parse(I.responseText))}else{y=WebServiceEngine.ProcessJsonResult(u,I.responseText)}}}return y},GetParameterNames:function(e,h){var b=e.args.parameters;var f=_sdl[h];if(b.elem!=null){var c=new Array();var g=WebServiceEngine.GetSchema(f,b);et=g==null?b:g.elems[b.elem];var i=g.types[et.type];for(var d in i){c.push(d)}return c}return null},CallNext:function(a){if(a.fSeq){setTimeout('WebServiceEngine.InvokeNext("'+a.url+'")',0)}},EnsureXmlHttp:function(b,d){var c=b?d.aXmlHttp==null:d.sXmlHttp==null;if(!c&&d.fSeq){return b?d.aXmlHttp:d.sXmlHttp}var f;try{if(IS.ie){f=new ActiveXObject("Microsoft.XMLHTTP")}else{f=new XMLHttpRequest()}}catch(a){return null}if(!d.fSeq){return f}if(b){d.aXmlHttp=f}else{d.sXmlHttp=f}return f},GetMsg:function(j,c,b,a){var g;var f=c.funcName;var i=_sdl[j];try{var k=i.soapPort[c.portName];g=k.msgs[f]}catch(d){return null}if(g==null||g.length==null){return null}var h;for(h in g){if(g[h].args.length==b.length-a){g=g[h];break}}if(g.length!=null){g=g[h]}return g},GetErrorFromNode:function(b){var a=WebServiceEngine.GetElementNode(b,0);if(a){return a.nodeValue}else{return b.nodeValue}},ProcessResult:function(u,w){var A=new Object();A.id=u.id;if(w==null){A.error=true;A.errorDetail=_errUnknownS;return WebServiceEngine.ReturnResult(u,A)}try{var z=w.prefix}catch(j){z=null}var p=z==null?"":(z+":");var t=w.selectSingleNode(p+"Body");if(t==null){A.error=true;A.errorDetail=_errInvalRes;return WebServiceEngine.ReturnResult(u,A)}var f=t.selectNodes(p+"Fault");if(f.length>0){A.error=true;A.errorDetail=new Object();var a=f[0].selectNodes(p+"faultcode");if(a.length==0){a=f[0].selectNodes("faultcode")}A.errorDetail.code=a.length>0?WebServiceEngine.GetErrorFromNode(a[0]):"Unknown";var h=f[0].selectNodes(p+"faultstring");if(h.length==0){h=f[0].selectNodes("faultstring")}if(h.length>0&&h[0].hasChildNodes()){A.errorDetail.string=WebServiceEngine.GetElementNode(h[0],0)}else{A.errorDetail.string=""}A.errorDetail.raw=w;return WebServiceEngine.ReturnResult(u,A)}A.error=false;A.raw=w;if(!t.hasChildNodes()){A.value=null;return WebServiceEngine.ReturnResult(u,A)}var x=_sdl[u.service];if(x==null||x.fPending){A.error=true;A.errorDetail=_errNotReady;return WebServiceEngine.ReturnResult(u,A)}var q=WebServiceEngine.GetElementNode(t,0);var B=q.baseName;var y=x.schemas[q.namespaceURI];var d=null;var v=u.fRpc?u.response:null;if(v){d=v.args}else{v=x.soapPort[u.co.portName].msgs[B];if(v==null){var k=y==null?null:y.elems[B];if(k==null){if(!u.fLiteral&&y!=null){d=y.types[B]}if(d==null){d=u.response.args}if(d==null){A.error=true;A.errorDetail=_errInvalRes;return WebServiceEngine.ReturnResult(u,A)}}else{if(k.fFinal){d=k}else{d=y.types[k.type]}}}else{d=v.args}}if(d==null){A.value=null;return WebServiceEngine.ReturnResult(u,A)}var n=0;for(var m in d){n++}if(n==0){A.value=null}else{if(d.type!=null){n=1}var g=q.selectNodes("//*[@id]");var b=new Array();for(var m=0;m<g.length;m++){b[WebServiceEngine.GetAttrib(g[m],"id")]=g[m]}var c=WebServiceEngine.DecodeType(x,d,q,b);if(n==1){for(var m in c){A.value=c[m];break}}else{A.value=c}}return WebServiceEngine.ReturnResult(u,A)},EncodeArgs:function(w,D,d,c){var x=_sdl[D];var r=d.length;var E="";var u=w.opname;var n=!w.fRpc&&!w.fLiteral;if(!w.fRpc&&w.argl==1){var z=null;for(z in w.args){break}if(z==null){return null}var b=w.args[z];if(!w.fLiteral&&b.type==null){b.type=b.elem}var m=b;if(b.elem!=null){var y=WebServiceEngine.GetSchema(x,b);m=y==null?b:y.elems[b.elem]}var B=b.ns==null?"":(b.ns+":");var v=' xmlns ="'+(b.ns==null?x.targetns:x.ns[b.ns])+'"';if(w.fLiteral&&b.elem!=null){E+="\n<"+b.elem+v+">"}else{E+="\n<"+B+b.type+' xmlns="" xsi:type="'+B+b.type+'">'}var o=c;if(m.fFinal==true){E+=WebServiceEngine.EncodeVar(x,n,d[o],m)}else{if(WebServiceEngine.IsPrimitive(x,m)){E+="\n<"+m.type+">";E+=WebServiceEngine.EncodePrimitive(x,m.type,d[o]);E+="</"+m.type+">"}else{var y=WebServiceEngine.GetSchema(x,m);if(y==null){return null}var G=y.types[m.type];for(var H in G){if(o>=r){break}E+="\n<"+G[H].name+">";E+=WebServiceEngine.EncodeVar(x,n,d[o],G[H]);E+="</"+G[H].name+">";o++}}}if(w.fLiteral&&b.elem!=null){E+="</"+b.elem+">"}else{E+="</"+B+b.type+">"}return E}if(w.fRpc){E="\n<mswsb:"+u+WebServiceEngine.GetNs(x,w)+">"}var o=c;for(var z in w.args){if(o>=r){break}var b=w.args[z];if(b.elem==null&&b.type==null){return null}var A=w.fLiteral?"mswsb:":"";if(w.fRpc){var F="";if(b.type!=null&&WebServiceEngine.IsPrimitive(x,b)){F=' xsi:type="xsd:'+b.type+'"'}var y=WebServiceEngine.GetSchema(x,b);var h=y==null?null:y.types[b.type];var f=null;if(h!=null){f=WebServiceEngine.Get1stAryItem(h);if(!f.fArray){f=null}}if(f!=null){var g=f.sizeArray;var q=1;q=(g==null)?1:g.length;var e=d[o];if(typeof e=="unknown"){e=WebServiceEngine.VbArrayToJs(e,q)}var C=WebServiceEngine.GetArySize(e);if(g!=null){C="";for(var p=0;;){var t=WebServiceEngine.GetArySize(e);if(g[p]==null){C+=t}else{C+=Math.min(g[p],t)}p=p+1;if(p==g.length){break}C+=",";if(t==0){return null}e=WebServiceEngine.Get1stAryItem(e)}}var y=WebServiceEngine.GetSchema(x,f);if(y!=null){f.ns=x.nsalias[y.uri]}var I=(WebServiceEngine.IsPrimitive(x,f)||f.ns=="")?"xsd:":(f.ns+":");F=' xsi:type="soapenc:Array" soapenc:arrayType="'+I+f.type+"["+C+']"'}else{F=' xsi:type="'+(b.ns==""?"":(b.ns+":"))+b.type+'"'}E+="\n<"+A+b.name+(w.fLiteral?"":' xmlns=""')+F+">"}var m=(b.elem==null?b:WebServiceEngine.GetSchema(x,b).elems[b.elem]);if(w.fLiteral){if(b.elem!=null){E+="\n<"+b.elem+WebServiceEngine.GetNs(x,w)+">"}E+=WebServiceEngine.EncodeVar(x,n,d[o],m);if(b.elem!=null){E+="</"+b.elem+">"}}else{if(b.type==null){return null}if(w.fRpc){E+=WebServiceEngine.EncodeVar(x,n,d[o],m)}else{E+="\n<"+b.type+">"+WebServiceEngine.EncodeVar(x,n,d[o],m)+"</"+b.type+">"}}if(w.fRpc){E+="</"+A+b.name+">"}o++}if(w.fRpc){E+="</mswsb:"+u+">"}return E},GetSchema:function(b,d){if(d.ns==null){return WebServiceEngine.Get1stAryItem(b.schemas)}var a=b.ns[d.ns];var c=b.schemas[a];if(c!=null||d.ns.length==0){return c}for(var e in b.schemas){if(e.indexOf(a)==0&&b.schemas[e].types[d.type]!=null){return b.schemas[e]}}return null},InvokeNext:function(c){var b=_sdl[c];if(b==null){return}var a=b.nextCall;if(a==null){return null}b.nextCall=a.next;if(b.nextCall==null){b.lastCall=null}WebServiceEngine._Invoke(a)},GetChildNodesLength:function(c){var b=0;if(c!=null){for(var a=0;a<c.childNodes.length;a++){if(c.childNodes[a].nodeType==1){b++}}}return b},DecodeType:function(os,ot,o,aNodes,realType){if(ot==null){return null}var oschm=null;var j=-1;var or;if(realType==null){realType=o.nodeName}if(realType.indexOf("ArrayOf")==0){or=new Array()}else{if(eval("typeof("+realType+")")!="function"){or=new Array()}else{or=eval("new "+realType+"()")}}if(ot.type!=null){var st=ot.type;oschm=WebServiceEngine.GetSchema(os,ot);if(WebServiceEngine.IsSimpleType(os,oschm,ot)){var stype=oschm==null?null:oschm.sTypes[st];if(stype!=null){st=stype.type}if(ot.fArray){or.result=new Array();var o2=o.childNodes;if(WebServiceEngine.GetChildNodesLength(o)==0){return or}var ai=ot.sizeArray;if(ai==null){ai=new Array();ai[0]=o2.length}if(ai.length==1&&ai[0]==null){ai[0]=o2.length}var fnDec=function(vi){return WebServiceEngine.DecodePrimitive(os,st,vi)};WebServiceEngine.DecodeArray(0,or.result,ai,1,o2,fnDec)}else{or.result=WebServiceEngine.DecodePrimitive(os,st,o)}return or}else{or.result=WebServiceEngine.DecodeType(os,oschm.types[st],o,aNodes);return or}}for(var sn in ot){j++;var st=ot[sn].type;oschm=WebServiceEngine.GetSchema(os,ot[sn]);if(st==null){or[sn]=null;continue}if(ot[sn].fAttrib==true){var attrib=o.attributes.getNamedItem(sn);if(attrib!=null){or[sn]=attrib.value}continue}var o1s=o.selectNodes(sn);var o1=null;if(o1s.length==0){continue}else{o1=o1s[0]}if(!o1.hasChildNodes()){var sr=null;try{sr=WebServiceEngine.GetAttrib(o1,"href")}catch(e){}if(sr!=null&&sr.charAt(0)=="#"){o1=aNodes[sr.substring(1,sr.length)]}else{if(WebServiceEngine.IsSimpleType(os,oschm,ot[sn])){or[sn]=WebServiceEngine.DecodePrimitive(os,st,o1);continue}}}if(WebServiceEngine.IsSimpleType(os,oschm,ot[sn])){var stype=oschm==null?null:oschm.sTypes[st];if(stype!=null){st=stype.type}if(ot[sn].fArray){var o2;var ai=WebServiceEngine.GetArrayInfo(o1);var fNested=ot[sn].fNested==true||ai!=null;if(fNested){or[sn]=new Array();o2=WebServiceEngine.GetElementNodes(o1)}else{o2=WebServiceEngine.GetElementNodes(o)}if(o2.length==0){return or}if(ai==null){ai=ot[sn].sizeArray;if(ai==null){ai=new Array();ai[0]=o2.length}}if(ai.length==1&&ai[0]==null){ai[0]=o2.length}var fnDec=function(vi){return WebServiceEngine.DecodePrimitive(os,st,vi)};WebServiceEngine.DecodeArray(0,fNested?or[sn]:or,ai,1,o2,fnDec)}else{or[sn]=WebServiceEngine.DecodePrimitive(os,st,o1)}continue}var ot1=oschm.aTypes[st];var fCompArray=true;if(ot1==null){fCompArray=false;ot1=oschm.types[st]}if(fCompArray){return WebServiceEngine.DecodeType(os,ot1,o,aNodes)}if(ot1==null){or[sn]=o1;continue}if(ot[sn].fArray){var ai=WebServiceEngine.GetArrayInfo(o1);var fNested=ot[sn].fNested==true||ai!=null;var o2=fNested?WebServiceEngine.GetElementNodes(o1):WebServiceEngine.GetElementNodes(o);if(ai==null){ai=ot[sn].sizeArray;if(ai==null){ai=new Array();ai[0]=o2.length}}if(ai.length==1&&ai[0]==null){ai[0]=o2.length}var fnDec=function(vi){var sr=WebServiceEngine.GetAttrib(vi,"href");if(sr!=null&&sr.charAt(0)=="#"){vi=aNodes[sr.substring(1,sr.length)]}return WebServiceEngine.DecodeType(os,ot1,vi,aNodes)};if(fNested){or[sn]=new Array()}WebServiceEngine.DecodeArray(0,fNested?or[sn]:or,ai,1,o2,fnDec)}else{or[sn]=WebServiceEngine.DecodeType(os,ot1,o1,aNodes,ot[sn].type)}}return or},ReturnResult:function(c,d){if(c.co.async==false){return d}if(c.cb==null){var a=new Array();a[0]=d;try{Listener.Fire(WebServiceEngine,"OnResult",a)}catch(b){}}else{try{c.cb(d)}catch(b){}}},ReturnError:function(f,h,d){var g=new Object();g.id=f.id;g.error=true;if(d!=null){g.errorDetail=new ErrDetail(h,d.Message,d.StackTrace)}else{g.errorDetail=_aryError[h]}if(f.co.async==false){return g}var b=f.cb;if(b==null){var a=new Array();a[0]=g;try{Listener.Fire(WebServiceEngine,"OnResult",a)}catch(c){}}else{try{b(g)}catch(c){}}return f.id},PostError:function(a,b){if(a.co!=null&&!a.co.async){return WebServiceEngine.ReturnError(a,b)}var c=function(){WebServiceEngine.ReturnError(a,b)};setTimeout(c,0);return a.id},CreateUseOptions:function(b,c){var a=new Object();a.reuseConnection=false;a.SOAPHeader=c;return a},EnsureVBArray:function(d){if(!_fVBon){var s1='Function VBGetArySize(a, d)\nDim x\nDim s\ns=UBound(a, 1)\nFor x = 2 To d \ns = s & "," & UBound(a, x)\nNext\nVBGetArySize=s\nEnd Function';var o=document.createElement("script");o.language="VBS";o.text=s1;document.body.appendChild(o);_fVBon=true}var fn="VBGetAryItem"+d;if(eval("typeof "+fn)!="undefined"){return}var a=new Array();for(var i=0;i<d;i++){a[i]="p"+i}var sp=a.join(",");var s2="Function "+fn+"(a,"+sp+")\n"+fn+"=a("+sp+")\nEnd Function\n";var o=document.createElement("script");o.language="VBS";o.text=s2;document.body.appendChild(o)},Encb64hlp:function(f,c,e){var a=0;for(var b=0;b+c<=e;b++){a|=f.charCodeAt(b+c)<<(16-8*b)}var f="";for(var b=0;b<=e-c+1;b++){f+=_b64.charAt(a>>>(18-b*6)&63)}return f},Decb64hlp:function(b,c,k,g,h){var e=0;var j=h-g;for(var f=0;f+g<=h;f++){e|=_b64.indexOf(k.charAt(f+g))<<(18-6*f)}for(var f=0;f<j;f++){b[c+f]=(e>>>(16-f*8))&255}return c+f},Encb64p:function(c){var d="";var a;var b=c.length;for(a=2;a<b;a=a+3){d+=WebServiceEngine.Encb64hlp(c,a-2,a)}if(a-3<b){d+=WebServiceEngine.Encb64hlp(c,a-2,b-1)}return d},Decb64:function(s){var sDec="";var i;var ip=s.indexOf("=");var l=ip>=0?ip:s.length;var a=new Array((l>>>2)*3+1);var ai=0;for(i=3;i<l;i=i+4){ai=WebServiceEngine.Decb64hlp(a,ai,s,i-3,i)}if(i-4<l){ai=WebServiceEngine.Decb64hlp(a,ai,s,i-3,l-1)}var s;try{s=String.fromCharCode.apply(null,a)}catch(E){s=eval("String.fromCharCode("+a.join(",")+")")}return s},AllocCall:function(){var a=new Object();a.fDone=false;a.next=null;a.id=_nextId;_nextId++;return a},IsSimpleType:function(a,b,c){return WebServiceEngine.IsPrimitive(a,c)||b==null||b.sTypes[c.type]!=null},IsPrimitive:function(a,b){return a.ns[b.ns]==a.ns.xsd},GetSdl:function(){var j=null;for(var b in _sdl){if(_sdl[b]==null){continue}var k=_sdl[b]._oXml;if(k==null){continue}var i=k.readyState;var d=false;if(IS.safari){if(typeof(k.readyState)!="undefined"&&k.readyState!=null&&k.readyState!=-1){d=k.readyState==4}else{d=k.XMLDocument.GetReadyState()==4}}else{if(IS.ie){if(!IS.IsHTML5DocType()){if(k.XMLDocument!=null){if(k.XMLDocument.readyState!=4){i="loading"}else{i="complete"}}}else{if(IS.ie10){i=(i==4?"complete":"loading")}}}}if(_sdl[b].fPending&&((IS.safari&&d)||(i=="complete")||((k.XMLDocument!=null&&k.XMLDocument.readyState==4)))){_sdl[b].fPending=false;j=b;break}}if(j==null){return}var g=_sdl[j];var l=g._oXml.documentElement;if(l!=null||typeof(l)!="undefined"){WebServiceEngine.ParseSdl(l,j)}var h=new Object();h.serviceUrl=j;h.userName=_sdl[j].userName;h.serviceAvailable=l!=null;if(!IS.ie10&&!IS.IsHTML5DocType()){g._oXml.removeNode(true)}g._oXml=null;var a=new Array();a[0]=h;if(l==null){for(var f=g.nextCall;f!=null;f=f.next){WebServiceEngine.ReturnError(f,1)}_sdl[j]=null;try{a[1]=_errNotReady;Listener.Fire(WebServiceEngine,"OnServiceAvailable",a)}catch(c){}return}try{a[1]=l;Listener.Fire(WebServiceEngine,"OnServiceAvailable",a)}catch(c){}if(g.fSeq){return WebServiceEngine.CallNext(g)}while(g.nextCall!=null){var f=g.nextCall;g.nextCall=g.nextCall.next;WebServiceEngine._Invoke(f)}},GetAttrib:function(c,d){var b=c.attributes.getNamedItem(d);if(b!=null){return b.value}return null},GetBaseName:function(c){var b=c.split(":");if(b.length>1){return b[1]}return c},GetQualifier:function(c){var b=c.split(":");if(b.length>1){return b[0]}return""},ParseSimpleType:function(g,h,d,k){var c=WebServiceEngine.GetQualifier(d.tagName);var f=WebServiceEngine.GetElementNode(d,0);if(f==null){return null}var j=WebServiceEngine.GetAttrib(d,"name");if(j==null){return null}j=WebServiceEngine.GetBaseName(j);var i;switch(f.baseName){case"restriction":var a=f.selectNodes(c.length?(c+":enumeration"):"enumeration");if(a.length==0){return null}i=new Object();i.name=j;i.type="enum";try{i.base=WebServiceEngine.GetBaseName(WebServiceEngine.GetAttrib(f,"base"))}catch(b){i.base="string"}h.sTypes[j]=i;break;default:i=null}return i},ParseType:function(b,c,a,d){if(a==null){return null}switch(a.baseName){case"complexType":return WebServiceEngine.ParseComplexType(b,c,a,d);case"simpleType":return WebServiceEngine.ParseSimpleType(b,c,a,d)}return null},GetAttribEx:function(e,c){var b=e.attributes;for(var d=0;d<b.length;d++){if(b[d].baseName==c){return b[d].value}}return null},ParseArrayType:function(b,e){var a=e.split("[");if(a.length<=1){a=e.split(",");for(var c=0;c<a.length;c++){var d=parseInt(a[c]);b[b.length]=isNaN(d)?null:d}return}for(var c=0;c<a.length;c++){WebServiceEngine.ParseArrayType(b,a[c])}},ParseComplexType:function(n,p,h,t){var g=WebServiceEngine.GetQualifier(h.tagName);if(!h.hasChildNodes()){return null}var q=null;for(var f=0;f<h.childNodes.length;f++){var k=h.childNodes[f];if(k.nodeType!=1){continue}switch(k.baseName){case"sequence":case"all":var c=k.selectNodes(g.length?(g+":any"):"any");if(c.length!=0){continue}c=k.selectNodes(g.length?(g+":element"):"element");if(c.length==0){continue}q=new Array();for(var e=0;e<c.length;e++){var r=WebServiceEngine.GetAttrib(c[e],"name");if(r==null){var r=WebServiceEngine.GetAttrib(c[e],"ref");if(r!=null){n.refs[r]=q}}else{q[r]=WebServiceEngine.ParseElem(n,p,c[e],true,t)}}continue;case"complexContent":var l=WebServiceEngine.GetElementNode(k,0);switch(l.baseName){case"restriction":var u=WebServiceEngine.GetAttrib(h,"name");if(u==null){continue}u=WebServiceEngine.GetBaseName(u);var v=WebServiceEngine.ParseComplexType(n,p,l,t);p.aTypes[u]=v;return v;case"all":return WebServiceEngine.ParseComplexType(n,p,k,t)}continue;case"attribute":var d=WebServiceEngine.GetAttribEx(k,"arrayType");if(d==null){if(q==null){q=new Array()}q[WebServiceEngine.GetAttrib(k,"name")]=WebServiceEngine.ParseAttrib(k);continue}var u=WebServiceEngine.GetBaseName(d);if(q!=null){var m=WebServiceEngine.Get1stAryItem(q);m.fArray=true;m.fNested=true;m.sizeArray=new Array();WebServiceEngine.ParseArrayType(m.sizeArray,u.substring(u.indexOf("[")+1,u.length));continue}var m=new Object();var b=u.split("[");if(b.length<2){continue}m.ns=WebServiceEngine.GetQualifier(d);m.name=b[0];m.fArray=true;m.type=b[0];m.sizeArray=new Array();m.fNested=true;WebServiceEngine.ParseArrayType(m.sizeArray,u.substring(u.indexOf("[")+1,u.length));q=new Array();q[b[0]]=m;continue;default:q=null}}return q},ParseAttrib:function(b){var a=new Object();a.fAttrib=true;a.type=WebServiceEngine.GetAttrib(b,"type");return a},ParseElem:function(i,l,g,b,m){var h=new Object();h.name=WebServiceEngine.GetAttrib(g,"name");var n=WebServiceEngine.GetAttrib(g,"type");var f=WebServiceEngine.GetAttrib(g,"minOccurs");var e=WebServiceEngine.GetAttrib(g,"maxOccurs");h.fArray=(e!=null&&e!="1");if(n!=null){h.type=WebServiceEngine.GetBaseName(n);h.ns=WebServiceEngine.GetQualifier(n);h.fFinal=true;return h}h.fFinal=false;var a=WebServiceEngine.ParseType(i,l,WebServiceEngine.GetElementNode(g,0),h.name);if(b&&a!=null){var d=null;for(var c in a){if(d==null){d=c}else{d=null;break}}if(d!=null){h.type=a[d].type;h.ns=a[d].ns;h.fArray=a[d].fArray;h.fNested=true;return h}}if(typeof m!="undefined"){h.type=m+"_"+h.name}else{h.type=h.name}l.types[h.type]=a;return h},ParseSoapHeader:function(d,c){var b=new Object();b.ns=WebServiceEngine.GetAttrib(c,"namespace");b.es=WebServiceEngine.GetAttrib(c,"encodingStyle");var g=WebServiceEngine.GetAttrib(c,"use");b.fLiteral=(g!=null&&g.toLowerCase()=="literal");var e=WebServiceEngine.GetAttrib(c,"message");var a=d.msgs[WebServiceEngine.GetBaseName(e)];var f=WebServiceEngine.GetAttrib(c,"part");b.fRequired=WebServiceEngine.GetAttrib(c,"required")=="true";b.type=a.args[WebServiceEngine.GetBaseName(f)];return b},ParseSdl:function(an,al){if(typeof an=="undefined"||an==null){return}if(IS.ie10){an.ownerDocument.setProperty("SelectionNamespaces",'xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"')}var I=WebServiceEngine.GetQualifier(an.nodeName);var I=I.length==0?"":(I+":");var v=an.selectNodes(I+"message");var z=an.selectNodes(I+"portType");var r=an.selectNodes(I+"binding");var D=an.selectNodes(I+"service");var L=an.selectNodes(I+"types");var c=new Array();var e=new Array();var a=new Array();var Q=_sdl[al];Q.targetns=WebServiceEngine.GetAttrib(an,"targetNamespace");Q.ns=new Array();Q.ns[""]="";Q.ns.xsd="http://www.w3.org/2001/XMLSchema";Q.ns.soapenc="http://schemas.xmlsoap.org/soap/encoding/";Q.ns["SOAP-ENV"]="http://schemas.xmlsoap.org/soap/envelope/";Q.schemas=new Array();Q.nsalias=new Array();Q.msgs=c;Q.refs=new Array();for(var g=0;g<an.attributes.length;g++){var N=an.attributes.item(g);if(N.name=="xmlns"){continue}var h=N.name.indexOf("xmlns:");if(h!=0){continue}var E=N.name.substring(6,N.name.length);Q.ns[E]=N.value;Q.nsalias[N.value]=E}if(IS.ie10&&IS.IsHTML5DocType()){var p="";for(var B in Q.ns){if(B!=""){p+="xmlns:"+B+'="'+Q.ns[B]+'" '}}an.ownerDocument.setProperty("SelectionNamespaces",p)}if(Q.ns.xsi==null){Q.ns.xsi=Q.ns.xsd==xsd99?xsi99:xsi01}for(var g=0;g<L.length;g++){var C=L[g].childNodes;for(var m=0;m<C.length;m++){if(C[m].nodeType!=1){continue}var S=new Object();S.uri=WebServiceEngine.GetAttrib(C[m],"targetNamespace");S.efd=WebServiceEngine.GetAttrib(C[m],"elementFormDefault");S.afd=WebServiceEngine.GetAttrib(C[m],"attributeFormDefault");S.service=al;S.elems=new Array();S.types=new Array();S.sTypes=new Array();S.aTypes=new Array();var t=C[m].childNodes;for(var n=0;n<t.length;n++){if(t[n].nodeType!=1){continue}var ab=WebServiceEngine.GetAttrib(t[n],"name");if(ab==null){continue}switch(t[n].baseName){case"element":S.elems[ab]=WebServiceEngine.ParseElem(Q,S,t[n],false,ab);break;case"simpleType":case"complexType":S.types[ab]=WebServiceEngine.ParseType(Q,S,t[n]);break}}Q.schemas[S.uri]=S}}for(var am in Q.refs){var X=WebServiceEngine.GetQualifier(am);var K=Q.ns[X];var R=Q.schemas[K];if(R==null){continue}var V=R.elems[WebServiceEngine.GetBaseName(am)];Q.refs[am][V.name]=V}for(var g=0;g<v.length;g++){var ac=WebServiceEngine.GetAttrib(v[g],"name");c[ac]=new Object();var W=v[g].selectNodes(I+"part");c[ac].args=new Array();for(var m=0;m<W.length;m++){var d=new Object();d.name=WebServiceEngine.GetAttrib(W[m],"name");d.type=WebServiceEngine.GetAttrib(W[m],"type");d.elem=WebServiceEngine.GetAttrib(W[m],"element");if(d.elem!=null){d.ns=WebServiceEngine.GetQualifier(d.elem);d.elem=WebServiceEngine.GetBaseName(d.elem)}if(d.type!=null){d.ns=WebServiceEngine.GetQualifier(d.type);d.type=WebServiceEngine.GetBaseName(d.type)}if(d.ns!=null&&d.ns!=""){var J=WebServiceEngine.GetAttrib(W[m],"xmlns:"+d.ns);if(J!=null){Q.ns[d.ns]=J}}c[ac].args[d.name]=d}c[ac].argl=W.length}for(var g=0;g<z.length;g++){var ac=WebServiceEngine.GetAttrib(z[g],"name");e[ac]=new Object();var w=z[g].selectNodes(I+"operation");var P=new Array();e[ac].ops=P;for(var m=0;m<w.length;m++){var ae=WebServiceEngine.GetAttrib(w[m],"name");var u=w[m].selectNodes(I+"input");var o=null;if(u.length>0){var Y=WebServiceEngine.GetAttrib(u[0],"message");var aa=WebServiceEngine.GetBaseName(Y);var ad=WebServiceEngine.GetQualifier(Y);if(P[ae]==null){P[ae]=new Array()}var Z=WebServiceEngine.GetAttrib(u[0],"name");if(Z!=null){P[ae][Z]=c[aa]}else{P[ae][ae]=c[aa]}if(c[aa]==null){break}c[aa].opname=ae;o=c[aa]}var y=w[m].selectNodes(I+"output");if(y.length>0){var Y=WebServiceEngine.GetAttrib(y[0],"message");var aa=WebServiceEngine.GetBaseName(Y);var ag=c[aa].soapName;if(ag==null){e[ac].ops[aa]=c[aa]}else{e[ac].ops[ag]=c[aa];c[ag]=c[aa]}if(o!=null){o.response=c[aa]}}}}for(var g=0;g<r.length;g++){var T=r[g].selectNodes("soap:binding");if(T==null||T.length==0){continue}var ah=WebServiceEngine.GetAttrib(T[0],"style");var ac=WebServiceEngine.GetAttrib(r[g],"name");a[ac]=new Object();var ai=WebServiceEngine.GetBaseName(WebServiceEngine.GetAttrib(r[g],"type"));a[ac].msgs=e[ai].ops;var w=r[g].selectNodes(I+"operation");for(var m=0;m<w.length;m++){var ae=WebServiceEngine.GetAttrib(w[m],"name");var l=w[m].selectSingleNode(I+"input");if(l==null){continue}var Z=WebServiceEngine.GetAttrib(l,"name");if(Z==null){Z=ae}var O=a[ac].msgs[ae][Z];if(O==null){continue}var H=w[m].selectNodes("soap:operation");if(H.length==0){continue}var af=WebServiceEngine.GetAttrib(H[0],"style");O.soapAction=WebServiceEngine.GetAttrib(H[0],"soapAction");var F=w[m].selectNodes(I+"input/soap:body");if(F.length>0){O.ns=WebServiceEngine.GetAttrib(F[0],"namespace");O.es=WebServiceEngine.GetAttrib(F[0],"encodingStyle");var aj=WebServiceEngine.GetAttrib(F[0],"use");O.fLiteral=(aj!=null&&aj.toLowerCase()=="literal")}var G=w[m].selectNodes(I+"input/soap:header");O.headers=new Array();for(var n=0;n<G.length;n++){O.headers[n]=WebServiceEngine.ParseSoapHeader(Q,G[n])}if(af!=null){O.fRpc=af.toLowerCase()=="rpc"}else{O.fRpc=(ah!=null&&ah.toLowerCase()=="rpc")}}}if(D[0]!=null){var A=D[0].selectNodes(I+"port")}Q.soapPort=new Array();if(A!=null){for(var m=0;m<A.length;m++){var M=A[m].selectNodes("soap:address");if(M.length==0){continue}var U=A[m].selectNodes("soap:header");Q.headers=new Array();for(var n=0;n<U.length;n++){Q.headers[n]=WebServiceEngine.ParseSoapHeader(Q,U[n])}oPort=new Object();oPort.location=WebServiceEngine.GetAttrib(M[0],"location");var f=a[WebServiceEngine.GetBaseName(WebServiceEngine.GetAttrib(A[m],"binding"))];oPort.msgs=f.msgs;var ak=WebServiceEngine.GetAttrib(A[m],"name");Q.soapPort[ak]=oPort;if(Q.defPortName==null){Q.defPortName=ak}}}},FixupDT:function(a){return(a<10)?("0"+a):a},EncTZ:function(a){var b=a.getTimezoneOffset();return(b>0?"-":"+")+WebServiceEngine.FixupDT(b/60)+":"+WebServiceEngine.FixupDT(b%60)},EncodePrimitive:function(d,a,b){var f="";switch(_st[a]){case 2:if(d.fEscString){f=escape(b)}else{f="<![CDATA["+b+"]]>"}break;case 3:try{f=b.getFullYear()+"-"+WebServiceEngine.FixupDT(b.getMonth()+1)+"-"+WebServiceEngine.FixupDT(b.getDate())+"T"+WebServiceEngine.FixupDT(b.getHours())+":"+WebServiceEngine.FixupDT(b.getMinutes())+":"+WebServiceEngine.FixupDT(b.getSeconds())+(b.getMilliseconds==null?"":("."+b.getMilliseconds()))+WebServiceEngine.EncTZ(b)}catch(c){f=b}break;case 4:try{f=b.getFullYear()+"-"+WebServiceEngine.FixupDT(b.getMonth()+1)+"-"+WebServiceEngine.FixupDT(b.getDate())+WebServiceEngine.EncTZ(b)}catch(c){f=b}break;case 5:try{f=WebServiceEngine.FixupDT(b.getHours())+":"+WebServiceEngine.FixupDT(b.getMinutes())+":"+WebServiceEngine.FixupDT(b.getSeconds())+(b.getMilliseconds==null?"":("."+b.getMilliseconds()))+WebServiceEngine.EncTZ(b)}catch(c){f=b}break;case 6:f=WebServiceEngine.Encb64p(b);break;default:f=b}return f},BldJsAry:function(b,c,e){if(e==c.length-1){return}for(var f=0;f<c[e];f++){b[f]=new Array();WebServiceEngine.BldJsAry(b[f],c,e+1)}},GetNextIndexAry:function(b,c){var d;var e=b.length;if(c.length==0){for(d=0;d<e;d++){c[d]=0}return true}for(d=e-1;d>=0;d--){if(d==0&&1+c[0]>b[0]-1){return false}var f=c[d]+1;if(f<=b[d]-1){c[d]=f;return true}c[d]=0}return true},VbArrayToJs:function(a,d){WebServiceEngine.EnsureVBArray(d);var szSize;try{szSize=VBGetArySize(a,d)}catch(e){return new Array()}var aSize=szSize.split(",");var aszIndex=new Array();var ajs=new Array();WebServiceEngine.BldJsAry(ajs,aSize,0);var ai=new Array();while(true==WebServiceEngine.GetNextIndexAry(aSize,ai)){var s="ajs["+ai.join("][")+"]=VBGetAryItem"+d+"(a,"+ai.join(",")+");";try{eval(s)}catch(e){break}}return ajs},EncodeArray:function(e,g,h,a,b){var f="";for(var c in h){if(a==1){f+="\n<"+g+">"+b(e,g,h[c])+"</"+g+">"}else{f+=WebServiceEngine.EncodeArray(e,g,h[c],a-1,b)}}return f},EncodeVar:function(l,d,x,w){var n=w.ns==null?"":(w.ns+":");var r=d?("<"+n+w.type+' xsi:type="'+n+w.type+'">'):"";var u=d?("</"+n+w.type+">"):"";var q="";if(x==null){return r+q+u}var m=WebServiceEngine.GetSchema(l,w);if(WebServiceEngine.IsSimpleType(l,m,w)){if(w.fArray){if(typeof x!="object"&&typeof x!="unknown"){return r+q+u}var p=w.sizeArray;var h=1;h=(p==null)?1:p.length;if(typeof x=="unknown"){x=WebServiceEngine.VbArrayToJs(x,h)}q+=WebServiceEngine.EncodeArray(l,w.type,x,h,WebServiceEngine.EncodePrimitive);return r+q+u}else{q=WebServiceEngine.EncodePrimitive(l,w.type,x);return q}}var b=m.types[w.type];if(b==null){try{var l=WebServiceEngine.GetElementNodes(x);for(var g=0;g<l.length;g++){q+=l[g].xml}return r+q+u}catch(a){return r+q+u}}if(w.fArray){if(typeof x!="object"&&typeof x!="unknown"){return r+q+u}var j=new Object();j.name=w.name;j.fArray=false;j.type=w.type;j.ns=w.ns;var f=function(e,i,k){return WebServiceEngine.EncodeVar(e,d,k,j)};var p=w.sizeArray;var h=1;h=(p==null)?1:p.length;if(typeof x=="unknown"){x=WebServiceEngine.VbArrayToJs(x,h)}q+=WebServiceEngine.EncodeArray(l,w.type,x,h,f);return r+q+u}if(typeof x!="object"||x.length>0){var c=WebServiceEngine.Get1stAryItem(b);if(c==null){return r+q+u}if(x.length==null||x.length==0){q+="\n<"+c.name+">"}q+=WebServiceEngine.EncodeVar(l,d,x,c);if(x.length==null||x.length==0){q+="</"+c.name+">"}return r+q+u}for(var h in x){if(b[h]==null){continue}if(x[h]==null){q+="\n<"+b[h].name+' xsi:null="true"/>\n';continue}var o="";if(WebServiceEngine.IsPrimitive(l,b[h])){o=' xsi:type="xsd:'+b[h].type+'"'}q+="\n<"+b[h].name+o+">"+WebServiceEngine.EncodeVar(l,d,x[h],b[h])+"</"+b[h].name+">"}return r+q+u},GetNs:function(b,a){var c=a.ns==null?b.targetns:a.ns;return" xmlns"+(a.fRpc?":mswsb":"")+'="'+c+'"'},GetArySize:function(b){var c=0;for(var d in b){c++}return c},Get1stAryItem:function(b){for(var c in b){return b[c]}},DecTZ:function(d){var b=d.split(":");if(b.length==0){return 0}var c=parseInt(b[0],10);return(-c)*60+(b.length>1?((c>0?-1:1)*parseInt(b[1],10)):0)},ApplyTZ:function(a,b){a.setTime(a.getTime()+(b-a.getTimezoneOffset())*60000)},DecDate:function(c,e){var b=e.split("-");if(b.length<3){return}c.setYear(b[0]);c.setMonth(parseInt(b[1],10)-1);c.setDate(b[2]);var g=c.getTimezoneOffset();var f=e.indexOf("+");if(b.length>=4){g=-WebServiceEngine.DecTZ(b[3])}else{if(f>0){g=WebServiceEngine.DecTZ(e.substring(f,e.length))}else{return}}WebServiceEngine.ApplyTZ(c,g)},DecTime:function(c,f){var g=f.indexOf("+");if(g<0){g=f.indexOf("-")}var b=f.split(":");if(b.length<3){return}c.setHours(b[0]);c.setMinutes(b[1]);c.setSeconds(parseInt(b[2],10));var e=b[2].split(".")[1];if(e!=null&&c.setMilliseconds!=null){c.setMilliseconds(parseInt(e.substring(0,3,10)))}WebServiceEngine.ApplyTZ(c,g<0?0:WebServiceEngine.DecTZ(f.substring(g,f.length)))},DecodePrimitive:function(os,st,o){var r=o.hasChildNodes()?o.firstChild.nodeValue:o.nodeValue;if(r==null&&st=="string"){if(st=="string"){return""}return null}switch(_st[st]){case 0:r=eval(r);break;case 1:break;case 2:r=unescape(r);break;case 3:case 4:var aXmlDT=r.split("T");r=new Date();if(aXmlDT.length>0){WebServiceEngine.DecDate(r,aXmlDT[0]);if(aXmlDT.length>1){WebServiceEngine.DecTime(r,aXmlDT[1])}}break;case 5:var s=r;r=new Date();WebServiceEngine.DecTime(r,s);break;case 6:r=WebServiceEngine.Decb64(r);break;default:break}return r},GetArrayInfo:function(g){if(g.attributes==null){return null}for(var f=0;f<g.attributes.length;f++){var h=g.attributes.item(f);var c=h.name;var b=h.name.split(":");if(b.length>1){c=b[1]}if(c!="arrayType"){continue}var e=new Array();var d=h.value.split("[");if(d.length>1){WebServiceEngine.ParseArrayType(e,d[1])}else{e[0]=WebServiceEngine.GetElementNodes(g).length}return e}return null},DecodeArray:function(e,b,k,f,j,g){for(var h=0;h<k[f-1];h++){if(f==k.length){b[h]=g(j[e++])}else{b[h]=new Array();e=WebServiceEngine.DecodeArray(e,b[h],k,f+1,j,g)}}return e},GetResult:function(c){if(c==null){return}var d=_sdl[c.service];var f=c.oXmlHttp;if(f==null||(f.readyState!=4)){return}if(c.fDone){return}c.fDone=true;c.oXmlHttp=null;var a=f.getResponseHeader("Content-Type");var e=f.status;if(a.indexOf("json")>-1){var b=f.getResponseHeader("jsonerror");if(b=="true"){WebServiceEngine.ReturnError(c,e,ISJsonEngine.Parse(f.responseText))}else{WebServiceEngine.ProcessJsonResult(c,f.responseText)}}else{if(f.responseXML.parseError.errorCode!=0){_errUnknownS.raw=f.responseText;WebServiceEngine.ReturnError(c,4)}else{if(f.responseXML.documentElement==null){WebServiceEngine.ReturnError(c,4)}else{WebServiceEngine.ProcessResult(c,f.responseXML.documentElement)}}}WebServiceEngine.CallNext(d)},ProcessJsonResult:function(c,e){var b=ISJsonEngine.ParseAjax(e);var a="";var d=new Object();if(b.d){b=b.d}if(b!=null&&typeof(b)!="undefined"){if(typeof(b.__type)=="string"){a=b.__type}if(typeof(ISADONETMappingEngine)=="object"&&a.indexOf("ISDataSet")>-1||a.indexOf("ISDataTable")>-1){b=ISADONETMappingEngine.MappingJsonToObject(b)}}d.error=false;d.value=b;d.id=c.id;return WebServiceEngine.ReturnResult(c,d)}};