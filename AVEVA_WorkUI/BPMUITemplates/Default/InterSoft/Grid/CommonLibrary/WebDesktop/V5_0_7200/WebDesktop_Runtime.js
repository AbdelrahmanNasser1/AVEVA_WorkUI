function ISInteractiveObject(){this.Enabled=true;this.Resizable=false;this.Movable=false;this.FrameElement=null;this.DragElement=null;this.Registered=false;this.DesktopManager=null;this.Window=null;this._CursorElement=null}var ISWinEngine={Collection:null,LastValidObject:null,LastCursorPart:null,IsMouseDown:false,Event:null,LastDragObject:null,LastMovedObject:null,MozillaMouseUpTreshold:false,MozillaMouseUpTresholdId:0,Initialize:function(c){var a=document.body;Listener.Add(a,"onmousemove",ISWinEngine.OnMouseMove);Listener.Add(a,"onmousedown",ISWinEngine.OnMouseDown);Listener.Add(window,"onmouseup",ISWinEngine.OnMouseUp);for(var f=0;f<c.length;f++){var g=c[f];var d=g.FrameElement;d.IsInteractiveObject=true;g.Registered=true}ISWinEngine.Collection=c},CreateShadow:function(a,b,d){if(!d){d="afterBegin"}var e=document.createElement("DIV");e.onselectstart=function(){return false};e.ondragstart=function(){return false};e.style.display="none";e.hideFocus=true;e.innerHTML="<img width=100% height=100% src='"+a.ResolveImagePath("blank.gif")+"' />";Listener.Add(e,"onmousemove",ISWinEngine.OnShadowMouseMove);b.insertAdjacentElement(d,e);return e},OnShadowMouseMove:function(){},BlockDesktopManager:function(c){if(c.InteractiveShadow==null){c.InteractiveShadow=ISWinEngine.CreateShadow(c,c.FrameObj,"beforeEnd")}var sh=c.InteractiveShadow;if(sh.style.display=="none"){var size=c.GetDesktopSize();with(sh.style){position="absolute";width=c.FrameObj.clientWidth+"px";height=c.FrameObj.clientHeight+"px";left=0+"px";top=0+"px";backgroundColor="gray";zIndex=252}if(c.ShadowModeAnimation){var ani=new ISAnimatedObject();ani.Element=sh;ani.Speed="Fast";ani.StepInterval=10;ani.Type="FadeIn";ani.MaxFadeInOpacity=40;ani.Play()}else{sh.style.display="";if(!c.ShadowModeTransparency){sh.style.backgroundColor="transparent"}else{sh.style.opacity="0.5";sh.style.filter="Alpha(Opacity=50)"}}}},UnblockDesktopManager:function(b){if(b.ShadowModeAnimation){var a=new ISAnimatedObject();a.Element=b.InteractiveShadow;a.Speed="Fast";a.StepInterval=10;a.MaxFadeInOpacity=40;a.Type="FadeOut";a.OnCompleted=ISWinEngine.OnFadeOutCompleted;a.Play()}else{if(b.InteractiveShadow){b.InteractiveShadow.style.display="none"}}},OnFadeOutCompleted:function(){this.Element.style.display="none"},IsResizeOperation:function(d,e,c,a){var b=true;if(d!=null&&e!=null&&c==null&&a==null){b=false}return b},SetElementDimension:function(a,d,f,g,e,b){var c=true;if(d&&d.Window&&d.Window.DesktopManager.WindowInteractiveMode=="Shadow"){c=false}if(d&&d.Window&&IsIE8StandardMode()&&ISWinEngine.IsResizeOperation(f,g,e,b)&&!IS.IsHTML5DocType()){c=false}if(c){if(f){a.style.left=f+"px"}if(g){a.style.top=g+"px"}if(e){a.style.width=e+"px"}if(b){a.style.height=b+"px"}window.status=a.style.height}else{ISWinEngine.BlockDesktopManager(d.Window.DesktopManager);ISWinEngine.SetupShadow(d.Window,f,g,e,b)}},SetupShadow:function(win,x,y,w,h){var sh=ISWinEngine.Shadow;var dm=win.DesktopManager;var tt=ISWinEngine.ShadowInfo;if(sh==null){sh=document.createElement("DIV");sh.onselectstart=function(){return false};sh.ondragstart=function(){return false};sh.style.cssText="position: absolute; border: white 1px solid; background-color: gray;opacity: 0.5; filter: Alpha(Opacity=50); ";dm.FrameObj.appendChild(sh);ISWinEngine.Shadow=sh}if(tt==null){tt=document.createElement("DIV");tt.style.cssText="position: absolute; z-index: 254; color: white; font-family: Segoe UI, Tahoma; font-size: 9pt";tt.innerHTML="<span style='font-weight:bold'></span><br/>X: <span></span>, Y: <span></span><br/>Width: <span></span>, Height:<span></span>";dm.FrameObj.appendChild(tt);ISWinEngine.ShadowInfo=tt}if(sh.winName!=win.Name){if(IS.IsHTML5DocType()){x=win.GetWindowDivElement().offsetLeft;y=win.GetWindowDivElement().offsetTop;w=win.GetWindowDivElement().offsetWidth;h=win.GetWindowDivElement().offsetHeight;sh.winName=win.Name}else{x=win.Location.X;y=win.Location.Y;w=win.Size.Width;h=win.Size.Height;sh.winName=win.Name}}if(IS.IsHTML5DocType()){if(dm.TaskBarSettings.Position=="Top"){y+=dm.GetTaskBarElement().offsetHeight}}if(h!=null&&h<50){return}var desktopEl=dm.GetDesktopElement();if(x){x+=desktopEl.offsetLeft}if(y){y+=desktopEl.offsetTop}if(x){sh.style.left=x+"px"}if(y){sh.style.top=y+"px"}if(w){sh.style.width=w+"px"}if(h){sh.style.height=h+"px"}sh.style.zIndex=253;sh.style.display="";tt.children[0].innerText=win.Text;tt.children[2].innerText=sh.style.left;if(IS.IsHTML5DocType()&&dm.TaskBarSettings.Position=="Top"){tt.children[3].innerText=(y-dm.GetTaskBarElement().offsetHeight)+"px"}else{tt.children[3].innerText=sh.style.top}tt.children[5].innerText=sh.style.width;tt.children[6].innerText=sh.style.height;with(tt.style){left=(((sh.offsetWidth-tt.offsetWidth)/2)+sh.style.posLeft)+"px";top=(((sh.offsetHeight-tt.offsetHeight)/2)+sh.style.posTop)+"px";display=""}},OnMouseOperationEnd:function(win,frameEl,mode){if(win!=null){var isPhysical=null;if(IsIE8StandardMode()&&mode=="Resize"){isPhysical=false}if((isPhysical==false||win.DesktopManager.WindowInteractiveMode=="Shadow")&&ISWinEngine.Shadow!=null){var sh=ISWinEngine.Shadow;var dm=win.DesktopManager;var tt=ISWinEngine.ShadowInfo;var lvo=ISWinEngine.LastValidObject;var lmo=ISWinEngine.LastMovedObject;if(mode=="Move"){if(lmo==null){return}if(lmo!=null&&!lmo.Moved){return}lmo.Moved=false}if(mode=="Resize"){if(lvo==null){return}if(lvo!=null&&!lvo.Resized){return}lvo.Resized=false}sh.winName=null;sh.style.display="none";tt.style.display="none";var desktopEl=dm.GetDesktopElement();if(IS.IsHTML5DocType()){if(dm.TaskBarSettings.Position=="Top"){with(frameEl.style){left=(parseFloat(sh.style.left)-desktopEl.offsetLeft)+"px";top=(parseFloat(sh.style.top)-desktopEl.offsetTop-dm.GetTaskBarElement().offsetHeight)+"px";width=sh.style.width;height=sh.style.height}}else{with(frameEl.style){left=(parseFloat(sh.style.left)-desktopEl.offsetLeft)+"px";top=(parseFloat(sh.style.top)-desktopEl.offsetTop)+"px";width=sh.style.width;height=sh.style.height}}}else{with(frameEl.style){left=(parseFloat(sh.style.left)-desktopEl.offsetLeft)+"px";top=(parseFloat(sh.style.top)-desktopEl.offsetTop)+"px";width=sh.style.width;height=sh.style.height}}if(IsIE8StandardMode()&&win!=null){WebDMEngine.FixIEWindowSize(win,true)}if(win.EnableDropShadow&&win.DropShadow!=null){win.DropShadow.UpdatePosition()}win.SaveLocationAndSize();ISWinEngine.UnblockDesktopManager(dm)}else{if(IsIE8StandardMode()&&!IS.IsHTML5DocType()){win.GetContentDivElement().children[0].style.display="none"}if(win.IFrameContentBlocker){win.IFrameContentBlocker.style.display="none"}if(IsIE8StandardMode()&&!IS.IsHTML5DocType()){setTimeout(function(){win.GetContentDivElement().children[0].style.display=""},0)}WebDMEngine.DispatchWindowResize()}}},OnMouseMove:function(){var k=event;var m=false;if(k){ISWinEngine.Event=null}else{k=ISWinEngine.Event}var f=k.srcElement;var I=k.clientX;var J=k.clientY;if(!event){f=k.FrameElement;I+=ISPosLib.getLeft(f)+ISPosLib.getScrollLeft(f.ownerDocument);J+=ISPosLib.getTop(f)+ISPosLib.getScrollTop(f.ownerDocument);if(k.IsChildFrame){J+=ISWinEngine.GetParentFrameTop(null,k);I+=ISWinEngine.GetParentFrameLeft(null,k)}m=true}else{if(IS.moz&&event.view.name!=""){var G=k.FrameElement;if(IS.moz&&IsGecko18Up()&&G!=null){f=G;I+=ISPosLib.getLeft(f);J+=ISPosLib.getTop(f)}}if(!f.ownerDocument){return null}J+=ISPosLib.getScrollTop(f.ownerDocument)}if(f){if(!ISWinEngine.IsMouseDown){if(m){return}var q=ISWinEngine.GetNearestInteractiveObject(f);if(q){if(q&&q.Enabled){if(q.Resizable){var j=ISPosLib.getTop(q.FrameElement);var h=ISPosLib.getLeft(q.FrameElement);var g=j+ISPosLib.getHeight(q.FrameElement);var i=h+ISPosLib.getWidth(q.FrameElement);var n=ISWinEngine.LastValidObject;if(n!=null&&n!=q){ISWinEngine.ResetLastCursorObject();ISWinEngine.LastValidObject=null}if(J>=j&&J<j+7){if(I>=h&&I<h+20){if(n&&ISWinEngine.LastCursorPart=="UpperLeft"){return}f.style.cursor="nw-resize";ISWinEngine.LastCursorPart="UpperLeft"}else{if(I<=i+2&&I>i-20){if(n&&ISWinEngine.LastCursorPart=="UpperRight"){return}f.style.cursor="ne-resize";ISWinEngine.LastCursorPart="UpperRight"}else{if(n&&ISWinEngine.LastCursorPart=="Upper"){return}f.style.cursor="n-resize";ISWinEngine.LastCursorPart="Upper"}}q._CursorElement=f;ISWinEngine.LastValidObject=q}else{if(I>=h&&I<h+5&&J<g-4){var n=ISWinEngine.LastValidObject;if(n&&ISWinEngine.LastCursorPart=="Left"){return}f.style.cursor="w-resize";q._CursorElement=f;ISWinEngine.LastValidObject=q;ISWinEngine.LastCursorPart="Left"}else{if(I<=i+2&&I>i-4&&J<g-4){var n=ISWinEngine.LastValidObject;if(f.id==""&&q&&q.Window&&q.Window.DesktopManager.WindowSettings.BorderType=="ComplexImages"){f=f.parentElement}if(f.currentStyle.overflow=="visible"||IS.moz){if(n&&ISWinEngine.LastCursorPart=="Right"){return}f.style.cursor="w-resize";q._CursorElement=f;ISWinEngine.LastValidObject=q;ISWinEngine.LastCursorPart="Right"}}else{if(J<=g+1&&J>g-4){if(I>=h&&I<h+10){if(n&&ISWinEngine.LastCursorPart=="BottomLeft"){return}f.style.cursor="ne-resize";ISWinEngine.LastCursorPart="BottomLeft"}else{if(I<=i+2&&I>i-10){if(n&&ISWinEngine.LastCursorPart=="BottomRight"){return}f.style.cursor="nw-resize";ISWinEngine.LastCursorPart="BottomRight"}else{var n=ISWinEngine.LastValidObject;if(n&&ISWinEngine.LastCursorPart=="Bottom"){return}f.style.cursor="n-resize";ISWinEngine.LastCursorPart="Bottom"}}q._CursorElement=f;ISWinEngine.LastValidObject=q}else{ISWinEngine.ResetLastCursorObject()}}}}}else{ISWinEngine.ResetLastCursorObject();ISWinEngine.LastValidObject=null}}else{ISWinEngine.ResetLastCursorObject();ISWinEngine.LastValidObject=null}}else{ISWinEngine.ResetLastCursorObject();ISWinEngine.LastValidObject=null}}else{var n=ISWinEngine.LastValidObject;var z=false;var H=null;if(k!=null&&!ISEvent.IsLeftButton(k)){ISWinEngine.OnMouseUp();return}if(n&&n.Window){H=n.Window}else{if(ISWinEngine.LastMovedObject&&ISWinEngine.LastMovedObject.Window){H=ISWinEngine.LastMovedObject.Window}}if(H!=null&&H.Get("ContentMode")=="UseIFrame"&&H&&H.DesktopManager.WindowInteractiveMode!="Shadow"){if(!H.IFrameContentBlocker){var E=H.GetContentDivElement().parentElement;var F=document.createElement("div");F.style.cssText="position: absolute; top:"+ISPosLib.getHeight(H.GetCaptionBarCellElement())+"px; left:0px; width:100%; height:100%; z-index: 399; opacity:0.01";F.hideFocus=true;F.innerHTML="<img width='100%' height='100%' src='"+H.DesktopManager.ResolveImagePath("blank.gif")+"' />";E.insertAdjacentElement("beforeEnd",F);H.IFrameContentBlocker=F}H.IFrameContentBlocker.style.display=""}if(n){var v=ISWinEngine.LastCursorPart;var l=n.FrameElement;var t=0;var u=0;if(n.Window){var c=n.Window.DesktopManager.GetDesktopElement();t=ISPosLib.getLeft(c);u=ISPosLib.getTop(c);ISWinEngine.ApplyIFrameEvents(n.Window)}if(v=="Upper"){if(!l.origBottom){l.origBottom=ISPosLib.getTop(l)+ISPosLib.getHeight(l)-u}var C=J-4-u;var A=l.origBottom-C;if(n.Window){if(!n.Window.IsTargetSizeValid(ISPosLib.getWidth(l),A)){var w=n.Window.GetPreferredSize(ISPosLib.getWidth(l),A);A=w.Height;C=l.style.posTop}}if(A<30){A=30;C=l.style.posTop}ISWinEngine.SetElementDimension(l,n,null,C,null,A);z=true}else{if(v=="UpperLeft"||v=="UpperRight"){if(!l.origBottom){l.origBottom=ISPosLib.getTop(l)+ISPosLib.getHeight(l)-u}if(!l.origRight){l.origRight=ISPosLib.getLeft(l)+ISPosLib.getWidth(l)-t}var C=J-4-u;var A=l.origBottom-C;var B=I-4-t;var D=l.origRight-B;if(v=="UpperRight"){D=I-ISPosLib.getLeft(l)}if(n.Window){if(!n.Window.IsTargetSizeValid(D,A)){var w=n.Window.GetPreferredSize(D,A);A=w.Height;D=w.Width}}if(A<30){A=30;C=l.style.posTop}if(D<80){D=80;B=l.style.posLeft}if(v=="UpperLeft"){if(IS.IsHTML5DocType()){if(D<parseInt(n.Window.GetWindowDivElement().style.minWidth)){D=parseInt(n.Window.GetWindowDivElement().style.minWidth);B=l.origRight-D}}}else{B=null}ISWinEngine.SetElementDimension(l,n,B,C,D,A);z=true}else{if(v=="Left"){if(!l.origRight){l.origRight=ISPosLib.getLeft(l)+ISPosLib.getWidth(l)-t}var B=I-4-t;var D=l.origRight-B;if(n.Window){if(!n.Window.IsTargetSizeValid(D,ISPosLib.getHeight(l))){var w=n.Window.GetPreferredSize(D,ISPosLib.getHeight(l));D=w.Width;B=l.style.posLeft}}if(D<80){D=80;B=l.style.posLeft}if(D<parseInt(n.Window.GetWindowDivElement().style.minWidth)){D=parseInt(n.Window.GetWindowDivElement().style.minWidth);B=l.origRight-D}if(IS.IsHTML5DocType()&&n.Window.DesktopManager.TaskBarSettings.Position=="Top"){var C=n.Window.GetWindowDivElement().style.posTop;ISWinEngine.SetElementDimension(l,n,B,C,D,null)}else{ISWinEngine.SetElementDimension(l,n,B,null,D,null)}z=true}else{if(v=="Right"){var D=I-ISPosLib.getLeft(l);if(n.Window){if(!n.Window.IsTargetSizeValid(D,ISPosLib.getHeight(l))){var w=n.Window.GetPreferredSize(D,ISPosLib.getHeight(l));D=w.Width}}if(D<80){D=80}if(IS.IsHTML5DocType()&&n.Window.DesktopManager.TaskBarSettings.Position=="Top"){var C=n.Window.GetWindowDivElement().style.posTop;ISWinEngine.SetElementDimension(l,n,null,C,D,null)}else{ISWinEngine.SetElementDimension(l,n,null,null,D,null)}z=true}else{if(v=="Bottom"){var A=J-ISPosLib.getTop(l);if(n.Window){if(!n.Window.IsTargetSizeValid(ISPosLib.getWidth(l),A)){var w=n.Window.GetPreferredSize(ISPosLib.getWidth(l),A);A=w.Height}}if(A<30){A=30}if(IS.IsHTML5DocType()&&n.Window.DesktopManager.TaskBarSettings.Position=="Top"){var C=n.Window.GetWindowDivElement().style.posTop;ISWinEngine.SetElementDimension(l,n,null,C,null,A)}else{ISWinEngine.SetElementDimension(l,n,null,null,null,A)}z=true}else{if(v=="BottomLeft"||v=="BottomRight"){if(!l.origRight){l.origRight=ISPosLib.getLeft(l)+ISPosLib.getWidth(l)-t}var A=J-ISPosLib.getTop(l);var B=I-4-t;var D=l.origRight-B;if(v=="BottomRight"){D=I-ISPosLib.getLeft(l)}if(n.Window){if(!n.Window.IsTargetSizeValid(D,A)){var w=n.Window.GetPreferredSize(D,A);A=w.Height;D=w.Width}}if(A<30){A=30}if(D<80){D=80;B=l.style.posLeft}if(v=="BottomLeft"){if(IS.IsHTML5DocType()){if(D<parseInt(n.Window.GetWindowDivElement().style.minWidth)){D=parseInt(n.Window.GetWindowDivElement().style.minWidth);B=l.origRight-D}}}else{B=null}if(IS.IsHTML5DocType()&&n.Window.DesktopManager.TaskBarSettings.Position=="Top"){var C=n.Window.GetWindowDivElement().style.posTop;ISWinEngine.SetElementDimension(l,n,B,C,D,A)}else{ISWinEngine.SetElementDimension(l,n,B,null,D,A)}z=true}}}}}}if(z){if(n.Window){if((IS.moz)&&n.Window.Get("ContentMode")=="UseIFrame"){var a=n.Window.GetWindowIFrameElement().parentElement.parentElement;if(IsGecko18Up()){a=a.children[0]}a.style.display="none"}n.Resized=true;n.Window.SaveLocationAndSize();var b=n.Window.DesktopManager;if(b.WindowInteractiveMode!="Shadow"){if(n.Window.EnableDropShadow&&n.Window.DropShadow!=null){n.Window.DropShadow.UpdatePosition()}}ISEvent.Raise(b.ClientSideEvents.OnWindowResized,b.Id,n.Window,"interactive")}}}else{var q=null;if(ISWinEngine.LastMovedObject==null){q=ISWinEngine.GetNearestInteractiveObject(f)}else{q=ISWinEngine.LastMovedObject}if(q&&q.Enabled&&q.Movable){var p=true;var e=null;if(ISWinEngine.LastDragObject){e=ISWinEngine.LastDragObject;if(q.DragElement.contains(e)&&!e.nonMovable&&e.tagName!="INPUT"){p=true}else{p=false}}if(p){var l=q.FrameElement;var t=0;var u=0;var d=q.DesktopManager;var r=ISPosLib.getLeft(l);var s=ISPosLib.getTop(l);if(d){var c=d.GetDesktopElement();if(d.CreatedAtRuntime&&d.Id=="Global"){c=document.body}t=ISPosLib.getLeft(c);u=ISPosLib.getTop(c)}if(!l.parentOffsetX){l.parentOffsetX=I-r}if(!l.parentOffsetY){l.parentOffsetY=J-s}var B=I-l.parentOffsetX-t+document.body.scrollLeft;var C=J-l.parentOffsetY-u+document.body.scrollTop;if(d.WindowInteractiveMode=="Shadow"){ISWinEngine.LastMovedObject=q;if(B==r&&C==s){return}}q.Moved=true;ISWinEngine.SetElementDimension(l,q,B,C,null,null);ISWinEngine.LastMovedObject=q;if(q.Window){ISWinEngine.ApplyIFrameEvents(q.Window);if(q.Window.WindowState=="Normal"){q.Window.SaveLocationAndSize()}if(d.WindowInteractiveMode!="Shadow"){if(q.Window.EnableDropShadow&&q.Window.DropShadow!=null){q.Window.DropShadow.UpdatePosition()}}var b=q.Window.DesktopManager;ISEvent.Raise(b.ClientSideEvents.OnWindowMoved,b.Id,q.Window)}}}}}}},OnMouseDown:function(){var a=event.srcElement;var c=ISWinEngine.GetNearestInteractiveObject(a,true);var d=false;if(c){if(c.DragElement.contains(a)){d=true;if(c.Window){if(a.tagName=="SPAN"||a.tagName=="IMG"){a.nonMovable=true}}}}if(IS.ie11){if(!ISEvent.IsLeftButton(event)||a.nonMovable||c==null){return}}else{if(event.button!=ISEvent.LEFT||a.nonMovable||c==null){return}}ISWinEngine.IsMouseDown=true;ISWinEngine.LastDragObject=a;if(!IS.ie){if(ISWinEngine.LastValidObject!=null||ISWinEngine.LastDragObject!=null){var b=false;if(a.tagName=="TEXTAREA"||a.tagName=="SELECT"||a.tagName=="BUTTON"){b=true}if(a.tagName=="INPUT"&&a.type=="checkbox"&&a.className!="DefChkBox"){b=true}if(a.tagName=="INPUT"&&a.type=="text"){b=true}if(!b){event.cancelBubble=true;event.returnValue=false}}if(IS.MozillaMouseUpTresholdId>0){clearTimeout(IS.MozillaMouseUpTresholdId)}IS.MozillaMouseUpTreshold=false}if(IS.safari){if((ISWinEngine.LastValidObject!=null||d)&&!b){event.cancelBubble=true;event.returnValue=false}}},OnMouseUp:function(){if(!ISWinEngine.IsMouseDown){return}ISWinEngine.IsMouseDown=false;var e=ISWinEngine.LastValidObject;if(e){e.FrameElement.origBottom=null;e.FrameElement.origRight=null}if(e&&e.Window&&IS.moz){if(e.Window.Get("ContentMode")=="UseIFrame"){var a=e.Window.GetWindowIFrameElement().parentElement.parentElement;if(IsGecko18Up()){a=a.children[0]}a.style.display=""}WebDMEngine.FixMozillaWindowSize(e.Window)}if(ISWinEngine.LastMovedObject!=null){var d=ISWinEngine.LastMovedObject;var c=d.FrameElement;c.parentOffsetX=null;c.parentOffsetY=null;ISWinEngine.OnMouseOperationEnd(d.Window,d.FrameElement,"Move");ISWinEngine.LastMovedObject=null}if(e!=null&&e.Window!=null){var b=e.Window.DesktopManager;ISWinEngine.OnMouseOperationEnd(e.Window,e.FrameElement,"Resize");ISEvent.Raise(b.ClientSideEvents.OnWindowResized,b.Id,e.Window,"end")}if(IS.IsHTML5DocType()){ISWinEngine.ResetLastCursorObject()}ISWinEngine.LastDragObject=null;ISWinEngine.LastValidObject=null;if(IS.moz){ISWinEngine.MozillaMouseUpTreshold=true;ISWinEngine.MozillaMouseUpTresholdId=setTimeout(function(){ISWinEngine.MozillaMouseUpTreshold=false},1000)}},ResetLastCursorObject:function(){var a=ISWinEngine.LastValidObject;if(a!=null){var b=a._CursorElement;b.style.cursor="";ISWinEngine.LastValidObject=null}},GetValidResizableObject:function(c){for(var a=0;a<ISWinEngine.Collection.length;a++){var b=ISWinEngine.Collection[a];if(b.Resizable&&b.Enabled){if(c==b.FrameElement){return b}}}return null},GetNearestInteractiveObject:function(b,a){var b=ISWinEngine.GetNearestInteractiveElement(b,a);if(b){for(var c=0;c<ISWinEngine.Collection.length;c++){var d=ISWinEngine.Collection[c];if(b==d.FrameElement){return d}}return null}},GetNearestInteractiveElement:function(b,a){if(b.IsInteractiveObject){return b}if(a&&IS.GetAttr(b,"nonMovable")!=""){return null}while(b.parentElement!=null){var b=b.parentElement;if(a&&IS.GetAttr(b,"nonMovable")!=""){return null}if(b.IsInteractiveObject){return b}}return null},ApplyIFrameEvents:function(b){if(b&&(b.CreatedAtRuntime||IS.moz)){var a=b.DesktopManager.GetIFrameWindow(b.Name);if(a){WebDMEngine.HookIFrameEvents(b.DesktopManager,a)}}},GetParentFrame:function(a,b){if(b&&b.IsChildFrame&&IS.ie&&!IS.ie10){return b.FrameElement.document.parentWindow.frameElement}return null},GetParentFrameTop:function(a,c){if(c&&c.IsChildFrame&&IS.ie){var b=ISWinEngine.GetParentFrame(a,c);if(b){return ISPosLib.getTop(b)}}return 0},GetParentFrameLeft:function(a,c){if(c&&c.IsChildFrame&&IS.ie){var b=ISWinEngine.GetParentFrame(a,c);if(b){return ISPosLib.getLeft(b)}}return 0}};var WinRuntimeEngine={_RenderCaptionBar:function(g){if(IS.IsHTML5DocType()){var f="";var a=g.DesktopManager;var d=a.ImagesSettings.CaptionLeftInactive;var b=a.ImagesSettings.CaptionCenterInactive;var e=a.ImagesSettings.CaptionRightInactive;if(a.WindowSettings.BorderType=="ComplexImages"){f+="<div style='height:100%; width:100%; position:relative;'>";f+="<div style='position:absolute; top:0px; bottom:0px; left:0px;'>";f+="<img src='"+a.ResolveImagePath(d)+"' />";f+="</div>";f+="<div noWrap style='position:absolute; top:0px; bottom:0px; background-repeat: repeat-x; background-image:url("+a.ResolveImagePath(b)+")'>";f+=WinRuntimeEngine._RenderInnerCaptionBar(g);f+="</div>";f+="<div style='position:absolute; top:0px; bottom:0px; right:0px;'>";f+="<img src='"+a.ResolveImagePath(e)+"' />";f+="</div>";f+="</div>"}else{f+=WinRuntimeEngine._RenderInnerCaptionBar(g)}return f}else{var f="";var a=g.DesktopManager;var d=a.ImagesSettings.CaptionLeftInactive;var b=a.ImagesSettings.CaptionCenterInactive;var e=a.ImagesSettings.CaptionRightInactive;if(a.WindowSettings.BorderType=="ComplexImages"){f+="<table border=0 cellspacing=0 cellpadding=0 width='100%' height='100%'>";f+="<tr>";f+="<td>";f+="<img src='"+a.ResolveImagePath(d)+"' />";f+="</td>";f+="<td width='100%' noWrap style='background-repeat: repeat-x; background-image:url("+a.ResolveImagePath(b)+")'>";f+=WinRuntimeEngine._RenderInnerCaptionBar(g);f+="</td>";f+="<td>";f+="<img src='"+a.ResolveImagePath(e)+"' />";f+="</td>";f+="</tr>";f+="</table>"}else{f+=WinRuntimeEngine._RenderInnerCaptionBar(g)}return f}},_RenderInnerCaptionBar:function(h){if(IS.IsHTML5DocType()){var g="";var b=h.DesktopManager;var f="";if(IS.moz){f="-moz-"}else{if(IS.safari){f="-webkit-"}}g+="<div style='height:100%; width:100%; position:relative; "+f+"box-sizing: border-box;' ";g+="class="+b.WindowSettings.CaptionStyle.Normal;g+=">";if(b.WindowSettings.WindowOptionsPosition=="Left"){g+=WinRuntimeEngine._RenderWindowOptions(h,"Left")}var a=b.UseCssFramework?" ui-part='window-caption'":"";if(b.WindowSettings.WindowOptionsPosition=="Left"){g+="<div style='position:absolute; top:0px; bottom:0px; right:0px; left: 16px;'"+a+">"}else{if(b.WindowSettings.WindowOptionsPosition=="Right"){g+="<div style='position:absolute; top:0px; bottom:0px; left:0px; right: 16px;'"+a+">"}}g+="<div style='position:relative; height:100%; width:100%; text-align:"+h.DesktopManager.WindowSettings.TextAlignment.toString()+"'>";if(h.CaptionDisplayMode=="UseTemplate"){g+="<div style='height: 100%; width: 100%; position: relative; display: inline-block;'"}else{g+="<div style='height: 100%; position: relative; display: inline-block;'"}if(b.WindowSettings.BorderType=="Simple"){g+="class="+b.WindowSettings.CaptionStyle.Normal}g+=">";g+="<div style='height:100%; display:table;'>";a=b.UseCssFramework?" ui-part='window-caption-image'":"";if(b.WindowSettings.ControlBoxPosition=="Left"){if(h.Get("ControlBox")=="Yes"){g+="<div style='display: table-cell; vertical-align: middle; text-align:center;'"+a+">";var d="";var e=b.ResolveImagePath(h.Get("ControlBoxImage"));if(b.UseCssFramework){if(e==b.ResolveImagePath("")){d=" isdefault"}}else{d=" style='margin:2px;' vspace='2'"}g+="<img"+d+" src='"+e+"' align=absmiddle/>";g+="</div>"}}if(h.Get("ControlBox")=="Yes"&&b.WindowSettings.ControlBoxPosition=="Center"){g+="<div style='display: table-cell; vertical-align: middle; text-align:center;'"+a+">";g+="<img ";g+="src='"+b.ResolveImagePath(h.Get("ControlBoxImage"))+"' ";g+="style='margin: 2px;' ";g+=" />";g+="</div>"}a=b.UseCssFramework?" ui-part='window-caption-title'":"";g+="<div style='display: table-cell; vertical-align: middle; text-align: left;'"+a+">";if(h.Get("CaptionDisplayMode")=="UseTemplate"){a=b.UseCssFramework?"":"padding-left: 2px;";g+="<div style='display:block;"+a+"'></div>"}else{a=b.UseCssFramework?"":"padding-left: 2px;";g+="<div style='display:block;"+a+"'>"+h.Text+"</div>"}g+="</div>";g+="</div>";g+="</div>";g+="</div>";g+="</div>";if(b.WindowSettings.WindowOptionsPosition=="Right"){g+=WinRuntimeEngine._RenderWindowOptions(h,"Right")}g+="</div>";return g}else{var g="";var b=h.DesktopManager;g+="<table border=0 cellspacing=0 cellpadding=0 width='100%' height='100%' ";g+="class="+b.WindowSettings.CaptionStyle.Normal;g+=">";g+="<tr>";if(b.WindowSettings.WindowOptionsPosition=="Left"){g+=WinRuntimeEngine._RenderWindowOptions(h,"Left")}if(b.WindowSettings.ControlBoxPosition=="Left"){if(h.Get("ControlBox")=="Yes"){g+="<td valign=absmiddle>";g+="<img src='"+b.ResolveImagePath(h.Get("ControlBoxImage"))+"' align=absmiddle vspace=2 />";g+="</td>"}}g+="<td width='100%' noWrap valign=absmiddle align="+h.Get("TextAlignment").toLowerCase()+">";if(h.Get("ControlBox")=="Yes"&&b.WindowSettings.ControlBoxPosition=="Center"){g+="<img ";g+="src='"+b.ResolveImagePath(h.Get("ControlBoxImage"))+"' ";g+="align='"+(IS.ie?"absmiddle":"")+"' ";g+="/>";g+="&nbsp;"}if(h.Get("CaptionDisplayMode")=="UseTemplate"){}else{g+=h.Text}g+="</td>";if(b.WindowSettings.WindowOptionsPosition=="Right"){g+=WinRuntimeEngine._RenderWindowOptions(h,"Right")}g+="</tr>";g+="</table>";return g}},_RenderWindowOptions:function(d,b){if(IS.IsHTML5DocType()){var c="";var a=d.DesktopManager.UseCssFramework?" ui-part='window-captionbutton'":"";if(d.DesktopManager.WindowSettings.WindowOptionsPosition=="Right"){c+="<div style='position:absolute; top:0px; bottom:0px; right:0px; width:16px;'";c+=a+">";c+="<div style='position:relative; height:100%; width:100%; display:table;'>";c+="<div noWrap style='display:table-cell; vertical-align:middle;'>";c+=WinRuntimeEngine._RenderWindowOptionsBox(d);c+="</div>";c+="</div>";c+="</div>"}else{if(d.DesktopManager.WindowSettings.WindowOptionsPosition=="Left"){c+="<div style='position:absolute; top:0px; bottom:0px; left:0px; width:16px;'";c+=">";c+="<div style='position:relative; height:100%; width:100%; display:table;'>";c+="<div noWrap style='display:table-cell; vertical-align:middle;'>";c+=WinRuntimeEngine._RenderWindowOptionsBox(d);c+="</div>";c+="</div>";c+="</div>"}}return c}else{var c="<td noWrap valign=absmiddle ";if(IS.moz){c+="width=100 align="+b}c+=">";c+=WinRuntimeEngine._RenderWindowOptionsBox(d);c+="</td>";return c}},_RenderWindowOptionsBox:function(h){var g="";var a=h.DesktopManager;var e=a.ImagesSettings.MinimizeInactive;var d=a.ImagesSettings.MaximizeInactive;var f=a.ImagesSettings.RestoreInactive;var b=a.ImagesSettings.CloseInactive;if(IS.opera||IS.safari||IsGecko30()){if(e==""){e="webdings_0.gif"}if(d==""){d="webdings_1.gif"}if(b==""){b="webdings_r.gif"}}if(a.WindowSettings.WindowOptionsPosition=="Right"){if(h.Get("AllowMinimize")=="Yes"){g+=WinRuntimeEngine._RenderMinimizeButton(a,e);g+=WinRuntimeEngine._RenderOptionSpace(a)}if(h.Get("AllowMaximize")=="Yes"){g+=WinRuntimeEngine._RenderMaximizeButton(a,d);g+=WinRuntimeEngine._RenderOptionSpace(a)}if(h.Get("AllowClose")=="Yes"){g+=WinRuntimeEngine._RenderCloseButton(a,b)}}else{if(h.Get("AllowClose")=="Yes"){g+=WinRuntimeEngine._RenderCloseButton(a,b);g+=WinRuntimeEngine._RenderOptionSpace(a)}if(h.Get("AllowMinimize")=="Yes"){g+=WinRuntimeEngine._RenderMinimizeButton(a,e);g+=WinRuntimeEngine._RenderOptionSpace(a)}if(h.Get("AllowMaximize")=="Yes"){g+=WinRuntimeEngine._RenderMaximizeButton(a,d)}}return g},_RenderMinimizeButton:function(b,d){if(IS.IsHTML5DocType()){var a=b.UseCssFramework?"button-type='minimize'":"";var e="<span type='Min' ";e+="style='display: inline-block;' ";e+="title='"+b.TextSettings.MinimizeText+"' ";e+="class='"+b.WindowSettings.CaptionButtonStyle.Normal+"' ";e+=a+">";if(d==""){e+="<font face='Webdings'>";e+="<span style='position:relative; top:-2px'>";e+="0";e+="</span>";e+="</font>"}else{e+="<img src='"+b.ResolveImagePath(d)+"' align=absmiddle />"}e+="</span>";return e}else{var e="<span type='Min' ";e+="title='"+b.TextSettings.MinimizeText+"' ";e+="class='"+b.WindowSettings.CaptionButtonStyle.Normal+"' ";e+=">";if(d==""){e+="<font face='Webdings'>";e+="<span style='position:relative; top:-2px'>";e+="0";e+="</span>";e+="</font>"}else{e+="<img src='"+b.ResolveImagePath(d)+"' align=absmiddle />"}e+="</span>";return e}},_RenderOptionSpace:function(a){if(IS.IsHTML5DocType()){var b="<span style='width:"+a.WindowSettings.CaptionButtonSpacing+"px;";if(IS.moz){b+="display:-moz-inline-box"}else{b+="display:inline-block"}b+="'></span>";return b}else{var b="<span style='width:"+a.WindowSettings.CaptionButtonSpacing+"px;";if(IS.moz){b+="display:-moz-inline-box"}else{if(!IS.ie){b+="display:inline-block"}}b+="'></span>";return b}},_RenderMaximizeButton:function(b,d){if(IS.IsHTML5DocType()){var a=b.UseCssFramework?"button-type='maximize'":"";var e="<span type='Max' ";e+="style='display: inline-block;' ";e+="title='"+b.TextSettings.MaximizeText+"' ";e+="class='"+b.WindowSettings.CaptionButtonStyle.Normal+"' ";e+=a+">";if(d==""){e+="<font face='Webdings'>";e+="<span style='position:relative; top:-2px'>";e+="1";e+="</span>";e+="</font>"}else{e+="<img src='"+b.ResolveImagePath(d)+"' align=absmiddle />"}e+="</span>";return e}else{var e="<span type='Max' ";e+="title='"+b.TextSettings.MaximizeText+"' ";e+="class='"+b.WindowSettings.CaptionButtonStyle.Normal+"' ";e+=">";if(d==""){e+="<font face='Webdings'>";e+="<span style='position:relative; top:-2px'>";e+="1";e+="</span>";e+="</font>"}else{e+="<img src='"+b.ResolveImagePath(d)+"' align=absmiddle />"}e+="</span>";return e}},_RenderCloseButton:function(b,d){if(IS.IsHTML5DocType()){var a=b.UseCssFramework?"button-type='close'":"";var e="<span type='Close' ";e+="style='display: inline-block;' ";e+="title='"+b.TextSettings.CloseText+"' ";e+="class='"+b.WindowSettings.CaptionButtonStyle.Normal+"' ";e+=a+">";if(d==""&&!b.UseCssFramework){e+="<font face='Webdings'>";e+="<span style='position:relative; top:-2px'>";e+="r";e+="</span>";e+="</font>"}else{e+="<img src='"+b.ResolveImagePath(d)+"' align=absmiddle />"}e+="</span>";return e}else{var e="<span type='Close' ";e+="title='"+b.TextSettings.CloseText+"' ";e+="class='"+b.WindowSettings.CaptionButtonStyle.Normal+"' ";e+=">";if(d==""){e+="<font face='Webdings'>";e+="<span style='position:relative; top:-2px'>";e+="r";e+="</span>";e+="</font>"}else{e+="<img src='"+b.ResolveImagePath(d)+"' align=absmiddle />"}e+="</span>";return e}},_RenderContentBar:function(e){var d="";var a=e.DesktopManager;var b="";if(IS.moz){b="-moz-"}else{if(IS.safari){b="-webkit-"}}if(a.WindowSettings.BorderType!="ComplexImages"){d+="<div class="+a.WindowSettings.ContainerStyle}else{d+="<div class="+a.WindowSettings.WindowStyle.Normal}d+=" style='position:relative; height: 100%; width: 100%;"+b+"box-sizing: border-box; ";if(e.Get("ContentMode")=="UseIFrame"){d+="overflow:hidden;"}if(a.WindowSettings.IgnoreIFramePadding&&e.Get("ContentMode")=="UseIFrame"){d+="padding:0px;"}d+="'";d+=">";d+="<div style='width:100%; height:100%;";if(IS.IsHTML5DocType()&&!a.UseCssFramework){d+="padding: 1px; "+b+"box-sizing: border-box; "}d+="' ";if(a.WindowSettings.ApplyContainerStyle==true&&a.WindowSettings.BorderType=="ComplexImages"){d+="class="+a.WindowSettings.ContainerStyle}d+=" >";if(e.Get("ContentMode")=="UseIFrame"||e.ContentURL!=""){d+="<iframe "+(a.WindowSettings.IFrameAllowTransparency?"allowtransparency='true'":"")+" frameborder=0 ";if(!a.UseCssFramework){d+=" style='width:100%; height:100%; position:relative; "}if(a.WindowSettings.IFrameShowLoader&&!IS.moz){d+="display:none;"}d+="'";d+=" name='"+e.Name+"'";d+=">";d+="</iframe>"}d+="</div>";d+="</div>";return d}};function ISDropShadow(){this.Margin=35;this.Owner=null;this.ImageFolder="images/";this.Element=null;this.ParentElement=null;this.Container=null;this.Create=function(){var div=document.createElement("div");var html="<table width='100%' height='100%' cellspacing='0' cellpadding='0' style='table-layout: fixed'><colgroup>    <col width='73' />    <col width='100%' />    <col width='73' /></colgroup><tr height='71'>    <td style='background-image: url("+this.ImageFolder+"shadow_1.png); background-repeat: no-repeat'>&nbsp;</td>    <td style='background-image: url("+this.ImageFolder+"shadow_2.png); background-repeat: repeat-x'>&nbsp;</td>    <td style='background-image: url("+this.ImageFolder+"shadow_3.png); background-repeat: no-repeat'>&nbsp;</td></tr><tr>    <td style='background-image: url("+this.ImageFolder+"shadow_4.png); background-repeat: repeat-y'>&nbsp;</td>    <td style='background-image: url("+this.ImageFolder+"shadow_fill.png);'>&nbsp;</td>    <td style='background-image: url("+this.ImageFolder+"shadow_5.png); background-repeat: repeat-y'>&nbsp;</td></tr><tr height='71'>    <td style='background-image: url("+this.ImageFolder+"shadow_6.png); background-repeat: no-repeat'>&nbsp;</td>    <td style='background-image: url("+this.ImageFolder+"shadow_7.png); background-repeat: repeat-x'>&nbsp;</td>    <td style='background-image: url("+this.ImageFolder+"shadow_8.png); background-repeat: no-repeat'>&nbsp;</td></tr></table>";div.style.display="none";div.style.direction="ltr";div.style.zIndex=1;div.innerHTML=html;this.Element=div;if(this.Container==null){document.body.insertAdjacentElement("afterBegin",div)}else{this.Container.insertAdjacentElement("afterBegin",div)}};this.AttachTo=function(o){if(this.Element==null){this.Create()}var zIndex=parseFloat(o.style.zIndex);if(!isNaN(zIndex)&&this.Container!=null){this.Element.style.zIndex=zIndex}this.ParentElement=o;this.UpdatePosition()};this.Show=function(){this.Element.style.display=""};this.Hide=function(){this.Element.style.display="none"};this.Destroy=function(){this.Hide();if(this.Element!=null){this.Element.removeNode(true);this.Element=null}};this.UpdatePosition=function(){var div=this.Element;var o=this.ParentElement;var l=ISPosLib.getLeft(o)-this.GetContainerLeft();var t=ISPosLib.getTop(o)-(!IS.ie?ISPosLib.getScrollTop(document):0)-this.GetContainerTop();var w=ISPosLib.getWidth(o);var h=ISPosLib.getHeight(o);if(IsIE7StandardMode()){h=o.scrollHeight}with(div.style){position="absolute";left=(l-this.Margin)+"px";top=(t-this.Margin)+"px";width=(w+(this.Margin*2))+"px"}div.style.height=(h+(this.Margin*2))+"px";if(IsIE7StandardMode()){var height=parseFloat(div.style.height);var middleHeight=0;if(height>142){middleHeight=height-142}div.children[0].rows[1].style.height=middleHeight+"px"}if(!isNaN(div.style.zIndex)){var zIndex=parseFloat(o.style.zIndex);if(!isNaN(zIndex)&&this.Container!=null){this.Element.style.zIndex=zIndex}}};this.GetContainerLeft=function(){if(this.Container==null){return 0}else{if(this.Container.style.position=="relative"){return ISPosLib.getLeft(this.Container)}}return 0};this.GetContainerTop=function(){if(this.Container==null){return 0}else{if(this.Container.style.position=="relative"){return ISPosLib.getTop(this.Container)}}return 0}};