function InitWebNavPane(a){var b=WebNavPaneEngine.Create(a);b.OnControlInitialized()}function InitWebNavPaneProperties(a){var c=IS.GetRuntimeObjectById(a);WebNavPaneEngine.AssignNavbarProperties(c);var b=new UnitSize();b.Width=c.FrameObj.offsetWidth;b.Height=c.FrameObj.offsetHeight;c.CachedSize=b;if(c.OnInitialize!=""){if(!ISEvent.Raise(c.OnInitialize,c.Id,c.Id)){return}}}function WebNavPane(a){this.ClassName="WebNavPane";this.Version="1.5.2006";this.BuildNumber="0";this.MajorVersion="1.0";this.RequiredFrameworkVersion="2.0.5000.10";ISControl.call(this,a);this.Id=a;this.NavType="Outlook2003";this.BarItems=new ISArray();this.ActiveBarIndex=0;this.FrameStyle=null;this.GripStyle=null;this.AllowResize=true;this.AutoPostBack=false;this.BarItemSettings=new WebNavPaneItemSettings();this.BarSettings=new WebNavBarSettings();this.FooterSettings=new WebNavPaneFooterSettings();this.BarVisible=-1;this.ImagesDirectory="/CommonLibrary/Images/WebDesktop/";this.OnBarClick="";this.OnBarItemClick="";this.OnPaneResize="";this.OnInitialize="";this.OnClientUnload="";this.CausesValidation=true;this.ValidationGroup="";this.BarCursor="";this.GripCursor="";this.WebResourceIdentifier="D";this.RenderAsListBox=false;this.ReBindingPostBackData=function(){this.Set("ActiveBarIndex",this.ActiveBarIndex,true);this.Set("BarVisible",this.BarItems.length-WebNavPaneEngine.NumberOfCollapse(this),true);for(var c=0;c<this.BarItems.length;c++){var b=this.BarItems[c];b.Set("Collapse",b.Collapse,true);b.Set("Visible",b.Visible,true);b.Set("ActiveBarItemIndex",b.ActiveBarItemIndex,true)}};this.ResolveImagePath=function(b){return this._ResolveImagePath(this.ImagesDirectory,b)};this.__setter=function(c,d,b){return WebNavPaneEngine.__setter(this,c,d,b)};this.GetCaptionElement=function(){return document.getElementById(this.Id+"_captionbar")};this.GetItemsContainerElement=function(){return document.getElementById(this.Id+"_navbaritems")};this.GetGripElement=function(){return document.getElementById(this.Id+"_grip")};this.GetFooterElement=function(){return document.getElementById(this.Id+"_footer")};this.Unload=function(){if(this.OnClientUnload!=""){if(!ISEvent.Raise(this.OnClientUnload,this.Id)){return}}WebNavPaneEngine.onUnload(this)};this.OnControlInitialized=function(){this.BarItems.ReindexPosition();for(var c=0;c<this.BarItems.length;c++){var b=this.BarItems[c];if(b.Get("ContentMode")=="UseItems"&&b.Items.length>0){b.Items.ReindexPosition()}}};this.GetActiveBar=function(){return this.BarItems[this.ActiveBarIndex]};this.SetActiveBar=function(d){if(d<this.BarItems.length&&d>=0){this.ActiveBarIndex=d;var b=this.GetActiveBar();WebNavPaneEngine.HideAllItemsPlaceholders(this);WebNavPaneEngine.SelectedNavBar(this,b);var c=this.GetCaptionElement();if(IS.IsHTML5DocType()){c.children[0].children[0].innerHTML=b.Text;c.children[0].style.cssText+=b.CaptionCustomRules}else{c.innerText=(b.CaptionText==""?b.Text:b.CaptionText);c.style.cssText="; "+b.CaptionCustomRules}var e=b.GetItemsContainerElement();e.style.display=""}};this.AddBar=function(o){this.BarItems.Add(o);this.BarItems.UpdateChanges();var r=WebNavPaneEngine.CreateNavBarElement(this,o);if(IS.IsHTML5DocType()){if(this.GetControlElement().border!="0"){if(r.style.borderBottom==""){r.style.borderBottomColor=wnp.GetControlElement().borderColor;r.style.borderBottomStyle="solid";r.style.borderBottomWidth="1px"}}}o.HtmlObj=r;var d=this.GetFooterElement();this.HtmlObj.childNodes[0].insertBefore(r.parentNode,d.parentNode);r.parentNode.style.display="";var l=this.GetItemsContainerElement();var e=0;if(IS.IsHTML5DocType()&&IS.ie){if(!IS.ie11){var n=l.children.length;var m=l.children[0].style.height;var h=m.split(" ");var f=h[2].split("",3);var g=f.join("");e=parseInt(g)+31;var b=1;if(this.GetControlElement().border=="0"){b=0}e=e+b;for(var j=0;j<l.children.length;j++){l.children[j].style.height="calc(100% - "+e.toString()+"px)"}}}var c=document.createElement("DIV");c.id=this.Id+"_"+o.Name.replace(/ /ig,"_")+"_items";c.align=o.ItemSettings.Get("Alignment");c.className=o.ItemSettings.Get("ItemsContainerStyle");if(IS.IsHTML5DocType()&&IS.ie){if(!IS.ie11){c.style.height="calc(100% - "+e.toString()+"px)";var k=document.createElement("DIV");if(l.style.padding==""){k.style.margin="4px"}else{k.style.margin=c.style.padding}c.style.padding="0px";c.style.display="none"}}var p=document.createElement("TABLE");p.border=0;p.cellPadding=3;p.cellSpacing=0;p.style.cssText="border-collapse:collapse";if(!IS.IsHTML5DocType()){var q=document.createElement("TBODY");p.appendChild(q)}if(IS.IsHTML5DocType()&&IS.ie){if(!IS.ie11){k.appendChild(p);c.appendChild(k)}}else{var q=document.createElement("TBODY");p.appendChild(q);c.appendChild(p)}l.appendChild(c);Listener.Add(o.HtmlObj,"onclick",WebNavPaneEngine.OnNavbarClickHandler,o);WebNavPaneEngine.AssignNavbarProperties(this)};this.OnResize=function(){WebNavPaneEngine.onResize(this.Id)}}function WebNavBar(){this._Type="WebNavBar";ISObject.call(this);this.Name="";this.Index=0;if(IS.IsHTML5DocType()&&IS.ie){this.Size=31}else{this.Size=30}this.Text="";this.Image="";this.ImageSize="";this.BarStyle=null;this.ToolTip="";this.Visible=true;this.Enabled=true;this.Collapse=false;this.CaptionDisplayMode="Default";this.CaptionStyle=null;this.CaptionCustomRules="";this.Items=new ISArray();this.ActiveBarItemIndex=0;this.ContentMode="Default";this.ContentURL="";this.IFrameContentLoaded=false;this.ItemSettings=new WebNavBarItemSettings();this.TopClientY=0;this.CaptionText="";this.GetActiveBarItem=function(){return this.Items[this.ActiveBarItemIndex]};this.__setter=function(b,c,a){return WebNavPaneEngine.__setter(this,b,c,a)};this.__getter=function(a){switch(a){case"ContentMode":return this.GetDefault(a);break;case"Image":return this.GetDefault(a);break;case"ImageSize":return this.GetDefault(a);break;case"CaptionDisplayMode":return this.GetDefault(a);break}};this.GetDefault=function(a){if(this[a]=="Default"||this[a]==""){return this.Parent.BarSettings[a]}else{return this[a]}};this.OnPropertiesInitialized=function(e){var f=this.Parent.BarItems.XmlNode.ownerDocument;var d=ISXml.GetNode(this.Parent.BarItems.XmlNode,"//BarItems");if(e=="OnAdd"){var c=ISXml.CreateNode(f,d,"WebNavBar","");ISXml.SetAttribute(c,"Name",this.Name);ISXml.SetAttribute(c,"Text",this.Text);ISXml.SetAttribute(c,"Collapse",this.Collapse);var b=ISXml.CreateNode(f,c,"ItemSettings","");var a=ISXml.CreateNode(f,c,"Items","")}};this.GetItemsContainerElement=function(){return document.getElementById(this.Parent.Id+"_"+this.Name.replace(/ /ig,"_")+"_items")};this.GetIFrameElement=function(){var a=this.GetItemsContainerElement();return a.children[0]};this.GetImageElement=function(){return document.getElementById("imgbar_"+this.Parent.Id+"_"+this.Name.replace(/ /ig,"_"))};this.GetTextElement=function(){return document.getElementById("txtbar_"+this.Parent.Id+"_"+this.Name.replace(/ /ig,"_"))};this.GetElement=function(){return document.getElementById(this.Parent.Id+"_"+this.Name.replace(/ /ig,"_"))};this.GetFooterElement=function(){return document.getElementById("btm_"+this.Parent.Id+"_"+this.Name.replace(/ /ig,"_"))};this.IsActive=function(){if(this.Parent.ActiveBarIndex==this.Index){return true}return false};this.SetCaption=function(a){var b=this.Parent.GetCaptionElement();this.CaptionText=a;this.Text=a;if(this.IsActive()){if(IS.IsHTML5DocType()){b.children[0].children[0].innerText=a}else{b.innerText=a}}this.GetTextElement().innerText=a};this.SetImage=function(a){var b=this.GetImageElement();this.Image=a;b.childNodes[0].src=a};this.SetDisable=function(){var b=this.GetElement();var a=this.GetFooterElement();this.Enabled=false;if(b){b.disabled=true;if(this.Parent.UseCssFramework){b.setAttribute("disabled","")}}if(a){a.disabled=true;if(this.Parent.UseCssFramework){a.setAttribute("disabled","")}}};this.SetEnable=function(){var b=this.GetElement();var a=this.GetFooterElement();this.Enabled=true;b.disabled=false;if(b){b.disabled=true;if(this.Parent.UseCssFramework){b.removeAttribute("disabled")}}if(a){a.disabled=true;if(this.Parent.UseCssFramework){a.removeAttribute("disabled")}}};this.SetActive=function(){this.Parent.SetActiveBar(this.Index)};this.SetVisible=function(c){var b=this.GetElement();var a=this.GetFooterElement();this.Visible=c;if(c==true){if(b){b.parentNode.style.display=""}if(a){a.style.display=""}}else{if(c==false){if(!this.Collapse){this.Parent.BarVisible-=1}if(this.Parent.ActiveBarIndex>this.Index){this.Parent.ActiveBarIndex-=1}if(b){b.parentNode.style.display="none"}if(a){a.style.display="none"}}}WebNavPaneEngine.AssignNavbarProperties(this.Parent)};this.Click=function(){var a=this.GetElement();if(this.Collapse){a=this.GetFooterElement()}if(a){if(IS.moz||IS.safari){window.setTimeout(function(){a.fireEvent("onclick")},10)}else{a.fireEvent("onclick")}}};this.AddBarItem=function(c){this.Items.Add(c);this.Items.UpdateChanges();if(c.Parent==null){c.Parent=this}var a=this.GetItemsContainerElement();var d=a.children[0];var e=d.childNodes[0];var g=document.createElement("TR");var f=document.createElement("TD");f.id=this.Parent.Id+"_"+this.Name.replace(/ /ig,"_")+"_"+c.Name.replace(/ /ig,"_");var b=document.createElement("IMG");b.align="absmiddle";b.src=c.Image;if(c.Get("DisplayMode")=="TextAndImage"){if(c.Get("ImagePosition")=="AboveText"){b.style.display="block"}f.appendChild(b);f.innerHTML+="&nbsp;"+c.Text}else{if(c.Get("DisplayMode")=="Text"){f.innerText=c.Text}else{if(c.Get("DisplayMode")=="Image"){f.appendChild(b)}}}g.appendChild(f);e.appendChild(g);WebNavPaneEngine.SetItemStyleNormal(f,this.Parent);Listener.Add(f,"onclick",WebNavPaneEngine.onBarItemClickHandler,c)};this.ItemSettings.Parent=this}function WebNavBarItem(){this._Type="WebNavBarItem";ISObject.call(this);this.Name="";this.Index=0;this.Text="";this.Image="";this.ImageSize=0;this.ToolTip="";this.Enabled=true;this.DisplayMode="Default";this.ImagePosition="Default";this.Visible=true;this.TargetURL="";this.TargetWindow="";this.__getter=function(a){switch(a){case"ImagePosition":return this.GetDefault(a);break;case"DisplayMode":return this.GetDefault(a);break}};this.GetDefault=function(a){if(this[a]=="Default"){return this.Parent.Parent.BarItemSettings[a]}else{return this[a]}};this.GetElement=function(){if(this.Parent){return document.getElementById(this.Parent.Parent.Id+"_"+this.Parent.Name.replace(/ /ig,"_")+"_"+this.Name.replace(/ /ig,"_"))}};this.IsActive=function(){if(this.Parent.ActiveBarItemIndex==this.Index){return true}return false};this.Click=function(){var a=this.GetElement();if(a){setTimeout(function(){a.fireEvent("onclick")},10)}}}function WebNavBarSettings(){this.CaptionStyle=null;this.BarStyle=null;this.CaptionDisplayMode="Text";this.ContentMode="UseItems";this.ImageSize="22px";if(IS.IsHTML5DocType()&&IS.ie){this.Size="31px"}else{this.Size="30px"}this.Image=""}function WebNavPaneItemSettings(){this.Alignment="Left";this.ItemContainerStyle=null;this.ItemStyle=null;this.DisplayMode="Text";this.ImagePosition="BesideText";this.ImageSize="16px";this.TargetWindow=""}function WebNavBarItemSettings(){this._Type="WebNavBarItemSettings";ISObject.call(this);this.Alignment="Default";this.ItemContainerStyle=null;this.ItemStyle=null;this.DisplayMode="Default";this.ImagePosition="Default";this.ImageSize="";this.TargetWindow="";this.__getter=function(a){switch(a){case"Alignment":return this.GetDefault(a);break;case"ItemsContainerStyle":return this.GetDefault(a);break}};this.GetDefault=function(a){if(this[a]=="Default"||this[a]==null){return this.Parent.Parent.BarItemSettings[a]}else{return this[a]}}}function WebNavPaneFooterSettings(){this.ImageSize="19px"}var WebNavPaneEngine={Create:function(b){var g=new WebNavPane(b);if(IS.moz){var c=document.getElementById(g.Id+IS.FrameSuffix);c.style.overflow="hidden";if(IS.moz){c.style.MozBoxSizing="border-box"}}if(IS.IsHTML5DocType()&&IS.ie){var d=document.getElementById(g.Id+IS.FrameSuffix);d.style.overflow="hidden";d.style.boxSizing="border-box"}WebNavPaneEngine.AssignProperties(g);WebNavPaneEngine.AssignBehavior(g);if(!g.UseCssFramework){var a=IS.GetCssObject(g.Id,g.FrameStyle);var e=document.getElementById(g.Id);var f=parseFloat(a.borderWidth);if(!isNaN(f)){e.border=a.borderWidth}else{e.border=1}e.borderColor=a.borderColor}return g},AssignProperties:function(c){var b=ISXml.GetNode(c.XmlDt,"//WebNavPane");if(b!=null){if(typeof(IS_ReleaseType)!="undefined"&&IS_ReleaseType=="Beta"){c.ImagesDirectory="/CommonLibraryBeta/Images/WebDesktop/"}IS.SetPropertiesRecursive(c,b);if(c.GetGripElement()){if(IS.IsHTML5DocType){var a=c.GetGripElement().children[0]}else{var a=c.GetGripElement()}c.GripStyle=DynamicStyleEngine.Assign(b.selectSingleNode("GripStyle"),a);c.GripCursor=c.GripStyle.Active.Cursor;if(c.GripCursor=="NotSet"||c.GripCursor==""){c.GripCursor="n-resize"}}c.BarSettings.BarStyle=DynamicStyleEngine.Assign(b.selectSingleNode("BarSettings/BarStyle"));c.BarCursor=c.BarSettings.BarStyle.Normal.Cursor;if(c.BarCursor=="NotSet"||c.BarCursor==""){c.BarCursor="default"}c.BarItemSettings.ItemStyle=DynamicStyleEngine.Assign(b.selectSingleNode("BarItemSettings/ItemStyle"))}},AssignBehavior:function(k){var d=k.Id;var b=k.GetGripElement();Listener.Add(k.HtmlObj,"onmouseover",function(){WebNavPaneEngine.onMouseOver(d)});Listener.Add(k.HtmlObj,"onmouseout",function(){WebNavPaneEngine.onMouseOut(d)});Listener.Add(document,"onmouseup",WebNavPaneEngine.onMouseUpHandler);Listener.Add(document,"onmousemove",WebNavPaneEngine.onMouseMoveHandler);Listener.Add(k.FrameObj,"onresize",function(){WebNavPaneEngine.onResize(d)});if(!k.RenderAsListBox){Listener.Add(b,"onmousedown",function(){WebNavPaneEngine.onMouseDownHandler(d)});Listener.Add(k.GetFooterElement(),"onclick",function(){WebNavPaneEngine.onClickHandler(d)})}if(IS.moz){Listener.Add(window,"onresize",function(){WebNavPaneEngine.onResize(d)})}for(var c=0;c<k.BarItems.length;c++){var h=k.BarItems[c];if(h.Visible){if(!k.RenderAsListBox){if(!h.Collapse){h.HtmlObj=h.GetElement();Listener.Add(h.HtmlObj,"onclick",WebNavPaneEngine.OnNavbarClickHandler,h)}else{var a=h.GetFooterElement();if(a){a.title=(h.ToolTip==""?h.Text:h.ToolTip)}}}if(h.Get("ContentMode")=="UseItems"){for(var g=0;g<h.Items.length;g++){var e=h.Items[g];if(e.Visible){var f=e.GetElement();Listener.Add(f,"onclick",WebNavPaneEngine.onBarItemClickHandler,e)}}}}}window.attachEvent("onunload",function(){WebNavPaneEngine.onUnload(k)})},AssignNavbarProperties:function(h,g){if(!h||!h.BarItems){return}var f=h.BarItems.length;for(var b=0;b<h.BarItems.length;b++){var e=h.BarItems[b];if(e.Visible==false){f--}}var b=f-1;var d=h.BarItems.length;while(d>0){var a=h.GetFooterElement();var e=h.BarItems[d-1];d--;if(e.Visible&&a!=null){e.TopClientY=ISPosLib.getTop(a)-((e.Size)*(f-b));b--}if(!h.UseCssFramework&&(IS.moz||IS.chrome)){var c=e.GetItemsContainerElement();c.style.height="1px";c.style.height=c.parentNode.clientHeight+"px"}}},__setter:function(d,b,c,a){switch(b){default:d[b]=c;break}},RenderBarStyle:function(a,c,b){if(b.IsActive()){a.className=c.BarSettings.BarStyle.Active}else{a.className=c.BarSettings.BarStyle.Normal}},ClearBarStyle:function(a){a.className=""},SetBarStyle:function(a,c,b){c.BarSettings.BarStyle.Object=a;if(b.IsActive()){c.BarSettings.BarStyle.SetToActive()}else{c.BarSettings.BarStyle.SetToNormal()}},SetBarStyleNormal:function(a,b){b.BarSettings.BarStyle.Object=a;b.BarSettings.BarStyle.SetToNormal()},SetBarStyleActive:function(a,b){b.BarSettings.BarStyle.Object=a;b.BarSettings.BarStyle.SetToActive()},SetBarStyleOver:function(a,b){b.BarSettings.BarStyle.Object=a;b.BarSettings.BarStyle.SetToOver()},SetItemStyle:function(a,d,c,b){d.BarItemSettings.ItemStyle.Object=a;if(b.IsActive()){d.BarItemSettings.ItemStyle.SetToActive()}else{d.BarItemSettings.ItemStyle.SetToNormal()}},SetItemStyleNormal:function(a,b){b.BarItemSettings.ItemStyle.Object=a;b.BarItemSettings.ItemStyle.SetToNormal()},SetItemStyleActive:function(a,b){b.BarItemSettings.ItemStyle.Object=a;b.BarItemSettings.ItemStyle.SetToActive()},SetItemStyleOver:function(a,b){b.BarItemSettings.ItemStyle.Object=a;b.BarItemSettings.ItemStyle.SetToOver()},CreateNavBarElement:function(j,b){var i=document.createElement("TR");var e=document.createElement("TD");e.id=j.Id+"_"+b.Name.replace(/ /ig,"_");e.width="100%";e.height=b.Size+"px";if(j.UseCssFramework){e.setAttribute("ui-part","navbar-bar")}if(!b.Enabled){e.setAttribute("disabled","")}if(IS.IsHTML5DocType()&&IS.ie){if(!IS.ie11){if(j.GetControlElement().border!="0"){if(e.style.borderBottom==""){e.style.borderBottomColor=j.GetControlElement().borderColor;e.style.borderBottomStyle="solid";e.style.borderBottomWidth="1px"}}}}var c=document.createElement("TABLE");c.border=0;c.width="100%";c.height="100%";c.cellPadding=5;c.cellSpacing=0;c.style.cssText="border-collapse:collapse; height:100%;";var d=document.createElement("TBODY");var h=document.createElement("TR");var g=document.createElement("TD");g.id="txtbar_"+j.Id+"_"+b.Name.replace(/ /ig,"_");g.title=b.ToolTip;WebNavPaneEngine.RenderBarStyle(g,j,b);g.innerText=b.Text;var f=document.createElement("TD");f.id="imgbar_"+j.Id+"_"+b.Name.replace(/ /ig,"_");f.title=b.ToolTip;WebNavPaneEngine.RenderBarStyle(f,j,b);var a=document.createElement("IMG");a.align="absmiddle";a.src=b.Image;f.appendChild(a);if(b.Get("CaptionDisplayMode")=="TextAndImage"){f.width=j.BarSettings.ImageSize;f.align="center";h.appendChild(f);h.appendChild(g)}else{if(b.Get("CaptionDisplayMode")=="Text"){g.colspan=2;h.appendChild(g)}else{if(b.Get("CaptionDisplayMode")=="Image"){f.colspan=2;h.appendChild(f)}}}d.appendChild(h);c.appendChild(d);e.appendChild(c);i.appendChild(e);i.style.display="none";return e},onResize:function(b){var f=ISGetObject(b);var e=f.CachedSize;if(!f.UseCssFramework&&IS.moz){for(var a=f.BarItems.length-1;a>=0;a--){var d=f.BarItems[a];var c=d.GetItemsContainerElement();c.style.height="1px"}}else{if(IS.ie&&!IS.IsHTML5DocType()){if(f.FrameObj.parentElement!=null){f.FrameObj.style.height=f.FrameObj.parentElement.clientHeight+"px"}f.FrameObj.style.height="100%"}}if(e!=null){if(IS.moz||(f.FrameObj.offsetWidth!=e.Width&&f.FrameObj.offsetHeight!=e.Height)){e=null;WebNavPaneEngine.AssignNavbarProperties(f,true);if(typeof(WebPaneManager)=="function"){setTimeout(function(){WebNavPaneEngine.AssignNavbarProperties(f,true)},50)}}}if(e==null){e=new UnitSize();e.Width=f.FrameObj.offsetWidth;e.Height=f.FrameObj.offsetHeight;f.CachedSize=e}},onMouseOver:function(q){var l=window.event.srcElement;var o=l.id;var m=l.parentElement;var n=m.id;var p=ISGetObject(q);if(p){if(WebNavPaneEngine.__gripClicked==false){if(o==q+"_grip"||o==q+"_grip_image"||n==q+"_grip"||n==q+"_grip_image"){if(IS.IsHTML5DocType){p.GripStyle.Object=p.GetGripElement().children[0]}else{p.GripStyle.Object=p.GetGripElement()}p.GripStyle.SetToOver();return}var d=event.srcElement;while(d!=null){var e=false;for(var f=0;f<p.BarItems.length;f++){var a=p.BarItems[f];var c="txtbar_"+p.Id+"_"+a.Name.replace(/ /ig,"_");var b="imgbar_"+p.Id+"_"+a.Name.replace(/ /ig,"_");if(d.tagName=="TD"&&(d.id==c||d.id==b)){if(!a.IsActive()){WebNavPaneEngine.SetBarStyleOver(a.GetImageElement(),p);WebNavPaneEngine.SetBarStyleOver(a.GetTextElement(),p)}e=true;break}if(d.tagName=="TD"&&d.id=="btm_"+p.Id+"_"+a.Name.replace(/ /ig,"_")){if(!a.IsActive()){WebNavPaneEngine.SetBarStyleOver(d,p)}e=true;break}if(a.IsActive()){for(var k=0;k<a.Items.length;k++){var g=a.Items[k];var h=p.Id+"_"+a.Name.replace(/ /ig,"_")+"_"+g.Name.replace(/ /ig,"_");if(d.tagName=="TD"&&!g.IsActive()&&d.id==h){WebNavPaneEngine.SetItemStyleOver(g.GetElement(),p);e=true;break}}}}if(e){break}d=d.parentElement}}}},onMouseOut:function(q){var l=window.event.srcElement;var o=l.id;var m=l.parentElement;var n=m.id;var p=ISGetObject(q);if(p){if(WebNavPaneEngine.__gripClicked==false){if(o==q+"_grip"||o==q+"_grip_image"||n==q+"_grip"||n==q+"_grip_image"){if(IS.IsHTML5DocType){p.GripStyle.Object=p.GetGripElement().children[0]}else{p.GripStyle.Object=p.GetGripElement()}p.GripStyle.SetToNormal();return}var d=event.srcElement;while(d!=null){var e=false;for(var f=0;f<p.BarItems.length;f++){var a=p.BarItems[f];var c="txtbar_"+p.Id+"_"+a.Name.replace(/ /ig,"_");var b="imgbar_"+p.Id+"_"+a.Name.replace(/ /ig,"_");if(d.tagName=="TD"&&(d.id==c||d.id==b)){WebNavPaneEngine.SetBarStyle(a.GetImageElement(),p,a);WebNavPaneEngine.SetBarStyle(a.GetTextElement(),p,a);e=true;break}if(d.tagName=="TD"&&d.id=="btm_"+p.Id+"_"+a.Name.replace(/ /ig,"_")){if(a.IsActive()){WebNavPaneEngine.SetBarStyleActive(d,p)}else{WebNavPaneEngine.ClearBarStyle(d)}e=true;break}if(a.IsActive()){for(var k=0;k<a.Items.length;k++){var g=a.Items[k];var h=p.Id+"_"+a.Name.replace(/ /ig,"_")+"_"+g.Name.replace(/ /ig,"_");if(d.tagName=="TD"&&d.id==h){WebNavPaneEngine.SetItemStyle(g.GetElement(),p,a,g);e=true;break}}}}if(e){break}d=d.parentElement}}}},__gripClicked:false,__id:null,__lastClientY:0,__lastIdxBarUp:0,__lastIdxBarDown:0,__lastNumOfCollapse:-1,__IFrame:null,GetIFrame:function(a){var c=null;var b;for(b=0;b<a.childNodes.length;b++){c=a.childNodes[b];if(c.nodeName=="IFRAME"){return c}}},AttachEventIFrame:function(e,d){if(d){var c=d.GetItemsContainerElement();var b=WebNavPaneEngine.GetIFrame(c);if(b){WebNavPaneEngine.__IFrame=b;var a=b.contentWindow.document;a.body.attachEvent("onmousemove",WebNavPaneEngine.onIFrameMouseMoveHandler);a.body.attachEvent("onmouseup",WebNavPaneEngine.onIFrameMouseUpHandler)}}},DetachEventIFrame:function(e,d){if(d){var c=d.GetItemsContainerElement();var b=WebNavPaneEngine.GetIFrame(c);if(b){WebNavPaneEngine.__IFrame=b;var a=b.contentWindow.document;a.body.detachEvent("onmousemove",WebNavPaneEngine.onIFrameMouseMoveHandler);a.body.detachEvent("onmouseup",WebNavPaneEngine.onIFrameMouseUpHandler)}}},HideAllItemsPlaceholders:function(e){var c=null;var b=document.getElementById(e.Id+"_navbaritems");for(var a=0;a<b.childNodes.length;a++){var d=b.childNodes[a];if(d.style.display!="none"){c=d;d.style.display="none";break}}return c},onBarItemClickHandler:function(){var a=this;var e=a.Parent.Parent;var c=a.Parent;var d="_blank";if(a.Enabled==true){if(e.OnBarItemClick!=""){if(!ISEvent.Raise(e.OnBarItemClick,e.Id,a)){return}}var b=c.ActiveBarItemIndex;WebNavPaneEngine.SelectedNavBarItem(e,a);if(e.AutoPostBack){WebNavPaneEngine.OnBarItemPostbackClick(a,b)}if(a.TargetWindow!=""){d=a.TargetWindow}else{if(a.Parent.ItemSettings.TargetWindow!=""){d=a.Parent.ItemSettings.TargetWindow}else{if(e.BarItemSettings.TargetWindow!=""){d=e.BarItemSettings.TargetWindow}}}if(a.TargetURL!=""){window.open(a.TargetURL,d)}}},OnBarItemPostbackClick:function(b,c){var d=b.Parent;var e=d.Parent;var a="'NavbarItemClick'";a+="\03'"+b.Name+"'";a+="\03"+c+"\03"+d.ActiveBarItemIndex;if(WebNavPaneEngine.ShouldPerformValidation(e)){__doPostBack(e.ServerUniqueID,a)}},onClickHandler:function(f){var e=null;if(IS.IsAvailableRuntimeObjectById(f)){e=IS.GetRuntimeObjectById(f)}var c=WebNavPaneEngine.TraverseElementInsideNavbar(window.event.srcElement,e);if(c&&c.Enabled==true){if(e.OnBarClick!=""){if(!ISEvent.Raise(e.OnBarClick,e.Id,c)){return}}var b=e.ActiveBarIndex;WebNavPaneEngine.HideAllItemsPlaceholders(e);WebNavPaneEngine.SelectedNavBar(e,c);var a=e.GetCaptionElement();if(IS.IsHTML5DocType()){a.children[0].children[0].innerHTML=c.Text;a.children[0].style.cssText+=e.GetActiveBar().CaptionCustomRules}else{a.innerText=(c.CaptionText==""?c.Text:c.CaptionText);a.style.cssText="; "+e.GetActiveBar().CaptionCustomRules}var d=c.GetItemsContainerElement();d.style.display="";if(e.AutoPostBack){WebNavPaneEngine.OnNavbarPostbackClick(c,b)}}},OnNavbarClickHandler:function(){var c=this;var e=c.Parent;if(c.Enabled==true){if(e.OnBarClick!=""){if(!ISEvent.Raise(e.OnBarClick,e.Id,c)){return}}var b=e.ActiveBarIndex;WebNavPaneEngine.HideAllItemsPlaceholders(e);WebNavPaneEngine.SelectedNavBar(e,c);var a=e.GetCaptionElement();if(IS.IsHTML5DocType()){a.children[0].children[0].innerHTML=c.Text;a.children[0].style.cssText+=e.GetActiveBar().CaptionCustomRule}else{a.innerText=(c.CaptionText==""?c.Text:c.CaptionText);a.style.cssText="; "+e.GetActiveBar().CaptionCustomRules}var d=c.GetItemsContainerElement();if(!e.UseCssFramework&&(IS.moz||IS.chrome)){d.style.height=d.parentElement.clientHeight+"px"}d.style.display="";if(e.AutoPostBack){WebNavPaneEngine.OnNavbarPostbackClick(c,b)}}},ShouldPerformValidation:function(a){var b=true;var d=!a.CausesValidation;if(a.CausesValidation){if(typeof(Page_ClientValidate)=="function"){b=Page_ClientValidate(a.ValidationGroup)}if(b){d=true}}return b},OnNavbarPostbackClick:function(c,b){var d=c.Parent;var a="'NavbarClick'";a+="\03'"+c.Name+"'";a+="\03"+b+"\03"+d.ActiveBarIndex;if(WebNavPaneEngine.ShouldPerformValidation(d)){__doPostBack(d.ServerUniqueID,a)}},SelectedNavBar:function(d,c){if(c){for(var b=0;b<d.BarItems.length;b++){var a=d.BarItems[b];if(a.Name==c.Name){WebNavPaneEngine.SetBarStyleActive(a.GetImageElement(),d);WebNavPaneEngine.SetBarStyleActive(a.GetTextElement(),d);WebNavPaneEngine.LoadContent(a);d.ActiveBarIndex=a.Index;if(a.GetFooterElement()){WebNavPaneEngine.SetBarStyleActive(a.GetFooterElement(),d)}}else{WebNavPaneEngine.SetBarStyleNormal(a.GetImageElement(),d);WebNavPaneEngine.SetBarStyleNormal(a.GetTextElement(),d);if(a.GetFooterElement()){WebNavPaneEngine.ClearBarStyle(a.GetFooterElement())}}}}},LoadContent:function(a){if(a.Get("ContentMode")=="UseIFrame"){if(!a.IFrameContentLoaded&&a.ContentURL!=""){var b=a.GetIFrameElement();b.src=a.ContentURL;a.IFrameContentLoaded=true}}},SelectedNavBarItem:function(e,b){if(b){var a=e.GetActiveBar();for(var c=0;c<a.Items.length;c++){var d=a.Items[c];if(d.Name==b.Name){WebNavPaneEngine.SetItemStyleActive(d.GetElement(),e);a.ActiveBarItemIndex=d.Index}else{WebNavPaneEngine.SetItemStyleNormal(d.GetElement(),e)}}}},TraverseElementInsideNavbar:function(a,e){for(var b=0;b<e.BarItems.length;b++){var d=e.BarItems[b];var c=a;while(c.id!=e.Id+"_footer"){if(c.id=="btm_"+e.Id+"_"+d.Name.replace(/ /ig,"_")){return d}c=c.parentElement;if(c==null){return null}}}return null},TraverseElementInsideNavbarItem:function(a,f){var e=f.GetActiveBar();if(e){for(var b=0;b<e.Items.length;b++){var c=e.Items[b];var d=a;while(d.id!=f.Id){if(d.id==f.Id+"_"+e.Name.replace(/ /ig,"_")+"_"+c.Name.replace(/ /ig,"_")){return c}d=d.parentElement;if(d==null){return null}}}}return null},onMouseDownHandler:function(e){if(IS.IsAvailableRuntimeObjectById(e)){wnp=IS.GetRuntimeObjectById(e);WebNavPaneEngine.__id=e}var b=e+"_grip";var c=e+"_grip_image";if(!IS.IsHTML5DocType){if(window.event.srcElement.id==b||window.event.srcElement.id==c){WebNavPaneEngine.__gripClicked=true;WebNavPaneEngine.__dragY=window.event.clientY;wnp.GripStyle.Object=wnp.GetGripElement();wnp.GripStyle.SetToActive();WebNavPaneEngine.AttachEventIFrame(wnp,wnp.GetActiveBar());window.event.returnValue=false;window.event.cancelBubble=true}else{WebNavPaneEngine.__gripClicked=false}}else{var a=window.event.srcElement;var d=a.parentElement;while(a.id==""){a=a.parentElement}if(a.id==b||a.id==c||d.id==b||d.id==c){WebNavPaneEngine.__gripClicked=true;WebNavPaneEngine.__dragY=window.event.clientY;wnp.GripStyle.Object=wnp.GetGripElement().children[0];wnp.GripStyle.SetToActive();WebNavPaneEngine.AttachEventIFrame(wnp,wnp.GetActiveBar());window.event.returnValue=false;window.event.cancelBubble=true}else{WebNavPaneEngine.__gripClicked=false}}},onIFrameMouseMoveHandler:function(){var c=WebNavPaneEngine.__IFrame;var b=c.contentWindow;var a=ISPosLib.getTop(c)+b.event.clientY;if(WebNavPaneEngine.__gripClicked==true){WebNavPaneEngine.CoreMouseMoveHandler(a);WebNavPaneEngine.__lastClientY=a;b.document.body.style.cursor="n-resize";b.event.returnValue=false;b.event.cancelBubble=true}},onMouseMoveHandler:function(){var a=event.clientY;if(WebNavPaneEngine.__gripClicked==true){if(IS.IsHTML5DocType()){var c=WebNavPaneEngine.__id;if(IS.IsAvailableRuntimeObjectById(c)){wnp=IS.GetRuntimeObjectById(c)}var b=WebNavPaneEngine.__dragY-a-wnp.GetFrameElement().offsetTop+wnp.GetFooterElement().clientHeight}else{var b=WebNavPaneEngine.__dragY-a}if(WebNavPaneEngine.__dragY==-2||b<-20||b>0){WebNavPaneEngine.CoreMouseMoveHandler(a);WebNavPaneEngine.__lastClientY=a;document.body.style.cursor="n-resize"}window.event.returnValue=false;window.event.cancelBubble=true}},CoreMouseMoveHandler:function(b){var m=WebNavPaneEngine.__id;var l=null;if(IS.IsAvailableRuntimeObjectById(m)){l=IS.GetRuntimeObjectById(m)}if(l.AllowResize){WebNavPaneEngine.SetNavbarCursor(l,"n-resize");WebNavPaneEngine.__dragY=-2;var g;if(WebNavPaneEngine.__lastClientY<b){g=WebNavPaneEngine.NavbarIdx(l,b);WebNavPaneEngine.__lastIdxBarDown=g}if(WebNavPaneEngine.__lastClientY>b){g=WebNavPaneEngine.NavbarIdx(l,b);g++;WebNavPaneEngine.__lastIdxBarUp=g}if(WebNavPaneEngine.__lastIdxBarUp==WebNavPaneEngine.__lastIdxBarDown+1){WebNavPaneEngine.__lastClientY=b;return}if(g>1){for(var e=0;e<=l.BarItems.length-g;e++){var h=l.BarItems[e];if(h.Visible==false){g--}}var e=0;while(e<g-1){var f=l.BarItems.length-1-e;var h=l.BarItems[f];var a=false;if(h.Visible){if(h.HtmlObj==null){a=false}else{if(h.HtmlObj.parentNode.style.display!="none"){a=true}h.HtmlObj.parentNode.style.display="none"}}e++;if(a){WebNavPaneEngine.AddToBottom(l,h)}}while(e<l.BarItems.length){var f=l.BarItems.length-1-e;var h=l.BarItems[f];var j=false;if(h.Visible){if(h.HtmlObj==null){var k=WebNavPaneEngine.CreateNavBarElement(l,h);h.HtmlObj=k;Listener.Add(h.HtmlObj,"onclick",WebNavPaneEngine.OnNavbarClickHandler,h);var d=l.GetFooterElement();l.HtmlObj.childNodes[0].insertBefore(k.parentNode,d.parentNode)}if(h.HtmlObj.parentNode.style.display=="none"){j=true}h.HtmlObj.parentNode.style.display=""}e++;if(j){WebNavPaneEngine.RemoveFromBottom(l,h)}}}else{if(g<=1){var h=l.BarItems[l.BarItems.length-1];if(h){if(h.Visible){if(h.HtmlObj==null){var k=WebNavPaneEngine.CreateNavBarElement(l,h);h.HtmlObj=k;Listener.Add(h.HtmlObj,"onclick",WebNavPaneEngine.OnNavbarClickHandler,h);var d=l.GetFooterElement();l.HtmlObj.childNodes[0].insertBefore(k.parentNode,d.parentNode)}var j=false;if(h.HtmlObj.parentNode.style.display=="none"){j=true}h.HtmlObj.parentNode.style.display="";if(j){WebNavPaneEngine.RemoveFromBottom(l,h)}}}}}var c=WebNavPaneEngine.NumberOfCollapse(l);if(WebNavPaneEngine.__lastNumOfCollapse!=c){if(l.OnPaneResize!=""){if(!ISEvent.Raise(l.OnPaneResize,l.Id,l.Id)){return}}}WebNavPaneEngine.__lastNumOfCollapse=c}},onMouseUpHandler:function(){if(WebNavPaneEngine.__gripClicked==true){WebNavPaneEngine.__gripClicked=false;WebNavPaneEngine.__lastClientY=0;WebNavPaneEngine.__lastIdxBarUp=0;WebNavPaneEngine.__lastIdxBarDown=0;WebNavPaneEngine.__lastNumOfCollapse=-1;var b=WebNavPaneEngine.__id;var a=null;if(IS.IsAvailableRuntimeObjectById(b)){a=IS.GetRuntimeObjectById(b)}if(IS.IsHTML5DocType){a.GripStyle.Object=a.GetGripElement().children[0]}else{a.GripStyle.Object=a.GetGripElement()}a.GripStyle.SetToNormal();WebNavPaneEngine.DetachEventIFrame(a,a.GetActiveBar());if(a.BarSettings.BarStyle){WebNavPaneEngine.SetNavbarCursor(a,a.BarCursor)}}WebNavPaneEngine.__id=null;document.body.style.cursor="default"},onIFrameMouseUpHandler:function(){WebNavPaneEngine.onMouseUpHandler();var b=WebNavPaneEngine.__IFrame;if(b){var a=b.contentWindow;if(a){a.document.body.style.cursor=""}}},SetNavbarCursor:function(d,c){for(var a=0;a<d.BarItems.length;a++){var b=d.BarItems[a];if(b.HtmlObj!=null){b.HtmlObj.style.cursor=c}}},NavbarIdx:function(e,a){for(var c=0;c<e.BarItems.length;c++){var d=e.BarItems[c];if(a<d.TopClientY){return c}}var b=ISPosLib.getTop(e.GetFooterElement());if(a>b){return e.BarItems.length+1}return e.BarItems.length},AddToBottom:function(r,n){var d=r.GetFooterElement();var o=d.childNodes[0];var p=document.createElement("TD");p.id="btm_"+r.Id+"_"+n.Name.replace(/ /ig,"_");p.title=(n.ToolTip==""?n.Text:n.ToolTip);if(n.Enabled==false){p.disabled=true;p.setAttribute("disabled","")}var j=document.createElement("IMG");j.align="absmiddle";j.src=r.ResolveImagePath(n.Get("Image"));j.style.width=parseFloat(r.FooterSettings.ImageSize)+"px";j.style.height=parseFloat(r.FooterSettings.ImageSize)+"px";p.appendChild(j);n.Collapse=true;if(n.IsActive()){WebNavPaneEngine.SetBarStyle(p,r,n)}var q=null;if(IS.IsHTML5DocType()){q=o.childNodes[0].childNodes[0].childNodes[0]}else{q=o.childNodes[0].childNodes[0]}if(r.UseCssFramework&&q.childNodes.length<=1){d.childNodes[0].removeAttribute("isEmpty")}var c=q.childNodes[0];q.insertBefore(p,c);if(!r.UseCssFramework&&(IS.moz|IS.chrome)){var a=r.GetActiveBar();var k=a.GetItemsContainerElement();k.style.height=k.parentNode.offsetHeight+"px"}if(IS.IsHTML5DocType()&&IS.ie){if(IS.ie11){var a=r.GetActiveBar();var k=a.GetItemsContainerElement();k.style.height=k.parentNode.offsetHeight+"px"}else{var k=r.GetItemsContainerElement();var m=k.children.length;var l=k.children[0].style.height;var g=l.split(" ");var b=1;if(r.GetControlElement().border=="0"){b=0}var e=g[2].split("",3);var f=e.join("");for(var h=0;h<k.children.length;h++){k.children[h].style.height="calc(100% - "+(parseInt(f)-n.GetElement().height-b)+"px)"}}}},RemoveFromBottom:function(o,l){var c=o.GetFooterElement();var m=c.childNodes[0];if(IS.IsHTML5DocType()){m=m.children[0]}var n=m.childNodes[0].childNodes[0];for(var g=0;g<n.childNodes.length;g++){if(n.childNodes[g].id=="btm_"+o.Id+"_"+l.Name.replace(/ /ig,"_")){n.removeChild(n.childNodes[g]);l.Collapse=false}}if(o.UseCssFramework&&n.childNodes.length<=1){c.childNodes[0].setAttribute("isEmpty","")}if(!o.UseCssFramework&&(IS.moz|IS.chrome)){var a=o.GetActiveBar();var h=a.GetItemsContainerElement();h.style.display="none";h.style.height="";h.style.height=h.parentNode.offsetHeight+"px";h.style.display=""}if(IS.IsHTML5DocType()&&IS.ie){if(IS.ie11){var a=o.GetActiveBar();var h=a.GetItemsContainerElement();h.style.display="none";h.style.height="";h.style.height=h.parentNode.offsetHeight+"px";h.style.display=""}else{var h=o.GetItemsContainerElement();var k=h.children.length;var j=h.children[0].style.height;var f=j.split(" ");var d=f[2].split("",3);var e=d.join("");var b=1;if(o.GetControlElement().border=="0"){b=0}for(var g=0;g<h.children.length;g++){h.children[g].style.height="calc(100% - "+(parseInt(e)+parseInt(l.GetElement().height)+b)+"px)"}}}},NumberOfCollapse:function(c){var a=0;for(var b=0;b<c.BarItems.length;b++){if(c.BarItems[b].Collapse==true){a++}}return a},onUnload:function(f){if(!f.ClassName){return}for(var a=0;a<f.BarItems.length;a++){var e=f.BarItems[a];if(e.HtmlObj){Listener.Unload(e.HtmlObj)}if(e.Get("ContentMode")=="UseItems"){for(var d=0;d<e.Items.length;d++){var b=e.Items[d];if(b.Visible){var c=b.GetElement();Listener.Unload(c)}}}}Listener.Unload(f.GetGripElement());Listener.Unload(f.GetFooterElement());Listener.Unload(f.HtmlObj);Listener.Unload(document);Listener.Unload(f.FrameObj);window.detachEvent("onresize",WebNavPaneEngine.AssignNavbarProperties)}};