function WebNotification(a){this.ClassName="WebNotification";this.Version="1.5.2006";this.BuildNumber="1";this.MajorVersion="1.5";this.RequiredFrameworkVersion="2.0.5000.18";ISControl.call(this,a);IFlyPostBack.call(this,"WebNotificationRequest");this.ScriptDirectory="/CommonLibrary/WebDesktop/V3_0_7200/";this.ImagesDirectory="/CommonLibrary/Images/WebDesktop/";this.Interval=5;this.DisplayLatency=5;this.IntegratedToDesktopManager=false;this.DisplayPosition="RightBottom";this.ServiceType="WebService";this.ServiceUrl="";this.DisplayMode="TextAndImage";this.ContentText="";this.ContentImage="";this.CaptionText="";this.ContentTemplate=null;this.ShowActionDropdown=false;this.ShowCloseButton=true;this.EnableSound=false;this.SoundFile="";this.AnimationStyle="Fading";this.ImagePosition="Left";this.ImageVAlign="Top";this.ImagesSettings=new WebNotificationImagesSettings();this.ClientSideEvents=new WebNotificationClientSideEvents();this.FrameStyle=null;this.CaptionStyle=null;this.ContentStyle=null;this.CommandStyle=new DynamicStyle();this.ImageSize=new UnitSize(16,16);this.IntegratedTo="None";this.ShowDelay=500;this.FadingSpeed="Slow";this.HasInitialEvent=false;if(typeof(WebMenu)!="undefined"){this.MenuStyleSettings=new WebMenuStyles();this.ActionMenu=new WebMenu();this.Menu=this.ActionMenu;this.Items=this.ActionMenu.Items}this.ViewStateStorage="PageCache";this.IsPreviewMode=false;this.ServerUniqueID="";this.Enabled=true;this.ToolTip="";this.Visible=true;this.XmlCompressionEnabled=false;this.ClientID=a;this.ID=a;this.UniqueID=a;this.NotifyWindowClickable=false;this.NotifyWindowURL="";this.NotifyWindowName="_blank";this.AutoStart=true;this.RunOnce=false;this.FPBManager=null;this.TimerID=null;this.AnimatedObj=null;this.AllNotifications=new Array();this.LastNotification=null;this.HideIntervalID=0;this.CurrentSession=null;this.CustomData="";this._Menu=null;this._NeedCreateMenuStyle=false;this._MenuOpened=false;this._Sound=null;this.WebResourceIdentifier="D";this.OnInitialize=function(){ISEvent.Raise(this.ClientSideEvents.OnInitialize,this.Id)};this.OnUnload=function(){var b=this;var f=b.GetOptionElement();var d=b.GetCloseElement();Listener.Unload(f);Listener.Unload(d);Listener.Unload(window);Listener.Unload(b.GetContentElement());Listener.Unload(b.FrameObj);if(this.IntegratedToDesktopManager){var e=b.FrameObj.removeNode(true);e=null;b.FrameObj=null}window.detachEvent("onload",function(){WebNotificationEngine.OnWindowLoad(b)})};this.OnPropertiesInitialized=function(){if(this.Events!=null){var b;for(b in this.Events){if(typeof(this.Events[b])=="string"){this.ClientSideEvents[b]=this.Events[b]}}}var c=document.getElementById(this.Id);if(c==null){c=document.getElementById(this.ServerUniqueID)}c.value="ISWebNotification"};this.Show=function(){this.FrameObj.style.display=""};this.Hide=function(){this.FrameObj.style.display="none"};this.Enable=function(){if(!this.Enabled){this.Enabled=true;if(this.TimerID>0){clearInterval(this.TimerID)}var b=this;this.TimerID=setInterval(function(){WebNotificationEngine.ProcessTimer(b)},this.Interval*1000)}};this.Disable=function(){if(this.TimerID>0){clearInterval(this.TimerID);this.TimerID=0}this.Enabled=false};this.GetFlyPostBackManager=function(){return this.FPBManager};this.Reposition=function(){return WebNotificationEngine.InitializeUI(this)};this.GetCaptionElement=function(){var b=this.GetCaptionBarElement();if(b){return b.rows[0].cells[0]}};this.SetCaptionText=function(c){var b=this.GetCaptionElement();b.innerText=c};this.GetOptionElement=function(){if(this.ShowActionDropdown){var c=this.GetCaptionBarElement();if(c){var b=c.rows[0].cells[1];return b.children[0]}}return null};this.GetCloseElement=function(){if(this.ShowCloseButton){var c=this.GetCaptionBarElement();if(c){var b=c.rows[0].cells[1];if(this.ShowActionDropdown){return b.children[2]}else{return b.children[0]}}}return null};this.GetCaptionBarElement=function(){var c=this.FrameObj;var d=c.children[0];var b=d.rows[0].cells[0];return b.children[0]};this.GetContentElement=function(){return this.FrameObj.children[0].rows[1].cells[0].children[0]};this.GetContentTextElement=function(){var b=this.GetContentElement();var d=b.children[0].rows[0];var c=0;if(this.DisplayMode=="TextAndImage"){c=1}else{if(this.DisplayMode=="Text"){c=0}}return d.cells[c].children[0]};this.GetContentImageElement=function(){var b=this.GetContentElement();var d=b.children[0].rows[0];var c=0;if(this.DisplayMode=="TextAndImage"||this.DisplayMode=="Image"){c=0}return d.cells[c].children[0]};this.GetContentTemplateElement=function(){var b=this.GetContentElement();return b.children[0].rows[0].cells[0].children[0]};this.SetContentTemplateText=function(c){var b=this.GetContentTemplateElement();b.innerHTML=c};this.SetContentText=function(c){var b=this.GetContentTextElement();b.innerText=c};this.GetCurrentNotification=function(){return this.CurrentNotification};this.GetAllNotifications=function(){return this.AllNotifications};this.GetLastNotification=function(){return this.LastNotification};this.GetMissedNotifications=function(){var b=new Array();for(var c=0;c<this.AllNotifications.length;c++){var d=this.AllNotifications[c];if(!d.Clicked){b[b.length]=d}}return b};this.GetActionMenu=function(){return this._Menu};this.Notify=function(b){WebNotificationEngine.ShowNotification(this,b)};this.GetSoundElement=function(){if(this._Sound==null){var b=document.createElement("bgsound");b.loop=1;document.body.appendChild(b);this._Sound=b}return this._Sound}}function WebNotificationEventCollection(){this.Notifications=new Array();this.HasData=false}function WebNotificationEvent(){this.ContentImage="";this.ContentText="";this.Properties=new Array();this.Shown=false;this.Clicked=false;this.CaptionText="";this.NotifyURL="";this.GetProperty=function(b){for(var a=0;a<this.Properties.length;a++){if(this.Properties[a].Key==b){return this.Properties[a]}}};this.GetPropertyValue=function(b){for(var a=0;a<this.Properties.length;a++){if(this.Properties[a].Key==b){return this.Properties[a].Value}}}}function WebNotificationEventArgs(){this.Id="";this.RawUrl="";this.CustomData=""}function Property(){this.Key="";this.Value=""}function WebNotificationClientSideEvents(){this._Type="WebNotificationClientSideEvents";ISObject.call(this);this.OnBeforeRequest="";this.OnNotify="";this.OnInitialize="";this.OnResponse="";this.OnError="";this.OnClick="";this.OnClose="";this.OnActionClick=""}function WebNotificationImagesSettings(){this._Type="WebNotificationImagesSettings";ISObject.call(this);this.CloseNormal="";this.CloseOver="";this.CloseActive="";this.ActionNormal="";this.ActionOver="";this.ActionActive=""}function InitWebNotification(d,b){var a=WebNotificationEngine.Create(d,b);a.OnInitialize()}function WebNotification_Notify(e,c,b,a,f){var d=ISGetObject(e);var g=new WebNotificationEvent();g.ContentText=c;g.ContentImage=b;g.CaptionText=a;g.NotifyUrl=f;if(d!=null){d.Notify(g)}}var WebNotificationEngine={Initialized:false,Create:function(d,b){var a=new WebNotification(d);WebNotificationEngine.AssignProperties(a);WebNotificationEngine.RegisterBehaviour(a);WebNotificationEngine.InitializeMozilla(a);WebNotificationEngine.InitializeUI(a);a.IsInit=true;if(b){a.HasInitialEvent=true}return a},AssignProperties:function(c){if(c==null){return}if(!c.IsInit){var pn=null;if(typeof(IS_ReleaseType)!="undefined"&&IS_ReleaseType=="Beta"){c.ScriptDirectory="/CommonLibraryBeta/WebDesktop/V3_0_7200/";c.ImagesDirectory="/CommonLibraryBeta/Images/WebDesktop/"}try{pn=ISXml.GetNode(c.XmlDt,"//WebNotification")}catch(e){}if(pn==null){pn=c.XmlDt.documentElement}if(pn!=null){IS.SetPropertiesRecursive(c,pn);c.CommandStyle=DynamicStyleEngine.Assign(ISXml.GetNode(c.XmlDt,"//CommandStyle"));if(c.ShowActionDropdown){if(ISXml.GetNode(pn,"//MenuStyleSettings")==null){c._NeedCreateMenuStyle=true}else{var menuStyles=["ItemStyle","DisabledItemStyle","CheckedItemStyle"];DynamicStyleEngine.AssignFromArray(c.MenuStyleSettings,c.MenuStyleSettings.XmlNode,menuStyles)}if(c._Menu==null){c._Menu=new WebContextMenu(c.Id+"_Action");c._Menu.UseCssFramework=c.UseCssFramework;c._Menu.MenuWindowType=c.MenuStyleSettings.MenuWindowType;c._Menu.RootMenu=c.ActionMenu;c._Menu.RootMenu.MenuControl=c._Menu;c._Menu.RootMenu.OffsetElement=c.GetOptionElement();c._Menu.RootMenu.OwnerControl=c;c._Menu.Items=c.Items;c._Menu.MenuStyleSettings=c.MenuStyleSettings;c._Menu.OnRootMenuClosed="WebNotificationEngine.OnMenuClosed";if(c.UseCssFramework){c._Menu.MenuWindowType="Normal"}}}c.FPBMan=new WebFlyPostBackManager(c.ServerUniqueID+"_iswnf-pb");with(c.FPBMan){ServiceType=c.ServiceType;ServiceUrl=c.ServiceUrl;ClientSideEvents.OnResponseSuccess="WebNotificationEngine.OnResponse";ClientSideEvents.OnError="WebNotificationEngine.OnError";PostViewState=false;PostInputControls=false;PostHiddenFields=false;PostControlState=false}c.FPBMan.Owner=c;if(c.AnimationStyle!="None"){c.AnimatedObj=new ISAnimatedObject();c.AnimatedObj.Element=c.FrameObj;c.AnimatedObj.OnCompleted=WebNotificationEngine.OnAnimationCompleted;c.AnimatedObj.Owner=c;c.AnimatedObj.Speed=c.FadingSpeed}}}pn=null;c=null},RegisterBehaviour:function(a){var d=a.GetOptionElement();var b=a.GetCloseElement();if(d){Listener.Add(d,"onmouseover",function(){WebNotificationEngine.OnOptionMouseOver(a,d)});Listener.Add(d,"onmouseout",function(){WebNotificationEngine.OnOptionMouseOut(a,d)});Listener.Add(d,"onmouseup",function(){WebNotificationEngine.OnOptionMouseDown(a,d)})}if(b){Listener.Add(b,"onmouseover",function(){WebNotificationEngine.OnOptionMouseOver(a,b)});Listener.Add(b,"onmouseout",function(){WebNotificationEngine.OnOptionMouseOut(a,b)});Listener.Add(b,"onmousedown",function(){WebNotificationEngine.OnOptionMouseDown(a,b)})}window.attachEvent("onload",function(){WebNotificationEngine.OnWindowLoad(a)});Listener.Add(a.GetContentElement(),"onclick",WebNotificationEngine.OnClick,a);Listener.Add(a.FrameObj,"onmouseover",WebNotificationEngine.OnMouseOver,a);Listener.Add(a.FrameObj,"onmouseout",WebNotificationEngine.OnMouseOut,a);if(!a.IntegratedToDesktopManager){Listener.Add(window,"onresize",WebNotificationEngine.OnWindowResize,a)}},OnWindowResize:function(){WebNotificationEngine.InitializeUI(this)},InitializeMozilla:function(a){if(IS.moz){}},InitializeUI:function(c){var position=c.DisplayPosition;var left=0;var top=0;var offset=null;var dm=null;if(c.IsPreviewMode){return}if(position=="Left"||position=="Top"){position="LeftTop"}if(position=="Right"||position=="Bottom"){position="RightBottom"}if(c.IntegratedToDesktopManager){dm=ISGetDesktopManager();if(dm){offset=dm.GetDesktopElement();if(!dm.UseCssFramework){WebNotificationEngine.PerformStyleTransfers(dm,c)}var desktop=dm.GetDesktopElement();var notificationFrame=c.FrameObj.removeNode(true);desktop.insertAdjacentElement("beforeEnd",notificationFrame)}else{c.FrameObj.style.display="none";c.Disable();alert("Integration Error: Cannot find WebDesktopManager instance.\nMake sure this page is hosted inside WebDesktopManager.");return}}else{offset=document.body}var height=ISPosLib.getHeight(c.FrameObj);if(c.FrameObj.OriginalHeight){height=c.FrameObj.OriginalHeight}switch(position){case"RightTop":left=offset.clientWidth-c.FrameObj.offsetWidth;top=ISPosLib.getTop(offset);break;case"RightBottom":left=offset.clientWidth-ISPosLib.getWidth(c.FrameObj)-ISPosLib.getLeft(c.FrameObj.parentElement)-4;top=ISPosLib.getTop(offset)+offset.offsetHeight-height-parseInt(ISPosLib.getTop(c.FrameObj.parentElement))-4;break;case"LeftTop":left=ISPosLib.getLeft(offset);top=ISPosLib.getTop(offset);break;case"LeftBottom":left=ISPosLib.getLeft(offset);top=ISPosLib.getTop(offset)+offset.offsetHeight-height-ISPosLib.getTop(c.FrameObj.parentElement)-4;break}with(c.FrameObj){style.position="absolute";style.left=left+"px";style.top=top+"px";if(c.AnimationStyle=="Sliding"){c.FrameObj.OriginalTop=parseFloat(top);if(!c.FrameObj.OriginalHeight){c.FrameObj.OriginalHeight=ISPosLib.getHeight(c.FrameObj)}}var n=c.GetCurrentNotification();if(n==null){style.display="none"}if(c.IntegratedToDesktopManager){style.zIndex=200}}offset=null},ResolveImagePath:function(a,b){return a.ResolveImagePath(a.ImagesDirectory,b)},OnClick:function(){if(this.NotifyWindowClickable){var b=ISEvent.Raise(this.ClientSideEvents.OnClick,this.Id);if(this.NotifyWindowURL!=""&&b){var a=this.GetCurrentNotification();a.Clicked=true;window.open(this.NotifyWindowURL,this.NotifyWindowName)}}},OnMouseOver:function(){if(this.AnimationStyle=="Fading"&&this.AnimatedObj.Type=="FadeOut"){if(this.HideIntervalID>0){clearTimeout(this.HideIntervalID);this.HideIntervalID=0}this.AnimatedObj.Stop()}},GetEvent:function(a){if(a.IntegratedToDesktopManager){var b=ISGetDesktopManager();var d=b.GetContentWindow().event;b=null;return d}else{return event}},OnMouseOut:function(){if(this.AnimationStyle=="Fading"&&this.HideIntervalID==0&&this.AnimatedObj.Type=="FadeOut"&&!this._MenuOpened){var a=this.FrameObj;var b=WebNotificationEngine.GetEvent(this);if(!a.contains(b.toElement)){WebNotificationEngine.HideNotification(this)}}},OnWindowLoad:function(a){if(a.IsPreviewMode){a.ServiceUrl="previewmode";a.Enabled=false;a.IntegratedTo="None"}if(a._NeedCreateMenuStyle){if(a.IntegratedTo=="DesktopManager"){a._Menu.SetIntegratedToDesktopManager()}else{if(a.IntegratedTo=="None"){WebNotificationEngine.CreateDefaultMenuStyles(a)}}}else{if(a._Menu!=null){a._Menu.CreateDefaultStyles()}}if(a.ServiceUrl==""&&!a.HasInitialEvent){alert(a.Id+": ServiceUrl has not been specified.\nThe control is running in disabled mode.")}if(a.Enabled&&a.Interval>0&&a.ServiceUrl!=""){var b=a;WebFlyPostBackManagerEngine.OnInitialize(a.FPBMan);if(a.AutoStart){WebNotificationEngine.ProcessTimer(b)}a.TimerID=setInterval(function(){WebNotificationEngine.ProcessTimer(b)},a.Interval*1000)}},OnOptionMouseOver:function(a,b){if(a._MenuOpened){return false}if(b.children[0].tagName=="FONT"){DynamicStyleEngine.SetToOverStyle(null,a.CommandStyle,b)}else{var d=b.attributes.type.value;if(a.ImagesSettings[d+"Over"]!=""){b.children[0].src=WebNotificationEngine.ResolveImagePath(a,a.ImagesSettings["type"+Over])}}},OnOptionMouseOut:function(a,b){if(a._MenuOpened){return false}if(b.children[0].tagName=="FONT"){DynamicStyleEngine.SetToStyle(null,a.CommandStyle,b)}else{var d=b.attributes.type.value;b.children[0].src=WebNotificationEngine.ResolveImagePath(a,a.ImagesSettings[d+"Normal"])}},OnOptionMouseDown:function(a,b){var d=b.attributes.type.value;if(b.children[0].tagName=="FONT"){DynamicStyleEngine.SetToActiveStyle(null,a.CommandStyle,b)}else{if(a.ImagesSettings[d+"Active"]!=""){b.children[0].src=WebNotificationEngine.ResolveImagePath(a,a.ImagesSettings[d+"Active"])}else{b.children[0].src=WebNotificationEngine.ResolveImagePath(a,a.ImagesSettings[d+"Normal"])}}if(d=="Action"){if(a.Items!=null){ISEvent.Raise(a.ClientSideEvents.OnActionClick,a.Id,a._Menu);a._Menu.Show();a._MenuOpened=true;if(IS.moz||IS.ie11){b.isContextMenu=true;if(b.children[0].tagName=="FONT"){b.children[0].children[0].isContextMenu=true}else{b.children[0].isContextMenu=true}if(event){event.cancelBubble=true;event.returnValue=false}}}}else{if(d=="Close"){if(a.IsPreviewMode){return}if(ISEvent.Raise(a.ClientSideEvents.OnClose,a.Id)){a.Hide();a.CurrentNotification.Shown=true;a.CurrentNotification=null;if(a.AnimationStyle!="None"&&a.AnimatedObj.IntervalId!=null&&a.AnimatedObj.IntervalId!=0){clearTimeout(a.AnimatedObj.IntervalId);a.AnimatedObj.IntervalId=0}}}}},OnMenuClosed:function(a){var b=a.OwnerControl;b._MenuOpened=false;WebNotificationEngine.OnOptionMouseOut(b,b.GetOptionElement());if(b.HideIntervalID==0){b.HideIntervalID=setTimeout(function(){WebNotificationEngine.HideNotification(b);b=null},2000)}},CreateDefaultMenuStyles:function(a){WebNotificationEngine.AssignMenuClassName(a.Id,a._Menu.MenuStyleSettings,a.UseCssFramework);a._Menu.CreateDefaultStyles()},AssignMenuClassName:function(b,a,c){if(c){a.HasBackgroundStrip=false;a.MenuWindowType="Normal";a.FrameStyle="common-menu";a.ItemStyle=new DynamicStyle("common-menu-item","common-menu-item hover","common-menu-item active");a.CheckedItemStyle=new DynamicStyle("common-menu-checkeditem","common-menu-checkeditem hover","common-menu-checkeditem active");a.DisabledItemStyle=new DynamicStyle("common-menu-item disabled","common-menu-item disabled hover","common-menu-item disabled active");a.SeparatorStyle="common-menu-separator"}else{a.FrameStyle=b+"_FrameStyle";a.ItemStyle=new DynamicStyle();a.ItemStyle.Normal=b+"_ItemStyle_Normal";a.ItemStyle.Over=b+"_ItemStyle_Over";a.CheckedItemStyle=new DynamicStyle();a.CheckedItemStyle.Normal=b+"_CheckedItemStyle_Normal";a.CheckedItemStyle.Over=b+"_CheckedItemStyle_Over";a.DisabledItemStyle=new DynamicStyle();a.DisabledItemStyle.Normal=b+"_DisabledItemStyle_Normal";a.DisabledItemStyle.Over=b+"_DisabledItemStyle_Over";a.SeparatorStyle=b+"_SeparatorStyle"}},ProcessTimer:function(b){if(b.CurrentSession==null){var a=new WebNotificationEventArgs();a.Id=b.ServerUniqueID;a.RawUrl=WebNotificationEngine.BuildUrl(window.location.toString());a.CustomData=b.CustomData;if(ISEvent.Raise(b.ClientSideEvents.OnBeforeRequest,b.Id,a)){b.FPBMan.Invoke("GetNotifications",a)}}},BuildUrl:function(a){if(a.indexOf("?")>-1){a=a.substring(0,a.indexOf("?"))}return a},ShowNotification:function(a,e){a.AllNotifications[a.AllNotifications.length]=e;a.CurrentNotification=e;a.LastNotification=e;if(!ISEvent.Raise(a.ClientSideEvents.OnNotify,a.Id,e)){return}if(a.DisplayMode=="UseTemplate"){var d=a.GetContentTemplateElement();if(typeof(e.TemplateText)!="undefined"&&e.TemplateText!=""){d.innerHTML=e.TemplateText}}else{var f=a.GetContentTextElement();f.innerText=e.ContentText;var b=a.GetContentImageElement();if(e.ContentImage!=""){b.src=WebNotificationEngine.ResolveImagePath(a,e.ContentImage);if(a.UseCssFramework){if(b.src==WebNotificationEngine.ResolveImagePath(a,"")){b.setAttribute("isdefault","")}else{b.removeAttribute("isdefault")}}}if(a.NotifyWindowClickable&&e.NotifyURL!=""){a.NotifyWindowURL=e.NotifyURL}}if(e.CaptionText!=""){a.SetCaptionText(e.CaptionText)}if(a.AnimationStyle=="None"){e.Shown=true;a.Show();a.HideIntervalID=setTimeout(function(){WebNotificationEngine.HideNotification(a)},a.DisplayLatency*1000)}else{if(a.AnimationStyle=="Fading"){a.AnimatedObj.Type="FadeIn";a.AnimatedObj.Play()}else{a.AnimatedObj.Type="MSNSlideUp";a.AnimatedObj.Play()}}},MapProperties:function(a){var g=new Array();for(var b=0;b<a.length;b++){var d=a[b];if(d.Properties!=null&&d.Properties.childNodes.length>0){for(var c=0;c<d.Properties.childNodes.length;c++){var f=d.Properties.childNodes[c];var e=new Property();e.Key=f.selectSingleNode("Key").text;e.Value=f.selectSingleNode("Value").text;g.push(e)}}}d.Properties=g},OnResponse:function(d,e,g){var b=ISGetObject(unescape(d));var a=b.Owner;if(!ISEvent.Raise(a.ClientSideEvents.OnResponse,d,g)){return}if(g!=null){var f=g;if(f.HasData){a.CurrentSession=f;if(a.EnableSound&&a.SoundFile!=""){var h=a.GetSoundElement();h.src=a.SoundFile}if(a.ServiceType=="WebService"){WebNotificationEngine.MapProperties(f.Notifications)}WebNotificationEngine.ShowNotification(a,f.Notifications[0])}}if(a.RunOnce){clearInterval(a.TimerID);a.TimerID=0}b=null;a=null},OnError:function(e,f,b){var d=ISGetObject(unescape(e));var a=d.Owner;if(unescape(b)=="web method not available"){b="GetNotifications method required by WebNotification control cannot be found at specified ServiceUrl."}else{b=unescape(b)}if(a.RunOnce){clearInterval(a.TimerID);a.TimerID=0}if(ISEvent.Raise(a.ClientSideEvents.OnError,e,b)){if(b!="null"&&b!="undefined"){alert(e+" Error: "+b)}}},OnAnimationCompleted:function(){var a=this.Owner;if(a.CurrentNotification==null){WebNotificationEngine.InvokeNextEvent(a);return}if(this.Type=="FadeIn"||this.Type=="MSNSlideUp"){a.CurrentNotification.Shown=true;a.HideIntervalID=setTimeout(function(){WebNotificationEngine.HideNotification(a)},a.DisplayLatency*1000)}else{if(!this.Canceled){a.HideIntervalID=0;a.Hide();a.CurrentNotification=null;WebNotificationEngine.InvokeNextEvent(a)}a=null}},InvokeNextEvent:function(a){var b=WebNotificationEngine.GetNextNotification(a);if(b){setTimeout(function(){WebNotificationEngine.ShowNotification(a,b);b=null},300)}else{a.CurrentSession=null}},HideNotification:function(a){if(!a._MenuOpened){if(a.AnimationStyle=="None"){a.Hide();WebNotificationEngine.InvokeNextEvent(a)}else{if(a.AnimationStyle=="Fading"){if(WebNotificationEngine.GetNextNotification(a)){a.Hide();WebNotificationEngine.InvokeNextEvent(a)}else{a.AnimatedObj.Type="FadeOut";a.AnimatedObj.Canceled=false;a.AnimatedObj.Play()}}else{if(a.CurrentNotification!=null){a.AnimatedObj.Type="MSNSlideDown";a.AnimatedObj.Play()}else{WebNotificationEngine.InvokeNextEvent(a)}}}}else{a.HideIntervalID=0}},GetNextNotification:function(a){if(a.CurrentSession!=null){for(var b=0;b<a.CurrentSession.Notifications.length;b++){if(!a.CurrentSession.Notifications[b].Shown){return a.CurrentSession.Notifications[b]}}}},PerformStyleTransfers:function(d,a){var f=[a.CaptionStyle,a.FrameStyle,a.ContentStyle,a.CommandStyle.Normal,a.CommandStyle.Over,a.CommandStyle.Active];for(var e=0;e<f.length;e++){var b=IS.GetCssObject(null,f[e],true);if(b){d.TransferStyle(b)}}}};function WebNotificationDestructor(){WebNotificationEngine=null;var a=delete WebNotificationEngine}window.attachEvent("onunload",WebNotificationDestructor);