function WebTab(a){this.ClassName="WebTab";this.Version="1.0.2006";this.BuildNumber="0";this.MajorVersion="1.0";this.RequiredFrameworkVersion="2.0.5000.10";ISControl.call(this,a);this.ActiveTabIndex=0;this.TabPages=new ISArray();this.Alignment="Left";this.EnableKeyboardNavigation=true;this.FrameStyle=null;this.TabItemStyle=null;this.TabSeparatorStyle=null;this.ContainerStyle=null;this.CaptionDisplayMode="Text";this.ImageAlignment="Left";this.DefaultTabItemWidth=80;this.DefaultTabItemHeight=20;this.Orientation="Horizontal";this.Position="Top";this.TextDirection="Horizontal";this.SizeMode="Automatic";this.RoundCornerSettings=new WebTabRoundCornerSettings();this.TrimSeparatorsWhenActive=true;this.DefaultTabSeparatorWidth=2;this.ActiveTab=null;this.ContainerDropShadow=false;this.TabItemImageStyle=null;this.AllowTextWrapping=true;this.ShowFocusBorder=false;this.ContentMode="UseInlineContent";this.IFrameAutoLoadContent=false;this.IFrameAllowTransparency=true;this.RenderMode="Simple";this.AutoPostback=false;this.AllowScrolling=false;this.AllowClose="No";this.DisabledStyle=null;this.TabSeparator=true;this.NormalTabOffset=4;this.ClientSideEvents=new WebTabClientEvents();this.ComplexImagesSettings=new WebTabComplexImagesSettings();this.ImagesSettings=new WebTabImageSettings();this.IFrameShowLoader=true;this.TextSettings=new WebTabTextSettings();this.ImagesDirectory="/CommonLibrary/Images/WebDesktop/";this.ScriptDirectory="/CommonLibrary/WebDesktop/V3_0_7200/";this.AccessKey="";this.Enabled=true;this.Visible=false;this.Height=null;this.Width=null;this.ClientID=this.Name=this.UniqueID=this.ID=a;this.AlwaysVisibleSeparator=false;this.DivFiller=null;this.FillerBorder="";this.LastKeyHandled=false;this.ScrollTimeoutID=0;this.WebResourceIdentifier="D";this.CloseIndicatorPosition="EdgeOfContainer";this.OnInitialize=function(){ISEvent.Raise(this.ClientSideEvents.OnInitialize,this.Id);this.TabPages.ReindexPosition();this.ActiveTab=this.TabPages[this.ActiveTabIndex];this.ActiveTab.IFrameLoaded=true;WebTabEngine.InitializeBorders(this);WebTabEngine.OnResize(this);if(IS.moz){WebTabEngine.InitMoz(this)}this.RemoveDynamicStyle()};this.OnPropertiesInitialized=function(){if(this.Events!=null){var b;for(b in this.Events){if(typeof(this.Events[b])=="string"){this.ClientSideEvents[b]=this.Events[b]}}}var c=document.getElementById(this.Id);c.value="ISWebTab"};this.RemoveDynamicStyle=function(){var e=["TabItem","TabItemImage"];var b=["Frame","TabSeparator","Container","Disabled"];for(var c=0;c<e.length;c++){var d=this[e[c]+"Style"];if(d){ISXml.RemoveNode(this.XmlNode,e[c]+"Style")}}for(var c=0;c<b.length;c++){this.XmlNode.removeAttribute(b[c]+"Style")}};this.ReBindingPostBackData=function(){this.Set("ActiveTabIndex",this.ActiveTabIndex,true)};this.GetContainerBorderWidth=function(){var b=this.GetTabContentDivElement();return b.currentStyle.borderTopWidth};this.GetHeaderTableElement=function(){return WebTabEngine.GetHeaderTable(this)};this.GetTabContentDivElement=function(){return WebTabEngine.GetTabContentDivElement(this)};this.GetTabItemNormalStyle=function(){var b=IS.GetCssObject(null,this.TabItemStyle.Normal);if(b){return b}};this.OnUnload=function(){WebTabEngine.UnregisterBehaviour(this)};this.GetIFrameWindow=function(b){return window.frames[b]};this.GetScrollCellElement=function(){return document.getElementById("tdScroll_"+this.Id)};this.GetScrollLeftButtonElement=function(){var b=this.GetScrollCellElement();return b.children[0].children[0]};this.GetScrollRightButtonElement=function(){var b=this.GetScrollCellElement();return b.children[0].children[1]};this.GetCloseButtonElement=function(){var b=this.GetScrollCellElement();if(this.AllowScrolling){return b.children[0].children[2]}else{return b.children[0].children[0]}};this.GetActiveTab=function(){return this.ActiveTab};this.AddNewTabItem=function(e,b,d,c,g){var f=new WebTabItem();f.Name=e;f.Text=b;f.Image=d;f.ContentURL=c;f.Tab=this;f.Collection=this.TabPages;f.ContentMode="UseIFrame";f.Index=this.TabPages.length;if(d==null){f.Image=""}if(!c){f.ContentURL=""}if(e==null||e==""){throw new Error(this.ClassName+" Exception: Name should not be null or empty.");return}else{if(this.TabPages.GetNamedItem(e)){throw new Error(this.ClassName+" Exception: Specified Name '"+e+"' already exist in TabPages collection.");return}}if(ISEvent.Raise(this.ClientSideEvents.OnCreated,this.Id,f)){WebTabEngine.RenderNewItem(f,g);this.TabPages[f.Index]=f;this.TabPages.UpdateChanges();if(g){f.SetActive()}}return f}}function WebTabClientEvents(){this._Type="WebTabClientEvents";ISObject.call(this);this.OnBeforeTabChanged="";this.OnAfterTabChanged="";this.OnInitialize="";this.OnBeforeClosed="";this.OnAfterClosed="";this.OnCreated="";this.OnScroll=""}function WebTabComplexImagesSettings(){this._Type="WebTabComplexImagesSettings";ISObject.call(this);this.AllowOverlappingEdges=false;this.UseSpecialRightSeparator=false;this.RenderDividerForActiveTab=true}function WebTabImageSettings(){this._Type="WebTabImageSettings";ISObject.call(this);this.NormalCenter="";this.NormalLeft="";this.NormalRight="";this.NormalSeparator="";this.OverLeft="";this.OverCenter="";this.OverRight="";this.ActiveLeft="";this.ActiveCenter="";this.ActiveRight="";this.SpecialRightSeparator="";this.CloseButton="";this.ScrollLeftButton="";this.ScrollRightButton="";this.ActiveLeftSeparator="";this.ActiveRightSeparator="";this.InProgress="";this.OnPropertiesInitialized=function(){if(this.InProgress==""){this.InProgress="is_progress-16.gif"}}}function WebTabItem(){this._Type="WebTabItem";ISObject.call(this);this.Name="";this.CaptionDisplayMode="Default";this.ImageAlignment="Default";this.IsEnabled=true;this.IsSeparator=false;this.Width=null;this.Style=null;this.Text="";this.Image="";this.AccessKey="";this.Tab=null;this.Index=-1;this.ToolTip="";this.ContentMode="Default";this.ContentURL="";this.AllowClose="Default";this.InProgressText="";this.Collection=null;this.Element=null;this.IFrameLoaded=false;this.IFrameContentLoaded=false;this.IsClosed=false;this.OnPropertiesInitialized=function(){this.Tab=this.Parent;this.Collection=this.Tab.TabPages};this.GetDefault=function(a){if(this[a]=="Default"){return this.Tab[a]}else{return this[a]}};this.__getter=function(a){switch(a){case"CaptionDisplayMode":case"ImageAlignment":case"ContentMode":case"AllowClose":return this.GetDefault(a);break}};this.IsActiveTab=function(){return(this.Index==this.Tab.ActiveTabIndex)};this.SetActive=function(){var a=this.Tab;if(!this.IsSeparator&&this.IsEnabled&&!this.IsActiveTab()){var b=a.ActiveTab;var d=ISEvent.Raise(a.ClientSideEvents.OnBeforeTabChanged,a.Id,a.ActiveTab,this);if(d){WebTabEngine.SetActive(this);a.ActiveTabIndex=this.Index;a.ActiveTab=this;ISEvent.Raise(this.Tab.ClientSideEvents.OnAfterTabChanged,this.Tab.Id,this);if(a.AutoPostback){__doPostBack(a.ServerUniqueID,"TabChanged:"+b.Name+","+this.Name)}}}};this.Enable=function(){var b=this.GetElement();var a=b.children[0];this.IsEnabled=true;a.disabled=false;if(this.Tab.RenderMode=="ComplexImages"){return}if(this.Tab.RenderMode=="RoundCorner"){a=b.children[b.children.length-1]}if(this.IsActiveTab()){DynamicStyleEngine.SetToActiveStyle(null,this.Tab.TabItemStyle,a)}else{DynamicStyleEngine.SetToStyle(null,this.Tab.TabItemStyle,a)}};this.Disable=function(){var c=this.GetElement();var b=c.children[0];this.IsEnabled=false;b.disabled=true;if(this.Tab.RenderMode!="ComplexImages"){var a=IS.GetCssObject(null,this.Tab.DisabledStyle);if(a){if(this.Tab.RenderMode=="Simple"){b.className=this.Tab.DisabledStyle}else{c.children[c.children.length-1].className=this.Tab.DisabledStyle}}}};this.Close=function(){WebTabEngine.CloseTab(this.Tab,this)};this.GetElement=function(){if(this.Element==null){var c=WebTabEngine.GetHeaderTable(this.Tab);var b=c.rows[0];for(var a=0;a<b.cells.length;a++){if(IS.GetAttr(b.cells[a],"name")==this.Name){this.Element=b.cells[a];break}}}return this.Element};this.GetInnerTableElement=function(){var a=this.GetElement();return a.children[0].children[0]};this.GetLeftImageElement=function(){var a=this.GetInnerTableElement();return a.rows[0].cells[0].children[0]};this.GetCenterImageCellElement=function(){var a=this.GetInnerTableElement();return a.rows[0].cells[1]};this.GetRightImageElement=function(){var a=this.GetInnerTableElement();if(a.rows[0].cells.length>2){return a.rows[0].cells[2].children[0]}return null};this.GetDivElement=function(){var b=this.GetElement();if(!this.IsSeparator){if(this.Tab.RenderMode=="ComplexImages"){var a=this.GetCenterImageCellElement();return a.children[0]}else{if(this.Tab.RenderMode=="Simple"||this.Tab.Position=="Bottom"){return b.children[0]}else{return b.children[3]}}}return null};this.SetCaption=function(a){WebTabEngine.SetCaption(this,a)};this.SetImage=function(a){WebTabEngine.SetImage(this,a)};this.SetContentURL=function(b){if(this.Get("ContentMode")=="UseIFrame"){this.ContentURL=b;this.IFrameLoaded=false;this.IFrameContentLoaded=false;if(this.Tab.IFrameShowLoader&&IS.ie){var a=this.GetTabPageIFrameElement();a.style.display="none"}this.LoadContent()}};this.IsFirstItem=function(){return(this.Index==0)};this.IsLastItem=function(){return(this.Index==this.Collection.length-1)};this.IsRightPositionFromActive=function(){return(this.Index>this.Tab.ActiveTabIndex)};this.GetLeftSeparatorElement=function(){if(!this.IsFirstItem()){var a=this.GetElement();return a.previousSibling}return null};this.GetRightSeparatorElement=function(){if(!this.IsLastItem()){var a=this.GetElement();return a.nextSibling}return null};this.GetLeftItem=function(){if(!this.IsFirstItem()){return this.Collection[this.Index-1]}return null};this.GetRightItem=function(){if(!this.IsLastItem()){return this.Collection[this.Index+1]}return null};this.GetRoundCornerDiv1=function(){var a=this.GetElement();if(this.Tab.Position=="Top"){return a.children[0]}else{return a.children[3]}};this.GetRoundCornerDiv2=function(){var a=this.GetElement();if(this.Tab.Position=="Top"){return a.children[1]}else{return a.children[2]}};this.GetRoundCornerDiv3=function(){var a=this.GetElement();if(this.Tab.Position=="Top"){return a.children[2]}else{return a.children[1]}};this.GetRoundCornerDivContent=function(){var a=this.GetElement();if(this.Tab.Position=="Top"){return a.children[3]}else{return a.children[0]}};this.GetActiveTabBackgroundColor=function(){var b=this.GetElement();if(this.Tab.RenderMode=="ComplexImages"){}else{var a=this.GetDivElement();if(a.currentStyle.filter==""||IS.moz){return a.currentStyle.backgroundColor}else{var c=a.currentStyle.filter;if(c.indexOf("endColorstr")>-1){var d=c.indexOf("endColorstr");return"#"+c.substring(d+15,d+21)}else{return a.currentStyle.backgroundColor}}}};this.GetActiveTabBorderWidth=function(){var b=this.GetElement();if(this.Tab.RenderMode=="ComplexImages"){}else{var a=this.GetDivElement();return a.currentStyle.borderLeftWidth}};this.GetTabPageElement=function(){var a=this.Tab.GetTabContentDivElement();var b=a.children[this.Index];if(!b){b=a.childNodes[this.Index]}return b};this.GetTabPageIFrameElement=function(){var a=this.GetTabPageElement();return a.children[0]};this.LoadContent=function(){if(this.Get("ContentMode")=="UseIFrame"){WebTabEngine.LoadIFrameContent(this)}};this.GetInProgressText=function(){if(this.InProgressText==""){return this.Tab.TextSettings.InProgressText}else{return this.InProgressText}};this.ScrollIntoView=function(){WebTabEngine.ScrollItemToView(this)}}function WebTabRoundCornerSettings(){this._Type="WebTabRoundCornerSettings";ISObject.call(this);this.TopBorderColor="";this.FillerBorderColor="";this.ApplyHover=true;this.OnPropertiesInitialized=function(){if(this.TopBorderColor!=""){if(this.TopBorderColor.indexOf(",")>-1){this.TopBorderColor="rgb("+this.TopBorderColor+")"}}if(this.FillerBorderColor!=""){if(this.FillerBorderColor.indexOf(",")>-1){this.FillerBorderColor="rgb("+this.FillerBorderColor+")"}}}}function WebTabTextSettings(){this._Type="WebTabTextSettings";ISObject.call(this);this.InProgressText="Loading...";this.ScrollLeftButtonTooltipText="";this.ScrollRightButtonTooltipText="";this.CloseButtonTooltipText="Close"}function InitWebTab(b){var a=WebTabEngine.Create(b);a.OnInitialize()}var WebTabEngine={Initialized:false,Create:function(b){var a=new WebTab(b);WebTabEngine.AssignProperties(a);WebTabEngine.RegisterBehaviour(a);WebTabEngine.InitializeMozilla(a);a.IsInit=true;return a},AssignProperties:function(a){if(a==null){return}if(!a.IsInit){var d=null;if(typeof(IS_ReleaseType)!="undefined"&&IS_ReleaseType=="Beta"){a.ScriptDirectory="/CommonLibraryBeta/WebDesktop/V3_0_7200/";a.ImagesDirectory="/CommonLibraryBeta/Images/WebDesktop/"}try{d=ISXml.GetNode(a.XmlDt,"//WebTab")}catch(b){}if(d==null){d=a.XmlDt.documentElement}if(d!=null){IS.SetPropertiesRecursive(a,d);a.TabItemStyle=DynamicStyleEngine.Assign(ISXml.GetNode(a.XmlDt,"//TabItemStyle"));a.TabItemImageStyle=DynamicStyleEngine.Assign(ISXml.GetNode(a.XmlDt,"//TabItemImageStyle"))}}},GetHeaderTable:function(a){var b=document.getElementById("tbHeader_"+a.Id);return b},GetTabContentDivElement:function(a){return document.getElementById("dvTabCnt_"+a.Id)},GetScrollCell:function(a){return document.getElementById("tdScroll_"+a.Id)},RegisterBehaviour:function(a){var d=WebTabEngine.GetHeaderTable(a);var b=a.FrameObj;Listener.Add(d,"onmousedown",function(){WebTabEngine.OnHeaderMouseDown(a)});Listener.Add(d,"onmouseover",function(){WebTabEngine.OnHeaderMouseOver(a)});Listener.Add(d,"onmouseout",function(){WebTabEngine.OnHeaderMouseOut(a)});Listener.Add(b,"onresize",function(){WebTabEngine.OnResize(a)});Listener.Add(b,"onkeydown",function(){WebTabEngine.OnKeyDown(a)});if(!IS.ie||IS.ie11){window.attachEvent("onresize",function(){WebTabEngine.OnResize(a)});Listener.Add(b,"onkeydown",function(){WebTabEngine.OnKeyPress(a)});b.style.MozUserFocus="normal"}if(a.AllowScrolling){Listener.Add(a.GetScrollLeftButtonElement(),"onclick",function(){WebTabEngine.Scroll(a,"left")});Listener.Add(a.GetScrollRightButtonElement(),"onclick",function(){WebTabEngine.Scroll(a,"right")})}if(a.AllowClose=="Yes"&&a.CloseIndicatorPosition=="EdgeOfContainer"){Listener.Add(a.GetCloseButtonElement(),"onclick",function(){WebTabEngine.CloseTab(a)})}if(a.GetScrollCellElement()){Listener.Add(a.GetScrollCellElement(),"onselectstart",function(){return false})}},UnregisterBehaviour:function(a){var d=WebTabEngine.GetHeaderTable(a);var b=a.FrameObj;Listener.Unload(d);Listener.Unload(b);if(a.AllowScrolling){Listener.Unload(a.GetScrollLeftButtonElement());Listener.Unload(a.GetScrollRightButtonElement())}if(a.AllowClose=="Yes"&&a.CloseIndicatorPosition=="EdgeOfContainer"){Listener.Unload(a.GetCloseButtonElement())}if(a.GetScrollCellElement()){Listener.Unload(a.GetScrollCellElement())}},InitializeMozilla:function(a){if(IS.moz){if(a.RenderMode=="RoundCorner"&&(a.RenderingMode!="HTML5"||!IS.IsHTML5DocType())){var d=a.GetHeaderTableElement();d.style.height=d.offsetHeight-2;d.style.height="100%";if(a.Position=="Top"){var b=a.FrameObj;b.children[0].rows[0].cells[0].valign="bottom"}}}},GetTabTD:function(a){while(a!=null){if(a.tagName=="TD"&&IS.GetAttr(a,"type")=="Tab"){return a}if(a.tagName=="TABLE"&&a.id.length>7&&a.id.substring(0,7)=="tbHeader"){return null}a=a.parentElement}return a},GetObjectType:function(a){var b=WebTabEngine.GetTabTD(a);if(b){if(IS.GetAttr(a,"type")=="Tab"){return"TabItem"}}},OnKeyDown:function(b){var e=event.keyCode;if(event.altKey){var d=ISKeyboardKey.GetChar(e);if(d!=""){for(var f=0;f<b.TabPages.length;f++){var g=b.TabPages[f];if(g.IsEnabled&&!g.IsSeparator&&!g.IsClosed){if(g.AccessKey==d){g.SetActive();b.LastKeyHandled=true;break}}}}}if(e==32||e==13){var h=event.srcElement;var k=WebTabEngine.GetHeaderTable(b);if(k.contains(k)&&h.tagName=="DIV"){var l=h.parentElement;var g=b.TabPages.GetNamedItem(l.name);if(g){g.SetActive();event.cancelBubble=true;event.returnValue=false;return}}}if(b.EnableKeyboardNavigation){if(event.ctrlKey&&event.altKey){var a=b.GetActiveTab();var j=null;if(e==ISKeyboardKey.LEFT){if(a.Index==0){j=b.TabPages[b.TabPages.length-1]}else{j=b.TabPages[a.Index-1]}}else{if(e==ISKeyboardKey.RIGHT){if(a.Index==b.TabPages.length-1){j=b.TabPages[0]}else{j=b.TabPages[a.Index+1]}}}if(j){j.SetActive();event.cancelBubble=true;event.returnValue=false}}}},OnKeyPress:function(a){if(IS.moz&&a.LastKeyHandled){event.cancelBubble=true;event.returnValue=false;a.LastKeyHandled=false}},OnHeaderMouseDown:function(a){var b=event.srcElement;var f=WebTabEngine.GetTabTD(b);if(f){var d=IS.GetAttr(f,"name");var e=a.TabPages.GetNamedItem(d);if(!e.IsActiveTab()&&!e.IsSeparator){e.SetActive()}if((b.tagName=="IMG"||b.tagName=="FONT")&&a.CloseIndicatorPosition=="EdgeOfTabHeader"){e.Close()}}},OnHeaderMouseOver:function(a){var d=event.srcElement;var g=WebTabEngine.GetTabTD(d);if(g){var e=IS.GetAttr(g,"name");var f=a.TabPages.GetNamedItem(e);if(!f.IsActiveTab()&&!f.IsSeparator){if(IS.moz){if(a.RenderMode=="RoundCorner"){var b=f.GetDivElement();if(b.className==a.TabItemStyle.Over){return}}}WebTabEngine.SetOver(f)}}},OnHeaderMouseOut:function(a){var b=event.srcElement;var g=event.toElement;var f=WebTabEngine.GetTabTD(b);if(f){var d=IS.GetAttr(f,"name");var e=a.TabPages.GetNamedItem(d);if(!e.IsActiveTab()&&!e.IsSeparator){if(a.RenderMode!="ComplexImages"&&e.GetDivElement().className==a.TabItemStyle.Over&&g!=null&&f.contains(g)){return}else{if(a.RenderMode=="ComplexImages"&&g!=null&&f.contains(g)){return}}WebTabEngine.SetOut(e)}}},OnResize:function(a){if(a.AllowScrolling){var d=WebTabEngine.GetHeaderTable(a);var b=d.parentElement;if(d.offsetWidth>b.offsetWidth){WebTabEngine.InvalidateCurrentScroll(a)}else{d.style.position="";d.style.left=""}WebTabEngine.InvalidateScrollRight(a);WebTabEngine.InvalidateScrollLeft(a)}},InvalidateCurrentScroll:function(a){var e=WebTabEngine.GetHeaderTable(a);var d=e.parentElement;if(e.style.position=="relative"&&e.style.posLeft<0){var b=e.style.posLeft;if(d.offsetWidth-e.offsetWidth>b){e.style.left=(d.offsetWidth-e.offsetWidth)+"px"}}},InvalidateScrollLeft:function(a){var b=a.GetScrollLeftButtonElement();var d=WebTabEngine.GetHeaderTable(a);if(d.style.posLeft<0){b.disabled=false;b.style.cursor="pointer";if(!IS.ie){b.style.color="black"}}else{b.disabled=true;b.style.cursor="default";if(!IS.ie){b.style.color="gray"}}},InvalidateScrollRight:function(a){var e=a.GetScrollRightButtonElement();var d=a.GetScrollCellElement().parentElement;var f=WebTabEngine.GetHeaderTable(a);var b=f.style.posLeft;if(typeof(b)!="number"||isNaN(b)){b=0}if(f.offsetWidth>=d.offsetWidth-b){if(IS.ie11){e.disabled=false}else{e.removeAttribute("disabled")}e.style.cursor="pointer";if(!IS.ie){e.style.color="black"}}else{e.disabled=true;e.style.cursor="default";if(!IS.ie){e.style.color="gray"}}},Scroll:function(a,d){var e=a.GetScrollCellElement().parentElement;var h=WebTabEngine.GetHeaderTable(a);var b=h.style.posLeft;if(d=="left"){var f=a.GetScrollLeftButtonElement();if(f.disabled){return}}else{var g=a.GetScrollRightButtonElement();if(g.disabled){return}if(typeof(b)!="number"||isNaN(b)){b=0}h.style.position="relative"}WebTabEngine.BeginScroll(a,e,h,d)},BeginScroll:function(a,e,f,d){var b=f.style.posLeft;if(typeof(b)!="number"||isNaN(b)){b=0}if(a.ScrollTimeoutID!=0){return}if(d=="right"){var g=(f.offsetWidth-e.offsetWidth)+b+45;if(g>e.offsetWidth){g=e.offsetWidth-50}a.ScrollTimeoutID=setTimeout(function(){WebTabEngine.ScrollAnimated(a,f,d,0,g)},10)}else{var g=0-b;if(g>e.offsetWidth){g=e.offsetWidth-50}a.ScrollTimeoutID=setTimeout(function(){WebTabEngine.ScrollAnimated(a,f,d,0,g)},10)}},ScrollAnimated:function(a,h,e,d,f){var g=f-d;var b=h.style.posLeft;if(typeof(b)!="number"||isNaN(b)){b=0}if(e=="right"){if(g>1){if(g>15){g=15}b-=g;h.style.left=b+"px";d+=15;setTimeout(function(){WebTabEngine.ScrollAnimated(a,h,e,d,f)},10)}else{WebTabEngine.InvalidateScrollLeft(a);WebTabEngine.InvalidateScrollRight(a);a.ScrollTimeoutID=0}}else{if(g>1){if(g>15){g=15}b+=g;h.style.left=b+"px";d+=15;setTimeout(function(){WebTabEngine.ScrollAnimated(a,h,e,d,f)},10)}else{WebTabEngine.InvalidateScrollLeft(a);WebTabEngine.InvalidateScrollRight(a);a.ScrollTimeoutID=0}}},CloseTab:function(a,e){var b=false;if(!e){e=a.ActiveTab;b=true;if(e.Get("AllowClose")=="No"){return}}if(e){if(ISEvent.Raise(a.ClientSideEvents.OnBeforeClosed,a.Id,e)){if(e.IsFirstItem()&&e.IsLastItem()){return}var i=e.GetElement();var h=e.GetTabPageElement();var g;var f;var d=e.IsActiveTab();if(a.RenderMode!="ComplexImages"&&a.TabSeparator&&a.TrimSeparatorsWhenActive){if(!e.IsLastItem()){i.nextSibling.removeNode(true)}else{i.previousSibling.removeNode(true)}}i.removeNode(true);h.removeNode(true);g=e.GetLeftItem();f=e.GetRightItem();e.IsClosed=true;a.TabPages.Remove(e);a.TabPages.UpdateChanges();if(d){a.ActiveTabIndex=-1;a.ActiveTab=null;if(f){f.SetActive()}else{if(g){g.SetActive()}}}if(a.AllowScrolling){WebTabEngine.InvalidateCurrentScroll(a);WebTabEngine.InvalidateScrollLeft(a);WebTabEngine.InvalidateScrollRight(a)}}ISEvent.Raise(a.ClientSideEvents.OnAfterClosed,a.Id,e)}},InitializeBorders:function(b){var a="";var f=b.GetTabContentDivElement();var p=b.GetHeaderTableElement();var q=p.rows[0];var d;if(b.UseCssFramework){return}d=IS.GetCssObject(null,f.className);if(b.Position=="Top"){a=d.borderTop;if(a==""){a=d.borderStyle+" "+d.borderColor+" "+d.borderWidth}f.style.borderTop="none"}else{a=d.borderBottom;if(a==""){a=d.borderStyle+" "+d.borderColor+" "+d.borderWidth}f.style.borderBottom="none"}if(b.RenderMode!="ComplexImages"){for(var g=0;g<q.cells.length;g++){var o=q.cells[g].style;if(b.Position=="Top"){o.borderBottom=a;if(b.RenderMode=="RoundCorner"&&IS.ie11){if(typeof(q.cells[g].attributes.type)!="undefined"){if(q.cells[g].attributes.type.value=="Tab"){o.borderBottomWidth=b.NormalTabOffset+"px"}}}}else{o.borderTop=a}if(!IS.ie){o.emptyCells="show"}}}else{var m=q.cells[q.cells.length-1];if(m.width=="100%"){if(b.Position=="Top"){m.style.borderBottom=a}else{m.style.borderTop=a}}}var n=WebTabEngine.GetScrollCell(b);if(n){n=n.children[0];if(b.Position=="Top"){n.style.borderBottom=a}else{n.style.borderTop=a}}if(b.RenderMode!="ComplexImages"){var r=b.ActiveTab.GetElement();if(b.Position=="Top"){r.style.borderBottom="none"}else{r.style.borderTop="none"}if(b.RenderMode=="RoundCorner"){for(var g=0;g<b.TabPages.length;g++){var h=b.TabPages[g];var j=h.GetRoundCornerDivContent();var l=j.parentElement;h.GetRoundCornerDiv1().style.fontSize="1px";h.GetRoundCornerDiv2().style.fontSize="1px";h.GetRoundCornerDiv3().style.fontSize="1px"}if(b.Position=="Top"){var k=ISPosLib.getHeight(p)-8;for(var g=0;g<b.TabPages.length;g++){var h=b.TabPages[g];var j=h.GetRoundCornerDivContent();var l=j.parentElement}}}else{if(IS.safari&&(b.RenderingMode!="HTML5"||!IS.IsHTML5DocType())){var e=r.children[0];e.style.height=parseFloat(r.offsetHeight)}}}if(b.RenderMode=="RoundCorner"&&b.ActiveTab){WebTabEngine.SetRoundCornerActive(b.ActiveTab)}if(IS.safari&&b.Position=="Bottom"&&(b.RenderingMode!="HTML5"||!IS.IsHTML5DocType())){p.parentElement.style.top="-11px"}b.FillerBorder=a},SetOver:function(d){var a=d.Tab;if(a.RenderMode!="ComplexImages"&&d.IsEnabled){var b=d.GetDivElement();var e=null;if(!a.UseCssFramework){e=IS.GetCssObject(null,a.TabItemStyle.Over)}if(e||a.UseCssFramework){DynamicStyleEngine.SetToOverStyle(null,a.TabItemStyle,b)}if(a.RenderMode=="RoundCorner"&&a.RoundCornerSettings.ApplyHover){if(a.ActiveTab.GetRightItem()==d){WebTabEngine.SetRoundCornerRightFromActive(d,true)}else{if(a.ActiveTab.GetLeftItem()==d){WebTabEngine.SetRoundCornerLeftFromActive(d,true)}else{WebTabEngine.SetRoundCornerActive(d)}}}}else{if(d.IsEnabled&&!d.IsActiveTab()){WebTabEngine.SetOverImages(d)}}},SetOut:function(d){var a=d.Tab;if(a.RenderMode!="ComplexImages"&&d.IsEnabled){var b=d.GetDivElement();DynamicStyleEngine.SetToStyle(null,a.TabItemStyle,b);if(a.RenderMode=="RoundCorner"&&a.RoundCornerSettings.ApplyHover){if(a.ActiveTab.GetRightItem()==d){WebTabEngine.SetRoundCornerRightFromActive(d)}else{if(a.ActiveTab.GetLeftItem()==d){WebTabEngine.SetRoundCornerLeftFromActive(d)}else{WebTabEngine.SetRoundCornerNormal(d)}}}}else{if(d.IsEnabled){WebTabEngine.SetNormalImages(d,true)}}},SetActive:function(g){var a=g.Tab;var h=a.ActiveTab;var b=g.GetDivElement();var i=g.GetElement();var d=g.GetTabPageElement();var e;if(h){e=h.GetTabPageElement()}WebTabEngine.SetActiveInternal(g);if(h){e.style.display="none"}d.style.display="";g.LoadContent();if(a.IFrameAutoLoadContent&&g.Get("ContentMode")=="UseIFrame"){var f=d.children[0];f.style.display=""}if(a.AllowScrolling){WebTabEngine.ScrollItemToView(g)}},ScrollItemToView:function(f){var a=f.Tab;var b=f.GetDivElement();var k=f.GetElement();var g=ISPosLib.getLeft(k);var l=ISPosLib.getWidth(k);var j=WebTabEngine.GetHeaderTable(a);var d=j.parentElement;var h=ISPosLib.getWidth(d);var e=false;if(g+l>h){var i=(g+l)-h;if(!f.IsLastItem()){i+=7}else{if(i<=10){return}else{i-=7}}if(j.style.position!="relative"){j.style.position="relative";j.style.left=0+"px"}j.style.left=(j.style.posLeft-i)+"px";e=true}else{if(g<0){var i=j.style.posLeft-g;if(!f.IsFirstItem()){j.style.left=(i+15)+"px"}else{j.style.left=0+"px"}e=true}}if(e&&a.AllowScrolling){WebTabEngine.InvalidateScrollLeft(a);WebTabEngine.InvalidateScrollRight(a)}return e},SetNormalInternal:function(d){var a=d.Tab;var b=d.GetDivElement();var g=d.GetElement();if(d.IsEnabled&&!d.IsSeparator&&!d.IsClosed){DynamicStyleEngine.SetToStyle(null,a.TabItemStyle,b);if(a.RenderMode=="ComplexImages"){}else{if(a.NormalTabOffset>-1){if(a.Position=="Top"||a.Position=="Left"){g.style.paddingTop=a.NormalTabOffset+"px"}else{if(a.RenderMode=="Simple"){g.style.paddingBottom=a.NormalTabOffset+"px"}else{b.style.paddingTop=""}}}if(a.Position=="Top"){g.style.borderBottom=a.FillerBorder}else{g.style.borderTop=a.FillerBorder}var e=a.TabPages[a.TabPages.length-1];if(e.IsActiveTab()){if(a.TabSeparator&&a.TrimSeparatorsWhenActive){var f=d.GetLeftSeparatorElement();if(!a.AlwaysVisibleSeparator){f.style.display="none"}b.style.borderLeftStyle="none"}}if(a.RenderMode=="RoundCorner"){if(d.GetLeftItem()==a.ActiveTab){WebTabEngine.SetRoundCornerRightFromActive(d)}else{if(d.GetRightItem()==a.ActiveTab){WebTabEngine.SetRoundCornerLeftFromActive(d)}else{WebTabEngine.SetRoundCornerNormal(d)}}if(a.Position=="Top"){b.style.borderTopStyle="none"}else{b.style.borderBottomStyle="none";b.style.height="auto"}}}}},SetActiveInternal:function(e){var a=e.Tab;var l=a.ActiveTab;var d=e.GetDivElement();var i;var t=e.GetElement();var o;if(l){i=l.GetDivElement();o=l.GetElement()}if(a.RenderMode=="ComplexImages"){if(i){DynamicStyleEngine.SetToStyle(null,a.TabItemStyle,i)}DynamicStyleEngine.SetToActiveStyle(null,a.TabItemStyle,d);if(l){WebTabEngine.SetNormalImages(l)}if(l){if(l.GetLeftItem()){WebTabEngine.SetNormalImages(l.GetLeftItem())}if(l.GetRightItem()){WebTabEngine.SetNormalImages(l.GetRightItem())}}WebTabEngine.SetActiveImages(e)}else{if(i){DynamicStyleEngine.SetToStyle(null,a.TabItemStyle,i)}DynamicStyleEngine.SetToActiveStyle(null,a.TabItemStyle,d);if(a.NormalTabOffset>-1&&!a.UseCssFramework){if(a.Position=="Top"||a.Position=="Left"){t.style.paddingTop="0px";if(o){o.style.paddingTop=a.NormalTabOffset+"px"}}else{if(a.RenderMode=="Simple"){t.style.paddingBottom="0px";if(o){o.style.paddingBottom=a.NormalTabOffset+"px"}}else{d.style.paddingTop=(a.NormalTabOffset+2)+"px";if(i){i.style.paddingTop=""}}}}if(a.TabSeparator&&a.TrimSeparatorsWhenActive&&a.RenderMode!="ComplexImages"){var q=e.GetLeftSeparatorElement();var r=e.GetRightSeparatorElement();var m;var n;var g=e.GetLeftItem();var p=e.GetRightItem();var j;var k;if(l){m=l.GetLeftSeparatorElement();n=l.GetRightSeparatorElement();j=l.GetLeftItem();k=l.GetRightItem()}if(m&&!l.IsClosed){m.style.display=""}if(n&&!l.IsClosed){n.style.display=""}if(!a.AlwaysVisibleSeparator){if(q){q.style.display="none"}if(r){r.style.display="none"}}if(i){i.style.borderRightStyle=i.style.borderLeftStyle=""}d.style.borderLeftStyle=d.style.borderRightStyle="";if(a.AlwaysVisibleSeparator!=true){if(g&&!g.IsSeparator){g.GetDivElement().style.borderRightStyle="none"}if(p&&!p.IsSeparator){p.GetDivElement().style.borderLeftStyle="none"}}if(j&&!j.IsSeparator){j.GetDivElement().style.borderRightStyle=""}if(k&&!k.IsSeparator){k.GetDivElement().style.borderLeftStyle=""}}if(!a.UseCssFramework){if(a.Position=="Top"){t.style.borderBottom="none";if(o){o.style.borderBottom=a.FillerBorder}if(a.RenderMode=="RoundCorner"&&IS.ie11){o.style.borderBottomWidth=a.NormalTabOffset+"px"}}else{t.style.borderTop="none";if(o){o.style.borderTop=a.FillerBorder}}}if(a.RenderMode=="RoundCorner"){if(l){WebTabEngine.SetRoundCornerNormal(l)}if(l){if(l.GetLeftItem()){WebTabEngine.SetRoundCornerNormal(l.GetLeftItem())}if(l.GetRightItem()){WebTabEngine.SetRoundCornerNormal(l.GetRightItem())}}WebTabEngine.SetRoundCornerActive(e);if(e.GetLeftItem()){WebTabEngine.SetRoundCornerLeftFromActive(e.GetLeftItem())}if(e.GetRightItem()){WebTabEngine.SetRoundCornerRightFromActive(e.GetRightItem())}if(l&&a.Position=="Top"){var f=l.GetRoundCornerDivContent();var s=a.GetHeaderTableElement();f.style.height=ISPosLib.getHeight(s)-8}if(a.Position=="Top"){e.GetRoundCornerDivContent().style.height=""}}else{if(IS.safari&&(a.RenderingMode!="HTML5"||!IS.IsHTML5DocType())&&!a.UseCssFramework){var b=t.children[0];var h=0;if(o){o.children[0].style.height="auto"}h=parseFloat(t.offsetHeight);b.style.height=h+"px"}}}},SetRoundCornerNormal:function(e){var b=e.Tab;var f=e.GetRoundCornerDiv1();var g=e.GetRoundCornerDiv2();var h=e.GetRoundCornerDiv3();var a=[g,h];var j=b.GetTabItemNormalStyle();f.style.backgroundColor=j.borderTopColor;f.style.marginLeft=f.style.marginRight="3px";for(var d=0;d<a.length;d++){var k=a[d].style;k.backgroundColor=j.backgroundColor;k.borderLeftColor=k.borderRightColor=j.borderTopColor;k.borderLeftStyle=k.borderRightStyle="solid";k.borderLeftWidth=k.borderRightWidth="1px";if(IS.ie){k.fontSize="1px"}}g.style.marginLeft=g.style.marginRight="2px";h.style.marginLeft=h.style.marginRight="1px";if(IS.ie){f.style.fontSize="1px"}},SetRoundCornerLeftFromActive:function(f,e){var b=f.Tab;var g=f.GetRoundCornerDiv1();var h=f.GetRoundCornerDiv2();var j=f.GetRoundCornerDiv3();var a=[g,h,j];if(e){WebTabEngine.SetRoundCornerActive(f)}else{WebTabEngine.SetRoundCornerNormal(f)}if(b.TrimSeparatorsWhenActive){for(var d=0;d<a.length;d++){var k=a[d].style;k.marginRight="0px";k.borderRightWidth="0px"}}},SetRoundCornerRightFromActive:function(f,e){var b=f.Tab;var g=f.GetRoundCornerDiv1();var h=f.GetRoundCornerDiv2();var j=f.GetRoundCornerDiv3();var a=[g,h,j];if(e){WebTabEngine.SetRoundCornerActive(f)}else{WebTabEngine.SetRoundCornerNormal(f)}if(b.TrimSeparatorsWhenActive){for(var d=0;d<a.length;d++){var k=a[d].style;k.marginLeft="0px";k.borderLeftWidth="0px"}}},SetRoundCornerActive:function(e){var b=e.Tab;var f=e.GetRoundCornerDiv1();var g=e.GetRoundCornerDiv2();var h=e.GetRoundCornerDiv3();var a=[g,h];f.style.backgroundColor=b.RoundCornerSettings.TopBorderColor;f.style.marginLeft=f.style.marginRight="3px";for(var d=0;d<a.length;d++){var j=a[d].style;j.backgroundColor=b.RoundCornerSettings.FillerBorderColor;j.borderLeftColor=j.borderRightColor=b.RoundCornerSettings.TopBorderColor;j.borderLeftStyle=j.borderRightStyle="solid";j.borderLeftWidth=j.borderRightWidth="1px";if(IS.ie){j.fontSize="1px"}}g.style.marginLeft=g.style.marginRight="2px";h.style.marginLeft=h.style.marginLeft="1px";if(IS.ie){f.style.fontSize="1px"}},SetNormalImages:function(f,e){var a=f.Tab;var g=f.GetLeftImageElement();var h=f.GetRightImageElement();var b=f.GetCenterImageCellElement();var d=a.ImagesDirectory;if(f.IsFirstItem()||!a.ComplexImagesSettings.AllowOverlappingEdges){g.src=a.ResolveImagePath(d,a.ImagesSettings.NormalLeft)}else{if(!e){g.src=a.ResolveImagePath(d,a.ImagesSettings.NormalSeparator)}}if(!a.ComplexImagesSettings.AllowOverlappingEdges||f.IsLastItem()){h.src=a.ResolveImagePath(d,a.ImagesSettings.NormalRight)}b.style.backgroundImage="url("+a.ResolveImagePath(d,a.ImagesSettings.NormalCenter)+")"},SetOverImages:function(e){var a=e.Tab;if(a.ImagesSettings.OverCenter!=""){var f=e.GetLeftImageElement();var g=e.GetRightImageElement();var b=e.GetCenterImageCellElement();var d=a.ImagesDirectory;if(e.IsFirstItem()||!a.ComplexImagesSettings.AllowOverlappingEdges){f.src=a.ResolveImagePath(d,a.ImagesSettings.OverLeft)}if(!a.ComplexImagesSettings.AllowOverlappingEdges||e.IsLastItem()){g.src=a.ResolveImagePath(d,a.ImagesSettings.OverRight)}b.style.backgroundImage="url("+a.ResolveImagePath(d,a.ImagesSettings.OverCenter)+")"}},SetActiveImages:function(f){var a=f.Tab;var g=f.GetLeftImageElement();var k=f.GetRightImageElement();var b=f.GetCenterImageCellElement();var d=a.ImagesDirectory;if(f.IsFirstItem()||!a.ComplexImagesSettings.AllowOverlappingEdges){g.src=a.ResolveImagePath(d,a.ImagesSettings.ActiveLeft)}else{g.src=a.ResolveImagePath(d,a.ImagesSettings.ActiveLeftSeparator)}if(!f.IsLastItem()&&a.ComplexImagesSettings.AllowOverlappingEdges){var m=f.GetRightItem();var h=m.GetLeftImageElement();h.src=a.ResolveImagePath(d,a.ImagesSettings.ActiveRightSeparator)}if(!a.ComplexImagesSettings.AllowOverlappingEdges||f.IsLastItem()){if(!k){var n=f.GetElement().children[0].children[0];var l=n.rows[0].insertCell(-1);l.valign="top";l.innerHTML="<img>";k=l.children[0]}k.src=a.ResolveImagePath(d,a.ImagesSettings.ActiveRight)}b.style.backgroundImage="url("+a.ResolveImagePath(d,a.ImagesSettings.ActiveCenter)+")";if(a.ComplexImagesSettings.UseSpecialRightSeparator){for(var e=f.Index+2;e<f.Collection.length;e++){var m=f.Collection[e];var j=m.GetLeftImageElement();j.src=a.ResolveImagePath(d,a.ImagesSettings.SpecialRightSeparator)}}},LoadIFrameContent:function(i){if(i.IsClosed){return}var f=i.GetTabPageIFrameElement();var j=f.parentElement;if(i.ContentURL!=""&&(f.src==""||!i.IFrameLoaded)){if(f.src!=""&&i.Tab.IFrameAutoLoadContent){i.IFrameLoaded=true;i.IFrameContentLoaded=true;return}var k=i.ContentURL;if(IS.ie11&&f.tagName.toLowerCase()=="iframe"){f.onload=function(){WebTabEngine.IFrameContentLoaded(i,true)}}f.src=k;i.IFrameLoaded=true;if(i.Tab.IFrameShowLoader&&IS.ie&&!IS.ie11){var h=i.Tab.GetIFrameWindow(f.name);var d=false;try{var g=h.document}catch(c){d=true}if(h&&f.readyState!="complete"){var j=f.parentElement;var b=document.createElement("DIV");var a=IS.GetCssObject(null,i.Tab.TabItemStyle.Normal);b.style.cssText="width:100%;height:100%;vertical-align:middle;";b.style.fontWeight=a.fontWeight;b.style.display="none";b.innerHTML="<table width=100% height=100%><tr><td valign=center align=center style='font-family:"+a.fontFamily+";font-size:"+a.fontSize+"'><img align='absmiddle' src='"+i.Tab.ResolveImagePath(i.Tab.ImagesDirectory,i.Tab.ImagesSettings.InProgress)+"'>&nbsp;"+i.GetInProgressText()+"</td></tr></table>";j.appendChild(b);setTimeout(function(){WebTabEngine.PrepareLoader(i)},100)}else{i.IFrameContentLoaded=true;f.style.display=""}}else{i.IFrameContentLoaded=true;f.style.display=""}}},PrepareLoader:function(g){var c=g.GetTabPageIFrameElement();var f=g.Tab.GetIFrameWindow(c.name);var b=false;try{var d=f.document}catch(a){b=true}if(f&&c.readyState=="complete"){if(IS.ie11){WebTabEngine.IFrameContentLoaded(g,true)}else{WebTabEngine.IFrameContentLoaded(g)}}if(!g.IFrameContentLoaded){c.nextSibling.style.display="";if(!IS.ie11){c.attachEvent("onreadystatechange",function(){WebTabEngine.IFrameContentLoaded(g)})}}},IFrameContentLoaded:function(d,a){if(d.IsClosed){return}var b=d.GetTabPageIFrameElement();var c=d.Tab.GetIFrameWindow(b.name);var e=b.parentElement;if(a){b.readyState="complete"}if(!d.IFrameContentLoaded){if(e.children[1]!=null){e.children[1].removeNode(true)}b.style.display="";d.IFrameContentLoaded=true}},SetCaption:function(c,d){var a=c.GetDivElement();var e=null;var b=null;if(c.Get("CaptionDisplayMode")=="Text"){e=a.children[0]}else{if(c.Get("CaptionDisplayMode")=="TextAndImage"){if(c.Get("ImageAlignment")=="Left"||c.Get("ImageAlignment")=="Top"){e=a.children[1]}else{e=a.children[0]}}}if(c.Tab.AllowTextWrapping){b=e}else{b=e.children[0]}b.innerHTML=d},SetImage:function(e,f){var b=e.GetDivElement();var d=null;var a=e.Tab;if(e.Get("CaptionDisplayMode")=="Text"){d=b.children[1]}else{if(e.Get("CaptionDisplayMode")=="TextAndImage"){if(a.RenderingMode=="HTML5"||IS.IsHTML5DocType()){if(e.Get("ImageAlignment")=="Left"||e.Get("ImageAlignment")=="Top"){d=b.children[0].children[0]}else{d=b.children[1].children[0]}}else{if(e.Get("ImageAlignment")=="Left"||e.Get("ImageAlignment")=="Top"){d=b.children[0]}else{d=b.children[1]}}}}if(d){d.src=f}},RenderNewItem:function(j,q){var e=j.Tab;var r=WebTabEngine.GetHeaderTable(e);var g=e.GetTabContentDivElement();var i;var o=r.rows[0];var d="";var f;if(o.cells[o.cells.length-1].width!="100%"){i=-1}else{i=o.cells.length-1}if(e.TabSeparator){var p=o.insertCell(i);p.type="TabSeparator";if(!e.UseCssFramework){f=IS.GetCssObject(null,g.className);if(e.Position=="Top"){d=f.borderTop}else{d=f.borderBottom}if(e.RenderMode!="ComplexImages"){if(e.Position=="Top"){p.style.borderBottom=d}else{p.style.borderTop=d}}}p.innerHTML="<div style='width:"+e.DefaultTabSeparatorWidth+"px'></div>";if(i!=-1){i+=1}}var s=o.insertCell(i);var k=e.TabPages[0];s.vAlign="top";s.type="Tab";s.setAttribute("type","Tab");s.noWrap=true;s.name=j.Name;s.style.cssText=k.GetElement().style.cssText;var t="<div></div>";var n="";var h;if(e.RenderMode=="RoundCorner"){n=WebTabEngine.GetRoundCornerDivs(e);if(e.Position=="Top"){t=n+t}else{t=t+n}}s.innerHTML=t;if(e.RenderMode=="RoundCorner"){if(e.Position=="Top"){h=s.children[3]}else{h=s.children[0]}}else{h=s.children[0]}h.align="center";if(e.UseCssFramework){h.setAttribute("display-mode",j.Get("CaptionDisplayMode"));h.setAttribute("image-alignment",j.Get("ImageAlignment"))}if(e.CloseIndicatorPosition=="EdgeOfTabHeader"){h.style.position="relative";h.style.paddingRight="20px"}if(j.AccessKey!=""){h.accessKey=j.AccessKey}if(j.ToolTip!=""){h.title=j.ToolTip}if(e.ShowFocusBorder){h.tabIndex=0}if(e.RenderMode!="ComplexImages"){if(!e.UseCssFramework){if(e.Position=="Top"){h.style.borderBottom="none"}else{h.style.borderTop="none"}}if(e.RenderingMode=="HTML5"||IS.IsHTML5DocType()){h.style.display="table"}}else{h=WebTabEngine.CreateInnerTable(j,h);if(e.ComplexImagesSettings.AllowOverlappingEdges){var l=e.TabPages[e.TabPages.length-1];var m=l.GetRightImageElement();m.parentElement.removeNode(true)}if(e.Position=="Top"){s.vAlign="bottom"}}if(IS.moz){h.style.overflow="visible"}var b="";var a="";WebTabEngine.RenderHeaderContent(e,j,h,b,a);WebTabEngine.SetNormalInternal(j);WebTabEngine.RenderPageContent(e,j);if(e.AllowScrolling){WebTabEngine.InvalidateScrollLeft(e);WebTabEngine.InvalidateScrollRight(e)}},RenderHeaderContent:function(d,h,e,b,a){var g="";var i="";var f="";if((h.Get("CaptionDisplayMode")=="Image"||h.Get("CaptionDisplayMode")=="TextAndImage")&&h.Image!=""){if(d.RenderingMode=="HTML5"||IS.IsHTML5DocType()){g="<div style='display:table-cell;vertical-align:middle;'><img class="+d.TabItemImageStyle+" hspace=3 src='"+h.Image+"' align=absmiddle vspace=2 /></div>"}else{g="<img class="+d.TabItemImageStyle+" hspace=3 src='"+h.Image+"' align=absmiddle vspace=2 />"}}if((d.RenderingMode=="HTML5"||IS.IsHTML5DocType())&&d.RenderMode!="ComplexImages"){i="<span style='display:table-cell;vertical-align:middle;'>"}else{if((d.RenderingMode=="HTML5"||IS.IsHTML5DocType())&&d.RenderMode=="ComplexImages"){i="<span style='display:table-cell;'>"}else{i="<span>"}}if(!d.AllowTextWrapping){i+="<nobr>"}i+=h.Text;if(!d.AllowTextWrapping){i+"</nobr>"}i+="</span>";if(h.Get("ImageAlignment")=="Left"||h.Get("ImageAlignment")=="Top"){result=g+i}else{result=i+g}if(h.Get("AllowClose")=="Yes"&&d.CloseIndicatorPosition=="EdgeOfTabHeader"){result+=WebTabEngine.RenderCloseButton(d)}e.innerHTML=b+result+a},RenderCloseButton:function(a){var b="<span style='font-size: 8pt; cursor:pointer";b+=";position:absolute;right:4px;top:0px' ";b+="title='"+a.TextSettings.CloseButtonTooltipText+"'>";if(a.ImagesSettings.CloseButton==""){b+="<font face='Webdings'>r</font>"}else{b+="<img align=absmiddle src='"+a.ResolveImagePath(a.ImagesDirectory,a.ImagesSettings.CloseButton)+"'>"}b+="</span>";return b},RenderPageContent:function(a,f){var b=a.GetTabContentDivElement();var d=document.createElement("DIV");var e="";if(f.Get("ContentMode")=="UseIFrame"){e="<iframe style='DISPLAY:none;WIDTH:100%;HEIGHT:100%' name='"+f.Name+"' frameBorder=0 "+(a.IFrameAllowTransparency?"allowTransparency":"")+" ";if(a.IFrameAutoLoadContent&&f.ContentURL!=""){e+="src='"+f.ContentURL+"'"}e+=">";e+="</iframe>"}d.style.cssText="DISPLAY: none; WIDTH: 100%; HEIGHT: 100%; POSITION: relative";d.innerHTML=e;b.appendChild(d)},GetRoundCornerDivs:function(a){var g="";var b=a.TabPages[0];var d=b.GetRoundCornerDiv1();var e=b.GetRoundCornerDiv2();var f=b.GetRoundCornerDiv3();if(a.Position=="Top"){g=d.outerHTML+e.outerHTML+f.outerHTML}else{g=f.outerHTML+e.outerHTML+d.outerHTML}return g},CreateInnerTable:function(d,b){var f="";var a=d.Tab;var e=a.ImagesSettings.NormalLeft;if(a.ActiveTabIndex==a.TabPages.length-1){if(a.ComplexImagesSettings.AllowOverlappingEdges){e=a.ImagesSettings.ActiveRightSeparator}}else{if(a.ComplexImagesSettings.AllowOverlappingEdges){e=a.ImagesSettings.NormalSeparator}if(a.ComplexImagesSettings.UseSpecialRightSeparator){e=a.ImagesSettings.SpecialRightSeparator}}f="<table cellspacing=0 cellpadding=0 width=100%><tr><td valign=top>";f+="<img src='"+a.ResolveImagePath(a.ImagesDirectory,e)+"'></td>";f+="<td style='background-image: url("+a.ResolveImagePath(a.ImagesDirectory,a.ImagesSettings.NormalCenter)+"); background-repeat: repeat-x' width='100%'><div align=center></div></td>";f+="<td valign=top><img src='"+a.ResolveImagePath(a.ImagesDirectory,a.ImagesSettings.NormalRight)+"'></td></tr></table>";b.innerHTML=f;return b.children[0].rows[0].cells[1].children[0]},InitMoz:function(a){for(var b=0;b<window.frames.length;b++){if(window.frames[b].document.body.innerHTML=="false"){window.frames[b].document.body.innerHTML=""}}}};function WebTabDestructor(){var a=delete WebTabEngine}window.attachEvent("onunload",WebTabDestructor);