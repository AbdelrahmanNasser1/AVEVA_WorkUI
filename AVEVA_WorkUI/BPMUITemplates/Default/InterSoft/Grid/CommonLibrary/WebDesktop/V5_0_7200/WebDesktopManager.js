function InitWebDesktopLoader(id,mode,transition,progressEvent,text,useCssFramework){var el=document.getElementById(id+"_loader");if(el){if(mode=="UseBuiltIn"){var cssObj=el.currentStyle;var table=el.children[0];var div=table.rows[1].cells[0].children[0];var span=div.children[0];span.style.width="0px";if(!useCssFramework){with(table.style){color=cssObj.color;fontFamily=cssObj.fontFamily;fontSize=cssObj.fontSize}span.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=30, FinishOpacity=100, Style=1, StartX=0,  FinishX=100, StartY=0, FinishY=0)";span.style.backgroundColor=div.currentStyle.color}}el.mode=mode;el.transition=transition;el.eventName=progressEvent;el.loaderText=text;if(document.readyState=="complete"){WebDesktopLoaderProgress(id,100)}else{var resources=new Array();var scripts=document.getElementsByTagName("script");var images=eval(id+"_images");if(IS.ie&&!IS.ie11){for(var i=0;i<scripts.length;i++){if(scripts[i].src!=""){resources[resources.length]=scripts[i]}}}for(var i=0;i<images.length;i++){var img=new Image();img.src=images[i];img.loadTry=0;resources[resources.length]=img}WebDMEngine.ResourcesList=resources;el.totalResources=resources.length;setTimeout(function(){WebDesktopLoaderTimer(id,el)},50)}}}function WebDesktopLoaderTimer(c,a){var g=WebDMEngine.ResourcesList;var h=a.totalResources;var j=0;var d=0;var e=0;for(var b=0;b<g.length;b++){var f=g[b];if(f.marked){j++}else{if((f.tagName=="SCRIPT"&&f.readyState=="complete")||(f.complete)){d++;f.marked=true}else{if(f.tagName=="IMG"&&!f.complete){if(f.loadTry==5&&f.fileSize==-1){d++;f.marked=true}else{f.loadTry++}}}}}if(h==0){e=100}else{e=Math.round(((j+d)/h)*100)}if(IS.ie&&!IS.ie11){if(e>90){if(document.readyState!="complete"){if(!a.retryCount){a.retryCount=0}else{a.retryCount++}e=90+a.retryCount;if(e>97){e=97}}else{e=100}}}WebDesktopLoaderProgress(c,a,e);if(e<100){a.nextTimerID=setTimeout(function(){WebDesktopLoaderTimer(c,a)},50)}}function WebDesktopLoaderProgress(b,a,c){if(a.mode=="UseBuiltIn"){var e=a.children[0];var d=e.rows[1].cells[0].children[0].children[0];var f=e.rows[0].cells[0];var g=a.loaderText;g=g.replace("[completed]",c);f.innerText=g;if(IS.safari){d.style.display="-webkit-inline-box"}else{if(IS.moz){d.style.display="-moz-inline-box"}else{d.style.display="inline-block"}}d.style.width=((c/100)*d.parentElement.clientWidth)+"px"}ISEvent.Raise(a.eventName,b,c);if(c>99){WebDMEngine.ResourcesList=null;clearTimeout(a.nextTimerID);if(IS.ie){setTimeout(function(){WebDMEngine.PlayTransition(a,a.transition)},500)}setTimeout(function(){a.removeNode(true)},1000)}else{}}function WebDesktopMenuStyles(){this._Type="WebDesktopMenuStyles";ISObject.call(this);this.Application=null;this.System=null;if(typeof(WebMenuStyles)=="function"){this.Application=new WebMenuStyles();this.System=new WebMenuStyles()}}function WebDesktopClientSideEvents(){this._Type="WebDesktopClientSideEvents";ISObject.call(this);this.OnInitialize="";this.OnShortcutCreated="";this.OnShortcutSelected="";this.OnShortcutBeforeLaunched="";this.OnShortcutAfterLaunched="";this.OnWindowCreating="";this.OnWindowCreated="";this.OnWindowMinimized="";this.OnWindowMaximized="";this.OnWindowRestored="";this.OnWindowBeforeClosed="";this.OnWindowAfterClosed="";this.OnWindowResized="";this.OnWindowMoved="";this.OnContextMenu="";this.OnWindowBeforeActivated="";this.OnWindowAfterActivated="";this.OnWindowDeactivated="";this.OnLoaderProgress="";this.OnWindowShown=""}function WebDesktopLoaderSettings(){this._Type="WebDesktopLoaderSettings";ISObject.call(this);this.Enabled=false;this.Mode="UseBuiltIn";this.OnReadyTransitionEffect="None"}function WebDesktopImagesSettings(){this._Type="WebDesktopImagesSettings";ISObject.call(this);this.InProgress="is_progress-16.gif";this.MinimizeActive="";this.MaximizeActive="";this.CloseActive="";this.RestoreActive="";this.ControlBox="is_window-16.gif";this.CaptionLeftActive="";this.CaptionCenterActive="";this.CaptionRightActive="";this.CaptionLeftInactive="";this.CaptionCenterInactive="";this.CaptionRightInactive="";this.MinimizeInactive="";this.MaximizeInactive="";this.RestoreInactive="";this.CloseInactive="";this.MinimizeOver="";this.MaximizeOver="";this.RestoreOver="";this.CloseOver="";this.MinimizeDown="";this.MaximizeDown="";this.RestoreDown="";this.CloseDown="";this.ButtonLeftInactive="";this.ButtonCenterInactive="";this.ButtonRightInactive="";this.ButtonLeftOver="";this.ButtonCenterOver="";this.ButtonRightOver="";this.ButtonLeftActive="";this.ButtonCenterActive="";this.ButtonRightActive=""}function WebDesktopManager(a){this.ClassName="WebDesktopManager";this.Version="1.0.2006";this.BuildNumber="0";this.MajorVersion="1.0";this.RequiredFrameworkVersion="2.0.5000.16";ISControl.call(this,a);this.ScriptDirectory="/CommonLibrary/WebDesktop/V3_0_7200/";this.ImagesDirectory="/CommonLibrary/Images/WebDesktop/";this.FrameStyle="";this.Windows=new ISArray();this.ShortcutIcons=new ISArray();this.WindowArrangement="Cascaded";this.TaskBarVisible=true;this.TaskBarSettings=new WebDesktopTaskBarSettings();this.ImagesSettings=new WebDesktopImagesSettings();this.WindowSettings=new WebDesktopWindowSettings();this.MenuStyles=new WebDesktopMenuStyles();this.ShortcutIconsVisible=false;this.EnableAnimation=true;this.EnableKeyboardNavigation=true;this.ClientSideEvents=new WebDesktopClientSideEvents();this.TextSettings=new WebDesktopTextSettings();this.ShortcutSettings=new WebDesktopShortcutSettings();this.TaskBarStyle="";this.TaskBarButtonStyle=null;this.ActiveWindowIndex=-1;this.EnableContextMenu=false;this.ShortcutStyle=null;this.ViewStateStorage="PageCache";this.AccessKey="";this.Enabled=false;this.TabIndex=null;this.ToolTip="";this.Visible=false;this.ClientID=this.ID=this.UniqueID=a;this.MaxZIndex=0;this.IsInResizing=false;this.ActiveShortcutIndex=-1;this.ShortcutDisplayMode="TextAndImage";this.InteractiveObjects=new Array();this.CreatedAtRuntime=false;this.SystemMenu=null;this.DesktopContextMenu=null;this.TaskBarLocked=false;this.LoaderStyle=null;this.LoaderSettings=new WebDesktopLoaderSettings();this.CachedDesktopSize=null;this.WebResourceIdentifier="D";this.WindowInteractiveMode="Physical";this.ShadowModeAnimation=false;this.ShadowModeTransparency=false;this.AnimationStyle="ShrinkExpand";this.DockBottomHeight=0;this.OnInitialize=function(){ISEvent.Raise(this.ClientSideEvents.OnInitialize,this.Id);this.Windows.ReindexPosition();this.ShortcutIcons.ReindexPosition();this.RemoveDynamicStyle();WebDMEngine.InitializeInteractiveObjects(this);if(typeof(ISWinEngine)=="object"){ISWinEngine.Initialize(this.InteractiveObjects)}};this.ReBindingPostBackData=function(){this.Set("ActiveWindowIndex",this.ActiveWindowIndex,true)};this.OnPropertiesInitialized=function(){if(this.Events!=null){var b;for(b in this.Events){if(typeof(this.Events[b])=="string"){this.ClientSideEvents[b]=this.Events[b]}}}var c=document.getElementById(this.Id);if(c==null){c=document.getElementById(this.ServerUniqueID)}c.value="ISWebDesktopManager"};this.RemoveDynamicStyle=function(){var d=["TaskBarButon","Shortcut"];var e=["Caption","CaptionButton","Window","CommandButton"];for(var b=0;b<d.length;b++){var c=this[d[b]+"Style"];if(c){ISXml.RemoveNode(this.XmlNode,d[b]+"Style")}}for(var b=0;b<e.length;b++){var c=this.WindowSettings[e[b]+"Style"];if(c){ISXml.RemoveNode(this.WindowSettings.XmlNode,e[b]+"Style")}}};this.GetMaxZIndex=function(){if(this.MaxZIndex==0){for(var b=0;b<this.Windows.length;b++){var c=this.Windows[b].GetWindowDivElement();if(c){this.MaxZIndex=Math.max(this.MaxZIndex,c.style.zIndex)}}}return this.MaxZIndex};this.GetIFrameWindow=function(b){return window.frames[b]};this.GetAvailableColumn=function(){var e=10;var f=0;var b=-1;var c=this.GetDesktopSize();for(var d=0;d<this.ShortcutIcons.length;d++){var g=this.ShortcutIcons[d];if(!g.RuntimeLocation.IsEmpty()&&g.Location.IsEmpty()){e=Math.max(e,g.RuntimeLocation.X)}}b=(e-10)/80;for(var d=0;d<this.ShortcutIcons.length;d++){var g=this.ShortcutIcons[d];if(!g.RuntimeLocation.IsEmpty()&&g.RuntimeLocation.X==e&&g.Location.IsEmpty()){f=Math.max(f,g.RuntimeLocation.Y)}}if(f+(80*2)>c.Height){b++}return b};this.GetAvailableRow=function(b){var d=(b*80)+10;var e=5;var f=-1;for(var c=0;c<this.ShortcutIcons.length;c++){var g=this.ShortcutIcons[c];if(!g.RuntimeLocation.IsEmpty()&&g.RuntimeLocation.X==d&&(this.ShortcutSettings.AllowAutoArrange||g.Location.IsEmpty())){e=Math.max(e,g.RuntimeLocation.Y+80)}}f=(e-5)/80;return f};this.GetCssObject=function(b){return IS.GetCssObject(null,b,true)};this.TransferStyle=function(b){var c=this.GetCssObject(b.selectorText.substring(1));if(!c){var d=IS.GetRuntimeStyleSheetExact();if(IS.ie||IS.safari){d.addRule(b.selectorText,b.style.cssText)}else{d.innerHTML+=b.selectorText+" { "+b.style.cssText+" }\n"}return true}return false};this.OnUnload=function(){WebDMEngine.UnregisterBehaviour(this)};this.CreateWindow=function(){return new WebDesktopWindow()};this.ShowDialogBox=function(){};this.GetDocument=function(){var b=this.GetDesktopElement();if(b){if(IS.ie&&!IS.ie10){return b.document}else{return b.ownerDocument}}else{return document}};this.GetContentWindow=function(){var b=this.GetDocument();return b.parentWindow};this.GetTaskBarElement=function(){return document.getElementById("dvTaskBar_"+this.Id)};this.GetTaskBarWindowGroupElement=function(){var b=this.GetTaskBarElement();if(!b){return null}var d=b.children[0];for(var c=0;c<d.rows[0].cells.length;c++){if(IS.GetAttr(d.rows[0].cells[c],"type")=="WindowGroup"){return d.rows[0].cells[c]}}return null};this.GetTaskBarLeftTemplateElement=function(){var b=this.GetTaskBarElement();if(!b){return null}var d=b.children[0];for(var c=0;c<d.rows[0].cells.length;c++){if(IS.GetAttr(d.rows[0].cells[c],"type")=="Left"){return d.rows[0].cells[c]}}return null};this.GetTaskBarRightTemplateElement=function(){var b=this.GetTaskBarElement();if(!b){return null}var d=b.children[0];for(var c=0;c<d.rows[0].cells.length;c++){if(IS.GetAttr(d.rows[0].cells[c],"type")=="Right"){return d.rows[0].cells[c]}}return null};this.GetDesktopElement=function(){var b=document.getElementById("dvDesktop_"+this.Id);if(!b&&this.CreatedAtRuntime){if(document.forms.length>0){b=document.forms[0]}else{if(IS.IsXHTMLDocType()){b=document.documentElement}else{b=document.body}}}return b};this.GetDesktopSize=function(){var c=new UnitSize();if(this.CachedDesktopSize==null){var b=null;if(!this.CreatedAtRuntime){b=this.GetDesktopElement()}else{if(IS.IsXHTMLDocType()){b=document.documentElement}else{b=document.body}}c.Width=b.offsetWidth;c.Height=b.offsetHeight;if(c.Height==0){c.Height=ISPosLib.getHeight(b)}this.CachedDesktopSize=c}else{c=this.CachedDesktopSize}return c};this.GetDesktopClientSize=function(){var c=new UnitSize();var b=null;if(!this.CreatedAtRuntime){b=this.GetDesktopElement()}else{if(IS.IsXHTMLDocType()){b=document.documentElement}else{b=document.body}}c.Width=b.clientWidth;c.Height=b.clientHeight;if(c.Height==0){c.Height=ISPosLib.getHeight(b)}return c};this.GetAvailableDesktopHeight=function(b){return b-this.DockBottomHeight};this.CascadeWindows=function(c,b){WebDMEngine.CascadeWindows(this,c,b)};this.TileWindowsHorizontally=function(c,b){WebDMEngine.TileWindows(this,c,"H",b)};this.TileWindowsVertically=function(c,b){WebDMEngine.TileWindows(this,c,"V",b)};this.GetActiveWindow=function(){return this.Windows[this.ActiveWindowIndex]};this.GetActiveShortcut=function(){return this.ShortcutIcons[this.ActiveShortcutIndex]};this.GetWindow=function(b){var c=this.Windows.GetNamedItem(b);if(!c&&this.CreatedAtRuntime){c=ISGetObject(b.substring(3));if(c&&c.GetType()=="WebDialogBox"){c=c.Window}}return c};this.ResolveImagePath=function(b){return this._ResolveImagePath(this.ImagesDirectory,b)};this.GetTopMostWindowBefore=function(g){var d=null;var c=0;for(var b=0;b<this.Windows.length;b++){var e=this.Windows[b];if(e.WindowState!="Minimized"&&!e.IsClosed&&e.Initialized&&e!=g&&e.ClientVisible){var f=e.GetWindowDivElement();if(f){c=Math.max(c,f.style.zIndex);if(c==f.style.zIndex){d=e}}}}return d};this.GetWindowListByZOrder=function(){var g=new Array();var d=new Array();for(var b=0;b<this.Windows.length;b++){g[g.length]=this.Windows[b].GetWindowDivElement().style.zIndex}g.sort(WebDMEngine.CompareNumbers);g.reverse();for(var b=0;b<g.length;b++){for(var c=0;c<this.Windows.length;c++){var e=this.Windows[c];var f=e.GetWindowDivElement();if(f.style.zIndex==g[b]){d[d.length]=e}}}return d};this.SetNoActiveWindow=function(){var c=this.GetActiveWindow();if(c&&c.ClientVisible&&!c.Closed){var b=c.GetTaskBarButtonElement();DynamicStyleEngine.SetToStyle(null,this.TaskBarButtonStyle,b)}this.ActiveWindowIndex=-1};this.RearrangeShortcutIcons=function(){WebDMEngine.RearrangeShortcutIcons(this)};this.ShowShortcutIcons=function(){for(var b=0;b<this.ShortcutIcons.length;b++){var c=this.ShortcutIcons[b];c.Show()}this.ShortcutIconsVisible=true};this.HideShortcutIcons=function(){for(var b=0;b<this.ShortcutIcons.length;b++){var c=this.ShortcutIcons[b];c.Hide()}this.ShortcutIconsVisible=false};this.ShowDesktop=function(){for(var b=0;b<this.Windows.length;b++){var c=this.Windows[b];if(c.WindowState!="Minimized"&&!c.IsDialogBox){c.Minimize()}}this.SetNoActiveWindow()};this.SaveDesktopStateToXml=function(){this.Windows.UpdateChanges();this.ShortcutIcons.UpdateChanges();var c=ISXml.CreateXmlDocument();var b="<Desktop>";b+=this.Windows.XmlNode.xml;if(this.ShortcutIconsVisible){b+=this.ShortcutIcons.XmlNode.xml}b+="</Desktop>";ISXml.LoadXml(c,b);return b};this.RegisterEvents=function(b,c){WebDMEngine.HookIFrameEvents(this,b,c?b.parent.name:null)};this.GetNotificationControl=function(){for(var c=0;c<IS.RuntimeObjects;c++){var b=IS.RuntimeObjects[c];if(b!=null&&b.GetType()=="WebNotification"){return b}}return null};this.IsVistaAnimation=function(){return(this.EnableAnimation&&this.AnimationStyle=="VistaStyleZoom")};this.GetVisibleWindows=function(){var c=new Array();for(var b=0;b<this.Windows.length;b++){var d=this.Windows[b];if(d.ClientVisible&&!d.IsClosed){c.push(d)}}return c};this.OpenFromFishEye=function(b){WebDMEngine.OpenFromFishEye(this,b)}}function WebDesktopShortcut(){this._Type="WebDesktopShortcut";ISObject.call(this);this.Name="";this.Index=-1;this.DesktopManager=null;this.Text="";this.Image="";this.TargetURL="";this.WindowName="";this.Visible=true;this.Enabled=true;this.Location=new OffsetLocation();this.RuntimeLocation=new OffsetLocation();this.Collection=null;this.ToolTip="";this.TargetControlBoxImage="";this.TaskBarImage="";this.InteractiveObject=null;this.OnPropertiesInitialized=function(){this.DesktopManager=this.Parent;this.Collection=this.DesktopManager.ShortcutIcons;if(ISXml.GetAttribute(this.XmlNode,"Location")!=null){var a=ISXml.GetAttribute(this.XmlNode,"Location");this.Location.Parse(a)}};this.OnAdd=function(){WebDMEngine.CreateShortcut(this)};this.Initialize=function(){this.Rearrange();if(this.DesktopManager.ShortcutSettings.Movable){var d=new ISInteractiveObject();var b=this.GetElement();var a=this.DesktopManager;d.DesktopManager=this.DesktopManager;d.Movable=true;d.DragElement=b;d.FrameElement=b;a.InteractiveObjects[a.InteractiveObjects.length]=d;this.InteractiveObject=d;this.Registered=true;b.IsInteractiveObject=true}};this.GetElement=function(){return document.getElementById("dvSCI_"+this.DesktopManager.Id+"_"+this.Name)};this.GetTextElement=function(){var a=this.GetElement();return a.children[1]};this.Rearrange=function(){var e=this.Index;var c=this.DesktopManager;var f=c.ShortcutSettings;var d=this.GetElement();if(!this.Visible||!d){return}if(f.AllowAutoArrange||this.Location.IsEmpty()){var a=c.GetAvailableColumn();var b=c.GetAvailableRow(a);var g=5+(b*80);this.RuntimeLocation.X=(a*80)+10;this.RuntimeLocation.Y=g}else{this.RuntimeLocation.X=this.Location.X;this.RuntimeLocation.Y=this.Location.Y}d.style.left=this.RuntimeLocation.X+"px";d.style.top=this.RuntimeLocation.Y+"px"};this.Select=function(d){if(this.Visible){var b=this.DesktopManager.GetActiveShortcut();if(b){var a=b.GetTextElement();DynamicStyleEngine.SetToStyle(null,this.DesktopManager.ShortcutStyle,a);if(this.DesktopManager&&this.DesktopManager.UseCssFramework){var c=b.GetElement();var e=c.getAttribute("state");if(e&&e.toLowerCase()=="active"){c.removeAttribute("state")}}}var c=this.GetTextElement();DynamicStyleEngine.SetToActiveStyle(null,this.DesktopManager.ShortcutStyle,c);this.DesktopManager.ActiveShortcutIndex=this.Index;if(this.DesktopManager&&this.DesktopManager.UseCssFramework){var c=this.GetElement();var e=c.getAttribute("state");if(!e||e.toLowerCase()!="disabled"){c.setAttribute("state","active")}}if(d){pass=ISEvent.Raise(this.DesktopManager.ClientSideEvents.OnShortcutSelected,this.DesktopManager.Id,this)}}};this.Open=function(b){var a=true;if(b){a=ISEvent.Raise(this.DesktopManager.ClientSideEvents.OnShortcutBeforeLaunched,this.DesktopManager.Id,this)}if(a){WebDMEngine.OpenShortcut(this)}ISEvent.Raise(this.DesktopManager.ClientSideEvents.OnShortcutAfterLaunched,this.DesktopManager.Id,this)};this.SetText=function(b){var a=this.GetElement();if(a){a.children[1].innerHTML=b}this.Text=b};this.Delete=function(){WebDMEngine.DeleteShortcut(this)};this.Show=function(){var a=this.GetElement();if(a){a.style.display=""}};this.Hide=function(){var a=this.GetElement();if(a){a.style.display="none"}}}function WebDesktopShortcutSettings(){this._Type="WebDesktopShortcutSettings";ISObject.call(this);this.AllowAutoArrange=true;this.Movable=false}function WebDesktopTaskBarSettings(){this._Type="WebDesktopTaskBarSettings";ISObject.call(this);this.Position="Bottom";this.Movable=false;this.Resizable=false;this.ShowWindows=true;this.WindowButtonWidth=150}function WebDesktopTextSettings(){this._Type="WebDesktopTextSettings";ISObject.call(this);this.InProgressText="Loading content...";this.MaximizeText="Maximize";this.MinimizeText="Minimize";this.RestoreText="Restore Down";this.CloseText="Close";this.BusyText="Please wait while your request is being processed...";this.LoadingText="Loading desktop..."}function WebDesktopWindow(){this._Type="WebDesktopWindow";ISObject.call(this);this.AllowMinimize="Default";this.AllowMaximize="Default";this.AllowResize="Default";this.AllowClose="Default";this.ControlBox="Default";this.Text="";this.TextAlignment="Default";this.CaptionDisplayMode="Default";this.ContentMode="Default";this.HeaderTemplate=null;this.ContentTemplate=null;this.ClientVisible=true;this.Size=new UnitSize();this.MaximumSize=new UnitSize();this.MinimumSize=new UnitSize();this.Location=new OffsetLocation();this.Name="";this.InProgressText="";this.BusyText="";this.ShowInTaskBar=true;this.ControlBoxImage="";this.ShortcutImage="";this.Index=-1;this.DesktopManager=null;this.ContentURL="";this.Collection=null;this.IsClosed=false;this.Initialized=false;this.IFrameLoaded=false;this.IFrameContentLoaded=false;this.WindowState="Normal";this.PreviousWindowState="Normal";this.InteractiveObject=null;this.CreatedAtRuntime=false;this.DialogBoxShown=false;this.CurrentDialogBox=null;this.BarsAccessKeyEnabled=true;this.IsBusy=false;this.StartupPositionInitialized=false;this.DialogBoxWindows=new ISArray();this.TaskBarImage="";this.OnAfterActivated="";this.OnAfterClosed="";this.OnPrepareClosed="";this.OnBeforeActivated="";this.OnBeforeClosed="";this.OnMaximized="";this.OnMinimized="";this.OnResized="";this.OnRestored="";this.EnableDropShadow=false;this.DropShadow=null;this.OnPropertiesInitialized=function(){this.DesktopManager=this.Parent;this.Collection=this.DesktopManager.Windows;if(ISXml.GetAttribute(this.XmlNode,"Size")!=null){this.Size.Parse(ISXml.GetAttribute(this.XmlNode,"Size"))}if(ISXml.GetAttribute(this.XmlNode,"MinimumSize")!=null){this.MinimumSize.Parse(ISXml.GetAttribute(this.XmlNode,"MinimumSize"))}if(ISXml.GetAttribute(this.XmlNode,"MaximumSize")!=null){this.MaximumSize.Parse(ISXml.GetAttribute(this.XmlNode,"MaximumSize"))}if(ISXml.GetAttribute(this.XmlNode,"Location")!=null){this.Location.Parse(ISXml.GetAttribute(this.XmlNode,"Location"))}};this.GetDefault=function(a){if(this[a]=="Default"){return this.DesktopManager.WindowSettings[a]}else{return this[a]}};this.GetDefaultSize=function(a){if(this[a].IsEmpty()){return this.DesktopManager.WindowSettings[a]}else{return this[a]}};this.__getter=function(a){switch(a){case"CaptionDisplayMode":case"ImageAlignment":case"ContentMode":case"AllowMinimize":case"AllowMaximize":case"AllowClose":case"AllowResize":case"ControlBox":case"TextAlignment":return this.GetDefault(a);break;case"ControlBoxImage":if(this[a]==""){return this.DesktopManager.ImagesSettings.ControlBox}else{return this[a]}break;case"Size":case"MinimumSize":case"MaximumSize":return this.GetDefaultSize(a);case"BusyText":if(this[a]==""){return this.DesktopManager.TextSettings[a]}else{return this[a]}}};this.OnAdd=function(){WebDMEngine.CreateWindow(this)};this.OnUpdate=function(a){if(!this.Location.IsEmpty()){ISXml.SetAttribute(a,"Location",this.Location.X+", "+this.Location.Y)}if(!this.IsClosed&&!this.Size.IsEmpty()){ISXml.SetAttribute(a,"Size",this.Size.Width+", "+this.Size.Height)}};this.ReInitialize=function(){WebDMEngine.UnregisterWindowBehaviour(this);this.Initialize(true)};this.Initialize=function(e){WebDMEngine.RegisterWindowBehaviour(this);if(e){return}var a=this.DesktopManager;var f=this.GetWindowDivElement();var b=this.GetCaptionBarTableElement();var d=new ISInteractiveObject();if(this.Get("AllowResize")=="Yes"){d.Resizable=true}d.Window=this;d.DesktopManager=a;d.Movable=true;d.DragElement=b;d.FrameElement=f;d.FrameElement.IsInteractiveObject=true;d.Registered=true;a.InteractiveObjects[a.InteractiveObjects.length]=d;this.InteractiveObject=d;this.Initialized=true};this.UnregisterAccessKeys=function(){WebDMEngine.UnregisterAccessKeys(this)};this.RegisterAccessKeys=function(){WebDMEngine.RegisterAccessKeys(this)};this.GetWindowDivElement=function(){return document.getElementById("dvWnd_"+this.DesktopManager.Id+"_"+this.Name)};this.GetCaptionBarCellElement=function(){var b=this.GetWindowDivElement();var a=b.children[0];if(b){if(IS.IsHTML5DocType()){return a.children[0]}else{return a.rows[0].cells[0]}}return null};this.GetControlBoxElement=function(){var a=this.GetCaptionBarCellElement();if(this.Get("ControlBox")=="Yes"){var d=a.children[0];var b=(this.DesktopManager.WindowSettings.ControlBoxPosition=="Left")?0:1;if(IS.IsHTML5DocType()){b=0}var c=(this.DesktopManager.WindowSettings.WindowOptionsPosition=="Left")?1:0;if(IS.IsHTML5DocType()){if(this.DesktopManager.WindowSettings.BorderType=="Simple"){return d.children[c].children[0].children[0].children[0].children[b]}else{return d.children[1].children[0].children[c].children[0].children[0].children[0].children[b]}}else{if(this.DesktopManager.WindowSettings.BorderType=="Simple"){return d.rows[0].cells[b]}else{return d.rows[0].cells[1].children[0].rows[0].cells[b]}}}return null};this.GetCaptionBarTableElement=function(){if(IS.IsHTML5DocType()){if(this.DesktopManager.WindowSettings.BorderType=="Simple"){return this.GetCaptionBarCellElement().children[0]}else{if(this.DesktopManager.WindowSettings.BorderType=="ComplexImages"){var b=this.GetCaptionBarCellElement();if(b){var c=b.children[0];var a=c.children[1];return a.children[0]}return null}}}else{if(this.DesktopManager.WindowSettings.BorderType=="Simple"){return this.GetCaptionBarCellElement().children[0]}else{if(this.DesktopManager.WindowSettings.BorderType=="ComplexImages"){var b=this.GetCaptionBarCellElement();if(b){var c=b.children[0];var a=c.rows[0].cells[1];return a.children[0]}return null}}}};this.GetInProgressText=function(){if(this.InProgressText==""){return this.DesktopManager.TextSettings.InProgressText}else{return this.InProgressText}};this.GetContentDivElement=function(){var b=this.GetWindowDivElement();if(b){var a=b.children[0];if(IS.IsHTML5DocType()&&a.children[1]){return a.children[1].children[0]}else{return a.rows[1].cells[0].children[0]}}return null};this.GetDesktopManager=function(){return this.DesktopManager};this.GetWindowOptionsCellElement=function(){var b=this.GetCaptionBarTableElement();if(IS.IsHTML5DocType()){if(b){var a=b;if(this.DesktopManager.WindowSettings.WindowOptionsPosition=="Right"){return a.children[b.children.length-1].children[0].children[0]}else{return a.children[0].children[0].children[0]}}else{return null}}else{if(b){var a=b.rows[0];if(this.DesktopManager.WindowSettings.WindowOptionsPosition=="Right"){return a.cells[b.rows[0].cells.length-1]}else{return a.cells[0]}}else{return null}}};this.GetControlBoxCellElement=function(){if(this.Get("ControlBox")=="No"){return null}var a=this.GetCaptionBarTableElement();if(IS.IsHTML5DocType()){if(a){idx=0;if(this.DesktopManager.WindowSettings.WindowOptionsPosition=="Left"){idx=1}if(this.DesktopManager.WindowSettings.ControlBoxPosition=="Left"){return a.children[idx].children[0].children[0].children[0].children[0]}else{return a.children[idx].children[0].children[0].children[0].children[0]}}else{return null}}else{if(a){if(this.DesktopManager.WindowSettings.ControlBoxPosition=="Left"){return a.rows[0].cells[0]}else{return a.rows[0].cells[1].children[0]}}else{return null}}};this.GetMaximizeButtonElement=function(){var c=this.GetWindowOptionsCellElement();for(var b=0;b<c.children.length;b++){var a=c.children[b];if(IS.GetAttr(a,"type")=="Max"){return a}}return null};this.GetCloseButtonElement=function(){var c=this.GetWindowOptionsCellElement();for(var b=0;b<c.children.length;b++){var a=c.children[b];if(IS.GetAttr(a,"type")=="Close"){return a}}return null};this.GetMinimizeButtonElement=function(){var c=this.GetWindowOptionsCellElement();for(var b=0;b<c.children.length;b++){var a=c.children[b];if(IS.GetAttr(a,"type")=="Min"){return a}}return null};this.IsActiveWindow=function(){return(this.DesktopManager.ActiveWindowIndex==this.Index)};this.GetTaskBarButtonElement=function(){var a=this.DesktopManager;if(a.TaskBarVisible&&a.TaskBarSettings.ShowWindows){if(this.ShowInTaskBar&&!this.IsClosed&&this.Initialized){var c=this.DesktopManager.GetTaskBarWindowGroupElement();if(c){var d=c.children[0].children[0];for(var b=0;b<d.rows[0].cells.length;b++){if(IS.GetAttr(d.rows[0].cells[b],"name")==this.Name){return d.rows[0].cells[b]}}}}}return null};this.GetTaskBarButtonImageElement=function(){var a=this.GetTaskBarButtonElement();if(a){return a.children[0].children[0].children[0]}return null};this.GetTaskBarButtonTextElement=function(){var a=this.GetTaskBarButtonElement();if(a){return a.children[0].children[0].childNodes[2]}return null};this.GetWindowIFrameElement=function(){var a=this.GetContentDivElement();if(!a){return null}var b=a.children[0];if(b.children[0].tagName=="IFRAME"){return b.children[0]}else{return b.children[1]}};this.GetContentWindow=function(){var a=this.GetWindowIFrameElement();if(a){return a.contentWindow}};this.MoveTo=function(a,b){WebDMEngine.MoveWindowTo(this,a,b)};this.MoveToCenterDesktop=function(){var a=this.DesktopManager.GetDesktopSize();WebDMEngine.MoveWindowTo(this,(a.Width-this.Size.Width)/2,(a.Height-this.Size.Height)/2)};this.MoveToCenterDesktopAbsolute=function(){var a=this.DesktopManager.GetDesktopClientSize();WebDMEngine.MoveWindowTo(this,(a.Width-this.Size.Width)/2,(a.Height-this.Size.Height)/2)};this.ResizeTo=function(b,a){WebDMEngine.ResizeWindowTo(this,b,a)};this.Minimize=function(b,c){var a=true;if(b){a=WebDMEngine.RaiseWindowDeactivate(this.DesktopManager);if(a){a=ISEvent.Raise(this.DesktopManager.ClientSideEvents.OnWindowMinimized,this.DesktopManager.Id,this)}}if(a){WebDMEngine.MinimizeWindow(this,c)}};this.Maximize=function(b,c){var a=true;if(b){a=ISEvent.Raise(this.DesktopManager.ClientSideEvents.OnWindowMaximized,this.DesktopManager.Id,this)}if(a){WebDMEngine.MaximizeWindow(this,c)}};this.Restore=function(b,c){var a=true;if(b){a=ISEvent.Raise(this.DesktopManager.ClientSideEvents.OnWindowRestored,this.DesktopManager.Id,this)}if(a){WebDMEngine.RestoreWindow(this,c)}};this.Close=function(b){var a=true;if(b){a=WebDMEngine.RaiseWindowDeactivate(this.DesktopManager);if(a){a=ISEvent.Raise(this.OnBeforeClosed,this)}}if(a){if(b){a=ISEvent.Raise(this.DesktopManager.ClientSideEvents.OnWindowBeforeClosed,this.DesktopManager.Id,this)}}if(a){WebDMEngine.CloseWindow(this);ISEvent.Raise(this.OnAfterClosed,this);if(b){ISEvent.Raise(this.DesktopManager.ClientSideEvents.OnWindowAfterClosed,this.DesktopManager.Id,this)}WebDMEngine.DestroyWindow(this)}};this.Activate=function(a){if(!this.IsActiveWindow()){WebDMEngine.DecreaseZIndex(this.DesktopManager);this.BringToFront();WebDMEngine.Activate(this,a)}};this.ShowAndActivate=function(){this.Show(null,null,null,true)};this.Show=function(j,b,h,a){var c=false;if(this.CreatedAtRuntime){if(j&&this.DesktopManager.EnableAnimation&&this.DesktopManager.AnimationStyle=="ShrinkExpand"){var d=new ISAnimatedObject();var l=this;var g=new UnitSize();var f=new OffsetLocation();f.X=ISPosLib.getLeft(j);f.Y=ISPosLib.getTop(j);g.Width=ISPosLib.getWidth(j);g.Height=ISPosLib.getHeight(j);if(b){d.BorderColor=b}d.Type="ShrinkExpand";d.AnimateLocation=true;d.AnimateSize=true;d.Element=this.GetWindowDivElement();d.CurrentSize=g;d.CurrentLocation=f;d.TargetSize=this.Size;d.TargetLocation=this.Location;d.OnCompleted=function(){l.Show()};d.Play();c=true}else{if(this.ShowInTaskBar){WebDMEngine.CreateTaskBarButton(this)}if((h==true||!this.DesktopManager.IsVistaAnimation())&&this.ContentURL!=""){this.LoadContent()}this.Activate()}}else{if(!this.ClientVisible&&this.DesktopManager.TaskBarVisible&&this.ShowInTaskBar){WebDMEngine.CreateTaskBarButton(this)}if((h==true||!this.DesktopManager.IsVistaAnimation())&&this.ContentURL!=""&&this.Get("ContentMode")=="UseIFrame"&&!this.IFrameContentLoaded){this.LoadContent()}}var m=this.GetWindowDivElement();var k=this.GetTaskBarButtonElement();var i=false;if(!c&&!h){if(this.DesktopManager.IsVistaAnimation()){var e=this.GetContentDivElement().children[0];e.style.display="none";var d=new ISAnimatedObject();var l=this;d.Type="ZoomIn";d.AnimateLocation=false;d.AnimateSize=false;d.Element=m;d.MaxStep=7;d.OnCompleted=function(){WebDMEngine.OnWindowShown(l,a)};d.Play();c=true}else{i=true}}if(!i&&h){i=true}if(i){m.style.display="";if(IS.ie&&IS.GetIEVersion<7){this.EnableDropShadow=false}if(this.EnableDropShadow){if(IS.IsHTML5DocType()){m.style.boxShadow="5px 5px 40px #555"}else{if(this.DropShadow==null){this.DropShadow=new ISDropShadow();this.DropShadow.Container=this.DesktopManager.GetDesktopElement();if(this.DesktopManager.UseWebResourcesForClient){this.DropShadow.ImageFolder=IS.GetAppDomainPath()+"ISRes.axd?D/"}this.DropShadow.AttachTo(m)}this.DropShadow.UpdatePosition();this.DropShadow.Show()}}if(IsIE8StandardMode()){WebDMEngine.FixIEWindowSize(this)}ISEvent.Raise(this.DesktopManager.ClientSideEvents.OnWindowShown,this.DesktopManager.Id,this)}if(k){k.style.display=""}if(!c&&a){this.Activate()}this.ClientVisible=true;if(IS.IsHTML5DocType()){WebDMEngine.SetWindowSeparator(this)}};this.Hide=function(){var e=this.GetWindowDivElement();var c=this.GetTaskBarButtonElement();if(typeof(event)!="undefined"&&event!=null&&this.DesktopManager.IsVistaAnimation()&&this.WindowState!="Minimized"){if(this.Get("ContentMode")=="UseIFrame"){var b=this.GetWindowIFrameElement();b.style.display="none"}var a=new ISAnimatedObject();var d=this;a.Type="ZoomOut";a.AnimateLocation=false;a.AnimateSize=false;a.Element=e;a.OnCompleted=function(){WebDMEngine.OnWindowHidden(d)};a.Play()}else{e.style.display="none";if(this.EnableDropShadow&&this.DropShadow!=null){this.DropShadow.Hide()}}if(c){c.style.display="none"}this.ClientVisible=false};this.BringToFront=function(){var b=this.GetWindowDivElement();if(b){var a=parseFloat(b.style.zIndex);if(isNaN(a)){a=1}if(a<102){b.style.zIndex=102}}};this.SendToBack=function(){var a=this.GetWindowDivElement();if(a){a.style.zIndex=100-this.Collection.length}};this.GetCaptionBarTextCellElement=function(){var a=this.GetCaptionBarTableElement();if(a){var b=1;if(this.Get("ControlBox")=="No"){b=0}if(IS.IsHTML5DocType()){var c=0;if(this.DesktopManager.WindowSettings.WindowOptionsPosition=="Left"){c=1}return a.children[c].children[0].children[0].children[0].children[b].children[0]}else{return a.rows[0].cells[b]}}return null};this.SetCaption=function(d){var b=this.GetCaptionBarTextCellElement();var c=this.GetTaskBarButtonTextElement();var a=this.GetCaptionBarTableElement();if(a){if(this.DesktopManager.WindowSettings.ControlBoxPosition=="Left"){b.innerHTML=d}else{b.childNodes[1].nodeValue=" "+d}}if(c){c.nodeValue=" "+d}if(IS.IsHTML5DocType()){WebDMEngine.SetWindowSeparator(this)}};this.SetControlBoxImage=function(b){var a=this.GetControlBoxElement();if(a){a.children[0].src=b}};this.SetContentURL=function(b){if(this.Get("ContentMode")=="UseIFrame"){this.ContentURL=b;this.IFrameLoaded=false;this.IFrameContentLoaded=false;if(this.DesktopManager.WindowSettings.IFrameShowLoader&&IS.ie){var a=this.GetWindowIFrameElement();a.style.display="none"}this.LoadContent()}};this.LoadContent=function(){if(this.Get("ContentMode")=="UseIFrame"){WebDMEngine.LoadIFrameContent(this)}};this.SaveLocationAndSize=function(){var a=new OffsetLocation();var b=new UnitSize();var c=this.GetWindowDivElement();a.X=c.style.posLeft;a.Y=c.style.posTop;b.Width=c.offsetWidth;b.Height=c.offsetHeight;this.Location=a;this.Size=b};this.IsTargetSizeValid=function(b,a){if(this.MinimumSize.IsEmpty()&&this.MaximumSize.IsEmpty()){return true}if(!this.MinimumSize.IsEmpty()){if(b<this.MinimumSize.Width||a<this.MinimumSize.Height){return false}}if(!this.MaximumSize.IsEmpty()){if(b>this.MaximumSize.Width||a>this.MaximumSize.Height){return false}}return true};this.GetPreferredSize=function(c,a){if(!c&&!a){c=this.Size.Width;a=this.Size.Height}var b=new UnitSize();b.Width=c;b.Height=a;if(!this.MinimumSize.IsEmpty()){if(c<this.MinimumSize.Width){b.Width=this.MinimumSize.Width}if(a<this.MinimumSize.Height){b.Height=this.MinimumSize.Height}}if(!this.MaximumSize.IsEmpty()){if(c>this.MaximumSize.Width){b.Width=this.MaximumSize.Width}if(a>this.MaximumSize.Height){b.Height=this.MaximumSize.Height}}return b};this.GetMinimizedLocation=function(){var a=this.Collection;var d=-1;var f=new OffsetLocation();for(var c=0;c<a.length;c++){var h=a[c];if(h.WindowState=="Minimized"&&h.GetTaskBarButtonElement()==null){d++}}d++;f.X=5+(d*200);f.Y=this.DesktopManager.GetDesktopSize().Height-35;if(this.DesktopManager.UseCssFramework){var e,b,g=this.GetMinimizedSize();for(var c=0;c<a.length;c++){var h=a[c];if(h.WindowState=="Minimized"&&h.GetTaskBarButtonElement()==null){if(!e){e=h.GetWindowDivElement()}else{if(e.offsetLeft<h.GetWindowDivElement().offsetLeft){e=h.GetWindowDivElement()}}if(!b){b=h.GetWindowDivElement()}else{if(b.offsetLeft>h.GetWindowDivElement().offsetLeft){b=h.GetWindowDivElement()}}}}if(!b||!e||b.offsetLeft>g.Width+5||b.offsetTop+b.offsetHeight<this.DesktopManager.GetDesktopSize().Height-30){f.X=5}else{f.X=e.offsetLeft+e.offsetWidth+5}if(a[0].GetCaptionBarCellElement().offsetHeight>0){f.Y=this.DesktopManager.GetDesktopSize().Height+10-a[0].GetCaptionBarCellElement().offsetHeight}}return f};this.GetMinimizedSize=function(){var a=new UnitSize();a.Width=150;a.Height=25;return a};this.GetNextWindow=function(){var a=this.DesktopManager.GetWindowListByZOrder();var c=null;for(var b=0;b<a.length;b++){if(a[b]==this){c=a[b+1]}}if(!c&&a.length>0){c=a[0]}return c};this.GetNextWindowExact=function(){var a=ISGetActiveWindow();var b=this.DesktopManager.Windows[this.Index+1];if(!b){b=this.DesktopManager.Windows[0]}if(b&&(!b.ClientVisible||b.IsClosed)){b=b.GetNextWindowExact()}return b};this.GetPreviousWindow=function(){var a=this.DesktopManager.GetWindowListByZOrder();var c=null;for(var b=0;b<a.length;b++){if(a[b]==this){c=a[b-1]}}if(!c&&a.length>0){c=a[a.length-1]}return c};this.GetPreviousWindowExact=function(){var a=ISGetActiveWindow();var b=this.DesktopManager.Windows[this.Index-1];if(!b){b=this.DesktopManager.Windows[this.DesktopManager.Windows.length-1]}if(b&&(!b.ClientVisible||b.IsClosed)){b=b.GetPreviousWindowExact()}return b};this.InitializeLayout=function(a,b){WebDMEngine.InitializeLayout(this,a,b)};this.SetInlineContent=function(b){var a=this.GetContentDivElement();a.innerHTML=b};this.GetHourGlassDiv=function(){var a=this.GetWindowDivElement();if(a){var b=a.children[a.children.length-1];if(b&&b.tagName=="DIV"&&b.type=="BusyLayer"){return b}}return null};this.SetBusy=function(){var a=this.GetWindowDivElement();if(a){var b=this.GetHourGlassDiv();if(!b){var c=0;if(this.DesktopManager.WindowSettings.DimWindowWhenBusy){c=50}b=document.createElement("DIV");b.type="BusyLayer";b.style.cssText="position:absolute; top:0px; left:0px; width:100%; height:100%; cursor:wait; z-index: 1;";b.style.width=a.offsetWidth+"px";if(IS.ie){b.style.filter="Alpha(Opacity="+c+")";b.style.backgroundColor="white"}b.title=this.Get("BusyText");a.insertAdjacentElement("beforeEnd",b)}else{b.style.cursor="wait";b.style.display=""}this.InteractiveObject.OriginalResizable=this.InteractiveObject.Resizable;this.InteractiveObject.Resizable=false;this.IsBusy=true}};this.SetIdle=function(){if(this.IsBusy){var a=this.GetHourGlassDiv();if(a){a.style.cursor="default";a.style.display="none"}}this.InteractiveObject.Resizable=this.InteractiveObject.OriginalResizable;this.IsBusy=false}}function WebDesktopWindowSettings(){this._Type="WebDesktopWindowSettings";ISObject.call(this);this.AllowMinimize="Yes";this.AllowMaximize="Yes";this.AllowResize="Yes";this.AllowClose="Yes";this.ControlBox="Yes";this.TextAlignment="Left";this.WindowStyle=null;this.OuterBorderStyle="";this.CaptionStyle=null;this.CaptionDisplayMode="Text";this.ContentMode="UseInlineContent";this.CaptionButtonStyle=null;this.Size=new UnitSize();this.MaximumSize=new UnitSize();this.MinimumSize=new UnitSize();this.BorderType="Simple";this.DropShadow=false;this.IFrameAllowTransparency=true;this.IFrameShowLoader=true;this.ContainerStyle="";this.CommandButtonStyle=null;this.CommandButtonBorderType="Simple";this.CommandBarPadding=10;this.CommandButtonDisabledStyle="";this.CaptionButtonSpacing=2;this.IgnoreIFramePadding=false;this.EnableFastWindowActivation=false;this.CachedStyles=new Array();this.WindowHeaderHeight=24;this.ApplyContainerStyle=false;this.DimWindowWhenBusy=false;this.IFrameReadyTransitionEffect="None";this.WindowOptionsPosition="Right";this.ControlBoxPosition="Left";this.OnPropertiesInitialized=function(){if(ISXml.GetAttribute(this.XmlNode,"Size")!=null){this.Size.Parse(ISXml.GetAttribute(this.XmlNode,"Size"))}if(ISXml.GetAttribute(this.XmlNode,"MinimumSize")!=null){this.MinimumSize.Parse(ISXml.GetAttribute(this.XmlNode,"MinimumSize"))}if(ISXml.GetAttribute(this.XmlNode,"MaximumSize")!=null){this.MaximumSize.Parse(ISXml.GetAttribute(this.XmlNode,"MaximumSize"))}}}function InitWebDesktopManager(b){var a=WebDMEngine.Create(b);a.OnInitialize()}function OnWebDMRSC(c,a){var d=c.name;var b=ISGetObject(a);if(b){var e=b.GetWindow(d);if(IS.ie11){WebDMEngine.IFrameContentLoaded(e,true)}else{WebDMEngine.IFrameContentLoaded(e)}}else{setTimeout(function(){OnWebDMRSC(c,a)},10)}}var WebDMEngine={Initialized:false,ResourcesList:null,Create:function(b){var a=new WebDesktopManager(b);WebDMEngine.AssignProperties(a);WebDMEngine.RegisterBehaviour(a);WebDMEngine.InitializeMozilla(a);WebDMEngine.InitializeSystemMenu(a);WebDMEngine.PreloadImages(a);if(IS.IsHTML5DocType()){WebDMEngine.SetTaskBarSeparator(a)}a.IsInit=true;return a},SetWindowSeparator:function(c){var g=c.GetWindowOptionsCellElement();var e=c.GetControlBoxCellElement();var h=c.GetCaptionBarTextCellElement();var f=c.GetWindowDivElement();var d=c.GetCaptionBarCellElement();var b=0;if(c.DesktopManager.WindowSettings.BorderType=="Simple"){if(g.offsetWidth!=0){for(var a=0;a<g.children.length;a++){b+=g.children[a].offsetWidth}if(b<10){b=14}g.parentElement.parentElement.style.width=(b+2)+"px";if(g.parentElement.parentElement.nextSibling!=null){g.parentElement.parentElement.nextSibling.style.left=(b+2)+"px"}else{if(g.parentElement.parentElement.previousSibling!=null){g.parentElement.parentElement.previousSibling.style.right=(b+2)+"px"}}if(c.DesktopManager.WindowSettings.MinimumSize.Width==null){if(e==null&&h==null){f.style.minWidth=(b+20)+"px"}else{if(e==null){f.style.minWidth=(b+h.offsetWidth+20)+"px"}else{if(h==null){f.style.minWidth=(b+e.offsetWidth+20)+"px"}else{f.style.minWidth=(b+e.offsetWidth+h.offsetWidth+20)+"px"}}}}else{f.style.minWidth=c.DesktopManager.WindowSettings.MinimumSize.Width+"px"}}}else{if(g.offsetWidth!=0){for(var a=0;a<c.GetCaptionBarCellElement().children[0].children.length;a++){if(a==0){if(c.GetCaptionBarCellElement().children[0].children[a].children[0].nodeName=="IMG"){c.GetCaptionBarCellElement().children[0].children[a].style.width=c.GetCaptionBarCellElement().children[0].children[a].children[0].naturalWidth+"px";c.GetCaptionBarCellElement().children[0].children[a+1].style.left=c.GetCaptionBarCellElement().children[0].children[a].style.width}}else{if(a==c.GetCaptionBarCellElement().children[0].children.length-1){if(c.GetCaptionBarCellElement().children[0].children[a].children[0].nodeName=="IMG"){c.GetCaptionBarCellElement().children[0].children[a].style.width=c.GetCaptionBarCellElement().children[0].children[a].children[0].naturalWidth+"px";c.GetCaptionBarCellElement().children[0].children[a-1].style.right=c.GetCaptionBarCellElement().children[0].children[a].style.width}}}}for(var a=0;a<g.children.length;a++){b+=g.children[a].offsetWidth}g.parentElement.parentElement.style.width=(b)+"px";if(g.parentElement.parentElement.nextSibling!=null){g.parentElement.parentElement.nextSibling.style.left=(b)+"px"}else{if(g.parentElement.parentElement.previousSibling!=null){g.parentElement.parentElement.previousSibling.style.right=(b)+"px"}}if(c.DesktopManager.WindowSettings.MinimumSize.Width==null){if(e==null&&h==null){f.style.minWidth=(b+d.children[0].children[0].offsetWidth+d.children[0].children[2].offsetWidth+20)+"px"}else{if(e==null){f.style.minWidth=(b+h.offsetWidth+d.children[0].children[0].offsetWidth+d.children[0].children[2].offsetWidth+20)+"px"}else{if(h==null){f.style.minWidth=(b+e.offsetWidth+d.children[0].children[0].offsetWidth+d.children[0].children[2].offsetWidth+20)+"px"}else{f.style.minWidth=(b+e.offsetWidth+h.offsetWidth+d.children[0].children[0].offsetWidth+d.children[0].children[2].offsetWidth+20)+"px"}}}}}}},SetTaskBarSeparator:function(a){left=a.GetTaskBarLeftTemplateElement();right=a.GetTaskBarRightTemplateElement();var d=0;var e=0;if(left!=null){for(var b=0;b<left.children.length;b++){d+=left.children[b].offsetWidth}if(d!=0){left.width=d+"px"}}if(right!=null){for(var b=0;b<right.children.length;b++){e+=right.children[b].offsetWidth}if(e!=0){right.width=e+"px"}}},PreloadImages:function(a){if(a.WindowSettings.BorderType=="ComplexImages"){var d=new Array();var e=a.ImagesSettings;var b=0;for(var g in e){var f=e[g];if(typeof(f)=="string"&&f!=""&&f!=e._Type){var h=a.ResolveImagePath(f);d[b]=new Image();d[b].src=h;b++}}}},AssignProperties:function(a){if(a==null){return}if(!a.IsInit){var g=null;if(typeof(IS_ReleaseType)!="undefined"&&IS_ReleaseType=="Beta"){a.ScriptDirectory="/CommonLibraryBeta/WebDesktop/V3_0_7200/";a.ImagesDirectory="/CommonLibraryBeta/Images/WebDesktop/"}try{g=ISXml.GetNode(a.XmlDt,"//WebDesktopManager")}catch(d){}if(g==null){g=a.XmlDt.documentElement}if(g!=null){IS.SetPropertiesRecursive(a,g);a.TaskBarButtonStyle=DynamicStyleEngine.Assign(ISXml.GetNode(a.XmlDt,"//TaskBarButtonStyle"));a.ShortcutStyle=DynamicStyleEngine.Assign(ISXml.GetNode(a.XmlDt,"//ShortcutStyle"));var b=["CaptionButtonStyle","CaptionStyle","WindowStyle","CommandButtonStyle"];var f=["ItemStyle","DisabledItemStyle","CheckedItemStyle"];DynamicStyleEngine.AssignFromArray(a.WindowSettings,a.WindowSettings.XmlNode,b);if(a.EnableContextMenu){DynamicStyleEngine.AssignFromArray(a.MenuStyles.Application,a.MenuStyles.Application.XmlNode,f);DynamicStyleEngine.AssignFromArray(a.MenuStyles.System,a.MenuStyles.System.XmlNode,f)}}}},UnregisterWindowBehaviour:function(e){var f=e.GetWindowDivElement();if(!f){return}var g=e.GetWindowOptionsCellElement();if(f){Listener.Unload(f)}if(g){Listener.Unload(g)}if(e.Get("ContentMode")=="UseInlineContent"){var b=e.GetContentDivElement();if(b){Listener.Unload(b)}}var a=e.GetCaptionBarTableElement();if(a){Listener.Unload(a)}var c=e.GetControlBoxCellElement();if(c){Listener.Unload(c)}var d=e.GetTaskBarButtonElement();if(d){Listener.Unload(d)}},UnregisterBehaviour:function(a){var d=a.FrameObj;var b=a.GetDesktopElement();Listener.Unload(d);Listener.Unload(b);Listener.Unload(document.body);var f=a.GetTaskBarWindowGroupElement();if(f){Listener.Unload(f)}for(var e=0;e<a.Windows.length;e++){var g=a.Windows[e];WebDMEngine.UnregisterWindowBehaviour(g)}window.detachEvent("onload",function(){WebDMEngine.OnWindowOnLoad(a)});if(IS.moz){window.detachEvent("onresize",function(){WebDMEngine.OnResize(a)})}},RegisterWindowBehaviour:function(f){var a=f.DesktopManager;var g=f.GetWindowDivElement();var h=f.GetWindowOptionsCellElement();if(g){Listener.Add(g,"onmousedown",WebDMEngine.OnWindowMouseDown,f);Listener.Add(g,"onmousemove",WebDMEngine.OnWindowMouseMove,f);Listener.Add(h,"onmousedown",WebDMEngine.OnOptionsMouseEvent,f);Listener.Add(h,"onmouseup",WebDMEngine.OnOptionsMouseEvent,f);Listener.Add(h,"onmouseover",WebDMEngine.OnOptionsMouseEvent,f);Listener.Add(h,"onmouseout",WebDMEngine.OnOptionsMouseEvent,f);if(f.Get("ContentMode")=="UseInlineContent"){var d=f.GetContentDivElement();Listener.Add(d,"onselectstart",function(){WebDMEngine.OnContentSelectStart(a)});Listener.Add(d,"onscroll",function(){WebDMEngine.OnContentScroll(a)})}var b=f.GetCaptionBarTableElement();if(b){Listener.Add(b,"ondblclick",function(){WebDMEngine.OnCaptionBarDblClick(a)});Listener.Add(b,"oncontextmenu",function(){return WebDMEngine.OnCaptionBarContextMenu(a)})}var e=f.GetControlBoxCellElement();if(e){Listener.Add(e,"onclick",function(){WebDMEngine.OnControlBoxClick(a)})}}},RegisterBehaviour:function(a){var d=a.FrameObj;var b=a.GetDesktopElement();Listener.Add(d,"onresize",function(){WebDMEngine.OnResize(a)});Listener.Add(d,"onselectstart",function(){WebDMEngine.OnSelectStart(a)});Listener.Add(d,"ondragstart",function(){event.cancelBubble=true;return false});Listener.Add(b,"onmousedown",function(){WebDMEngine.OnDesktopMouseEvent(a)});Listener.Add(b,"ondblclick",function(){WebDMEngine.OnDesktopMouseEvent(a)});Listener.Add(b,"onkeydown",function(){WebDMEngine.OnDesktopKeyDown(a)});Listener.Add(b,"oncontextmenu",function(){return WebDMEngine.OnDesktopContextMenu(a)});var f=a.GetTaskBarWindowGroupElement();if(f){Listener.Add(f,"onmousedown",function(){WebDMEngine.OnTaskBarMouseEvent(a)});Listener.Add(f,"onmouseup",function(){WebDMEngine.OnTaskBarMouseEvent(a)});Listener.Add(f,"onmouseover",function(){WebDMEngine.OnTaskBarMouseEvent(a)});Listener.Add(f,"onmouseout",function(){WebDMEngine.OnTaskBarMouseEvent(a)});Listener.Add(f,"oncontextmenu",function(){return WebDMEngine.OnTaskBarMouseEvent(a)})}if(IS.ie11){a.Windows.ReindexPosition()}for(var e=0;e<a.Windows.length;e++){WebDMEngine.RegisterWindowBehaviour(a.Windows[e])}window.attachEvent("onload",function(){WebDMEngine.OnWindowOnLoad(a)});window.attachEvent("onresize",function(){WebDMEngine.OnResize(a)})},InitializeMozilla:function(a){if(IS.moz){var b=a.FrameObj;b.tabindex=0;b.style.MozUserFocus="normal";for(var d=0;d<a.Windows.length;d++){var e=a.Windows[d];var f=e.GetWindowDivElement();f.style.overflow="hidden"}}},InitializeStartupWindows:function(b){var a=false;var h=null;if(b.WindowArrangement=="Cascaded"){b.CascadeWindows(true)}else{if(b.WindowArrangement=="TiledHorizontally"){b.TileWindowsHorizontally(true)}else{if(b.WindowArrangement=="TiledVertically"){b.TileWindowsVertically(true)}}}for(var e=0;e<b.Windows.length;e++){var g=b.Windows[e];if(g.ClientVisible){if(g.WindowState=="Normal"){g.Show()}else{if(g.WindowState=="Maximized"){g.Show();g.WindowState="Normal";g.Maximize(null,false)}else{g.Hide();if(e==b.ActiveWindowIndex){if(b.Windows[e+1]!=null&&!a){var f=b.Windows[e+1];if(f.ClientVisible&&f.WindowState!="Minimized"){b.ActiveWindowIndex=e;a=true;h=f}}}}}g.StartupPositionInitialized=true}else{g.Hide()}if(g.Get("ContentMode")=="UseIFrame"){var d=g.GetContentDivElement();d.style.overflow="hidden";d.style.overflowY="hidden";d.style.overflowX="hidden"}g.Initialized=true}if(b.ActiveWindowIndex>-1&&b.Windows.length>b.ActiveWindowIndex&&b.Windows[b.ActiveWindowIndex].ClientVisible&&!h){b.Windows[b.ActiveWindowIndex].Activate()}else{if(h){h.Activate()}else{b.ActiveWindowIndex=-1}}WebDMEngine.EnsureTaskBarWidth(b);WebDMEngine.RearrangeShortcutIcons(b);WebDMEngine.CalculateTaskBarButtons(b)},InitializeInteractiveObjects:function(a){for(var b=0;b<a.Windows.length;b++){var f=a.Windows[b];var d=new ISInteractiveObject();if(f.Get("AllowResize")=="Yes"){d.Resizable=true}d.Window=f;d.DesktopManager=a;d.Movable=true;d.DragElement=f.GetCaptionBarTableElement();d.FrameElement=f.GetWindowDivElement();a.InteractiveObjects[a.InteractiveObjects.length]=d;f.InteractiveObject=d}if(a.ShortcutSettings.Movable){for(var b=0;b<a.ShortcutIcons.length;b++){var e=a.ShortcutIcons[b];var d=new ISInteractiveObject();d.DesktopManager=a;d.Movable=true;d.DragElement=e.GetElement();d.FrameElement=e.GetElement();a.InteractiveObjects[a.InteractiveObjects.length]=d;e.InteractiveObject=d}}},CompareNumbers:function(c,d){return c-d},EnsureTaskBarWidth:function(a){var d=a.GetTaskBarLeftTemplateElement();var e=a.GetTaskBarRightTemplateElement();if(d){d.style.width=d.scrollWidth;if(IS.moz&&d.scrollWidth==0&&d.children.length>0){d.style.width=d.children[0].offsetWidth}}if(e){e.style.width=e.scrollWidth;if(IS.moz&&e.scrollWidth==0&&e.children.length>0){e.style.width=e.children[0].offsetWidth}if(IS.ie&&e.scrollWidth==0&&e.children.length>0){var f=0;for(var b=0;b<e.children.length;b++){f+=e.children[b].offsetWidth}e.style.width=f+"px"}}},OnSelectStart:function(a){var d=event.srcElement;var e=d.tagName;var b=true;switch(e){case"INPUT":case"SELECT":case"TEXTAREA":b=false}if(b){event.cancelBubble=true;event.returnValue=false}},OnContentScroll:function(a){if(IS.ie){if(typeof(ISWinEngine)=="object"){ISWinEngine.IsMouseDown=false}}},OnContentSelectStart:function(a){if(typeof(ISWinEngine)=="object"){if(ISWinEngine.IsMouseDown&&ISWinEngine.LastValidObject){return true}}event.cancelBubble=true;return true},OnCaptionBarDblClick:function(a){var d=event.srcElement;var e=WebDMEngine.GetWindowByElement(a,d);if(d&&d.tagName=="INPUT"){return}if(e){var b=e.GetControlBoxElement();if(b&&b.contains(d)){if(a.WindowSettings.ControlBoxPosition=="Left"){if(e.Get("AllowClose")=="Yes"){e.Close();return}}else{if(b.children[0]==d&&e.Get("AllowClose")=="Yes"){e.Close();return}}}if(e.WindowState=="Normal"&&e.Get("AllowMaximize")=="Yes"){e.Maximize(true,true)}else{if(e.WindowState=="Maximized"||e.WindowState=="Minimized"){e.Restore(true,true)}}}},OnDesktopKeyDown:function(d,q,l,f,b,p){var i=event;if(q){i=new Object();i.srcElement=q;i.keyCode=l;i.ctrlKey=f;i.altKey=b;i.shiftKey=p}var h=i.srcElement;var l=i.keyCode;var j=false;if(!d.EnableKeyboardNavigation){return false}switch(l){case 49:if(i.ctrlKey){var k=true;var s=null;var a=d.GetActiveWindow();if(i.shiftKey){k=false}if(a){if(k){s=a.GetNextWindowExact()}else{s=a.GetPreviousWindowExact()}}else{if(d.Windows.length>0){s=d.Windows[0]}}if(s){s.Activate();j=true}}break;case 67:if(i.ctrlKey&&i.altKey){var a=d.GetActiveWindow();if(a&&a.Get("AllowClose")=="Yes"){a.Close();j=true}}break;case ISKeyboardKey.LEFT:case ISKeyboardKey.RIGHT:case ISKeyboardKey.DOWN:case ISKeyboardKey.UP:var o=WebDMEngine.GetShortcutDiv(h);if(o){var m=WebDMEngine.GetWindowName(o.id,d.Id);var n=d.ShortcutIcons.GetNamedItem(m);var r=null;if(IS.moz){n=d.ShortcutIcons[d.ActiveShortcutIndex]}if(l==ISKeyboardKey.LEFT||l==ISKeyboardKey.UP){r=d.ShortcutIcons[n.Index-1];if(!r&&d.ShortcutIcons.length>0){r=d.ShortcutIcons[0]}}else{if(l==ISKeyboardKey.RIGHT||l==ISKeyboardKey.DOWN){r=d.ShortcutIcons[n.Index+1];if(!r&&d.ShortcutIcons.length>0){r=d.ShortcutIcons[d.ShortcutIcons.length-1]}}}if(r&&r.Visible){r.Select(true);if(IS.ie){r.GetElement().focus()}j=true}}break;case ISKeyboardKey.ENTER:var o=WebDMEngine.GetShortcutDiv(h);if(o){var m=WebDMEngine.GetWindowName(o.id,d.Id);var n=d.ShortcutIcons.GetNamedItem(m);var r=null;if(IS.moz){n=d.ShortcutIcons[d.ActiveShortcutIndex]}if(n&&n.Visible&&n.Enabled){n.Open(true)}}j=true;break}if(j){try{i.keyCode=0}catch(g){}i.cancelBubble=true;i.returnValue=false}},GetShortcutDiv:function(a){if(a.tagName=="DIV"){if(a.id.indexOf("dvSCI")>-1){return a}}while(a.parentElement!=null){a=a.parentElement;if(a.tagName=="DIV"&&a.id.indexOf("dvSCI")>-1){return a}}return null},OnDesktopMouseEvent:function(b){var j=event.type;var d=event.srcElement;var f;var g="";if(d.tagName=="DIV"){if(d.id.indexOf("dvDesktop")>-1){f=d;g="Desktop"}else{if(d.id.indexOf("dvSCI")>-1){f=d;g="Shortcut"}}}if(!f){while(d.parentElement!=null){d=d.parentElement;if(d.tagName=="DIV"&&d.id.indexOf("dvSCI")>-1){f=d;g="Shortcut";break}}}if(f){if(j=="mousedown"){if(IS.ie11){if(ISEvent.IsLeftButton(event)){if(g=="Desktop"){var a=b.GetActiveShortcut();if(a){DynamicStyleEngine.SetToStyle(null,b.ShortcutStyle,a.GetTextElement());if(b.UseCssFramework){var d=a.GetElement();var i=d.getAttribute("state");if(i&&i.toLowerCase()=="active"){d.removeAttribute("state")}}}b.ActiveShortcutIndex=-1}else{var e=WebDMEngine.GetWindowName(f.id,b.Id);var h=b.ShortcutIcons.GetNamedItem(e);if(h){h.Select(true)}}}}else{if(event.button==ISEvent.LEFT){if(g=="Desktop"){var a=b.GetActiveShortcut();if(a){DynamicStyleEngine.SetToStyle(null,b.ShortcutStyle,a.GetTextElement());if(b.UseCssFramework){var d=a.GetElement();var i=d.getAttribute("state");if(i&&i.toLowerCase()=="active"){d.removeAttribute("state")}}}b.ActiveShortcutIndex=-1}else{var e=WebDMEngine.GetWindowName(f.id,b.Id);var h=b.ShortcutIcons.GetNamedItem(e);if(h){h.Select(true)}}}}}else{if(j=="dblclick"){if(g=="Shortcut"){var e=WebDMEngine.GetWindowName(f.id,b.Id);var h=b.ShortcutIcons.GetNamedItem(e);if(h){h.Open(true)}}if(IS.moz){event.cancelBubble=true;event.returnValue=false}}}}},OnOptionsMouseEvent:function(){var g=this;var f=event.srcElement;if(!g){return}var e=g.GetMinimizeButtonElement();var d=g.GetMaximizeButtonElement();var c=g.GetCloseButtonElement();var a=[e,d,c];for(var b in a){b=a[b];if(b){if(b==f||(typeof(b.contains)!="undefined"&&b.contains(f))){WebDMEngine.SetOptionButtonStyle(g,event.type,b);return}}}},SetOptionButtonStyle:function(i,h,b){var d=i.DesktopManager;var j=d.WindowSettings;var a=j.BorderType;var g=d.ImagesSettings;if(h=="mouseover"){if(a=="Simple"){DynamicStyleEngine.SetToOverStyle(null,j.CaptionButtonStyle,b)}else{if(a=="ComplexImages"){var f=b.children[0];var e="";if(IS.GetAttr(b,"type")=="Min"){e=d.ResolveImagePath(g.MinimizeOver)}else{if(IS.GetAttr(b,"type")=="Max"){if(i.WindowState=="Maximized"){e=d.ResolveImagePath(g.RestoreOver)}else{e=d.ResolveImagePath(g.MaximizeOver)}}else{e=d.ResolveImagePath(g.CloseOver)}}f.src=e}}}else{if(h=="mouseout"||h=="mouseup"){if(a=="Simple"){DynamicStyleEngine.SetToStyle(null,j.CaptionButtonStyle,b)}else{if(a=="ComplexImages"){var f=b.children[0];var e="";if(i.IsActiveWindow()||(i.IsDialogBox)){if(IS.GetAttr(b,"type")=="Min"){e=d.ResolveImagePath(g.MinimizeActive)}else{if(IS.GetAttr(b,"type")=="Max"){if(i.WindowState=="Maximized"){e=d.ResolveImagePath(g.RestoreActive)}else{e=d.ResolveImagePath(g.MaximizeActive)}}else{e=d.ResolveImagePath(g.CloseActive)}}}else{if(IS.GetAttr(b,"type")=="Min"){e=d.ResolveImagePath(g.MinimizeInactive)}else{if(IS.GetAttr(b,"type")=="Max"){if(i.WindowState=="Maximized"){e=d.ResolveImagePath(g.RestoreInactive)}else{e=d.ResolveImagePath(g.MaximizeInactive)}}else{e=d.ResolveImagePath(g.CloseInactive)}}}f.src=e}}}else{if(h=="mousedown"){if(a=="Simple"){DynamicStyleEngine.SetToActiveStyle(null,j.CaptionButtonStyle,b)}else{if(a=="ComplexImages"){var f=b.children[0];var e="";if(IS.GetAttr(b,"type")=="Min"){e=d.ResolveImagePath(g.MinimizeDown)}else{if(IS.GetAttr(b,"type")=="Max"){if(i.WindowState=="Maximized"){e=d.ResolveImagePath(g.RestoreDown)}else{e=d.ResolveImagePath(g.MaximizeDown)}}else{e=d.ResolveImagePath(g.CloseDown)}}f.src=e}}}}}if(h=="mouseup"){var c=IS.GetAttr(b,"type");if(c=="Min"){if(i.WindowState!="Minimized"){i.Minimize(true,true)}else{i.Restore(true,true)}}else{if(c=="Max"){if(i.WindowState!="Maximized"){i.Maximize(true,true)}else{i.Restore(true,true)}}else{if(c=="Close"){if(!b.disabled){i.Close(true)}}}}if(typeof(ISWinEngine)=="object"){ISWinEngine.IsMouseDown=false}}if(IS.moz){event.cancelBubble=true;event.returnValue=false}},OnTaskBarMouseEvent:function(a){var e=event.srcElement;var f=WebDMEngine.GetTD(e);if(typeof(f)!="undefined"&&IS.GetAttr(f,"name")!=""){var g=event.type;var i=IS.GetAttr(f,"name");var h=a.GetWindow(i);if(h&&h.DesktopManager){if(h.DesktopManager.TaskBarLocked){return}}if(g=="mouseover"){if(!h.IsActiveWindow()){var b=null;if(!a.UseCssFramework){b=IS.GetCssObject(null,a.TaskBarButtonStyle.Over)}if(b||a.UseCssFramework){DynamicStyleEngine.SetToOverStyle(null,a.TaskBarButtonStyle,f)}}var d=f.children[0];if(d.scrollWidth>d.offsetWidth){f.title=d.innerText}else{f.title=""}}else{if(g=="mouseout"){if(!h.IsActiveWindow()){DynamicStyleEngine.SetToStyle(null,a.TaskBarButtonStyle,f)}}else{if(g=="mousedown"){if(!h.IsActiveWindow()){DynamicStyleEngine.SetToActiveStyle(null,a.TaskBarButtonStyle,f)}}else{if(g=="mouseup"){if(IS.ie11){if(ISEvent.IsLeftButton(event)){if(h.IsActiveWindow()){h.Minimize(true,true)}else{WebDMEngine.ActivateWithEvents(a,h)}}}else{if(event.button==ISEvent.LEFT){if(h.IsActiveWindow()){h.Minimize(true,true)}else{WebDMEngine.ActivateWithEvents(a,h)}}}}else{if(g=="contextmenu"){event.cancelBubble=true;event.returnValue=false;WebDMEngine.ShowWindowContextMenu(h);return false}}}}}}},OnResize:function(a){WebDMEngine.ResetShortcutLocations(a);WebDMEngine.RearrangeShortcutIcons(a);WebDMEngine.CalculateTaskBarButtons(a);WebDMEngine.ResizeMaximizedWindows(a);a.CachedDesktopSize=null},DispatchWindowResize:function(){if(document.createEvent){var a=document.createEvent("HTMLEvents");a.initEvent("resize",false,false);window.dispatchEvent(a)}},OnWindowOnLoad:function(a){WebDMEngine.InitializeStartupWindows(a);if(IS.moz){for(var b=0;b<a.Windows.length;b++){var e=a.Windows[b];if(e.Get("ContentMode")=="UseIFrame"){WebDMEngine.HookIFrameEvents(a,a.GetIFrameWindow(e.Name))}}}if(IS.IsHTML5DocType()){for(b=0;b<a.Windows.length;b++){var d=a.Windows[b];WebDMEngine.SetWindowSeparator(d)}}setTimeout(function(){WebDMEngine.DispatchWindowResize()},10)},OnWindowMouseDown:function(b){if(!b||typeof(b.IsActiveWindow)!="function"){b=this}if(!b.IsActiveWindow()){var a=b.DesktopManager;if(b.IsDialogBox){b.DialogBox.Activate()}else{WebDMEngine.ActivateWithEvents(a,b)}}},OnWindowMouseMove:function(a){},OnIFrameMouseDown:function(a,e,f){if(f){e=f}var d=window.frames[e];if(d){var b=d.event;var g=a.GetWindow(e);if(g!=null&&!g.IsActiveWindow()){WebDMEngine.OnWindowMouseDown(g)}}},OnIFrameKeyDown:function(a,e,f){var d=window.frames[e];if(d){var b=d.event;var g=a.GetWindow(e);if(g){WebDMEngine.OnDesktopKeyDown(a,g.GetWindowDivElement(),b.keyCode,b.ctrlKey,b.altKey,b.shiftKey)}}},OnIFrameMouseUp:function(a,d,e){if(e){d=e}var b=window.frames[d];if(!b){return}if(typeof(ISWinEngine)=="object"){var f=a.GetWindow(d);if(IS.ie){ISWinEngine.Event=b.event}else{ISWinEngine.Event=event}ISWinEngine.OnMouseUp()}},OnIFrameUnload:function(a,b){if(a==null||a.ClassName==null){return false}var d=a.GetWindow(b);if(!d){return}d.IFrameContentLoaded=false;if(IS.moz){setTimeout(function(){WebDMEngine.CheckMozReadyState(a,b)},50)}},OnIFrameMouseMove:function(a,b,f){var e=b.name;var d=window.frames[e];var g=e;if(typeof(f)=="string"){d=window.frames[f];g=f}if(typeof(ISWinEngine)=="object"){var i=a.GetWindow(g);var h=null;if(i==null){return}if(f){if(b.event){ISWinEngine.Event=b.event}else{ISWinEngine.Event=event}ISWinEngine.Event.FrameElement=b.frameElement;ISWinEngine.Event.IsChildFrame=true;ISWinEngine.Event.ParentFrameName=f}else{if(d==null){return}if(b.event){ISWinEngine.Event=d.event}else{ISWinEngine.Event=event}ISWinEngine.Event.FrameElement=i.GetWindowIFrameElement()}ISWinEngine.Event.Window=i;ISWinEngine.OnMouseMove()}},CheckMozReadyState:function(a,d){var b=a.GetIFrameWindow(d)},GetWindowName:function(d,a){if(!a){var c=d.lastIndexOf("_");return d.substring(c+1)}else{var b=d.indexOf(a);return d.substring(b+a.length+1)}},GetTD:function(a){if(a.tagName=="TD"){return a}while(a.parentElement!=null){a=a.parentElement;if(a.tagName=="TD"){return a}}return null},GetWindowElement:function(a){if(a.tagName=="DIV"&&a.id.indexOf("dvWnd")>-1){return a}while(a.parentElement!=null){a=a.parentElement;if(a.tagName=="DIV"&&a.id.indexOf("dvWnd")>-1){return a}}return null},GetWindowByElement:function(a,d){var d=event.srcElement;var f=WebDMEngine.GetWindowElement(d);var b="";if(f){b=WebDMEngine.GetWindowName(f.id,a.Id)}if(b!=""){var e=a.GetWindow(b);return e}return null},CalculateTaskBarButtons:function(a,g){var j=a.GetTaskBarWindowGroupElement();if(!j){return null}var d=j.children[0];var h=d.children[0];if(!a.IsInResizing){a.IsInResizing=true;if(d.currentMode=="justify"){var e=null;for(var f=0;f<h.rows[0].cells.length;f++){var b=h.rows[0].cells[f];if(IS.GetAttr(b,"name")!=""&&b.style.display!="none"){e=b;break}}if(e){if(e.offsetWidth>a.TaskBarSettings.WindowButtonWidth){d.currentMode="normal"}}}if(d.offsetWidth>=h.offsetWidth&&d.currentMode!="justify"){for(var f=0;f<h.rows[0].cells.length;f++){var b=h.rows[0].cells[f];if(IS.GetAttr(b,"name")!=""){b.style.width=a.TaskBarSettings.WindowButtonWidth+"px"}}h.rows[0].cells[h.rows[0].cells.length-1].style.width="100%";d.currentMode="normal"}else{if(d.currentMode!="justify"||g){for(var f=0;f<h.rows[0].cells.length;f++){var b=h.rows[0].cells[f];if(IS.GetAttr(b,"name")!=""){b.style.width="auto"}}h.rows[0].cells[h.rows[0].cells.length-1].style.width="0%";d.currentMode="justify"}}a.IsInResizing=false}},RearrangeShortcutIcons:function(a){if(a.ShortcutIconsVisible){for(var b=0;b<a.ShortcutIcons.length;b++){var d=a.ShortcutIcons[b];d.Rearrange()}}},ResetShortcutLocations:function(a){var e=a.ShortcutSettings;for(var b=0;b<a.ShortcutIcons.length;b++){var d=a.ShortcutIcons[b];if(e.AllowAutoArrange||d.Location.IsEmpty()){d.RuntimeLocation=new OffsetLocation()}}},CascadeWindows:function(a,e,b){for(var d=0;d<a.Windows.length;d++){var f=a.Windows[d];if(b&&f.Get("AllowResize")=="No"){f.ForceNoResize=true}if(!f.IsDialogBox){f.InitializeLayout("Cascade",e)}}},TileWindows:function(a,e,f,b){for(var d=0;d<a.Windows.length;d++){var g=a.Windows[d];if(b&&g.Get("AllowResize")=="No"){g.ForceNoResize=true}if(!g.IsDialogBox){g.InitializeLayout("TileWindows"+f,e)}}},MoveWindowTo:function(a,c,d){var b=a.GetWindowDivElement();a.Location.X=c;a.Location.Y=d;b.style.left=c+"px";b.style.top=d+"px";if(a.EnableDropShadow&&a.DropShadow!=null){a.DropShadow.UpdatePosition()}},ResizeWindowTo:function(f,g,c){var h=f.GetWindowDivElement();if(typeof(g)=="string"){g=parseFloat(g)}if(typeof(c)=="string"){c=parseFloat(c)}if(!f.IsTargetSizeValid(g,c)){var e=f.GetPreferredSize(g,c);g=e.Width;c=e.Height}f.Size.Width=g;f.Size.Height=c;h.style.width=g+"px";h.style.height=c+"px";if(f.EnableDropShadow&&f.DropShadow!=null){f.DropShadow.UpdatePosition()}if(IS.moz){if(f.Get("ContentMode")=="UseInlineContent"){if(!IS.IsHTML5DocType()){var b=f.GetContentDivElement();var d=b.children[0];var a=f.GetCaptionBarTableElement();d.style.height="0pt"}}WebDMEngine.FixMozillaWindowSize(f)}else{WebDMEngine.FixIEWindowSize(f)}if(IS.IsHTML5DocType()){WebDMEngine.SetWindowSeparator(f)}},FixIEWindowSize:function(e,d){var f=e.GetWindowDivElement();var a=e.GetContentDivElement();var b=e.DesktopManager;if(e.Get("ContentMode")=="UseIFrame"){var c=e.GetWindowIFrameElement();if(b.WindowSettings.BorderType=="ComplexImages"){if(IsIE8StandardMode()&&!IS.IsHTML5DocType()){if(d){a.style.display="none"}setTimeout(function(){a.style.height=ISPosLib.getHeight(a.parentElement);if(d){a.style.display=""}},10)}}if(c){c.style.display="none";c.style.height="100%";c.style.display="";if(IS.IsHTML5DocType()){c.parentElement.style.overflow="hidden"}}}},FixMozillaWindowSize:function(e){var f=e.GetWindowDivElement();var a=e.GetContentDivElement();var c=e.DesktopManager;if(IS.safari){return}if(c.WindowSettings.BorderType=="Simple"){a.style.overflow="visible";if(!e.IsDialogBox||c.UseCssFramework){setTimeout(function(){a.style.overflow="auto"})}}else{a.style.overflow="visible";var b=a.children[0];b.style.overflow="visible";b.style.display="none";setTimeout(function(){if(!e.IsDialogBox){a.style.overflow="auto"}b.style.display="";var g=b.children[0];if(g!=null&&g.clientHeight==0){b.style.height="100%"}})}if(e.Get("ContentMode")=="UseIFrame"){var d=e.GetWindowIFrameElement();if(d){if(IS.moz){d.style.display="none"}d.parentElement.style.display="none";setTimeout(function(){var g=d.parentElement;if(IS.moz||g.offsetHeight==0){g=g.parentElement}if(g.offsetHeight>0){if(!c.UseCssFramework){d.style.height=(ISPosLib.getHeight(g)-(IS.moz?((parseFloat(g.currentStyle.paddingTop)*2)):0))+"px"}d.style.display="";d.parentElement.style.display=""}else{WebDMEngine.FixMozillaWindowSize(e)}},10)}}},DecreaseZIndex:function(a){for(var b=0;b<a.Windows.length;b++){var d=a.Windows[b];var e=d.GetWindowDivElement();if(e){var f=e.style.zIndex-1;e.style.zIndex=f}}},IFrameContentLoaded:function(h,a){var e=h.GetWindowIFrameElement();var b=false;if(!e){return}if(!h.ClientVisible){if(h.WindowState=="Minimized"||h.WindowState=="Maximized"){b=true}else{return false}}if(a){e.readyState="complete"}var f=h.DesktopManager.GetIFrameWindow(e.name);var g=e.parentElement;var c=h.DesktopManager;var i=c.WindowSettings;if(!h.IFrameContentLoaded&&e.readyState=="complete"){var d=g.children[1];if(d&&d.tagName=="DIV"){if(!b){if(d.style.display!="none"){e.style.display="";WebDMEngine.PlayTransition(d,i.IFrameReadyTransitionEffect)}else{e.style.display="";e.style.visibility="hidden";WebDMEngine.PlayTransition(e,i.IFrameReadyTransitionEffect,true)}}if(i.IFrameReadyTransitionEffect=="None"||b){d.removeNode(true)}else{setTimeout(function(){if(d){d.removeNode(true)}},500)}}WebDMEngine.HookIFrameEvents(c,f);h.IFrameContentLoaded=true}},HookIFrameEvents:function(a,h,j){var b=null;try{b=h.document.body}catch(c){}if(b){if(IS.GetAttr(b,"ISWinEventsInitialized")==""){Listener.Add(b,"onmousedown",function(){WebDMEngine.OnIFrameMouseDown(a,h.name,j)});Listener.Add(b,"onmouseup",function(){WebDMEngine.OnIFrameMouseUp(a,h.name,j)});Listener.Add(b,"onunload",function(){WebDMEngine.OnIFrameUnload(a,h.name,j)});Listener.Add(b,"onmousemove",function(){WebDMEngine.OnIFrameMouseMove(a,h,j)});Listener.Add(b,"onkeydown",function(){WebDMEngine.OnIFrameKeyDown(a,h.name,j)});b.ISWinEventsInitialized=true}var f=b.getElementsByTagName("IFRAME");for(var d=0;d<f.length;d++){if(f[d].name!=""){var g=h.frames[f[d].name];if(g&&f[d].readyState=="complete"){if(!j){j=h.name}WebDMEngine.HookIFrameEvents(a,g,j)}}}}},SetWindowStyleToNormal:function(c,a){var b=a.DesktopManager;if(c.BorderType=="Simple"){if(c.EnableFastWindowActivation&&IS.ie&&!b.UseCssFramework){WebDMEngine.FastStyleSwitching(c,c.WindowStyle.Normal,a.GetWindowDivElement())}else{DynamicStyleEngine.SetToStyle(null,c.WindowStyle,a.GetWindowDivElement())}DynamicStyleEngine.SetToStyle(null,c.CaptionStyle,a.GetCaptionBarCellElement().children[0]);if(IS.IsHTML5DocType()){DynamicStyleEngine.SetToStyle(null,c.CaptionStyle,a.GetCaptionBarCellElement().children[0].children[0].children[0].children[0])}}else{if(c.BorderType=="ComplexImages"){DynamicStyleEngine.SetToStyle(null,c.WindowStyle,a.GetContentDivElement());DynamicStyleEngine.SetToStyle(null,c.CaptionStyle,a.GetCaptionBarTableElement());WebDMEngine.SetImages(b,a,"Normal")}}},Activate:function(j,d){var c=j.DesktopManager;var m=c.WindowSettings;var a=c.GetActiveWindow();var h=j.GetWindowDivElement();if(a){WebDMEngine.SetWindowStyleToNormal(m,a);if(!j.IsDialogBox){var g=a.GetTaskBarButtonElement();if(g){DynamicStyleEngine.SetToStyle(null,c.TaskBarButtonStyle,g)}}if(a.CurrentDialogBox&&a.DialogBoxShown){var l=a.CurrentDialogBox.Window;WebDMEngine.SetWindowStyleToNormal(m,l)}a.UnregisterAccessKeys()}if(m.BorderType=="Simple"){if(m.EnableFastWindowActivation&&IS.ie&&!c.UseCssFramework){WebDMEngine.FastStyleSwitching(m,m.WindowStyle.Active,h)}else{DynamicStyleEngine.SetToActiveStyle(null,m.WindowStyle,h)}DynamicStyleEngine.SetToActiveStyle(null,m.CaptionStyle,j.GetCaptionBarCellElement().children[0]);if(IS.IsHTML5DocType()){DynamicStyleEngine.SetToActiveStyle(null,m.CaptionStyle,j.GetCaptionBarCellElement().children[0].children[0].children[0].children[0])}}else{if(m.BorderType=="ComplexImages"){DynamicStyleEngine.SetToActiveStyle(null,m.CaptionStyle,j.GetCaptionBarTableElement());DynamicStyleEngine.SetToActiveStyle(null,m.WindowStyle,j.GetContentDivElement());WebDMEngine.SetImages(c,j,"Active")}}if(!j.IsDialogBox){var g=j.GetTaskBarButtonElement();if(j.WindowState=="Minimized"&&g){j.Restore(true,true)}if(!j.CreatedAtRuntime&&!j.StartupPositionInitialized){if(j.WindowState=="Maximized"){j.WindowState="Normal";j.Maximize(null,false)}}if(g){DynamicStyleEngine.SetToActiveStyle(null,c.TaskBarButtonStyle,g)}j.RegisterAccessKeys();c.ActiveWindowIndex=j.Index}if(j.DialogBoxShown){if(j.DialogBoxWindows.length>0){var b=j.GetWindowDivElement().style.zIndex;for(var e=0;e<j.DialogBoxWindows.length;e++){var k=j.DialogBoxWindows[e];if(k.IsDialogBox){k.GetWindowDivElement().style.zIndex=b}}}j.CurrentDialogBox.Window.Activate()}if(c.IsVistaAnimation()&&!d){ISAnimation_RemoveOpacity(h);if(j.Get("ContentMode")=="UseIFrame"){var f=j.GetWindowIFrameElement();if(f.style.display=="none"){f.style.display=""}}}},ActivateWithEvents:function(a,d){var b=WebDMEngine.RaiseWindowDeactivate(a);if(b){b=ISEvent.Raise(d.OnBeforeActivated,d);if(b){if(ISEvent.Raise(a.ClientSideEvents.OnWindowBeforeActivated,a.Id,d)){d.Activate(true)}}ISEvent.Raise(d.OnAfterActivated,d);ISEvent.Raise(a.ClientSideEvents.OnWindowAfterActivated,a.Id,d)}},RaiseWindowDeactivate:function(b){var a=b.GetActiveWindow();if(a){if(!window.IsDialogBox){return ISEvent.Raise(b.ClientSideEvents.OnWindowDeactivated,b.Id,a)}}return true},FastStyleSwitching:function(d,c,a){if(!d.CachedStyles[c]){d.CachedStyles[c]=IS.GetCssObject(null,c)}var b=d.CachedStyles[c];if(b){a.runtimeStyle.border=b.border}},SetImages:function(a,r,m){if(IS.IsHTML5DocType()){var n=r.GetCaptionBarCellElement().children[0];var p=n.children[0];var o=n.children[1];var q=n.children[2];var d="";var b="";var e="";var k="";var i="";var f="";var h=a.ImagesSettings;if(m=="Normal"){d=a.ResolveImagePath(h.CaptionLeftInactive);b=a.ResolveImagePath(h.CaptionCenterInactive);e=a.ResolveImagePath(h.CaptionRightInactive);k=a.ResolveImagePath(h.MinimizeInactive);i=a.ResolveImagePath(h.MaximizeInactive);if(r.WindowState=="Maximized"){i=a.ResolveImagePath(h.RestoreInactive)}f=a.ResolveImagePath(h.CloseInactive)}else{d=a.ResolveImagePath(h.CaptionLeftActive);b=a.ResolveImagePath(h.CaptionCenterActive);e=a.ResolveImagePath(h.CaptionRightActive);k=a.ResolveImagePath(h.MinimizeActive);i=a.ResolveImagePath(h.MaximizeActive);if(r.PreviousWindowState=="Maximized"){i=a.ResolveImagePath(h.RestoreActive)}f=a.ResolveImagePath(h.CloseActive)}p.children[0].src=d;o.style.backgroundImage="url("+b+")";q.children[0].src=e;if(r.Get("AllowMinimize")=="Yes"){var l=r.GetMinimizeButtonElement();if(l){l.children[0].src=k}}if(r.Get("AllowMaximize")=="Yes"){var j=r.GetMaximizeButtonElement();if(j){j.children[0].src=i}}if(r.Get("AllowClose")=="Yes"){var g=r.GetCloseButtonElement();if(g){g.children[0].src=f}}}else{var n=r.GetCaptionBarCellElement().children[0];var p=n.rows[0].cells[0];var o=n.rows[0].cells[1];var q=n.rows[0].cells[2];var d="";var b="";var e="";var k="";var i="";var f="";var h=a.ImagesSettings;if(m=="Normal"){d=a.ResolveImagePath(h.CaptionLeftInactive);b=a.ResolveImagePath(h.CaptionCenterInactive);e=a.ResolveImagePath(h.CaptionRightInactive);k=a.ResolveImagePath(h.MinimizeInactive);i=a.ResolveImagePath(h.MaximizeInactive);if(r.WindowState=="Maximized"){i=a.ResolveImagePath(h.RestoreInactive)}f=a.ResolveImagePath(h.CloseInactive)}else{d=a.ResolveImagePath(h.CaptionLeftActive);b=a.ResolveImagePath(h.CaptionCenterActive);e=a.ResolveImagePath(h.CaptionRightActive);k=a.ResolveImagePath(h.MinimizeActive);i=a.ResolveImagePath(h.MaximizeActive);if(r.PreviousWindowState=="Maximized"){i=a.ResolveImagePath(h.RestoreActive)}f=a.ResolveImagePath(h.CloseActive)}p.children[0].src=d;o.style.backgroundImage="url("+b+")";q.children[0].src=e;if(r.Get("AllowMinimize")=="Yes"){var l=r.GetMinimizeButtonElement();if(l){l.children[0].src=k}}if(r.Get("AllowMaximize")=="Yes"){var j=r.GetMaximizeButtonElement();if(j){j.children[0].src=i}}if(r.Get("AllowClose")=="Yes"){var g=r.GetCloseButtonElement();if(g){g.children[0].src=f}}}},MinimizeWindow:function(u,a,i){var d=u.DesktopManager;var n=false;if(d.EnableAnimation){if(a){n=true}}if(u.DialogBoxShown){return}if(n&&!i){var r=new UnitSize();var q=new OffsetLocation();if(u.GetTaskBarButtonElement()){var s=u.GetTaskBarButtonElement();q.X=ISPosLib.getLeft(s);q.Y=ISPosLib.getTop(s);r.Width=ISPosLib.getWidth(s);r.Height=ISPosLib.getHeight(s)}else{q=u.GetMinimizedLocation();r=u.GetMinimizedSize()}var b=new ISAnimatedObject();b.Type=(d.IsVistaAnimation()?"ZoomOut":"ShrinkExpand");b.AnimateLocation=true;b.AnimateSize=true;b.Element=u.GetWindowDivElement();b.CurrentSize=u.Size;b.CurrentLocation=u.Location;b.TargetSize=r;b.TargetLocation=q;b.OnCompleted=function(){WebDMEngine.MinimizeWindow(u,null,true)};if(d.IsVistaAnimation()){b.MaxStep=3;if(u.Get("ContentMode")=="UseIFrame"){var f=u.GetWindowIFrameElement();f.style.display="none"}}b.Play()}else{if(!n||i){var v=u.GetWindowDivElement();if(!u.GetTaskBarButtonElement()){var e=u.GetContentDivElement();var j=u.GetMinimizedLocation();var o=u.GetMinimizedSize();var l=u.GetMinimizeButtonElement();var k=u.GetMaximizeButtonElement();var h=d.ImagesSettings;var t=d.TextSettings;if(e){e.style.display=""}if(l){if(h.RestoreActive==""){var p=l.children[0].children[0];p.innerText="2"}else{var g=l.children[0];g.src=d.ResolveImagePath(h.RestoreActive)}l.title=t.RestoreText;if(d.UseCssFramework){l.setAttribute("button-type","restore")}}if(k){if(h.MaximizeActive==""){var p=k.children[0].children[0];p.innerText="1"}else{var g=k.children[0];g.src=d.ResolveImagePath(h.MaximizeActive)}k.title=t.MaximizeText;if(d.UseCssFramework){k.setAttribute("button-type","maximize")}}v.style.left=j.X+"px";v.style.top=j.Y+"px";v.style.width=o.Width+"px";v.style.height=o.Height+"px";u.InteractiveObject.Resizable=false;u.InteractiveObject.Enabled=true}else{v.style.display="none"}var m=d.GetTopMostWindowBefore(u);if(m&&m.IsDialogBox){m=null}if(m){m.Activate()}else{d.SetNoActiveWindow()}u.PreviousWindowState=u.WindowState;u.WindowState="Minimized";if(d.UseCssFramework){v.setAttribute("window-state",u.WindowState.toLowerCase())}}}},MaximizeWindow:function(q,a,h){var e=q.DesktopManager;var d=e;var s=e.WindowSettings;var g=e.ImagesSettings;var p=e.TextSettings;var r=q.GetWindowDivElement();var i=q.GetMaximizeButtonElement();var j=q.GetMinimizeButtonElement();var o=q.GetTaskBarButtonElement();var k=false;if(d.EnableAnimation){if(a){k=true}if(d.IsVistaAnimation()){k=false}}if(k&&!h){var n=new UnitSize();var m=new OffsetLocation();m.X=0;m.Y=0;n.Width=d.GetDesktopSize().Width;n.Height=d.GetDesktopSize().Height;var b=new ISAnimatedObject();b.Type=(d.IsVistaAnimation()?"ZoomIn":"ShrinkExpand");b.AnimateLocation=true;b.AnimateSize=true;b.Element=q.GetWindowDivElement();b.CurrentSize=q.Size;b.CurrentLocation=q.Location;b.TargetSize=n;b.TargetLocation=m;b.OnCompleted=function(){WebDMEngine.MaximizeWindow(q,null,true)};b.Play()}else{if(!k||h){q.PreviousWindowState=q.WindowState;q.WindowState="Maximized";q.InteractiveObject.Enabled=false;if(o){q.SaveLocationAndSize()}else{q.InteractiveObject.Resizable=q.Get("AllowResize")=="Yes";if(j){if(g.MinimizeActive==""){var l=j.children[0].children[0];l.innerText="0"}else{var f=j.children[0];f.src=e.ResolveImagePath(g.MinimizeActive)}j.title=p.MinimizeText;if(d.UseCssFramework){j.setAttribute("button-type","minimize")}}}r.style.left=0+"px";r.style.top=0+"px";r.style.width=d.GetDesktopSize().Width+"px";r.style.height=d.GetAvailableDesktopHeight(d.GetDesktopSize().Height)+"px";if(i){if(g.RestoreActive==""){var l=i.children[0].children[0];l.innerText="2"}else{var f=i.children[0];f.src=e.ResolveImagePath(g.RestoreActive)}i.title=p.RestoreText;if(d.UseCssFramework){i.setAttribute("button-type","restore")}}if(e.UseCssFramework){r.setAttribute("window-state",q.WindowState.toLowerCase());WebDMEngine.DispatchWindowResize()}if(!IS.ie11){WebDMEngine.FixMozillaWindowSize(q)}}}},RestoreWindow:function(u,a,k){var g=u.DesktopManager;var d=g;var w=g.WindowSettings;var t=g.TextSettings;var j=g.ImagesSettings;var v=u.GetWindowDivElement();var l=u.GetMaximizeButtonElement();var m=u.GetMinimizeButtonElement();var o=false;if(d.EnableAnimation){if(a){o=true}if(u.WindowState=="Maximized"&&d.IsVistaAnimation()){o=false}}if(o&&!k){var r=new UnitSize();var q=new OffsetLocation();var s=u.GetTaskBarButtonElement();var f=new UnitSize();var e=new OffsetLocation();if(u.WindowState=="Maximized"){e.X=0;e.Y=0;f.Width=d.GetDesktopSize().Width;f.Height=d.GetDesktopSize().Height;q=u.Location;r=u.Size}else{if(s){e.X=ISPosLib.getLeft(s);e.Y=ISPosLib.getTop(s);f.Width=ISPosLib.getWidth(s);f.Height=ISPosLib.getHeight(s)}else{e=u.GetMinimizedLocation();f=u.GetMinimizedSize()}q=u.Location;r=u.Size;if(d.IsVistaAnimation()&&u.PreviousWindowState=="Maximized"){q=new OffsetLocation(0,0);r=new UnitSize(d.GetDesktopSize().Width,d.GetDesktopSize().Height)}}var b=new ISAnimatedObject();b.Type=(d.IsVistaAnimation()?"ZoomIn":"ShrinkExpand");b.AnimateLocation=true;b.AnimateSize=true;b.Element=u.GetWindowDivElement();b.CurrentSize=f;b.CurrentLocation=e;b.TargetSize=r;b.TargetLocation=q;b.OnCompleted=function(){WebDMEngine.RestoreWindow(u,null,true)};if(d.IsVistaAnimation()){b.MaxStep=3;b.CurrentOpacity=20;b.CurrentInterval=100;if(u.Get("ContentMode")=="UseIFrame"){var h=u.GetWindowIFrameElement();h.style.display="none"}}b.Play()}else{if(!o||k){var n=u.PreviousWindowState;v.style.display="";u.InteractiveObject.Resizable=u.Get("AllowResize")=="Yes";if((u.PreviousWindowState!="Maximized"&&u.WindowState=="Minimized")||u.WindowState=="Maximized"){if(l){if(j.MaximizeActive==""){var p=l.children[0].children[0];p.innerText="1"}else{var i=l.children[0];i.src=g.ResolveImagePath(j.MaximizeActive)}l.title=t.MaximizeText;if(d.UseCssFramework){l.setAttribute("button-type","maximize")}}}if(u.WindowState=="Maximized"||(u.WindowState=="Minimized"&&!u.GetTaskBarButtonElement())){if(u.WindowState=="Minimized"&&m){if(j.MinimizeActive==""){var p=m.children[0].children[0];p.innerText="0"}else{var i=m.children[0];i.src=g.ResolveImagePath(j.MinimizeActive)}m.title=t.MinimizeText;if(d.UseCssFramework){m.setAttribute("button-type","minimize")}}u.MoveTo(u.Location.X,u.Location.Y);u.ResizeTo(u.Size.Width,u.Size.Height);u.PreviousWindowState="Normal"}u.WindowState=u.PreviousWindowState;u.InteractiveObject.Enabled=true;if(g.UseCssFramework){v.setAttribute("window-state",u.WindowState.toLowerCase());WebDMEngine.DispatchWindowResize()}if(d.IsVistaAnimation()){if(n=="Maximized"&&u.WindowState=="Maximized"){u.InteractiveObject.Enabled=false}if(k){ISAnimation_RemoveOpacity(v);if(u.Get("ContentMode")=="UseIFrame"){setTimeout(function(){var c=u.GetWindowIFrameElement();if(c!=null){c.style.display=""}},50)}}}}}},DestroyIFrame:function(d){if(d.frameElement!=null){var c=null;try{c=d.document}catch(a){return}c.open("text/html");c.write("");c.close();var b=d.frameElement.removeNode(true);b=null;delete b;d.ISWindowDestroyed=true;d=null;delete d;c=null;delete c}},CloseWindow:function(m){var a=m.DesktopManager;var b=m.Collection;var j=a.GetTopMostWindowBefore(m);var n=m.GetWindowDivElement();var l=m.GetTaskBarButtonElement();var k=true;if(m.IsDialogBox){var f=m.DialogBox;f.CloseDialog();return}ISEvent.Raise(m.OnPrepareClosed);if(m.Get("ContentMode")=="UseIFrame"){if(m.CreatedAtRuntime){var i=a.GetIFrameWindow(m.Name);var h=false;try{if(i.document){h=true}}catch(g){if(g.message.indexOf("Access is denied")>-1){h=true}}if(i&&h){m.Hide();setTimeout(function(){WebDMEngine.DestroyIFrame(i)},(a.IsVistaAnimation()?200:10))}}else{k=false;m.Hide()}}else{if(!m.CreatedAtRuntime){k=false;m.Hide()}}if(k){WebDMEngine.UnregisterWindowBehaviour(m);var d=null;if(!a.IsVistaAnimation()){d=n.removeNode(true)}else{setTimeout(function(){d=n.removeNode(true);delete d},200)}if(l){Listener.Unload(l);l.removeNode(true);WebDMEngine.CalculateTaskBarButtons(a)}if(d!=null){delete d;d=null}if(m.EnableDropShadow&&m.DropShadow!=null){m.DropShadow.Destroy()}m.IsClosed=true;if(b!=null){b.Remove(m);b.UpdateChanges()}}WebDMEngine.CheckForClose(m);m=null;delete m;if(a.IsVistaAnimation()){setTimeout(function(){a.ActiveWindowIndex=-1;if(j){j.Activate()}else{a.SetNoActiveWindow()}},100);return}a.ActiveWindowIndex=-1;if(j){j.Activate()}else{a.SetNoActiveWindow()}},DestroyWindow:function(a){},OpenFromFishEye:function(b,a){if(a.Enabled&&(a.TargetUrl!=""||a.WindowName!="")){var g=null;if(a.WindowName!=""){g=b.Windows.GetNamedItem(a.WindowName)}if(!g){for(var d=0;d<b.Windows.length;d++){if(b.Windows[d].ContentURL==a.TargetUrl){g=b.Windows[d];break}}}if(g){if(g.Initialized&&!g.IsClosed){if(g.ClientVisible){g.Activate()}else{var h=g.GetWindowDivElement();h.style.display="";var f=g.GetTaskBarButtonElement();if(g.ShowInTaskBar){if(!f){WebDMEngine.CreateTaskBarButton(g)}else{f.style.display=""}}if(g.ContentURL!=""){g.LoadContent()}g.ClientVisible=true;g.Activate()}}}else{var e=new WebDesktopWindow();e.Name=a.WindowName;e.ContentURL=a.TargetUrl;e.Text=a.Text;e.ControlBoxImage=a.TargetControlBoxImage;e.DesktopManager=b;e.ContentMode="UseIFrame";b.Windows.Add(e);e.Show()}}},OpenShortcut:function(e){var a=e.DesktopManager;if(e.Enabled&&(e.TargetURL!=""||e.WindowName!="")){var g=null;if(e.WindowName!=""){g=a.Windows.GetNamedItem(e.WindowName)}if(!g){for(var b=0;b<a.Windows.length;b++){if(a.Windows[b].ContentURL==e.TargetURL){g=a.Windows[b];break}}}if(g){if(g.Initialized&&!g.IsClosed){if(g.ClientVisible){g.Activate()}else{var h=g.GetWindowDivElement();h.style.display="";var f=g.GetTaskBarButtonElement();if(g.ShowInTaskBar){if(!f){WebDMEngine.CreateTaskBarButton(g)}else{f.style.display=""}}if(g.ContentURL!=""){g.LoadContent()}g.ClientVisible=true;g.Activate()}}}else{var d=new WebDesktopWindow();d.Name=e.WindowName;d.ContentURL=e.TargetURL;d.Text=e.Text;d.ControlBoxImage=e.TargetControlBoxImage;d.DesktopManager=a;d.ContentMode="UseIFrame";if(e.TaskBarImage!=""){d.TaskBarImage=e.TaskBarImage}a.Windows.Add(d);d.Show(e.GetElement())}}},CreateWindow:function(i){if(IS.IsHTML5DocType()){var b=i.DesktopManager;var f=b.GetDesktopElement();var h="";var j=null;if(i.Name!=""){var d=b.GetWindow(i.Name);if(d!=null&&d!=i){i.Name+=i.Index}}else{i.Name="Window"+i.Index}ISEvent.Raise(b.ClientSideEvents.OnWindowCreating,b.Id,i);j=document.createElement("DIV");j.id="dvWnd_"+b.Id+"_"+i.Name;j.style.cssText="position:absolute; display:none";j.style.zIndex=100-i.Index;if(b.UseCssFramework){j.setAttribute("window-state","normal")}if(b.WindowSettings.BorderType!="ComplexImages"){j.className=b.WindowSettings.WindowStyle.Normal}h+="<div style='position:relative; height:100%; width:100%;' ";if(i.Get("ContentMode")=="UseIFrame"){h+="onselectstart='return false' ondragstart='return false'"}h+=">";var a=b.UseCssFramework?"' ui-part='window-header'":"height:"+(parseInt(i.DesktopManager.WindowSettings.WindowHeaderHeight)+1)+"px;'";h+="<div style='position:absolute; top:0px; left:0px; right:0px;"+a+">";h+=WinRuntimeEngine._RenderCaptionBar(i);h+="</div>";a=b.UseCssFramework?"' ui-part='window-content'":" top:"+(parseInt(i.DesktopManager.WindowSettings.WindowHeaderHeight)+1)+"px;'";h+="<div style='position:absolute; left:0px; right:0px; bottom:0px;"+a+">";h+=WinRuntimeEngine._RenderContentBar(i);h+="</div>";h+="</div>";j.innerHTML=h;try{f.appendChild(j)}catch(g){f.insertAdjacentElement("beforeEnd",j)}i.CreatedAtRuntime=true;i.Initialize();i.InitializeLayout("Cascade");ISEvent.Raise(b.ClientSideEvents.OnWindowCreated,b.Id,i)}else{var b=i.DesktopManager;var f=b.GetDesktopElement();var h="";var j=null;if(i.Name!=""){var d=b.GetWindow(i.Name);if(d!=null&&d!=i){i.Name+=i.Index}}else{i.Name="Window"+i.Index}ISEvent.Raise(b.ClientSideEvents.OnWindowCreating,b.Id,i);j=document.createElement("DIV");j.id="dvWnd_"+b.Id+"_"+i.Name;j.style.cssText="position:absolute; display:none";j.style.zIndex=100-i.Index;if(!IS.IsXHTMLDocType()){j.setAttribute("popupProvider","Intersoft")}if(b.WindowSettings.BorderType!="ComplexImages"){j.className=b.WindowSettings.WindowStyle.Normal}h+="<table border=0 cellspacing=0 cellpadding=0 width='100%' height='100%' ";if(i.Get("ContentMode")=="UseIFrame"){h+="onselectstart='return false' ondragstart='return false'"}h+=">";h+="<tr><td noWrap>";h+=WinRuntimeEngine._RenderCaptionBar(i);h+="</td></tr>";h+="<tr height='100%'><td valign='top' height='100%'>";h+=WinRuntimeEngine._RenderContentBar(i);h+="</td></tr>";h+="</table>";j.innerHTML=h;try{f.appendChild(j)}catch(g){f.insertAdjacentElement("beforeEnd",j)}i.CreatedAtRuntime=true;i.Initialize();i.InitializeLayout("Cascade");ISEvent.Raise(b.ClientSideEvents.OnWindowCreated,b.Id,i)}},CreateShortcut:function(e){var a=e.DesktopManager;var b=a.GetDesktopElement();var d="";var f=null;if(e.Name!=""){if(a.ShortcutIcons.GetNamedItem(e.Name)!=e){e.Name+=e.Index}}else{e.Name="Shortcut"+e.Index}f=document.createElement("DIV");f.id="dvSCI_"+a.Id+"_"+e.Name;f.style.cssText="position:absolute; width:80px; height:80px; overflow: hidden; text-overflow: ellipsis;";f.align="center";if(!e.Visible){f.style.display="none"}b.appendChild(f);d+="<img vspace=2 src='"+a.ResolveImagePath(e.Image)+"' />";d+="<div ";d+="class="+a.ShortcutStyle.Normal;d+=">";if(a.ShortcutDisplayMode=="TextAndImage"){d+=e.Text}d+="</div>";f.innerHTML=d;e.Initialize();ISEvent.Raise(a.ClientSideEvents.OnShortcutCreated,a.Id,e)},DeleteShortcut:function(c){var b=c.GetElement();var a=c.Collection;a.Remove(c);a.UpdateChanges();Listener.Unload(b);b.removeNode(true)},CreateTaskBarButton:function(l){var a=l.DesktopManager;var i=a.GetTaskBarWindowGroupElement();var k=l.GetTaskBarButtonElement();if(i&&!k){var j=i.children[0].children[0];var g=j.rows[0];var d=-1;if(g.cells[g.cells.length-1].getAttribute("placeholder")=="true"){d=g.cells.length-1}var f=g.insertCell(d);var h="";f.nowrap=true;f.name=l.Name;f.className=a.TaskBarButtonStyle.Normal;h="<div style='overflow:hidden; text-overflow: ellipsis; width:100%'>";var b=a.UseCssFramework?"":"&nbsp;";h+="<nobr>"+b;if(l.TaskBarImage!=""){h+="<img src='"+a.ResolveImagePath(l.Get("TaskBarImage"))+"'"}else{var e=a.ResolveImagePath(l.Get("ControlBoxImage"));b="";if(a.UseCssFramework&&e==a.ResolveImagePath("")){b=" isdefault"}h+="<img"+b+" src='"+e+"'"}b=a.UseCssFramework?"":"&nbsp;";h+="  align=absmiddle>"+b;h+=l.Text;h+="</nobr>";h+="</div>";f.innerHTML=h;WebDMEngine.CalculateTaskBarButtons(a,true)}},GetVisibleWindowIndex:function(b,c){for(var a=0;a<b.length;a++){if(b[a].Name==c.Name){return a}}return -1},InitializeLayout:function(k,e,f){var a=k.DesktopManager;var b=a.GetDesktopSize();if(b.Width==0||b.Height==0){a.CachedDesktopSize=null;b=a.GetDesktopSize();if(b.Width==0){setTimeout(function(){WebDMEngine.InitializeLayout(k,e,f)},50);return}}if(!f||(f&&k.Location.IsEmpty())){var i=a.GetVisibleWindows();var l=WebDMEngine.GetVisibleWindowIndex(i,k);if(e=="Cascade"){k.MoveTo(75+(l*20),25+(l*20));var h=b.Height-k.Location.Y-(25*(i.length-l));if(a.DockBottomHeight>0){var g=h+k.Location.Y;if(b.Height-g<a.DockBottomHeight){h=h-(a.DockBottomHeight-(b.Height-g))}}if(k.Size.IsEmpty()&&!k.ForceNoResize){k.ResizeTo(b.Width-k.Location.X-(25*(i.length-l)),h)}}else{if(e=="TileWindowsH"){var d=b.Height/i.length;k.MoveTo(0,l*d);if(!k.ForceNoResize){k.ResizeTo(b.Width,d)}}else{var j=b.Width/i.length;k.MoveTo(l*j,0);if(!k.ForceNoResize){k.ResizeTo(j,b.Height)}}}if(!k.Size.IsEmpty()){k.ResizeTo(k.Size.Width,k.Size.Height)}}else{if(!k.Location.IsEmpty()&&f){k.MoveTo(k.Location.X,k.Location.Y);if(k.Size.IsEmpty()){k.ResizeTo(b.Width-k.Location.X-10,b.Height-k.Location.Y-10)}else{k.ResizeTo(k.Size.Width,k.Size.Height)}}}},LoadIFrameContent:function(k){var h=k.GetWindowIFrameElement();var m=h.parentElement;var a=k.DesktopManager;if(k.ContentURL!=""&&(h.src==""||!k.IFrameLoaded)){var o=k.ContentURL;if(o!=""&&o.substring(0,2)=="./"){o=o.substring(2)}if(h.src.indexOf(o)==-1||k.ContentURLChanged){if(IS.ie11){h.onload=function(){WebDMEngine.IFrameContentLoaded(k,true)}}h.src=o}k.IFrameLoaded=true;k.ContentURLChanged=false;if(a.WindowSettings.IFrameShowLoader&&IS.ie){var j=a.GetIFrameWindow(h.name);var g=false;try{var i=j.document;if(!i){g=true}}catch(f){g=true}if(j&&h.readyState!="complete"){var l=h.children[1];if(l==null){var m=h.parentElement;var d=document.createElement("DIV");var n="";if(!a.UseCssFramework){var b=IS.GetCssObject(null,a.WindowSettings.ContainerStyle);d.style.fontWeight=b.fontWeight;n=" style='font-family:"+b.fontFamily+";font-size:"+b.fontSize+"'"}d.style.cssText="width:100%;height:100%;vertical-align:middle;position:absolute;left:0px;top:0px;background-color:White";d.style.display="none";d.innerHTML="<table width=100% height=100%><tr><td valign=center align='center'"+n+"><img align='absmiddle' src='"+a.ResolveImagePath(a.ImagesSettings.InProgress)+"'>&nbsp;"+k.GetInProgressText()+"</td></tr></table>";m.appendChild(d)}h.style.display="none";k.IFrameContentLoaded=false;setTimeout(function(){WebDMEngine.PrepareLoader(k)},100)}else{k.IFrameContentLoaded=true;h.style.display=""}}else{k.IFrameContentLoaded=true;h.style.display="";if(!(IS.moz&&h.style.height.indexOf("%")==-1)){h.style.height="100%"}}}},PrepareLoader:function(e){if(e.IsClosed){return}var b=e.GetWindowIFrameElement();var a=e.DesktopManager;var d=a.GetIFrameWindow(b.name);if(d&&b.readyState=="complete"){if(IS.ie11){WebDMEngine.IFrameContentLoaded(e,true)}else{WebDMEngine.IFrameContentLoaded(e)}}if(!e.IFrameContentLoaded){b.nextSibling.style.display="";if(IS.ie11){b.onload=function(){WebDMEngine.IFrameContentLoaded(e,true)}}else{if(b.onreadystatechange==null){b.attachEvent("onreadystatechange",function(){WebDMEngine.IFrameContentLoaded(e)})}}}},InitializeSystemMenu:function(b){if(b.EnableContextMenu){var j=new WebContextMenu(b.Id+"_SysMenu");j.UseCssFramework=b.UseCssFramework;j.MenuStyleSettings.CopyFrom(b.MenuStyles.System);j.MenuStyleSettings.Parent=j;j.MenuStyleSettings.OnPropertiesInitialized();var g=j.Items.Add(new WebMenuItem("mnuRestore","Restore",IS.GetSymbol(b,"2",true),function(){WebDMEngine.SystemMenuCommand(this)},null,"webui-icon webui-restore"));var f=j.Items.Add(new WebMenuItem("mnuMove","Move",null,function(){WebDMEngine.SystemMenuCommand(this)}));var i=j.Items.Add(new WebMenuItem("mnuSize","Size",null,function(){WebDMEngine.SystemMenuCommand(this)}));var e=j.Items.Add(new WebMenuItem("mnuMinimize","Minimize",IS.GetSymbol(b,"0",true),function(){WebDMEngine.SystemMenuCommand(this)},null,"webui-icon webui-minimize"));var d=j.Items.Add(new WebMenuItem("mnuMaximize","Maximize",IS.GetSymbol(b,"1",true),function(){WebDMEngine.SystemMenuCommand(this)},null,"webui-icon webui-maximize"));j.Items.Add(new WebMenuSeparatorItem());var c=j.Items.Add(new WebMenuItem("mnuClose","Close",IS.GetSymbol(b,"r",true),function(){WebDMEngine.SystemMenuCommand(this)},new ShortcutKey(true,true,false,null,"C"),"webui-icon webui-android-close"));if(!b.UseCssFramework){if(IS.ie||(IS.moz&&!IsGecko30())){g.UseFontImage=e.UseFontImage=d.UseFontImage=c.UseFontImage=true}else{j.ImageSize=new UnitSize(12,14)}}b.SystemMenu=j;var a=new WebContextMenu(b.Id+"_DeskMenu");a.UseCssFramework=b.UseCssFramework;a.MenuStyleSettings.CopyFrom(b.MenuStyles.System);a.MenuStyleSettings.Parent=a;a.MenuStyleSettings.OnPropertiesInitialized();a.Items.Add(new WebMenuCheckBoxItem("mnuAutoArrange","Auto Arrange Icons",null,function(){WebDMEngine.DesktopMenuCommand(this)},null,b.ShortcutSettings.AllowAutoArrange));var h=a.Items.Add(new WebMenuCheckBoxItem("mnuShowDesktopIcons","Show Desktop Icons",null,function(){WebDMEngine.DesktopMenuCommand(this)},null,b.ShortcutIconsVisible));a.Items.Add(new WebMenuSeparatorItem());a.Items.Add(new WebMenuItem("mnuCascade","Cascade Windows",null,function(){WebDMEngine.DesktopMenuCommand(this)}));a.Items.Add(new WebMenuItem("mnuTileHz","Tile Windows Horizontally",null,function(){WebDMEngine.DesktopMenuCommand(this)}));a.Items.Add(new WebMenuItem("mnuTileVt","Tile Windows Vertically",null,function(){WebDMEngine.DesktopMenuCommand(this)}));a.Items.Add(new WebMenuSeparatorItem());a.Items.Add(new WebMenuItem("mnuShowDesktop","Show the Desktop",null,function(){WebDMEngine.DesktopMenuCommand(this)}));if(!b.ShortcutIconsVisible){h.Enabled=false}b.DesktopContextMenu=a}},OnDesktopContextMenu:function(c){event.cancelBubble=true;event.returnValue=false;var d=event.srcElement;var a=0;var b=0;if(d==c.GetDesktopElement()){if(c.EnableContextMenu&&c.DesktopContextMenu){var e=c.DesktopContextMenu;ISEvent.Raise(c.ClientSideEvents.OnContextMenu,c.Id,"Desktop",c,e);e.Show(e.GetEventLocation())}}return false},OnControlBoxClick:function(a){if(a.EnableContextMenu&&a.SystemMenu){var b=event.srcElement;var c=WebDMEngine.GetWindowByElement(a,b);if(c&&!c.IsClosed){WebDMEngine.ShowWindowContextMenu(c)}}},CheckForClose:function(b){if(b.IsClosed||!b.ClientVisible){var a=b.DesktopManager;if(a.SystemMenu){a.SystemMenu.HideAll()}}},OnCaptionBarContextMenu:function(a){event.returnValue=false;event.cancelBubble=true;if(a.EnableContextMenu&&a.SystemMenu){var b=event.srcElement;var c=WebDMEngine.GetWindowByElement(a,b);WebDMEngine.ShowWindowContextMenu(c)}return false},ShowWindowContextMenu:function(e){var c=e.DesktopManager;var d=c.SystemMenu;var a=0;var b=0;if(e&&e.Initialized&&!e.IsClosed&&d){if(e.WindowState=="Normal"){d.Items[0].Disable();d.Items[1].Enable();d.Items[2].Enable();d.Items[3].Enable();d.Items[4].Enable()}else{if(e.WindowState=="Minimized"){d.Items[0].Enable();d.Items[1].Disable();d.Items[2].Disable();d.Items[3].Disable();d.Items[4].Enable()}else{if(e.WindowState=="Maximized"){d.Items[1].Disable();d.Items[2].Disable();d.Items[4].Disable();if(!d.Items[0].Enabled){d.Items[0].Enable()}d.Items[3].Enable()}}}if(e.Get("AllowClose")=="No"){d.Items[6].Disable()}if(e.Get("AllowMinimize")=="No"){d.Items[3].Disable()}if(e.Get("AllowMaximize")=="No"){d.Items[0].Disable();d.Items[4].Disable()}if(e.Get("AllowResize")=="No"){d.Items[2].Disable()}d.Window=e;ISEvent.Raise(c.ClientSideEvents.OnContextMenu,c.Id,"Window",e,d);d.Show(d.GetEventLocation())}},SystemMenuCommand:function(a){var b=a.OwnerMenu.MenuControl.Window;switch(a.Name){case"mnuMinimize":b.Minimize(null,true);break;case"mnuMaximize":if(b.WindowState=="Minimized"){b.Restore()}b.Maximize(null,true);break;case"mnuRestore":b.Restore(null,true);break;case"mnuClose":b.Close();break;case"mnuMove":case"mnuSize":ISWinEngine.CaptureAction=(a.Name=="mnuMove")?"Move":"Size";WebDMEngine.SetCapture(b);ISWinEngine.SetupShadow(b,b.Location.X,b.Location.Y,b.Size.Width,b.Size.Height);break}},SetCapture:function(b){var a=document.body;if(!IS.ie){a=window}Listener.Add(a,"onkeydown",WebDMEngine.WindowCommand,b);Listener.Add(a,"onmousedown",WebDMEngine.WindowCommand,b);if(IS.ie){Listener.Add(a,"onkeyup",WebDMEngine.WindowCommand,b)}},ReleaseCapture:function(b){var a=document.body;if(!IS.ie){a=window}Listener.Remove(a,"onkeydown",WebDMEngine.WindowCommand,b);Listener.Remove(a,"onmousedown",WebDMEngine.WindowCommand,b);if(IS.ie){Listener.Remove(a,"onkeyup",WebDMEngine.WindowCommand,b)}ISWinEngine.Shadow.winName=null;ISWinEngine.Shadow.style.display="none";ISWinEngine.ShadowInfo.style.display="none";ISWinEngine.CaptureAction=null},WindowCommand:function(){if(event.type=="keydown"||event.type=="keyup"){var k=ISWinEngine.Shadow;var f=true;var c=-1;var d=-1;var e=-1;var b=-1;var g=event.keyCode;if(event.type=="keyup"&&event.keyCode!=ISKeyboardKey.ENTER){g=0}switch(g){case ISKeyboardKey.ESC:WebDMEngine.ReleaseCapture(this);f=false;break;case ISKeyboardKey.LEFT:if(ISWinEngine.CaptureAction=="Move"){c=ISPosLib.getLeft(k)-10}else{c=ISPosLib.getLeft(k)-10;e=ISPosLib.getWidth(k)+10}break;case ISKeyboardKey.DOWN:if(ISWinEngine.CaptureAction=="Move"){d=ISPosLib.getTop(k)+10}else{d=ISPosLib.getTop(k)+10;b=ISPosLib.getHeight(k)-10}break;case ISKeyboardKey.RIGHT:if(ISWinEngine.CaptureAction=="Move"){c=ISPosLib.getLeft(k)+10}else{c=ISPosLib.getLeft(k)+10;e=ISPosLib.getWidth(k)-10}break;case ISKeyboardKey.UP:if(ISWinEngine.CaptureAction=="Move"){d=ISPosLib.getTop(k)-10}else{d=ISPosLib.getTop(k)-10;b=ISPosLib.getHeight(k)+10}break;case ISKeyboardKey.ENTER:var j=this.GetPreferredSize(parseFloat(k.style.width),parseFloat(k.style.height));this.MoveTo(parseFloat(k.style.left),parseFloat(k.style.top));this.ResizeTo(j.Width,j.Height);if(this.EnableDropShadow&&this.DropShadow!=null){this.DropShadow.UpdatePosition()}this.SaveLocationAndSize();WebDMEngine.ReleaseCapture(this);WebDMEngine.DispatchWindowResize();f=false;break}if(f){var a=this.GetDesktopManager().GetDesktopElement();var h=ISPosLib.getLeft(a);var i=ISPosLib.getTop(a);if(c==-1){c=parseFloat(k.style.left)}if(d==-1){d=parseFloat(k.style.top)}if(e==-1){e=parseFloat(k.style.width)}if(b==-1){b=parseFloat(k.style.height)}if(e<50){return}c-=h;d-=i;ISWinEngine.SetupShadow(this,c,d,e,b)}}else{WebDMEngine.ReleaseCapture(this)}},DesktopMenuCommand:function(b){var a=ISGetDesktopManager();switch(b.Name){case"mnuAutoArrange":if(b.Checked){a.ShortcutSettings.AllowAutoArrange=true;WebDMEngine.ResetShortcutLocations(a);WebDMEngine.RearrangeShortcutIcons(a)}else{a.ShortcutSettings.AllowAutoArrange=false}break;case"mnuShowDesktopIcons":if(b.Checked){a.ShowShortcutIcons()}else{a.HideShortcutIcons()}break;case"mnuCascade":a.CascadeWindows(null,true);break;case"mnuTileHz":a.TileWindowsHorizontally(null,true);break;case"mnuTileVt":a.TileWindowsVertically(null,true);break;case"mnuShowDesktop":a.ShowDesktop();break}},GetBarControls:function(c){var a=new Array();for(var b=0;b<c.IS.RuntimeObjects.length;b++){var d=c.IS.RuntimeObjects[b];if(d&&(d.GetType()=="WebToolBar"||d.GetType()=="WebMenuBar")){a.push(d)}}return a},UnregisterAccessKeys:function(f){if(!f.BarsAccessKeyEnabled){return}if(f.Get("ContentMode")=="UseIFrame"&&!f.IsClosed&&f.Initialized){var c=f.DesktopManager;var e=c.GetIFrameWindow(f.Name);if(e&&e.ISGetObject){var b=WebDMEngine.GetBarControls(e);for(var d=0;d<b.length;d++){var a=b[d];if(a.Enabled){a.UnregisterAccessKeys()}}}f.BarsAccessKeyEnabled=false}},RegisterAccessKeys:function(f){if(f.BarsAccessKeyEnabled){return}if(f.Get("ContentMode")=="UseIFrame"&&!f.IsClosed&&f.Initialized){var c=f.DesktopManager;var e=c.GetIFrameWindow(f.Name);if(e&&e.ISGetObject){var b=WebDMEngine.GetBarControls(e);for(var d=0;d<b.length;d++){var a=b[d];if(a.Enabled){a.RegisterAccessKeys()}}}f.BarsAccessKeyEnabled=true}},PlayTransition:function(b,e,d){var c="progid:DXImageTransform.Microsoft.";var a="0.5";if(e!="None"){switch(e){case"Fade":c+="Fade(duration="+a+",overlap=1.0)";break;case"GradientWipe":c+="Wipe(duration="+a+",GradientSize=1.0, wipeStyle=1, motion='forward')";break;case"Pixelate":c+="Pixelate(duration="+a+",MaxSquare=30)";break;case"SlideAndHide":c+="Slide(duration="+a+",slideStyle='HIDE', bands=1)";break;case"SlideAndPush":c+="Slide(duration="+a+",slideStyle='PUSH', bands=1)";break;case"SlideAndSwap":c+="Slide(duration="+a+",slideStyle='SWAP', bands=1)";break;case"Iris":c+="Iris(duration="+a+",irisStyle='CIRCLE', motion='out')";break;case"Wheel":c+="Wheel(duration="+a+",Spokes=4)";break}if(b.filters!=null){b.style.filter=c;b.filters[0].Apply();if(!d){b.style.visibility="hidden"}else{b.style.visibility="visible"}b.filters[0].Play()}}else{b.style.visibility="visible"}},OnWindowHidden:function(a){var b=a.GetWindowDivElement();if(b!=null){b.style.display="none";b.style.zoom="100%"}},OnWindowShown:function(c,a){var d=c.GetWindowDivElement();if(d!=null){d.style.display="";ISAnimation_RemoveOpacity(d)}var b=c.GetContentDivElement().children[0];if(b!=null){b.style.display=""}c.Show(null,null,true,a)},ResizeMaximizedWindows:function(a){var b=a.GetDesktopClientSize();for(var d=0;d<a.Windows.length;d++){var g=a.Windows[d];var h=g.GetWindowDivElement();if(g.ClientVisible&&g.WindowState=="Maximized"&&!g.IsClosed){h.style.width=b.Width+"px";h.style.height=a.GetAvailableDesktopHeight(b.Height)+"px";if(g.Get("ContentMode")=="UseIFrame"){var e=g.GetWindowIFrameElement();var f=e.parentElement.clientHeight;if(e){if(f>b.Height){e.style.height=f+"px"}else{e.style.height="100%"}}}}}}};function ISFindWindowRecursive(b,f){var g=null;if(!f){g=window}else{g=f}if(g.name==b){return g}else{var c=g.frames;for(var d=0;d<c.length;d++){var a=c[d];if(a.name==b){return a}if(a.frames.length>0){var e=ISFindWindowRecursive(b,a);if(e){return e}}}}return null}function WebDesktopManagerDestructor(){var a=delete WebDMEngine}window.attachEvent("onunload",WebDesktopManagerDestructor);