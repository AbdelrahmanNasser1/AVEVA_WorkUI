function InitWebToolBar(a,c,b){var d=WebToolBarEngine.Create(a,c,b);var e=ISGetCurrentWindow();if(e){if(e!=ISGetActiveWindow()){d.UnregisterAccessKeys()}}}function WebToolBar(a){this.ClassName="WebToolBar";this.RequiredFrameworkVersion="2.0.5000.18";ISControl.call(this,a);BarControl.call(this);this.ClassName="WebToolBar";this.Commands=new ISArray();this.MergeToolBar=false;this.MergeToolBarParentID="";this.MergeToolBarParentWindowName="_parent";this.NewCreatedMergeChildBar=false;this.CustomStateString=null;this.ImagesDirectory="/CommonLibrary/Images/WebDesktop/";this.WebResourceIdentifier="D";this.IsRuntimeToolCommandCreated=false;this.ToggleGroups=new ISArray();this.LazyLoadContextMenu=false;this.DisplayAccessKeyOnToolTip="Yes";this.OnPostInitialized=function(){WebToolBarEngine._OnPostInitialized(this)};this.OnUnload=function(){WebToolBarEngine._OnUnload(this);this.Unloaded=true};this.OnBeforeUnload=function(){WebToolBarEngine._OnBeforeUnload(this)};this.ReBindingPostBackData=function(){WebToolBarEngine.AssignPropertiesToXml(this)};this._GetItems=function(){return this.Commands}}var pWTB=WebToolBar.prototype;pWTB._AddMergedCommands=function(a,c,b){WebToolBarMergingEngine._AddMergedCommands(this,a,c,b)};pWTB._ClearMergedCommands=function(){if(typeof(WebToolBarMergingEngine)=="object"){WebToolBarMergingEngine._ClearMergedCommands(this)}};pWTB._ClearMergedCommandsByChildBar=function(a){if(typeof(WebToolBarMergingEngine)=="object"){WebToolBarMergingEngine._ClearMergedCommandsByChildBar(this,a)}};pWTB.ShowCommand=function(a,b){WebToolBarEngine._ShowCommand(this,a,b)};pWTB.HideCommand=function(a,b){WebToolBarEngine._HideCommand(this,a,b)};pWTB.AddCommand=function(a,b){WebToolBarEngine._AddCommand(this,a,b)};pWTB.RemoveCommand=function(a){WebToolBarEngine._RemoveCommand(this,a)};pWTB.EnableCommand=function(a){WebToolBarEngine._EnableCommand(this,a)};pWTB.DisableCommand=function(a){WebToolBarEngine._DisableCommand(this,a)};pWTB._SetItemToHorizontalDisplay=function(a){WebToolBarEngine._SetItemToHorizontalDisplay(a)};pWTB._SetItemToVerticalDisplay=function(a){WebToolBarEngine._SetItemToVerticalDisplay(a)};pWTB._RegisterBehaviour=function(){WebToolBarEngine.RegisterBehaviour(this)};pWTB._RefreshStyle=function(){WebToolBarEngine._RefreshStyle(this)};pWTB._UpdateCommandTextAndImage=function(a){WebToolBarEngine._UpdateCommandTextAndImage(a)};pWTB._AssignCommandListener=function(a){WebToolBarEngine._AssignCommandListener(a)};pWTB.Render=function(){WebToolBarEngine.Render(this)};function ToolCommand(){Command.call(this);this._Type="ToolCommand";this.DisplayAccessKeyOnToolTip="Yes";this.ToggleGroupName="";this.Type="Button";this.AutoPostBack="Default";this.Pushed=false;this.AutoCheck=true;this.Checked=false;this.MergeCommandID="";this._MergeCommand=false;this._OriginalMergeToolBarWindow=null;this._OriginalBar=null;this.IsRendered=false;this.__getter=function(a){return ToolCommandEngine.__getter(this,a)};this.__setter=function(b,c,a){return ToolCommandEngine.__setter(this,b,c,a)}}var pTCmd=ToolCommand.prototype;pTCmd.SetVisible=function(b,a){ToolCommandEngine._SetVisible(this,b,a)};pTCmd.SetIsEnabled=function(a){ToolCommandEngine._SetIsEnabled(this,a)};pTCmd.OnClick=function(){ToolCommandEngine._OnClick(this)};pTCmd.OnAccessKey=function(){ToolCommandEngine._OnAccessKey(this)};pTCmd.OnPostBackClick=function(){ToolCommandEngine._OnPostBackClick(this)};pTCmd.SetPushed=function(a){ToolCommandEngine._SetPushed(this,a)};pTCmd.Select=function(){ToolCommandEngine._Select(this)};pTCmd.AttachMenuItem=function(a){ToolCommandEngine._AttachMenuItem(this,a)};pTCmd.OnAdd=function(){ToolCommandEngine.OnAdd(this)};var ToolCommandEngine={__getter:function(a,b){var d;switch(b){case"Menu":d=a._ContextMenu!=null?a._ContextMenu.RootMenu:a.Menu;break;default:d=CommandEngine.__getter(a,b);break}return d},__setter:function(b,d,e,a){switch(d){case"Visible":b.SetVisible(e);break;case"IsEnabled":b.SetIsEnabled(e);break;default:CommandEngine.__setter(b,d,e,a);break}},_OnClick:function(a){WebToolBarEngine._ClearOtherOnClickCommand(a._Bar);a._HtmlObj.fireEvent("onmouseover");a._HtmlObj.fireEvent("onmousedown");a._HtmlObj.fireEvent("onmouseup");if(a.Type=="Button"||a.Type=="SplitButton"){a.CommandStyle.SetToNormal()}WebToolBarEngine._RaiseCommandClientSideEvents(a,"OnClick")},_OnAccessKey:function(a){WebToolBarEngine._ClearOtherOnClickCommand(a._Bar);a._HtmlObj.fireEvent("onmouseover");a._HtmlObj.fireEvent("onmousedown");a._HtmlObj.fireEvent("onmouseup");a._HtmlObj.fireEvent("onmouseout")},_OnPostBackClick:function(b){var a=b._OriginalBar==null?b._Bar:b._OriginalBar;var c="Type='CommandClick'";c+=":Name='"+b.Name+"'";if(b.SelectedMenuItem!=null){c+=":ItemNameHierarchy='"+WebMenuEngine.GetSelectedMenuItemHierarchy(b.SelectedMenuItem)+"'"}if(typeof(Page_ClientValidate)=="function"){Page_ClientValidate(null,true)}if(typeof(Page_BlockSubmit)=="undefined"||!Page_BlockSubmit){if(!a.OriginalWindow){__doPostBack(a.ServerUniqueID,c)}else{a.OriginalWindow.__doPostBack(a.ServerUniqueID,c)}}},_SetIsEnabled:function(a,h){a.IsEnabled=h;a._HtmlObj.disabled=!h;if(a.Type!="Separator"&&a.Type!="Container"){var c=a.CommandStyle;var f=c.Normal;var d=a.CommandDisabledStyle;var b=a.Get("DisplayMode");if(a.Type=="ToggleButton"&&a.Pushed){f=c.Active}a._HtmlObj.className=(h==true)?f:d;if(a.Type=="DropDownButton"||a.Type=="SplitButton"){var g=a._HtmlObj.children[0];g.className=(h==true)?f:d;WebToolBarEngine._SetSplitButtonEffect(a,"Normal")}if(a._OriginalBar!=null){if(a.DisplayMode=="Default"){b=a._OriginalBar.DisplayMode}else{b=a.DisplayMode}}if(a._Bar.Get("GreyImageWhenDisabled")=="Yes"&&(b=="Image"||b=="TextAndImage")){var e=a._HtmlObj.getElementsByTagName("IMG")[0];if(h){e.style.cssText=e.style.cssText.replace("FILTER: Alpha(Opacity=50), Gray()","")}else{e.style.cssText=e.style.cssText+";FILTER: Alpha(Opacity=50), Gray()"}}}},_SetVisible:function(b,d,a){b.Visible=b._Visible=b._PrevVisible=d;if(a==true){b._Bar._UIState=b._UIState="Update"}else{if(b._HtmlObj==null){return}if(b.Visible){b._Bar._AssignCommandListener(b)}else{Listener.Unload(b._HtmlObj)}b._HtmlObj.style.display=b.Visible?"":"none";try{if(b._Bar.GetOrientation()=="Horizontal"){b._HtmlObj.previousSibling.style.display=b.Visible?"":"none"}else{b._HtmlObj.offsetParent.rows[marginIndex].style.display=b.Visible?"":"none"}}catch(c){}}},_SetPushed:function(a,b){if(a.Get("Type")!="ToggleButton"||a.IsEnabled==false){return}if(b==true){ToolCommandEngine._SetPushedToggleButton(a)}else{ToolCommandEngine._SetNotPushedToggleButton(a)}},_SetPushedToggleButton:function(a){if(a.ToggleGroupName!=null&&a.ToggleGroupName!=""){var b=WebToolBarEngine._GetPushedToggleCommandByGroup(a._Bar,a.ToggleGroupName);if(b!=null){b.CommandStyle.SetToNormal();b.Pushed=false}}a.CommandStyle.SetToActive();a.Pushed=true},_SetNotPushedToggleButton:function(a){a.CommandStyle.SetToNormal();a.Pushed=false;if(a.ToggleGroupName!=null&&a.ToggleGroupName!=""){var c=a._Bar.ToggleGroups.GetNamedItem(a.ToggleGroupName);if(c!=null&&c.ToggleGroupType=="SelectOne"){var b=WebToolBarEngine._GetToggleCommandsByGroup(a._Bar,a.ToggleGroupName);if(b.length>1){var a=b[0]!=a?b[0]:b[b.length-1];a.CommandStyle.SetToActive();a.Pushed=true}}}},_Select:function(a){WebToolBarEngine._ClearOtherOnClickCommand(a._Bar);a._HtmlObj.fireEvent("onmouseover")},_AttachMenuItem:function(a,b){if(!b.HasSubMenu()){if(b.OnClick!=null){b._OnClick=b.OnClick}b.OnClick="WebToolBarEngine._OnCommandContextMenuClick"}b._ToolCommand=a},OnAdd:function(a){if(a.IsRendered==false){var c=a.Parent;WebToolBarEngine._AssignPerCommandHTMLObj(a.Index,a,c);a._Visible=a.Visible;a._PrevVisible=a.Visible;a._Collection=c.Commands;var b=ISXml.GetAttribute(c.XmlDt.documentElement,"ImageSize");a.XmlNode=ISXml.CreateNode(a._Collection.XmlNode.ownerDocument,a._Collection.XmlNode,"ToolCommand","");ToolCommandEngine.CreateXmlNodeElement(a);if(b!=""&&b!=null){a.ImageSize.Parse(b)}if(a.Type=="DropDownButton"||a.Type=="SplitButton"){WebToolBarEngine._CreateCommandContextMenu(a)}}},CreateXmlNodeElement:function(c){var d=c.XmlNode;if(d==null){return}var b=d.ownerDocument;var a=null;for(k in c){if(c[k]!=null&&k!="Parent"&&k!="XmlNode"&&k.indexOf("_")!=0){if(typeof(c[k])!="object"){if(c[k]!=""){a=b.createAttribute(k);a.value=c[k].toString();d.attributes.setNamedItem(a)}}}}}};var WebToolBarEngine={IsWindowLoaded:false,Create:function(a,c,b){var d=ISGetObject(a);if(d!=null){return d}d=new WebToolBar(a);d.Name=a;if(b==true){d.NewCreatedMergeChildBar=true}WebToolBarEngine.AssignProperties(d);if(c!=null){d.PlaceHolder=c}if(WebToolBarEngine.IsWindowLoaded){d.OnPostInitialized();d.IsOnPostInitialized=true}return d},_OnPostInitialized:function(d){if((d.MergeToolBar==null||d.MergeToolBar==false||d.NewCreatedMergeChildBar)&&d.PlaceHolder!=""){var c=ISGetObject(d.PlaceHolder);if(c==null){try{if(typeof(InitPlaceHolderManager)=="function"){InitPlaceHolderManager(d.PlaceHolder)}}catch(b){var a;for(i in IS.RuntimeObjects){a=IS.RuntimeObjects[i];if(a.Id==d.PlaceHolder){delete IS.RuntimeObjects[i];break}}if(d.Id.indexOf("_")>-1&&typeof(InitPlaceHolderManager)=="function"){InitPlaceHolderManager(d.Id.substr(0,d.Id.lastIndexOf("_")+1)+d.PlaceHolder)}}c=ISGetObject(d.PlaceHolder)}WebToolBarEngine.RegisterBehaviour(d);if(c!=null){if(c.IsPostBack){WebToolBarEngine._AssignCommandHTMLObj(d)}c.RegisterBar(d)}d._UIState=""}WebToolBarEngine.AssignProperties1(d);if(d.Opacity!=1){d.Set("Opacity",d.Opacity)}},_OnBeforeUnload:function(a){if(IS.safari||IS.opera){if(a.MergeToolBar==true){WebToolBarEngine._OnUnLoadPage(a,true)}else{if(a._prntPHM!=null){WebToolBarEngine._OnUnLoadPage(a,true)}else{if(a._IsAddedWithMergedCommands==true){if(a._ChildBars!=null){for(var b in a._ChildBars){WebToolBarEngine._OnUnLoadPage(a._ChildBars[b],true);a._ChildBars[b]=null}}}}}}},_OnUnload:function(b){var a=b.Commands;for(var f=0;f<a.length;f++){if(a[f]._HtmlObj==null){continue}a[f]._Bar=b;a[f].Set("Visible",true);if(a[f]._HtmlObj!=null){Listener.Unload(a[f]._HtmlObj)}if(a[f]._ContextMenu!=null){a[f]._ContextMenu.OnRootMenuClosed=null}}Listener.Unload(document.getElementById(b.Id+BarControlEngine.BarHandleSuffix+"_Vertical"));Listener.Unload(document.getElementById(b.Id+BarControlEngine.BarHandleSuffix+"_Horizontal"));var d=document.getElementById(b.Id+IS.FrameHeaderSuffix);if(d!=null){Listener.Unload(d);Listener.Unload(d.offsetParent);Listener.Unload(d.parentNode.parentNode)}try{b._ClearMergedCommands();b.UpdateUI(true)}catch(c){}Listener.Unload(document.body);window.detachEvent("onresize",function(){DoWebToolBarResize(b)})},_ClearOtherOnClickCommand:function(c){var a;for(var b=0;b<c.Commands.length;b++){a=c.Commands[b];if(a.IsEnabled==true&&(a.Type=="Button"||a.Type=="DropDownButton"||a.Type=="SplitButton")){if((a.Type=="SplitButton"||a.Type=="DropDownButton")&&a._ContextMenu!=null&&a._ContextMenu.RootMenu.IsOpen()){}else{a.CommandStyle.SetToNormal()}WebToolBarEngine._SetSplitButtonEffect(a,"Normal")}}},_GetElementsByAttribute:function(e,a,b){var f=new Array();var g;if(e.getAttribute(a)==b){f[f.length]=e}var d=e.children;for(var h=0;h<d.length;h++){g=WebToolBarEngine._GetElementsByAttribute(d[h],a,b);if(g.length>0){for(var l=0;l<g.length;l++){f[f.length]=g[l]}}}return f},_GetDropDownCell:function(a){var b;if(a._Bar.GetOrientation()=="Horizontal"){b=a._HtmlObj.children[0].rows[0].cells[1]}else{b=a._HtmlObj.children[0].rows[1].cells[0]}return b},_RefreshHeaderCaptionStyle:function(a){var b=document.getElementById(a.Id+IS.FrameHeaderSuffix);b.cells[0].className=a.HeaderCaptionStyle;b.cells[1].className=b.cells[2].className=a.HeaderOptionButtonStyle.Normal},_RefreshForeColorStyle:function(c,h,a,b,j){var f=WebToolBarEngine._GetElementsByAttribute(c.FrameObj,a,b);var d;for(var g=0;g<f.length;g++){d=f[g];if(j){d.style.backgroundColor=d.style.color=h.ForeColor}else{d.style.color=h.ForeColor}}},_RefreshBackColorStyle:function(c,m,a,b){var g=WebToolBarEngine._GetElementsByAttribute(c.FrameObj,a,b);var f;var j=m.BackColor2!=null&&m.BackColor2!=""&&IS.ie==true;var l;var d=document.getElementById(c.Id+"_f_Horizontal");for(var h=0;h<g.length;h++){f=g[h];if(j==false){f.style.backgroundColor=m.BackColor}else{l=d.contains(f)?"h":"v";WebToolBarEngine._RefreshGradientBackColorStyle(f,l,m)}}},_RefreshGradientBackColorStyle:function(a,j,l){var h=false;var d;if(j=="h"){d=l.GradientType=="Horizontal"?"1":"0"}else{d=l.GradientType=="Horizontal"?"0":"1"}for(var g=0;g<a.filters.length;g++){if(a.filters[g].GradientType!=undefined){var b=a.filters[g];b.StartColorStr=l.BackColor;b.EndColorStr=l.BackColor2;b.GradientType=d;h=true;break}}if(h==false){var c=";filter: progid:DXImageTransform.Microsoft.gradient(StartColorStr="+l.BackColor+" , EndColorStr="+l.BackColor2+", GradientType="+d+")";a.style.cssText+=c}},_RefreshCommandStyle:function(a){var b;for(var e=0;e<a.Commands.length;e++){b=a.Commands[e];if(b.Type!="Separator"){var c,d;if(b.IsEnabled){c=a.CommandStyle.Normal;d=a.CommandFontStyle.Normal}else{c=a.CommandDisabledStyle;d=a.CommandDisableFontStyle}switch(b.Type){case"Button":b._HtmlObj.className=c;break;case"DropDownButton":case"SplitButton":b._HtmlObj.className=c;b._HtmlObj.children[0].className=d;break}}else{b._HtmlObj.className=a.SeparatorStyle}}},_RefreshStyle:function(a){if(a.UseCssFramework){return}WebToolBarEngine._RefreshHeaderCaptionStyle(a);WebToolBarEngine._RefreshBackColorStyle(a,a.HandleStyle,"handleBgColor","true");WebToolBarEngine._RefreshForeColorStyle(a,a.HandleStyle,"handleForeColor","true",true);WebToolBarEngine._RefreshBackColorStyle(a,a.BodyStyle,"bodyBgColor","true");WebToolBarEngine._RefreshBackColorStyle(a,a.OptionStyle,"optionBgColor","true");WebToolBarEngine._RefreshForeColorStyle(a,a.OptionStyle,"optionForeColor","true",false);WebToolBarEngine._RefreshCommandStyle(a)},AssignProperties:function(d){if(typeof(IS_ReleaseType)!="undefined"&&IS_ReleaseType=="Beta"){if(typeof(IS_ReleaseType)!="undefined"&&IS_ReleaseType=="Beta"){d.ScriptDirectory="/CommonLibraryBeta/WebDesktop/V3_0_7200/";d.ImagesDirectory="/CommonLibraryBeta/Images/WebDesktop/"}}d._HtmlObjV=document.getElementById(d.Id+IS.FrameSuffix+"_Vertical");d._HtmlObjV_tbl=document.getElementById(d.Id+BarControlEngine.BarInnerContainerSuffix+"_Vertical");d._HtmlObjH=document.getElementById(d.Id+IS.FrameSuffix+"_Horizontal");d._HtmlObjH_tbl=document.getElementById(d.Id+BarControlEngine.BarInnerContainerSuffix+"_Horizontal");var c=d.XmlDt.documentElement;if(c!=null){IS.SetPropertiesRecursive(d,c)}d.OldDockingArea=d.DockingArea;d.OldDockingRow=d.DockingRow;d.OldIsFloat=d.IsFloat;if(d.DockingArea=="Left"||d.DockingArea=="Right"){d._IsHorizontal=false}var a=d.FrameObj;d.IsFloat1=d.IsFloat;d.IsFloat=a.style.position=="absolute"?"Yes":"No";if(d.Get("FillDockingRow")=="No"&&d.Get("IsFloat1")=="No"){var b=d.FrameObj.offsetParent;d._PlaceHolderMaxDimensionWidth=b.offsetWidth;d._PlaceHolderMaxDimensionHeight=b.offsetHeight}if(d.Get("FillDockingRow")=="Yes"){d.DockingOffset=0}},AssignProperties1:function(f){var e=f.XmlDt.documentElement;f.CommandStyle=DynamicStyleEngine.Assign(e.selectSingleNode("CommandStyle"),null);f.CommandFontStyle=DynamicStyleEngine.Assign(e.selectSingleNode("CommandFontStyle"),null);if(f.MenuStyleSettings!=null){var d=ISXml.GetNode(f.XmlDt,"//MenuStyleSettings");if(d!=null){IS.SetPropertiesRecursive(f.MenuStyleSettings,d);var c=f.MenuStyleSettings;if(c.ItemStyle==null||c.FrameStyle==""||c.DisabledItemStyle==null||this.CheckedItemStyle==null||this.SeparatorStyle==""){f._IsCreateDefaultMenuStyles=true}}else{f._IsCreateDefaultMenuStyles=true}}var b=ISXml.GetAttribute(e,"ImageSize");if(b!=""&&b!=null){f.ImageSize.Parse(b)}WebToolBarEngine._AssignCommandsProperties(f);WebToolBarEngine._AssignToggleGroupsIndex(f);var a=document.getElementById(f.Id+IS.FrameHeaderSuffix).parentNode.parentNode;f.HeaderOptionButtonStyle=DynamicStyleEngine.Assign(e.selectSingleNode("HeaderButtonStyle"),a.rows[0].cells[1]);f.HeaderCloseButtonStyle=DynamicStyleEngine.Assign(e.selectSingleNode("HeaderButtonStyle"),a.rows[0].cells[2]);if(f.Get("MergeToolBar")!=true){Listener.Add(a,"onmouseover",WebToolBarEngine._OnMouseOverHeader,f);Listener.Add(a,"onmouseout",WebToolBarEngine._OnMouseOutHeader,f);Listener.Add(a,"onmousedown",WebToolBarEngine._OnMouseDownHeader,f);Listener.Add(a,"onmouseup",WebToolBarEngine._OnMouseOverHeader,f);Listener.Add(a,"ondblclick",WebToolBarEngine._OnDblClickHeader,f);window.attachEvent("onresize",function(){DoWebToolBarResize(f)})}if(!f.LazyLoadContextMenu){WebToolBarEngine._CreateCommandsContextMenu(f)}},_CreateCommandsContextMenu:function(c){if(c.MergeToolBar==true){return}var a=c.Commands;for(var b=0;b<a.length;b++){if(a[b].Type=="DropDownButton"||a[b].Type=="SplitButton"){WebToolBarEngine._CreateCommandContextMenu(a[b])}}},_RootMenuClosed:function(c){var b=c.MenuControl;var a=b._ToolCommand;a.CommandStyle.SetToNormal();WebToolBarEngine._SetSplitButtonEffect(a,"Normal");if(a.Type=="SplitButton"||a.Type=="DropDownButton"){var d=a._HtmlObj.children[0];if(d!=null){d.className=a.CommandFontStyle.Normal}}c.MenuControl.JustClosed=true;setTimeout(function(){c.MenuControl.JustClosed=false},200)},_CreateCommandContextMenu:function(b){if(b.Menu==null){b.Menu=new WebMenu()}b.Menu.UseCssFramework=b._Bar.UseCssFramework;WebToolBarEngine._MapMenuProperties(b);WebToolBarEngine._CreateContextMenuItems(b);WebToolBarEngine._AttachCommandContextMenuOnClick(b,b.Menu.Items);var a=new WebContextMenu(b.Name+"ContextMenu");a.UseCssFramework=b._Bar.UseCssFramework;b.Menu.MenuControl=a;b.Items=b.Menu.Items;a.SetOffsetElement(b._HtmlObj);a.RootMenu=b.Menu;a.Items=b.Menu.Items;a.MenuStyleSettings=b._Bar.MenuStyleSettings;a.OnRootMenuClosed="WebToolBarEngine._RootMenuClosed";a._ToolCommand=b;a.IntegratedToBar=true;a.RefreshStructure();if(b._Bar._IsCreateDefaultMenuStyles==true&&!b._Bar.UseCssFramework){if(b._Bar.IntegratedTo=="None"||b._Bar.PlaceHolder==""){WebToolBarEngine._CreateContextMenuTempClasName(b._Bar.Id,a.MenuStyleSettings)}}if((!b._Bar._IsMenuStyleCreated&&b._Bar.IntegratedTo=="None")||(b._Bar.IntegratedTo=="PlaceHolderManager"&&b._Bar.PlaceHolder!=""&&!b._Bar.PlaceHolderManager._IsMenuStyleCreated)){a.CreateDefaultStyles();if(b._Bar.IntegratedTo=="None"||b._Bar.PlaceHolder==""){b._Bar._IsMenuStyleCreated=true}else{if(b._Bar.PlaceHolderManager!=null){b._Bar.PlaceHolderManager._IsMenuStyleCreated=true}}}b._ContextMenu=a},_CreateContextMenuTempClasName:function(b,a){a.FrameStyle=b+"_FrameStyle";a.ItemStyle.Normal=b+"_ItemStyle_Normal";a.ItemStyle.Over=b+"_ItemStyle_Over";a.CheckedItemStyle.Normal=b+"_CheckedItemStyle_Normal";a.CheckedItemStyle.Over=b+"_CheckedItemStyle_Over";a.DisabledItemStyle.Normal=b+"_DisabledItemStyle_Normal";a.DisabledItemStyle.Over=b+"_DisabledItemStyle_Over";a.SeparatorStyle=b+"_SeparatorStyle"},_MapMenuProperties:function(a){if(a.XmlNode!=null){var b=a.XmlNode.selectSingleNode("Menu");if(b!=null){IS.SetProperties(a.Menu,b)}}},_CreateContextMenuItems:function(a){if(a.XmlNode!=null){var b=a.XmlNode.selectSingleNode("Items");if(b!=null){WebToolBarEngine._CreateMenuItems(a.Menu.Items,b)}}},_CreateMenuItems:function(c,b){for(var a=0;a<b.childNodes.length;a++){c.Add(WebToolBarEngine._CreateMenuItem(b.childNodes[a],c))}},_CreateMenuItem:function(c,d){var b=new WebMenuItem();var a;b.Parent=d.Parent;IS.SetPropertiesRecursive(b,c);return b},_AttachCommandContextMenuOnClick:function(a,d){var c;for(var b=0;b<d.length;b++){c=d[b];a.AttachMenuItem(c);WebToolBarEngine._AttachCommandContextMenuOnClick(a,c.Items)}},_OnCommandContextMenuClick:function(b){var a=b._ToolCommand;var d=a._Bar;var c=true;a.SelectedMenuItem=b;if(b._OnClick){c=ISEvent.Raise(b._OnClick,b)}if(c){var e=a._MergeCommand?a._OriginalBar:d;if(e!=null&&e.CommandClientSideEvents!=null){if(e.CommandClientSideEvents.OnClick!=""){c=WebToolBarEngine._RaiseCommandClientSideEvents(a,"OnClick")}else{if(e.CommandClientSideEvents.OnMouseUp!=""){c=WebToolBarEngine._RaiseCommandClientSideEvents(a,"OnMouseUp")}}}if(c){WebToolBarEngine._RaisePostBackCommandClick(a,b)}}a.SelectedMenuItem=null},_RaiseCommandClientSideEvents:function(a,f){var d=a._Bar;var c=d.CommandClientSideEvents[f];if(c==null){return}if(a._MergeCommand){try{c=a._OriginalBar.CommandClientSideEvents[f];if(c!=null){return a._OriginalMergeToolBarWindow.ISEvent.Raise(c,d.Id,a)}else{return null}}catch(b){}}else{return ISEvent.Raise(c,d.Id,a)}},_RaisePostBackCommandClick:function(a,b){if(a._Bar&&a._Bar.Get==null){return}if(a.Get("AutoPostBack")=="Yes"||(b&&b.AutoPostBack=="Yes")){a.OnPostBackClick()}},_AssignToggleGroupsIndex:function(b){var d=b.ToggleGroups;var c;for(var a=0;a<d.length;a++){c=d[a];c.Index=a}},_EnableCommand:function(e,a){if(a==null){return}var b;if(a.constructor==Array||typeof(a.length)=="number"){for(var d=0;d<a.length;d++){b=e.Commands.GetNamedItem(a[d]);b.SetIsEnabled(true)}}else{b=typeof(a)=="object"?a:e.Commands.GetNamedItem(a);if(b!=null){b.SetIsEnabled(true)}}},_DisableCommand:function(e,a){if(a==null){return}var b;if(a.constructor==Array||typeof(a.length)=="number"){for(var d=0;d<a.length;d++){b=e.Commands.GetNamedItem(a[d]);b.SetIsEnabled(false)}}else{b=typeof(a)=="object"?a:e.Commands.GetNamedItem(a);if(b!=null){b.SetIsEnabled(false)}}},_OnDblClickHeader:function(){if(this._PrevDockingArea==""){return}this.DockingArea=this._PrevDockingArea;this.DockingRow=this._PrevDockingRow;this.FrameObj.DragTargetId=this._PrevDragTargetId;this._Dock()},_OnMouseOverHeader:function(){if(window.event==null){return}var c=window.event.srcElement;try{var b=document.getElementById(this.Id+IS.FrameHeaderSuffix).offsetParent;if(!b||!b.rows){b=document.getElementById(this.Id+IS.FrameHeaderSuffix).parentElement.parentElement}if(b.rows[0].cells[1].contains(c)){this.HeaderOptionButtonStyle.SetToOver()}else{if(b.rows[0].cells[2].contains(c)){this.HeaderCloseButtonStyle.SetToOver()}}}catch(a){}},_OnMouseOutHeader:function(){if(window.event==null){return}var c=window.event.srcElement;try{var b=document.getElementById(this.Id+IS.FrameHeaderSuffix).offsetParent;if(!b||!b.rows){b=document.getElementById(this.Id+IS.FrameHeaderSuffix).parentElement.parentElement}if(b.rows[0].cells[1].contains(c)){this.HeaderOptionButtonStyle.SetToNormal()}else{if(b.rows[0].cells[2].contains(c)){this.HeaderCloseButtonStyle.SetToNormal()}}}catch(a){}},_OnMouseDownHeader:function(){if(window.event==null){return}var b=window.event.srcElement;var a=document.getElementById(this.Id+IS.FrameHeaderSuffix).offsetParent;if(a.rows[0].cells[1].contains(b)){this.HeaderOptionButtonStyle.SetToActive()}else{if(a.rows[0].cells[2].contains(b)){this.HeaderCloseButtonStyle.SetToActive()}}},AssignPropertiesToXml:function(n){if(n.IsRuntimeBar==true&&n._ReBinding==true){return}if(n.XmlDt==null){return}var m=n.XmlDt.documentElement;if(m!=null){n.Style1=n.FrameObj.style.cssText;n.NewDockingArea=n.DockingArea;n.NewDockingRow=n.DockingRow;n.NewIsFloat=n.IsFloat;n.DockingArea=n.OldDockingArea;n.DockingRow=n.OldDockingRow;n.IsFloat=n.OldIsFloat;IS.SetPropertiesToXml(n,m);if(n.IsRuntimeBar==true){var f=n.XmlDt.documentElement.attributes.getNamedItem("Id");if(f==null){f=n.XmlDt.createAttribute("Id");f.text=n.Id;n.XmlDt.documentElement.attributes.setNamedItem(f)}}if(n.XmlDt.documentElement.attributes.getNamedItem("ImageSize")!=null&&!n.ImageSize.IsEmpty()){n.XmlDt.documentElement.attributes.getNamedItem("ImageSize").value=parseFloat(n.ImageSize.Width)+", "+parseFloat(n.ImageSize.Height)}var b=n.Commands;if(n.Get("AllowCustomize")=="No"&&n.IsRuntimeToolCommandCreated==false){var o=WebToolBarEngine._GetToggleCommands(n);var d="";var l=ISXml.CreateXmlDocument();ISXml.LoadXml(l,n.XmlDt.xml);if(o.length==0){var c=ISXml.GetNode(l,"//Commands");l.documentElement.removeChild(c)}else{for(var e=0;e<b.length;e++){var h=ISXml.GetNode(l,"//ToolCommand[@Name='"+b[e].Name+"']");if(h){ISXml.RemoveNode(h,"Menu");ISXml.RemoveNode(h,"Items");var a=h.attributes.length;for(var g=0;g<a;g++){h.removeAttribute(h.attributes[0].name)}ISXml.SetAttribute(h,"Name",b[e].Name);if(b[e].Type=="ToggleButton"){ISXml.SetAttribute(h,"Pushed",b[e].Pushed?"True":"False")}if(h.attributes.getNamedItem("ImageSize")!=null&&!b[e].ImageSize.IsEmpty()){h.attributes.getNamedItem("ImageSize").value=parseFloat(b[e].ImageSize.Width)+", "+parseFloat(b[e].ImageSize.Height)}}}}ISBarCommon.RemoveStyleNodes(l.firstChild);n.CustomStateString=l.xml}else{for(var e=0;e<b.length;e++){IS.SetPropertiesToXml(b[e],b[e].XmlNode);var h=b[e].XmlNode;if(h.attributes.getNamedItem("ImageSize")!=null&&!b[e].ImageSize.IsEmpty()){h.attributes.getNamedItem("ImageSize").value=parseFloat(b[e].ImageSize.Width)+", "+parseFloat(b[e].ImageSize.Height)}}var l=ISXml.CreateXmlDocument();ISXml.LoadXml(l,n.XmlDt.xml);ISBarCommon.RemoveStyleNodes(l.firstChild);n.CustomStateString=l.xml}}},RegisterBehaviour:function(e){var d=e.PlaceHolder;if(d!=null&&d!=""){var c=e.PlaceHolderManager==null?ISGetObject(d):e.PlaceHolderManager;if(c==null){InitPlaceHolderManager(d)}c=ISGetObject(d);if(c!=null){e.PlaceHolderManager=c}if(c!=null&&e.Get("HandleVisible")=="Yes"){var a="";if(e.Get("AllowDockTop")=="Yes"){for(var b=c.MaxDockingRows-1;b>-1;b--){a+=c.Id+PlaceHolderManagerEngine.PlaceHolderManagerTopDockingAreaSuffix+PlaceHolderManagerEngine.PlaceHolderManagerTableDockingAreaSuffix+"_"+b+";"}}if(e.Get("AllowDockRight")=="Yes"){for(var b=c.MaxDockingRows-1;b>-1;b--){a+=c.Id+PlaceHolderManagerEngine.PlaceHolderManagerRightDockingAreaSuffix+PlaceHolderManagerEngine.PlaceHolderManagerTableDockingAreaSuffix+"_"+b+";"}}if(e.Get("AllowDockBottom")=="Yes"){for(var b=c.MaxDockingRows-1;b>-1;b--){a+=c.Id+PlaceHolderManagerEngine.PlaceHolderManagerBottomDockingAreaSuffix+PlaceHolderManagerEngine.PlaceHolderManagerTableDockingAreaSuffix+"_"+b+";"}}if(e.Get("AllowDockLeft")=="Yes"){for(var b=c.MaxDockingRows-1;b>-1;b--){a+=c.Id+PlaceHolderManagerEngine.PlaceHolderManagerLeftDockingAreaSuffix+PlaceHolderManagerEngine.PlaceHolderManagerTableDockingAreaSuffix+"_"+b+";"}}if(a.length>0){a=a.substr(0,a.length-1)}}if(e.Get("AllowMove")=="Yes"&&e.Get("HandleVisible")=="Yes"){ISDrag.Register(e.Id+IS.FrameSuffix,e.Id+BarControlEngine.BarHandleSuffix+"_Vertical;"+e.Id+BarControlEngine.BarHandleSuffix+"_Horizontal",WebToolBarEngine._OnDragStart,WebToolBarEngine._OnDrag,WebToolBarEngine._OnDragEnd,a)}}if(e.Get("AllowMove")=="Yes"){ISDrag.Register(e.Id+IS.FrameSuffix,e.Id+IS.FrameHeaderSuffix,WebToolBarEngine._OnDragStart,WebToolBarEngine._OnDrag,WebToolBarEngine._OnDragEnd,a)}},_UpdateCommandTextAndImage:function(a){if(a._Text!=a.Text){a._Text=a.Text}if(a._Image!=a.Image){a._Image=a.Image}var c=a.Get("Type");if(c=="Button"||c=="ToggleButton"){switch(a.Get("DisplayMode")){case"Text":var b=a._HtmlObj.children[0];b.innerHTML=WebToolBarEngine._GetCommandText(a);break;case"Image":var b=a._HtmlObj;b.innerHTML=WebToolBarEngine._GetCommandImage(a);break;case"TextAndImage":var b=a._HtmlObj;b.innerHTML=WebToolBarEngine._GetCommandTextAndImage(a);break}}else{if(c=="DropDownButton"||c=="SplitButton"){switch(a.Get("DisplayMode")){case"Text":var b=a._HtmlObj.children[0].rows[0].cells[0].children[0];b.innerHTML=WebToolBarEngine._GetCommandText(a);break;case"Image":var b=a._HtmlObj.children[0].rows[0].cells[0];b.innerHTML=WebToolBarEngine._GetCommandImage(a);break;case"TextAndImage":var b=a._HtmlObj.children[0].rows[0].cells[0];b.innerHTML=WebToolBarEngine._GetCommandTextAndImage(a);break}}}},_GetCommandText:function(a){var c="&nbsp;";if(a.AccessKey==null||a.AccessKey==""){c+=a.Text}else{var b=a.Text.toLowerCase().indexOf(a.AccessKey.toLowerCase());if(b>-1){c+=a.Text.substr(0,idx);c+="<u>";c+=a.Text.substr(idx,1);c+="</u>";c+=a.Text.substr(idx+1)}else{c+=a.Text}}return c},_GetCommandImage:function(a,b){var c=a.Get("ImageSize");var d="<img align='absmiddle' style='overflow:hidden;width:";d+=c.Width;d+=";height:";d+=c.Height;if(b!=null){d+=b+";"}d+="' src='";d+=a.Image;d+="'/>";return d},_GetCommandTextAndImage:function(a){var c="";if(a._Bar.GetOrientation()=="Horizontal"){switch(a.Get("TextAlign")){case"Left":c+=WebToolBarEngine._GetCommandText(a);c+="&nbsp;";c+=WebToolBarEngine._GetCommandImage(a);break;case"Right":c+=WebToolBarEngine._GetCommandImage(a);c+="&nbsp;";c+=WebToolBarEngine._GetCommandText(a);break;case"Above":c+=WebToolBarEngine._GetCommandText(a);c+=WebToolBarEngine._GetCommandImage(a,";display:block");break;case"Underneath":c+=WebToolBarEngine._GetCommandImage(a,";display:block");c+=WebToolBarEngine._GetCommandText(a);break}}else{var b="";switch(a.Get("TextAlign")){case"Left":c+=WebToolBarEngine._GetCommandText(a);c+=WebToolBarEngine._GetCommandImage(a);break;case"Right":c+=WebToolBarEngine._GetCommandImage(a);c+=WebToolBarEngine._GetCommandText(a);break;case"Above":b=a._Bar.UseCssFramework?"":" style='writing-mode:tb-rl'";c+="<div nowrap"+b+">";c+=WebToolBarEngine._GetCommandText(a);c+=WebToolBarEngine._GetCommandImage(a,";display:block");c+="</div>";break;case"Underneath":b=a._Bar.UseCssFramework?"":" style='writing-mode:tb-rl'";c+="<div nowrap"+b+">";c+=WebToolBarEngine._GetCommandImage(a,";display:block");c+=WebToolBarEngine._GetCommandText(a);c+="</div>";break}}return c},_GetToolBarChildIdx:function(b){var d=-1;var a=b.offsetParent;for(var c=0;c<a.children.length;c++){if(a.children[c]==b){d=c;break}}return d},_OnDragStart:function(a){if(isNaN(parseFloat(a.style.left))){a.style.left=ISPosLib.getLeft(a)}if(isNaN(parseFloat(a.style.top))){a.style.top=ISPosLib.getTop(a)}if(a.dragAreaId.indexOf(BarControlEngine.BarHandleSuffix)>-1){a.IsDrop=a.style.position==""||a.style.position=="static"}else{a.IsDrop=false}var b=ISGetObject(a.id.replace(IS.FrameSuffix,""));if(b!=null&&b.PlaceHolderManager!=null){b.PlaceHolderManager.IsDraggingChild=true}},_OnDrag:function(c,a,b){if(!c.IsInDragArea){if(c.IsDrop){var f=ISGetObject(c.id.replace(IS.FrameSuffix,""));var d=false;if(f){f._ChildIdx=WebToolBarEngine._GetToolBarChildIdx(c);f._OffsetParent=c.offsetParent;d=f._UnDock()}if(d){c.IsReCalculateDragArea=true;c.style.left=c.DragX+"px";c.style.top=c.DragY+"px";c.DragWidth=ISPosLib.getWidth(c);c.DragHeight=ISPosLib.getHeight(c);c.IsDrop=false}else{if(isNaN(parseFloat(c.style.left))){c.style.left=ISPosLib.getLeft(c)+"px"}if(isNaN(parseFloat(c.style.top))){c.style.top=ISPosLib.getTop(c)+"px"}c.style.left=parseFloat(c.style.left)+a+"px";c.style.top=parseFloat(c.style.top)+b+"px"}}else{if(isNaN(parseFloat(c.style.left))){c.style.left=ISPosLib.getLeft(c)+"px"}if(isNaN(parseFloat(c.style.top))){c.style.top=ISPosLib.getTop(c)+"px"}c.style.left=parseFloat(c.style.left)+a+"px";c.style.top=parseFloat(c.style.top)+b+"px"}}else{var f=ISGetObject(c.id.replace(IS.FrameSuffix,""));if(c.IsDrop==false){if(f._Dock()==true){f._ChildIdx=WebToolBarEngine._GetToolBarChildIdx(c);c.IsReCalculateDragArea=true;c.IsDrop=true;c.dropAreaId=c.dragAreaId;c.DragWidth=ISPosLib.getWidth(c);c.DragHeight=ISPosLib.getHeight(c)}else{if(isNaN(parseFloat(c.style.left))){c.style.left=ISPosLib.getLeft(c)+"px"}if(isNaN(parseFloat(c.style.top))){c.style.top=ISPosLib.getTop(c)+"px"}c.style.left=parseFloat(c.style.left)+a+"px";c.style.top=parseFloat(c.style.top)+b+"px"}}else{if(f._CheckingDockingArea()){f._ChildIdx=WebToolBarEngine._GetToolBarChildIdx(c)}}}},_OnDragEnd:function(a){var b=ISGetObject(a.id.replace(IS.FrameSuffix,""));if(b){if(a.IsInDragArea){b._ChildIdx=WebToolBarEngine._GetToolBarChildIdx(a);a.IsDrop=true}else{if(!b.Get("AllowFloat")=="Yes"){if(typeof(PlaceHolderManagerEngine)==""){PlaceHolderManagerEngine.InsertBackBarFromDragOperation(b,a)}b._SetToStaticDisplay();a.IsDrop=true}}if(b.PlaceHolderManager!=null){b.PlaceHolderManager.IsDraggingChild=false}}},_SetDropDownButtonItemToHorizontalDisplay:function(b){var d=b._HtmlObj.children[0];var a=d.rows[0].insertCell(1);var c=d.rows[1].cells[0];if(b._Bar.UseCssFramework){a.outerHTML=c.outerHTML}else{a.innerHTML=c.innerHTML;a.style.paddingLeft="1px"}a.style.width=c.style.height;a.style.height="";a.style.paddingTop="";d.deleteRow(1)},_SetDropDownButtonItemToVerticalDisplay:function(b){var e=b._HtmlObj.children[0];var d=e.insertRow(1);var a=d.insertCell(0);var c=e.rows[0].cells[1];if(b._Bar.UseCssFramework){a.outerHTML=c.outerHTML}else{a.innerHTML=c.innerHTML;a.style.paddingTop="1px"}a.style.height=c.style.width;a.style.width="";a.style.paddingLeft="";e.rows[0].deleteCell(1)},_SetItemToVerticalDisplay:function(a){if(a.Type=="Button"||a.Type=="ToggleButton"||a.Type=="DropDownButton"||a.Type=="SplitButton"){if(a.Type=="DropDownButton"||a.Type=="SplitButton"){WebToolBarEngine._SetDropDownButtonItemToVerticalDisplay(a)}switch(a.Get("DisplayMode")){case"Text":if(!a._Bar.UseCssFramework){if(a.Type!="DropDownButton"&&a.Type!="SplitButton"){a._HtmlObj.children[0].style.writingMode="tb-rl"}else{a._HtmlObj.children[0].rows[0].cells[0].children[0].style.writingMode="tb-rl"}}break;case"TextAndImage":WebToolBarEngine._SetTextAndImageItemToVerticalDisplay(a);break}}else{if(a.Type=="Custom"&&a.Visible==true){a._HtmlObj.style.display="none"}}if(a._Bar.Get("SizeMode")=="Fixed"){var b=a._HtmlObj;b.style.width="";b.style.height=a.Get("CommandSize")}},_SetTextAndImageItemToVerticalDisplay:function(a){var c=a.Type!="DropDownButton"&&a.Type!="SplitButton"?a._HtmlObj:a._HtmlObj.children[0].rows[0].cells[0];if(a.Get("TextAlign")=="Left"||a.Get("TextAlign")=="Right"){var b=document.createElement("DIV");if(!a._Bar.UseCssFramework){b.style.cssText="writing-mode:tb-rl"}var d=c.children[0];document.body.appendChild(d);b.innerHTML=c.innerHTML;c.innerHTML="";c.appendChild(b);if(a.Get("TextAlign")=="Left"){b.insertAdjacentElement("afterEnd",d)}else{b.insertAdjacentElement("beforeBegin",d)}}else{var d=c.children[0];d.style.display="inline"}},_CheckVerticalDisplayRows:function(c,b){if(c.rows.length<b){for(var a=c.rows.length;a<b;a++){c.insertRow(0)}}else{if(c.rows.length>b){for(var a=b;a<c.rows.length;a++){c.deleteRow(b)}}}},_SetItemToHorizontalDisplay:function(a){if(a.Type=="Button"||a.Type=="ToggleButton"||a.Type=="DropDownButton"||a.Type=="SplitButton"){if(a.Type=="DropDownButton"||a.Type=="SplitButton"){WebToolBarEngine._SetDropDownButtonItemToHorizontalDisplay(a)}switch(a.Get("DisplayMode")){case"Text":if(!a._Bar.UseCssFramework){if(a.Type!="DropDownButton"&&a.Type!="SplitButton"){a._HtmlObj.children[0].style.writingMode="lr-tb"}else{a._HtmlObj.children[0].rows[0].cells[0].children[0].style.writingMode="lr-tb"}}break;case"TextAndImage":WebToolBarEngine._SetTextAndImageItemToHorizontalDisplay(a);break}}else{if(a.Type=="Custom"&&a.Visible==true){a._HtmlObj.style.display=""}}if(a._Bar.Get("SizeMode")=="Fixed"){var b=a._HtmlObj;b.style.height="";b.style.width=a.Get("CommandSize")}},_SetTextAndImageItemToHorizontalDisplay:function(a){var b=a.Type!="DropDownButton"&&a.Type!="SplitButton"?a._HtmlObj:a._HtmlObj.children[0].rows[0].cells[0];var d;var c;switch(a.Get("TextAlign")){case"Left":d=b.children[0].innerHTML;c=b.children[1];document.body.appendChild(c);b.innerHTML=d;b.insertAdjacentElement("beforeEnd",c);break;case"Right":d=b.children[1].innerHTML;c=b.children[0];document.body.appendChild(c);b.innerHTML=d;b.insertAdjacentElement("afterBegin",c);break;case"Above":case"Underneath":b.children[0].style.display="block";break}},_GetOptionDropDownPaddingTopOnHorizontalDisplay:function(b){var a=ISPosLib.getHeight(b.FrameObj)-(b.Get("BarStyle")=="OfficeXP"||b.Get("BarStyle")=="IE"?2:0);return((a-16)+"px")},_AssignCommandsProperties:function(e){var a,c;var d=e.XmlDt.selectSingleNode("//CommandStyle");for(var b=0;b<e.Commands.length;b++){a=e.Commands[b];WebToolBarEngine._AssignPerCommandHTMLObj(b,e.Commands[b],e);a._Visible=a.Visible;a._PrevVisible=a.Visible;a._Collection=e.Commands;a.IsRendered=true;c=ISXml.GetAttribute(a.XmlNode,"ImageSize");if(c!=""&&c!=null){a.ImageSize.Parse(c)}if(a.Type!="Container"){BarControlEngine._AssignCommandStyle(a,e,d);if(e.MergeToolBar==null||e.MergeToolBar==false||e.NewCreatedMergeChildBar){e._AssignCommandListener(a)}}}},_AssignCommandHTMLObj:function(b){for(var a=0;a<b.Commands.length;a++){WebToolBarEngine._AssignPerCommandHTMLObj(a,b.Commands[a],b)}},_AssignPerCommandHTMLObj:function(b,a,c){a.Index=b;a._Bar=c;a._Image=a.Image;a._Text=a.Text;a._HtmlObj=document.getElementById(c.Id+"_"+a.Name+BarControlEngine.BarItemSuffix);a._PrevBarId=a._OriBarId=c.Id},_AssignCommandListener:function(a){if(a.Visible==true){var b=a._HtmlObj;Listener.Add(b,"onclick",WebToolBarEngine._OnClickCommand,a);Listener.Add(b,"ondblclick",WebToolBarEngine._OnDblClickCommand,a);Listener.Add(b,"onmousedown",WebToolBarEngine._OnMouseDownCommand,a);Listener.Add(b,"onmousemove",WebToolBarEngine._OnMouseMoveCommand,a);Listener.Add(b,"onmouseout",WebToolBarEngine._OnMouseOutCommand,a);Listener.Add(b,"onmouseover",WebToolBarEngine._OnMouseOverCommand,a);Listener.Add(b,"onmouseup",WebToolBarEngine._OnMouseUpCommand,a);Listener.Add(b,"onselectstart",WebToolBarEngine._OnSelectStart,a);Listener.Add(b,"onkeydown",WebToolBarEngine._OnKeyDownCommand,a)}},_GetPushedToggleCommandByGroup:function(e,f){var d;var a,b;for(var c=0;c<e.Commands.length;c++){a=e.Commands[c];if(a.Visible==true&&a.Type=="ToggleButton"&&a.Pushed&&a.ToggleGroupName==f){d=a;break}}return d},_GetToggleCommandsByGroup:function(d,e){var b=new Array();var a;for(var c=0;c<d.Commands.length;c++){a=d.Commands[c];if(a.Type=="ToggleButton"&&a.ToggleGroupName==e){b[b.length]=a}}return b},_GetToggleCommands:function(d){var b=new Array();var a;for(var c=0;c<d.Commands.length;c++){a=d.Commands[c];if(a.Type=="ToggleButton"){b[b.length]=a}}return b},_IsSplitButtonRaiseEvent:function(a){var b=WebToolBarEngine._GetDropDownCell(a);if(b.contains(window.event.srcElement)){return false}else{return true}},_OnActivateCommand:function(){var b=event;if(this.Type=="Custom"){return}if(b&&b.altKey){var c=b.fromElement;try{this.OnClick();if(this._Bar.Unloaded){return}if(this.Type=="SplitButton"){WebToolBarEngine._SetSplitButtonEffect(this,"Normal")}if(c){c.focus()}else{this._HtmlObj.blur()}}catch(a){}}},_OnSelectStart:function(){if(this.Type!="Custom"){event.returnValue=false}},_OnKeyDownCommand:function(){var b=event;var c=false;if(this.Type=="Custom"){return}if(b.keyCode==ISKeyboardKey.ENTER||b.keyCode==ISKeyboardKey.SPACE){this.OnClick();if(this.Type=="SplitButton"){WebToolBarEngine._SetSplitButtonEffect(this,"Normal")}c=true}else{if(b.keyCode==ISKeyboardKey.DOWN){if(this.Type=="SplitButton"){var a=WebToolBarEngine._GetDropDownCell(this);if(a){a.fireEvent("onmouseup")}}else{if(this.Type=="DropDownButton"){this.OnClick()}}c=true}}if(c){b.cancelBubble=true;b.returnValue=false}},_OnClickCommand:function(){if(!this.IsEnabled){return}if(this.Type=="SplitButton"&&WebToolBarEngine._IsSplitButtonRaiseEvent(this)==false){return}WebToolBarEngine._RaiseCommandClientSideEvents(this,"OnClick")},_OnDblClickCommand:function(){if(!this.IsEnabled){return}if(this.Type=="SplitButton"&&WebToolBarEngine._IsSplitButtonRaiseEvent(this)==false){return}WebToolBarEngine._RaiseCommandClientSideEvents(this,"OnDblClick")},_SetSplitButtonEffect:function(a,b){if(a._Bar&&a._Bar.UseCssFramework){return}if(a.Type=="SplitButton"){var c=WebToolBarEngine._GetDropDownCell(a);if(a._Bar.GetOrientation()=="Horizontal"){if(b=="Active"){c.style.borderLeft="1px solid "+WebToolBarEngine._GetSplitButtonColor(a.CommandStyle.Over);c.style.paddingLeft="0px"}else{if(b=="Normal"){c.style.borderLeft="";c.style.paddingLeft="1px"}}}else{if(b=="Active"){c.style.borderTop="1px solid "+WebToolBarEngine._GetSplitButtonColor(a.CommandStyle.Over);c.style.paddingTop="0px"}else{if(b=="Normal"){c.style.borderTop="";c.style.paddingTop="1px"}}}}},_OnMouseDownCommand:function(){var a=this._Bar.PlaceHolderManager;if(a!=null&&a.IsDraggingChild){return}if(!this.IsEnabled){return}if(this._HtmlObj.contains(window.event.srcElement)){if(this.Type!="Custom"&&this.Type!="Separator"){if(this.Type=="ToggleButton"){this.SetPushed(!this.Pushed)}else{this.CommandStyle.SetToActive()}if(this.Type=="DropDownButton"||this.Type=="SplitButton"){var b=this._HtmlObj.children[0];b.className=this.CommandFontStyle.Active;WebToolBarEngine._SetSplitButtonEffect(this,"Normal")}}if(this.Type=="SplitButton"&&WebToolBarEngine._IsSplitButtonRaiseEvent(this)==false){return}WebToolBarEngine._RaiseCommandClientSideEvents(this,"OnMouseDown")}},_OnMouseMoveCommand:function(){if(!this.IsEnabled){return}if(this.Type=="SplitButton"&&WebToolBarEngine._IsSplitButtonRaiseEvent(this)==false){return}WebToolBarEngine._RaiseCommandClientSideEvents(this,"OnMouseMove")},_OnMouseOverCommand:function(){var a=this._Bar.PlaceHolderManager;if(a!=null&&a.IsDraggingChild){return}if(!this.IsEnabled){return}if(this._HtmlObj.contains(window.event.srcElement)){if(this.Type!="Custom"&&this.Type!="Separator"){this.CommandStyle.SetToOver();if(this.Type=="DropDownButton"||this.Type=="SplitButton"){var b=this._HtmlObj.children[0];b.className=this.CommandFontStyle.Over;if(this.Type=="SplitButton"&&this._ContextMenu!=null&&!this._ContextMenu.RootMenu.IsOpen()){WebToolBarEngine._SetSplitButtonEffect(this,"Active")}else{if((this.Type=="SplitButton"||this.Type=="DropDownButton")&&this._ContextMenu!=null&&this._ContextMenu.RootMenu.IsOpen()){this.CommandStyle.SetToActive();b.className=this.CommandFontStyle.Active}}}}if(this.Type=="SplitButton"&&WebToolBarEngine._IsSplitButtonRaiseEvent(this)==false){return}WebToolBarEngine._RaiseCommandClientSideEvents(this,"OnMouseOver")}},_GetSplitButtonColor:function(a){var c="black";var b=IS.GetCssObject("",a,false);if(b!=null){c=b.borderLeftColor}return c},_OnMouseOutCommand:function(){var a=this._Bar.PlaceHolderManager;if(a!=null&&a.IsDraggingChild){return}if(!this.IsEnabled){return}if(this._HtmlObj.contains(window.event.srcElement)){if(this.Type!="Custom"&&this.Type!="Separator"){if(this.Type=="DropDownButton"||this.Type=="SplitButton"){if(this._ContextMenu!=null){if(this._ContextMenu.RootMenu.IsOpen()){return}}var b=this._HtmlObj.children[0];b.className=this.CommandFontStyle.Normal;WebToolBarEngine._SetSplitButtonEffect(this,"Normal")}if(this.Type!="ToggleButton"){this.CommandStyle.SetToNormal()}else{if(this.Pushed==false){this.CommandStyle.SetToNormal()}else{this.CommandStyle.SetToActive()}}}if(!this.IsEnabled){return}if(this.Type=="SplitButton"&&WebToolBarEngine._IsSplitButtonRaiseEvent(this)==false){return}WebToolBarEngine._RaiseCommandClientSideEvents(this,"OnMouseOut")}},_OnMouseUpCommand:function(){var b=this._Bar.PlaceHolderManager;if(b!=null&&b.IsDraggingChild){return}if(!this.IsEnabled){return}if(this._HtmlObj.contains(window.event.srcElement)){if(this.Type!="Custom"&&this.Type!="Separator"){if(this.Type!="ToggleButton"){this.CommandStyle.SetToOver()}else{if(this.Pushed==false){this.CommandStyle.SetToNormal()}else{this.CommandStyle.SetToActive()}}if(this.Type=="DropDownButton"||this.Type=="SplitButton"){if(this._Bar.LazyLoadContextMenu&&this._ContextMenu==null){WebToolBarEngine._CreateCommandsContextMenu(this._Bar)}if(this._ContextMenu!=null&&this._ContextMenu.RootMenu.IsOpen()||WebToolBarEngine._IsSplitButtonRaiseEvent(this)==false){this.CommandStyle.SetToActive();this._HtmlObj.children[0].className=this.CommandFontStyle.Active}else{if(this.Type=="SplitButton"){WebToolBarEngine._SetSplitButtonEffect(this,"Active")}}}}if((this.Type=="SplitButton"&&WebToolBarEngine._IsSplitButtonRaiseEvent(this)==false)||this.Type=="DropDownButton"){var a=this;setTimeout(function(){if(a._ContextMenu&&!a._ContextMenu.JustClosed&&!a._ContextMenu.RootMenu.IsOpen()){WebToolBarEngine._ShowContextMenu(a)}else{a.CommandStyle.SetToOver()}},150)}if(this.Type=="SplitButton"&&WebToolBarEngine._IsSplitButtonRaiseEvent(this)==false){return}if(WebToolBarEngine._RaiseCommandClientSideEvents(this,"OnMouseUp")==true){if(this.Type!="DropDownButton"&&WebToolBarEngine){WebToolBarEngine._RaisePostBackCommandClick(this)}}}},_ShowContextMenu:function(a){WebToolBarEngine._HideAllContextMenuButton(a._Bar,a);if(a._ContextMenu!=null){var b=a._ContextMenu.RootMenu;if(b.Items.length<=0){return}var c=ISPosLib.getScreenLeft(a._HtmlObj);var d=ISPosLib.getScreenTop(a._HtmlObj)+ISPosLib.getHeight(a._HtmlObj);if(a.Type=="DropDownButton"){a.CommandStyle.SetToActive();a._HtmlObj.children[0].className=a.CommandFontStyle.Active}a._ContextMenu.SetOffsetElement(a._HtmlObj);if(a.Menu.OffsetAlignment=="RightTop"){b.OffsetAlignment="LeftBottom"}b.Direction="Vertical";b.Show();return}},_ShowCustomizeWindowFromMoreItems:function(a){if(typeof(CustomizeWindowBAR)!="undefined"){var b=a._Bar.PlaceHolderManager;if(b!=null){b.ShowCustomizeWindow()}}},_CreateAddRemoveOptionMenuItems:function(g){var c=WebToolBarEngine._CreateAddRemoveOptionMenuItemsRoot(g);if(c==null){return}var a=g._OptionContextMenu;var b,f;for(var d=0;d<g.Commands.length;d++){b=g.Commands[d];var e="";if(b.Image!=""){e="<img align=absmiddle src='"+b.Image+"'>&nbsp;"}else{e="<img align=absmiddle style='width:16; height:16; visibility:hidden'>&nbsp;"}if(b.Type=="Button"||b.Type=="DropDownButton"||b.Type=="SplitButton"||b.Type=="ToggleButton"){f=new WebMenuItem(b.Name,e+b.Text,null,"WebToolBarEngine._MoreItemOnClick");f._ToolCommand=b;f.Tooltip=b.ToolTip;f.Type="CheckBox";f.KeepMenuVisible=true;f.Checked=b.Visible;c.Items.Add(f)}}},_HideAllContextMenuButton:function(e,c){var b=null;var a;for(var d=0;d<e.Commands.length;d++){b=e.Commands[d];if(b!=c&&(b.Type=="DropDownButton"||b.Type=="SplitButton")){a=b._ContextMenu;if(a!=null){if(b.Type=="SplitButton"&&!e.UseCssFramework){var f=WebToolBarEngine._GetDropDownCell(b);f.style.borderLeft="";f.style.paddingLeft="1px"}b.CommandStyle.SetToNormal();a.HideAll()}}}},_IconItemClick:function(a){a._ToolCommand.OnClick()},_CreateAddRemoveOptionMenuItemsRoot:function(l){var a=l._OptionContextMenu;var h=a.RootMenu;var c=false;if(l.Get("AddRemoveOptionMenuViewMode")=="IconView"){h.IconViewMode=true;h.Width=150}var b;if(l.Get("AllowExpandCollapse")=="Yes"){for(var d=0;d<l.Commands.length;d++){b=l.Commands[d];if(b._UIVisible==false&&b.IsEnabled&&b.Visible==true&&(b.Type!="Separator"&&b.Type!="Custom"&&b.Type!="Container")){var j=h.Items.Add(new WebMenuItem(b.Name,b.Text,b.Image,"WebToolBarEngine._OnCommandContextMenuClick"));j._ToolCommand=b;j.Tooltip=b.ToolTip;if(b.Type=="DropDownButton"||b.Type=="SplitButton"){WebToolBarEngine._CreateSubMoreItems(j,b.Items)}c=true}}}if(l.Get("AllowCustomize")=="Yes"){if(c){h.Items.Add(new WebMenuSeparatorItem())}var e=new WebMenuItem("rAddRemoveButtons","Add or Remove Buttons");h.Items.Add(e);e.IconViewMode=false;e.IconViewDisplayMode="Text";var f=new WebMenuItem("r"+l.Id,l.Caption);e.Items.Add(f);if(l.PlaceHolder!=null&&l.PlaceHolder!=""){var g=new WebMenuItem("rCustomize","Customize ...","","WebToolBarEngine._ShowCustomizeWindowFromMoreItems");g._Bar=l;g.Enabled=l.Get("AllowCustomize")=="Yes";e.Items.Add(g)}}return f},_CreateSubMoreItems:function(e,d){if(d==null){return}e.SubMenu.IconViewMode=d.Parent.IconViewMode;for(var b=0;b<d.length;b++){var c=d[b];var a=new WebMenuItem();a.CopyFrom(c);e.Items.Add(c)}},_MoreItemOnClick:function(a){a._ToolCommand.SetVisible(a.Checked)},ShowOptionWindow:function(d){var g=ISGetObject(d);if(typeof(CustomizeWindowBAR)!="undefined"){var b=PlaceHolderManagerEngine.GetCustomizeWindow();b.Hide()}g.CheckCommandsVisibility();var a=g._OptionContextMenu;if(g._IsReCalculateOptionMenu==true||a==null){if(a!=null){a.ClearAll()}a=new WebContextMenu(g.Id+"MoreItems");a.RootMenu=new WebMenu();a.UseCssFramework=g.UseCssFramework;a.RootMenu.UseCssFramework=g.UseCssFramework;a.RootMenu.MenuControl=a;g._OptionContextMenu=a;WebToolBarEngine._CreateAddRemoveOptionMenuItems(g);a.MenuStyleSettings=g.MenuStyleSettings;if(g._IsCreateDefaultMenuStyles==true){try{if(!g.UseCssFramework&&(g.IntegratedTo=="None"||(IS.safari&&(a.MenuStyleSettings.FrameStyle==null||a.MenuStyleSettings.FrameStyle=="")))){WebToolBarEngine._CreateContextMenuTempClasName(g.Id,a.MenuStyleSettings)}a.CreateDefaultStyles()}catch(c){}}a.RefreshStructure();g._IsReCalculateOptionMenu=false}var f;if(g.Get("IsFloat")=="No"){f=document.getElementById(g.Id+BarControlEngine.BarOptionSuffix+"_"+g.GetOrientation());a.RootMenu.Direction="Vertical";if(g.GetOrientation()=="Horizontal"){a.RootMenu.OffsetAlignment="LeftBottom"}else{a.RootMenu.OffsetAlignment="RightTop"}}else{f=document.getElementById(g.Id+IS.FrameHeaderSuffix).offsetParent.rows[0].cells[1];a.RootMenu.Direction="Vertical";a.RootMenu.OffsetAlignment="LeftBottom"}a.SetOffsetElement(f);if(a.RootMenu.Items.length>0){a.RootMenu.Show()}},_CalculateAvailableMaxDimensionToDock:function(h,g){var a=0;var e=g=="h"?h.offsetWidth:h.offsetHeight;var c,f;for(var b=0;b<h.children.length;b++){c=h.children[b];if(c.id.indexOf(IS.FrameSuffix)>-1){f=ISGetObject(c.id.replace(IS.FrameSuffix,""));if(f!=null){if(f.ClassName=="WebToolBar"){a+=g=="h"?f.FrameObj.offsetWidth:f.FrameObj.offsetHeight}}}}return(e-a)},_ShowCommand:function(c,a,d){c._UIState="ShowCommand";var b;if(typeof(a)=="object"){b=a}else{b=c.Commands[a]}b.Visible=b._PrevVisible=b._Visible=true;b._UIState="Show";c.UpdateUI(d);return true},_HideCommand:function(c,a,d){var b;if(typeof(a)=="object"){b=a}else{b=c.Commands[a]}c._UIState="HideCommand";b.Visible=b._PrevVisible=b._Visible=false;b._UIState="Hide";c.UpdateUI(d);return true},_AddCommand:function(c,a,b){if(typeof(b)=="number"){c.Commands.InsertAt(a,b)}else{c.Commands.Add(a)}},_RemoveCommand:function(c,a){var b;if(typeof(a)=="object"){b=a}else{b=c.Commands[a]}c.Commands.Remove(b,false)},_OnUnLoadPage:function(j,g){var a=g==true?j:this;if(a.MergeToolBar!=true){return}if(!IS.safari&&!IS.opera){Listener.Remove(window,"onbeforeunload",WebToolBarEngine._OnUnLoadPage,a)}if(a.MergeToolBarParentID==null||a.MergeToolBarParentID==""){try{if(a._prntPHM!=null&&a._prntPHM.UnRegisterBar){a._prntPHM.UnRegisterBar(a.Id)}var l=WebToolBarMergingEngine.GetParentFrameWindowName(a.MergeToolBarParentWindowName);var b;for(i in l.IS.RuntimeObjects){b=l.IS.RuntimeObjects[i];if(b.Id==a.Id){delete l.IS.RuntimeObjects[i];break}}var c=a.FrameObj.ownerDocument;var f=c.getElementById(a.Id+IS.XmlSuffix);f.removeNode(true);f=c.getElementById(a.Id+IS.HiddenDataSuffix);f.removeNode(true);f=c.getElementById(a.Id+BarControlEngine.BarOptionWindowSuffix);f.removeNode(true);a.FrameObj.removeNode(true);a._prntPHM=null}catch(d){}}else{var h=a._ParentBarMerging;if(h!=null&&h._ClearMergedCommandsByChildBar!=null){h._ClearMergedCommandsByChildBar(a);h.UpdateUI(true)}a._ParentBarMerging=null}a._prntPHM=null;a=null},CreateNewToolBar:function(b,a){WebToolBarFactoryEngine.CreateNewToolBar(b,a)},AssignCommandName:function(a){if(a.Name==null||a.Name==""){var b=a.Text==null?"":a.Text;a.Name="cmd"+b.replace(" ","").replace("/","").replace(".","").replace("&","")}},Render:function(h){var a=null;var f=h._IsHorizontal;var d=h._HtmlObjH_tbl;var j=h._HtmlObjV_tbl;var g;var b=h.CommandMargin;var c;for(var e=0;e<h.Commands.length;e++){a=h.Commands[e];if(a.IsRendered==false){WebToolBarEngine.AssignCommandName(a);if(f){WebToolBarEngine.RenderHorizontalCommand(a,d,g,b)}else{WebToolBarEngine.RenderVerticalCommand(a,j,g,b)}a.IsRendered=true;h.IsRuntimeToolCommandCreated=true;if(a._Bar!=null){a.Category=a._Bar.Id;if(a._Bar.PlaceHolderManager!=null){var l=a._Bar.PlaceHolderManager.GetCustomizeWindow();if(l!=null){l.RegisterCommand(a)}}}}g=a._HtmlObj}},RenderHorizontalCommand:function(a,d,g,b){var f=null;var c=null;var h=d.rows[0];var e=g==null?0:(g.cellIndex+1);f=h.insertCell(e);e++;c=h.insertCell(e);WebToolBarEngine.SetCommandMarginCell(f,b,true);WebToolBarEngine.SetCommandCell(a,c,b)},RenderVerticalCommand:function(a,g,e,b){var d=null;var c=null;var f=g.insertRow(e==null?-1:(e.parentNode.rowIndex+1));d=f.insertCell(-1);c=g.insertRow(f.rowIndex+1).insertCell(-1);WebToolBarEngine.SetCommandMarginCell(d,b,false);WebToolBarEngine.SetCommandCell(a,c,b)},SetCommandMarginCell:function(d,a,c){var e=document.createAttribute("type");e.value="m";d.attributes.setNamedItem(e);var b=document.createElement("DIV");d.appendChild(b);b.style.overflow="hidden";if(c==true){d.style.width=a;b.style.width=a}else{d.style.height=a;b.style.height=a}},SetCommandCell:function(a,c,b){a._HtmlObj=c;c.align="center";c.style.cssText="WHITE-SPACE: nowrap";c.tabIndex=-1;c.vAlign="middle";c.id=a.Parent.ClientID+"_"+a.Name+BarControlEngine.BarItemSuffix;c.title=WebToolBarEngine.GetCommandToolTip(a);if(a.IsEnabled==false){c.disabled=true}if(a.Visible==false){c.style.display="none"}if(a.Get("Type")!="Container"){var d=a.Parent;BarControlEngine._AssignCommandStyle(a,d,d.XmlDt.selectSingleNode("//CommandStyle"));if(d.MergeToolBar==null||d.MergeToolBar==false||d.NewCreatedMergeChildBar){d._AssignCommandListener(a)}}switch(a.Get("Type")){case"Button":case"ToggleButton":WebToolBarEngine.RenderCommandButton(a,c,b);break;case"Custom":WebToolBarEngine.RenderCustomButton(a,c,b);break;case"DropDownButton":case"SplitButton":WebToolBarEngine.RenderDropDownButton(a,c,b);break;case"Separator":WebToolBarEngine.RenderSeparatorButton(a,c,b);break;case"Container":WebToolBarEngine.RenderContainerButton(a,c,b);break}},GetCommandToolTip:function(a){var b="";if(a.Get("DisplayToolTip")=="Yes"){b=a.Get("ToolTip");if(a.Get("DisplayAccessKeyOnToolTip")=="Yes"){if(a.Get("AccessKey")==null||a.Get("AccessKey")==""){b+=" (Alt + "+a.Get("AccessKey")+")"}}}return b},RenderCommandButton:function(a,c,b){var d="";if(a.Parent.Get("SizeMode")=="Fixed"){if(a.Parent._IsHorizontal==true){d+=";overflow:hidden;width:"+a.CommandSize.toString()}else{d+=";overflow:hidden;height:"+a.CommandSize.toString()}}if(a._Bar.UseCssFramework){c.setAttribute("display-mode",a.Get("DisplayMode").toLowerCase());c.setAttribute("commandtext-align",a.Get("TextAlign").toLowerCase());c.setAttribute("command-type",a.Type.toLowerCase())}if(a.Get("Type")!="ToggleButton"){c.className=a.IsEnabled?a.CommandStyle.Normal:a.Parent.CommandDisabledStyle}else{if(a.IsEnabled){c.className=a.Pushed?a.CommandStyle.Active:a.CommandStyle.Normal}else{c.className=a.Pushed?a.CommandStyle.Active:a.Parent.CommandDisabledStyle}}c.style.cssText+=d;if(a.AccessKey==null||a.AccessKey==""){c.accessKey=a.AccessKey;c.tabIndex=a.Parent.ShowFocusBorder?0:-1}switch(a.Get("DisplayMode")){case"Text":WebToolBarEngine.RenderCommandText(a,a._HtmlObj);break;case"Image":WebToolBarEngine.RenderImageCommand(a,"",a._HtmlObj);break;case"TextAndImage":WebToolBarEngine.RenderImageAndTextCommand(a,a._HtmlObj);break}},RenderCommandText:function(a,c){var b=document.createElement("DIV");if(a.Parent._IsHorizontal==false){if(IS.moz==false&&IS.safari==false){b.style.cssText=a._Bar.UseCssFramework?"white-space: nowrap;":"white-space: nowrap;writing-mode:tb-rl"}}else{b.style.cssText="white-space: nowrap;"}c.appendChild(b);WebToolBarEngine._RenderCommandText(a,b)},RenderImageCommand:function(a,b,c){var d=document.createElement("IMG");d.align="absmiddle";b+="overflow:hidden;";if(a._Bar.UseCssFramework){d.setAttribute("ui-part","toolbar-command-image")}else{b+="width:"+a.ImageSize.Width+";";b+="height:"+a.ImageSize.Height}if(a.IsEnabled==false&&toolBar.GreyImageWhenDisabled=="Yes"){b+=";filter:Alpha(Opacity=50), Gray()"}d.style.cssText=b;if(a.Image!=null&&a.Image!=""){d.src=a.Parent.ResolveImagePath(a.Image.charAt(0)=="."||a.Image.charAt(0)=="/"||a.Image.charAt(0)=="~"?a.Parent.ImagesDirectory:"",a.Image)}c.appendChild(d)},RenderImageAndTextCommand:function(a,c){if(a.Parent._IsHorizontal==true){var c=a._HtmlObj;switch(a.Get("TextAlign")){case"Left":WebToolBarEngine._RenderCommandText(a,c);if(!a._Bar.UseCssFramework){c.insertAdjacentHTML("beforeEnd","&nbsp;")}WebToolBarEngine.RenderImageCommand(a,"",c);break;case"Right":WebToolBarEngine.RenderImageCommand(a,"",c);if(!a._Bar.UseCssFramework){c.insertAdjacentHTML("beforeEnd","&nbsp;")}WebToolBarEngine._RenderCommandText(a,c);break;case"Above":WebToolBarEngine._RenderCommandText(a,c);WebToolBarEngine.RenderImageCommand(a,"display:block",c);break;case"Underneath":WebToolBarEngine.RenderImageCommand(a,"display:block",c);WebToolBarEngine._RenderCommandText(a,c);break}}else{switch(a.Get("TextAlign")){case"Left":WebToolBarEngine.RenderCommandText(a,c);WebToolBarEngine.RenderImageCommand(a,"",c);break;case"Right":WebToolBarEngine.RenderImageCommand(a,"",c);WebToolBarEngine.RenderCommandText(a,c);break;case"Above":var b=document.createElement("DIV");b.style.cssText=a._Bar.UseCssFramework?"white-space: nowrap;":"white-space: nowrap;writing-mode:tb-rl";c.appendChild(b);WebToolBarEngine._RenderCommandText(a,b);WebToolBarEngine.RenderImageCommand(a,"display:block",b);break;case"Underneath":var b=document.createElement("DIV");b.style.cssText=a._Bar.UseCssFramework?"white-space: nowrap;":"white-space: nowrap;writing-mode:tb-rl";c.appendChild(b);WebToolBarEngine.RenderImageCommand(a,"display:block",b);WebToolBarEngine._RenderCommandText(a,b);break}}},_RenderCommandText:function(a,b){var d="";if(a.Text==null||a.Text==""){d="&nbsp;"}if(a.AccessKey==null||a.AccessKey==""){d=a.Text}else{var c=a.Text.toLowerCase().indexOf(a.AccessKey);if(c>-1){d=a.Text.Substring(0,c);d+="<u>";d+=a.Text.Substring(c,1);d+="</u>";d+=a.Text.Substring(c+1)}else{d=a.Text}}b.insertAdjacentHTML("beforeEnd",d)},RenderCustomButton:function(a,c,b){var d="";if(a.Parent.Get("SizeMode")=="Fixed"){if(a.Parent._IsHorizontal==true){d+=";padding:0px;overflow:hidden;width:"+a.CommandSize.toString()}else{d+=";padding:0px;overflow:hidden;height:"+a.CommandSize.toString()}}c.className=a.IsEnabled?a.CommandStyle.Normal:a.Parent.CommandDisabledStyle;c.style.cssText+=d;var e=document.createElement("DIV");c.appendChild(e);if(a.CommandSize!="50px"){if(a.Parent._IsHorizontal==true){e.style.width=a.CommandSize.toString()}else{e.style.height=a.CommandSize.toString()}}if(a.Parent._IsHorizontal==true){if(IS.moz==false&&IS.safari==false&&!a._Bar.UseCssFramework){e.style.writingMode="tb-rl"}}},RenderDropDownButton:function(c,e,d){var f="";if(c.Parent.Get("SizeMode")=="Fixed"){if(c.Parent._IsHorizontal==true){f+=";overflow:hidden;width:"+c.CommandSize.toString()}else{f+=";overflow:hidden;height:"+c.CommandSize.toString()}}e.style.cssText+=f;e.className=c.IsEnabled?c.CommandStyle.Normal:c.Parent.CommandDisabledStyle;if(c._Bar.UseCssFramework){e.setAttribute("display-mode",c.Get("DisplayMode").toLowerCase());e.setAttribute("commandtext-align",c.Get("TextAlign").toLowerCase());e.setAttribute("command-type",c.Type.toLowerCase())}if(c.AccessKey==null||c.AccessKey==""){e.accessKey=c.AccessKey;e.tabIndex=c.Parent.ShowFocusBorder?0:-1}var h=document.createElement("TABLE");e.appendChild(h);h.cellSpacing=0;h.cellPadding=0;h.border=0;h.style.cssText="width:100%;height:100%";h.className=c.IsEnabled?c.Parent.CommandFontStyle.Normal:c.Parent.CommandDisableFontStyle;var g=h.insertRow(-1);var a=g.insertCell(-1);a.align="center";a.vAlign="middle";a.style.cssText="white-space:nowarp";switch(c.Get("DisplayMode")){case"Text":WebToolBarEngine.RenderCommandText(c,a);break;case"Image":WebToolBarEngine.RenderImageCommand(c,"",a);break;case"TextAndImage":WebToolBarEngine.RenderImageAndTextCommand(c,a);break}var b=null;if(c.Parent._IsHorizontal==false){b=h.insertRow(-1).insertCell(-1);b.align="center";b.vAlign="middle";b.style.cssText="overflow: hidden; white-space: nowrap";if(c._Bar.UseCssFramework){b.setAttribute("ui-part","command-dropdown-arrow");b.innerHTML='<img src="'+IS.TransparentImage+'">'}else{b.style.cssText+="padding-top: 1px; height: 12px;";b.innerHTML='<font face="webdings" style="font-size:8px">6</font>'}}else{b=g.insertCell(-1);if(c._Bar.UseCssFramework){b.setAttribute("ui-part","command-dropdown-arrow");b.innerHTML='<img src="'+IS.TransparentImage+'">'}else{b.style.cssText="padding-left: 1px; width: 12px;";b.innerHTML='<font face="webdings" style="font-size:8px">6</font>'}}},RenderSeparatorButton:function(a,c,b){c.className=a.Parent.SeparatorStyle;c.innerHTML="&nbsp;"},RenderContainerButton:function(a,c,b){c.style.overflow="hidden";if(a.Parent._IsHorizontal){c.style.width="0px"}else{c.style.height="0px"}}};function HideFloatingToolBar(a){var b=ISGetObject(a);b.Hide()}function WebToolBarOnLoad(){WebToolBarEngine.IsWindowLoaded=true;var a=ISGetCurrentWindow();if(a){if(a!=ISGetActiveWindow()){a.UnregisterAccessKeys()}}}function WebToolBarOnUnLoad(){window.detachEvent("onload",WebToolBarOnLoad);window.detachEvent("onbeforeunload",WebToolBarOnBeforeUnLoad);window.detachEvent("onunload",WebToolBarOnUnLoad);IS.RegisterUnloadVariables("pWTB");IS.RegisterUnloadVariables("pTCmd");IS.RegisterUnloadVariables("ToolCommandEngine");IS.RegisterUnloadVariables("WebToolBarEngine");IS.RegisterUnloadVariables("WebToolBarFactoryEngine");IS.RegisterUnloadVariables("WebToolBarMergingEngine");IS.RegisterUnloadVariables("CommandEngine");IS.RegisterUnloadVariables("ISBarCommon");IS.RegisterUnloadVariables("ISDrag");IS.RegisterUnloadVariables("BarControlEngine")}function WebToolBarOnBeforeUnLoad(){var a;for(var c=0;c<IS.RuntimeObjects.length;c++){a=IS.RuntimeObjects[c];if(a==null){continue}if(a.GetType()=="WebToolBar"){if(a.Get("AllowMove")=="Yes"){Listener.Unload(document.getElementById(a.Id+BarControlEngine.BarHandleSuffix+"_Vertical"));Listener.Unload(document.getElementById(a.Id+BarControlEngine.BarHandleSuffix+"_Horizontal"));var b=document.getElementById(a.Id+IS.FrameHeaderSuffix);if(b!=null){Listener.Unload(b);Listener.Unload(b.offsetParent);Listener.Unload(b.parentNode.parentNode)}}}}}function DoWebToolBarResize(a){a._IsReCalculateOptionMenu=true}function CreateWebToolBar(a,b){return WebToolBarFactoryEngine.CreateNewToolBar(b,a)}window.attachEvent("onload",WebToolBarOnLoad);window.attachEvent("onbeforeunload",WebToolBarOnBeforeUnLoad);window.attachEvent("onunload",WebToolBarOnUnLoad);