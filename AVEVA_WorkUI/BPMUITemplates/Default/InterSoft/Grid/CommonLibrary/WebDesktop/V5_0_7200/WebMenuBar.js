function InitWebMenuBar(a){var b=WebMenuBarEngine.Create(a);var c=ISGetCurrentWindow();if(c){if(c!=ISGetActiveWindow()){b.UnregisterAccessKeys()}}}function WebMenuBar(a){this.ClassName="WebMenuBar";this.RequiredFrameworkVersion="2.0.5000.18";WebMenuControlBase.call(this,a);BarControl.call(this);this.ClassName="WebMenuBar";this.ImagesDirectory="/CommonLibrary/Images/WebDesktop/";this.WebResourceIdentifier="D";this.Menus=new ISArray();this.AllowCustomize="No";this.ActiveMenu=null;this.DisplayAccessKeyOnToolTip="No";this.OnPostInitialized=function(){WebMenuBarEngine._OnPostInitialized(this)};this.OnUnload=function(){WebMenuBarEngine._OnUnload(this);this.Unloaded=true};this.ReBindingPostBackData=function(){WebMenuBarEngine.AssignPropertiesToXml(this)};this._GetItems=function(){return this.Menus}}var pWMB=WebMenuBar.prototype;pWMB.HideAll=function(){for(var a=0;a<this.Menus.length;a++){var b=this.Menus[a];if(b._ContextMenu){b._ContextMenu.HideAll()}}};pWMB.SelectMenu=function(a){WebMenuBarEngine._SelectMenu(this,a)};pWMB.SelectPrevMenu=function(){WebMenuBarEngine._SelectPrevMenu(this)};pWMB.SelectNextMenu=function(){WebMenuBarEngine._SelectNextMenu(this)};pWMB.OnMenuKeyDown=function(b,a){WebMenuBarEngine._OnMenuKeyDown(this,b,a)};pWMB.ShowMenu=function(a,b){WebMenuBarEngine._ShowMenu(this,a,b)};pWMB.HideMenu=function(a,b){WebMenuBarEngine._HideMenu(this,a,b)};pWMB.AddMenu=function(a,b){WebMenuBarEngine._AddMenu(this,a,b)};pWMB.RemoveMenu=function(a){WebMenuBarEngine._RemoveMenu(this,a)};pWMB.EnableMenu=function(a){WebMenuBarEngine._EnableMenu(this,a)};pWMB.DisableMenu=function(a){WebMenuBarEngine._DisableMenu(this,a)};pWMB._SetItemToHorizontalDisplay=function(a){WebMenuBarEngine._SetItemToHorizontalDisplay(a)};pWMB._SetItemToVerticalDisplay=function(a){WebMenuBarEngine._SetItemToVerticalDisplay(a)};pWMB._UpdateCommandTextAndImage=function(a){WebMenuBarEngine._UpdateCommandTextAndImage(a)};pWMB._AssignCommandListener=function(a){WebMenuBarEngine._AssignCommandListener(a)};function MenuCommand(){Command.call(this);this._Type="MenuCommand";this.DisplayAccessKeyOnToolTip="No";this.Type="Normal";this.__getter=function(a){return MenuCommandEngine.__getter(this,a)};this.__setter=function(b,c,a){return MenuCommandEngine.__setter(this,b,c,a)}}var pMnCmd=MenuCommand.prototype;pMnCmd.OnAccessKey=function(){MenuCommandEngine._OnClick(this)};pMnCmd.SetVisible=function(b,a){MenuCommandEngine._SetVisible(this,b,a)};pMnCmd.SetIsEnabled=function(a){MenuCommandEngine._SetIsEnabled(this,a)};pMnCmd.OnClick=function(){MenuCommandEngine._OnClick(this)};pMnCmd.OnPostBackClick=function(){MenuCommandEngine._OnPostBackClick(this)};pMnCmd.Select=function(){MenuCommandEngine._Select(this)};pMnCmd.GetPreviousNormalMenu=function(){return MenuCommandEngine._GetPreviousNormalMenu(this)};pMnCmd.GetNextNormalMenu=function(){return MenuCommandEngine._GetNextNormalMenu(this)};pMnCmd.IsValidCommandType=function(){return(this.Type!="Custom"&&this.Type!="Separator")};pMnCmd.AttachMenuItem=function(a){MenuCommandEngine._AttachMenuItem(this,a)};var MenuCommandEngine={__getter:function(a,b){var d;switch(b){case"Menu":d=a._ContextMenu!=null?a._ContextMenu.RootMenu:a.Menu;break;default:d=CommandEngine.__getter(a,b);break}return d},__setter:function(b,d,e,a){switch(d){case"Visible":b.SetVisible(e);break;case"IsEnabled":b.SetIsEnabled(e);break;default:CommandEngine.__setter(b,d,e,a);break}},_OnClick:function(a){WebMenuBarEngine._ClearOtherOnClickCommand(a._Bar);if(!IS.ie){var b=document.createEventObject();b.srcElement=a._HtmlObj;a._HtmlObj.fireEvent("onmouseover",b);var c=document.createEventObject();c.srcElement=a._HtmlObj;a._HtmlObj.fireEvent("onmousedown",c);var d=document.createEventObject();d.srcElement=a._HtmlObj;a._HtmlObj.fireEvent("onmouseup",d)}else{a._HtmlObj.fireEvent("onmouseover");a._HtmlObj.fireEvent("onmousedown");a._HtmlObj.fireEvent("onmouseup")}WebMenuBarEngine._ActiveWebMenuBar=a._Bar},_OnPostBackClick:function(b){var a=b._Bar;var c="Type='CommandClick'";c+=":Name='"+b.Name+"'";if(b.SelectedMenuItem!=null){c+=":ItemNameHierarchy='"+WebMenuEngine.GetSelectedMenuItemHierarchy(b.SelectedMenuItem)+"'"}if(typeof(Page_ClientValidate)=="function"){Page_ClientValidate(null,true)}if(typeof(Page_BlockSubmit)=="undefined"||!Page_BlockSubmit){__doPostBack(a.ServerUniqueID,c)}},_SetIsEnabled:function(a,c){a.IsEnabled=c;a._HtmlObj.disabled=!c;if(a.Type=="Normal"){a._HtmlObj.className=c==true?a.CommandStyle.Normal:a.CommandDisabledStyle;if(a._Bar.Get("GreyImageWhenDisabled")=="Yes"&&(a.Get("DisplayMode")=="Image"||a.Get("DisplayMode")=="TextAndImage")){var b=a._HtmlObj.getElementsByTagName("IMG")[0];if(c==true){b.style.cssText=(!IS.IsHTML5DocType())?b.style.cssText.replace("FILTER: Alpha(Opacity=50), Gray()",""):b.style.cssText.replace("filter: Alpha(Opacity=50), Gray();","")}else{b.style.cssText=(!IS.IsHTML5DocType())?b.style.cssText+";FILTER: Alpha(Opacity=50), Gray()":b.style.cssText+"filter: Alpha(Opacity=50), Gray();"}}}},_SetVisible:function(b,d,a){b.Visible=b._Visible=b._PrevVisible=d;if(a==true){b._Bar._UIState=b._UIState="Update"}else{try{if(b._Bar.GetOrientation()=="Horizontal"){b._HtmlObj.previousSibling.style.display=b.Visible?"":"none"}else{b._HtmlObj.offsetParent.rows[marginIndex].style.display=b.Visible?"":"none"}}catch(c){}b._HtmlObj.style.display=b.Visible?"":"none"}},_GetPreviousNormalMenu:function(a){var d=null;for(var b=a.Index-1;b>-1;b--){var c=a._Collection[b];if(c.Type=="Normal"){d=c;break}}if(d==null&&a.Index!=a._Collection.length-1){d=a._Collection[a._Collection.length-1]}return d},_GetNextNormalMenu:function(a){var d=null;for(var b=a.Index+1;b<a._Collection.length;b++){var c=a._Collection[b];if(c.Type=="Normal"){d=c;break}}if(d==null&&a.Index!=0){d=a._Collection[0]}return d},_Select:function(a){WebMenuBarEngine._ClearOtherOnClickCommand(a._Bar);a._HtmlObj.fireEvent("onmouseover");WebMenuBarEngine._ActiveWebMenuBar=a._Bar;a._Bar.ActiveMenu=a},_AttachMenuItem:function(a,b){if(!b.HasSubMenu()){if(b.OnClick!=null){b._OnClick=b.OnClick}b.OnClick="WebMenuBarEngine._OnCommandContextMenuClick"}b._MenuCommand=a}};var WebMenuBarEngine={_ActiveWebMenuBar:null,IsWindowLoaded:false,Create:function(a){var b=ISGetObject(a);if(b!=null){return b}b=new WebMenuBar(a);b.Name=a;WebMenuBarEngine.AssignProperties(b);if(WebMenuBarEngine.IsWindowLoaded){b.OnPostInitialized();b.IsOnPostInitialized=true}return b},_OnPostInitialized:function(c){if(c.PlaceHolder!=null&&c.PlaceHolder!=""){var d=ISGetObject(c.PlaceHolder);if(d==null){try{InitPlaceHolderManager(c.PlaceHolder)}catch(b){var a;for(i in IS.RuntimeObjects){a=IS.RuntimeObjects[i];if(a.Id==c.PlaceHolder){delete IS.RuntimeObjects[i];break}}if(c.Id.indexOf("_")>-1){InitPlaceHolderManager(c.Id.substr(0,c.Id.lastIndexOf("_")+1)+c.PlaceHolder)}}d=ISGetObject(c.PlaceHolder)}WebMenuBarEngine.RegisterBehaviour(c);if(d.IsPostBack){WebMenuBarEngine._AssignCommandHTMLObj(c)}d.RegisterBar(c);c._UIState=""}WebMenuBarEngine.AssignProperties1(c);if(c.Opacity!=1){c.Set("Opacity",c.Opacity)}},_OnUnload:function(d){var b=document.getElementById(d.Id+IS.FrameHeaderSuffix);if(b!=null){Listener.Unload(b.parentNode.parentNode)}var a=d.Menus;for(var c=0;c<a.length;c++){if(a[c]._HtmlObj!=null){a[c].Set("Visible",true);Listener.Unload(a[c]._HtmlObj)}}Listener.Unload(document.body);if(d.Get("AllowMove")=="Yes"){Listener.Unload(document.getElementById(d.Id+BarControlEngine.BarHandleSuffix+"_Vertical"));Listener.Unload(document.getElementById(d.Id+BarControlEngine.BarHandleSuffix+"_Horizontal"));Listener.Unload(document.getElementById(d.Id+IS.FrameHeaderSuffix))}window.detachEvent("onresize",function(){DoWebMenuBarResize(d)})},_ClearOtherOnClickCommand:function(c){var a;for(var b=0;b<c.Menus.length;b++){a=c.Menus[b];if(a.IsEnabled==true&&a.Type=="Normal"){a.CommandStyle.SetToNormal()}}c.ActiveMenu=null},_GetElementsByAttribute:function(e,a,b){var f=new Array();var g;if(e.getAttribute(a)==b){f[f.length]=e}var d=e.children;for(var h=0;h<d.length;h++){g=WebMenuBarEngine._GetElementsByAttribute(d[h],a,b);if(g.length>0){for(var k=0;k<g.length;k++){f[f.length]=g[k]}}}return f},_RefreshHeaderCaptionStyle:function(a){var b=document.getElementById(a.Id+IS.FrameHeaderSuffix);b.cells[0].className=a.HeaderCaptionStyle;b.cells[1].className=b.cells[2].className=a.HeaderOptionButtonStyle.Normal},_RefreshForeColorStyle:function(c,h,a,b){var f=WebMenuBarEngine._GetElementsByAttribute(c.FrameObj,a,b);var d;for(var g=0;g<f.length;g++){d=f[g];d.style.backgroundColor=d.style.color=h.ForeColor}},_RefreshBackColorStyle:function(c,l,a,b){var g=WebMenuBarEngine._GetElementsByAttribute(c.FrameObj,a,b);var f;var j=l.BackColor2!=null&&l.BackColor2!=""&&IS.ie==true;var k;var d=document.getElementById(c.Id+"_f_Horizontal");for(var h=0;h<g.length;h++){f=g[h];if(j==false){f.style.backgroundColor=l.BackColor}else{k=d.contains(f)?"h":"v";WebMenuBarEngine._RefreshGradientBackColorStyle(f,k,l)}}},_RefreshGradientBackColorStyle:function(a,j,k){var h=false;var d;if(j=="h"){d=k.GradientType=="Horizontal"?"1":"0"}else{d=k.GradientType=="Horizontal"?"0":"1"}for(var g=0;g<a.filters.length;g++){if(a.filters[g].GradientType!=undefined){var b=a.filters[g];b.StartColorStr=k.BackColor;b.EndColorStr=k.BackColor2;b.GradientType=d;h=true;break}}if(h==false){var c=";filter: progid:DXImageTransform.Microsoft.gradient(StartColorStr="+k.BackColor+" , EndColorStr="+k.BackColor2+", GradientType="+d+")";a.style.cssText+=c}},_RefreshCommandStyle:function(a){var b;for(var e=0;e<a.Menus.length;e++){b=a.Menus[e];if(b.Type!="Separator"){var c,d;if(b.IsEnabled){c=a.CommandStyle.Normal;d=a.CommandFontStyle.Normal}else{c=a.CommandDisabledStyle;d=a.CommandDisableFontStyle}b._HtmlObj.className=c}else{if(b.Type=="Separator"){b._HtmlObj.className=a.SeparatorStyle}}}},_RefreshStyle:function(a){WebMenuBarEngine._RefreshHeaderCaptionStyle(a);WebMenuBarEngine._RefreshBackColorStyle(a,a.HandleStyle,"handleBgColor","true");WebMenuBarEngine._RefreshForeColorStyle(a,a.HandleStyle,"handleForeColor","true");WebMenuBarEngine._RefreshBackColorStyle(a,a.BodyStyle,"bodyBgColor","true");WebMenuBarEngine._RefreshBackColorStyle(a,a.OptionStyle,"optionBgColor","true");WebMenuBarEngine._RefreshForeColorStyle(a,a.OptionStyle,"optionForeColor","true");WebMenuBarEngine._RefreshCommandStyle(a)},AssignProperties:function(d){if(typeof(IS_ReleaseType)!="undefined"&&IS_ReleaseType=="Beta"){d.ImagesDirectory="/CommonLibraryBeta/Images/WebDesktop/"}d._HtmlObjV=document.getElementById(d.Id+IS.FrameSuffix+"_Vertical");d._HtmlObjV_tbl=document.getElementById(d.Id+BarControlEngine.BarInnerContainerSuffix+"_Vertical");d._HtmlObjH=document.getElementById(d.Id+IS.FrameSuffix+"_Horizontal");d._HtmlObjH_tbl=document.getElementById(d.Id+BarControlEngine.BarInnerContainerSuffix+"_Horizontal");var c=d.XmlDt.documentElement;if(c!=null){IS.SetPropertiesRecursive(d,c)}d.OldDockingArea=d.DockingArea;d.OldDockingRow=d.DockingRow;d.OldIsFloat=d.IsFloat;if(d.DockingArea=="Left"||d.DockingArea=="Right"){d._IsHorizontal=false}var a=d.FrameObj;Listener.Add(a,"onblur",WebMenuBarEngine._OnBlur,d);d.IsFloat1=d.IsFloat;d.IsFloat=a.style.position=="absolute"?"Yes":"No";if(d.Get("FillDockingRow")=="No"&&d.Get("IsFloat1")=="No"){var b=d.FrameObj.offsetParent;d._PlaceHolderMaxDimensionWidth=b.offsetWidth;d._PlaceHolderMaxDimensionHeight=b.offsetHeight}if(d.Get("FillDockingRow")=="Yes"){d.DockingOffset=0}},_OnBlur:function(){WebMenuBarEngine._ActiveWebMenuBar=null},AssignProperties1:function(e){var d=e.XmlDt.documentElement;e.CommandStyle=DynamicStyleEngine.Assign(d.selectSingleNode("CommandStyle"),null);e.CommandFontStyle=DynamicStyleEngine.Assign(d.selectSingleNode("CommandFontStyle"),null);if(e.MenuStyleSettings!=null){var c=ISXml.GetNode(e.XmlDt,"//MenuStyleSettings");if(c!=null){IS.SetPropertiesRecursive(e.MenuStyleSettings,c)}else{e._IsCreateDefaultMenuStyles=true}}var b=ISXml.GetAttribute(d,"ImageSize");if(b!=""&&b!=null){e.ImageSize.Parse(b)}WebMenuBarEngine._AssignCommandsProperties(e);var a=document.getElementById(e.Id+IS.FrameHeaderSuffix).parentNode.parentNode;e.HeaderOptionButtonStyle=DynamicStyleEngine.Assign(d.selectSingleNode("HeaderButtonStyle"),a.rows[0].cells[1]);e.HeaderCloseButtonStyle=DynamicStyleEngine.Assign(d.selectSingleNode("HeaderButtonStyle"),a.rows[0].cells[2]);Listener.Add(a,"onmouseover",WebMenuBarEngine._OnMouseOverHeader,e);Listener.Add(a,"onmouseout",WebMenuBarEngine._OnMouseOutHeader,e);Listener.Add(a,"onmousedown",WebMenuBarEngine._OnMouseDownHeader,e);Listener.Add(a,"onmouseup",WebMenuBarEngine._OnMouseOverHeader,e);Listener.Add(a,"ondblclick",WebMenuBarEngine._OnDblClickHeader,e);WebMenuBarEngine._CreateCommandsContextMenu(e);window.attachEvent("onresize",function(){DoWebMenuBarResize(e)})},_CreateCommandsContextMenu:function(c){var a=c.Menus;for(var b=0;b<a.length;b++){if(a[b].Type=="Normal"){WebMenuBarEngine._CreateCommandContextMenu(a[b])}}},_CreateCommandContextMenu:function(b){if(b.Menu==null){b.Menu=new WebMenu()}b.Menu.UseCssFramework=b._Bar.UseCssFramework;WebMenuBarEngine._MapMenuProperties(b);WebMenuBarEngine._CreateContextMenuItems(b);WebMenuBarEngine._AttachCommandContextMenuOnClick(b,b.Menu.Items);var a=new WebContextMenu(b.Name+"ContextMenu");a.UseCssFramework=b._Bar.UseCssFramework;a.SetOffsetElement(b._HtmlObj);if(b.Menu.OffsetAlignment=="RightTop"){b.Menu.OffsetAlignment="LeftBottom"}b.Menu.Direction="Vertical";b.Menu.MenuControl=b._Bar;b.Menu.ContextMenu=a;a.RootMenu=b.Menu;a.Items=b.Menu.Items;a.MenuStyleSettings=b._Bar.MenuStyleSettings;b.Menu.MenuControl.OnRootMenuClosed="WebMenuBarEngine._RootMenuClosed";a.RefreshStructure();a.IntegratedToBar=true;if(b._Bar._IsCreateDefaultMenuStyles==true&&!b._Bar.UseCssFramework){if(b._Bar.IntegratedTo=="None"||b._Bar.PlaceHolder==""){WebMenuBarEngine._CreateContextMenuTempClasName(b._Bar.Id,a.MenuStyleSettings)}}if((!b._Bar._IsMenuStyleCreated&&b._Bar.IntegratedTo=="None")||(b._Bar.IntegratedTo=="PlaceHolderManager"&&b._Bar.PlaceHolder!=""&&!b._Bar.PlaceHolderManager._IsMenuStyleCreated)){a.CreateDefaultStyles();if(b._Bar.IntegratedTo=="None"||b._Bar.PlaceHolder==""){b._Bar._IsMenuStyleCreated=true}else{if(b._Bar.PlaceHolderManager!=null){b._Bar.PlaceHolderManager._IsMenuStyleCreated=true}}}a._MenuCommand=b;b._ContextMenu=a;b.Menu=a.RootMenu},_RootMenuClosed:function(a){var c=a.ContextMenu._MenuCommand;var b=c._Bar;c.CommandStyle.SetToNormal();if(b.ActiveMenu==a._MenuCommand){b.ActiveMenu=null}a.ContextMenu.JustClosed=true;setTimeout(function(){a.ContextMenu.JustClosed=false},200)},_CreateContextMenuTempClasName:function(b,a){a.FrameStyle=b+"_FrameStyle";a.ItemStyle.Normal=b+"_ItemStyle_Normal";a.ItemStyle.Over=b+"_ItemStyle_Over";a.CheckedItemStyle.Normal=b+"_CheckedItemStyle_Normal";a.CheckedItemStyle.Over=b+"_CheckedItemStyle_Over";a.DisabledItemStyle.Normal=b+"_DisabledItemStyle_Normal";a.DisabledItemStyle.Over=b+"_DisabledItemStyle_Over";a.SeparatorStyle=b+"_SeparatorStyle"},_MapMenuProperties:function(a){var b=a.XmlNode.selectSingleNode("Menu");if(b!=null){IS.SetProperties(a.Menu,b)}},_CreateContextMenuItems:function(a){var b=a.XmlNode.selectSingleNode("Items");if(b!=null){WebMenuBarEngine._CreateMenuItems(a.Menu.Items,b)}},_CreateMenuItems:function(c,b){for(var a=0;a<b.childNodes.length;a++){c.Add(WebMenuBarEngine._CreateMenuItem(b.childNodes[a],c))}},_CreateMenuItem:function(c,d){var b=new WebMenuItem();var a;b.Parent=d.Parent;IS.SetPropertiesRecursive(b,c);return b},_AttachCommandContextMenuOnClick:function(a,d){var c;for(var b=0;b<d.length;b++){c=d[b];a.AttachMenuItem(c);WebMenuBarEngine._AttachCommandContextMenuOnClick(a,c.Items)}},_OnCommandContextMenuClick:function(b){var a=b._MenuCommand;var d=a._Bar;var c=true;a.SelectedMenuItem=b;if(b._OnClick){c=ISEvent.Raise(b._OnClick,b)}if(c){if(d.CommandClientSideEvents!=null){if(d.CommandClientSideEvents.OnClick!=""){c=WebMenuBarEngine._RaiseCommandClientSideEvents(a,"OnClick")}else{if(d.CommandClientSideEvents.OnMouseUp!=""){c=WebMenuBarEngine._RaiseCommandClientSideEvents(a,"OnMouseUp")}}}if(c&&WebMenuBarEngine){WebMenuBarEngine._RaisePostBackCommandClick(a,b)}}a.SelectedMenuItem=null},_RaiseCommandClientSideEvents:function(a,d){var c=a._Bar;var b=c.CommandClientSideEvents[d];if(b==null){return true}return ISEvent.Raise(b,c.Id,a)},_RaisePostBackCommandClick:function(a,b){if(a.Get("AutoPostBack")=="Yes"||(b&&b.AutoPostBack=="Yes")){a.OnPostBackClick()}},_EnableMenu:function(e,a){if(a==null){return}var b;if(a.constructor==Array){for(var d=0;d<a.length;d++){b=e.Menus.GetNamedItem(a[d]);b.SetIsEnabled(true)}}else{b=typeof(a)=="object"?a:e.Menus.GetNamedItem(a);if(b!=null){b.SetIsEnabled(true)}}},_DisableMenu:function(e,a){if(a==null){return}var b;if(a.constructor==Array){for(var d=0;d<a.length;d++){b=e.Menus.GetNamedItem(a[d]);b.SetIsEnabled(false)}}else{b=typeof(a)=="object"?a:e.Menus.GetNamedItem(a);if(b!=null){b.SetIsEnabled(false)}}},_OnDblClickHeader:function(){if(this._PrevDockingArea==""){return}this.DockingArea=this._PrevDockingArea;this.DockingRow=this._PrevDockingRow;this.FrameObj.DragTargetId=this._PrevDragTargetId;this._Dock()},_OnMouseOverHeader:function(){if(window.event==null){return}var c=window.event.srcElement;try{var b=document.getElementById(this.Id+IS.FrameHeaderSuffix).offsetParent;if(!b||!b.rows){b=document.getElementById(this.Id+IS.FrameHeaderSuffix).parentElement.parentElement}if(b.rows[0].cells[1].contains(c)){this.HeaderOptionButtonStyle.SetToOver()}else{if(b.rows[0].cells[2].contains(c)){this.HeaderCloseButtonStyle.SetToOver()}}}catch(a){}},_OnMouseOutHeader:function(){if(window.event==null){return}var c=window.event.srcElement;try{var b=document.getElementById(this.Id+IS.FrameHeaderSuffix).offsetParent;if(!b||!b.rows){b=document.getElementById(this.Id+IS.FrameHeaderSuffix).parentElement.parentElement}if(b.rows[0].cells[1].contains(c)){this.HeaderOptionButtonStyle.SetToNormal()}else{if(b.rows[0].cells[2].contains(c)){this.HeaderCloseButtonStyle.SetToNormal()}}}catch(a){}},_OnMouseDownHeader:function(){if(window.event==null){return}var b=window.event.srcElement;var a=document.getElementById(this.Id+IS.FrameHeaderSuffix).offsetParent;if(a.rows[0].cells[1].contains(b)){this.HeaderOptionButtonStyle.SetToActive()}else{if(a.rows[0].cells[2].contains(b)){this.HeaderCloseButtonStyle.SetToActive()}}},AssignPropertiesToXml:function(g){if(g.IsRuntimeBar==true&&g._ReBinding==true){return}var f=g.XmlDt.documentElement;if(f!=null){g.Style1=g.FrameObj.style.cssText;g.NewDockingArea=g.DockingArea;g.NewDockingRow=g.DockingRow;g.NewIsFloat=g.IsFloat;g.DockingArea=g.OldDockingArea;g.DockingRow=g.OldDockingRow;g.IsFloat=g.OldIsFloat;IS.SetPropertiesToXml(g,f);if(g.IsRuntimeBar==true){var d=g.XmlDt.documentElement.attributes.getNamedItem("Id");if(d==null){d=g.XmlDt.createAttribute("Id");d.text=g.Id;g.XmlDt.documentElement.attributes.setNamedItem(d)}}if(g.XmlDt.documentElement.attributes.getNamedItem("ImageSize")!=null&&!g.ImageSize.IsEmpty()){g.XmlDt.documentElement.attributes.getNamedItem("ImageSize").value=parseFloat(g.ImageSize.Width)+", "+parseFloat(g.ImageSize.Height)}var b=ISXml.GetNode(g.XmlDt,"//Menus");if(g.Get("AllowCustomize")=="No"){if(b!=null){g.XmlDt.documentElement.removeChild(b)}}else{var a=g.Menus;for(var c=0;c<a.length;c++){IS.SetPropertiesToXml(a[c],a[c].XmlNode);var e=a[c].XmlNode;if(e.attributes.getNamedItem("ImageSize")!=null&&!a[c].ImageSize.IsEmpty()){e.attributes.getNamedItem("ImageSize").value=parseFloat(a[c].ImageSize.Width)+", "+parseFloat(a[c].ImageSize.Height)}}}ISBarCommon.RemoveStyleNodes(g.XmlDt.firstChild)}},RegisterBehaviour:function(c){var e=c.PlaceHolder;if(e!=null&&e!=""){var d=c.PlaceHolderManager==null?ISGetObject(e):c.PlaceHolderManager;if(d==null){InitPlaceHolderManager(e)}d=ISGetObject(e);if(d!=null&&c.Get("HandleVisible")=="Yes"){var a="";if(c.Get("AllowDockTop")=="Yes"){for(var b=d.MaxDockingRows-1;b>-1;b--){a+=d.Id+PlaceHolderManagerEngine.PlaceHolderManagerTopDockingAreaSuffix+PlaceHolderManagerEngine.PlaceHolderManagerTableDockingAreaSuffix+"_"+b+";"}}if(c.Get("AllowDockRight")=="Yes"){for(var b=d.MaxDockingRows-1;b>-1;b--){a+=d.Id+PlaceHolderManagerEngine.PlaceHolderManagerRightDockingAreaSuffix+PlaceHolderManagerEngine.PlaceHolderManagerTableDockingAreaSuffix+"_"+b+";"}}if(c.Get("AllowDockBottom")=="Yes"){for(var b=d.MaxDockingRows-1;b>-1;b--){a+=d.Id+PlaceHolderManagerEngine.PlaceHolderManagerBottomDockingAreaSuffix+PlaceHolderManagerEngine.PlaceHolderManagerTableDockingAreaSuffix+"_"+b+";"}}if(c.Get("AllowDockLeft")=="Yes"){for(var b=d.MaxDockingRows-1;b>-1;b--){a+=d.Id+PlaceHolderManagerEngine.PlaceHolderManagerLeftDockingAreaSuffix+PlaceHolderManagerEngine.PlaceHolderManagerTableDockingAreaSuffix+"_"+b+";"}}if(a.length>0){a=a.substr(0,a.length-1)}if(c.Get("AllowMove")=="Yes"){if(c.Get("HandleVisible")=="Yes"){ISDrag.Register(c.Id+IS.FrameSuffix,c.Id+BarControlEngine.BarHandleSuffix+"_Vertical;"+c.Id+BarControlEngine.BarHandleSuffix+"_Horizontal",WebMenuBarEngine._OnDragStart,WebMenuBarEngine._OnDrag,WebMenuBarEngine._OnDragEnd,a)}ISDrag.Register(c.Id+IS.FrameSuffix,c.Id+IS.FrameHeaderSuffix,WebMenuBarEngine._OnDragStart,WebMenuBarEngine._OnDrag,WebMenuBarEngine._OnDragEnd,a)}}}},_UpdateCommandTextAndImage:function(a){if(a._Text!=a.Text){a._Text=a.Text}if(a._Image!=a.Image){a._Image=a.Image}var c=a.Get("Type");if(c=="Normal"){switch(a.Get("DisplayMode")){case"Text":var b=a._HtmlObj.children[0];b.innerHTML=WebMenuBarEngine._GetCommandText(a);break;case"Image":var b=a._HtmlObj;b.innerHTML=WebMenuBarEngine._GetCommandImage(a);break;case"TextAndImage":var b=a._HtmlObj;b.innerHTML=WebMenuBarEngine._GetCommandTextAndImage(a);break}}},_GetCommandText:function(a){var c="&nbsp;";if(a.AccessKey==null||a.AccessKey==""){c+=a.Text}else{var b=a.Text.toLowerCase().indexOf(a.AccessKey.toLowerCase());if(b>-1){c+=a.Text.substr(0,b);c+="<u>";c+=a.Text.substr(b,1);c+="</u>";c+=a.Text.substr(b+1)}else{c+=a.Text}}return c},_GetCommandImage:function(a,b){var c=a.Get("ImageSize");var d="<img align='absmiddle' style='overflow:hidden;width:";d+=c.Width;d+=";height:";d+=c.Height;if(b!=null){d+=b+";"}d+="' src='";d+=a.Image;d+="'/>";return d},_GetCommandTextAndImage:function(a){var c="";if(a._Bar.GetOrientation()=="Horizontal"){switch(a.Get("TextAlign")){case"Left":c+=WebMenuBarEngine._GetCommandText(a);c+="&nbsp;";c+=WebMenuBarEngine._GetCommandImage(a);break;case"Right":c+=WebMenuBarEngine._GetCommandImage(a);c+="&nbsp;";c+=WebMenuBarEngine._GetCommandText(a);break;case"Above":c+=WebMenuBarEngine._GetCommandText(a);c+=WebMenuBarEngine._GetCommandImage(a,";display:block");break;case"Underneath":c+=WebMenuBarEngine._GetCommandImage(a,";display:block");c+=WebMenuBarEngine._GetCommandText(a);break}}else{var b="";switch(a.Get("TextAlign")){case"Left":c+=WebMenuBarEngine._GetCommandText(a);c+=WebMenuBarEngine._GetCommandImage(a);break;case"Right":c+=WebMenuBarEngine._GetCommandImage(a);c+=WebMenuBarEngine._GetCommandText(a);break;case"Above":b=a._Bar.UseCssFramework?"":" style='writing-mode:tb-rl'";c+="<div nowrap"+b+">";c+=WebMenuBarEngine._GetCommandText(a);c+=WebMenuBarEngine._GetCommandImage(a,";display:block");c+="</div>";break;case"Underneath":b=a._Bar.UseCssFramework?"":" style='writing-mode:tb-rl'";c+="<div nowrap"+b+">";c+=WebMenuBarEngine._GetCommandImage(a,";display:block");c+=WebMenuBarEngine._GetCommandText(a);c+="</div>";break}}return c},_GetToolBarChildIdx:function(b){var d=-1;var a=b.offsetParent;for(var c=0;c<a.children.length;c++){if(a.children[c]==b){d=c;break}}return d},_OnDragStart:function(a){if(isNaN(parseFloat(a.style.left))){a.style.left=ISPosLib.getLeft(a)+"px"}if(isNaN(parseFloat(a.style.top))){a.style.top=ISPosLib.getTop(a)+"px"}if(a.dragAreaId.indexOf(BarControlEngine.BarHandleSuffix)>-1){a.IsDrop=a.style.position==""||a.style.position=="static"}else{a.IsDrop=false}var b=ISGetObject(a.id.replace(IS.FrameSuffix,""));if(b!=null){b.PlaceHolderManager.IsDraggingChild=true}},_OnDrag:function(c,a,b){if(!c.IsInDragArea){if(c.IsDrop){var f=ISGetObject(c.id.replace(IS.FrameSuffix,""));var d=false;if(f){f._ChildIdx=WebMenuBarEngine._GetToolBarChildIdx(c);f._OffsetParent=c.offsetParent;d=f._UnDock()}if(d){c.IsReCalculateDragArea=true;c.style.left=c.DragX+"px";c.style.top=c.DragY+"px";c.DragWidth=ISPosLib.getWidth(c);c.DragHeight=ISPosLib.getHeight(c);c.IsDrop=false}else{c.style.left=parseFloat(c.style.left)+a+"px";c.style.top=parseFloat(c.style.top)+b+"px"}}else{c.style.left=parseFloat(c.style.left)+a+"px";c.style.top=parseFloat(c.style.top)+b+"px"}}else{var f=ISGetObject(c.id.replace(IS.FrameSuffix,""));if(c.IsDrop==false){if(f._Dock()==true){f._ChildIdx=WebMenuBarEngine._GetToolBarChildIdx(c);c.IsReCalculateDragArea=true;c.IsDrop=true;c.dropAreaId=c.dragAreaId;c.DragWidth=ISPosLib.getWidth(c);c.DragHeight=ISPosLib.getHeight(c)}else{if(isNaN(parseFloat(c.style.left))){c.style.left=ISPosLib.getLeft(c)}if(isNaN(parseFloat(c.style.top))){c.style.top=ISPosLib.getTop(c)}c.style.left=parseFloat(c.style.left)+a+"px";c.style.top=parseFloat(c.style.top)+b+"px"}}else{if(f._CheckingDockingArea()){f._ChildIdx=WebMenuBarEngine._GetToolBarChildIdx(c)}}}},_OnDragEnd:function(a){var b=ISGetObject(a.id.replace(IS.FrameSuffix,""));if(b){if(a.IsInDragArea){b._ChildIdx=WebMenuBarEngine._GetToolBarChildIdx(a);a.IsDrop=true}else{if(!b.Get("AllowFloat")=="Yes"){PlaceHolderManagerEngine.InsertBackBarFromDragOperation(b,a);b._SetToStaticDisplay();a.IsDrop=true}}b.PlaceHolderManager.IsDraggingChild=false}},_SetItemToVerticalDisplay:function(a){if(a.Type=="Normal"){switch(a.Get("DisplayMode")){case"Text":if(!a._Bar.UseCssFramework){a._HtmlObj.children[0].style.writingMode="tb-rl"}break;case"TextAndImage":WebMenuBarEngine._SetTextAndImageItemToVerticalDisplay(a);break}}else{if(a.Type=="Custom"&&a.Visible==true){a._HtmlObj.style.display="none"}}if(a._Bar.Get("SizeMode")=="Fixed"){var b=a._HtmlObj;b.style.width="";b.style.height=a.Get("CommandSize")}},_SetTextAndImageItemToVerticalDisplay:function(a){var c=a._HtmlObj;if(a.Get("TextAlign")=="Left"||a.Get("TextAlign")=="Right"){var b=document.createElement("DIV");if(!a._Bar.UseCssFramework){b.style.cssText="writing-mode:tb-rl"}var d=c.children[0];document.body.appendChild(d);b.innerHTML=c.innerHTML;c.innerHTML="";c.appendChild(b);if(a.Get("TextAlign")=="Left"){b.insertAdjacentElement("afterEnd",d)}else{b.insertAdjacentElement("beforeBegin",d)}}else{var d=c.children[0];d.style.display="inline"}},_CheckVerticalDisplayRows:function(c,b){if(c.rows.length<b){for(var a=c.rows.length;a<b;a++){c.insertRow(0)}}else{if(c.rows.length>b){for(var a=b;a<c.rows.length;a++){c.deleteRow(b)}}}},_SetItemToHorizontalDisplay:function(a){if(a.Type=="Normal"){switch(a.Get("DisplayMode")){case"Text":if(!a._Bar.UseCssFramework){a._HtmlObj.children[0].style.writingMode="lr-tb"}break;case"TextAndImage":WebMenuBarEngine._SetTextAndImageItemToHorizontalDisplay(a);break}}else{if(a.Type=="Custom"&&a.Visible==true){a._HtmlObj.style.display=""}}if(a._Bar.Get("SizeMode")=="Fixed"){var b=a._HtmlObj;b.style.height="";b.style.width=a.Get("CommandSize")}},_SetTextAndImageItemToHorizontalDisplay:function(a){var b=a._HtmlObj;var d;var c;switch(a.Get("TextAlign")){case"Left":d=b.children[0].innerHTML;c=b.children[1];document.body.appendChild(c);b.innerHTML=d;b.insertAdjacentElement("beforeEnd",c);break;case"Right":d=b.children[1].innerHTML;c=b.children[0];document.body.appendChild(c);b.innerHTML=d;b.insertAdjacentElement("afterBegin",c);break;case"Above":case"Underneath":b.children[0].style.display="block";break}},_GetOptionDropDownPaddingTopOnHorizontalDisplay:function(b){var a=ISPosLib.getHeight(b.FrameObj)-(b.Get("BarStyle")=="OfficeXP"||b.Get("BarStyle")=="IE"?2:0);return((a-16)+"px")},_AssignCommandsProperties:function(e){var a,c;var d=e.XmlDt.selectSingleNode("//CommandStyle");for(var b=0;b<e.Menus.length;b++){a=e.Menus[b];WebMenuBarEngine._AssignPerCommandHTMLObj(b,a,e);a._Visible=a.Visible;a._PrevVisible=a.Visible;BarControlEngine._AssignCommandStyle(a,e,d);e._AssignCommandListener(a);a._Collection=e.Menus;c=ISXml.GetAttribute(a.XmlNode,"ImageSize");if(c!=""&&c!=null){a.ImageSize.Parse(c)}}},_AssignCommandHTMLObj:function(d){var a,c;for(var b=0;b<d.Menus.length;b++){WebMenuBarEngine._AssignPerCommandHTMLObj(b,d.Menus[b],d)}},_AssignPerCommandHTMLObj:function(b,a,c){a.Index=b;a._Image=a.Image;a._Text=a.Text;a._Bar=c;a._HtmlObj=document.getElementById(c.Id+"_"+a.Name+BarControlEngine.BarItemSuffix);a._PrevBarId=a._OriBarId=c.Id},_AssignCommandListener:function(a){var b=a._HtmlObj;Listener.Add(b,"onclick",WebMenuBarEngine._OnClickCommand,a);Listener.Add(b,"ondblclick",WebMenuBarEngine._OnDblClickCommand,a);Listener.Add(b,"onmousedown",WebMenuBarEngine._OnMouseDownCommand,a);Listener.Add(b,"onmousemove",WebMenuBarEngine._OnMouseMoveCommand,a);Listener.Add(b,"onmouseout",WebMenuBarEngine._OnMouseOutCommand,a);Listener.Add(b,"onmouseover",WebMenuBarEngine._OnMouseOverCommand,a);Listener.Add(b,"onmouseup",WebMenuBarEngine._OnMouseUpCommand,a);Listener.Add(b,"onselectstart",WebMenuBarEngine._OnSelectStart,a);Listener.Add(b,"onkeydown",WebMenuBarEngine._OnKeyDownCommand,a)},_OnActivateCommand:function(){var a=event;if(this.Type=="Custom"){return}if(a&&a.altKey){var b=a.fromElement;this.OnClick();if(b){b.focus()}else{this._HtmlObj.blur()}}},_OnSelectStart:function(){if(this.Type!="Custom"){event.returnValue=false}},_OnKeyDownCommand:function(){var a=event;var b=false;if(this.Type=="Custom"){return}if(a.keyCode==ISKeyboardKey.ENTER||a.keyCode==ISKeyboardKey.SPACE||a.keyCode==ISKeyboardKey.DOWN){this.OnClick();b=true}if(b){a.cancelBubble=true;a.returnValue=false}},_OnClickCommand:function(){if(!this.IsEnabled){return}WebMenuBarEngine._RaiseCommandClientSideEvents(this,"OnClick")},_OnDblClickCommand:function(){if(!this.IsEnabled){return}WebMenuBarEngine._RaiseCommandClientSideEvents(this,"OnDblClick")},_OnMouseDownCommand:function(){var a=this._Bar.PlaceHolderManager;if(a!=null&&a.IsDraggingChild){return}if(!this.IsEnabled){return}if(this._HtmlObj.contains(window.event.srcElement)){if(this.Type=="Normal"){this.CommandStyle.SetToActive();this._Bar.ActiveMenu=this}WebMenuBarEngine._RaiseCommandClientSideEvents(this,"OnMouseDown")}WebMenuBarEngine._ActiveWebMenuBar=this._Bar},_OnMouseMoveCommand:function(){if(!this.IsEnabled){return}WebMenuBarEngine._RaiseCommandClientSideEvents(this,"OnMouseMove")},_OnMouseOverCommand:function(){var a=this._Bar.PlaceHolderManager;if(a!=null&&a.IsDraggingChild){return}if(!this.IsEnabled){return}if(this._HtmlObj.contains(window.event.srcElement)){if(this.Type=="Normal"){this.CommandStyle.SetToOver()}if(WebMenuBarEngine._CheckContextMenusOpened(this._Bar)&&this.IsValidCommandType()){WebMenuBarEngine._ShowContextMenu(this);this.CommandStyle.SetToActive()}WebMenuBarEngine._RaiseCommandClientSideEvents(this,"OnMouseOver")}},_QueueShowContextMenu:function(a){var b=a._Bar;if(b._ShowQueueId){clearTimeout(b._ShowQueueId)}b._ShowQueueId=setTimeout(function(){WebMenuBarEngine._ShowContextMenu(a)},250)},_OnMouseOutCommand:function(){var a=this._Bar.PlaceHolderManager;if(a!=null&&a.IsDraggingChild){return}if(!this.IsEnabled){return}if(!this._HtmlObj.contains(window.event.toElement)){if(this.Type=="Normal"){if(this._ContextMenu!=null){if(this._ContextMenu.RootMenu.IsOpen()){return}}this.CommandStyle.SetToNormal()}if(!this.IsEnabled){return}WebMenuBarEngine._RaiseCommandClientSideEvents(this,"OnMouseOut")}WebMenuBarEngine._ActiveWebMenuBar=this._Bar},_OnMouseUpCommand:function(){var b=this._Bar.PlaceHolderManager;if(b!=null&&b.IsDraggingChild){return}if(!this.IsEnabled){return}if(this._HtmlObj.contains(window.event.srcElement)){if(this.Type=="Normal"){if(this.Menu&&this.Menu.Items.length>0){this.CommandStyle.SetToActive()}else{this.CommandStyle.SetToOver()}}if(this.IsValidCommandType()){var a=this;setTimeout(function(){if(a._ContextMenu&&!a._ContextMenu.JustClosed){WebMenuBarEngine._ShowContextMenu(a)}else{a.CommandStyle.SetToOver()}},150)}if(WebMenuBarEngine._RaiseCommandClientSideEvents(this,"OnMouseUp")==true){WebMenuBarEngine._RaiseTargetCommandClick(this);WebMenuBarEngine._RaisePostBackCommandClick(this)}}},_RaiseTargetCommandClick:function(a){if(a.TargetURL!=null&&a.TargetURL!=""){if(a.TargetFrame==""){document.location.href=a.TargetURL}else{var b=a.TargetFrame;if(b=="Blank"||b=="Parent"||b=="Search"||b=="Self"||b=="Top"||b=="UseBase"){b="_"+b.toLowerCase()}window.open(a.TargetURL,b)}return true}else{return false}},_ShowContextMenu:function(a){WebMenuBarEngine._HideAllContextMenuButton(a._Bar,a);if(a._ContextMenu!=null){var b=a._ContextMenu.RootMenu;if(b.Items.length<=0){return}a._ContextMenu.SetOffsetElement(a._HtmlObj);b.MenuControl.CopyMenuSetting(a._ContextMenu);b.Show()}},_CheckContextMenusOpened:function(d){var b=false;var c;for(var a=0;a<d.Menus.length;a++){c=d.Menus[a];if(c._ContextMenu!=null){if(c._ContextMenu.RootMenu.IsOpen()){b=true;break}}}return b},_ShowCustomizeWindowFromMoreItems:function(a){if(typeof(CustomizeWindowBAR)!="undefined"){var b=a._Bar.PlaceHolderManager;if(b!=null){b.ShowCustomizeWindow()}}},_CreateAddRemoveOptionMenuItems:function(f){var c=WebMenuBarEngine._CreateAddRemoveOptionMenuItemsRoot(f);if(c==null){return}var a=f._OptionContextMenu;var b,e;for(var d=0;d<f.Menus.length;d++){b=f.Menus[d];if(b.Type=="Normal"){e=new WebMenuItem(b.Name,"<img src='"+b.Image+"'>&nbsp;"+b.Text,null,"WebMenuBarEngine._MoreItemOnClick");e._MenuCommand=b;e.Tooltip=b.ToolTip;e.Type="CheckBox";e.KeepMenuVisible=true;e.Checked=b.Visible;c.Items.Add(e)}}},_HideAllContextMenuButton:function(e,c){var b=null;var a;for(var d=0;d<e.Menus.length;d++){b=e.Menus[d];if(b!=c){a=b._ContextMenu;if(a!=null){b.CommandStyle.SetToNormal();a.HideAll()}}}},_CreateAddRemoveOptionMenuItemsRoot:function(k){var a=k._OptionContextMenu;var j=a.RootMenu;var d=false;if(k.Get("AddRemoveOptionMenuViewMode")=="IconView"){j.IconViewMode=true;j.Width=150}var b,c;if(k.Get("AllowExpandCollapse")=="Yes"){for(var e=0;e<k.Menus.length;e++){b=k.Menus[e];if(b._UIVisible==false&&b.IsEnabled&&b.Visible==true){c=j.Items.Add(new WebMenuItem(b.Name,b.Text,b.Image));c.Tooltip=b.ToolTip;d=true}}}if(k.Get("AllowCustomize")=="Yes"){if(d){j.Items.Add(new WebMenuSeparatorItem())}var f=new WebMenuItem("rAddRemoveButtons","Add or Remove Buttons");j.Items.Add(f);f.IconViewMode=false;f.IconViewDisplayMode="Text";var g=new WebMenuItem("r"+k.Id,k.Caption);f.Items.Add(g);var h=new WebMenuItem("rCustomize","Customize ...","","WebMenuBarEngine._ShowCustomizeWindowFromMoreItems");h._Bar=k;if(typeof(CustomizeWindowBAR)!="undefined"){h.Enabled=k.Get("AllowCustomize")=="Yes"}else{h.Enabled=false}f.Items.Add(h)}return g},_MoreItemOnClick:function(a){a._MenuCommand.SetVisible(a.Checked)},ShowOptionWindow:function(c){var e=ISGetObject(c);if(typeof(CustomizeWindowBAR)!="undefined"){var b=PlaceHolderManagerEngine.GetCustomizeWindow();b.Hide()}e.CheckCommandsVisibility();var a=e._OptionContextMenu;if(e._IsReCalculateOptionMenu==true||a==null){a=new WebContextMenu(e.Id+"MoreItems");a.RootMenu=new WebMenu();a.RootMenu.MenuControl=a;a.UseCssFramework=e.UseCssFramework;a.RootMenu.UseCssFramework=e.UseCssFramework;e._OptionContextMenu=a;WebMenuBarEngine._CreateAddRemoveOptionMenuItems(e);a.MenuStyleSettings=e.MenuStyleSettings;if(e._IsCreateDefaultMenuStyles==true){if(!e.UseCssFramework&&e.IntegratedTo=="None"){WebMenuBarEngine._CreateContextMenuTempClasName(e.Id,a.MenuStyleSettings)}a.CreateDefaultStyles()}e._IsReCalculateOptionMenu=false}var d;if(e.Get("IsFloat")=="No"){d=document.getElementById(e.Id+BarControlEngine.BarOptionSuffix+"_"+e.GetOrientation());a.RootMenu.Direction="Vertical";if(e.GetOrientation()=="Horizontal"){a.RootMenu.OffsetAlignment="LeftBottom"}else{a.RootMenu.OffsetAlignment="RightTop"}}else{d=document.getElementById(e.Id+IS.FrameHeaderSuffix).offsetParent.rows[0].cells[1];a.RootMenu.Direction="Vertical";a.RootMenu.OffsetAlignment="LeftBottom"}a.SetOffsetElement(d);if(a.RootMenu.Items.length>0){a.RootMenu.Show()}},_CalculateAvailableMaxDimensionToDock:function(h,g){var a=0;var e=g=="h"?h.offsetWidth:h.offsetHeight;var c,f;for(var b=0;b<h.children.length;b++){c=h.children[b];if(c.id.indexOf(IS.FrameSuffix)>-1){f=ISGetObject(c.id.replace(IS.FrameSuffix,""));if(f!=null){if(f.ClassName=="WebMenuBar"){a+=g=="h"?f.FrameObj.offsetWidth:f.FrameObj.offsetHeight}}}}return(e-a)},_ShowMenu:function(c,a,d){c._UIState="ShowMenu";var b;if(typeof(a)=="object"){b=a}else{b=c.Menus[a]}b.Visible=b._PrevVisible=b._Visible=true;b._UIState="Show";c.UpdateUI(d);return true},_HideMenu:function(c,a,d){var b;if(typeof(a)=="object"){b=a}else{b=c.Menus[a]}c._UIState="HideMenu";b.Visible=b._PrevVisible=b._Visible=false;b._UIState="Hide";c.UpdateUI(d);return true},_AddMenu:function(c,a,b){if(typeof(b)=="number"){c.Menus.InsertAt(a,b)}else{c.Menus.Add(a)}},_RemoveMenu:function(c,a){var b;if(typeof(a)=="object"){b=a}else{b=c.Menus[a]}c.Menus.Remove(b,false)},CreateNewToolBar:function(b,a){WebMenuBarFactoryEngine.CreateNewToolBar(b,a)},_OnMenuKeyDown:function(d,b,a){if(a.IconViewMode){return}var c=null;switch(b){case ISKeyboardKey.LEFT:c=a._MenuCommand.GetPreviousNormalMenu();break;case ISKeyboardKey.RIGHT:c=a._MenuCommand.GetNextNormalMenu();break}if(c){c.OnClick();if(c._ContextMenu&&c._ContextMenu.RootMenu.Items.length>0){c._ContextMenu.RootMenu.Items[0].Select()}}},_ActiveMenuBarOnKeyDown:function(){var d=window.event.keyCode;var c=window.event.altKey;var a=WebMenuBarEngine._ActiveWebMenuBar;if(a!=null){if(WebMenuBarEngine._ActiveWebMenuBar.FrameObj.contains(window.event.srcElement)==false){return}var e=a.GetOrientation();var b=false;switch(d){case ISKeyboardKey.LEFT:if(e=="Horizontal"){a.SelectPrevMenu()}b=true;break;case ISKeyboardKey.RIGHT:if(e=="Horizontal"){a.SelectNextMenu()}b=true;break;case ISKeyboardKey.TOP:if(e=="Vertical"){a.SelectPrevMenu()}b=true;break;case ISKeyboardKey.BOTTOM:if(e=="Vertical"){a.SelectNextMenu()}b=true;break;case ISKeyboardKey.ENTER:if(a.ActiveMenu!=null){a.ActiveMenu.OnClick()}b=true;break}if(b){if(IS.ie){event.keyCode=0}event.cancelBubble=true;event.returnValue=false}}},_SelectMenu:function(c,b){var a=false;if(c.Menus.IndexOf(b)>-1){if(b.Type=="Normal"||b.Type=="Custom"){b.Select();a=true}}return a},_SelectPrevMenu:function(b){var c=b.Menus;if(c.length<=0){return}var a=-1;if(b.ActiveMenu!=null){a=c.IndexOf(b.ActiveMenu)-1;if(a<0){a=c.length-1}}else{a=0}b.ActiveMenu=c[a];b.ActiveMenu.Select()},_SelectNextMenu:function(b){var c=b.Menus;if(c.length<=0){return}var a=-1;if(b.ActiveMenu!=null){a=c.IndexOf(b.ActiveMenu)+1;if(a>=c.length){a=0}}else{a=c.length-1}b.ActiveMenu=c[a];b.ActiveMenu.Select()}};function HideFloatingMenuBar(a){var b=ISGetObject(a);b.Hide()}function ActiveMenuBarOnKeyDown(){WebMenuBarEngine._ActiveMenuBarOnKeyDown()}function WebMenuBarOnLoad(){WebMenuBarEngine.IsWindowLoaded=true;document.body.attachEvent("onkeydown",ActiveMenuBarOnKeyDown)}function WebMenuBarOnUnLoad(){document.body.detachEvent("onkeydown",ActiveMenuBarOnKeyDown);window.detachEvent("onload",WebMenuBarOnLoad);window.detachEvent("onbeforeunload",WebMenuBarOnBeforeUnLoad);window.detachEvent("onunload",WebMenuBarOnUnLoad);IS.RegisterUnloadVariables("pWMB");IS.RegisterUnloadVariables("pMnCmd");IS.RegisterUnloadVariables("MenuCommandEngine");IS.RegisterUnloadVariables("WebMenuBarEngine");IS.RegisterUnloadVariables("CommandEngine");IS.RegisterUnloadVariables("ISBarCommon");IS.RegisterUnloadVariables("ISDrag");IS.RegisterUnloadVariables("BarControlEngine")}function DoWebMenuBarResize(a){a=ISGetObject(a.Id);a._IsReCalculateOptionMenu=true;a.CheckCommandsVisibility()}function WebMenuBarOnBeforeUnLoad(){var a;for(var b=0;b<IS.RuntimeObjects.length;b++){a=IS.RuntimeObjects[b];if(a==null){continue}if(a.GetType()=="WebMenuBar"){if(a.Menus.length>0){if(a.Menus[0]._HtmlObj!=null){var e=IS.IsHTML5DocType()?a.Menus[0]._HtmlObj.parentElement.parentElement.parentElement:a.Menus[0]._HtmlObj.offsetParent;if(e==null){continue}for(var c=0;c<e.rows.length;c++){for(var d=0;d<e.rows[c].cells.length;d++){e.rows[c].cells[d].style.display=""}}}}}}}window.attachEvent("onload",WebMenuBarOnLoad);window.attachEvent("onbeforeunload",WebMenuBarOnBeforeUnLoad);window.attachEvent("onunload",WebMenuBarOnUnLoad);