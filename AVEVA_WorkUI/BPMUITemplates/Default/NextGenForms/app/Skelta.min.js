/*!
 *	jQuery dotdotdot 1.7.4
 *
 *	Copyright (c) Fred Heusschen
 *	www.frebsite.nl
 *
 *	Plugin website:
 *	dotdotdot.frebsite.nl
 *
 *	Licensed under the MIT license.
 *	http://en.wikipedia.org/wiki/MIT_License
 */
function ClearMappings(n){document.getElementById(n).value!=""&&se.ui.messageDialog.showConfirmation(skelta.localize.getString("FormNGFClear_Mappings_Title"),skelta.localize.getString("FormNGFClear_Mappings_Message"),function(t){if(t&&(document.getElementById(n).value="",window.parent.frames.editframe!=undefined||window.parent.frames.editframe!=null)){var r=window.parent.frames.editframe.viewModelObject?window.parent.frames.editframe.viewModelObject:window.parent.frames.editframe.contentWindow.viewModelObject,i=r.topLevelForm.findByXmlNode("MappingsSchema");i.value="";skelta.forms.utilities.initializeMappingSchemaWithWorkflowDetails(i)}})}function createFrame(n,t){var i,r;if(t=="ReportViewer")parent.document.getElementById("reportViewerFrame").src=n,parent.document.getElementById("reportViewerFrame").attributes["data-sksw"].value=1;else if(t=="FormSchema")parent.document.getElementById("fschemaframe").src=n,parent.document.getElementById("fschemaframe").attributes["data-skfsw"].value=1;else if(t=="XMLVariableConfig")parent.document.getElementById("propertyLookupFrame").src=n,parent.document.getElementById("propertyLookupFrame").attributes["data-skfsw"].value=1;else if(t=="MappingsSchema")$(parent.document).find("#mapingFrameDiv")!=undefined&&$(parent.document).find("#mapingFrameDiv")!=null&&(i=$(parent.document).find("#mapingFrameDiv"),r=i.find(".skpopup_maindivPopupForm").find("iframe"),r.attr("src","../Repository/Site/"+n),i.show());else if(t=="LookupSource")parent.document.getElementById("propertyLookupFrame").src=n,parent.document.getElementById("propertyLookupFrame").attributes["data-skfsw"].value=1;else{var f=screen.width-screen.width/100*40,u=screen.height-screen.height/100*40,e=screen.width/2-(screen.width-screen.width/100*40)/2,o=screen.height/2-u/2;(t===null||t===undefined)&&(t="default");window.open(n,t,"directories=no,titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no,height="+u+",width="+f+", , top="+o+", left="+e+"")}}function GetFormSchema(){}function sf_onFocus(){}function InputParameterObject(){this.InstanceXml;this.InstanceJSON}function buttonClickEventArgs(){this.event;this.message;this.buttonText;this.data}function submitClickEvent(n,t){if(this.type=n,!this.type)throw"Must specify a SubmitClickEvent type";this.fn=[];typeof t=="function"&&(this.fn[0]=t)}function expandOrCollapseBaseForm(n){var t=n.parentNode.parentNode,i=$(t).find(">."+cssClasses.controlsWrapper);t.getAttribute(dataAttributes.isBaseFormCollapsed)==="0"?(t.setAttribute(dataAttributes.isBaseFormCollapsed,"1"),$(i).hide(100)):(t.setAttribute(dataAttributes.isBaseFormCollapsed,"0"),$(i).show(100))}function ValidationOptions(n,t){var i=this;i.isValid=n;i.message=t}function popupObject(n,t){var i=this;i.templateDivObj=null;i.templateName=n;i.templateObject=t;i.templateControlName=ko.observable("");i.selectedValue="";i.data=ko.observable("");i.eventType=ko.observable("");i.state=ko.observable("close");i.subscriberFn=null;i.controlSender=null;i.close=i.state.subscribe(function(n){var t=function(n){n.templateDivObj.empty();n.templateDivObj.attr("class","");n.templateDivObj.attr("style","");n.templateDivObj.attr("data-bind","");n.templateControlName()==="ReportViewer"&&n.templateDivObj.attr("text","");n.subscriberFn=null;n.templateControlName("");n.eventType("")};n=="close"&&(SFU.isUndefined(i.subscriberFn)||i.subscriberFn(i),ko.cleanNode(i.templateDivObj[0]),skelta.forms.utilities.resetIframeControls(i.templateDivObj,function(){t(i)}))})}function ajaxFailed(){skeltaUtils.showError(document.title,skelta.localize.getString("FormNGFULRLAjaxFail"));logger.logError(skelta.localize.getString("FormNGFULRLAjaxFail"))}function loadUserLookupViewModel(n){var t=new UserLookupViewModel(n),i=skeltaUtils.createJsonRequestHelper({appName:skelta.userContext.getUserContextFor("appN")});return skeltaUtils.callServerMethod("POST",skelta.forms.utilities.getServerUrl("UserLookup.aspx/GetProviderList"),"application/json; charset=utf-8",i,"json",t.loadProviders,ajaxFailed,null),t}function loadResources(n,t){var i=skeltaUtils.createJsonRequestHelper({providerName:t});skeltaUtils.callServerMethod("POST",skelta.forms.utilities.getServerUrl("UserLookup.aspx/GetPropertiesList"),"application/json; charset=utf-8",i,"json",n,ajaxFailed,null)}function search(n,t){try{var r=t.selectedresourceProperties(),u=skeltaUtils.createJsonRequestHelper({searchText:n,providerName:t.selectedProvider(),resourceProperties:r}),i=skeltaUtils.requestPromise("POST",skelta.forms.utilities.getServerUrl("UserLookup.aspx/SearchUsers"),"application/json; charset=utf-8",u,"json",!0,skelta.userContext.getUserContextFor("lookupTimeout"));i.done(function(n){t.loadAvailableResources(n)});i.fail(function(n,i,r){t.ajaxFailed1(n,i,r)})}catch(f){self.showLoader(!1);skeltaUtils.showError(document.title,skelta.localize.getString("FormNGFULRLAjaxFail"));logger.logError(skelta.localize.getString("FormNGFULRLAjaxFail"))}}function UserLookupViewModel(n){var t=this;t.popupobject=n;t._value=ko.observable("");Object.defineProperty(t,"value",{get:function(){return t._value()},set:function(n){t._value(n)},enumerable:!0,configurable:!0});t.validationError=ko.observable(!1);t.validationErrorMessage=ko.observable("");t.validationErrorCode=ko.observable(errorConstants.none);t.topLevelForm=n.controlSender.topLevelForm;t.associatedForm=n.controlSender.associatedForm;t._tagName=ko.observable("Search text");Object.defineProperty(t,"tagName",{get:function(){return t._tagName()},set:function(n){t._tagName(n)},enumerable:!0,configurable:!0});t._lostFocus=ko.observable(!1);Object.defineProperty(t,"lostFocus",{get:function(){return t._lostFocus()},set:function(n){t._lostFocus(n)},enumerable:!0,configurable:!0});t._lostFocus=t._lostFocus.extend({skLostFocusExtend:t});t._isMandatory=ko.observable(!0);Object.defineProperty(t,"isMandatory",{get:function(){return t._isMandatory()},set:function(n){t._isMandatory(n)},enumerable:!0,configurable:!0});t.showLoader=ko.observable(!1);t.showResult=ko.observable(!1);t.isSingle=ko.observable(!1);t.noResult=ko.observable(!1);t._visible=ko.observable(!1);Object.defineProperty(t,"visible",{get:function(){return t._visible()},set:function(n){t._visible(n)},enumerable:!0,configurable:!0});t.selectedControlName=ko.observable("");t.providers=ko.observableArray([]);t.loadProviders=function(n){t.providers($.parseJSON(n.d));t.providers().length<=2?t.isSingle(!0):t.isSingle(!1);t.selectedProvider($.parseJSON(n.d)[1]._value)};t.selectedProvider=ko.observable();t.resourceProperties=ko.observableArray([]);t.selectedresourceProperties=ko.observable();t.availableResourcesList=ko.observableArray([]);t.selectedAvailableResourcesList=ko.observable();t.searchClick=function(){if(t.validationErrorMessage.peek()!==""){t._lostFocus(!0);return}if(t.selectedProvider()!=null&&t.selectedresourceProperties()!=null&&t.value!=null){var n=skeltaUtils.getLoaderObject();$("#skpopup_loader")[0].appendChild(n);t.showLoader(!0);search(t.value,t);t.selectedAvailableResourcesList(null)}};t.selectedAvailableResourcesList.subscribe(function(n){t.selectedAvailableResourcesList(n)});t.clearErrorMessage=function(){t.validationError(!1);t.validationErrorMessage("");t.validationErrorCode(errorConstants.none)};t.onEnterSearch=function(n,i){return i.which==13?(t._lostFocus(!1),t.searchClick(),!1):!0};t.onEnterSave=function(n,i){return i.which==13?(t.submit(),!1):!0};t.submit=function(){var i=ko.utils.arrayFirst(t.availableResourcesList(),function(n){return n.Value===t.selectedAvailableResourcesList()}),r,u,n;if(SFU.isUndefined(i)){if(r='[{"Name":"","Value":""}]',u="",t.validationErrorMessage.peek()!==""){t._lostFocus(!0);return}}else r='[{"Name":"'+i.Name+'","Value":"'+i.Value+'"}]',u=i.Value;n=t.popupobject;n.data=r;n.selectedValue=u;t.showResult(!1);t.noResult(!1);n.eventType("submit");n.state("close");t.clearErrorMessage()};t.noResultClick=function(){t.showResult(!1);t.popupobject.templateDivObj.find("#pageSearch").attr("data-skpop","1");t.popupobject.templateDivObj.find("#pageResult").attr("data-skpop","0");t.popupobject.templateDivObj.find("#pageNoResult").attr("data-skpop","0")};t.ajaxFailed1=function(n,i,r){t.showLoader(!1);i==="timeout"?(skeltaUtils.showError(document.title,skelta.localize.getString("Form_ULRL_TO")),logger.logError(skelta.localize.getString("Form_ULRL_TO")+"\n"+r.message)):(skeltaUtils.showError(document.title,skelta.localize.getString("FormNGFULRLAjaxFail")),logger.logError(skelta.localize.getString("FormNGFULRLAjaxFail")))};t.cancel=function(){var n=t.popupobject;t.showResult(!1);t.noResult(!1);n.eventType("Cancel");n.state("close");t.value="";t.clearErrorMessage()};t.clear=function(){t.showResult(!1);t.selectedAvailableResourcesList(null);t.value="";t.clearErrorMessage();t._lostFocus(!0);t.popupobject.templateDivObj.find("#pageSearch").attr("data-skpop","1");t.popupobject.templateDivObj.find("#pageResult").attr("data-skpop","0")};t.choosenResourcesList=ko.observableArray([]);t.selectedChoosenResourcesList=ko.observable();t.loadResources=function(n){t.resourceProperties($.parseJSON(n.d));t.selectedresourceProperties($.parseJSON(n.d)[0].value)};this.selectedProvider.subscribe(function(n){skeltaUtils.isUndefined(n)||loadResources(t.loadResources,n)});t.loadAvailableResources=function(n){t.availableResourcesList($.parseJSON(n.d));$.parseJSON(n.d).length>0?(t.showResult(!0),t.noResult(!1),t.popupobject.templateDivObj.find("#pageSearch").attr("data-skpop","0"),t.popupobject.templateDivObj.find("#pageResult").attr("data-skpop","1")):(t.showResult(!1),t.noResult(!0),t.popupobject.templateDivObj.find("#pageSearch").attr("data-skpop","0"),t.popupobject.templateDivObj.find("#pageNoResult").attr("data-skpop","1"));t.showLoader(!1)}}function loadRoleLookupViewModel(n){var t=new RoleLookupViewModel(n),i=skeltaUtils.createJsonRequestHelper({appName:skelta.userContext.getUserContextFor("appN")});return skeltaUtils.callServerMethod("POST",skelta.forms.utilities.getServerUrl("UserLookup.aspx/GetProviderList"),"application/json; charset=utf-8",i,"json",t.loadProviders,ajaxFailed,null),t}function RoleLookupViewModel(n){var t=this;t.popupobject=n;t._value=ko.observable("");Object.defineProperty(t,"value",{get:function(){return t._value()},set:function(n){t._value(n)},enumerable:!0,configurable:!0});t.validationError=ko.observable(!1);t.validationErrorMessage=ko.observable("");t.validationErrorCode=ko.observable(errorConstants.none);t.topLevelForm=n.controlSender.topLevelForm;t.associatedForm=n.controlSender.associatedForm;t._tagName=ko.observable("Search text");Object.defineProperty(t,"tagName",{get:function(){return t._tagName()},set:function(n){t._tagName(n)},enumerable:!0,configurable:!0});t._lostFocus=ko.observable(!1);Object.defineProperty(t,"lostFocus",{get:function(){return t._lostFocus()},set:function(n){t._lostFocus(n)},enumerable:!0,configurable:!0});t._lostFocus=t._lostFocus.extend({skLostFocusExtend:t});t._isMandatory=ko.observable(!0);Object.defineProperty(t,"isMandatory",{get:function(){return t._isMandatory()},set:function(n){t._isMandatory(n)},enumerable:!0,configurable:!0});t.showLoader=ko.observable(!1);t.showResult=ko.observable(!1);t.isMultiple=ko.observable(!1);t.numberOfColumns=ko.observable("2");t.noResult=ko.observable(!1);t._visible=ko.observable(!1);Object.defineProperty(t,"visible",{get:function(){return t._visible()},set:function(n){t._visible(n)},enumerable:!0,configurable:!0});t.availableResourcesList=ko.observableArray([]);t.selectedControlName=ko.observable("");t.selectedAvailableResourcesList=ko.observable();t.providers=ko.observableArray([]);t.loadProviders=function(n){t.providers($.parseJSON(n.d));t.providers().length<=2?(t.isMultiple(!1),t.numberOfColumns("1")):(t.isMultiple(!0),t.numberOfColumns("2"));t.selectedProvider($.parseJSON(n.d)[1]._value)};t.selectedProvider=ko.observable();t.loadAvailableResources=function(n){t.availableResourcesList($.parseJSON(n.d));$.parseJSON(n.d).length>0?(t.showResult(!0),t.noResult(!1),t.popupobject.templateDivObj.find("#pageSearch").attr("data-skpop","0"),t.popupobject.templateDivObj.find("#pageResult").attr("data-skpop","1")):(t.showResult(!1),t.noResult(!0),t.popupobject.templateDivObj.find("#pageSearch").attr("data-skpop","0"),t.popupobject.templateDivObj.find("#pageNoResult").attr("data-skpop","1"));t.showLoader(!1)};t.searchClick=function(){var n,i;try{if(t.validationErrorMessage.peek()!==""){t._lostFocus(!0);return}t.selectedProvider()!=null&&t.value!=null&&(n=skeltaUtils.getLoaderObject(),$("#skpopup_loader")[0].appendChild(n),t.showLoader(!0),i=skeltaUtils.createJsonRequestHelper({searchText:t.value,appName:skelta.userContext.getUserContextFor("appN"),provider:t.selectedProvider()}),skeltaUtils.callServerMethod("POST",skelta.forms.utilities.getServerUrl("UserLookup.aspx/GetRoles"),"application/json; charset=utf-8",i,"json",t.loadAvailableResources,t.ajaxFailed,null),t.selectedAvailableResourcesList(null))}catch(r){t.ajaxFailed()}};t.ajaxFailed=function(){t.showLoader(!1);skeltaUtils.showError(document.title,skelta.localize.getString("FormNGFULRLAjaxFail"));logger.logError(skelta.localize.getString("FormNGFULRLAjaxFail"))};t.noResultClick=function(){t.showResult(!1);t.popupobject.templateDivObj.find("#pageSearch").attr("data-skpop","1");t.popupobject.templateDivObj.find("#pageResult").attr("data-skpop","0");t.popupobject.templateDivObj.find("#pageNoResult").attr("data-skpop","0")};t.selectedAvailableResourcesList.subscribe(function(n){t.selectedAvailableResourcesList(n)});t.onEnterSearch=function(n,i){return i.which==13?(t._lostFocus(!1),t.searchClick(),!1):!0};t.onEnterSave=function(n,i){return i.which==13?(t.submit(),!1):!0};t.submit=function(){var i=ko.utils.arrayFirst(t.availableResourcesList(),function(n){return n.Value===t.selectedAvailableResourcesList()}),r,u,n;skeltaUtils.isUndefined(i)?(r='[{"Name":"","Value":""}]',u=""):(r='[{"Name":"'+i.Name+'","Value":"'+i.Value+'"}]',u=i.Value);n=t.popupobject;n.data=r;n.selectedValue=u;t.showResult(!1);t.noResult(!1);n.eventType("submit");n.state("close");t.clearErrorMessage()};t.cancel=function(){var n=t.popupobject;t.showResult(!1);t.noResult(!1);n.eventType("Cancel");n.state("close");t.value="";t.clearErrorMessage()};t.clear=function(){t.showResult(!1);t.selectedAvailableResourcesList(null);t.value="";t.clearErrorMessage();t._lostFocus(!0);t.popupobject.templateDivObj.find("#pageSearch").attr("data-skpop","1");t.popupobject.templateDivObj.find("#pageResult").attr("data-skpop","0")};t.clearErrorMessage=function(){t.validationError(!1);t.validationErrorMessage("");t.validationErrorCode(errorConstants.none)}}var clickedSubmitButtonId,formsControlLookupDiv,SFV,dialog,scrollview,skeltaUtils,logger;(function(n,t){function v(n,t,r){var e=n.children(),o=!1,u,s,f;for(n.empty(),u=0,s=e.length;u<s;u++)if(f=e.eq(u),n.append(f),r&&n.append(r),i(n,t)){f.remove();o=!0;break}else r&&r.detach();return o}function e(t,r,u,f,o){var s=!1,h="a, table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style",c="script, .dotdotdot-keep";return t.contents().detach().each(function(){var a=this,l=n(a);if(typeof a=="undefined")return!0;if(l.is(c))t.append(l);else{if(s)return!0;t.append(l);!o||l.is(f.after)||l.find(f.after).length||t[t.is(h)?"after":"append"](o);i(u,f)&&(s=a.nodeType==3?y(l,r,u,f,o):e(l,r,u,f,o),s||(l.detach(),s=!0));s||o&&o.detach()}}),r.addClass("is-truncated"),s}function y(t,f,e,s,c){var l=t[0],nt,k,d;if(!l)return!1;var y=h(l),tt=y.indexOf(" ")!==-1?" ":"　",p=s.wrap=="letter"?"":tt,a=y.split(p),g=-1,w=-1,b=0,v=a.length-1;for(s.fallbackToLetter&&b==0&&v==0&&(p="",a=y.split(p),v=a.length-1);b<=v&&!(b==0&&v==0);){if(nt=Math.floor((b+v)/2),nt==w)break;w=nt;u(l,a.slice(0,w+1).join(p)+s.ellipsis);e.children().each(function(){n(this).toggle().toggle()});i(e,s)?(v=w,s.fallbackToLetter&&b==0&&v==0&&(p="",a=a[0].split(p),g=-1,w=-1,b=0,v=a.length-1)):(g=w,b=w)}return g==-1||a.length==1&&a[0].length==0?(k=t.parent(),t.detach(),d=c&&c.closest(k).length?c.length:0,k.contents().length>d?l=r(k.contents().eq(-1-d),f):(l=r(k,f,!0),d||k.detach()),l&&(y=o(h(l),s),u(l,y),d&&c&&n(l).parent().append(c))):(y=o(a.slice(0,g+1).join(p),s),u(l,y)),!0}function i(n,t){return n.innerHeight()>t.maxHeight}function o(t,i){while(n.inArray(t.slice(-1),i.lastCharacter.remove)>-1)t=t.slice(0,-1);return n.inArray(t.slice(-1),i.lastCharacter.noEllipsis)<0&&(t+=i.ellipsis),t}function s(n){return{width:n.innerWidth(),height:n.innerHeight()}}function u(n,t){n.innerText?n.innerText=t:n.nodeValue?n.nodeValue=t:n.textContent&&(n.textContent=t)}function h(n){return n.innerText?n.innerText:n.nodeValue?n.nodeValue:n.textContent?n.textContent:""}function c(n){do n=n.previousSibling;while(n&&n.nodeType!==1&&n.nodeType!==3);return n}function r(t,i,u){var e=t&&t[0],f;if(e){if(!u){if(e.nodeType===3)return e;if(n.trim(t.text()))return r(t.contents().last(),i)}for(f=c(e);!f;){if(t=t.parent(),t.is(i)||!t.length)return!1;f=c(t[0])}if(f)return r(n(f),i)}return!1}function p(t,i){return t?typeof t=="string"?(t=n(t,i),t.length?t:!1):t.jquery?t:!1:!1}function w(n){for(var t,r=n.innerHeight(),u=["paddingTop","paddingBottom"],i=0,f=u.length;i<f;i++)t=parseInt(n.css(u[i]),10),isNaN(t)&&(t=0),r-=t;return r}var f,l,a;n.fn.dotdotdot||(n.fn.dotdotdot=function(t){var r;if(this.length==0)return n.fn.dotdotdot.debug('No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){n(this).dotdotdot(t)});r=this;r.data("dotdotdot")&&r.trigger("destroy.dot");r.data("dotdotdot-style",r.attr("style")||"");r.css("word-wrap","break-word");r.css("white-space")==="nowrap"&&r.css("white-space","normal");r.bind_events=function(){r.on("update.dot",function(t,f){r.removeClass("is-truncated");t.preventDefault();t.stopPropagation();switch(typeof u.height){case"number":u.maxHeight=u.height;break;case"function":u.maxHeight=u.height.call(r[0]);break;default:u.maxHeight=w(r)}u.maxHeight+=u.tolerance;typeof f!="undefined"&&((typeof f=="string"||"nodeType"in f&&f.nodeType===1)&&(f=n("<div />").append(f).contents()),f instanceof n&&(c=f));h=r.wrapInner('<div class="dotdotdot" />').children();h.contents().detach().end().append(c.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var s=!1,l=!1;return o.afterElement&&(s=o.afterElement.clone(!0),s.show(),o.afterElement.detach()),i(h,u)&&(l=u.wrap=="children"?v(h,u,s):e(h,r,h,u,s)),h.replaceWith(h.contents()),h=null,n.isFunction(u.callback)&&u.callback.call(r[0],l,c),o.isTruncated=l,l}).on("isTruncated.dot",function(n,t){return n.preventDefault(),n.stopPropagation(),typeof t=="function"&&t.call(r[0],o.isTruncated),o.isTruncated}).on("originalContent.dot",function(n,t){return n.preventDefault(),n.stopPropagation(),typeof t=="function"&&t.call(r[0],c),c}).on("destroy.dot",function(n){n.preventDefault();n.stopPropagation();r.unwatch().unbind_events().contents().detach().end().append(c).attr("style",r.data("dotdotdot-style")||"").data("dotdotdot",!1)});return r};r.unbind_events=function(){return r.unbind(".dot"),r};r.watch=function(){if(r.unwatch(),u.watch=="window"){var t=n(window),i=t.width(),f=t.height();t.on("resize.dot"+o.dotId,function(){i==t.width()&&f==t.height()&&u.windowResizeFix||(i=t.width(),f=t.height(),l&&clearInterval(l),l=setTimeout(function(){r.trigger("update.dot")},100))})}else a=s(r),l=setInterval(function(){if(r.is(":visible")){var n=s(r);(a.width!=n.width||a.height!=n.height)&&(r.trigger("update.dot"),a=n)}},500);return r};r.unwatch=function(){return n(window).unbind("resize.dot"+o.dotId),l&&clearInterval(l),r};var c=r.contents(),u=n.extend(!0,{},n.fn.dotdotdot.defaults,t),o={},a={},l=null,h=null;return u.lastCharacter.remove instanceof Array||(u.lastCharacter.remove=n.fn.dotdotdot.defaultArrays.lastCharacter.remove),u.lastCharacter.noEllipsis instanceof Array||(u.lastCharacter.noEllipsis=n.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),o.afterElement=p(u.after,r),o.isTruncated=!1,o.dotId=f++,r.data("dotdotdot",!0).bind_events().trigger("update.dot"),u.watch&&r.watch(),r},n.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0},n.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","　",",",";",".","!","?"],noEllipsis:[]}},n.fn.dotdotdot.debug=function(){},f=1,l=n.fn.html,n.fn.html=function(i){return i!=t&&!n.isFunction(i)&&this.data("dotdotdot")?this.trigger("update",[i]):l.apply(this,arguments)},a=n.fn.text,n.fn.text=function(i){return i!=t&&!n.isFunction(i)&&this.data("dotdotdot")?(i=n("<div />").text(i).html(),this.trigger("update",[i])):a.apply(this,arguments)})})(jQuery);
/*!
// ------------------------------------------------------------------------------------------------------------
// <copyright company="Schneider Electric Software, LLC" file="se.ui.js">
//   © 2015 Schneider Electric Software, LLC. All rights reserved.
//
// THIS CODE AND INFORMATION ARE PROVIDED "AS IS" WITHOUT WARRANTY OF ANY
// KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
// IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A
// PARTICULAR PURPOSE.
// </copyright>
// <author>Rupesh Kokal</author>
// <date>2015-07-21</date>
// <summary>
// This module contains the common UI/UX Web components.
// </summary>
// ------------------------------------------------------------------------------------------------------------
*/
window.se||function(){function n(){var n=this}n.prototype.createNamespace=function(){for(var f=arguments,i=null,e,o,u,t,r=0;r<f.length;r++){u="";try{(typeof f[r]=="string"||f[r]instanceof String)&&(u=f[r].toString())}catch(s){u=""}if(u!="")for(o=(""+u).split("."),i=window,e=0;e<o.length;e++)t=o[e],!t||t.length<0?t="_":t.indexOf(" ")>-1&&(t=t.replace(/\s+/g,"_")),i[t]=i[t]||new n(i,t),i=i[t]}};window.se=window.se||new n(null,"se")}();se.utils||(se.utils=function(n){function t(n){return typeof n=="undefined"||n==null}function e(n){return!t(n)&&typeof n=="object"}function r(n){return!t(n)&&(typeof n=="string"||n instanceof String)}function i(n){return!t(n)&&Object.prototype.toString.apply(n)==="[object Array]"}function o(n){return!t(n)&&typeof n=="function"}function s(n,t){return i(n)?t<0||t>n.length-1?!1:!0:!1}function h(u,f){var e;if(!t(f))return i(f)||(f=[f]),n.each(f,function(n,t){if(r(u[t]))return e=u[t],!1}),e}function c(){try{return t(window.parent)?void 0:window.parent===window?void 0:t(window.parent.$)?void 0:u(window.parent)?window.parent:void 0}catch(n){return}}function l(){try{return t(window.top)?void 0:window.top===window?void 0:t(window.top.$)?void 0:u(window.top)?window.top:void 0}catch(n){return}}function u(n){try{return n.$('<div style="display:none"/>').remove(),!0}catch(t){}return!1}function a(){var t=n("body");return t.length<1&&(t=n("html")),t}function f(n){var i,t,r;try{if(n=n||window.document,n.body===n.activeElement||n.activeElement.tagName.toLowerCase()=="iframe"){for(i=n.getElementsByTagName("iframe"),t=0;t<i.length;t++)if(r=f(i[t].contentWindow.document),r!==!1)return r}else return n.activeElement}catch(u){console.log("Error encountered while checking active element:");console.log("  -  "+u.message)}return!1}function v(t){var r="",i=n("<div/>").html(t);return i.children("br").after("\n").remove(),r=i.text(),i.remove(),r}function y(){var n=!1,i;try{i=window.location.pathname.match(/_layouts\/[0-9][0-9]\/BPMUI/i);!t(i)&&i.length>0?n=!0:t(window.SP)||t(window.SP.ClientContext)?t(window._spPageContextInfo)||t(window._spPageContextInfo.layoutsUrl)||(n=!0):n=!0}catch(r){}return n}return{isUndefined:t,isString:r,isObject:e,isArray:i,isFunction:o,isValidArrayIndex:s,getFirstValueFromMemberArrayInObject:h,getParentAccessibleWindow:c,getTopLevelAccessibleWindow:l,getBodyElement:a,getActiveElement:f,getTextFromHTMLForMessage:v,isSharePointEnvironment:y}}(jQuery));se.ui||function(n){se.createNamespace("se.ui");var i=se.utils,t=se.ui;(function(){var r=function(){var t=this;this.$element=n("<a />").text(this._options.text).attr("title",this._options.tooltip).addClass("se-ui-image-link");this._options.imageClassName!==""&&this.$element.addClass(this._options.imageClassName);this._options.className!==""&&this.$element.addClass(this._options.className);this.$element.click(function(){var n=t._options;(i.isUndefined(n.callback)||n.callback(n.value)!=!1)&&(i.isUndefined(n.callAfterCallback)||n.callAfterCallback(n.value))})},u=function(){this.$element.remove();delete this.$element};t.ImageLink=function(t){this._options={key:"",text:"",value:"",tooltip:"",imageClassName:"",className:"",callback:undefined,callAfterCallback:function(){}};i.isUndefined(t)&&(t={});n.extend(!0,this._options,t);r.call(this)};t.ImageLink.prototype.dispose=function(){u.call(this)}})(),function(){var r=function(){var t=this;this.$element=n('<input type="button" />').attr("value",this._options.text).attr("title",this._options.tooltip).addClass("se-ui-button");this._options.defaultFocus&&this.$element.addClass("se-ui-button-defaultfocus");this._options.className!==""&&this.$element.addClass(this._options.className);this.$element.click(function(){var n=t._options;(i.isUndefined(n.callback)||n.callback(n.value)!=!1)&&(i.isUndefined(n.callAfterCallback)||n.callAfterCallback(n.value))})},u=function(){this.$element.remove();delete this.$element};t.Button=function(t){this._options={key:"",defaultFocus:!1,text:"",value:"",tooltip:"",className:"",callback:undefined,callAfterCallback:function(){}};i.isUndefined(t)&&(t={});n.extend(!0,this._options,t);r.call(this)};t.Button.prototype.dispose=function(){u.call(this)}}(),function(){var r=function(r){var f=this;i.isUndefined(r)&&(r={});n.each(r,function(r,e){var o,s;u.call(f,r)||(o=n.extend(!0,{},e,{key:r}),i.isFunction(o.callback)||i.isUndefined(f._options.handlerFn)||(o.callback=f._options.handlerFn),s=new t.Button(o),f._collection.push(s),f._options.reverseOrder?f.$element.prepend(s.$element):f.$element.append(s.$element))})},u=function(t){var i=!1;return n.each(this._collection,function(n,r){if(r._options.key==t)return i=!0,!1}),i},f=function(){while(this._collection.length>0){var n=this._collection.pop();n.dispose()}},e=function(){this.$element=n("<div />").addClass("se-ui-buttons-container se-flex-item-align-item-end");this._options.className!==""&&this.$element.addClass(this._options.className);r.call(this,this._options.buttons)},o=function(){f.call(this);this.$element.remove();delete this.$element};t.Buttons=function(t){this._options={className:"",reverseOrder:!0,buttons:{}};i.isUndefined(t)&&(t={});n.extend(!0,this._options,t);this._collection=[];e.call(this)};t.Buttons.prototype.getButtonWithKey=function(t){var i;return n.each(this._collection,function(n,r){if(r._options.key==t)return i=r,!1}),i};t.Buttons.prototype.dispose=function(){o.call(this)}}(),function(){var r=function(){var r=this,t;f.call(this);this.$element=n("<div/>").addClass("se-ui-overlay-container se-flex-container se-flex-container-direction-column se-flex-container-align-items-stretch se-flex-container-justify-content-center");this.$element.on("mouseup",function(){r.$elementFirst.focus()});this.$element.on("focus",function(){r.$elementFirst.focus()});n(window).on("focus.se.message",function(){r.$elementFirst.focus()});this._options.className!==""&&this.$element.addClass(this._options.className);this.$elementFirst=n("<div />").on("keydown",function(n){var t=n.which||n.keyCode;t===9&&n.shiftKey&&(r.$elementLast.focus(),n.preventDefault(),n.stopPropagation());t===32&&(n.preventDefault(),n.stopPropagation())}).appendTo(this.$element).attr("tabindex","0");t=i.getBodyElement();this._options.hideScroll&&(this._options.trackScroll&&(this._scrollTop=t.scrollTop(),this._scrollLeft=t.scrollLeft()),this._overflow=t[0].style.overflow);this.$elementDummyBodyFirst=n("<div />").on("focus",function(){r.$elementFirst.focus()}).prependTo(t).attr("tabindex","0");this.$element.appendTo(t);this._options.hideScroll&&t.css("overflow","hidden")},u=function(){if(n(window).off("focus.se.message"),this.$elementDummyBodyFirst.remove(),delete this.$elementDummyBodyFirst,this.$elementFirst.remove(),delete this.$elmentFirst,this.$elementLast.remove(),delete this.$elementLast,this.$element.remove(),delete this.$element,this._options.hideScroll){var t=i.getBodyElement();i.isUndefined(this._overflow)||(t[0].style.overflow=this._overflow);this._options.trackScroll&&(t.scrollTop(this._scrollTop),t.scrollLeft(this._scrollLeft))}e.call(this)},f=function(){this.originalFocusElement=i.getActiveElement();this._restoreFocus=this._options.restoreFocus},e=function(){try{if(this._restoreFocus===!0)try{this.originalFocusElement.focus()}catch(t){}delete this.originalFocusElement;delete this._restoreFocus}catch(n){console.log("Focus to the active element could not be set:");console.log("  -  "+n.message)}};t.Overlay=function(u){this._options={hideScroll:t.messageDialogDefaults.hideScroll,trackScroll:t.messageDialogDefaults.trackScroll,restoreFocus:t.messageDialogDefaults.restoreFocus,className:""};i.isUndefined(u)&&(u={});n.extend(!0,this._options,u);r.call(this)};t.Overlay.prototype.suppressFocus=function(){this._restoreFocus=!1};t.Overlay.prototype.addLastElement=function(){var t=this;this.$elementLast=n("<div />").on("keydown",function(n){var i=n.which||n.keyCode;i!==9||n.shiftKey||(t.$elementFirst.focus(),n.preventDefault(),n.stopPropagation());i===32&&(n.preventDefault(),n.stopPropagation())}).appendTo(this.$element).attr("tabindex","0")};t.Overlay.prototype.dispose=function(){u.call(this)}}(),function(){t.messageDialogTypes={notification:"notification",warning:"warning",confirmation:"confirmation",error:"error",custom:"custom"};t.messageDialogTarget={currentWindow:"currentWindow",parentWindow:"parentWindow",topWindow:"topWindow"};t.messageDialogDefaults={messageDialogTarget:t.messageDialogTarget.topWindow,hideScroll:!0,trackScroll:!1,restoreFocus:!0,buttonReverseOrder:!0,okButtonCaption:"OK",cancelButtonCaption:"Cancel",closeButtonCaption:"Close",showDetailsCaption:"More",hideDetailsCaption:"Less",showMoreImageClassName:"se-ui-image-down-arrow",hideMoreImageClassName:"se-ui-image-up-arrow"};t.messageDialogConstants={titleParam:"title",messageParam:"message",buttonCaptionParam:"buttonCaption",okButtonCaptionParam:"okButtonCaption",cancelButtonCaptionParam:"cancelButtonCaption",closeButtonCaptionParam:"closeButtonCaption",detailsParam:"details",showDetailsCaptionParam:"showDetailsCaption",hideDetailsCaptionParam:"hideDetailsCaption",classNameParam:"className",handlerFnParam:"handlerFn"};var r=function(n,t,r,u){var e=t,f;return i.isString(t)&&t!==""||(i.isUndefined(this._globalOptions.localization[n])||(f=i.getFirstValueFromMemberArrayInObject(this._globalOptions.localization[n],r)),(i.isUndefined(f)||f==="")&&(f=i.getFirstValueFromMemberArrayInObject(this._globalOptions.localization,r),(i.isUndefined(f)||f==="")&&(f=u)),e=f),e},o=function(n,u,f,e,o,s,h){var a=this,c,l;arguments.length>=2&&arguments.length<=3&&(c=arguments[1],i.isObject(c)?(u=c[t.messageDialogConstants.titleParam],f=c[t.messageDialogConstants.messageParam],o=c[t.messageDialogConstants.okButtonCaptionParam],s=c[t.messageDialogConstants.cancelButtonCaptionParam],h=c[t.messageDialogConstants.classNameParam],e=c[t.messageDialogConstants.handlerFnParam]):arguments.length==3?(l=arguments[2],i.isFunction(l)&&(e=l,i.isString(c)&&(f=c,u=""))):arguments.length==2&&i.isString(c)&&(f=c,u=""));n!==t.messageDialogTypes.warning&&(n=t.messageDialogTypes.confirmation);i.isString(u)||(u="");i.isString(f)||(f="");o=r.call(this,n,o,t.messageDialogConstants.okButtonCaptionParam,t.messageDialogDefaults.okButtonCaption);s=r.call(this,n,s,t.messageDialogConstants.cancelButtonCaptionParam,t.messageDialogDefaults.cancelButtonCaption);i.isString(h)||(h="");i.isFunction(e)||(e=undefined);this.show({title:u,message:f,type:n,className:h,buttonsOptions:{buttons:{ok:{text:o,value:!0,defaultFocus:!0},cancel:{text:s,value:!1,callAfterCallback:function(){a.close()}}},handlerFn:e}})},s=function(){this._resizeTimeOut=null;this._showMoreLink.$element.hide();this._hideMoreLink.$element.hide();u.call(this);this.$elementMessage.removeClass("se-ui-message-show-more-options");this.$elementMessage.removeClass("se-ui-message-show-more");v.call(this,175);e.call(this,40);h.call(this);y.call(this)?(u.call(this),this.$elementMessage.addClass("se-ui-message-show-more-options"),f.call(this,!1)):u.call(this)},f=function(n){var t=this._showMoreLink,i=this._hideMoreLink;n===!0?(t.$element.hide(),i.$element.show(),u.call(this),e.call(this,80)):(t.$element.show(),i.$element.hide(),e.call(this,40),h.call(this))},h=function(){if(this.$messageDescription.data("dotdotdot")){var n=this.$messageDescription.triggerHandler("isTruncated.dot");n||this.$messageDescription.trigger("update.dot")}else this.$messageDescription.dotdotdot({ellipsis:"... ",wrap:"letter",fallbackToLetter:!0,after:null,watch:!1,height:null,tolerance:-20,callback:function(){},lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]}});this.$elementMessage.removeClass("se-ui-message-show-more")},u=function(){if(this.$messageDescription.data("dotdotdot")){var n=this.$messageDescription.triggerHandler("isTruncated.dot");this.$messageDescription.trigger("destroy.dot")}this.$elementMessage.addClass("se-ui-message-show-more")},c=function(t,i){var r=t,u;return r-=40,n(".se-ui-message-title").text()!==""&&(u=n(".se-ui-message-title").outerHeight(),r-=u,i-=u),r-=n(".se-ui-message-footer").outerHeight(),r<i&&(r=i),r},v=function(n){var t=c.call(this,n,100);this.$messageDescription.css("min-height",t+"px")},e=function(n){var t=c.call(this,n/100*this._overlay.$element.height(),parseFloat(this.$messageDescription.css("min-height")));this.$messageDescription.css("max-height",t+"px")},y=function(){return this.$messageDescription.data("dotdotdot")?this.$messageDescription.triggerHandler("isTruncated.dot"):!1},l=function(n){this._options=n;w.call(this)},p=function(){return"se-ui-message-type-"+this._options.type},w=function(){function v(n){var t=n.which||n.keyCode;!t||t!==13||n.altKey||n.ctrlKey||n.shiftKey||n.stopPropagation()}var r=this,f,e,o,c,l;this._overlay=new t.Overlay({hideScroll:this._globalOptions.hideScroll,trackScroll:this._globalOptions.trackScroll,restoreFocus:this._globalOptions.restoreFocus});this.$elementMessage=n("<div />").addClass("se-ui-message-container se-flex-container se-flex-container-direction-row se-flex-container-justify-content-center se-flex-container-align-items-stretch");n("<div/>").addClass("se-ui-message-type").addClass(p.call(this)).appendTo(this.$elementMessage);var a=n("<div/>").addClass("se-ui-message-details-container").appendTo(this.$elementMessage),h=n("<div/>").addClass("se-ui-message-details-sub-container se-flex-container se-flex-container-direction-column se-flex-container-align-items-stretch").appendTo(a),u=this._options.title;i.isString(u)||(u="");f=n("<div/>").addClass("se-ui-message-title");f.html(u);h.append(f);u===""&&f.hide();e=this._options.message;i.isString(e)||(e="");o=this._options.details;i.isString(o)||(o="");this.$messageDescription=n("<div/>").addClass("se-ui-message-description se-flex-item-flex-grow");this.$messageDescription.html(e+"<br/>"+o);h.append(this.$messageDescription);c=n("<div/>").addClass("se-ui-message-footer se-flex-container se-flex-container-direction-row se-flex-container-justify-content-space-between se-flex-container-align-items-stretch").appendTo(h);this._showMoreLink=new t.ImageLink(this._options.showDetails);this._hideMoreLink=new t.ImageLink(this._options.hideDetails);n("<div/>").append(this._showMoreLink.$element).append(this._hideMoreLink.$element).appendTo(c);this._buttons=new t.Buttons(this._options.buttonsOptions);this._buttons.$element.appendTo(c);this._overlay.$element.keydown(function(n){var u=n.which||n.keyCode,t;u&&u===27?(t=r._buttons.getButtonWithKey("cancel"),i.isUndefined(t)&&(t=r._buttons.getButtonWithKey("ok")),i.isUndefined(t)||t.$element.click(),n.preventDefault()):!u||u!==13||n.altKey||n.ctrlKey||n.shiftKey||(t=r._buttons.getButtonWithKey("ok"),i.isUndefined(t)&&(t=r._buttons.getButtonWithKey("cancel")),i.isUndefined(t)||t.$element.click(),n.preventDefault());n.stopPropagation()});this.$elementMessage.keydown(v);this._overlay.$element.append(this.$elementMessage);this._overlay.addLastElement();s.call(this);n(window).on("resize.se.ui.ellipsis",function(){this._resizeTimeOut&&clearTimeout(this._resizeTimeOut);this._resizeTimeOut=setTimeout(function(){s.call(r)},200)});l=this._overlay.$element.find(".se-ui-button-defaultfocus");setTimeout(function(){l.length>0?l.focus():this._overlay.$elementFirst.focus()},100)},a=function(){!this._overlay.$element.has(i.getActiveElement()).length>0&&this.suppressFocus();this._resizeTimeOut&&clearTimeout(this._resizeTimeOut);this._resizeTimeOut=null;n(window).off("resize.se.ui.ellipsis");this._buttons.dispose();delete this._buttons;this._showMoreLink.dispose();delete this._showMoreLink;this._hideMoreLink.dispose();delete this._hideMoreLink;this.$messageDescription.remove();delete this.$messageDescription;this.$elementMessage.remove();delete this.$elementMessage;this._overlay.dispose();delete this._overlay};MessageDialog=function(r){this._globalOptions={target:t.messageDialogDefaults.messageDialogTarget,buttonReverseOrder:t.messageDialogDefaults.buttonReverseOrder,hideScroll:t.messageDialogDefaults.hideScroll,trackScroll:t.messageDialogDefaults.trackScroll,restoreFocus:t.messageDialogDefaults.restoreFocus,showMoreImageClassName:t.messageDialogDefaults.showMoreImageClassName,hideMoreImageClassName:t.messageDialogDefaults.hideMoreImageClassName,localization:{closeButtonCaption:t.messageDialogDefaults.closeButtonCaption,okButtonCaption:t.messageDialogDefaults.okButtonCaption,cancelButtonCaption:t.messageDialogDefaults.cancelButtonCaption,showDetailsCaption:t.messageDialogDefaults.showDetailsCaption,hideDetailsCaption:t.messageDialogDefaults.hideDetailsCaption}};i.isUndefined(r)&&(r={});n.extend(!0,this._globalOptions,r);this._messageQueue=[]};MessageDialog.prototype.suppressFocus=function(){i.isUndefined(this._overlay)||this._overlay.suppressFocus()};MessageDialog.prototype.setGlobalOptions=function(t){i.isUndefined(t)&&(t={});n.extend(!0,this._globalOptions,t)};MessageDialog.prototype.getWindowObject=function(){try{var n;switch(this._globalOptions.target){case t.messageDialogTarget.parentWindow:n=i.getParentAccessibleWindow();break;case t.messageDialogTarget.topWindow:n=i.getTopLevelAccessibleWindow();break;default:return}return!i.isUndefined(n)&&!i.isUndefined(n.se)&&!i.isUndefined(n.se.ui)?n:void 0}catch(r){return}};MessageDialog.prototype.showAlert=function(n,u,f,e,o){if(arguments.length==1){var s=arguments[0];i.isString(s)?(u=s,n="",o="",f=undefined):i.isObject(s)&&(n=s[t.messageDialogConstants.titleParam],u=s[t.messageDialogConstants.messageParam],e=s[t.messageDialogConstants.buttonCaptionParam],o=s[t.messageDialogConstants.classNameParam],f=s[t.messageDialogConstants.handlerFnParam])}i.isString(n)||(n="");i.isString(u)||(u="");e=r.call(this,t.messageDialogTypes.notification,e,[t.messageDialogConstants.buttonCaptionParam,t.messageDialogConstants.closeButtonCaptionParam],t.messageDialogDefaults.closeButtonCaption);i.isString(o)||(o="");i.isFunction(f)||(f=undefined);this.show({title:n,message:u,type:t.messageDialogTypes.notification,className:o,buttonsOptions:{buttons:{ok:{text:e,value:"ok",defaultFocus:!0,callback:f}}}})};MessageDialog.prototype.showConfirmation=function(){var n=[t.messageDialogTypes.confirmation].concat(Array.prototype.slice.call(arguments));o.apply(this,n)};MessageDialog.prototype.showWarning=function(){var n=[t.messageDialogTypes.warning].concat(Array.prototype.slice.call(arguments));o.apply(this,n)};MessageDialog.prototype.showError=function(n,u,f,e,o,s){var c=this,h;arguments.length==1&&(h=arguments[0],i.isString(h)?(u=h,n="",s="",f=undefined,e=""):i.isObject(h)&&(n=h[t.messageDialogConstants.titleParam],u=h[t.messageDialogConstants.messageParam],o=h[t.messageDialogConstants.buttonCaptionParam],s=h[t.messageDialogConstants.classNameParam],f=h[t.messageDialogConstants.handlerFnParam],e=h[t.messageDialogConstants.detailsParam]));i.isString(n)||(n="");i.isString(u)||(u="");i.isString(e)||(e="");o=r.call(this,t.messageDialogTypes.error,o,[t.messageDialogConstants.buttonCaptionParam,t.messageDialogConstants.closeButtonCaptionParam],t.messageDialogDefaults.closeButtonCaption);i.isString(s)||(s="");i.isFunction(f)||(f=undefined);this.show({title:n,message:u,type:t.messageDialogTypes.error,details:e,className:s,buttonsOptions:{buttons:{ok:{text:o,value:"ok",defaultFocus:!0,callback:f}}}})};MessageDialog.prototype.show=function(u){var s,o,e,c,h;if(!i.isSharePointEnvironment()&&(s=this.getWindowObject(),!i.isUndefined(s))){s.se.ui.messageDialog.show(u);return}if(o=this,e={title:"",message:"",className:"",type:t.messageDialogTypes.notification,buttonsOptions:{reverseOrder:this._globalOptions.buttonReverseOrder,buttons:{ok:{text:t.messageDialogDefaults.closeButtonCaption,value:"ok",defaultFocus:!0,callAfterCallback:function(){o.close()}}}}},i.isUndefined(u)&&(u={}),n.extend(!0,e,u),e.showDetailsCaption=r.call(this,e.type,e.showDetailsCaption,t.messageDialogConstants.showDetailsCaptionParam,t.messageDialogDefaults.showDetailsCaption),e.hideDetailsCaption=r.call(this,e.type,e.hideDetailsCaption,t.messageDialogConstants.hideDetailsCaptionParam,t.messageDialogDefaults.hideDetailsCaption),n.extend(!0,e,{showDetails:{text:e.showDetailsCaption,value:"",imageClassName:t.messageDialogDefaults.showMoreImageClassName,callback:function(){f.call(o,!0)}},hideDetails:{text:e.hideDetailsCaption,imageClassName:t.messageDialogDefaults.hideMoreImageClassName,value:"",callback:function(){f.call(o,!1)}}}),i.isSharePointEnvironment()){try{switch(e.type){case t.messageDialogTypes.confirmation:case t.messageDialogTypes.warning:c=confirm(i.getTextFromHTMLForMessage(e.message));i.isUndefined(e.buttonsOptions.handlerFn)||e.buttonsOptions.handlerFn(c);break;case t.messageDialogTypes.error:h=e.message;i.isString(e.details)&&e.details!==""&&(h+="<br>"+e.details);alert(i.getTextFromHTMLForMessage(h));i.isUndefined(e.buttonsOptions.buttons.ok.callback)||e.buttonsOptions.buttons.ok.callback();break;default:alert(i.getTextFromHTMLForMessage(e.message));i.isUndefined(e.buttonsOptions.buttons.ok.callback)||e.buttonsOptions.buttons.ok.callback()}}catch(a){}return}(this._messageQueue.push(e),this._messageQueue.length>1)||l.call(this,e)};MessageDialog.prototype.close=function(){var n=this.getWindowObject();if(!i.isUndefined(n)){n.se.ui.messageDialog.close();return}a.call(this);this._messageQueue.shift();delete this._options;this._messageQueue.length>0&&l.call(this,this._messageQueue[0])};MessageDialog.prototype.dispose=function(){a.call(this)};t.messageDialog=new MessageDialog({target:t.messageDialogTarget.topWindow})}()}(jQuery);window.Skelta||function(){function n(){var n=this}n.prototype.createNamespace=function(){for(var f=arguments,i=null,e,o,u,t,r=0;r<f.length;r++){u="";try{(typeof f[r]=="string"||f[r]instanceof String)&&(u=f[r].toString())}catch(s){u=""}if(u!="")for(o=(""+u).split("."),i=window,e=0;e<o.length;e++)t=o[e],!t||t.length<0?t="_":t.indexOf(" ")>-1&&(t=t.replace(/\s+/g,"_")),i[t]=i[t]||new n(i,t),i=i[t]}return i};window.skelta=window.skelta||new n(null,"skelta");skelta.BaseClass=function(n,t){var i=this;i.getClassName=function(){return t}};skelta.BaseClass.prototype=skelta.BaseClass}();var readEditBehaviourEnum={editable:0,readOnly:1,allowOnlyAdd:2,editableWithoutParentPrecedence:4},FormCustomPath="FORMCUSTOMPATH",FormCustomThemePath="FORMCUSTOMTHEMEPATH";window.WW_IFRAME_PARAMETERNAME_FORMUNIQUEID=window.WW_IFRAME_PARAMETERNAME_FORMUNIQUEID||"skuniqueidforform";window.WW_SKINIT_FOCUS_DUMMY="dummy";var cssClasses={control:"skctr",mainControl:"skc",controlContainer:"skccon",container:"skcn",formContainer:"skfcn",containerBodyDiv:"skcb",containerBodyDivWrapper:"skcw",containerFormWrapper:"skcfw",columnResizer:"skcr",flexContainer:"skfc",flexDirectionColumn:"skfdc",flexDirectionRow:"skfdr",flexDirectionRowNoWrap:"skfdrnowrap",emptyContainerMsg:"skecm",flexAlignStretch:"skfas",flexAlignTop:"skfat",flexAlignCenter:"skfac",flexContent:"skflx",blankControl:"skbct",panelColumnHorizontal:"skpch",panelColumnVertical:"skpcv",propertiesToolBar:"skptb",formLabel:"skfl",labelControl:"sklc",formLabelInset:"skfli",formLabelDescription:"skfld",toolItem:"skti",validationMessage:"skvm",topLevelTitle:"sktt",topLevelDescription:"sktd",panelTitle:"skpt",panelDescription:"skpd",baseFormTitle:"skbt",baseFormDescription:"skbd",inputs:"ski",label:"skl",scrollableArea:"sksa",formFirstBody:"skffb",formFirstLabelDescription:"skffd",formFirstLabel:"skffl",formFirstLabelInset:"skffi",manageRecordLink:"skmr",addRowLink:"skar",deleteRowLink:"skdr",deleteRowLinkChild:"skdrc",formVisibility:"skfv",sfHeader:"skh",sfFooter:"skf",formVersionClass:"skfvc",mandatory:"skm",dropDown:"skdd",firstForm:"skff",toolBarControlContainer:"sktbc",toolBarControlImage:"sktbci",modalOverlay:"skma",eventLookup:"skel",formImage:"skfi",gridView:"skgv",gridViewTHead:"skgvth",gridViewTBody:"skgvtb",columnOptions:"skco",columnDeleteOption:"skcdo",positioningDivsHorizontal:"skposdh",positioningDivsVertical:"skposdv",formMainDiv:"skfmd",contentPosition:"skcp",controlLabelInset:"skcli",addButton:"skab",deleteButton:"skdb",mobileViewBackButton:"skm_bb",mobileViewHeaderTitle:"skm_h",mobileViewAddRowLink:"skm_ar",mobileViewDeleteRowLink:"skm_dr",mobileViewRecord:"skm_r",mobileViewSummary:"skm_sv",inputFlexContent:"skiflx",eventLookupImage:"skelimg",backButton:"skbb",baseFormCollapse:"skbfc",baseFormSummary:"skbsv",baseFormSummaryText:"skbst",baseFormSummarySeparator:"skbss",buttonControl:"skbtn",formLevelButtonTemplate:"skfbtn",actionToolBarTemplate:"skat",buttonControlImage:"skbtni",buttonControlTextAndImage:"skbtnti",radioButton:"skrb",checkBox:"skchb",listInputbox:"skli",mobileBaseFormImage:"skm_i",propertiesToolBarCollapse:"skptbc",buttonDiv:"skbtnd",buttonDivButtons:"skbtndb",buttonDivCancel:"skbtndc",actionToolBarButtons:"skatbtn",actionToolBarExtraButtons:"skate",flexJustifyContent:"skjc",controlsWrapper:"skctrw",lookupListing:"skll",lookupItems:"sklr",formsControlLookup:"skfcl",formsControlLookupDropDown:"skfcld",formsControlLookupAppend:"skfcla",formsControlLookupListing:"skfcll",formsControlLookupItems:"skfclr",UserLookupClearIcon:"skulci",UserLookupClearIconOverlay:"skulcio",lookupMobile:"skml",lookupMobileHidden:"skml_h",gridMobileViewTemplate:"skgmvt",gridMobileViewTemplateHidden:"skgmvt_h",AddTabs:"skatab",TabsContentWrapper:"sktcw",TabSelector:"skts",TabsPanel:"sktp",TabSeperator:"sktsp",TabBody:"sktb",lookupLoadMore:"skllm",embedPage:"skepg",mobileLookupInput:"sklid",tabsList:"sktl",tab:"skt",reportviewer:"skrv",lookupLoadmoreText:"skllmt",lookupMobileSelect:"sklms",lookupMobileItems:"skmlr",lookupMobileSelection:"skmlrs",adaptUIEnabled:"skauie",WebWidget:"skww"},dataAttributes={labelPosition:"data-sklp",isMainForm:"data-skimf",columnIndex:"data-skci",containerType:"data-skcnt",numberOfColumns:"data-sknoc",tabbing:"data-skt",columnWidths:"data-skcw",autoLayout:"data-skal",isMandatory:"data-skm",marginsPresent:"data-skmp",signatureHeaderDetails:"data-skhd",labelAlign:"data-skla",labelShowLine:"data-sksl",displayToolBar:"data-skdt",showHover:"data-sksh",showTargets:"data-skstg",targetType:"data-sktt",selected:"data-sks",senderType:"data-skst",controlType:"data-skct",showResizer:"data-sksr",toolType:"data-skttp",position:"data-skpos",columnResizer:"data-skcr",toolBarIcon:"data-sktbi",imageAlign:"data-skfi",controlPositionInPanel:"data-skcp",viewMode:"data-skvm",role:"data-skrl",gridViewControlId:"data-skgid",controlName:"data-skcn",isBaseFormRepeating:"data-skbfr",isMobileView:"data-skimv",isBaseFormCollapsed:"data-skbfc",baseFormDeleteLinkDisabled:"data-skbfdld",buttonType:"data-skbtn",buttonAlign:"data-skbtna",showAsLink:"data-sksal",buttonImageAlignment:"data-skbtnia",radioButtonDirection:"data-skrbd",checkBoxDirection:"data-skchbd",optionCountPerRow:"data-skoc",gridViewColumnCount:"data-skgvcc",retainSpace:"data-skrs",isPropertiesToolBarCollapse:"data-skptbc",gridViewCacheKey:"data-skck",actionToolBarButtonLength:"data-skat",actionToolBarExtraButtonLength:"data-skebtn",selectedTabIndex:"data-sksti",numberOfTab:"data-sknot",tabIndex:"data-sktab",isTabSelected:"data-skits",isTabHidden:"data-skith",mobileViewTemplate:"skmvt",buttonText:"data-btnt",reportviewerviewoption:"data-rpvo",mobileLookupSelectEnabled:"data-mlse",showGridHeader:"data-sksgh",WebWidgetHeightAttribute:"data-skwwh",PanelAvailableHeightAttribute:"data-cah"},idValues={stylePrefix:"SkSt_"},errorConstants={none:0,mandatory:1,controlSpecificValidation:2,validationScript:3,uiValidationRules:4,valueValidationRules:5},customBindings={panelRearrangeElements:"skpre",initGridStyles:"skigs",setFocusOnNewRecord:"skgf",autoAppendForGrid:"skaa",multipleAttribute:"skatml",tabsBodyVisibility:"sktbv",embedPageLoader:"skepl",isLoaded:"skisloaded",keyDownEvent:"skkde",attrItemHighlighted:"skhighlighted",WidgetInstanceId:"skwiid",AngularInstanceId:"skaiid"},customProperties={isValueInXmlEncoded:"skive",embedFormTopLevelXmlNode:"skefxml"},baseFormViewMode={"default":"0",grid:"1"},ngfLocalStorageKeys={nGFPageDefaults:"NGFPD",nGFLocales:"NGFLoc"},xmlUniqueSeparator="[[]{*}$!${*}[]]",numberRange={minimumValue:-999999999999999,maximumValue:999999999999999},propertyType={observable:"0",observableArray:"1",nonObservable:"2"};(function(){skelta.forms===undefined&&skelta.createNamespace("skelta.forms");skelta.forms.constants=function(){function c(){var n=[];return $.each(t,function(t,i){i.controlType==="actionbar"&&($.each(i.functions,function(t,i){n.push(i.name)}),$.each(i.properties,function(t,i){n.push(i.propertyName)}))}),n}var n={nonContainerFunctions:[{name:"findById",applicableTo:"both"},{name:"findByXmlNode",applicableTo:"both"},{name:"findByName",applicableTo:"both"},{name:"topLevelForm",applicableTo:"both"},{name:"submitForm",applicableTo:"both"},{name:"associatedForm",applicableTo:"both"},{name:"dataContainerForm",applicableTo:"both"},{name:"isTopLevelForm",applicableTo:"both"},{name:"getType",applicableTo:"both"},{name:"findAllById",applicableTo:"both"},{name:"findAllByName",applicableTo:"both"},{name:"findAllByXmlNode",applicableTo:"both"},{name:"sumById",applicableTo:"both"},{name:"sumByName",applicableTo:"both"},{name:"validateControl",applicableTo:"both"},{name:"sumByXmlNode",applicableTo:"both"}],containerFunctions:[{name:"findImmediateChildRecordControlById",applicableTo:"both"},{name:"findImmediateChildRecordControlByName",applicableTo:"both"},{name:"findImmediateChildRecordControlByXmlNode",applicableTo:"both"},{name:"findImmediateChildControlById",applicableTo:"associatedForm"},{name:"findImmediateChildControlByName",applicableTo:"associatedForm"},{name:"findImmediateChildControlByXmlNode",applicableTo:"associatedForm"},{name:"findChildRecordControlById",applicableTo:"both"},{name:"findChildRecordControlByName",applicableTo:"both"},{name:"findChildRecordControlByXmlNode",applicableTo:"both"},{name:"addRecord",applicableTo:"dataContainerForm"},{name:"addRecordToTop",applicableTo:"dataContainerForm"},{name:"addRecordToBottom",applicableTo:"dataContainerForm"},{name:"addRecordToPosition",applicableTo:"dataContainerForm"},{name:"clearContent",applicableTo:"both"},{name:"submitClick",applicableTo:"both"},{name:"removeAll",applicableTo:"dataContainerForm"},{name:"removeAt",applicableTo:"dataContainerForm"},{name:"removeRecord",applicableTo:"dataContainerForm"},{name:"remove",applicableTo:"associatedForm"},{name:"validateRecord",applicableTo:"associatedForm"},{name:"validateForm",applicableTo:"dataContainerForm"},{name:"records",applicableTo:"dataContainerForm"}]},t=[{functions:n.nonContainerFunctions.concat(n.containerFunctions).concat([{name:"getFormSubmissionData",applicableTo:"both"}]),isContainerControl:!0,controlType:"TopLevelForm",properties:[{isWritable:!0,propertyName:"tagName",propertyType:"0"},{isWritable:!0,propertyName:"description",propertyType:"0"},{isWritable:!1,propertyName:"formParameters",propertyType:"2"},{isWritable:!1,propertyName:"actionbar",propertyType:"2"}]},{functions:n.nonContainerFunctions.concat(n.containerFunctions),isContainerControl:!0,controlType:"BaseForm",properties:[{isWritable:!0,propertyName:"tagName",propertyType:"0"},{isWritable:!0,propertyName:"description",propertyType:"0"},{isWritable:!0,propertyName:"visible",propertyType:"0"},{isWritable:!0,propertyName:"width",propertyType:"0"},{isWritable:!0,propertyName:"height",propertyType:"0"},{isWritable:!1,propertyName:"id",propertyType:"2"},{isWritable:!1,propertyName:"xmlNodeBoundTo",propertyType:"2"},{isWritable:!1,propertyName:"isRepeating",propertyType:"2"},{isWritable:!0,propertyName:"addLinkText",propertyType:"0"},{isWritable:!0,propertyName:"deleteLinkText",propertyType:"0"},{isWritable:!0,propertyName:"imageSource",propertyType:"2"},{isWritable:!0,propertyName:"readEditAddBehaviour",propertyType:"0"},{isWritable:!1,propertyName:"viewMode",propertyType:"2"},{isWritable:!1,propertyName:"autoAppend",propertyType:"2"},{isWritable:!1,propertyName:"controls",propertyType:"1"},{isWritable:!1,propertyName:"minimumRows",propertyType:"0"},{isWritable:!1,propertyName:"maximumRows",propertyType:"0"}]},{functions:n.nonContainerFunctions.concat(n.containerFunctions),isContainerControl:!0,controlType:"PanelForm",properties:[{isWritable:!0,propertyName:"tagName",propertyType:"0"},{isWritable:!0,propertyName:"description",propertyType:"0"},{isWritable:!0,propertyName:"visible",propertyType:"0"},{isWritable:!0,propertyName:"width",propertyType:"0"},{isWritable:!0,propertyName:"height",propertyType:"0"},{isWritable:!1,propertyName:"id",propertyType:"2"},{isWritable:!0,propertyName:"imageSource",propertyType:"2"}]},{functions:n.nonContainerFunctions.concat(n.containerFunctions.concat([{name:"selectTab"}])),isContainerControl:!0,controlType:"Tabs",properties:[{isWritable:!0,propertyName:"tagName",propertyType:"0"},{isWritable:!0,propertyName:"description",propertyType:"0"},{isWritable:!0,propertyName:"visible",propertyType:"0"},{isWritable:!1,propertyName:"id",propertyType:"2"},{isWritable:!0,propertyName:"imageSource",propertyType:"2"},{isWritable:!1,propertyName:"selectedTabIndex",propertyType:"2"}]},{functions:n.nonContainerFunctions.concat(n.containerFunctions),isContainerControl:!0,controlType:"Tab",properties:[{isWritable:!0,propertyName:"tagName",propertyType:"0"},{isWritable:!0,propertyName:"description",propertyType:"0"},{isWritable:!0,propertyName:"visible",propertyType:"0"},{isWritable:!1,propertyName:"id",propertyType:"2"}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"Number",properties:[{isWritable:!0,propertyName:"max",propertyType:"0"},{isWritable:!0,propertyName:"min",propertyType:"0"},{isWritable:!0,propertyName:"value",propertyType:"0"},{isWritable:!1,propertyName:"defaultValue",propertyType:"0"},{isWritable:!0,propertyName:"isMandatory",propertyType:"0"},{isWritable:!1,propertyName:"xmlNodeBoundTo",propertyType:"2"},{isWritable:!0,propertyName:"readOnly",propertyType:"0"},{isWritable:!0,propertyName:"enable",propertyType:"0"},{isWritable:!0,propertyName:"tagName",propertyType:"0"},{isWritable:!0,propertyName:"description",propertyType:"0"},{isWritable:!0,propertyName:"visible",propertyType:"0"},{isWritable:!0,propertyName:"width",propertyType:"0"},{isWritable:!0,propertyName:"height",propertyType:"0"},{isWritable:!1,propertyName:"id",propertyType:"2"},{isWritable:!0,propertyName:"toolTip",propertyType:"0"},{propertyName:"displayValue",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"TextInput",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"maxLength",propertyType:"0",isWritable:!0},{propertyName:"minLength",propertyType:"0",isWritable:!0},{propertyName:"pattern",propertyType:"0",isWritable:!0},{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"readOnly",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"width",propertyType:"0",isWritable:!0},{propertyName:"height",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"EmailInput",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"maxLength",propertyType:"0",isWritable:!0},{propertyName:"messageWhenEmpty",propertyType:"0",isWritable:!0},{propertyName:"isMultipleEmail",propertyType:"0",isWritable:!0},{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"readOnly",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"width",propertyType:"0",isWritable:!0},{propertyName:"height",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"BooleanInput",properties:[{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"displayValue",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"HyperLinkText",properties:[{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"displayText",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"UserLookUp",properties:[{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"displayValue",propertyType:"0",isWritable:!1},{propertyName:"extendedInformation",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"RoleLookUp",properties:[{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"displayValue",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"Attachment",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"fileName",propertyType:"0",isWritable:!1},{propertyName:"file",propertyType:"0",isWritable:!1},{propertyName:"filePathTemplate",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"LabelControl",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"displayValue",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"CheckList",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"options",propertyType:"0",isWritable:!0},{propertyName:"optionText",propertyType:"2",isWritable:!0},{propertyName:"optionValue",propertyType:"2",isWritable:!0},{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"width",propertyType:"0",isWritable:!0},{propertyName:"height",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"selectedMode",propertyType:"0",isWritable:!0},{propertyName:"displayValue",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"FormImage",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"width",propertyType:"0",isWritable:!0},{propertyName:"height",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"ListInputbox",properties:[{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"selectedMode",propertyType:"2",isWritable:!1},{propertyName:"options",propertyType:"0",isWritable:!0},{propertyName:"optionText",propertyType:"2",isWritable:!0},{propertyName:"optionValue",propertyType:"2",isWritable:!0},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"width",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"displayValue",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"DropDownChoice",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"options",propertyType:"0",isWritable:!0},{propertyName:"optionCaption",propertyType:"2",isWritable:!0},{propertyName:"optionText",propertyType:"2",isWritable:!1},{propertyName:"optionValue",propertyType:"2",isWritable:!1},{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"width",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"displayValue",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"DateInput",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"max",propertyType:"0",isWritable:!0},{propertyName:"dateFormat",propertyType:"2",isWritable:!1},{propertyName:"min",propertyType:"0",isWritable:!0},{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"readOnly",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"displayValue",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"FormButton",properties:[{propertyName:"buttonText",propertyType:"0",isWritable:!0},{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"imagePath",propertyType:"2",isWritable:!1},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"Geolocation",properties:[{propertyName:"buttonText",propertyType:"0",isWritable:!0},{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"imagePath",propertyType:"2",isWritable:!1},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"latitude",propertyType:"0",isWritable:!0},{propertyName:"longitude",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"InvokeWorkflow",properties:[{propertyName:"buttonText",propertyType:"0",isWritable:!0},{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"executingMode",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"imagePath",propertyType:"2",isWritable:!1},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"TimeInput",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"timeFormat",propertyType:"2",isWritable:!1},{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"readOnly",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"displayValue",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"RadioButtonGroup",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"options",propertyType:"0",isWritable:!0},{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"optionText",propertyType:"2",isWritable:!0},{propertyName:"optionValue",propertyType:"2",isWritable:!0},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"width",propertyType:"0",isWritable:!0},{propertyName:"height",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"displayValue",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"HiddenFieldControl",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"DateTimeInput",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"max",propertyType:"0",isWritable:!0},{propertyName:"dateFormat",propertyType:"2",isWritable:!1},{propertyName:"timeFormat",propertyType:"2",isWritable:!1},{propertyName:"min",propertyType:"0",isWritable:!0},{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"readOnly",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"displayValue",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions.concat([{name:"selectRecord"},{name:"refreshGrid"},{name:"getDataSource"}]),isContainerControl:!1,controlType:"Grid",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"extendedInformation",propertyType:"2",isWritable:!1},{propertyName:"sourceName",propertyType:"2",isWritable:!1},{propertyName:"source",propertyType:"1",isWritable:!1},{propertyName:"readOnly",propertyType:"0",isWritable:!0},{propertyName:"selectedValue",propertyType:"0",isWritable:!1},{propertyName:"displayValue",propertyType:"0",isWritable:!1},{propertyName:"previousSelection",propertyType:"2",isWritable:!1},{propertyName:"autoLoadGrid",propertyType:"2",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"EmbedPage",properties:[{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"url",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"ElectronicSignatureForm",properties:[{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"visible",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"Password",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"readOnly",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"securityMode",propertyType:"0",isWritable:!1},{propertyName:"encryptedValue",propertyType:"0",isWritable:!1},{propertyName:"persistPassword",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"LookupInput",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"displayValue",propertyType:"0",isWritable:!1},{propertyName:"extendedInformation",propertyType:"2",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"PopupForm",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0},{propertyName:"extendedInformation",propertyType:"2",isWritable:!1},{propertyName:"buttonText",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"EmbeddedForm",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"ReportViewer",properties:[{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"reportName",propertyType:"0",isWritable:!0},{propertyName:"reportConfiguration",propertyType:"0",isWritable:!1},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"url",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"RichTextInput",properties:[{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"isMandatory",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"readOnly",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions.concat([{name:"refreshTree"}]),isContainerControl:!1,controlType:"Tree",properties:[{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"value",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"Gauge",properties:[{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"scaleMin",propertyType:"2",isWritable:!0},{propertyName:"scaleMax",propertyType:"2",isWritable:!0},{propertyName:"scaleAngleStart",propertyType:"2",isWritable:!0},{propertyName:"scaleAngleEnd",propertyType:"2",isWritable:!0},{propertyName:"minorUnit",propertyType:"2",isWritable:!0},{propertyName:"majorUnit",propertyType:"2",isWritable:!0},{propertyName:"valuePrecision",propertyType:"2",isWritable:!0},{propertyName:"showTargetIndicator",propertyType:"2",isWritable:!0},{propertyName:"targetValue",propertyType:"2",isWritable:!0},{propertyName:"width",propertyType:"0",isWritable:!1},{propertyName:"height",propertyType:"0",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"labelUnitOfMeasure",propertyType:"2",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"RFIDReader",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"width",propertyType:"0",isWritable:!0},{propertyName:"height",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"QRCodeScanner",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"width",propertyType:"0",isWritable:!0},{propertyName:"height",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"FormButton",properties:[{propertyName:"buttonText",propertyType:"0",isWritable:!0},{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"imagePath",propertyType:"2",isWritable:!1},{propertyName:"enable",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"toolTip",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions.concat([{name:"applyFilter"},{name:"clearFilter"},{name:"updateLevel1ProgressDisplay"},{name:"updateLevel2ProgressDisplay"},{name:"updateLevel3ProgressDisplay"},{name:"updateLevel2ToggleDisplay"},{name:"updateLevel3ToggleDisplay"},{name:"updateLevel2"},{name:"updateLevel3"},{name:"updateLevel2SelectItem"},{name:"updateLevel3SelectItem"}]),isContainerControl:!1,controlType:"HierarchicalList",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"width",propertyType:"0",isWritable:!0},{propertyName:"height",propertyType:"0",isWritable:!0},{propertyName:"level1IndicatorColor",propertyType:"2",isWritable:!0},{propertyName:"level1ProgressValue",propertyType:"2",isWritable:!0},{propertyName:"level1ProgressDescription",propertyType:"2",isWritable:!0},{propertyName:"level1ProgressColor",propertyType:"2",isWritable:!0},{propertyName:"level2IndicatorColor",propertyType:"2",isWritable:!0},{propertyName:"level2ProgressValue",propertyType:"2",isWritable:!0},{propertyName:"level2ProgressDescription",propertyType:"2",isWritable:!0},{propertyName:"level2ProgressColor",propertyType:"2",isWritable:!0},{propertyName:"level3IndicatorColor",propertyType:"2",isWritable:!0},{propertyName:"level3ProgressValue",propertyType:"2",isWritable:!0},{propertyName:"level3ProgressDescription",propertyType:"2",isWritable:!0},{propertyName:"level3ProgressColor",propertyType:"2",isWritable:!0},{propertyName:"level2ToggleEnable",propertyType:"2",isWritable:!0},{propertyName:"level2ToggleVisible",propertyType:"2",isWritable:!0},{propertyName:"level3ToggleEnable",propertyType:"2",isWritable:!0},{propertyName:"level3ToggleVisible",propertyType:"2",isWritable:!0},{propertyName:"children",propertyType:"2",isWritable:!0},{propertyName:"sibling",propertyType:"2",isWritable:!0},{propertyName:"aboveSiblingValue",propertyType:"2",isWritable:!0},{propertyName:"belowSiblingValue",propertyType:"2",isWritable:!0},{propertyName:"allSiblingValue",propertyType:"2",isWritable:!0}]},{functions:n.nonContainerFunctions.concat([{name:"refreshChart"}]),isContainerControl:!1,controlType:"Chart",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"width",propertyType:"0",isWritable:!0},{propertyName:"height",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"Slider",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"width",propertyType:"0",isWritable:!0},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"defaultValue",propertyType:"0",isWritable:!1}]},{functions:n.nonContainerFunctions.concat([{name:"CardImage"},{name:"refreshCard"},{name:"setAutoLoadCard"}]),isContainerControl:!1,controlType:"Card",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"width",propertyType:"0",isWritable:!0},{propertyName:"height",propertyType:"0",isWritable:!0},{propertyName:"headerValueLeft",propertyType:"0",isWritable:!0},{propertyName:"headerValueRight",propertyType:"0",isWritable:!0},{propertyName:"value1",propertyType:"0",isWritable:!0},{propertyName:"value2",propertyType:"0",isWritable:!0},{propertyName:"value2Label",propertyType:"0",isWritable:!0},{propertyName:"value3",propertyType:"0",isWritable:!0},{propertyName:"value3Label",propertyType:"0",isWritable:!0},{propertyName:"value4",propertyType:"0",isWritable:!0},{propertyName:"value4Label",propertyType:"0",isWritable:!0},{propertyName:"value5",propertyType:"0",isWritable:!0},{propertyName:"value5Label",propertyType:"0",isWritable:!0},{propertyName:"autoLoadCard",propertyType:"2",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"Arc",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"arcTitle",propertyType:"0",isWritable:!0},{propertyName:"arcUom",propertyType:"0",isWritable:!0},{propertyName:"arcTargetValue",propertyType:"0",isWritable:!0},{propertyName:"arcDecimalPlaces",propertyType:"0",isWritable:!0},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"options",propertyType:"0",isWritable:!0},{propertyName:"arcScaleMinValue",propertyType:"0",isWritable:!0},{propertyName:"arcScaleMaxValue",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"ProgressBar",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"progressBarTitle",propertyType:"0",isWritable:!0},{propertyName:"progressBarUom",propertyType:"0",isWritable:!0},{propertyName:"progressBarTargetValue",propertyType:"0",isWritable:!0},{propertyName:"progressBarDecimalPlaces",propertyType:"0",isWritable:!0},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"options",propertyType:"0",isWritable:!0},{propertyName:"progressBarScaleMinValue",propertyType:"0",isWritable:!0},{propertyName:"progressBarScaleMaxValue",propertyType:"0",isWritable:!0}]},{functions:n.nonContainerFunctions.concat([{name:"refreshData"}]),isContainerControl:!1,controlType:"Gantt",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"ganttDuration",propertyType:"0",isWritable:!0},{propertyName:"ganttTimeRangeStartTime",propertyType:"0",isWritable:!0},{propertyName:"ganttTimeRangeEndTime",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"ganttTitle",propertyType:"0",isWritable:!0},{propertyName:"ganttEnableAction1",propertyType:"0",isWritable:!0},{propertyName:"ganttEnableAction2",propertyType:"0",isWritable:!0},{propertyName:"ganttEnableAction3",propertyType:"0",isWritable:!0}]},{functions:[{name:"getActionItemByName"}],isContainerControl:!1,controlType:"actionbar",properties:[{propertyName:"items",propertyType:"2",isWritable:!1}]},{functions:n.nonContainerFunctions,isContainerControl:!1,controlType:"Widget",properties:[{propertyName:"xmlNodeBoundTo",propertyType:"2",isWritable:!1},{propertyName:"id",propertyType:"2",isWritable:!1},{propertyName:"tagName",propertyType:"0",isWritable:!0},{propertyName:"description",propertyType:"0",isWritable:!0},{propertyName:"defaultValue",propertyType:"2",isWritable:!1},{propertyName:"value",propertyType:"0",isWritable:!0},{propertyName:"visible",propertyType:"0",isWritable:!0},{propertyName:"widgetName",propertyType:"2",isWritable:!1},{propertyName:"confName",propertyType:"0",isWritable:!0},{propertyName:"widgetFormSource",propertyType:"0",isWritable:!0},{propertyName:"widgetProperties",propertyType:"0",isWritable:!1},{propertyName:"widgetScripts",propertyType:"0",isWritable:!1}]}],r={minimumValue:new Date(1900,1,1,0,0,1,0),maximumValue:new Date(9999,12,31,0,0,1,0)},i=["closeForm","decodeXmlValue","encodeXmlValue","encodeHtml","getDateTimeInStringFormat","getDateTimeInServerUTCFormat","getDateTimeInUTCFormat","getGridValue","getImagePath","getJSONObjectFromXml","getLookupSchemaAndData","getServerUtcOffset","getStorageItem","getUserLookupExtendedInformation","getUserRoles","getUserMemberOf","getUserSecurityGroup","getValueForRightCode","getVirtualActorId","getXmlFromJSONObject","hideLoader","includeCustomCssFiles","includeCustomJsFiles","invokeWorkflow","isArray","isControlInNewMode","isEmpty","isFormInEditMode","isMobileDisplayMode","isNumber","isUndefined","parseNumberValue","reloadForm","setStorageItem","soaMethod","showAlert","showConfirmation","showError","showLoader","showWarning","subscribeToControlParameters","getFormUrl","showPopupControl","logMessageToWMLogger","isWorkTasksPro","isWorkTasksProConnectedToInternet","updateFormHeaderForWorkTasksPro","getClientCredentialToken","getUserAccessToken","initializeWidgetFormCommunication"].sort(),u=["currentValue","control","window","document","SFU","skelta"].sort(),f=["localize","userContext","grid"].sort(),e=["getString"].sort(),o=["getUserContextFor"].sort(),s=["getDataSource"].sort(),h=["xmlNodeBoundTo","tagName","id","defaultValue","value","isMandatory","readOnly","enable","description","visible","width","height","toolTip"].sort(),l={globalObjects:u,skelta:f,SFU:i,localize:e,userContext:o,grid:s,actionbar:c(),controlDefaultMembers:h};return{controlsCollection:t,dateRange:r,formPControl:{Delimiter:"$!$//$!$"},lookupDefaults:{pageSize:50,itemHeight:30,minLength:3,dropdownHeight:300,lookupTimeout:50,validationTimeout:300,focusInTimeout:320,dropDownOpenTimeout:350,confirmationMessage:"ConfirMessageForClear",persistDisplayValueAttribute:"_DV",nodeAttributeName:"__text",persistValueDisplayColumn:"D",persistValueValueColumn:"V"},formsControlLookupSystemDefaults:{itemHeight:30,minLength:3,dropdownHeight:300,validationTimeout:300,persistDisplayValueAttribute:"_DV",nodeAttributeName:"__text"},ssrsConstants:{seprator_Section_Value:"@~!~@",seprator_Parameter_Inner_Value:"@!!@",seprator_Parameter_Outer_Value:"@~~@",report_View_Option_Embedded:"0",report_View_Option_Popup:"1",report_View_Option_Download:"2",section_Report_View_Option:0,section_Report_Template:1,section_Report_Behavior:2,section_Report_Parameters:3,section_Attachment:4,download_Report_Source_SSRS_Reports:"0",download_Report_Source_Reference_Id:"1"},dateFormats:{dateFormatForCoreValue:"MM/dd/yyyy",timeFormatForCoreValue:"HH:mm:ss",dateTimeFormatForCoreValue:"MM/dd/yyyy HH:mm:ss"},multiValueSeperator:{forms:";#",forms2011:";"},colorCode:{none:"#1b1b1b"},dataGridConstants:{enableThrottle:!0,throttleTime:100},invokeWorkflowConstants:{throttleOptions:{enabled:!0,wait:100,options:{trailing:!1}},timeout:1},loggerConstants:{enableThrottle:!0,throttleTime:1e3},triggerResizeEventConstants:{enableThrottle:!0,throttleTime:100},exclusionsFromDispose:["parentForm","associatedForm","topLevelForm","dataContainerForm","validationError","validationErrorMessage","validationErrorCode"],popupFormContants:{HtmRelativePath:""},expressionEditorDefaults:{isExpressionAttribute:"_isExpression"},SFUFunctions:i,intellisenseObjects:l,controlFunctions:n,filePathTemplateConstants:{storagePath:"<storagepath>",year:"<year>",month:"<month>",date:"<date>",hours:"<hours>",minutes:"<minutes>",seconds:"<seconds>",milliseconds:"<milliseconds>",guid:"<guid>",fileName:"<filename>",fileExtension:"<fileextension>"},defaultFilePathTemplate:"<StoragePath>\\<Year>\\<Month>\\<Date>\\<GUID>_<FileName>.<FileExtension>",cloudFilePathTemplate:"<GUID>_<FileName>.<FileExtension>",attachmentMaximumLimit:10}}()})();var lookupTemplateId="LookupTemplate",lookupTemplateDiv="lookupTemplateDiv",lookupScripTemplate="<script type='text/html' id="+lookupTemplateId+">";lookupScripTemplate+="<div style='overflow:auto;' data-bind='style: { maxHeight: $data._listingMaxHeight() + \"px\" }, foreach: $data._lookupItems'>";lookupScripTemplate+="<div class='"+cssClasses.lookupItems+"' data-bind='click: $parent.onItemClick, clickBubble: false, event: { mouseover: $parent.onItemMouseOver }, attr: { title: $data[$parent.displayField] }, skhighlighted: $parent.isDataItemHighlighted($data[$parent.valueField]), text: $data[$parent.displayField]'>";lookupScripTemplate+="<\/div><\/div>";lookupScripTemplate+="<div class='"+cssClasses.lookupLoadMore+"' data-bind='visible:$data._loadMore, click: $data.onLoadMoreParentClick, clickBubble: false'><a href='#' data-bind='text:$data._loadMoreText, click: $data.onLoadMoreClick, clickBubble: false'><\/a><\/div>";lookupScripTemplate+="<\/script>";var mobileLookupTemplate="MobileLookupTemplate",mobileLookupTemplateDiv="mobilelookupTemplateDiv",mobilelookupScripTemplate="<script type='text/html' id="+mobileLookupTemplate+">";mobilelookupScripTemplate+="<div class='"+cssClasses.sfHeader+"'>";mobilelookupScripTemplate+="<div class='"+cssClasses.mobileViewBackButton+"' data-bind='click: $data.closeMobileView, clickBubble: false'><\/div>";mobilelookupScripTemplate+="<div class='"+cssClasses.mobileViewHeaderTitle+"' data-bind='text: $data._tagName'><\/div><\/div>";mobilelookupScripTemplate+="<div class='"+cssClasses.mobileLookupInput+"'>";mobilelookupScripTemplate+="<!-- ko if: $data.showItemsByDefault === false -->";mobilelookupScripTemplate+="<input type='text' class='"+cssClasses.inputs+"' data-bind='event: { input: $data.onMobileInput }, hasfocus: $data._lostFocus' />";mobilelookupScripTemplate+="<div class='sklld sklir' data-bind='visible: $data._showLoader, event: { mouseover: $data.onLoaderMouseOver, mouseoverBubble: false }'><\/div>";mobilelookupScripTemplate+="<div class='skllc' data-bind='visible: $data._showClear, click: $data.onClearClick, clickBubble: false, event: { mouseout: $data.onLoaderMouseOut }'><\/div>";mobilelookupScripTemplate+="<div class='skls' data-bind='click: $data.onSearchClick, clickBubble: false'><\/div>";mobilelookupScripTemplate+="<!-- /ko --><\/div>";mobilelookupScripTemplate+="<div class='"+cssClasses.flexContent+" "+cssClasses.flexContainer+" "+cssClasses.flexDirectionRow+" "+cssClasses.flexAlignStretch+" "+cssClasses.contentPosition+"'>";mobilelookupScripTemplate+="<div class='"+cssClasses.scrollableArea+" "+cssClasses.flexContainer+" "+cssClasses.flexDirectionColumn+" "+cssClasses.flexAlignStretch+"'>";mobilelookupScripTemplate+="<div data-bind='foreach: $data._lookupItems'>";mobilelookupScripTemplate+="<div class='"+cssClasses.lookupMobileItems+"' data-bind='click: $parent.onItemClick, clickBubble: false, attr: { title: $data[$parent.displayField] }, text: $data[$parent.displayField]'>";mobilelookupScripTemplate+="<\/div><\/div><\/div><\/div><div class='"+cssClasses.lookupLoadMore+"'><div class='"+cssClasses.lookupLoadmoreText+"' data-bind='text: $data._loadMoreText, click: $data.onLoadMoreClick, clickBubble: false, visible:$data._loadMore'><\/div><div class='"+cssClasses.lookupMobileSelect+"' "+dataAttributes.mobileLookupSelectEnabled+"='0' data-bind='text: $data._lookupSelect, click: $data.onMobileSelect, clickBubble: false'><\/div><\/div>";mobilelookupScripTemplate+="<\/script>";var lookupDiv="<div id="+lookupTemplateDiv+"><\/div><div id="+mobileLookupTemplateDiv+"><\/div>",formsControlLookupTemplateId="FormsControlLookupTemplate",formsControlLookupTemplateDiv="formsControlLookupTemplateDiv",formsControlLookupScripTemplate="<script type='text/html' id="+formsControlLookupTemplateId+">";formsControlLookupScripTemplate+="<div style='overflow:auto;' data-bind='style: { maxHeight: $data._listingMaxHeight() + \"px\" }, foreach: $data._lookupItems'>";formsControlLookupScripTemplate+="<div class='"+cssClasses.formsControlLookupItems+"' data-bind='click: $parent.onItemClick, clickBubble: false, attr: { title: $data[$parent.displayField] }, text: $data[$parent.displayField]'>";formsControlLookupScripTemplate+="<\/div><\/div>";formsControlLookupScripTemplate+="<\/script>";formsControlLookupDiv="<div id="+formsControlLookupTemplateDiv+"><\/div>",function(){function n(n){return typeof n=="undefined"||n==null}n(skelta.logger)&&function(){function t(){skelta.BaseClass.call(this,skelta,"Logger")}var n={Message:"",Line:"",Column:"",File:""};window.onerror=function(i,r,u,f){n.Message="Message: "+i;n.Line="Line: "+u;n.Column="Column: "+f;n.File="File: "+r;t.prototype.logError(n.Message+"\n"+n.Line+"\n"+n.Column+"\n"+n.File)};t.prototype.logContextInformation=function(){if(skelta.utilities.isDebugMode()){var n="----------------------------------------------------------------------------------------------------------------------------------------------------------------",t=skelta.userContext.getAllInformation();this.logInformation(n+"\n"+t+"\tUrl: "+location.href+"\n"+n,!0)}};t.prototype.logInformation=function(n,t){(skelta.utilities.isDebugMode()||t)&&(window.console.log("[i - "+skelta.userContext.getUniqueInformation()+"]\t"+n),skeltaUtils.logMessageToWMLogger(skelta.userContext.getUniqueInformation()+"\t"+n,3,!1))};t.prototype.logWarning=function(n){window.console.warn("[? - "+skelta.userContext.getUniqueInformation()+"]\t"+n);skeltaUtils.logMessageToWMLogger(skelta.userContext.getUniqueInformation()+"\t"+n,2,!1)};t.prototype.logError=function(n){window.console.error("[! - "+skelta.userContext.getUniqueInformation()+"]\t"+n);skeltaUtils.logMessageToWMLogger(skelta.userContext.getUniqueInformation()+"\t"+n,1,!1)};t.prototype.logTime=function(n,t,i){try{if(skelta.utilities.isUndefined(t))return;if(skelta.utilities.isDebugMode()||i){var r=new Date-t;this.logInformation(n+": "+r+"ms",i)}}catch(u){this.logError(n+": Error logging time information - "+u.message)}};skelta.logger=new t}()}(),function(){function n(n){return typeof n=="undefined"||n===null}function t(n){return n===""}n(skelta.utilities)&&function(){function s(n,t){t&&(n.prototype=new t,n.prototype.constructor=n)}function i(){skelta.BaseClass.call(this,skelta,"Utilities")}function u(n){var t=this,i,e,f,o,r,u;if(t.href=n.href,t.protocol=n.protocol,t.hostname=n.hostname,t.port=n.port,t.pathname=n.pathname,t.search=n.search,t.hash=n.hash,t.host=n.host,t.baseURI=n.baseURI,t.protocolLong=n.protocolLong,t.origin=n.origin,i=[],i.parent=t,i.getValue=function(n){for(var i="",r=!1,t=0;t<this.length;t++)if(this[t].key.toLowerCase().trim()===n.toLowerCase().trim()){i=this[t].value;r=!0;break}return r||skelta.logger.logInformation("The parameter '"+n+"' in the uri "+this.parent.href+" not found."),i},!skeltaUtils.isUndefinedNullOrEmpty(t.search)){e=t.search.substr(0,1)=="?"?t.search.substr(1):t.search;f=e.split("&");for(o in f)r=f[o].split("="),u={key:"",value:""},u.key=r[0],r.length>1&&(u.value=decodeURIComponent(r[1].replace(/\+/g," "))),i.push(u)}t.parameters=i}function c(n){var t=n.href.toLowerCase();return n.hash.length>0&&(t=n.href.substring(0,n.href.indexOf("#")).toLowerCase()),t}function f(t){try{if(!n(t)&&!n(t.getClassName)&&typeof t.getClassName=="function")return t.getClassName()}catch(i){r.logError(i.message)}return""}function p(){var n,t,i;e.length<1||(n=e,e=[],t="Ajax call Initiated\n\t\ttype: POST\n\t\tapi: NextGenFormService.aspx/LogMessage\n\t\tasync: true",i="DateTime: "+skelta.forms.utilities.getDateTimeInStringFormat(new Date,"MM/dd/yyyy HH:mm:ss.fff"),n.push({Message:i+"  "+t,LogType:3}),console.log(i+"  "+t),$.ajax({type:"POST",async:!0,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/LogMessage"),data:JSON.stringify({message:n}),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(n){skelta.forms.utilities.addRequestHeaders(n,!0)},error:function(){console.error("Error while logging to WM Logger")}}))}function l(t){function f(){var n="";for(var t in r)r.hasOwnProperty(t)&&(n.length>0&&(n+="&"),n+=t+"="+encodeURIComponent(r[t]));return n}function u(n){var u,t;if(!i.hasMembers())return null;if(n=="post")return JSON.stringify(r);u={};for(t in r)r.hasOwnProperty(t)&&(u[t]=JSON.stringify(r[t]));return u}skelta.BaseClass.call(this,skelta,"JsonRequestHelper");var i=this,r={};i.initialize=function(t){if(i.clearAll(),n(t))return!0;for(var u in t)t.hasOwnProperty(u)&&(r[u]=t[u])};i.clearAll=function(){return r={},i};i.addMember=function(n,t){return r[n]=t,i};i.doesMemberExist=function(n){return r.hasOwnProperty(n)};i.hasMembers=function(){for(var n in r)if(r.hasOwnProperty(n))return!0;return!1};i.removeMember=function(n){return i.DoesMemberExist(n)&&delete r[n],i};i.getValueForGetRequest=function(){return u("get")};i.getValueForPostRequest=function(){return u("post")};i.getValueForQueryString=function(){return f()};i.initialize(t)}function w(){for(var n,i,r,u=[],t=0;t<256;t++){for(n=0,i=t,r=0;r<8;r++)((n^i)&1)!=0?n=n>>>1^40961:n>>>=1,i>>>=1;u[t]=n}return u}function a(n){for(var t,i=[],r=0;r<n.length;r++)t=n.charCodeAt(r),t<128?i.push(t):t<2048?i.push(192|t>>6,128|t&63):t<55296||t>=57344?i.push(224|t>>12,128|t>>6&63,128|t&63):(r++,t=65536+((t&1023)<<10)|n.charCodeAt(r)&1023,i.push(240|t>>18,128|t>>12&63,128|t>>6&63,128|t&63));return i}function o(n){return n.replace(new RegExp("[\\\\\\.\\?\\*\\$\\^\\!\\+\\=\\{\\}\\[\\]\\(\\)\\-\\/\\|\\,\\:]","g"),"\\$&")}var v=new X2JS,y=new X2JS({escapeMode:!1}),r=skelta.logger,e,h;$.ajaxSetup({converters:{"json skeltaJson":function(n){return n&&n.hasOwnProperty("d")?n.d:n}}});s(i,skelta.BaseClass);i.prototype.inheritClass=s;i.prototype.isUndefined=n;i.prototype.isEmpty=t;i.prototype.isDate=function(n){try{return!this.isUndefined(n)&&Object.prototype.toString.call(n)==="[object Date]"}catch(t){return!1}};i.prototype.isString=function(n){return!this.isUndefined(n)&&(typeof n=="string"||n instanceof String)};i.prototype.isBoolean=function(n){return!this.isUndefined(n)&&typeof n=="boolean"};i.prototype.wrapFunction=function(n,t,i){return function(){t.apply(n,i)}};i.prototype.orOperation=function(n,t){return n||t};i.prototype.andOperation=function(n,t){return n&&t};i.prototype.isObject=function(t){return!n(t)&&typeof t=="object"};i.prototype.isArray=function(n){return Object.prototype.toString.apply(n)==="[object Array]"};i.prototype.getJsonPathValue=function(n,t){var i="",u;if(!this.isObject(n)||!this.isString(t))return"";try{u=t.substr(0,1)=="["?"$"+t:"$."+t;i=jsonpath.query(n,u);i===!1||i.length===0?(r.logInformation(skelta.localize.getString("FormsNGF_Json_Value_Not_Found").replace("<@jsonpath@>",t)),i=""):i.length>0&&(i=i[0]);skelta.utilities.isUndefinedNullOrEmpty(i)?i="":!skelta.utilities.isString(i)&&skelta.utilities.isObject(i)?i=JSON.stringify(i):skelta.utilities.isString(i)||(i=i.toString())}catch(f){r.logError(skelta.localize.getString("FormsNGF_Json_Object_Not_Found").replace("<@jsonpath@>",t)+" - "+f.message);i=""}return i};i.prototype.isObjectPresentInArray=function(t,i){if(n(i))return!1;for(var r=0;r<i.length;r++)if(t===i[r])return!0;return!1};i.prototype.doesArrayContainString=function(n,t,i){try{var r=!1;return i=skelta.utilities.isUndefinedNullOrEmpty(i)?"":i.toLowerCase(),$.each(n,function(n,u){var f=skelta.utilities.isUndefinedNullOrEmpty(t)?u:u[t];return f=skelta.utilities.isUndefinedNullOrEmpty(f)?"":f.toLowerCase(),f===i?(r=!0,!1):void 0}),r}catch(u){return skelta.logger.logError("Error while checking array containing string: "+u.message),!1}};i.prototype.getCommaSeparatedStringFromArray=function(n,t,i){return skelta.utilities.getStringFromArray(n,"",",",t,!1,i)};i.prototype.getStringFromArray=function(n,t,i,r,u,f,e){var s="",c="@|!~!|@",p,h,y,v,o,l,a;if(skelta.utilities.isUndefinedNullOrEmpty(i)===!0||skelta.utilities.isArray(n)===!1||n.length<1)return"";r=skelta.utilities.isUndefinedNullOrEmpty(r)===!0?"":r;f=skelta.utilities.isUndefinedNullOrEmpty(f)===!0?"":f;e=skelta.utilities.isUndefinedNullOrEmpty(e)===!0?"":e;u=skelta.utilities.isBoolean(u)===!1?!1:u;p=n.length;h=0;for(y in n)v=n[y],o=skelta.utilities.isUndefinedNullOrEmpty(t)?v:v[t],o=skelta.utilities.isUndefinedNullOrEmpty(o)===!0?"":o,(u===!1||skelta.utilities.isUndefinedNullOrEmpty(o)===!1)&&(h++,o=f+o+e,h>1&&(s+=c),s+=o);return h>1&&skelta.utilities.isUndefinedNullOrEmpty(r)===!1&&(l=s.lastIndexOf(c),l>-1&&(a="",h>2&&(a=i),a+=" "+r+" ",s=s.substring(0,l)+s.substring(l).replaceString(c,a))),s.replaceString(c,i+" ",!1,!0)};i.prototype.moveItemInArray=function(n,t,i){if(i>=n.length)for(var r=i-n.length;r--+1;)n.push(undefined);n.splice(i,0,n.splice(t,1)[0])};i.prototype.parseNumberValue=function(n){var t=0;try{this.isNumber(n)&&(t=Number(n))}catch(i){r.logError(i.message);t=0}return t};i.prototype.isNullOrEmpty=function(n){return t(n)||n===null};i.prototype.isUndefinedNullOrEmpty=function(i){return t(i)||n(i)};i.prototype.hasCDataSection=function(n){return n&&n.substr(0,9)==="<![CDATA["};i.prototype.addCDataSection=function(n){return"<![CDATA["+n+"]\]>"};i.prototype.isNumber=function(n,t){var i=!1;try{t===undefined&&(t=!1);t&&n===""?i=!0:typeof n=="number"?i=!0:this.isUndefinedNullOrEmpty(n)||(i=!isNaN(n))}catch(u){r.logError(u.message)}return i};i.prototype.isValidDateMMddYYYY=function(n){var u;if(!/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(n))return!1;var i=n.split("/"),f=parseInt(i[1],10),r=parseInt(i[0],10),t=parseInt(i[2],10);return t<1e3||t>3e3||r==0||r>12?!1:(u=[31,28,31,30,31,30,31,31,30,31,30,31],(t%400==0||t%100!=0&&t%4==0)&&(u[1]=29),f>0&&f<=u[r-1])};i.prototype.validateTime=function(n){if(!n)return!1;return n.match(/^\s*([01]?\d|2[0-3]):[0-5]\d\s*$/i)||n.match(/^\s*(0?\d|1[0-2]):[0-5]\d(\s+(AM|PM))?\s*$/i)||n.match(/^\s*(0?\d|1[0-2]):[0-5]\d:(AM|PM)\s*$/i)};i.prototype.isMobileDisplayMode=function(t){if(document.body.offsetWidth>800)return!1;if(!n(t)){var i=t.topLevelForm;if(!n(i)&&!n(i.desktopViewOnly)&&i.desktopViewOnly)return!1;if(!n(t.enableResponsiveView))return t.enableResponsiveView===!0||t.enableResponsiveView==="True"}return!0};i.prototype.isDebugMode=function(){try{var t=skelta.userContext.getUserContextFor("debugMode");return n(t)||t?!0:!1}catch(i){return skelta.logger.logInformation("Debug Mode information is not present in the user context for this page."),!1}};i.prototype.getXmlFromJSONObject=function(n){return v.json2xml_str(n)};i.prototype.getJSONObjectFromXml=function(n){return n?y.xml_str2json(n):null};i.prototype.getUrlParameterValue=function(n,t){var i=RegExp("[?&]"+t+"=([^&]*)").exec(n.location.search);return i&&decodeURIComponent(i[1].replace(/\+/g," "))};u.prototype.getParameterValue=function(n){return this.parameters.getValue(n)};u.prototype.getPageNameWithExtension=function(){var n=this.pathname.lastIndexOf("/");return n>-1?this.pathname.substr(n+1):this.pathname};u.prototype.getPageNameWithoutExtension=function(){var n=this.getPageNameWithExtension(),t=n.indexOf(".");return t>-1?n.substr(0,t):n};u.prototype.removeParameter=function(n){var t=-1;$.each(this.parameters,function(i,r){if(r.key==n)return t=i,!1});t>-1&&this.parameters.splice(t,1)};u.prototype.joinParameters=function(n){if(!skelta.utilities.isString(n))return"";var t="";return $.each(this.parameters,function(i,r){t.length>0&&(t+=n);t+=r.key+"="+encodeURIComponent(r.value)}),t};u.prototype.isEqualExceptforHashPart=function(n){if(skeltaUtils.isUndefined(n))return!1;var t=c(this),i=c(n);return t===i};i.prototype.getUriObjectFromWindow=function(n){return skeltaUtils.isUndefinedNullOrEmpty(n)&&(n=window),new u(n.location)};i.prototype.getUriObjectFromString=function(n){var t=document.createElement("a"),i;return t.href=n,i=new u(t),$(t).remove(),i};i.prototype.getUrlString=function(t,i){var r=t,u;return n(i)?r:(u=this.createJsonRequestHelper(i).getValueForQueryString(),u.length>0&&(r+="?"+u),r)};i.prototype.reloadForm=function(){window.location=window.location};i.prototype.createMessageObjectForWorkTasks=function(){return{msgData:"",msgType:"",msgFrom:"",btnId:"",confirmFlag:""}};i.prototype.showAlert=function(n,t,i,r){var u,s;if(skelta.DeviceOS==="WorkTasks"){if(location.href.indexOf("PreviewForm.htm")>-1)return;var f=arguments.length>2?i:t,h=arguments.length>1&&this.isString(arguments[1])?r:!1,e=this.getTextFromHTMLForMessage(arguments.length>1&&this.isString(arguments[1])?t:n),o=this.getTextFromHTMLForMessage(arguments.length>1&&this.isString(arguments[1])?n:"");!this.isUndefined(h)&&h?window.top.showAlertPrompt(o,e,null,!0):$.isFunction(f)?window.top.showAlertPrompt(o,e,function(){$.isFunction(f)&&setTimeout(f,50)}):window.top.showAlertPrompt(o,e)}else arguments.length>1&&this.isString(arguments[1])&&(skelta.DeviceOS==="Web"||this.isUndefined(skelta.DeviceOS))?(u=Array.prototype.slice.call(arguments),u.length>=4&&skelta.utilities.isBoolean(u[3])&&u.splice(3,1),se.ui.messageDialog.showAlert.apply(se.ui.messageDialog,u)):(alert(this.getTextFromHTMLForMessage(arguments.length>1&&this.isString(arguments[1])?t:n)),s=arguments.length>2?i:t,$.isFunction(s)&&s())};i.prototype.getAjaxErrorDetailsMessage=function(n,t){if(this.isUndefined(n))return"";(this.isUndefined(t)||typeof t!="string")&&(t="");var i=n.status+" - "+n.statusText+t;try{i+=errorJSON.Message?errorJSON.Message:n.responseJSON.Message}catch(r){}return i};i.prototype.showError=function(n,t,i,r){var e,u;if(skelta.DeviceOS==="WorkTasks"){if(location.href.indexOf("PreviewForm.htm")>-1)return;var u=arguments.length>2?i:t,f=arguments.length>1&&this.isString(arguments[1])?t:n,o=arguments.length>1&&this.isString(arguments[1])?n:"";arguments.length>3&&this.isString(arguments[3])&&(f+="\n"+r);$.isFunction(u)?window.top.showAlertPrompt(o,f,function(){$.isFunction(u)&&setTimeout(u,50)}):window.top.showAlertPrompt(o,f)}else arguments.length>1&&(skelta.DeviceOS==="Web"||this.isUndefined(skelta.DeviceOS))?se.ui.messageDialog.showError.apply(se.ui.messageDialog,Array.prototype.slice.call(arguments)):(e=arguments.length>1&&this.isString(arguments[1])?t:n,arguments.length>3&&this.isString(arguments[3])&&(e+="\n"+r),alert(this.getTextFromHTMLForMessage(e)),u=arguments.length>2?i:t,$.isFunction(u)&&u())};i.prototype.showConfirmation=i.prototype.showConfirmationAlert=function(n,t,i){var e,u;if(skelta.DeviceOS==="WorkTasks"){if(location.href.indexOf("PreviewForm.htm")>-1)return;var r=arguments.length>2,f=r?i:t,o=this.getTextFromHTMLForMessage(r?n:""),s=this.getTextFromHTMLForMessage(r?t:n);window.top.showConfirmationPrompt(o,s,function(n){$.isFunction(f)&&setTimeout(function(){f(n)},50)})}else skelta.DeviceOS==="Web"||this.isUndefined(skelta.DeviceOS)?se.ui.messageDialog.showConfirmation.apply(se.ui.messageDialog,Array.prototype.slice.call(arguments)):(e=confirm(this.getTextFromHTMLForMessage(arguments.length>2?t:n)),u=arguments.length>2?i:t,$.isFunction(u)&&u(e))};i.prototype.showWarning=function(n,t,i){var e,u;if(skelta.DeviceOS==="WorkTasks"){if(location.href.indexOf("PreviewForm.htm")>-1)return;var r=arguments.length>2,f=r?i:t,o=this.getTextFromHTMLForMessage(r?t:n),s=this.getTextFromHTMLForMessage(r?n:"");window.top.showConfirmationPrompt(s,o,function(n){$.isFunction(f)&&setTimeout(function(){f(n)},50)})}else skelta.DeviceOS==="Web"||this.isUndefined(skelta.DeviceOS)?se.ui.messageDialog.showWarning.apply(se.ui.messageDialog,Array.prototype.slice.call(arguments)):(e=confirm(this.getTextFromHTMLForMessage(arguments.length>2?t:n)),u=arguments.length>2?i:t,$.isFunction(u)&&u(e))};i.prototype.getTextFromHTMLForMessage=function(n){var i="",t=$("<div/>");return t.html(n),t.children("br").after("\n").remove(),i=t.text(),t.remove(),i};i.prototype.getObjectClassName=f;i.prototype.getPromise=function(n,t,i,r,u,e){i=i?i:"GET";u=u?u:"json";r=r?r:"application/json; charset=utf-8";e=e?e:skelta.userContext.getUserContextFor("lookupTimeout")?skelta.userContext.getUserContextFor("lookupTimeout"):skelta.forms.constants.lookupDefaults.lookupTimeout;var o=t;return f(t)==="JsonRequestHelper"&&(o=i==="GET"?t.getValueForGetRequest():t.getValueForPostRequest()),$.ajax({type:i,url:n,timeout:1e3*e,contentType:r,data:o,dataType:u,beforeSend:skelta.forms.utilities.addRequestHeaders})};i.prototype.callServerMethod=function(n,t,i,r,u,e,o,s,h){var l=h===!1?!1:!0,c=r;f(r)=="JsonRequestHelper"&&(c=n=="GET"?r.getValueForGetRequest():r.getValueForPostRequest());$.ajax({async:l,type:n,url:t,contentType:i,data:c,dataType:u,beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(n){e&&typeof e=="function"&&e(n)},error:function(n,t,i){o&&typeof o=="function"&&o(n,t,i)},complete:function(n,t){s&&typeof s=="function"&&s(n,t)}})};i.prototype.requestServer=function(n,t,i,r,u,e,o,s,h,c){var v=h===!1?!1:!0,l=parseInt(c),y=isNaN(l)?50:l,a=r;return f(r)=="JsonRequestHelper"&&(a=n=="GET"?r.getValueForGetRequest():r.getValueForPostRequest()),$.ajax({async:v,type:n,url:t,contentType:i,data:a,dataType:u,timeout:1e3*y,beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(n){e&&typeof e=="function"&&e(n)},error:function(n,t,i){o&&typeof o=="function"&&o(n,t,i)},complete:function(n,t){s&&typeof s=="function"&&s(n,t)}})};i.prototype.requestPromise=function(n,t,i,r,u,e,o){var s=$.Deferred(),l=e===!1?!1:!0,h=parseInt(o),a=isNaN(h)?50:h,c=r;return f(r)=="JsonRequestHelper"&&(c=n=="GET"?r.getValueForGetRequest():r.getValueForPostRequest()),$.ajax({async:l,type:n,url:t,contentType:i,data:c,dataType:u,timeout:1e3*a,beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(n){s.resolve(n)},error:function(n,t,i){s.reject(n,t,i)},complete:function(){}}),s.promise()};i.prototype.encodeHtml=function(n){return $("<textarea/>").text(n).html()};i.prototype.encodeXmlValue=function(n){try{if(n.substr(0,9)=="<![CDATA["&&n.substr(n.length-3,3)=="]\]>")return n}catch(t){return r.logError(t.message),n}return(""+n).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};i.prototype.decodeXmlValue=function(n){return(""+n).replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")};i.prototype.appendCssLink=function(n){var t=$("<link skcssfile='"+n.toLowerCase()+"'>");t.attr({rel:"stylesheet",type:"text/css",href:n});$("head").append(t)};i.prototype.sanitizeHtml=function(n){var i=$("<div/>").html(n),t=skelta.forms.validations.removeTags(n.trim(),["object","iframe"])+" ";return skeltaUtils.isNullOrEmpty(n.trim())||$(i).html().trim().Equals(t.trim())||skeltaUtils.showAlert(document.title,skelta.localize.getString("RichTextControl_UnSupportedTags")),t};i.prototype.closeForm=function(){var t=skelta.DeviceOS,i,r;n(t)&&(t="Web");switch(t){case"WorkTasksPreview":i=$(window.self.top.document).find("#previewOverlayId");i[0].style.visibility="hidden";i[0].style.display="none";break;case"WorkTasks":r=skelta.utilities.createMessageObjectForWorkTasks();r.msgType="closeFormDetailView";window.top.postMessage(JSON.stringify(r),"*");break;default:window.close()}};i.prototype.getCssCompatibility=function(n){var t=document.createElement("x");return(n in t.style)?!0:!1};i.prototype.createJsonRequestHelper=function(n){return new l(n)};i.prototype.getLogger=function(){return r};i.prototype.loadCulture=function(n){var t="js/cultures/kendo.culture."+n+".min.js",i;(this.isUndefined(skelta.DeviceOS)||skelta.DeviceOS==="Web")&&(t=skelta.serverUrl?skelta.serverUrl+t:t);i={dataType:"script",cache:!0,url:t,async:!1};$.ajax(i).done(function(){kendo.culture(n);r.logInformation("Current culture is "+kendo.cultures.current.name)})};i.prototype.removeCdataSection=function(n){var t=n;return skelta.utilities.isUndefinedNullOrEmpty(t)||(t&&t.substr(0,9)==="<![CDATA["&&(t=t.substr(9,t.length)),t&&t.substr(t.length-3,3)==="]\]>"&&(t=t.substr(0,t.length-3))),t};i.prototype.getLoaderObject=function(){var n=(new Spinner).spin();return n.el.style.top="50%",n.el.style.left="50%",n.el};i.prototype.getEncryptedValue=function(n,t){var i=CryptoJS.enc.Utf8.parse(n),r=CryptoJS.enc.Utf8.parse(n),u=CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(t),i,{keySize:16,iv:r,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return""+u};i.prototype.getDecryptedValue=function(n,t){var i=CryptoJS.enc.Utf8.parse(n),r=CryptoJS.enc.Utf8.parse(n),u=CryptoJS.AES.decrypt(t,i,{keySize:16,iv:r,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return u.toString(CryptoJS.enc.Utf8)};e=[];i.prototype.logMessageToWMLogger=function(t,i,r){if(!skelta.forms.utilities.isWorkTasksPro()||skelta.forms.utilities.isWorkTasksProConnectedToInternet()!==!1){var u=parseInt(i);isNaN(u)||u<=0||u>=4||(skelta.forms.utilities.isUndefinedNullOrEmpty(r)&&(t=skelta.userContext.getUniqueInformation()+"\t"+t),e.push({Message:t,LogType:u}),skelta.forms.constants.loggerConstants.enableThrottle&&(n(skelta.forms.utilities.sendLogMessagesThrottleFn)&&(skelta.forms.utilities.sendLogMessagesThrottleFn=skelta.forms.utilities.throttle(p,skelta.forms.constants.loggerConstants.throttleTime,{leading:!1})),skelta.forms.utilities.sendLogMessagesThrottleFn()))}};s(l,skelta.BaseClass);i.prototype.getRequestValidationToken=function(){var n="",t,r,i;try{t=$("input[type='hidden'][name='__RequestVerificationToken']");t.length>0?n=t.val():(r=parent||opener,i=r.document.getElementsByName("__RequestVerificationToken"),i.length>0&&(n=i[0].value))}catch(u){n=""}return n};i.prototype.setRequestVerificationToken=function(n){try{var t=$("input[type='hidden'][name='__RequestVerificationToken']");t.length<1&&$("form").prepend(n)}catch(i){skelta.logger.logError("Error injecting html string")}};h=null;i.prototype.getCRC16BitChecksum=function(t){var e=h||(h=w()),i,u,r,f;if(n(t)||!this.isString(t))return skelta.logger.logInformation("The string is not valid for the checksum generation."),0;for(i=0,u=a(t),r=0;r<u.length;r++)f=(i^u[r])&255,i=i>>>8^e[f];return i.toString()};skelta.utilities=new i;r=skelta.logger;skelta.utilities.isUndefined(String.skHtmlEncode)&&(String.prototype.skHtmlEncode=function(){var t,u,i;try{if(t=this,n(t))return"";for(skelta.utilities.isString(t)||(t=t.toString()),u=[],i=t.length-1;i>=0;i--)u.unshift(["&#",t[i].charCodeAt(),";"].join(""));return u.join("")}catch(f){r.logError(f.message)}return this});skelta.utilities.isUndefined(String.skHtmlDecode)&&(String.prototype.skHtmlDecode=function(){try{return n(htmlStr)?"":(skelta.utilities.isString(htmlStr)||(htmlStr=htmlStr.toString()),htmlStr.replace(/&#(\d+);/g,function(n,t){return String.fromCharCode(t)}))}catch(t){r.logError(t.message)}return this});skelta.utilities.isUndefined(String.replaceString)&&(String.prototype.replaceString=function(t,i,u,f){try{skelta.utilities.isBoolean(u)||(u=!1);skelta.utilities.isBoolean(f)||(f=!1);n(t)?r.logError("'ReplaceString' method's argument 'findStr' needs to be specified."):skelta.utilities.isString(t)||(t=t.toString());n(i)?i="":skelta.utilities.isString(i)||(i=i.toString());i=i.replace(new RegExp(o("$"),"gi"),"$$$$");var e="";return f&&(e+="g"),u||(e+="i"),t=o(t),this.replace(new RegExp(t,e),i)}catch(s){r.logError(s.message)}return this});skelta.utilities.isUndefined(String.startsWithString)&&(String.prototype.startsWithString=function(t,i){try{return n(i)&&(i=!1),t=o(t),new RegExp("^"+t,i?"":"i").test(this)}catch(r){return!1}});skelta.utilities.isUndefined(String.endsWithString)&&(String.prototype.endsWithString=function(t,i){try{return n(i)&&(i=!1),t=o(t),new RegExp(t+"$",i?"":"i").test(this)}catch(r){return!1}});skelta.utilities.isUndefined(String.containsString)&&(String.prototype.containsString=function(t,i){try{return n(i)&&(i=!1),t=o(t),new RegExp(t,i?"":"i").test(this)}catch(r){return!1}});skelta.utilities.isUndefined(String.prototype.trim)&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});skelta.utilities.isUndefined(String.prototype.trimLeft)&&(String.prototype.trimLeft=function(){return this.replace(/^\s+/g,"")});skelta.utilities.isUndefined(String.prototype.trimRight)&&(String.prototype.trimRight=function(){return this.replace(/\s+$/g,"")});skelta.utilities.isUndefined(Object.values)&&(Object.values=function(n){return Object.keys(n).map(function(t){return n[t]})});skelta.utilities.isUndefined(Array.prototype.find)&&Object.defineProperty(Array.prototype,"find",{value:function(n){var i,u,f,t,r;if(this==null)throw new TypeError('"this" is null or not defined');if(i=Object(this),u=i.length>>>0,typeof n!="function")throw new TypeError("predicate must be a function");for(f=arguments[1],t=0;t<u;){if(r=i[t],n.call(f,r,t,i))return r;t++}return undefined},configurable:!0,writable:!0});Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(n){var i,r,u,t,f;if(this==null)throw new TypeError('"this" is null or not defined');if(i=Object(this),r=i.length>>>0,typeof n!="function")throw new TypeError("predicate must be a function");for(u=arguments[1],t=0;t<r;){if(f=i[t],n.call(u,f,t,i))return t;t++}return-1},configurable:!0,writable:!0});Number.prototype.Equals=function(n){return this.valueOf()===n};Number.prototype.DoesNotEquals=function(n){return this.valueOf()!==n};Number.prototype.GreaterThan=function(n){return this.valueOf()>n};Number.prototype.GreaterThanOrEqualTo=function(n){return this.valueOf()>=n};Number.prototype.LesserThan=function(n){return this.valueOf()<n};Number.prototype.LesserThanOrEqualTo=function(n){return this.valueOf()<=n};String.prototype.Equals=function(n){return this.concat()===n};String.prototype.NotEquals=function(n){return this.concat()!==n};String.prototype.Contains=function(n){return this.concat().indexOf(n)>-1};String.prototype.NotContains=function(n){return this.concat().indexOf(n)===-1};String.prototype.BeginsWith=function(n){return this.concat().indexOf(n)===0};String.prototype.DoesNotBeginsWith=function(n){return this.concat().indexOf(n)!==0};String.prototype.EndsWith=function(n){var t=this.concat(),i=t.length-n.length;return t.indexOf(n,i)!==-1};String.prototype.DoesNotEndWith=function(n){var t=this.concat(),i=t.length-n.length;return t.indexOf(n,i)===-1};String.prototype.ContainsData=function(){return this.length!==0};String.prototype.DoesNotContainsData=function(){return this.length===0};Boolean.prototype.True=function(){return this.toString()==="true"};Boolean.prototype.False=function(){return this.toString()==="false"};Date.prototype.On=function(n){return this.equals(n)};Date.prototype.OnOrAfter=function(n){return this.compareTo(n)===1||this.equals(n)};Date.prototype.OnOrBefore=function(n){return this.compareTo(n)===-1||this.equals(n)};Date.prototype.After=function(n){return this.compareTo(n)===1};Date.prototype.Before=function(n){return this.compareTo(n)===-1};Date.prototype.Today=function(n){var t=Date.today(n);return this.equals(t)};Date.prototype.Yesterday=function(n){var t=Date.today(n).addDays(-1);return this.equals(t)};Date.prototype.Tomorrow=function(n){var t=Date.today(n).addDays(1);return this.equals(t)};Date.prototype.ThisWeek=function(n){var t=new Date.parse(Date.today(),n).clearTime(),i=!1,r,u;return t.getMonth()===0?this.getWeek()===t.getWeek()&&(this.getWeek()===52||this.getWeek()===53||this.getWeek()===1?this.getYear()===t.getYear()?i=!0:(r=t,r=r.addYears(-1),this.getYear()===r.getYear()&&(i=!0)):this.getYear()===t.getYear()&&(i=!0)):t.getMonth()===11?this.getWeek()===t.getWeek()&&(this.getWeek()===52||this.getWeek()===53||this.getWeek()===1?this.getYear()===t.getYear()?i=!0:(u=t,u=u.addYears(1),this.getYear()===u.getYear()&&(i=!0)):this.getYear()===t.getYear()&&(i=!0)):this.getWeek()===t.getWeek()&&this.getYear()===t.getYear()&&(i=!0),i};Date.prototype.ThisMonth=function(n){var t=new Date.parse(Date.today(),n).clearTime();return this.getYear()===t.getYear()?this.getMonth()===t.getMonth():!1};Date.prototype.NextMonth=function(n){var t=new Date.parse(Date.today(),n).clearTime();return t=t.addMonths(1),this.getYear()===t.getYear()?this.getMonth()===t.getMonth():!1};Date.prototype.LastMonth=function(n){var t=new Date.parse(Date.today(),n).clearTime();return t=t.addMonths(-1),this.getYear()===t.getYear()?this.getMonth()===t.getMonth():!1};Date.prototype.ThisYear=function(n){var t=new Date.parse(Date.today(),n).clearTime();return this.getYear()===t.getYear()};Date.prototype.NextYear=function(n){var t=new Date.parse(Date.today(),n).clearTime();return t=t.addYears(1),this.getYear()===t.getYear()};Date.prototype.LastYear=function(n){var t=new Date.parse(Date.today(),n).clearTime();return t=t.addYears(-1),this.getYear()===t.getYear()};Date.prototype.NextXYears=function(n,t){var i=Date.today(t).addYears(parseInt(n)),r=Date.today(t).getYear();return!(this.getYear()<=r)&&this.getYear()<=i.getYear()};Date.prototype.LastXYears=function(n,t){var i=Date.today(t).addYears(-parseInt(n)),r=Date.today(t).getYear();return!(this.getYear()>=r)&&this.getYear()>=i.getYear()}}()}(),function(){skelta.utilities.isUndefined(skelta.forms)&&skelta.createNamespace("skelta.forms");skelta.utilities.isUndefined(skelta.forms.utilities)&&function(){function t(){skelta.BaseClass.call(this,skelta.forms,"Utilities")}function ni(n){return typeof n=="object"?typeof Node=="object"?n&&n instanceof Node:n&&typeof n=="object"&&typeof n.nodeType=="number"&&typeof n.nodeName=="string":!1}function ti(n){return typeof n=="object"?typeof HTMLElement=="object"?n&&n instanceof HTMLElement:n&&typeof n=="object"&&n!==null&&n.nodeType===1&&typeof n.nodeName=="string":!1}function ii(n){try{for(var u=0,t=0,i,u=n().length,t=u;t>0;t--)i=n.remove(n()[t]),this.dispose(i),delete i;n.dispose&&typeof n.dispose=="function"&&n.dispose();delete n}catch(f){r.logError(skelta.localize.getString("FormNGFErrorDisposing")+"\n"+f.message)}}function ri(n){try{for(var u=0,t=0,i,u=n.length,t=u;t>0;t--)i=n.pop(),this.dispose(i),delete i;delete n}catch(f){r.logError(skelta.localize.getString("FormNGFErrorDisposing")+"\n"+f.message)}}function b(t){var r=!1,i=t;return n.isUndefined(i)||n.isUndefined(i.isRecordRow)||(r=i.isRecordRow),r}function ui(){var n=window.document.createEvent("UIEvents");n.initUIEvent("resize",!0,!1,window,0);window.dispatchEvent(n)}function fi(n){setTimeout(function(){g(n)},0)}function g(n){n.sourceDetails=n.findByXmlNode("WorkflowWithVersion").value!=""&&n.findByXmlNode("XmlVariableName").value!=""?n.findByXmlNode("WorkflowWithVersion").value+"~"+n.findByXmlNode("XmlVariableName").value+"~"+n.findByXmlNode("Schema").value:""}function ei(t){skelta.utilities.isUndefined(t.readableMappingXml)&&(t.readableMappingXml=ko.computed(function(){var u=t._value(),f="",e="",i,r;if(u!=""&&(f=n.getJSONObjectFromXml(u),i=f.MappingXml.Mapping,skelta.utilities.isArray(i)||(i=[i]),i.length>0))for(r=0;r<i.length;r++)e+=i[r].WorkflowXmlLHS+" = "+i[r].FormXmlRHS+"\n";return e}))}function oi(n,t){var i="",r;return t.ActionType==="1"?(si(n),skelta.utilities.isUndefined(n.topLevelForm)||skelta.utilities.isUndefined(n.topLevelForm.tempControlList)?i=skelta.localize.getString("FormsNGF_MQTT_Topic_List_ControlNotLinked"):(r=n.topLevelForm.tempControlList[t.ControlName],i=skelta.utilities.isUndefined(r)?skelta.localize.getString("FormsNGF_MQTT_Topic_List_ControlNotLinked"):r)):i=skelta.localize.getString("FormsNGF_MQTT_Topic_List_Script"),i+" ~ "+t.TopicName}function si(t){if(skelta.utilities.isUndefined(t.topLevelForm.tempControlList)){var i=skelta.userContext.getUserContextFor("appN"),r=skelta.userContext.getUserContextFor("uId"),u=skelta.userContext.getUserContextFor("vStamp"),f=skelta.userContext.getUserContextFor("itemId"),e=n.createJsonRequestHelper({appName:i,userId:r,versionStamp:u,formItemId:f});n.callServerMethod("GET","NextGenFormService.aspx/GetControlListForMqttTopic","application/json; charset=utf-8",e,"json",function(n){t.topLevelForm.tempControlList=$.parseJSON(n.d)},null,null,!1)}}function hi(n){var t=CryptoJS.lib.WordArray.random(16),i;return n=t+skelta.forms.constants.formPControl.Delimiter+n,i=CryptoJS.SHA256(n),t+skelta.forms.constants.formPControl.Delimiter+i}function nt(n){var t=n,i;return n.containsString(skelta.forms.constants.formPControl.Delimiter)&&(i=n.split(skelta.forms.constants.formPControl.Delimiter),t=i[1]),t}function tt(t,i){var r,u,f,e;if(n.isUndefined(i)||i=="")t.encryptedValue=i;else if(t.value!==i||t.encryptedValue==="")switch(t.securityMode){case 0:t.encryptedValue=i;break;case 1:r=ci(i);t.encryptedValue=r;break;case 2:u=li(i);t.encryptedValue=u;break;case 3:f=ai(i);t.encryptedValue=f;break;case 4:e=hi(i);t.encryptedValue=e}return t.encryptedValue}function ci(t){var u="";n.callServerMethod("GET",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetKeyDataFromServer"),"application/json; charset=utf-8",null,"json",function(n){u=n.d},function(n){r.logError(skelta.localize.getString("FormNGFErrorEncryptionDetails")+"\n"+n.status+"\n"+n.statusText+"\n"+n.responseText)},null,!1);var i=u.split(skelta.forms.constants.formPControl.Delimiter),f=CryptoJS.enc.Utf8.parse(i[1]),e=CryptoJS.enc.Utf8.parse(i[1]),o=CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(t),f,{keySize:16,iv:e,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return i[0]+skelta.forms.constants.formPControl.Delimiter+o}function li(t){var i="",u=n.createJsonRequestHelper({inputText:t});return n.callServerMethod("GET",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetFormTypeEncryptPassword"),"application/json; charset=utf-8",u,"json",function(n){i=n.d},function(n){r.logError(skelta.localize.getString("FormNGFErrorEncryptionDetails")+"\n"+n.status+"\n"+n.statusText+"\n"+n.responseText)},null,!1),i}function ai(t){var i="",u=n.createJsonRequestHelper({inputText:t});return n.callServerMethod("GET",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetSkeltaListTypeEncryptPassword"),"application/json; charset=utf-8",u,"json",function(n){i=n.d},function(n){r.logError(skelta.localize.getString("FormNGFErrorEncryptionDetails")+"\n"+n.status+"\n"+n.statusText+"\n"+n.responseText)},null,!1),i}function it(n,t){return n&&!rt(t)&&!skelta.forms.utilities.isTagLoaded("skjsfile",t,"script")||!n&&!skelta.forms.utilities.isTagLoaded("skjsfile",t,"script")}function h(n){return n.toLowerCase().indexOf("custom/widgets/resources/apis")!==-1&&n.toLowerCase().lastIndexOf("iframeproxy.js")===-1}function rt(n){return!skelta.utilities.isUndefined(skelta.forms.jsFilesCache)&&$.isFunction(skelta.forms.jsFilesCache["_sk_"+n.toLowerCase()])}function ut(n,t){var i=$("<script>");i.text("skelta.forms.jsFilesCache = skelta.forms.jsFilesCache || {}; skelta.forms.jsFilesCache['_sk_"+n.toLowerCase()+"'] = function() {\n"+t+"\n}.bind(window);");$("head").append(i)}function ft(n,t){var i=$("<script skjsfile='"+n.toLowerCase()+"'><\/script>");i.text(t);$("head").append(i)}function c(n){skelta.forms.jsFilesCache["_sk_"+n.toLowerCase()]()}function a(n,t){var i=$("<style skcssfile='"+n.toLowerCase()+"'><\/style>");i.text(t);$("head").append(i)}function vi(){try{var n=ko.applyBindings;ko.applyBindings=function(){skelta.logger.logTime("Injection of view and view model before applying bindings",window.startTimeHtmlInjection,!0);var t=new Date;ko.applyBindings=n;n.apply(ko,arguments);skelta.logger.logTime("Apply bindings for view and view model",t,!0)}}catch(t){skelta.logger.logError("Error overriding the ko applyBinding function for timer injection - "+t.message)}}function yi(){try{var n=$.fn.html;$.fn.html=function(){window.startTimeHtmlInjection=new Date;$.fn.html=n;n.apply(this,arguments);skelta.logger.logTime("Injection of view and view model after applying bindings",window.startTimeHtmlInjection,!0);var t=arguments[0];skelta.logger.logInformation("View and view model length: "+t.length)}}catch(t){skelta.logger.logError("Error overriding the jquery html function for timer injection - "+t.message)}}function et(){var t=n.getUriObjectFromWindow(),i=t.getPageNameWithoutExtension();i!=="FormsDesigner"&&(vi(),yi())}function pi(n,t){var i=null;t.originalEvent&&t.originalEvent.explicitOriginalTarget?i=t.originalEvent.explicitOriginalTarget:t.relatedTarget?i=t.relatedTarget:document.activeElement&&document.activeElement.tagName.toLowerCase()!=="body"&&document.activeElement.tagName.toLowerCase()!=="div"&&(i=document.activeElement);setTimeout(function(){i!==null&&$(i).blur();setTimeout(function(){$(i).focus()},skelta.forms.constants.lookupDefaults.focusInTimeout)},0)}function wi(n,t){var r=n.lookupItems,f=n.valueField,u=-1,i;r.length!==0&&(skelta.utilities.isUndefinedNullOrEmpty(n.highlightedItemValue)||(u=r.findIndex(function(t){return t[f]===n.highlightedItemValue}),i=null,t.originalEvent&&t.originalEvent.explicitOriginalTarget?i=t.originalEvent.explicitOriginalTarget:t.relatedTarget?i=t.relatedTarget:document.activeElement&&document.activeElement.tagName.toLowerCase()!=="body"&&document.activeElement.tagName.toLowerCase()!=="div"&&(i=document.activeElement),setTimeout(function(){i!==null&&$(i).blur();n.onItemClick(r[u],t);setTimeout(function(){$(i).focus()},skelta.forms.constants.lookupDefaults.focusInTimeout+skelta.forms.constants.lookupDefaults.dropDownOpenTimeout)},0)))}function ot(n,t){var i=n.lookupItems,u=n.valueField,r=-1;if(i.length!==0){if(skelta.utilities.isUndefinedNullOrEmpty(n.highlightedItemValue)&&t===1){n.highlightedItemValue=i[0][u];return}if(r=i.findIndex(function(t){return t[u]===n.highlightedItemValue}),r===-1){n.highlightedItemValue=i[0][u];return}(r!==i.length-1||t!==1)&&(r!==0||t!==-1)&&(n.highlightedItemValue=i[r+t][u])}}function st(n,t){var i=SFU.getLookupSchemaAndData(n.value,t,!0,!1),r=[];i.Columns&&i.Columns.length>0&&(r=i.Columns,n.schema=r)}function ht(t,i){var e,u,f,o;extFormParam=t;try{u=null;f=null;n.isUndefined(i.topLevelForm.popupObjectItem.controlSender)?(e=i.topLevelForm.popupObjectItem.formparams,u=i.topLevelForm.popupObjectItem):(e=i.topLevelForm.popupObjectItem.controlSender.formparams,u=i.topLevelForm.popupObjectItem.controlSender,f={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm});(n.isUndefined(u)||u.controlType!=="PopupForm")&&(u=i,f=null);ko.utils.arrayForEach(e,function(n){var t=extFormParam[n.ParameterName],i=u.findById(n.ParameterControl,f);ct(t,n,i)==!0&&(t.value=skelta.forms.utilities.getTypeCastedParameterValue(n.ParameterName,n.ParameterType,i.value))})}catch(s){o=skelta.localize.getString("FormNGFErrorFormParametersFromPopup");n.showError(document.title,o,null,s.message);r.logError(o+"\n"+s.message)}}function ct(t,i,u){var f=!0;return(n.isUndefined(t)||t.Type!=i.ParameterType)&&(r.logWarning(skelta.localize.getString("FormNGFParameterNotFound").replace("@@parameter@@",i.ParameterName)),f=!1),n.isUndefined(u)&&(r.logWarning(skelta.localize.getString("FormNGFParameterMappedControlNotFound").replace("@@parameter@@",i.ParameterName).replace("@@control@@",i.ParameterControl)),f=!1),f}function bi(){return lt(1)}function lt(t){var r="",u=document.getElementById("hdnReportConfiguration"),i,f;return n.isUndefined(u)||(i=u.value,i=="hdnReportConfiguration"||i==""||n.isUndefined(i)||(f=i.split("@~!~@"),r=f[t])),r}function v(t){if(t.FLP&&t.FP){extFormParam=t.FP;var i=n.getJSONObjectFromXml(t.FLP),u=!Array.isArray(i.FormParameters.Parameter)&&typeof i.FormParameters.Parameter=="object"?[i.FormParameters.Parameter]:i.FormParameters.Parameter;ko.utils.arrayForEach(u,function(n){var t=extFormParam[n.Name];t&&t.Type===n.Type?n.Value&&(extFormParam[n.Name].value=skelta.forms.utilities.getTypeCastedParameterValue(n.Name,n.Type,n.Value)):r.logWarning(skelta.localize.getString("FormNGFParameterNotFound").replace("@@parameter@@",n.Name))})}}function ki(t){var i=JSON.parse(t.d);if(i.IsSuccess===!1)n.showAlert(document.title,i.ErrorMessage,function(){f()}),skelta.forms.utilities.pageLoadComplete("");else{if(o(i),document.title=skelta.localize.getString("FormPopupFormTitle"),isOpenedInNewWindow)try{n.isUndefined(window.opener)||window.opener.addEventListener("beforeunload",f)}catch(r){}di(isStagingViewAndViewModel)}}function di(t){var u=skelta.userContext.getUserContextFor("fName"),f=skelta.userContext.getUserContextFor("vStamp"),i=null,r;typeof popupObjectInstance=="undefined"||n.isUndefined(popupObjectInstance)||(n.isUndefined(popupObjectInstance.templateObject)||popupObjectInstance.templateObject.controlType!=="PopupForm"?popupObjectInstance.controlType==="PopupForm"&&(i=popupObjectInstance):i=popupObjectInstance.templateObject);u===""&&f===""&&i.persistFormDefinition===!0?(r=n.createJsonRequestHelper({applicationName:skelta.userContext.getUserContextFor("appN"),userId:skelta.userContext.getUserContextFor("uId"),listName:skelta.userContext.getUserContextFor("listName"),deviceType:skelta.DeviceOS,parentItemId:parentItemId,controlid:popupControlId,isStaging:t,formDefinitionString:i.formDefinitionString}),n.callServerMethod("POST","NextGenFormService.aspx/GetViewAndViewModelForPopupFormFromFormDefinition","application/json; charset=utf-8",r,"json",at,vt,y,!1)):(r=n.createJsonRequestHelper({applicationName:skelta.userContext.getUserContextFor("appN"),userId:skelta.userContext.getUserContextFor("uId"),formName:u,versionStamp:f,listName:skelta.userContext.getUserContextFor("listName"),deviceType:skelta.DeviceOS,isStaging:t}),n.callServerMethod("GET","NextGenFormService.aspx/GetViewAndViewModelForPopupForm","application/json; charset=utf-8",r,"json",at,vt,y,!1))}function at(t){var s,u,a,e,o,p,h;try{var i=JSON.parse(t.d),w=i.IsSuccess,v=i.Result,b=i.Status,c=i.ItemId?i.ItemId:"",y=skelta.userContext.getUserContextFor("appN"),l=i.VersionStamp?i.VersionStamp:"",k=skelta.userContext.getUserContextFor("fName");if(skelta.userContext.setUserContextFor("itemId",c),skelta.userContext.setUserContextFor("vStamp",l),w==="false"||isStagingViewAndViewModel===!1&&b==="Draft"||v===""){n.showError(document.title,skelta.localize.getString("FormNGFLoadViewAndViewModelPopup"),function(){f()});return}n.isUndefinedNullOrEmpty(i.FormParameters)||nr(JSON.parse(i.FormParameters));s="";s=c==""&&k===""&&l===""?skelta.forms.utilities.getFormUniqueKey(y,parentItemId+"_"+popupControlId,popupControlId):skelta.forms.utilities.getFormUniqueKey(y,c,l);isOpenedInNewWindow==!1&&(u=popupObjectInstance.controlSender,n.isUndefined(u)||(a=u.persistValue,n.isUndefined(a)||a!==!0||(e="",e=n.isUndefined(u.value)||n.isUndefined(u.value.__text)?u.value:u.value.__text,n.isUndefinedNullOrEmpty(e)||(e.DoesNotBeginsWith("<")&&(e=n.decodeXmlValue(e)),o=n.getJSONObjectFromXml(e),p=n.isUndefined(o)?o:o[Object.keys(o)[0]],n.isUndefinedNullOrEmpty(p)||(skelta.forms.utilities.createDataModelObject(s),skelta.forms.utilities.setDataModelObject(s,o))))));$("#viewModel").html(v);h=skelta.forms.utilities.getViewModelObject(s);h.onSave.subscribeEvent(yt);h.onCancel.subscribeEvent(f);$("#viewModel")[0].style.display="";h.topLevelForm.initializeFocus(0);skelta.forms.delay.loader.scrollEventHandler();skelta.logger.logTime("Form load time",window.skeltaFormLoadStartTime,!0)}catch(d){n.showError(document.title,skelta.localize.getString("FormNGFLoadViewAndViewModelPopup"));r.logError(skelta.localize.getString("FormNGFLoadViewAndViewModelPopup")+"\n"+d.message)}}function vt(t){n.showError(document.title,skelta.localize.getString("FormNGFLoadViewAndViewModelPopup"),function(){f()});r.logError(skelta.localize.getString("FormNGFLoadViewAndViewModelPopup")+"\n"+t.status+"\n"+t.statusText+"\n"+t.responseText)}function y(){if(!n.isUndefined(popupObjectInstance.controlSender)){var t=popupObjectInstance.controlSender;t.loaderIconState("0")}}function gi(){n.isUndefined(popupObjectInstance)||(y(),f())}function nr(t){try{var u,i=null,f=null;extFormParam=t.FP;n.isUndefined(parentViewModel.topLevelForm.popupObjectItem.controlSender)?(u=parentViewModel.topLevelForm.popupObjectItem.formparams,i=parentViewModel.topLevelForm.popupObjectItem):(u=parentViewModel.topLevelForm.popupObjectItem.controlSender.formparams,i=parentViewModel.topLevelForm.popupObjectItem.controlSender,f={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm});(n.isUndefined(i)||i.controlType!=="PopupForm")&&(i=parentViewModel,f=null);ko.utils.arrayForEach(u,function(n){var t=extFormParam[n.ParameterName],r=i.findById(n.ParameterControl,f);ct(t,n,r)==!0&&(t.value=skelta.forms.utilities.getTypeCastedParameterValue(n.ParameterName,n.ParameterType,r.value))})}catch(e){n.showError(document.title,skelta.localize.getString("FormNGFErrorFormParametersFromPopup"));r.logError(skelta.localize.getString("FormNGFErrorFormParametersFromPopup")+" - "+e.message)}}function yt(t){if(isOpenedInNewWindow===!1){var i=n.getXmlFromJSONObject(t.instanceXml);i=n.encodeXmlValue(i);popupObjectInstance.selectedValue=i;popupObjectInstance.eventType("submit");popupObjectInstance.state("close")}else window.close()}function f(){isOpenedInNewWindow===!1?(popupObjectInstance.eventType("cancel"),popupObjectInstance.state("close")):(window.opener.removeEventListener("beforeunload",f),window.close())}function tr(t){var i=JSON.parse(t.d),u,r;if(i.IsSuccess===!1)return n.showAlert(document.title,i.ErrorMessage,function(){window.close()}),!1;o(i);document.title=skelta.localize.getString("FormNGFPreviewFormTitle");$("#viewModel").html(i.ViewAndViewModel);u=skelta.forms.utilities.getFormUniqueKey(i.ApplicationName,i.FormId,i.FormVersion);r=skelta.forms.utilities.getViewModelObject(u);r.onSave.subscribeEvent(ir);r.onCancel.subscribeEvent(n.closeForm);skelta.localize.divTextLocalize();skelta.localize.divTitleLocalize();$("#viewModel")[0].style.display="";r.topLevelForm.initializeFocus(0);skelta.forms.delay.loader.scrollEventHandler();skelta.logger.logTime("Form load time",window.skeltaFormLoadStartTime,!0)}function e(t){n.showError(document.title,skelta.localize.getString("FormNGFInitializeFormFailed"),function(){gi()});skelta.logger.logError(skelta.localize.getString("FormNGFInitializeFormFailed")+" - "+t.status+" "+t.statusText+" "+t.responseText);skelta.forms.utilities.hideLoader()}function ir(n){window.sessionStorage.setItem("currentInstanceXML",n.InstanceJSON);var i=screen.width-screen.width/100*40,t=screen.height-screen.height/100*40,r=screen.width/2-(screen.width-screen.width/100*40)/2,u=screen.height/2-t/2;window.open("InstanceXML.htm","instancexml","directories=no,titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no,height="+t+",width="+i+", , top="+u+", left="+r+"");skelta.forms.utilities.hideLoader()}function o(t){var i,r;skelta.userContext.setUserContextFor("appN",t.ApplicationName);skelta.userContext.setUserContextFor("uId",decodeURIComponent(t.LoggedInUserId));skelta.userContext.setUserContextFor("fName",t.FormName);skelta.userContext.setUserContextFor("vStamp",t.FormVersion);skelta.userContext.setUserContextFor("itemId",t.FormId);skelta.userContext.setUserContextFor("listName",t.ListName?t.ListName:"Forms List");i=t.PageDefaults;skelta.userContext.setUserContextFor("debugMode",t.PageDefaults.DebugMode==="TRUE");skelta.userContext.setUserContextFor("PageInstanceID",t.PageDefaults.PageInstanceID);skelta.forms.utilities.savePageDefaultsInLocalStotage(i);skelta.userContext.setUserContextFor("culture",i.Culture);skelta.userContext.setUserContextFor("themePath",i.ThemePath);skelta.userContext.setUserContextFor("customThemePathForNextGenForm",i.CustomThemePathForNextGenForm);r=skelta.userContext.getUserContextFor("lastModifiedLocaleTime");r!=i.LastModifiedLocaleTime&&(skelta.forms.utilities.saveLocalesInLocalStotage(i,i.Culture),skelta.userContext.setUserContextFor("lastModifiedLocaleTime",i.LastModifiedLocaleTime));skelta.localize.localizeMessageDialog();skelta.utilities.setRequestVerificationToken(i.AFT);skelta.userContext.setUserContextFor("vId",i.VirtualActorId);skelta.userContext.setUserContextFor("lookupTimeout",i.LookupTimeout);skelta.userContext.setUserContextFor("serverUtcOffset",n.parseNumberValue(i.ServerUTCOffset));skelta.userContext.setUserContextFor("attachmentMaximumLimit",i.AttachmentMaximumLimit);skelta.logger.logContextInformation();et();n.loadCulture(skelta.userContext.getUserContextFor("culture"));skelta.forms.utilities.loadPageStyles(skelta.userContext.getUserContextFor("themePath"))}function rr(t){var i=JSON.parse(t.d);if(i.IsSuccess===!1)return n.showAlert(document.title,i.ErrorMessage),skelta.forms.utilities.pageLoadComplete(""),!1;o(i);document.title=skelta.localize.getString("FormNGFInstanceFormTitle");p(ur,fr,i.InstanceXml,i.FormLinkParameters)}function p(t,i,r,u){var f=n.createJsonRequestHelper({applicationName:skelta.userContext.getUserContextFor("appN"),userId:skelta.userContext.getUserContextFor("uId"),formName:skelta.userContext.getUserContextFor("fName"),versionStamp:skelta.userContext.getUserContextFor("vStamp"),listName:skelta.userContext.getUserContextFor("listName"),deviceType:skelta.DeviceOS});n.callServerMethod("GET",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetViewAndViewModel"),"application/json; charset=utf-8",f,"json",function(n){t(n,r,u)},i,function(){skelta.forms.utilities.pageLoadComplete("")})}function ur(t,i,r){var f=JSON.parse(t.d),s=skelta.userContext.getUserContextFor("appN"),h=skelta.userContext.getUserContextFor("itemId"),c=skelta.userContext.getUserContextFor("vStamp"),e=skelta.forms.utilities.getFormUniqueKey(s,h,c),l=n.getUrlParameterValue(window,"FromIntouch")==="True",a=n.getUrlParameterValue(window,"GKey"),o,u;l!==!0||n.isUndefined(a)||(skelta.forms.utilities.createDataModelObject(e),skelta.forms.utilities.setDataModelObject(e,n.getJSONObjectFromXml(i)));n.isUndefinedNullOrEmpty(f.FormParameters)||n.isUndefinedNullOrEmpty(r)||(o={FLP:r,FP:JSON.parse(f.FormParameters)},v(o));$("#viewModel").html(f.ViewAndViewModel);u=skelta.forms.utilities.getViewModelObject(e);u.onSave.subscribeEvent(pt);window.name.containsString("WebPartManagerControl")==!0||window.frameElement!=null&&window.frameElement.id.containsString("WebPartManagerControl")==!0?u.onCancel.subscribeEvent(n.reloadForm):u.onCancel.subscribeEvent(n.closeForm);skelta.localize.divTextLocalize();skelta.localize.divTitleLocalize();$("#viewModel")[0].style.display="";u.topLevelForm.initializeFocus(0);skelta.forms.delay.loader.scrollEventHandler();skelta.logger.logTime("Form load time",window.skeltaFormLoadStartTime,!0)}function fr(t){var u=skelta.userContext.getUserContextFor("appN"),f=skelta.userContext.getUserContextFor("fName"),e=skelta.userContext.getUserContextFor("vStamp"),i=skelta.localize.getString("FormNGFFillFormAjaxFailed").replace("<@paramApplicationName@>",u).replace("<@paramFormName@>",f).replace("<@paramVersionStamp@>",e);n.showError(document.title,i);r.logError(i+" - "+t.status+" - "+t.statusText+" - "+t.responseText)}function pt(t){var r=skelta.utilities.getUriObjectFromWindow(),i;if(!skelta.utilities.isUndefinedNullOrEmpty(r.getParameterValue(WW_IFRAME_PARAMETERNAME_FORMUNIQUEID))){skelta.forms.utilities.hideLoader();return}i=skelta.forms.utilities.throttle(function(){var i=n.getXmlFromJSONObject(t.instanceXml);if(skelta.forms.utilities.isWorkTasksPro())window.top.submitInstanceForm(i);else{var r=n.getUrlParameterValue(window,"fillFormTestRun"),u=n.isUndefined(r)==!0?"":r,f=skelta.userContext.getUserContextFor("appN"),e=skelta.userContext.getUserContextFor("uId"),o=skelta.userContext.getUserContextFor("fName"),s=skelta.userContext.getUserContextFor("vStamp"),h=skelta.userContext.getUserContextFor("listName"),c=n.createJsonRequestHelper({xmlInstance:i,applicationName:f,userId:e,formName:o,versionStamp:s,listName:h,deviceType:skelta.DeviceOS,fillFormTestRun:u});n.callServerMethod("POST",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/InvokeFillForm"),"application/json; charset=utf-8",c,"json",er,or,null)}},1e3,{leading:!1});i()}function er(t){function u(t){n.getUrlParameterValue(window,"FromArchestrA")==="True"||n.getUrlParameterValue(window,"FromIntouch")==="True"||window.name.containsString("WebPartManagerControl")==!0||window.frameElement!=null&&window.frameElement.id.containsString("WebPartManagerControl")==!0||window.frameElement!=null&&window.frameElement.id.containsString("Skelta_FillForm")===!0||window.frameElement!=null&&window.frameElement.ownerDocument&&window.frameElement.ownerDocument.URL.containsString("InstanceFormAsDashboard.aspx")==!0||window.frameElement!=null&&window.frameElement.id.containsString("DashboardLinkIFrame")===!0?n.reloadForm():t&&n.closeForm(skelta.DeviceOS)}var i=$.parseJSON(t.d),f,e;i.IsSuccess===!0?(f=n.getUrlParameterValue(window,"fillFormTestRun"),f||i.SyncMode===!0?i.RedirectLocation===null||i.RedirectLocation===undefined||i.RedirectLocation===""?(r.logError(skelta.localize.getString("FormRedirectionUrlErrorMessage")),n.showError(document.title,skelta.localize.getString("FormRedirectionUrlErrorMessage"),function(){n.closeForm()})):location.href=i.RedirectLocation:(r.logInformation(i.Result),e=n.getUrlParameterValue(window,"DisplayAlert")!=="False",e?n.showAlert(document.title,i.Result,function(){u(!0)},!0):u(!0))):(r.logError(i.ErrorMessage),n.showError(document.title,i.ErrorMessage,function(){u(!1)}),skelta.forms.utilities.hideLoader())}function or(t){var u=skelta.userContext.getUserContextFor("appN"),f=skelta.userContext.getUserContextFor("fName"),e=skelta.userContext.getUserContextFor("vStamp"),i=skelta.localize.getString("FormNGFSubmissionFormAjaxFailed").replace("<@paramApplicationName@>",u).replace("<@paramFormName@>",f).replace("<@paramVersionStamp@>",e);n.showError(document.title,i);r.logError(i+" - "+t.status+" - "+t.statusText+" - "+t.responseText)}function sr(t){var u=JSON.parse(t.d);if(u.IsSuccess===!1)return n.showAlert(document.title,u.ErrorMessage),skelta.forms.utilities.pageLoadComplete(""),!1;o(u);document.title=skelta.localize.getString("FormInvokeFormTitle");var r=$.parseJSON(u.Result),f=r.wfName,e=r.channelName,s=r.workItemId,a=r.virActorId,h=r.formType,c=r.maximizeOnLoad,l=r.closeOnSaveAsDraft,i=u.WorkItemDetails;skelta.userContext.setUserContextFor("wfName",f);skelta.userContext.setUserContextFor("channel",e);skelta.userContext.setUserContextFor("fType",h);skelta.userContext.setUserContextFor("workitemId",s);skelta.userContext.setUserContextFor("closeOnSaveAsDraft",l);skelta.userContext.setUserContextFor("maximizeOnLoad",c);window.paramExeDetailId=r.exeDetailId;window.paramGroupMode=r.groupMode;window.paramEnableHold=r.enableHold;window.paramEnableMoveNextPreviousWorkItem=r.enableMoveNextPreviousWorkItem;window.paramEnableAutoMoveWorkItem=r.enableAutoMoveWorkItem;i.SM&&i.SM.toLowerCase()=="true"&&i.EV.toLowerCase()=="yes"?(i.FH=parseInt(i.FH),i.FH=i.FH<=30?i.FH+20:i.FH,$("#manageWorkItemDiv").css("height",i.FH+"px"),$("#manageWorkItem").css("height",i.FH+"px"),$(".mainBody").css("top",i.FH+"px"),$("#manageWorkItem").attr("src","../WorkItemList/ManageWorkItem.aspx?wisuri="+n.getUrlParameterValue(window,"wisuri"))):($("#manageWorkItemDiv").css("display","none"),$(".mainBody").css("top","0"));i.CD===!0?($(".mainBody").attr("data-skfc","2"),$("#customDocument").attr("src","../WorkItemList/InvokeFormDocumentView.aspx?wisuri="+n.getUrlParameterValue(window,"wisuri"))):($("#customDocumentWrapper").css("display","none"),$(".mainBody").attr("data-skfc","1"));p(hr,wt,u.InstanceXml)}function hr(t,i){var u,f=$.parseJSON(i),a=$.parseJSON(t.d),h,c,l,o;if(f.IsSuccess===!0){var v=skelta.userContext.getUserContextFor("appN"),s=skelta.userContext.getUserContextFor("itemId"),y=skelta.userContext.getUserContextFor("vStamp"),e=skelta.forms.utilities.getFormUniqueKey(v,s,y);if(skelta.forms.utilities.createDataModelObject(e),skelta.forms.utilities.setDataModelObject(e,n.getJSONObjectFromXml(f.Result)),window.extFormParam=$.parseJSON(f.FormParameters),$("#viewModel").html(a.ViewAndViewModel),u=skelta.forms.utilities.getViewModelObject(e),n.isUndefined(u)){skelta.logger.logInformation("View and view model length: "+t.length);h=skelta.localize.getString("F_500");n.showError(document.title,h);c=skelta.localize.getString("F_501");l=c.replace("<@vmId@>",e).replace("<@frmId@>",s);r.logError(l);return}u.onSave.subscribeEvent(bt);u.onSaveAsDraft.subscribeEvent(lr);n.isUndefined(n.getUrlParameterValue(window,"openInIframe"))||n.getUrlParameterValue(window,"openInIframe")!=="yes"?n.isUndefined(window.parent)||n.isUndefined(window.parent.closeRadWindow)?u.onCancel.subscribeEvent(n.closeForm):u.onCancel.subscribeEvent(function(){window.parent.closeRadWindow()}):u.onCancel.subscribeEvent(n.reloadForm);f.ShowSaveAsDraftButton&&u.findById("NF1SaveAsDraftButton")._visible(!0);n.isUndefined(f.CollaborationModeResponseXPath)||f.CollaborationModeResponseXPath===""||u.NF1.makeReadOnlyForCollaborationMode(f.CollaborationModeResponseXPath);o=skelta.userContext.getUserContextFor("maximizeOnLoad");o&&o==="True"&&cr();skelta.localize.divTextLocalize();skelta.localize.divTitleLocalize();$("#viewModel")[0].style.display="";u.topLevelForm.initializeFocus(0);skelta.forms.delay.loader.scrollEventHandler();skelta.logger.logTime("Form load time",window.skeltaFormLoadStartTime,!0)}else n.showError(document.title,f.ErrorMessage),r.logError(f.ErrorMessage)}function cr(){try{window.top.moveTo(0,0);window.top.resizeTo(screen.availWidth,screen.availHeight)}catch(n){}}function wt(t){var u=skelta.userContext.getUserContextFor("appN"),f=skelta.userContext.getUserContextFor("fName"),e=skelta.userContext.getUserContextFor("vStamp"),i=skelta.localize.getString("FormNGFViewFormPageError").replace("<@applicationName@>",u).replace("<@formName@>",f).replace("<@formVersion@>",e);n.showError(document.title,i);r.logError(i+"\n"+n.getAjaxErrorDetailsMessage(t,"\n"));skelta.forms.utilities.pageLoadComplete("")}function lr(t,i){var r=skelta.forms.utilities.throttle(function(){var f=n.getXmlFromJSONObject(t.instanceXml),r=i.buttonText,u;n.isUndefined(r)&&(r="");n.isUndefined(window.extFormParam)&&(window.extFormParam={});u=n.createJsonRequestHelper({xmlInstance:f,clickedButtonText:r,applicationName:skelta.userContext.getUserContextFor("appN"),formName:skelta.userContext.getUserContextFor("fName"),wfName:skelta.userContext.getUserContextFor("wfName"),channelName:skelta.userContext.getUserContextFor("channel"),workItemId:skelta.userContext.getUserContextFor("workitemId"),virActorId:skelta.userContext.getUserContextFor("vId"),formType:skelta.userContext.getUserContextFor("fType"),isFromSaveAsDraftLink:!0,userId:skelta.userContext.getUserContextFor("uId"),formsParameters:window.extFormParam,formVersion:skelta.userContext.getUserContextFor("vStamp")});n.callServerMethod("POST",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/SubmitInvokeFormWorkItem"),"application/json; charset=utf-8",u,"json",ar,vr,skelta.forms.utilities.hideLoader)},1e3,{leading:!1});r()}function ar(t){var u=$.parseJSON(t.d),f,e,i;if(u.IsSuccess===!0)try{f=skelta.userContext.getUserContextFor("closeOnSaveAsDraft");e=skelta.localize.getString("FormNGFSaveAsDraftSuccess");n.showAlert(document.title,e,function(){n.isUndefined(f)||f!=="True"||s()});function s(){n.isUndefined(n.getUrlParameterValue(window,"openInIframe"))&&n.closeForm()}}catch(o){i=skelta.localize.getString("FormNGFSaveAsDraftFailure");n.showError(document.title,i,null,o.message);r.logError(i+"\n"+o.message)}else i=skelta.localize.getString("FormNGFSaveAsDraftFailure"),n.showError(document.title,i,null,u.ErrorMessage),r.logError(i+"\n"+u.ErrorMessage)}function vr(t){var i=skelta.localize.getString("FormNGFSaveAsDraftFailure");n.showError(document.title,i);r.logError(i+"\n"+n.getAjaxErrorDetailsMessage(t,"\n"))}function bt(t,i){var r=skelta.forms.utilities.throttle(function(){var u=n.getXmlFromJSONObject(t.instanceXml),r=i.buttonText,f;n.isUndefined(r)&&(r="");n.isUndefined(window.extFormParam)&&(window.extFormParam={});skelta.forms.utilities.isWorkTasksPro()?window.top.submitInstanceForm(u,r):(f=n.createJsonRequestHelper({xmlInstance:u,clickedButtonText:r,applicationName:skelta.userContext.getUserContextFor("appN"),formName:skelta.userContext.getUserContextFor("fName"),wfName:skelta.userContext.getUserContextFor("wfName"),channelName:skelta.userContext.getUserContextFor("channel"),workItemId:skelta.userContext.getUserContextFor("workitemId"),virActorId:skelta.userContext.getUserContextFor("vId"),formType:skelta.userContext.getUserContextFor("fType"),isFromSaveAsDraftLink:!1,userId:skelta.userContext.getUserContextFor("uId"),formsParameters:window.extFormParam,formVersion:skelta.userContext.getUserContextFor("vStamp")}),n.callServerMethod("POST",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/SubmitInvokeFormWorkItem"),"application/json; charset=utf-8",f,"json",yr,pr,skelta.forms.utilities.hideLoader))},1e3,{leading:!1});r()}function yr(t){var i=$.parseJSON(t.d),u;if(i.IsSuccess===!0)try{if(skelta.DeviceOS==="WorkTasks")u=skelta.utilities.createMessageObjectForWorkTasks(),u.msgType="closeFormDetailView",window.top.postMessage(JSON.stringify(u),"*");else if(n.isUndefined(n.getUrlParameterValue(window,"openInIframe")))n.isUndefined(window.parent.opener)?n.isUndefined(i.Result)||i.Result===""?window.RefreshGridwithoutCloseLocal():(n.showAlert(document.title,i.Result,function(){window.RefreshGridwithoutCloseLocal()}),r.logInformation(i.Result)):i.SyncMode===!0?i.RedirectLocation===null||i.RedirectLocation===undefined||i.RedirectLocation===""?(n.showError(document.title,skelta.localize.getString("FormRedirectionUrlErrorMessage"),function(){n.closeForm();l(i,window.paramEnableAutoMoveWorkItem,window,n)}),r.logError(skelta.localize.getString("FormRedirectionUrlErrorMessage"))):(location.href=i.RedirectLocation,l(i,window.paramEnableAutoMoveWorkItem,window,n)):n.isUndefined(i.Result)||i.Result===""?l(i,window.paramEnableAutoMoveWorkItem,window,n):(n.showAlert(document.title,i.Result,function(){l(i,window.paramEnableAutoMoveWorkItem,window,n)}),r.logInformation(i.Result));else if(n.getUrlParameterValue(window,"openInIframe")==="yes"){if(i.SyncMode===!0)location.href=i.RedirectLocation+"&openInIframe=yes";else if(n.isUndefined(i.Result)||i.Result==="")location.href="about:blank";else{n.showAlert(document.title,i.Result,function(){location.href="about:blank";window.parent.top.RefreshGridwithoutclose()});r.logInformation(i.Result);return}window.parent.top.RefreshGridwithoutclose()}}catch(f){r.logError(f);n.isUndefined(window.parent.opener)?window.close():window.parent.close()}else n.showError(document.title,i.ErrorMessage),r.logError(i.ErrorMessage)}function l(n,t,i,r){n.SyncMode===!0||t=="true"?i.parent.RefreshGridwithoutclose?i.parent.RefreshGridwithoutclose():i.parent.opener.window.RefreshGridwithoutclose&&i.parent.opener.window.RefreshGridwithoutclose():(i.parent.RefreshGrid?i.parent.RefreshGrid():i.parent.opener.window.RefreshGrid&&i.parent.opener.window.RefreshGrid(),r.closeForm(),location.href="about:blank")}function pr(t){var u=skelta.userContext.getUserContextFor("appN"),f=skelta.userContext.getUserContextFor("fName"),e=skelta.userContext.getUserContextFor("vStamp"),i=skelta.localize.getString("FormNGFWorkItemSubmitError").replace("<@applicationName@>",u).replace("<@formName@>",f).replace("<@formVersion@>",e).replace("@execuitonDtlsId@>",window.paramExeDetailId);n.showError(document.title,i);r.logError(i+"\n"+n.getAjaxErrorDetailsMessage(t,"\n"))}function wr(t){var r=JSON.parse(t.d);if(r.IsSuccess===!1)return n.showAlert(document.title,r.ErrorMessage),skelta.forms.utilities.pageLoadComplete(""),!1;o(r);document.title=skelta.localize.getString("FormNGFViewFormTitle");var i=$.parseJSON(r.Result),e=i.wfName,f=i.channelName,s=i.workItemId,h=i.virActorId,u=i.formType;f==="MobileWorkList"&&(u="Mobile "+u);window.paramExeDetailId=i.exeDetailId;window.paramGroupMode=i.groupMode;window.paramEnableHold=i.enableHold;window.paramEnableMoveNextPreviousWorkItem=i.enableMoveNextPreviousWorkItem;window.paramEnableAutoMoveWorkItem=i.enableAutoMoveWorkItem;window.paramExecutionId=i.execId;window.forStartActivity=i.startAct;p(br,wt,r.InstanceXml)}function br(t,i){var f,u=$.parseJSON(i),o=$.parseJSON(t.d);if(u.IsSuccess===!0){var s=skelta.userContext.getUserContextFor("appN"),h=skelta.userContext.getUserContextFor("itemId"),c=skelta.userContext.getUserContextFor("vStamp"),e=skelta.forms.utilities.getFormUniqueKey(s,h,c);skelta.forms.utilities.createDataModelObject(e);skelta.forms.utilities.setDataModelObject(e,n.getJSONObjectFromXml(u.Result));window.extFormParam=$.parseJSON(u.FormParameters);$("#viewModel").html(o.ViewAndViewModel);f=skelta.forms.utilities.getViewModelObject(e);f.NF1._readEditAddBehaviour(1);$(":focus").blur();$("."+cssClasses.sfFooter).hide();$("."+cssClasses.sfHeader).hide();skelta.localize.divTextLocalize();skelta.localize.divTitleLocalize();$("#viewModel")[0].style.display="";f.topLevelForm.initializeFocus(0);skelta.forms.delay.loader.scrollEventHandler();skelta.logger.logTime("Form load time",window.skeltaFormLoadStartTime,!0)}else n.showError(document.title,u.ErrorMessage),r.logError(u.ErrorMessage)}function kr(t){var i=JSON.parse(t.d),r,f;if(i.IsSuccess===!1)return n.showError(document.title,i.ErrorMessage),skelta.forms.utilities.pageLoadComplete(""),!1;if(o(i),window.openInViewMode=!1,window.mode=="Edit")document.title=skelta.localize.getString("DynamicEdit"),kt($.parseJSON(i.InstanceXml).Result);else if(window.mode=="View")document.title=skelta.localize.getString("DynamicView"),window.openInViewMode=!0,kt($.parseJSON(i.InstanceXml).Result);else{if(document.title=skelta.localize.getString("DynamicNew"),i.ViewAndViewModel==""){skelta.forms.utilities.hideLoader();r=skelta.localize.getString("FormNGFListFormNotPublished");r=r.replaceString("\\n","<br>",!0,!0);n.showError(document.title,r,function(){s()});return}$("#viewModel").html(i.ViewAndViewModel);var e=skelta.userContext.getUserContextFor("appN"),h=skelta.userContext.getUserContextFor("itemId"),c=skelta.userContext.getUserContextFor("vStamp"),l=skelta.forms.utilities.getFormUniqueKey(e,h,c),u=skelta.forms.utilities.getViewModelObject(l);u.onSave.subscribeEvent(dt);u.onCancel.subscribeEvent(gt);$("#viewModel")[0].style.display="";u.topLevelForm.initializeFocus(0);skelta.forms.utilities.hideLoader()}f=w();f&&f.set_title(document.title)}function kt(t){var i=n.createJsonRequestHelper({lcsuri:window.paramlcsuri});n.callServerMethod("GET","NextGenFormService.aspx/GetListEditFormDefinition","application/json; charset=utf-8",i,"html",function(n){dr(n,t)},gr,function(){skelta.forms.utilities.pageLoadComplete("")})}function dr(t,i){var f;try{if(n.isUndefinedNullOrEmpty(t)){f=skelta.localize.getString("FormNGFListFormNotPublished").replaceString("\\n","<br>",!0,!0);n.showError(document.title,f,function(){s()});return}if(t==="error"){n.showError(document.title,skelta.localize.getString("FormNGFDynamicFormLoadError"),function(){s()});return}var o=skelta.userContext.getUserContextFor("appN"),h=skelta.userContext.getUserContextFor("itemId"),c=skelta.userContext.getUserContextFor("vStamp"),u=skelta.forms.utilities.getFormUniqueKey(o,h,c);skelta.forms.utilities.createDataModelObject(u);skelta.forms.utilities.setDataModelObject(u,n.getJSONObjectFromXml(i));$("#viewModel").html(t);viewModelObject=skelta.forms.utilities.getViewModelObject(u);window.openInViewMode==!0&&(viewModelObject.NF1._readEditAddBehaviour(1),$("."+cssClasses.sfFooter).hide());viewModelObject.onSave.subscribeEvent(dt);viewModelObject.onCancel.subscribeEvent(gt);skelta.localize.divTextLocalize();skelta.localize.divTitleLocalize();$("#viewModel")[0].style.display="";viewModelObject.topLevelForm.initializeFocus(0)}catch(e){n.showError(document.title,skelta.localize.getString("FormNGFDynamicFormInstanceXmlError"),function(){s()},e.message);r.logError(skelta.localize.getString("FormNGFDynamicFormInstanceXmlError")+"\n"+e.message)}}function gr(t){n.showError(document.title,skelta.localize.getString("FormNGFDynamicFormLoadError"));r.logError(skelta.localize.getString("FormNGFDynamicFormLoadError")+"\n"+t.status+"\n"+t.statusText+"\n"+t.responseText)}function dt(t){var i=n.getXmlFromJSONObject(t.instanceXml),r=n.createJsonRequestHelper({pageOpenMode:window.mode,xmlInstance:i,lcsuri:window.paramlcsuri});n.callServerMethod("POST","NextGenFormService.aspx/SaveListItem","application/json; charset=utf-8",r,"json",nu,tu,null)}function nu(t){var i=$.parseJSON(t.d);if(i.IsSuccess===!0){s();return}n.showError(document.title,i.ErrorMessage);skelta.forms.utilities.hideLoader()}function tu(t){n.showError(document.title,skelta.localize.getString("FormNGFDynamicFormSaveError"));r.logError(skelta.localize.getString("FormNGFDynamicFormSaveError")+"\n"+t.status+"\n"+t.statusText+"\n"+t.responseText);skelta.forms.utilities.hideLoader()}function s(){var n=w();if(n!=null){try{parent.document.getElementById("mainframe").contentWindow.document.getElementById("gridframe").contentWindow.RefreshGrid()}catch(t){}n.hide()}else window.opener.location.reload(),window.close()}function gt(){var n=w();n!=null&&n.hide()}function w(){var n=null;return window.radWindow?n=window.radWindow:window.frameElement&&(window.frameElement.radWindow?n=window.frameElement.radWindow:window.location.reload()),n}function u(){skelta.BaseClass.call(this,skelta.forms,"UI")}var n=skelta.utilities,r=n.getLogger();skelta.utilities.inheritClass(t,skelta.utilities.constructor);t.prototype.defineSetterAndGetter=function(n,t,i){Object.defineProperty(n,t,{get:function(){return i?n["_"+t]():n["_"+t]},set:function(r){i?n["_"+t](r):n["_"+t]=r},enumerable:!0,configurable:!0})};t.prototype.initializeAngularControl=function(n){n.controlObject.topLevelForm.isFormLoaded.peek()===!0&&n.controlObject.dataContainerForm._isLoaded.peek()===!0?n.initializerFn(n):n.controlObject.topLevelForm.isFormLoaded.peek()===!1?n.controlObject.topLevelForm.isFormLoaded.subscribe(function(t){t===!0&&(n.controlObject.dataContainerForm._isLoaded.peek()===!0?n.initializerFn(n):n.controlObject.dataContainerForm._isLoaded.subscribe(function(t){t===!0&&n.initializerFn(n)}))}):n.controlObject.dataContainerForm._isLoaded.subscribe(function(t){t===!0&&n.initializerFn(n)})};t.prototype.initializeWidgetControl=function(n){n.initializerFn(n)};t.prototype.isWorkTasksPro=function(){return skelta.DeviceOS==="WorkTasks"};t.prototype.isWorkTasksProConnectedToInternet=function(){return window.top.isConnectedToInternet};t.prototype.isWorkTasksProOfflineSupportEnabled=function(){return window.top.isOfflineSupportEnabled};t.prototype.showWorkTasksProAccountErrorMessage=function(){if(window.top){var n=window.top.showAccountErrorMessage;n&&typeof n=="function"&&n()}};t.prototype.updateFormHeaderForWorkTasksPro=function(n){if(this.isWorkTasksPro()){var t=window.top.setFormHeader;this.isUndefinedNullOrEmpty(n)===!1&&this.isUndefined(t)===!1&&typeof t=="function"&&t(n)}};t.prototype.addRequestHeaders=function(t,i){var u,f,e,o,s,h;if(!n.isUndefined(this.url)&&i!==!0){var c=this.url.indexOf("?"),l=c<0?this.url:this.url.substring(0,c),r="Ajax call Initiated";r+="\n\t\t type: "+this.type;r+="\n\t\t api: "+l;r+="\n\t\t async: "+this.async.toString();skelta.logger.logInformation(r)}u=skelta.userContext.getUserContextFor("authenticationToken");n.isUndefinedNullOrEmpty(u)||t.setRequestHeader("Authentication",u);f=skelta.userContext.getUserContextFor("skSasToken");n.isUndefinedNullOrEmpty(f)||t.setRequestHeader("Authorization",f);skelta.forms.utilities.isWorkTasksPro()?(e=window.top.identityClientAccessToken,n.isUndefinedNullOrEmpty(e)||t.setRequestHeader("AccessToken",e),o=window.top.isAvevaConnect,n.isUndefinedNullOrEmpty(o)||t.setRequestHeader("IsAvevaConnect",o),s=window.top.isAzureActiveDirectory,n.isUndefinedNullOrEmpty(s)||t.setRequestHeader("IsAzureActiveDirectory",s)):t.setRequestHeader("__RequestVerificationToken",skelta.utilities.getRequestValidationToken());n.isDebugMode()&&(h=skelta.userContext.getUserContextFor("PageInstanceID"),n.isUndefinedNullOrEmpty(h)||t.setRequestHeader("SKPageInstanceID",h))};t.prototype.getClassForTag=function(n){return n()===0?"sf-span":n()===1?"sf-spanmandatory":"sf-spanerror"};t.prototype.boolOrOperation=function(n,t){return n||t};t.prototype.boolAndOperation=function(n,t){return n&&t};t.prototype.readEditAddBehaviourAndOperation=function(n,t,i){if(n===4)return 0;if(n==1||t==1)return 1;if(t==0)return n;if(t==2){if(n==0)return i?0:1;if(n==2)return i?2:1}return 1};t.prototype.logErrorWithAlert=function(n){this.showError(skelta.localize.getString("FormNGFPrintFormErrorTitle"),n);r.logError(n)};t.prototype.disposeAndDelete=function(n){try{n.dispose&&typeof n.dispose=="function"&&n.dispose();delete n}catch(t){r.logError(skelta.localize.getString("FormNGFErrorDisposing")+"\n"+t.message)}};t.prototype.dispose=function(n){var i,u,e,t,f;try{if(this.isUndefined(n))return;if(ko.isComputed(n))n.dispose&&typeof n.dispose=="function"&&n.dispose();else if(ko.isObservable(n))n.removeAll?ii.call(this,n):(this.dispose(ko.utils.peekObservable(n)),n.dispose&&typeof n.dispose=="function"&&n.dispose());else if(this.isArray(n))ri.call(this,n);else if(!ni(n)&&!ti(n)&&typeof n=="object"&&(i=Object.getOwnPropertyNames(n),i.length>0))for(e=i.length,t="",u=e;u>0;u--)t=i[u-1],n.propertyIsEnumerable(t)&&($.inArray(t,skelta.forms.constants.exclusionsFromDispose)>-1?delete n[t]:(f=Object.getOwnPropertyDescriptor(n,t),f.get||f.set?delete n[t]:(this.dispose(n[t]),delete n[t])));delete n}catch(o){r.logError(skelta.localize.getString("FormNGFErrorDisposing")+"\n"+o.message)}};t.prototype.getControlUniqueKey=function(n){for(var f=this.getFormUniqueKey(),t=n.dataContainerForm,r=n.associatedForm,u=f+"_"+n.id,i;t!==null;){if(u+="_"+t.id+"_"+t.records.indexOf(r),this.isUndefined(t.parentForm))break;i=t.parentForm;t=i.dataContainerForm;r=i.associatedForm}return u};t.prototype.reassertWidgetPropertiesAndEvents=function(n,t,i,r,u){var f=skelta.forms.utilities,e=n.findById("WidgetProperty"),o=n.findById("WidgetScript"),s;if(t!=="Form"&&(f.isUndefinedNullOrEmpty(i)||f.isUndefined(widgets))||t==="Form"&&f.isUndefinedNullOrEmpty(r)){e.removeAll();o.removeAll();return}if(t!=="Form"){if(s=widgets[i],f.isUndefined(s)){e.removeAll();o.removeAll();return}this.reassertWidgetProperties(e,s);this.reassertWidgetScripts(o,s)}else o.removeAll(),this.reassertWidgetFormSourceParameters(r,e,u)};t.prototype.reassertWidgetFormSourceParameters=function(n,t,i){var u=skelta.forms.utilities,f=n,e,o,s;if(u.isUndefinedNullOrEmpty(f)){t.removeAll();return}e=function(n){var r=$.parseJSON(n.d);r.IsSuccess===!0?(u.reassertWidgetProperties(t,r.WidgetDetails),u.isUndefinedNullOrEmpty(r.InformationMessage)||i!==!0||u.showAlert(document.title,u.encodeHtml(r.InformationMessage))):(u.showError(document.title,r.ErrorMessage),t.removeAll());u.pageLoadComplete("")};o=function(n,i,f){u.showError(document.title,skelta.localize.getString("FormWidgetError_FormParametersFetch_Unknown"),null,f);r.logError(f);t.removeAll();u.pageLoadComplete("")};u.showLoader();s=u.createJsonRequestHelper({formDetails:f,applicationName:skelta.userContext.getUserContextFor("appN")});u.callServerMethod("POST","NextGenFormService.aspx/GetWidgetDetailsFromFormParameters","application/json; charset=utf-8",s,"json",e,o,null)};t.prototype.reassertWidgetProperties=function(n,t){var r=skelta.forms.utilities,i=this.retrievePropertiesFromUI(n),f,s,u,e,o;if(i.length===1&&r.isUndefinedNullOrEmpty(i[0].Name)?(n.removeAll(),i=[]):n.removeAll(),!r.isUndefined(t.PropertiesAndEvents)&&!r.isUndefined(t.PropertiesAndEvents.PropertyOrder)){f=t.PropertiesAndEvents.PropertyOrder;for(s in f)u=f[s],e="",r.isUndefinedNullOrEmpty(i[u])||(e=i[u]),o=n.addRecord(),o.findByXmlNode("@Name").value=u,o.findByXmlNode("@Value").value=e}};t.prototype.retrievePropertiesFromUI=function(n){var i={},r=n.records(),u,t;for(u in r)t=r[u],i[t.findByXmlNode("@Name").value]=t.findByXmlNode("@Value").value;return i};t.prototype.reassertWidgetScripts=function(n,t){var u=skelta.forms.utilities,r=this.retrieveScriptsFromUI(n),e,h,i,o,s,f;if(r.length===1&&u.isUndefinedNullOrEmpty(r[0].Name)?(n.removeAll(),r=[]):n.removeAll(),!u.isUndefined(t.PropertiesAndEvents)&&!u.isUndefined(t.PropertiesAndEvents.EventOrder)){e=t.PropertiesAndEvents.EventOrder;for(h in e)i=e[h],o="",u.isUndefinedNullOrEmpty(r[i])||(o=r[i]),s=n.addRecord(),s.findByXmlNode("@Name").value=i,f=s.findByXmlNode("Value"),f.value=o,f.eventName=i,f.eventDisplayNameKey="FormWidget_"+n.findByXmlNode("WidgetName")._value.peek().toUpperCase()+"_Script_"+i.toUpperCase()}};t.prototype.retrieveScriptsFromUI=function(n){var i={},r=n.records(),u,t;for(u in r)t=r[u],i[t.findByXmlNode("@Name").value]=t.findByXmlNode("Value").value;return i};t.prototype.getOptionsForWidgetConfigurationsDropdown=function(n,t,i){var r=[],h=n.findByXmlNode("WidgetName").value,c=widgets[h],f,o,e,s,u;if(!this.isUndefined(c)&&(f=c.ConfigurationNames,!this.isUndefined(f))){o=!1;for(e in f)o||(r.push({Name:"",DisplayName:t}),o=!0),s="FormWidget_"+h.toUpperCase()+"_ConfName_"+f[e].toUpperCase(),u=skelta.localize.getString(s),u=u===s?e:u,r.push({Name:e,DisplayName:u})}return r.length===0&&r.push({Name:"",DisplayName:i}),r};t.prototype.isWidgetConfigurationValid=function(n,t){var u=n.findByXmlNode("WidgetName").value,i,r;return n.topLevelForm.onFormLoad===!0?!0:this.isUndefinedNullOrEmpty(t)||this.isUndefinedNullOrEmpty(u)||this.isUndefined(widgets)?!1:(i=widgets[u],!this.isUndefined(i)&&(r=i.ConfigurationNames,!this.isUndefined(r)&&!this.isUndefined(r[t])))?!0:!1};t.prototype.isWidgetNameValid=function(n,t){var r=t,i,u;return n.topLevelForm.onFormLoad===!0?!0:this.isUndefinedNullOrEmpty(t)||this.isUndefinedNullOrEmpty(r)||this.isUndefined(widgets)?!1:(i=widgets[r],!this.isUndefined(i)&&(u=i.ConfigurationNames,!this.isUndefined(u)))?!0:!1};t.prototype.getIdDisplayValueFromMultimodeControlIdString=function(t){if(n.isUndefinedNullOrEmpty(t))return"";var i=t.split("|");return i.join(".")};t.prototype.getControlFromMultimodeControlIdString=function(t,i){if(n.isUndefined(t)||n.isUndefinedNullOrEmpty(i))return null;var r=null,u=i.split("|"),f={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm,parentContainerTraversalValidation:skelta.forms.controls.findFunctions.isNotEmbeddedForm};return $.each(u,function(n,i){if(r=t.findById(i,f),skelta.utilities.isUndefined(r))return!1;u.length!=n+1&&(t=r)}),r};t.prototype.isRecordRow=b;t.prototype.getFormUniqueKey=function(n,t,i){skelta.utilities.isUndefined(n)&&(n=skelta.userContext.getUserContextFor("appN"),t=skelta.userContext.getUserContextFor("itemId"),i=skelta.userContext.getUserContextFor("vStamp"));var r=n+"_"+t+"_"+i;return r=r.replace(/ /g,"_"),r.replace(/[^a-zA-Z0-9_]/g,"_")};t.prototype.triggerResizeEvent=function(n){skelta.forms.utilities.isMobileDisplayMode(n)||(skelta.utilities.isUndefined(skelta.forms.utilities.sendResizeEventThrottleFn)&&(skelta.forms.utilities.sendResizeEventThrottleFn=skelta.forms.utilities.throttle(ui,skelta.forms.constants.triggerResizeEventConstants.throttleTime,{leading:!1})),skelta.forms.utilities.sendResizeEventThrottleFn())};t.prototype.getButtonTextFromEvent=function(n){var i,t,r,u,e,f;if(this.isWorkTasksPro()&&!skelta.utilities.isUndefinedNullOrEmpty(window.top.clickedButtonText))return window.top.clickedButtonText;if(skelta.utilities.isUndefined(n)||(i=n.target||event.srcElement||event.target,skelta.utilities.isUndefined(i)))return"";if(t=i.getAttribute(dataAttributes.buttonText),skelta.utilities.isUndefined(t)&&(r=null,r=i.tagName.toUpperCase()==="BUTTON"?i.childNodes:$(i).parent()[0].childNodes,!skelta.utilities.isUndefined(r)&&r.length>0))for(u=0;u<r.length;u++)if(e=r[u],f=e.getAttribute(dataAttributes.buttonText),!skelta.utilities.isUndefined(f)){t=f;break}return skelta.utilities.isUndefined(t)||(t=t.replace(/\&at;/g,"@")),t};t.prototype.getViewModelObject=function(n){return window["viewModelObject_"+n]};t.prototype.getDataModelObject=function(n){return window["dataModel_"+n]};t.prototype.createDataModelObject=function(n){window["dataModel_"+n]=undefined};t.prototype.setDataModelObject=function(n,t){window["dataModel_"+n]=t};t.prototype.getServerUrl=function(t){var r=skelta.userContext.getUserContextFor("skSasToken"),i;return n.isUndefinedNullOrEmpty(skelta.serverUrl)?t:n.isUndefinedNullOrEmpty(r)?skelta.serverUrl+t:(i=skelta.serverUrl+t,n.isUndefinedNullOrEmpty(i)||i.indexOf("?")!==-1?i+"&sb-token="+encodeURIComponent(r):i+"?sb-token="+encodeURIComponent(r))};t.prototype.setAttributesToForm=function(t,i){var r,f,u,e;try{if(b(t)){if(!n.isUndefined(i)){r=[];for(f in i)i.hasOwnProperty(f)&&f.indexOf("__",0)!==0&&f.indexOf("_",0)===0&&r.push(f.substring(1));if(t.Attributes=null,r.length>0)for(u=0,e=r.length,t.Attributes={}||t.Attributes,u=0;u<e;u++)t.Attributes[r[u]]=i["_"+r[u]]}t._isBindedToUI&&t._isBindedToUI(!0)}}catch(o){}};t.prototype.soaMethod=t.prototype.SOAMethod=function(t,i,u,f,e){var o,s=skelta.userContext.getUserContextFor("appN"),h=skelta.userContext.getUserContextFor("uId"),c=n.createJsonRequestHelper({applicationName:s,userId:h,nameOftheAssembly:t,nameSpaceWithClassName:i,methodToExec:u,inputParameters:f,deviceType:"Web"});return $.ajax({type:"POST",async:!1,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/InvokeSOAMethod"),contentType:"application/json; charset=utf-8",data:c.getValueForPostRequest(),dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(n){o=n},error:function(t){e?(n.showError(skelta.localize.getString("FormNGFErrorSOAMethodTitle"),skelta.localize.getString("FormNGFErrorSOAMethodExecution")),r.logError(skelta.localize.getString("FormNGFErrorSOAMethodExecution")+"\n"+t.status+"\n"+t.statusText+"\n"+t.responseText)):(n.showError(skelta.localize.getString("FormNGFErrorSOAMethodTitle"),skelta.localize.getString("FormNGFErrorSOAMethodTimeout")),r.logError(skelta.localize.getString("FormNGFErrorSOAMethodTimeout")))}}),$.parseJSON(o.d)};t.prototype.getVirtualRoleId=function(t){var u,i,o,f,e;try{if(u=skelta.userContext.getUserContextFor("appN"),i="",!n.isUndefined(t)&&t!==""&&!n.isUndefined(u)&&u!==""){if(o=n.createJsonRequestHelper({roleId:t,appName:u}),f=skelta.userContext.getUserContextFor("virtualRoleId_"+t),!n.isUndefinedNullOrEmpty(f))return f;e=n.requestPromise("GET",skelta.forms.utilities.getServerUrl("UserLookup.aspx/GetVirtualRoleId"),"application/json; charset=utf-8",o,"json",!1,skelta.userContext.getUserContextFor("lookupTimeout"));e.done(function(u){i=$.parseJSON(u.d);n.isUndefined(i.vId)||n.isUndefined(i.rId)||i.rId!==t?(r.logError(skelta.localize.getString("ErrorFormNGFGetVirtualRoleId")),i=""):(skelta.userContext.setUserContextFor("virtualRoleId_"+t,i.vId),i=i.vId)});e.fail(function(){r.logError(skelta.localize.getString("ErrorFormNGFGetVirtualRoleId"))})}return i}catch(s){return r.logError(skelta.localize.getString("ErrorFormNGFGetVirtualRoleId")),""}};t.prototype.getVirtualActorId=function(t){var f,u,i,o,e;try{return(skelta.utilities.isUndefined(t)&&(t=skelta.userContext.getUserContextFor("uId")),f=skelta.userContext.getUserContextFor("userlookupVirtualActorId_"+t),!n.isUndefinedNullOrEmpty(f))?f:(u=skelta.userContext.getUserContextFor("appN"),i="",n.isUndefined(t)||t===""||n.isUndefined(u)||u===""||(o=n.createJsonRequestHelper({userId:t,appName:u}),e=n.requestPromise("GET",skelta.forms.utilities.getServerUrl("UserLookup.aspx/GetVirtualActorId"),"application/json; charset=utf-8",o,"json",!1,skelta.userContext.getUserContextFor("lookupTimeout")),e.done(function(u){i=$.parseJSON(u.d);n.isUndefined(i.vId)||n.isUndefined(i.uId)||i.uId!==t?(r.logError(skelta.localize.getString("ErrorFormNGFGetVirtualActorId")),i=""):(skelta.userContext.setUserContextFor("userlookupVirtualActorId_"+t,i.vId),i=i.vId)}),e.fail(function(){r.logError(skelta.localize.getString("ErrorFormNGFGetVirtualActorId"))})),i)}catch(s){return r.logError(skelta.localize.getString("ErrorFormNGFGetVirtualActorId")),""}};t.prototype.getServerUtcOffset=function(){try{var t=skelta.userContext.getUserContextFor("serverUtcOffset");return skelta.utilities.isUndefined(t)&&($.ajax({type:"GET",async:!1,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetServerUTCOffset"),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(n){t=$.parseJSON(n.d)},error:function(){n.showError(document.title,skelta.localize.getString("FormNGFErrorGetServerUtcOffset"));r.logError(skelta.localize.getString("FormNGFErrorGetServerUtcOffset"))}}),skelta.userContext.setUserContextFor("serverUtcOffset",t)),t}catch(i){return r.logError(skelta.localize.getString("FormNGFErrorGetServerUtcOffset")),""}};t.prototype.userLookupValueHandler=function(t,i){return n.isUndefinedNullOrEmpty(i)?!n.isUndefined(t.showDefaultUser)&&t.showDefaultUser===!0?skelta.userContext.getUserContextFor("vId"):"":i};t.prototype.validateUserInESignature=function(t,i){var r=null,u=skelta.userContext.getUserContextFor("appN"),f=skelta.userContext.getUserContextFor("uId"),e=n.createJsonRequestHelper({userName:t,password:i,appName:u,userId:f});return n.callServerMethod("GET",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/ValidateUserInESignature"),"application/json; charset=utf-8",e,"json",function(n){r=$.parseJSON(n.d)},function(){r=null},null,!1),r};t.prototype.getDisplayTextForESign=function(){var i=skelta.userContext.getUserContextFor("vId"),u=skelta.userContext.getUserContextFor("appN"),f=n.createJsonRequestHelper({virtualId:i,applicationName:u}),t;return $.ajax({type:"POST",async:!1,url:skelta.forms.utilities.getServerUrl("UserLookup.aspx/GetDisplayTextForESign"),data:f.getValueForPostRequest(),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(n){t=$.parseJSON(n.d)},error:function(){r.logError(skelta.localize.getString("FormNGFGetDisplayText"))}}),t};t.prototype.getDisplayTextForUL=function(t){var u=skelta.userContext.getUserContextFor("userlookupDisplay_"+t),f,e,i;return n.isUndefinedNullOrEmpty(u)?(f=skelta.userContext.getUserContextFor("appN"),e=n.createJsonRequestHelper({virtualId:t,applicationName:f}),$.ajax({type:"GET",async:!1,url:skelta.forms.utilities.getServerUrl("UserLookup.aspx/GetDisplayText"),data:e.getValueForGetRequest(),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(n){i=$.parseJSON(n.d);skelta.userContext.setUserContextFor("userlookupDisplay_"+t,i)},error:function(){var i=skelta.localize.getString("FormNGFGetDisplayTextErrorUserNotFound").replaceString("<@userid@>",t);n.showError(document.title,i);r.logError(i)}}),i):u};t.prototype.getRoleNameForRL=function(t){var u=skelta.userContext.getUserContextFor("roleName_"+t),f,e,i;return n.isUndefinedNullOrEmpty(u)?(f=skelta.userContext.getUserContextFor("appN"),e=n.createJsonRequestHelper({virtualId:t,applicationName:f}),$.ajax({type:"GET",async:!1,url:skelta.forms.utilities.getServerUrl("UserLookup.aspx/GetRoleName"),data:e.getValueForGetRequest(),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(n){i=$.parseJSON(n.d);skelta.userContext.setUserContextFor("roleName_"+t,i)},error:function(){var i=skelta.localize.getString("FormNGFGetDisplayTextErrorRoleNotFound").replaceString("<@roleid@>",t);n.showError(document.title,i);r.logError(i)}}),i):u};t.prototype.isControlInNewMode=function(t){var i,r;try{if(i=t.associatedForm,n.isUndefined(i.isNewRecord))for(r=t.dataContainerForm;n.isUndefined(i.isNewRecord)&&!r.isTopLevelForm;)i=r.parentForm.associatedForm,r=r.parentForm.dataContainerForm;return i.isNewRecord}catch(u){return!1}};t.prototype.setNumberCulture=function(t){var u,e;kendo.cultures[t.culture]=$.extend(!0,{},kendo.cultures.current);kendo.cultures[t.culture].name=t.culture;t.pattern!=""&&(kendo.cultures[t.culture].numberFormat.pattern=[t.pattern]);var r=parseInt(t.decimals),i=t.groupSizes,f=t.showGroupSeparator?t.groupSeparator:"";if(!isNaN(r)&&r>=0&&(kendo.cultures[t.culture].numberFormat.decimals=r),t.decimalSeparator!=""&&(kendo.cultures[t.culture].numberFormat["."]=t.decimalSeparator),t.showGroupSeparator&&f==""||(kendo.cultures[t.culture].numberFormat[","]=f),!n.isUndefinedNullOrEmpty(i)&&n.isArray(i)&&i.length>0){u=[];for(e in i)u.push(n.parseNumberValue(i[e]));kendo.cultures[t.culture].numberFormat.groupSize=u}};t.prototype.setErrorBindingProperty=function(n){n.control.validationError=ko.observable(!1);n.control.validationErrorMessage=ko.observable("");n.control.validationErrorCode=ko.observable(errorConstants.None)};t.prototype.tabEventHandler=function(n){var t=n.control;t[n.event]=function(){if(t.controlType==="Tab"&&!skelta.utilities.isUndefined(t.topLevelForm.onFormLoad)&&t.topLevelForm.onFormLoad===!1){var i=t.getParentTabsContainerControl(),r=i.getIndexOfTabControl(t);i.selectTab(r)}t.topLevelForm.popupDiv.show(n.controlType,t,n.callBack,n.viewModel,n.viewTemplate,n.data,n.formKey)}};t.prototype.popupEventHandler=function(n){n.control[n.event]=function(){n.control.topLevelForm.popupDiv.show(n.controlType,n.control,n.callBack,n.viewModel,n.viewTemplate,n.data,n.formKey)}};t.prototype.closeBaseFormMobileView=function(n,t){var i=$("#templateDiv_"+n+""),r=function(n,t){n.empty();n.attr("class","");n.attr("style","");n.attr("data-bind","");!skelta.utilities.isUndefined(t)&&$.isFunction(t)&&t()};ko.cleanNode(i[0]);this.resetIframeControls(i,function(){r(i,t)})};t.prototype.resetIframeControls=function(n,t){var u;if((skelta.utilities.isUndefined(t)||!$.isFunction(t))&&(t=function(){}),skelta.utilities.isUndefined(n)){t();return}var r=0,u=null,f=!1,i=n.find("iframe");i.length>0?(r=i.length,i.off(),$.each(i,function(n,e){if(skelta.utilities.isUndefinedNullOrEmpty(e.src)||e.src.trim()==""||e.src.trim().toLowerCase()=="about:blank")r-=1;else{e.onload=function(){};$(e).off("load");$(e).off();$(e).on("load",function(){f||(r-=1,r<1&&(clearTimeout(u),u=null,i.off(),t()))});e.src="about:blank"}}),u=setTimeout(function(){f=!0;i.off();t()},1e3)):t()};t.prototype.setControlValue=function(t){var i,r;t.eventType()==="submit"&&(i=t.controlSender.controlType,i==="UserLookUp"?t.controlSender.value=skelta.forms.utilities.getVirtualActorId(t.selectedValue):i==="RoleLookUp"&&(t.controlSender.value=skelta.forms.utilities.getVirtualRoleId(t.selectedValue)),r=t.controlSender.domElement,n.isUndefined(r)||r.focus())};t.prototype.setPopUpControlValue=function(t){var i,r,u,f;t.eventType()==="submit"&&(i=t.controlSender,i.persistValue===!0&&(r=t.selectedValue,r!==""?(u=n.getJSONObjectFromXml(n.decodeXmlValue(r)),f=Object.keys(u)[0],i.extendedInformation=u[f]):i.extendedInformation=null,i.value=r),skelta.forms.utilities.hideLoader())};t.prototype.subscribeAndExecute=function(n){var t;n.ct._value.subscribe(function(n){t=n},n.ct,"beforeChange");n.ct._value.subscribe(function(){n.ct.topLevelForm.isFormLoaded()!==!0||skelta.utilities.isUndefined(n.ct.topLevelForm.onFormLoad)||n.ct.topLevelForm.onFormLoad!==!1||n.ct.executeScriptWithoutEval(n.ct._value,n.fn,t)})};t.prototype.getEventLookUpComputedValue=function(n){return ko.computed(function(){var t=n.value;return t&&t.substr(0,9)=="<![CDATA["&&(t=t.substr(9,t.length)),t&&t.substr(t.length-3,3)=="]\]>"&&(t=t.substr(0,t.length-3)),t})};t.prototype.now=Date.now||function(){return(new Date).getTime()};t.prototype.throttle=function(n,t,i){var r,u,o,f=null,e=0,s;return i||(i={}),s=function(){e=i.leading===!1?0:skelta.forms.utilities.now();f=null;o=n.apply(r,u);r=u=null},function(){var h=skelta.forms.utilities.now(),c;return e||i.leading!==!1||(e=h),c=t-(h-e),r=this,u=arguments,c<=0?(clearTimeout(f),f=null,e=h,o=n.apply(r,u),r=u=null):f||i.trailing===!1||(f=setTimeout(s,c)),o}};t.prototype.showPopupControl=function(t){var l=t.popupFormUniqueKey,h,y,u,c;if(skelta.DeviceOS!=="Web"||skelta.forms.utilities.isUndefined(t.openNewWindow)||t.openNewWindow!==!0){if(skelta.forms.utilities.isWorkTasksPro()&&t.formWithVersion===""){n.showAlert("",skelta.localize.getString("FormNGFPopupFormUnavailable"));return}y=SFU.setPopUpControlValue;t.loaderIconState=ko.observable("1");u=parseInt(t.dimension);u==0?t.styleAttrString="":(c=(100-u)/2,t.styleAttrString="height:"+u+"% !important;width:"+u+"% !important;margin:0 !important;top:"+c+"% !important;left:"+c+"% !important;");t.topLevelForm.popupDiv.show("PopupForm",t,y,t,"Sk_PopupForm","",l)}else{var p=t._popupFormUrl(),a=window.location.href,s=a.substr(0,a.indexOf(".htm")),v=s.split("/");v.pop();s=v.join("/");var f=parseInt(t.dimension),e="",o="",i=window.top.innerWidth,r=window.top.innerHeight;f===100?(e=document.all?window.top.screenTop:window.top.screenY,o=document.all?window.top.screenLeft:window.top.screenX):f===0?(e=r/2-300,o=i/2-400,i="801px",r="600px"):(r=r*(f/100),i=i*(f/100),e=window.top.innerHeight/2-r/2,o=window.top.innerWidth/2-i/2);$("#skloader").attr("data-skloader","1");$("#skloader").empty();h=skelta.forms.utilities.getViewModelObject(l);h.topLevelForm.popupObjectItem=null;h.topLevelForm.popupObjectItem=t;popupWindow=window.open(s+"/"+p,"popupPreview","toolbar=no, scrollbars=yes, resizable=yes, location=no, status=no, menubar=no, top="+e+", left="+o+", width="+i+", height="+r).focus()}};t.prototype.invokeWorkflow=function(t){var f=t.showConfirmation,i=skelta.forms.constants.invokeWorkflowConstants.throttleOptions,r=i.enabled?skelta.forms.utilities.throttle(skelta.forms.utilities.triggerWorkflowOnClick,i.wait,i.options):skelta.forms.utilities.triggerWorkflowOnClick,u;f===!1?r(t):(u=t.confirmationMessage===""?skelta.localize.getString("FormNGFInvokeWorkflowConfirmation"):t.confirmationMessage.skHtmlEncode(),n.showConfirmation("",u,function(n){if(n)r(t);else return}))};t.prototype.initializeMappingSchemaWithWorkflowDetails=function(n){if(ei(n),n.topLevelForm.isFormLoaded())g(n);else{var t=skelta.utilities.wrapFunction(this,fi,[n]);n.topLevelForm.functionQueueToBeTriggeredAfterFormLoad.push(t)}};t.prototype.getAttachmentStorageForEditControl=function(n,t,i){return n.value==="Cloud"&&!t?"Database":n.value==="FileSystem"&&!i?"Database":n.value};t.prototype.triggerWorkflowOnClick=function(t){function o(t){n.getUrlParameterValue(window,"FromIntouch")!=="True"&&!n.isUndefined(t.closeFormAfterExecution)&&t.closeFormAfterExecution===!0&&n.isUndefined(t.afterInvokeScript)&&(skelta.forms.utilities.isUndefined(t.topLevelForm.validationPromises)===!1&&t.topLevelForm.validationPromises.length>0?Promise.all(t.topLevelForm.validationPromises).then(function(){t.topLevelForm.cancelButtonClick.apply(t.topLevelForm)}):t.topLevelForm.cancelButtonClick.apply(t.topLevelForm))}function rt(i,r){var h,l,a;try{var u=$.parseJSON(i),c=u.executionMessage,f=u.redirectionPath,e=u.blockingOutput,s=u.workflowStatus}catch(v){skelta.forms.utilities.hideLoader();n.showError(document.title,i,function(){o(r)});return}c===""?(h=function(){r.executingMode==="Synchronous"&&(skelta.forms.utilities.hideLoader(),!n.isUndefined(f)&&f!==""&&(n.isUndefined(skelta.DeviceOS)||skelta.DeviceOS==="Web")&&window.open(f,"","directories=no,titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars,resizable,"+skelta.forms.utilities.getWindowHWSettings(screen)),n.isUndefined(r.afterInvokeScript)||(n.isUndefined(e)&&(e=""),n.isUndefined(s)&&(s=""),setTimeout(function(){r.afterInvokeScript(r,e,s);n.getUrlParameterValue(window,"FromIntouch")==="True"||n.isUndefined(r.closeFormAfterExecution)||r.closeFormAfterExecution!==!0||r.topLevelForm.cancelButtonClick()},skelta.forms.constants.invokeWorkflowConstants.timeout)));o(r)},l=t.showSuccessMessage,l===!0?(a=t.successMessage===""?skelta.localize.getString("FormNGFInvokeWorkflowSuccess"):t.successMessage.skHtmlEncode(),n.showAlert(document.title,a,h)):h()):(skelta.forms.utilities.hideLoader(),n.showError(document.title,c,function(){o(r)}))}function ut(t){skelta.forms.utilities.hideLoader();n.showError(document.title,skelta.localize.getString("FormNGFInvokeWorkflowError"),function(){o(t)})}var g=t.schemaDetails,l=g[0].schema,i=!1,a=g[0].gridId,s=t.executingMode,ft=t.closeFormAfterExecution,v=!0,tt,k,f,d,it;s==="Synchronous"&&(v=!1,skelta.forms.utilities.isWorkTasksPro()&&window.top.workTasksProPlatform==="iOS"&&(v=!0),skelta.forms.utilities.showLoader());var u=t.id,y=skelta.userContext.getUserContextFor("fName"),p=skelta.userContext.getUserContextFor("vStamp"),w="",r=null,b="",h="",e="",c=null,nt=!1;if(t.beforeInvokeScript&&(tt=t.beforeInvokeScript(t),tt===!1)){skelta.forms.utilities.hideLoader();return}if(r=skelta.forms.utilities.getParentEmbedContainerFormForControl(t),n.isUndefined(r)||(nt=!0,u=r.id+u,w=r.id),l=="FullForm")nt?(i=r.validateForm(!0,!1),i&&(i=skelta.attachment.isValidAttachmentStatus(r)),i&&(k={},k[r[customProperties.embedFormTopLevelXmlNode]]=r.records()[0].getFormSubmissionData()[r.xmlNodeBoundTo],e=n.getXmlFromJSONObject(k))):(i=t.topLevelForm.validateForm(!0,!1),i&&(i=skelta.attachment.isValidAttachmentStatus(t.topLevelForm)),i&&(e=n.getXmlFromJSONObject(t.topLevelForm.records()[0].getFormSubmissionData())));else{if(c=skelta.forms.utilities.getControlFromMultimodeControlIdString(t,a),n.isUndefined(c)){n.showError(document.title,skelta.localize.getString("FormNGFInvokeWorkfllowGridNotFound").replace("<@GridId@>",skelta.forms.utilities.getIdDisplayValueFromMultimodeControlIdString(a)));return}if(i=c.validateControl(!0),i&&(e=decodeURIComponent(c.value),n.isUndefinedNullOrEmpty(e))){skelta.forms.utilities.hideLoader();n.showError(document.title,skelta.localize.getString("FormNGFInvokeWorkflowNoRecordInSelectedGrid").replace("<@GridId@>",skelta.forms.utilities.getIdDisplayValueFromMultimodeControlIdString(a)));return}}i===!0?(typeof popupObjectInstance=="undefined"||n.isUndefined(popupObjectInstance)||(f=null,n.isUndefined(popupObjectInstance.templateObject)||popupObjectInstance.templateObject.controlType!=="PopupForm"||popupObjectInstance.templateObject.persistFormDefinition!==!0?popupObjectInstance.controlType==="PopupForm"&&popupObjectInstance.persistFormDefinition===!0&&(f=popupObjectInstance):f=popupObjectInstance.templateObject,SFU.isUndefined(f)||(u=f.id+u,d=skelta.forms.utilities.getParentEmbedContainerFormForControl(f),n.isUndefined(d)||(h=d.id,u=h+u),y=n.getUrlParameterValue(window,"parentfName"),p=n.getUrlParameterValue(window,"parentVstamp"),b=f.id)),it=n.createJsonRequestHelper({applicationName:skelta.userContext.getUserContextFor("appN"),userId:skelta.userContext.getUserContextFor("uId"),workflowDetails:t.workflowWithVersion,invokeWorkflowId:u,xmlVariableName:t.xmlVariableName,xmlInstance:e,formName:y,versionStamp:p,executionMode:s,embedContainerId:w,popupContainerId:b,popupParentEmbedContainerId:h,schemaType:l,mappingSchema:t.mappingsSchema}),setTimeout(function(){skelta.forms.utilities.isWorkTasksPro()&&skelta.forms.utilities.isWorkTasksProConnectedToInternet()===!1?(s==="Synchronous"?skelta.forms.utilities.showWorkTasksProAccountErrorMessage():skelta.forms.utilities.isWorkTasksProOfflineSupportEnabled()===!1?skelta.forms.utilities.showWorkTasksProAccountErrorMessage():(window.top.queueInvokeWorkflowTriggerRequest({workflowDetails:t.workflowWithVersion,invokeWorkflowId:u,xmlVariable:t.xmlVariableName,instanceXml:e,formName:y,version:p,mode:s,buttonText:t.buttonText,settings:JSON.stringify({embedContainerId:w,popupContainerId:b,popupParentEmbedContainerId:h,schemaType:l,mappingSchema:t.mappingsSchema})}),o(t)),skelta.forms.utilities.hideLoader()):n.callServerMethod("POST",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/ExecuteWorkFlow"),"application/json; charset=utf-8",it,"html",function(n){rt(n,t)},function(){ut(t)},null,v)},skelta.forms.constants.invokeWorkflowConstants.timeout)):(skelta.forms.utilities.showError(document.title,skelta.localize.getString("FormNGFValidationErrorIW")),skelta.forms.utilities.hideLoader())};t.prototype.getWindowHWSettings=function(n){var t=0,i=0;try{t=Math.floor((n.availWidth-840)/2);i=Math.floor((n.availHeight-620)/2)}catch(r){}finally{t=t<0?0:t;i=i<0?0:i}return"left = "+t+", top = "+i+", width = 840, height = 620"};t.prototype.clearUserLookupValue=function(t){if(t._value().length>0&&t._enable()===!0){t.value="";var i=t.domElement;n.isUndefined(i)||i.focus()}};t.prototype.appendInitialValueAssignment=function(t,i,r,u,f){if(!n.isUndefined(t)){var e=t[u];n.isUndefined(e)||(i[r]=f?e:e)}};t.prototype.updateCoreValue=function(t,i){var f,e,o,u,r,s,h,c;switch(t.controlType){case"ExpressionEditor":t.value=i;break;case"PropertyLookup":t.value=t.xmlNodeBoundTo==="FormDefinitionString"?n.encodeXmlValue(i):i;break;case"DropDownChoice":t.value=i?i.optionvalue:"";break;case"DateInput":f="";e=skelta.forms.utilities.GetDateForUIValue(t,i);e===null?t.value="":(f=e!==null?kendo.toString(e,"MM/dd/yyyy 00:00:00"):"",t.value!=f&&(t.value=f));break;case"TimeInput":skelta.forms.utilities.updateTimeInputCoreValue(i,t);break;case"DateTimeInput":skelta.forms.utilities.updateDateTimeCoreValue(i,t);break;case"ListInputbox":if(o="",i.length!==undefined)for(r=0;r<i.length;r++)i[r]==null||skelta.utilities.isUndefined(i[r].optionvalue)||i[r].optionvalue==""||(o+=r==i.length-1?i[r].optionvalue:i[r].optionvalue+skelta.forms.utilities.getMultiValueSeperator(t.forms2011Compatible));else i==null||skelta.utilities.isUndefined(i.optionvalue)||i.optionvalue==""||(o+=i.optionvalue);t.value=o;break;case"CheckList":for(u="",r=0;r<i.length;r++)i[r]!=""&&(u=r==i.length-1?u+i[r]:u+i[r]+skelta.forms.utilities.getMultiValueSeperator(t.forms2011Compatible));t.value=u;break;case"Grid":skelta.grid.updateGridCoreValue(t,i);break;case"Password":t.topLevelForm.isFormLoaded()&&(s=tt(t,i),t.encryptedValue=s,h=nt(s),t.value=h,t.uiValue=h);break;case"LookupInput":c=t.selectedItem;c&&(t.value=c[t.valueField]);break;case"ReportConfiguration":case"Slider":t.value=i;break;case"DataLookupPropertyChart":case"DataLookupProperty":case"DataLookupPropertyForHierarchicalList":t.value=n.isUndefined(i)||i===""?"":i;break;case"Attachment":skelta.attachment.updateCoreValue(t,i)}};t.prototype.updateUIValue=function(t,i){var l,a,f,v,e,o,h,c,u,s;switch(t.controlType){case"ActionBarItemCollection":i&&(t._actionItems([]),l=skelta.forms.utilities.getActionBarItems(i),t._actionItems(l));break;case"ExpressionEditor":t.uiValue=i;break;case"PropertyLookup":if(t.xmlNodeBoundTo==="FormDefinitionString"){if(t.isThroughUI=!0,t.isThroughCore=!1,!n.isUndefined(i)&&i!=="")try{i=n.decodeXmlValue(i)}catch(y){}t.uiValue=i}else t.uiValue=i;break;case"DropDownChoice":ko.utils.arrayFilter(t.options,function(n){n.optionvalue==i&&(a=n)});t.uiValue=a;break;case"Attachment":skelta.attachment.updateUIValue(i,t);break;case"ListInputbox":if(f="",ko.isObservable(i)&&(i=i.peek()),typeof i=="string"&&i)if(i=i.toString(),f=i.split(skelta.forms.utilities.getMultiValueSeperator(t.forms2011Compatible)),skelta.utilities.isUndefined(t.selectedMode)||(v=t.selectedMode),e=[],v=="Multiple"&&f.length>0){for(o=0;o<f.length;o++)e.push(skelta.forms.utilities.getItemFromValue(t.options,f[o],!1));t.uiValue=e}else e.push(skelta.forms.utilities.getItemFromValue(t.options,f[0],!1)),t.uiValue=e;else r.logInformation(skelta.localize.getString("FormListInputObjectcheck"));break;case"CheckList":n.isUndefined(i)||typeof i!="string"?r.logInformation(skelta.localize.getString("FormCheckBoxObjectcheck")):(i=i.toString(),t.uiValue=i.split(skelta.forms.utilities.getMultiValueSeperator(t.forms2011Compatible)));break;case"Grid":skelta.grid.updateGridUiValue(t,i);break;case"Password":h="";n.isUndefined(t.encryptedValue)||t.encryptedValue===""||(h=nt(t.encryptedValue));h===i?t.uiValue=i:(c=tt(t,i),t.uiValue=c,t.encryptedValue=c);break;case"FormImage":t.uiValue=skelta.forms.utilities.getImagePath(i);break;case"TimeInput":t.uiValue=skelta.forms.utilities.updateTimeInputDisplayValue(i,t);break;case"DateTimeInput":t.uiValue=skelta.forms.utilities.updateDateTimeDisplayValue(i,t);break;case"DateInput":t.uiValue=skelta.forms.utilities.updateDateDisplayValue(i,t);break;case"UserLookUp":n.isUndefined(i)||i===""?(t.uiValue="",t.extendedInformation=null):(u=skelta.forms.utilities.getDisplayTextForUL(i),n.isUndefined(u)||u===""?(t.uiValue="",t.value=""):t.uiValue=u,t.requiresExtendedInformation===!0&&(t.extendedInformation=skelta.forms.utilities.getUserLookupExtendedInformation(i)));break;case"RoleLookUp":n.isUndefined(i)||i===""?t.uiValue="":(u=skelta.forms.utilities.getRoleNameForRL(i),n.isUndefined(u)||u===""?(t.uiValue="",t.value=""):t.uiValue=u);break;case"Slider":s=parseInt(i);(isNaN(s)||s<0)&&(i=0);s>100&&(i=100);t.uiValue=i;t.value=i}};t.prototype.updateDisplayValue=function(t,i){var l,a,f,r,v,s,h,e,c,o,u,y,p;switch(t.controlType){case"ExpressionEditor":i?t.isExpression?(l=JSON.parse(i),a=JSON.parse(l.ExpressionString),t.displayValue=a.DisplayExpressionString):t.displayValue=i:t.displayValue="";break;case"DataLookupPropertyChart":case"DataLookupProperty":t.displayValue=n.isUndefined(i)||i===""?"":n.getJSONObjectFromXml(i).DataLookupProperty.LookupName;break;case"DataLookupPropertyForHierarchicalList":t.displayValue=n.isUndefined(i)||i===""?"":n.getJSONObjectFromXml(i).DataLookupPropertyForHierarchicalList.LookupName;break;case"PropertyLookup":t.xmlNodeBoundTo==="NavigateToForm"||t.xmlNodeBoundTo==="WorkflowWithVersion"||t.xmlNodeBoundTo==="FormWithVersion"||t.xmlNodeBoundTo==="PrintableSourceForm"||t.xmlNodeBoundTo==="WidgetFormSource"?i!==""?(f=i.split("~"),f[1]==="0"&&(f[1]=skelta.localize.getString("Latest")),t.displayValue=f.join("~")):t.displayValue=i:t.xmlNodeBoundTo==="FormDefinitionString"?t.displayValue=n.decodeXmlValue(i):t.xmlNodeBoundTo==="MqttTopic"?skelta.utilities.isUndefinedNullOrEmpty(i)?t.displayValue="":(r="",r=skelta.utilities.removeCdataSection(i),r=skelta.utilities.decodeXmlValue(r),skelta.utilities.isUndefinedNullOrEmpty(r)?t.displayValue="":(v=n.getJSONObjectFromXml(r).MqttTopic,t.displayValue=oi(t,v))):t.displayValue=i;break;case"CheckList":case"BooleanInput":case"RadioButtonGroup":case"DropDownChoice":case"ListInputbox":if(n.isUndefined(i)||typeof i!="string")t.displayValue="";else{for(i=i.toString(),s=i.split(skelta.forms.utilities.getMultiValueSeperator(t.forms2011Compatible)),h=[],e=0;e<s.length;e++)c=skelta.forms.utilities.getItemFromValue(t.options,s[e],!1),n.isUndefined(c)||h.push(c.optiontext);t.displayValue=h.join(", ")}break;case"UserLookUp":case"RoleLookUp":o=t.uiValue;t.displayValue=n.isUndefined(o)||o===""?"":o;break;case"LookupInput":i===""&&(t.displayValue=i,t.isItemSelected=!1,t.selectedItem=undefined,t.extendedInformation=null);u=t.selectedItem;u?(y=u[t.valueField],y===i&&t.resolveValueInEditMode===!1?t.displayValue=u[t.displayField]:(skelta.forms.utilities.resolveLookupValue(i,t),i&&skelta.forms.utilities.getLookupExtendedInformation(t,i,!1))):u===undefined&&i!==""&&(skelta.forms.utilities.resolveLookupValue(i,t),i&&skelta.forms.utilities.getLookupExtendedInformation(t,i,!1));break;case"FormsControlLookup":t.displayValue=i;break;case"TimeInput":t.displayValue=skelta.forms.utilities.updateTimeInputDisplayValue(i,t);break;case"DateTimeInput":t.displayValue=skelta.forms.utilities.updateDateTimeDisplayValue(i,t);break;case"DateInput":t.displayValue=skelta.forms.utilities.updateDateDisplayValue(i,t);break;case"Number":n.isUndefined(i)||i===""?t.displayValue="":(p=n.isUndefinedNullOrEmpty(t.numberFormat)?"n":t.numberFormat,t.displayValue=kendo.toString(parseFloat(i),p,kendo.cultures[t.culture]));break;case"LabelControl":t.displayValue=n.isUndefined(i)||i===""?"":n.decodeXmlValue(i);break;case"Grid":skelta.grid.updateGridDisplayValue(t,i);break;case"ReportConfigurationPropertyLookup":t.displayValue=i!=""?skelta.localize.getString("FormNGFRVEdit"):skelta.localize.getString("FormNGFRVNew");break;case"Attachment":skelta.attachment.updateDisplayValue(t,i);break;case"RichTextInput":t.displayValue=i?$("<div/>").html(i).text():""}};t.prototype.GetDateForUIValue=function(n,t){var r=kendo.culture().calendar.patterns.d,i=[];return n.dateFormat||i.push(r),n.renderMode==="NonHtml5"&&n.dateFormat&&i.push(n.dateFormat),kendo.parseDate(t,i)};t.prototype.GetDateForCoreValue=function(n,t){return kendo.parseDate(t,"MM/dd/yyyy 00:00:00")};t.prototype.GetTimeForUIValue=function(n,t){var r=kendo.culture().calendar.patterns.t,i=[];return n.timeFormat||i.push(r),n.renderMode==="NonHtml5"&&n.timeFormat&&i.push(n.timeFormat),kendo.parseDate(t,i)};t.prototype.GetTimeForCoreValue=function(n,t){return kendo.parseDate(t,skelta.forms.constants.dateFormats.timeFormatForCoreValue,"en-US")};t.prototype.GetDateTimeForUIValue=function(n,i){var r=[],u="";return n.renderMode==="NonHtml5"&&(u=t.prototype.GetDateTimeFormat(n),r.push(u)),kendo.parseDate(i,r)};t.prototype.GetDateTimeForCoreValue=function(n,t){return kendo.parseDate(t,skelta.forms.constants.dateFormats.dateTimeFormatForCoreValue)};t.prototype.GetDateTimeFormat=function(n){var t=n.dateFormat===""?kendo.culture().calendar.patterns.d:n.dateFormat,i=this.GetTimeFormat(n);return t+(" "+i)};t.prototype.GetTimeFormat=function(n){return n.timeFormat===""?kendo.culture().calendar.patterns.t:n.timeFormat};t.prototype.getDateTimeInUTCFormat=t.prototype.GetDateTimeInUTCFormat=function(n){return n instanceof Date||(n=new Date(n)),n=new Date(n.getTime()),n.setUTCHours(n.getHours()),n.setUTCMinutes(n.getMinutes()),n.setUTCSeconds(n.getSeconds()),n};t.prototype.getDateTimeInServerUTCFormat=t.prototype.GetDateTimeInServerUTCFormat=function(n,t){return n instanceof Date||(n=new Date(n)),n=new Date(n.getTime()),t===!0?n.setTime(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())):n.setMinutes(n.getMinutes()+n.getTimezoneOffset()),n};t.prototype.updateTimeInputCoreValue=function(t,i){var f,u,e;try{n.isUndefined(t)?i.value="":(f=i.timeFormat===""?skelta.forms.constants.dateFormats.timeFormatForCoreValue:i.timeFormat,u=kendo.parseDate(t,f),u==null&&(f=this.GetTimeFormat(i),u=kendo.parseDate(t,f)),u!==null?(e=kendo.toString(u,skelta.forms.constants.dateFormats.timeFormatForCoreValue),i.value=e):i.value="")}catch(o){r.logError(skelta.localize.getString("FormNGFErrorUpdatingTimeCoreValue").replace("<@controlid@>",i.id)+"\n"+o.message)}};t.prototype.updateTimeInputDisplayValue=function(t,i){var u,f,e;try{return n.isUndefined(t)||t.length<=0?t:(u=this.GetTimeForCoreValue(i,t),u!==null?(i.widgetValue=u,f=i.timeFormat===""?kendo.culture().calendar.patterns.t:i.timeFormat,e=kendo.toString(u,f),e):"")}catch(o){return r.logError(skelta.localize.getString("FormNGFErrorUpdatingTimeUIValue").replace("<@controlid@>",i.id)+"\n"+o.message),""}};t.prototype.updateDateTimeCoreValue=function(i,u){var f,e;try{n.isUndefined(i)?u.value="":(f=t.prototype.GetDateTimeForUIValue(u,i),f!==null?(f=t.prototype.GetDateTimeInServerUTCFormat(f,!1),e=kendo.toString(f,skelta.forms.constants.dateFormats.dateTimeFormatForCoreValue),u.value=e):u.value="")}catch(o){r.logError(skelta.localize.getString("FormNGFErrorUpdatingDateTimeCoreValue").replace("<@controlid@>",u.id)+"\n"+o.message)}};t.prototype.updateDateTimeDisplayValue=function(i,u){var f,e,o,s;try{return n.isUndefined(i)||i.length<=0?i:(f=kendo.parseDate(i,skelta.forms.constants.dateFormats.dateTimeFormatForCoreValue,"en-US"),f===null&&u.isValidValue===!1?"":(e=t.prototype.GetDateTimeInServerUTCFormat(f,!0),(skelta.utilities.isUndefinedNullOrEmpty(u.min)||f>=kendo.parseDate(u.min,skelta.forms.constants.dateFormats.dateTimeFormatForCoreValue,"en-US"))&&(skelta.utilities.isUndefinedNullOrEmpty(u.max)||f<=kendo.parseDate(u.max,skelta.forms.constants.dateFormats.dateTimeFormatForCoreValue,"en-US"))&&(u.widgetValue=e),o=t.prototype.GetDateTimeFormat(u),s=kendo.toString(e,o),s))}catch(h){return r.logError(skelta.localize.getString("FormNGFErrorUpdatingDateTimeUIValue").replace("<@controlid@>",u.id)+"\n"+h.message),""}};t.prototype.updateDateDisplayValue=function(n,t){var i=kendo.parseDate(n,"MM/dd/yyyy 00:00:00","en-US");return i===null&&t.isValidValue===!1?"":((skelta.utilities.isUndefined(t.min)||i>=t.min)&&(skelta.utilities.isUndefined(t.max)||i<=t.max)&&(t.widgetValue=i),t.dateFormat?kendo.toString(i,t.dateFormat):kendo.toString(i,kendo.culture().calendar.patterns.d))};t.prototype.getItemFromValue=function(n,t,i){var r;return ko.utils.arrayFilter(n,function(n){i?skelta.utilities.isUndefined(n)||n.optiontext!=t||(r=n):skelta.utilities.isUndefined(n)||n.optionvalue!=t||(r=n)}),r};t.prototype.parseUrl=function(n){function i(n){for(var i=t,f=i.parser[i.strictMode?"strict":"loose"].exec(n),r={},u=14;u--;)r[i.key[u]]=f[u]||"";return r[i.q.name]={},r[i.key[12]].replace(i.q.parser,function(n,t,u){t&&(r[i.q.name][t]=u)}),r}var t={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};return i(n)};t.prototype.isTagLoaded=function(n,t,i){var r=$("head > "+i+"["+n+"='"+t.toLowerCase()+"']");return r.length>0};t.prototype.localizeWidgetErrorMessage=function(t,i){var u=skelta.localize.getString(t).replace("@@widgetname@@",n.isUndefinedNullOrEmpty(i)?"":"'"+i+"'");return r.logError(u),u};t.prototype.includeCustomCssFiles=function(t){function y(n){n.indexOf("FNFMessage:")===0?console.log(n.split("FNFMessage:")[1]):a(u,n)}function p(t){var i=skelta.localize.getString("FormNGFErrorReadingFileContent");n.showError(document.title,i);r.logError(i+0+t.status+"\n"+t.statusText+"\n"+t.responseText)}for(var o,l,h,v,i=0;i<t.length;i++){var u="",c="",f="",e="",s="";skelta.DeviceOS==="WorkTasks"?this.isWorkTasksPro()?(o="",t[i].toLowerCase().indexOf("custom/widgets")!==-1?(u=t[i].substr(7),o=FormCustomPath+":"+u):t[i].split(":").length>1&&t[i].split(":")[0].trim().toUpperCase()===FormCustomThemePath||t[i].split(":").length>1&&t[i].split(":")[0].trim().toUpperCase()===FormCustomPath?(c=t[i].split(":")[0].trim().toUpperCase()+":",u=t[i].split(":")[1].trim(),o=c+u):o=t[i].toLowerCase().indexOf("css/custom/")===0?t[i].substr(11):t[i].toLowerCase().indexOf("css/")===0?t[i].substr(4):t[i],l=window.top.formsCustomFilesDataFromAppCache,h=l.filter(function(n){return n.Name.toLowerCase()===o.toLowerCase()}),!n.isUndefinedNullOrEmpty(h)&&h.length>0&&!n.isUndefinedNullOrEmpty(h[0].Data)&&(skelta.forms.utilities.isTagLoaded("skcssfile",o,"style")||a(o,h[0].Data))):(t[i].split(":").length>1&&t[i].split(":")[0].trim().toUpperCase()===FormCustomPath?u="custom/css/"+t[i].split(":")[1].trim():t[i].split(":").length>1&&t[i].split(":")[0].trim().toUpperCase()===FormCustomThemePath?(f=skelta.userContext.getUserContextFor("themePath"),e=!n.isUndefinedNullOrEmpty(f)&&f.toLowerCase().indexOf("themes")>-1?f.split("/"):null,s=n.isUndefinedNullOrEmpty(e)?null:e[e.length-2],u=n.isUndefinedNullOrEmpty(s)?"custom/css/"+t[i].split(":")[1].trim():"custom/Themes/"+s+"/css/"+t[i].split(":")[1].trim()):u=t[i],v=n.createJsonRequestHelper({file:u}),skelta.forms.utilities.isTagLoaded("skcssfile",u,"style")||$.ajax({type:"POST",async:!1,cache:!0,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetfileContent"),contentType:"application/json; charset=utf-8",dataType:"text",data:v.getValueForPostRequest(),beforeSend:skelta.forms.utilities.addRequestHeaders,success:y,error:p})):(t[i].split(":").length>1&&t[i].split(":")[0].trim().toUpperCase()===FormCustomPath?u="custom/css/"+t[i].split(":")[1].trim():t[i].split(":").length>1&&t[i].split(":")[0].trim().toUpperCase()===FormCustomThemePath?(f=skelta.userContext.getUserContextFor("themePath"),e=!n.isUndefinedNullOrEmpty(f)&&f.toLowerCase().indexOf("themes")>-1?f.split("/"):null,s=n.isUndefinedNullOrEmpty(e)?null:e[e.length-2],u=n.isUndefinedNullOrEmpty(s)?"custom/css/"+t[i].split(":")[1].trim():"custom/Themes/"+s+"/css/"+t[i].split(":")[1].trim()):u=t[i],skelta.forms.utilities.isTagLoaded("skcssfile",u,"link")||skelta.forms.utilities.appendCssLink(u))}};t.prototype.initializeWidgetFormCommunication=function(n){skelta.forms.utilities.includeCustomJsFiles(["./custom/widgets/resources/apis/iFrameClient.js"],!0,!0);initIframeCom(n)};t.prototype.includeCustomJsFiles=function(t,i,u){function v(n){try{n.indexOf("FNFMessage:")===0?r.logInformation(n.split("FNFMessage:")[1]):u&&!h(e)?(ut(e,n),c(e)):ft(e,n)}catch(t){r.logError(skelta.localize.getString("FormNGFErrorIncludingJSFile")+"\n"+t.message)}}function y(t){var i=skelta.localize.getString("FormNGFErrorReadingFileContent");n.showError(document.title,i);r.logError(i+0+t.status+"\n"+t.statusText+"\n"+t.responseText)}var f,l,o,w,s,b;for(skelta.utilities.isUndefined(u)&&(u=!1),f=0;f<t.length;f++){var e="",p="",a=!0;this.isWorkTasksPro()&&t[f]!=="../CommonUXControls/scripts/actionBar/actionBar.min.js"?(t[f].split(":").length>1&&t[f].split(":")[0].trim().toUpperCase()===FormCustomPath?(p=t[f].split(":")[0].trim().toUpperCase()+":",e=t[f].split(":")[1].trim()):t[f].toLowerCase().indexOf("custom/widgets")!==-1?t[f].toLowerCase().indexOf("custom/widgets/resources")!==-1?(a=!0,e=t[f]):(a=!1,e=t[f].substr(7),e=FormCustomPath+":"+e):e=t[f].toLowerCase().indexOf("js/custom/")===0?t[f].substr(10):t[f].toLowerCase().indexOf("js/")!==0||i?t[f]:t[f].substr(3),i&&a?it(u,e)?(l=e,skelta.forms.utilities.isWorkTasksPro()&&l.toLowerCase().indexOf("app/skelta.")!==-1&&window.top.ServerVersion===window.top.ServerVersionEnum.Version2020U2&&(l=l.replaceString(".min.js","_2020U2.min.js",!1,!0)),$.ajax({type:"GET",async:!1,cache:!0,url:l,dataType:"text",success:v,error:y})):u&&!h(e)&&c(e):(o="",t[f].split(":")[0].trim().toUpperCase()!=FormCustomPath?(t[f].split(":").length>1&&(e=t[f].split(":")[1].trim()),o=e):o=p+e,w=window.top.formsCustomFilesDataFromAppCache,s=w.filter(function(n){return n.Name.toLowerCase()===o.toLowerCase()}),!n.isUndefinedNullOrEmpty(s)&&s.length>0&&!n.isUndefinedNullOrEmpty(s[0].Data)&&(u&&!h(e)?(rt(o)||ut(o,s[0].Data),c(o)):skelta.forms.utilities.isTagLoaded("skjsfile",o,"script")||ft(o,s[0].Data)))):skelta.DeviceOS==="WorkTasksPreview"&&t[f]==="../CommonUXControls/scripts/actionBar/actionBar.min.js"||this.isWorkTasksPro()||(e=t[f].split(":").length>1&&t[f].split(":")[0].trim().toUpperCase()===FormCustomPath?"custom/js/"+t[f].split(":")[1].trim():t[f],b=n.createJsonRequestHelper({file:e}),it(u,e)?$.ajax({type:"POST",async:!1,cache:!0,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetfileContent"),contentType:"application/json; charset=utf-8",dataType:"text",data:b.getValueForPostRequest(),beforeSend:skelta.forms.utilities.addRequestHeaders,success:v,error:y}):u&&!h(e)&&c(e))}};t.prototype.loadCustomStyles=function(t){var i="",s="",u="",o,c,l;t.split(":").length>1&&(t.split(":")[0].trim().toUpperCase()===FormCustomPath||t.split(":")[0].trim().toUpperCase()===FormCustomThemePath)?(s=t.split(":")[0].trim().toUpperCase()+":",t=t.split(":")[1].trim(),i=skelta.userContext.getUserContextFor("customThemePathForNextGenForm"),n.isUndefinedNullOrEmpty(i)||(u=i.toLowerCase().indexOf("themes")>-1?"css/":"NextGenForms/custom/css/")):(t=t.trim(),i=skelta.userContext.getUserContextFor("themePath"),u="NextGenForms/css/custom/");var v=n.getUriObjectFromWindow(),h=v.getPageNameWithoutExtension(),r=(n.isUndefinedNullOrEmpty(i)?"":i)+u+t+(t.indexOf(".css")===-1?".css":"");if(skelta.DeviceOS==="WorkTasks")if(this.isWorkTasksPro()){var y=window.top.formsCustomFilesDataFromAppCache,e=s+t+(t.indexOf(".css")===-1?".css":""),f=y.filter(function(n){return n.Name.toLowerCase()===e.toLowerCase()});!n.isUndefinedNullOrEmpty(f)&&f.length>0&&!n.isUndefinedNullOrEmpty(f[0].Data)&&(skelta.forms.utilities.isTagLoaded("skcssfile",e,"style")||a(e,f[0].Data))}else o=this.parseUrl(this.getServerUrl()),r=o.protocol+"://"+o.authority+i+u+t+(t.indexOf(".css")===-1?".css":""),skelta.forms.utilities.isTagLoaded("skcssfile",r,"link")||this.appendCssLink(r);else(h==="FormsDesigner"||h==="PreviewForm")&&(c=new Date,l=c.getTime(),r+="?time="+l),this.appendCssLink(r)};t.prototype.loadPageStyles=function(t){var i,r,u;if(n.isUndefinedNullOrEmpty(skelta.DeviceOS)&&(skelta.DeviceOS="Web"),i=skelta.userContext.getThemeName(),i===""){skelta.DeviceOS.indexOf("Preview")>-1&&this.loadWorkTasksCSS();return}r=new n.getUriObjectFromWindow;u=r.getPageNameWithoutExtension();switch(u){case"EditControl":this.appendCssLink(t+"NextGenForms/css/SkeltaForms.min.css");this.appendCssLink(t+"NextGenForms/css/SkeltaFormsEditControl.min.css");this.appendCssLink(t+"CommonUXControls/StyleSheet/se.ui.min.css");break;case"ExpressionEditor":this.appendCssLink(t+"CommonUXControls/StyleSheet/UXControls.min.css");this.appendCssLink(t+"NextGenForms/css/SkeltaForms.min.css");this.appendCssLink(t+"NextGenForms/css/SkeltaFormsEditControl.min.css");this.appendCssLink(t+"NextGenForms/css/expressioneditor.min.css");this.appendCssLink(t+"CommonUXControls/StyleSheet/se.ui.min.css");break;case"FormsDesigner":this.appendCssLink(t+"CommonUXControls/StyleSheet/UXControls.min.css");this.appendCssLink(t+"NextGenForms/css/SkeltaForms.min.css");this.appendCssLink(t+"NextGenForms/css/SkeltaDesigner.min.css");this.appendCssLink(t+"NextGenForms/css/custom/SkeltaCustomControlDesigner.css");this.appendCssLink(t+"CommonUXControls/StyleSheet/se.ui.min.css");break;default:skelta.DeviceOS!=="WorkTasks"&&(this.appendCssLink(t+"CommonUXControls/StyleSheet/UXControls.min.css"),this.appendCssLink(t+"NextGenForms/css/SkeltaForms.min.css"),this.appendCssLink(t+"CommonUXControls/StyleSheet/se.ui.min.css"))}skelta.DeviceOS.indexOf("Preview")>-1&&this.loadWorkTasksCSS()};t.prototype.loadWorkTasksCSS=function(){this.appendCssLink("css/Android.min.css")};t.prototype.loadTemplates=function(){$(document).ready(function(){$("script[type='text/html']").each(function(t,i){n.isUndefined($(i).attr("src"))||$.get($(i).attr("src"),function(n){$(i).text(n)})})})};t.prototype.includePassScripts=function(){skelta.forms.utilities.includeCustomJsFiles(["js/aes-min.js","js/sha256-min.js"],!0)};t.prototype.executeInitialScripts=function(){this.loadTemplates();this.loadLookupTemplate();this.loadFormControlLookupTemplate()};t.prototype.formMaximize=function(){try{window.moveTo(0,0);window.resizeTo(screen.availWidth,screen.availHeight)}catch(n){}};t.prototype.closePropertiesFrame=function(){window.top.$("#editframe").attr("data-skipw","0");setTimeout(function(){window.top.$("#editframe").attr("src","");window.top.$("#designwrapper").css("visibility","hidden")},100)};t.prototype.showLoader=function(t){var i,r;skelta.DeviceOS==="WorkTasks"?window.top.showLoader():(i=$("#skloader"),n.isUndefined(i)||(i[0].childNodes.length===0&&(r=n.getLoaderObject(),i[0].appendChild(r)),n.isUndefined(t)&&(t=""),$("#skloader").attr("data-skpage",t),$("#skloader").attr("data-skloader","1")))};t.prototype.hideLoader=function(){try{if(skelta.DeviceOS==="WorkTasks")window.top.hideLoader();else{var t=$("#skloader");n.isUndefined(t)||t.attr("data-skloader","0")}}catch(i){r.logError(skelta.localize.getString("FormNGFErrorHidingLoader")+"\n"+i.message)}};t.prototype.pageLoadComplete=function(){this.hideLoader()};t.prototype.injectFormNotAvailableContentToWidgetIframe=function(t){var u="",f="",e,o,i,s,r;n.isUndefinedNullOrEmpty(skelta.DeviceOS)&&(skelta.DeviceOS="Web");skelta.DeviceOS.indexOf("Preview")>-1||this.isWorkTasksPro()?u="css/Android.min.css":(e=skelta.userContext.getUserContextFor("themePath"),o=e.toLowerCase().indexOf("/themes/"),o>-1&&(f=e.substr(0,o+1)+"NextGenForms/css/SkeltaForms.min.css"),u=e+"NextGenForms/css/SkeltaForms.min.css");i="<html><head>";n.isUndefinedNullOrEmpty(f)||(i+="<link skcssfile='"+f.toLowerCase()+"' rel='stylesheet' type='text/css' href='"+f.toLowerCase()+"' /> ");i+="<link skcssfile='"+u.toLowerCase()+"' rel='stylesheet' type='text/css' href='"+u.toLowerCase()+"' /> ";i+="<\/head><body>";i+="<table border='0' cellpadding='0' cellspacing='0' style='width:100%;height:100%; '>";i+="<tbody> <tr style='vertical-align: middle'>";i+="<td align='center'>";i+="<span style='display:inline-block; color:Black; width:100%; padding-bottom:8px; font-size: 12px; font-weight:normal; text-decoration:none'>";s=document.createElement("p");s.innerText=skelta.localize.getString("WidgetFormNotAvailableError");i+=s.innerHTML;i+="<\/span>";i+="<\/td>";i+="<\/tr>";i+="<\/tbody><\/table >";i+="<\/body><\/html>";r=t.document;t.contentDocument?r=t.contentDocument:t.contentWindow&&(r=t.contentWindow.document);r?(r.open(),r.writeln(i),r.close()):skelta.forms.utilities.showAlertMessage(document.title,"Cannot inject dynamic contents into iframe.")};skelta.forms.utilities=new t;t.prototype.getStorageItem=function(n){try{var t=localStorage[n];return skelta.utilities.isUndefined(t)?sessionStorage[n]:t}catch(i){return skelta.logger.logError(i.message),sessionStorage[n]}};t.prototype.setStorageItem=function(n,t){try{localStorage[n]=t}catch(i){sessionStorage[n]=t;skelta.logger.logError(i.message)}};t.prototype.removeStorageItem=function(n){try{localStorage.removeItem(n)}catch(t){sessionStorage.removeItem(n);skelta.logger.logError(t.message)}};t.prototype.getDateForTime=function(n,t){var i=n.split(t),r=0,u=0,f=0;return i.length>0&&(r=Number(i[0]),i.length>1&&(u=Number(i[1])),i.length>2&&(f=Number(i[2]))),new Date(0001,1,1,r,u,f,0)};t.prototype.savePageDefaultsInLocalStotage=function(n){try{var t={};t.ThemePath=n.ThemePath;t.Culture=n.Culture;skelta.forms.utilities.setStorageItem(ngfLocalStorageKeys.nGFPageDefaults,JSON.stringify(t))}catch(i){r.logError(i.message)}};t.prototype.saveLocalesInLocalStotage=function(n,t){var i,u,f;try{i=null;u=skelta.forms.utilities.getStorageItem(ngfLocalStorageKeys.nGFLocales);u!=null&&u!="{}"&&(i=JSON.parse(u));(i==null||skelta.DeviceOS==="WorkTasks"||i.LastModifiedLocaleTime!==n.LastModifiedLocaleTime||t!==n.Culture)&&(f={},f.LastModifiedLocaleTime=n.LastModifiedLocaleTime,f.Locales=n.Locales,skelta.forms.utilities.setStorageItem(ngfLocalStorageKeys.nGFLocales,JSON.stringify(f)))}catch(e){r.logError(e.message)}};t.prototype.openHyperLinkWindow=function(n){var t=n.replaceString("\\","/",!1,!0),i;t.startsWithString("<bpmuitemplates>/")&&(i=skelta.userContext.getBPMUITemplatesPath(),i!=""&&(t=t.replaceString("<bpmuitemplates>"+(i.endsWithString("/")?"/":""),i)));t.length>0&&(skelta.DeviceOS==="WorkTasks"?window.open(t):window.open(t,"popupwindow","scrollbars,resizable"))};t.prototype.setImagePath=function(n,t){$("#"+n).attr("src",this.getImagePath(t))};t.prototype.getImagePath=function(t){var e=skelta.DeviceOS,i,s,o,u,r,h,c,f;if((n.isUndefined(e)||e==="Web")&&(e="Web"),i="",skelta.utilities.isUndefined(t)||(i=t.replaceString("\\","/",!1,!0)),i.split(":").length>1&&i.split(":")[0].trim().toUpperCase()===FormCustomPath||i.split(":")[0].trim().toUpperCase()===FormCustomThemePath){if(i.startsWithString("http")||e!=="WorkTasks"||skelta.DeviceOS.indexOf("Preview")!==-1||i.toLowerCase().indexOf("base64")!==-1){var u=skelta.userContext.getUserContextFor("customThemePathForNextGenForm"),l=!n.isUndefinedNullOrEmpty(u)&&u.toLowerCase().indexOf("themes")>-1?"Images/":"NextGenForms/custom/Images/",a=i.split(":")[1].trim();return u+l+a}return s=skelta.userContext.getUserContextFor("skSasToken"),n.isUndefinedNullOrEmpty(s)?(f=this.parseUrl(this.getServerUrl()),o=skelta.userContext.getUserContextFor("themePath"),i=o+"NextGenForms/custom/Images/"+i.split(":")[1].trim(),f.protocol+"://"+f.authority+i):(o=skelta.userContext.getBPMUITemplatesPath(),i=o+"NextGenForms/custom/Images/"+i.split(":")[1].trim(),skelta.serverUrl.substr(0,skelta.serverUrl.toLowerCase().indexOf("/bpmuitemplates/"))+i.substr(i.toLowerCase().indexOf("/bpmuitemplates"))+"?sb-token="+encodeURIComponent(s))}return i.startsWithString(".")||(i.startsWithString("<themepath>/")?(u=skelta.userContext.getUserContextFor("themePath"),u!=""&&(i=i.replaceString("<themepath>"+(u.endsWithString("/")?"/":""),u))):i.startsWithString("<bpmuitemplates>/")?(r=skelta.userContext.getBPMUITemplatesPath(),r!=""&&(i=i.replaceString("<bpmuitemplates>"+(r.endsWithString("/")?"/":""),r))):i.startsWithString("bpmuitemplates/")&&(r=skelta.userContext.getBPMUITemplatesPath(),r!=""&&(i=r.substr(0,r.toLowerCase().indexOf("/bpmuitemplates/")+1)+i))),i.containsString("<themename>")&&(h=skelta.userContext.getThemeName(),i=h===""?i.containsString("/Themes/<ThemeName>/")?i.replaceString("/Themes/<ThemeName>/","/"):i.containsString("/<ThemeName>/")?i.replaceString("/<ThemeName>/","/"):i.replaceString("<ThemeName>",""):i.replaceString("<ThemeName>",h)),i.startsWithString("http")||e!=="WorkTasks"||skelta.DeviceOS.indexOf("Preview")!==-1||i.toLowerCase().indexOf("base64")!==-1||(c=skelta.userContext.getUserContextFor("skSasToken"),n.isUndefinedNullOrEmpty(c)?(f=this.parseUrl(this.getServerUrl()),i=f.protocol+"://"+f.authority+i):i=skelta.serverUrl.substr(0,skelta.serverUrl.toLowerCase().indexOf("/bpmuitemplates/"))+i.substr(i.toLowerCase().indexOf("/bpmuitemplates"))+"?sb-token="+encodeURIComponent(c)),i};t.prototype.getUrlPath=function(n){var t=n.replaceString("\\","/",!1,!0),i,r;return t.startsWithString("<bpmuitemplates>/")?(i=skelta.userContext.getBPMUITemplatesPath(),i!=""&&(skelta.DeviceOS==="WorkTasks"?(r=this.parseUrl(this.getServerUrl()),t=t.replaceString("<bpmuitemplates>"+(i.endsWithString("/")?"/":""),i),t=r.protocol+"://"+r.authority+t):t=t.replaceString("<bpmuitemplates>"+(i.endsWithString("/")?"/":""),i))):t.startsWithString("bpmuitemplates/")&&(i=skelta.userContext.getBPMUITemplatesPath(),i!=""&&(skelta.DeviceOS==="WorkTasks"?(r=this.parseUrl(this.getServerUrl()),t=i.substr(0,i.toLowerCase().indexOf("/bpmuitemplates/")+1)+t,t=r.protocol+"://"+r.authority+t):t=i.substr(0,i.toLowerCase().indexOf("/bpmuitemplates/")+1)+t)),t};t.prototype.subscribeReportViewerParameters=function(n){ko.computed(function(){var r,u,t,i;if(n.topLevelForm.isFormLoaded()===!0){if(n.subscribeReportViewerParametersComplete===!0)return;for(r=[],u={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm,parentContainerTraversalValidation:skelta.forms.controls.findFunctions.isNotEmbeddedForm},t=0;t<n.controlTypeParameters.length;t++)i=n.findByXmlNode(n.controlTypeParameters[t],u),skelta.utilities.isUndefined(i)||r.push({key:"",value:i.id,xmlNode:i.xmlNodeBoundTo});skelta.forms.utilities.subscribeToControlParameters(n,r,function(){skelta.forms.utilities.setReportViewerInstanceXmlId(n)},u);skelta.forms.utilities.setReportViewerInstanceXmlId(n);n.subscribeReportViewerParametersComplete=!0}})};t.prototype.setReportViewerInstanceXmlId=function(t){var f,i,u,o,h,e,c,l;try{f=skelta.userContext.getUserContextFor("appN");i=skelta.userContext.getUserContextFor("itemId");skelta.utilities.isUndefinedNullOrEmpty(i)&&(i="00000000-0000-0000-0000-000000000000");var y=skelta.userContext.getUserContextFor("vStamp"),a=t.controlTypeParameters.length,s={params:{}},v={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm,parentContainerTraversalValidation:skelta.forms.controls.findFunctions.isNotEmbeddedForm};for(u=0;u<t.controlTypeParameters.length;u++)o=t.findByXmlNode(t.controlTypeParameters[u],v),s.params[t.controlTypeParameters[u]]=n.isUndefined(o)?"":o.value;h=n.getXmlFromJSONObject(s);e="";!n.isUndefined(i)&&i!==""&&!n.isUndefined(f)&&f!==""&&a>0&&(c=n.createJsonRequestHelper({applicationName:f,instanceXml:h,formId:i}),l=skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/InsertReportViewerInstanceXmlId"),skelta.forms.utilities.abortRequest(t),t.xhr=n.requestServer("POST",l,"application/json; charset=utf-8",c,"json",function(n){e=n.d;e===""?r.logError(skelta.localize.getString("FormNGFGetInstanceXmlId")):t.instanceXmlId=e},function(n){n.statusText==="abort"?r.logInformation(skelta.localize.getString("AjaxReqCancelled").replaceString("<@ajaxrequestname@>","InsertReportViewerInstanceXmlId").replaceString("<@controlid@>",t.id)):r.logError(skelta.localize.getString("FormNGFGetInstanceXmlId"))},null,!0,skelta.userContext.getUserContextFor("lookupTimeout")))}catch(p){return r.logError(skelta.localize.getString("FormNGFGetInstanceXmlId")),""}};t.prototype.getReportUrlPath=function(t,i){var d=skelta.userContext.getUserContextFor("themePath"),a=n.getUriObjectFromWindow(),c=a.getPageNameWithoutExtension(),r=this.getUrlPath(i).replaceString("\\","/",!1,!0),l,f,s,u,e,o,h;if(r.containsString("<AppName>")){l=skelta.userContext.getUserContextFor("appN");r=r.replaceString("<AppName>",l);f=skelta.userContext.getUserContextFor("itemId");skelta.utilities.isUndefinedNullOrEmpty(f)&&(f="00000000-0000-0000-0000-000000000000");var v=skelta.userContext.getUserContextFor("fName"),y=skelta.userContext.getUserContextFor("vStamp"),p=t.instanceXmlId;r=r.replaceString("<instxmlid>",p);r=r.replaceString("<cachekey>",f);r=r.replaceString("<ListName>","Forms List");r=r.replaceString("<ControlId>",t.id);r=r.replaceString("<version>",y);r=r.replaceString("<showclose>","0");r=r.replaceString("<FormName>",v);s=this.getParentEmbedContainerFormForControl(t);n.isUndefined(s)||(r+="&parentEmbedFormId="+s.id)}if(u=n.getUriObjectFromWindow(),e=u.getParameterValue("parentItemId"),skelta.utilities.isUndefinedNullOrEmpty(e)||(c=u.getParameterValue("pageName")),!skelta.utilities.isUndefinedNullOrEmpty(e)&&f=="00000000-0000-0000-0000-000000000000"){var w=u.getParameterValue("parentfName"),b=u.getParameterValue("parentVstamp"),k=u.getParameterValue("controlid");r+="&parentItemId="+e;r+="&parentfName="+w;r+="&parentVstamp="+b;r+="&controlid="+k;typeof popupObjectInstance=="undefined"||n.isUndefined(popupObjectInstance)||(o=null,n.isUndefined(popupObjectInstance.templateObject)||popupObjectInstance.templateObject.controlType!=="PopupForm"||popupObjectInstance.templateObject.persistFormDefinition!==!0?popupObjectInstance.controlType==="PopupForm"&&popupObjectInstance.persistFormDefinition===!0&&(o=popupObjectInstance):o=popupObjectInstance.templateObject,h=this.getParentEmbedContainerFormForControl(o),n.isUndefined(h)||(r+="&popupParentEmbedFormId="+h.id))}return c==="PreviewForm"?r+"&isForPreview=1":r+"&isForPreview=0"};t.prototype.getParentEmbedContainerFormForControl=function(t){if(!n.isObject(t))return null;for(var i=t.dataContainerForm;i!=null;){if(i.controlType==="EmbeddedForm")break;i=n.isUndefined(i.parentForm)?null:i.parentForm.dataContainerForm}return i};t.prototype.getDownloadReportParameters=function(t,i,u){var f,s;try{f="<bpmuitemplates>/SkeltaForms/ViewDownloadFile.aspx";f=this.getUrlPath(f).replaceString("\\","/",!1,!0);var o=skelta.userContext.getUserContextFor("appN"),h=skelta.userContext.getUserContextFor("itemId"),c=skelta.userContext.getUserContextFor("vStamp"),e="";return(n.isUndefined(t)||t===""||n.isUndefined(o)||o===""||(s=n.createJsonRequestHelper({applicationName:o,ssrsItemIdOrTitle:t}),$.ajax({type:"POST",async:!1,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetDownloadReportParameters"),data:s.getValueForPostRequest(),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(n){e=n.d},error:function(){r.logError(skelta.localize.getString("FormNGFGetSecurityUriForDownloadReport"))}})),n.isUndefined(e)||e=="")?"skeltaUtils.showError(document.title, skelta.localize.getString('ssrs_sfc_download_report_invalid_secureid_msg'));":f+e+"&formsKey="+u+"&controlId="+i}catch(l){return r.logError(skelta.localize.getString("FormNGFGetSecurityUriForDownloadReport")),""}};t.prototype.getDownloadReportUrl=function(t,i){var a=skelta.userContext.getUserContextFor("appN"),o=t.id,s=t._reportConfiguration,c={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm},h,f,u,r,e;if(!n.isUndefined(s))try{if(h=s.split(skelta.forms.constants.ssrsConstants.seprator_Section_Value),f=h[skelta.forms.constants.ssrsConstants.section_Attachment].split(skelta.forms.constants.ssrsConstants.seprator_Parameter_Outer_Value),f[0]==skelta.forms.constants.ssrsConstants.download_Report_Source_SSRS_Reports)return this.getDownloadReportParameters(f[1],o,i);if(u=f[1].split(skelta.forms.constants.ssrsConstants.seprator_Parameter_Inner_Value),!n.isUndefined(u)&&u.length==3){if(r="",u[0]=="Controls")try{e=t.findById(u[2],c);r=n.isUndefined(e)||n.isUndefined(e.value)?"":e.value}catch(l){r=""}else r=u[1];return n.isUndefined(r)||r==""?"skeltaUtils.showError(document.title, skelta.localize.getString('ssrs_sfc_download_report_invalid_secureid_msg'));":this.getDownloadReportParameters(r,o,i)}}catch(l){log.logError(l.message)}};t.prototype.getPageDefaults=function(){var o=skelta.userContext.getUserContextFor("themePath"),h=skelta.userContext.getUserContextFor("customThemePathForNextGenForm"),t=skelta.userContext.getUserContextFor("culture"),i=skelta.userContext.getUserContextFor("lastModifiedLocaleTime"),u,f,e,s;skelta.utilities.isUndefined(i)&&(i="");u=skelta.userContext.getUserContextFor("uId");skelta.utilities.isUndefined(u)&&(u="");f=skelta.userContext.getUserContextFor("appN");skelta.utilities.isUndefined(f)&&(f="");e=skelta.utilities.getUrlParameterValue(window,"lcsuri");skelta.utilities.isUndefined(e)&&(e="");s=skelta.utilities.createJsonRequestHelper({themePath:o,culture:t,lastModifiedLocaleTime:i,lcsuri:e,userId:u,appName:f});n.callServerMethod("GET",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetPageDefaults"),"application/json; charset=utf-8",s,"json",function(r){if(r){var u=JSON.parse(r.d);u.IsSuccess===!0?((o!=u.ThemePath||h!=u.CustomThemePathForNextGenForm||t!=u.Culture)&&(skelta.forms.utilities.savePageDefaultsInLocalStotage(u),skelta.userContext.setUserContextFor("culture",u.Culture),skelta.userContext.setUserContextFor("themePath",u.ThemePath),skelta.userContext.setUserContextFor("customThemePathForNextGenForm",u.CustomThemePathForNextGenForm)),(t!=u.Culture||i!=u.LastModifiedLocaleTime)&&(skelta.forms.utilities.saveLocalesInLocalStotage(u,t),skelta.userContext.setUserContextFor("lastModifiedLocaleTime",u.LastModifiedLocaleTime)),skelta.localize.localizeMessageDialog(),skelta.utilities.setRequestVerificationToken(u.AFT),skelta.userContext.setUserContextFor("vId",u.VirtualActorId),skelta.userContext.setUserContextFor("lookupTimeout",u.LookupTimeout),skelta.userContext.setUserContextFor("attachmentMaximumLimit",u.AttachmentMaximumLimit),skelta.userContext.setUserContextFor("debugMode",u.DebugMode==="TRUE"),skelta.userContext.setUserContextFor("PageInstanceID",u.PageInstanceID),skelta.logger.logContextInformation(),et()):u.IsSuccess===!1&&n.showError(document.title,skelta.localize.getString("FormNGFErrorSettingUpPage"))}},function(t){n.showError(document.title,skelta.localize.getString("FormNGFErrorSettingUpPage"));r.logError(skelta.localize.getString("FormNGFErrorSettingUpPage")+"\n"+t.status+"\n"+t.statusText+"\n"+t.responseText)},null,!1)};t.prototype.loadPageDefault=function(){skelta.forms.utilities.getPageDefaults();n.loadCulture(skelta.userContext.getUserContextFor("culture"));skelta.forms.utilities.loadPageStyles(skelta.userContext.getUserContextFor("themePath"))};t.prototype.dropDownValueHandler=function(t,i){if(!n.isUndefined(t._value)&&t._value.peek()!=="")return t._value.peek();if(i!=="")return i;var r="";return t.defaultValue?r=t.defaultValue:t.optionCaption?r="":t.options&&t.options.length>0&&(r=t.options[0].optionvalue),r};t.prototype.inputHandler=function(n,t,i,r){return i.showItemsByDefault===!0?(t.currentTarget.value="",i.isItemSelected=!1,i.selectedItem=undefined,i.extendedInformation=null,!1):(i.extendedInformation=null,i.isItemSelected=!1,i.selectedItem=undefined,i.isMobileMode=r===!0,i.filterText=t.currentTarget.value,i.targetElement=t.currentTarget,i.showClear=i.filterText.length>0,!0)};t.prototype.formsControlLookupInputHandler=function(n,t,i){var r=t.currentTarget.value;i.value=r;i.displayValue=r;i.targetElement=t.currentTarget};t.prototype.dataBindLookupTemplateDiv=function(n){var i=$("#"+lookupTemplateDiv),t,r;ko.cleanNode(i[0]);i.attr("class",cssClasses.lookupListing);t=n.id;r="style: { display:"+t+"._listingDisplay, top:"+t+"._listingTop,left:"+t+"._listingLeft,width:"+t+"._listingWidth},template: { name:"+t+".template,data:"+t+"},visible:"+t+".isListingVisible";i.attr("data-bind",r);ko.applyBindings(n.parentForm,i[0])};t.prototype.dataBindFormsControlLookupTemplateDiv=function(n){var i=$("#"+formsControlLookupTemplateDiv),t,r;ko.cleanNode(i[0]);i.attr("class",cssClasses.formsControlLookupListing);t=n.id;r="style: { display:"+t+"._listingDisplay, top:"+t+"._listingTop,left:"+t+"._listingLeft,width:"+t+"._listingWidth},template: { name:"+t+".template,data:"+t+"},visible:"+t+".isListingVisible";i.attr("data-bind",r);ko.applyBindings(n.parentForm,i[0])};t.prototype.getViewModelDiv=function(){var n=$("#viewModel")[0],t;return n===undefined&&(t=skelta.forms.utilities.getFormUniqueKey(skelta.userContext.getUserContextFor("appN"),skelta.userContext.getUserContextFor("itemId"),skelta.userContext.getUserContextFor("vStamp")),n=$("#"+t)[0]),n};t.prototype.showLookupListing=function(n,t){var l,h,r,c;$("div:not([class="+cssClasses.lookupListing+"]) > div").one("scroll."+t.id,t,this.hideLookupListing);if(this.isWorkTasksPro()===!1)$(window).one("resize."+t.id,t,this.hideLookupListing);var w=skelta.forms.utilities.getViewModelDiv(),e=$(w).offset().top,i=$(n),a=t.listingMaxHeight,u=skelta.forms.constants.lookupDefaults.itemHeight*t.lookupItems.length,f=t.loadMore===!0?skelta.forms.constants.lookupDefaults.itemHeight:0,v=parseInt(a)+f,y=parseInt(u)+f,b=v>y?y:v,p=b+skelta.forms.constants.lookupDefaults.itemHeight,o=parseInt(window.innerHeight)-(parseInt(i.offset().top)+parseInt(n.offsetHeight)),s=parseInt(i.offset().top);o>=p?(h=i.offset().top+n.offsetHeight,t.listingTop=h-e+"px"):s>=p?(r=parseInt(i.offset().top)-f,c=u<a?r-u:r-a,t.listingTop=c-e+"px"):(l=o>s?o-f-skelta.forms.constants.lookupDefaults.itemHeight:s-skelta.forms.constants.lookupDefaults.itemHeight,t.listingMaxHeight=l,o>s?(h=i.offset().top+n.offsetHeight,t.listingTop=h-e+"px"):(r=parseInt(i.offset().top)-f,c=u<l?r-u:r-l,t.listingTop=c-e+"px"));t.listingLeft=i.offset().left+"px";t.listingWidth=n.offsetWidth+"px";t.isListingVisible=!0;t.listingDisplay="block"};t.prototype.showFormsControlLookupListing=function(n,t){var l,h,r,c;$("div:not([class="+cssClasses.formsControlLookupListing+"]) > div").one("scroll",t,this.hideFormsControlLookupListing);$(window).one("resize",t,this.hideFormsControlLookupListing);var w=skelta.forms.utilities.getViewModelDiv(),e=$(w).offset().top,i=$(n),a=t.listingMaxHeight,u=skelta.forms.constants.formsControlLookupSystemDefaults.itemHeight*t.lookupItems.length,f=t.loadMore===!0?skelta.forms.constants.formsControlLookupSystemDefaults.itemHeight:0,v=parseInt(a)+f,y=parseInt(u)+f,b=v>y?y:v,p=b+skelta.forms.constants.formsControlLookupSystemDefaults.itemHeight,o=parseInt(window.innerHeight)-(parseInt(i.offset().top)+parseInt(n.offsetHeight)),s=parseInt(i.offset().top);o>=p?(h=i.offset().top+n.offsetHeight,t.listingTop=h-e+"px"):s>=p?(r=parseInt(i.offset().top)-f,c=u<a?r-u:r-a,t.listingTop=c-e+"px"):(l=o>s?o-f-skelta.forms.constants.formsControlLookupSystemDefaults.itemHeight:s-skelta.forms.constants.formsControlLookupSystemDefaults.itemHeight,t.listingMaxHeight=l,o>s?(h=i.offset().top+n.offsetHeight,t.listingTop=h-e+"px"):(r=parseInt(i.offset().top)-f,c=u<l?r-u:r-l,t.listingTop=c-e+"px"));t.listingLeft=i.offset().left+"px";t.listingWidth=n.offsetWidth+"px";t.isListingVisible=!0;t.listingDisplay="block"};t.prototype.hideLookupListing=function(n){var t=n.data;$("div:not([class="+cssClasses.lookupListing+"]) > div").off("scroll."+t.id);$(window).off("resize."+t.id);n.data.isListingVisible&&skelta.forms.utilities.validateLookup(t)};t.prototype.hideFormsControlLookupListing=function(n){skelta.forms.utilities.validateFormsControlLookup(n.data)};t.prototype.lookupFilterHandler=function(n,t,i){var r=t.currentTarget.value;r.length>0?this.filterLookupData(i,r,t.currentTarget):(i.listingDisplay="none",i.isListingVisible=!1)};t.prototype.lookupItemClickHandler=function(n,t,i){i.isMobileMode===!1?(skelta.forms.utilities.cancelLookupValidation(i),i.selectedItem=n,skelta.forms.utilities.getLookupExtendedInformation(i,n[i.valueField],!1),i.value=n[i.valueField],i.displayValue=n[i.displayField],i.isItemSelected=!0,i.showClear=!0,i.showLoader=!1,i.filterText="",i.isListingVisible=!1,i.lostFocus=!0):(i.selectedItem=n,$(t.currentTarget).parent().find("."+cssClasses.lookupMobileSelection).removeClass(cssClasses.lookupMobileSelection),$(t.currentTarget).addClass(cssClasses.lookupMobileSelection),$("."+cssClasses.lookupMobileSelect).attr(dataAttributes.mobileLookupSelectEnabled,"1"))};t.prototype.formsControlLookupItemClickHandler=function(n,t,i){skelta.forms.utilities.cancelFormsControlLookupValidation(i);var r=i.value+n[i.valueField];i.value=r;i.displayValue=r;i.isListingVisible=!1;i.lostFocus=!0;skelta.forms.utilities.disposeFormsControlLookup(i)};t.prototype.formsControlLookupItemClickHandlerForPassword=function(n,t,i){skelta.forms.utilities.cancelFormsControlLookupValidation(i);var r=n[i.valueField];i.value=r;i.displayValue=r;i.isListingVisible=!1;i.lostFocus=!0;skelta.forms.utilities.disposeFormsControlLookup(i)};t.prototype.onMobileSelect=function(n,t,i){if(t.currentTarget.attributes["data-mlse"].value==="1"){var r=i.selectedItem[i.valueField];skelta.forms.utilities.getLookupExtendedInformation(i,r,!1);i.value=r;i.displayValue=i.selectedItem[i.displayField];i.isItemSelected=!0;i.showClear=!0;i.showLoader=!1;i.isListingVisible=!1;$("."+cssClasses.lookupMobileSelect).attr(dataAttributes.mobileLookupSelectEnabled,"0");this.disposeMobileLookup(i)}};t.prototype.getUserLookupExtendedInformation=function(t,i){if(skelta.utilities.isUndefined(i)&&(i=!1),skelta.utilities.isUndefined(t)||t==="")return null;var e=skelta.userContext.getUserContextFor("appN"),o=n.createJsonRequestHelper({appName:e,uId:t}),u=null,f=n.requestPromise("GET",skelta.forms.utilities.getServerUrl("UserLookup.aspx/GetULookupExtendedInformation"),"application/json; charset=utf-8",o,"json",i,skelta.userContext.getUserContextFor("lookupTimeout"));return f.done(function(n){if(n.d){var i=$.parseJSON(n.d),t=skelta.utilities.getJSONObjectFromXml(i),r=Object.keys(t)[0];u=t[r]}else u=null}),f.fail(function(n,t,i){r.logError(skelta.localize.getString("FormsNGFErrorActorExtendedInformation").replace("<@uid@>",skelta.userContext.getUserContextFor("uId")).replace("<@controlname@>",control.tagName?control.tagName:control.id)+"\n"+i.message);u=null}),u};t.prototype.getLookupExtendedInformation=function(t,i,r){if(t.requiresExtendedInformation===!0)if(this.isWorkTasksPro()&&t.parameterCollection.length===0)t.extendedInformation=t.selectedItem;else{var u=i===""?t.value:i,f=n.createJsonRequestHelper({appName:skelta.userContext.getUserContextFor("appN"),uId:skelta.userContext.getUserContextFor("uId"),source:t.lookupName,lv:u,lp:this.lookupParameters(t)});n.requestServer("POST",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/LookupExtendedInformation"),"application/json; charset=utf-8",f,"json",function(n){if(n.d){var r=$.parseJSON(n.d),i=skelta.utilities.getJSONObjectFromXml(r),u=Object.keys(i)[0];t.extendedInformation=i[u]}else t.extendedInformation=null},function(n,i){skelta.forms.utilities.onLookupErrorResponse(n,i,t)},null,r,skelta.userContext.getUserContextFor("lookupTimeout"))}};t.prototype.onLookupParameterChange=function(n){this.subscribeToControlParameters(n,n.parameterCollection,function(){n.selectedItem=undefined;n.displayValue="";n.value=""})};t.prototype.onLookupListingVisibleChanged=function(n,t){n===!1&&(t.isMobileMode?this.disposeMobileLookup(t):this.disposeLookup(t))};t.prototype.mobileParentClearVisibility=function(t){return!n.isUndefinedNullOrEmpty(t._displayValue())&&!n.isUndefinedNullOrEmpty(t._value())&&t.enable===!0&&t.readOnly===!1};t.prototype.disposeLookup=function(n){if(n.listingDisplay="none",n.isListingVisible="false",n.showLoader=!1,$("div:not([class="+cssClasses.lookupListing+"]) > div").off("scroll."+n.id),$(window).off("resize."+n.id),n.lookupItems.length>0&&(n.lookupItems=[]),n.templateDivBinded===!0){n.templateDivBinded=!1;var t=$("#"+lookupTemplateDiv);t.css("display","none");t.empty();ko.cleanNode(t[0])}n.highlightedItemValue=""};t.prototype.disposeFormsControlLookup=function(n){if(r.logInformation("disposeFormsControlLookup called"),n.listingDisplay="none",n.isListingVisible=!1,$("div:not([class="+cssClasses.formsControlLookupListing+"]) > div").unbind("scroll",n,this.hideFormsControlLookupListing),$(window).unbind("resize",n,this.hideFormsControlLookupListing),n.templateDivBinded=!1,n.templateDivBinded===!0){n.templateDivBinded=!1;var t=$("#"+formsControlLookupTemplateDiv);t.css("display","none");t.empty();ko.cleanNode(t[0])}};t.prototype.filterLookupData=function(t,i,u){if(!t.lookupName){n.showError(document.title,skelta.localize.getString("FormsNGFErrorLookupNameNotSet"));r.logError(skelta.localize.getString("FormsNGFErrorLookupNameNotSet"));return}if(t.lookupItems=[],t.serverFiltering===!1){if(t.lookupData.length===0&&(this.getLookupData(t),t.lookupData.length===0)){r.logWarning(skelta.localize.getString("FormsNGFNoRecordsForLookupWarning").replace("<@lookupname@>",t.lookupName));return}}else this.serverFiltering(t);var f=ko.utils.arrayFilter(t.lookupData,function(n){return n[t.displayField].indexOf(i)>=0});r.logInformation(skelta.localize.getString("FormsNGFRecordsFetchedFromServerInformation").replace("<@lookupname@>",t.lookupName).replace("<@length@>",t.lookupData.length));r.logInformation(skelta.localize.getString("FormsNGFFilteredRecordsInformation").replace("<@length@>",f.length));f.length>0?(t.templateDivBinded===!1&&(this.dataBindLookupTemplateDiv(t),t.templateDivBinded=!0),t.lookupItems=f,this.showLookupListing(u,t)):this.disposeLookup(t)};t.prototype.loadMoreItems=function(t,i,u){var e,o,s;if(skelta.forms.utilities.cancelLookupValidation(u),this.isWorkTasksPro()&&u.parameterCollection.length===0){var f=window.formLookupItems,h=u.pageSize>0?u.pageSize:skelta.forms.constants.lookupDefaults.pageSize,c=f.splice(0,h),l=u.lookupItems.concat(c);u.lookupItems=l;u.loadMore=f!==null&&f!==undefined&&f.length>0}else e=10,u.pageNumber=u.pageNumber+1,u.showClear=!1,u.showLoader=!0,u.showItemsByDefault===!1?(s=skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/FilterLookupData"),o=n.createJsonRequestHelper({appName:skelta.userContext.getUserContextFor("appN"),uId:skelta.userContext.getUserContextFor("uId"),source:u.lookupName,fd:u.filterText,pn:u.pageNumber,ps:u.pageSize>0?u.pageSize:e,lp:this.lookupParameters(u)})):(s=skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetLookupData"),o=n.createJsonRequestHelper({appName:skelta.userContext.getUserContextFor("appN"),uId:skelta.userContext.getUserContextFor("uId"),source:u.lookupName,pn:u.pageNumber,ps:u.pageSize>0?u.pageSize:e,lp:this.lookupParameters(u)})),u.xhr=n.requestServer("POST",s,"application/json; charset=utf-8",o,"json",function(n){var t=$.parseJSON(n.d),i;u.displayField=t.D;u.valueField=t.V;u.loadMore=u.showItemsByDefault===!1?t.FD==u.filterText&&t.IL>0:t.IL>0;i=u.lookupItems.concat(t.I);u.lookupItems=i;r.logInformation(skelta.localize.getString("FormsNGFItemsLeftOnServerInformation").replace("<@length@>",t.IL))},function(){n.showError(document.title,skelta.localize.getString("FormsNGFErrorLoadingMoreItems"));r.logError(skelta.localize.getString("FormsNGFErrorLoadingMoreItems"))},null,null,skelta.userContext.getUserContextFor("lookupTimeout")),u.isMobileMode||(u.lostFocus=!0)};t.prototype.appendLookupItems=function(n){var t=n.LookupData;t=t.slice(n.PageNumber(),n.PageSize);ko.utils.arrayPushAll(n.LookupItems,t)};t.prototype.serverFiltering=function(t){var r,u,i,e;if(this.isWorkTasksPro()&&t.parameterCollection.length===0){if(r=window.top.formLookupDataFromAppCache,!n.isUndefinedNullOrEmpty(r)){if(u=r.filter(function(n){return n.Name===t.lookupName}),u.length===1&&(i=u[0],t.displayField=i.DisplayColumn,t.valueField=i.ValueColumn,t.loadMore=!1,!n.isUndefinedNullOrEmpty(i.Data))){var o=$.parseJSON(i.Data),s=t.pageSize>0?t.pageSize:skelta.forms.constants.lookupDefaults.pageSize,h=t.filterText.toString().toLowerCase(),f=o.filter(function(t){var r=t[i.DisplayColumn];return n.isUndefinedNullOrEmpty(r)?!1:r.toString().toLowerCase().indexOf(h)>=0}),c=f.splice(0,s);window.formLookupItems=f;t.lookupItems=c;t.loadMore=f.length>0}t.showLoader=!1;t.showClear=!0}}else e=n.createJsonRequestHelper({appName:skelta.userContext.getUserContextFor("appN"),uId:skelta.userContext.getUserContextFor("uId"),source:t.lookupName,fd:t.filterText,pn:t.pageNumber,ps:t.pageSize>0?t.pageSize:skelta.forms.constants.lookupDefaults.pageSize,lp:this.lookupParameters(t)}),t.xhr=n.requestServer("POST",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/FilterLookupData"),"application/json; charset=utf-8",e,"json",function(n){if(n.d){var i=$.parseJSON(n.d);t.displayField=i.D;t.valueField=i.V;t.loadMore=i.FD==t.filterText&&i.IL>0;t.lookupItems=i.I;t.showClear=!0}else t.lookupItems.length>0&&(t.lookupItems=[]),t.loadMore=!1,t.showLoader=!1,t.showClear=!0},function(n,i){skelta.forms.utilities.onLookupErrorResponse(n,i,t)},null,null,skelta.userContext.getUserContextFor("lookupTimeout"))};t.prototype.getLookupData=function(t){var r,u,i,e;if(this.isWorkTasksPro()&&t.parameterCollection.length===0)if(r=window.top.formLookupDataFromAppCache,n.isUndefinedNullOrEmpty(r))skelta.logger.logError("window.top.formLookupDataFromAppCache is "+window.top.formLookupDataFromAppCache,1,!0);else if(u=r.filter(function(n){return n.Name===t.lookupName}),u.length===1)if(i=u[0],t.displayField=i.DisplayColumn,t.valueField=i.ValueColumn,t.loadMore=!1,n.isUndefinedNullOrEmpty(i.Data))skelta.logger.logError("Data not present for '"+t.lookupName+"'",2,!0);else{var f=$.parseJSON(i.Data),o=t.pageSize>0?t.pageSize:skelta.forms.constants.lookupDefaults.pageSize,s=f.splice(0,o);window.formLookupItems=f;t.lookupItems=s;t.loadMore=f.length>0}else skelta.logger.logError("Data not present for '"+t.lookupName+"'",1,!0);else e=n.createJsonRequestHelper({appName:skelta.userContext.getUserContextFor("appN"),uId:skelta.userContext.getUserContextFor("uId"),source:t.lookupName,pn:t.pageNumber,ps:t.pageSize>0?t.pageSize:skelta.forms.constants.lookupDefaults.pageSize,lp:this.lookupParameters(t)}),t.xhr=n.requestServer("POST",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetLookupData"),"application/json; charset=utf-8",e,"json",function(n){if(n.d){var i=$.parseJSON(n.d);t.displayField=i.D;t.valueField=i.V;t.loadMore=i.IL>0;t.lookupItems=i.I}else t.lookupItems.length>0&&(t.lookupItems=[]),t.showLoader=!1},function(n,i){skelta.forms.utilities.onLookupErrorResponse(n,i,t)},null,null,skelta.userContext.getUserContextFor("lookupTimeout"))};t.prototype.resolveLookupValue=function(t,i){if(t){var r=n.createJsonRequestHelper({appName:skelta.userContext.getUserContextFor("appN"),uId:skelta.userContext.getUserContextFor("uId"),source:i.lookupName,lv:t,lp:this.lookupParameters(i)});i.xhr=n.requestServer("POST",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/ResolveLookupValue"),"application/json; charset=utf-8",r,"json",function(n){var r,u;n.d&&(r=$.parseJSON(n.d),i.displayField=r.DisplayField,i.valueField=r.ValueField,u={},u[i.displayField]=r.DisplayText,u[i.valueField]=t,i.selectedItem=u,i.isItemSelected=!0,i.displayValue=r.DisplayText)},function(n,t){skelta.forms.utilities.onLookupErrorResponse(n,t,i)},null,null,skelta.userContext.getUserContextFor("lookupTimeout"))}};t.prototype.loadLookupTemplate=function(){$("#viewModel").prepend(lookupDiv);$("#viewModel").prepend(lookupScripTemplate);$("#viewModel").prepend(mobilelookupScripTemplate)};t.prototype.loadFormControlLookupTemplate=function(){$("#viewModel").prepend(formsControlLookupDiv);$("#viewModel").prepend(formsControlLookupScripTemplate)};t.prototype.onFilterChanged=function(n,t){t.isItemSelected!=!0?(t.minLength=t.minLength>0?t.minLength:skelta.forms.constants.lookupDefaults.minLength,n.length>=t.minLength?(t.showClear=!1,t.showLoader=!0,t.pageNumber=1,this.serverFiltering(t)):(t.showLoader=!1,t.isMobileMode===!1?this.disposeLookup(t):t.lookupItems=[],t.loadMore=!1)):t.isItemSelected=!1};t.prototype.onItemsChange=function(n,t){if(n.length>0){if(t.isMobileMode===!1){if(t.templateDivBinded===!1){var i=skelta.forms.constants.lookupDefaults.dropdownHeight;t.listingMaxHeight=t.listingMaxHeight>i?t.listingMaxHeight:i;this.dataBindLookupTemplateDiv(t);t.templateDivBinded=!0}this.showLookupListing(t.targetElement,t)}}else t.isMobileMode===!1&&this.disposeLookup(t);t.showLoader=!1;r.logInformation("Loaded Items for lookup "+t.lookupName+": "+n.length)};t.prototype.dataBindMobileDiv=function(n){var t=$("#"+mobileLookupTemplateDiv),i,r;ko.cleanNode(t[0]);t.attr("class",cssClasses.lookupMobile+" "+cssClasses.flexContainer+" "+cssClasses.container+" "+cssClasses.flexDirectionColumn+" "+cssClasses.flexAlignStretch+" "+cssClasses.formMainDiv);i=n.id;r="template: { name:"+i+"._mobileTemplate, data:"+i+"}";t.attr("data-bind",r);ko.applyBindings(n.parentForm,t[0])};t.prototype.showMobileDiv=function(n,t,i){i.enable!==!1&&i.readOnly!==!0&&(i.isMobileMode=!0,i.loadMore=!1,this.dataBindMobileDiv(i),i.showItemsByDefault===!0&&(i.pageNumber=1,this.getLookupData(i)))};t.prototype.onMobileParentClearClick=function(t,i,r){if(r.enable!==!1&&r.readOnly!==!0)if(r.confirmationOnClear===!0){var u=r.confirmationMessageOnClear;u=u===null||u===undefined||u===""?skelta.localize.getString("Are you sure?"):skelta.localize.getString(u);n.showConfirmation("",u,function(n){if(n)skelta.forms.utilities.clearOnMobileLookup(r);else return})}else skelta.forms.utilities.clearOnMobileLookup(r)};t.prototype.clearOnMobileLookup=function(n){n.isItemSelected=!1;n.selectedItem=undefined;n.filterText="";n.displayValue="";n._value("");n.extendedInformation=null};t.prototype.clearLookup=function(n){skelta.forms.utilities.cancelLookupValidation(n);n.showLoader=!1;n.filterText="";n.isItemSelected=!1;n.selectedItem=undefined;n.displayValue="";n.extendedInformation=null;n.targetElement&&$(n.targetElement).val("");skelta.forms.utilities.abortRequest(n);n.lookupItems.length>0&&(n.lookupItems=[]);n.showClear=!1;n.lostFocus=!0};t.prototype.closeMobileView=function(n,t,i){$("."+cssClasses.lookupMobileSelect).attr(dataAttributes.mobileLookupSelectEnabled,"0");this.disposeMobileLookup(i)};t.prototype.disposeMobileLookup=function(n){var t=$("#"+mobileLookupTemplateDiv);ko.cleanNode(t[0]);t.attr("class",cssClasses.lookupMobileHidden);t.text("");n.filterText="";n.lookupItems=[];n.showLoader=!1;n.showClear=!1;n.isMobileMode=!1;delete window.formLookupItems};t.prototype.onLoaderMouseOver=function(n,t){t.showClear=!0};t.prototype.onLoaderMouseOut=function(n,t){t.showLoader===!0&&(t.showClear=!1)};t.prototype.onClearClick=function(t,i){if(i.isMobileMode===!1)if(i.confirmationOnClear===!0&&skelta.forms.utilities.isWorkTasksPro()){var r=i.confirmationMessageOnClear;r=skelta.forms.utilities.isUndefinedNullOrEmpty(r)?skelta.localize.getString("Are you sure?"):skelta.localize.getString(r);n.showConfirmation("",r,function(n){if(n)skelta.forms.utilities.clearLookup(i);else return})}else skelta.forms.utilities.clearLookup(i);else i.showLoader=!1,i.filterText="",i.targetElement&&$(i.targetElement).val(""),skelta.forms.utilities.abortRequest(i),i.lookupItems.length>0&&(i.lookupItems=[]),i.showClear=!1,$("."+cssClasses.lookupMobileSelect).attr(dataAttributes.mobileLookupSelectEnabled,"0")};t.prototype.abortRequest=function(n){n.xhr&&n.xhr.readyState!=4&&(n.xhr.abort(),n.xhr=undefined)};t.prototype.onLoadMoreParentClick=function(n,t,i){skelta.forms.utilities.cancelLookupValidation(i);t.stopImmediatePropagation();return};t.prototype.lookupFocusIn=function(n,t,i){i.enable!==!1&&i.readOnly!==!0&&i.isMobileMode!==!0&&t.type=="focus"&&(i.showClear=$(t.currentTarget).val().length>0,i.targetElement=t.currentTarget)};t.prototype.formsControlLookupFocusIn=function(n,t,i){i.enable!==!1&&i.readOnly!==!0&&t.type=="focus"&&(i.targetElement=t.currentTarget)};t.prototype.lookupFocusOut=function(n,t,i){if(!i.isMobileMode){var r=null,u=$(t.currentTarget).parent().attr("controlid");t.originalEvent&&t.originalEvent.explicitOriginalTarget?r=t.originalEvent.explicitOriginalTarget:t.relatedTarget?r=t.relatedTarget:document.activeElement&&document.activeElement.tagName.toLowerCase()!=="body"&&document.activeElement.tagName.toLowerCase()!=="div"&&(r=document.activeElement);r===null||r===undefined?i.focusedElement=setTimeout(function(){i.filterText="";skelta.forms.utilities.validateLookup(i)},skelta.forms.constants.lookupDefaults.validationTimeout):r.tagName&&$.inArray(r.tagName.toLowerCase(),["button","input","select","textarea"])>-1?(i.filterText="",skelta.forms.utilities.validateLookup(i)):i.focusedElement=setTimeout(function(){i.filterText="";skelta.forms.utilities.validateLookup(i)},skelta.forms.constants.lookupDefaults.validationTimeout);document.activeElement&&document.activeElement.parentElement&&document.activeElement.parentElement.tagName.toLowerCase()==="div"&&document.activeElement.parentElement.className===cssClasses.lookupListing&&(skelta.forms.utilities.cancelLookupValidation(i),setTimeout(function(){i.targetElement.focus()},100))}};t.prototype.formsControlLookupFocusOut=function(n,t,i){var r=null,u=$(t.currentTarget).parent().attr("controlid");t.originalEvent&&t.originalEvent.explicitOriginalTarget?r=t.originalEvent.explicitOriginalTarget:t.relatedTarget?r=t.relatedTarget:document.activeElement&&document.activeElement.tagName.toLowerCase()!=="body"&&document.activeElement.tagName.toLowerCase()!=="div"&&(r=document.activeElement);r===null||r===undefined?i.focusedElement=setTimeout(function(){skelta.forms.utilities.validateFormsControlLookup(i)},skelta.forms.constants.formsControlLookupSystemDefaults.validationTimeout):r.tagName&&$.inArray(r.tagName.toLowerCase(),["button","input","select","textarea"])>-1?skelta.forms.utilities.validateFormsControlLookup(i):i.focusedElement=setTimeout(function(){skelta.forms.utilities.validateFormsControlLookup(i)},skelta.forms.constants.formsControlLookupSystemDefaults.validationTimeout);document.activeElement&&document.activeElement.parentElement&&document.activeElement.parentElement.tagName.toLowerCase()==="div"&&document.activeElement.parentElement.className===cssClasses.formsControlLookupListing&&(skelta.forms.utilities.cancelFormsControlLookupValidation(i),setTimeout(function(){i.targetElement.focus()},100))};t.prototype.lookupKeyDown=function(n,t,i){if(!n.defaultPrevented&&(!n.originalEvent||!n.originalEvent.defaultPrevented)){var f="ArrowDown",e="Down",u=!1,r=n.key;if(n.shiftKey||n.ctrlKey)return!0;if(i.showItemsByDefault&&n.altKey&&(r===f||r===e)){skelta.forms.utilities.onDropdownClick(null,n,i);u=!0}if(i.loadMore&&n.altKey&&r==="PageDown"&&i.isListingVisible===!0&&(setTimeout(function(){skelta.forms.utilities.loadMoreItems(null,n,i)},0),u=!0),!u&&n.altKey)return!0;if(i.showItemsByDefault&&(r==="Delete"||r==="Del"||r==="Backspace")){skelta.forms.utilities.onClearClick(null,i);u=!0}return(i.lookupItems.length>0&&i.isListingVisible===!0&&((r==="ArrowUp"||r==="Up")&&(ot(i,-1),u=!0),u||r!==f&&r!==e||(ot(i,1),u=!0),r==="Enter"&&(wi(i,n),u=!0),(r==="Escape"||r==="Esc")&&(pi(i,n),u=!0)),u)?(n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.cancelBubble=!0,!1):!0}};t.prototype.lookupItemMouseOverHandler=function(n,t,i){i.highlightedItemValue=n[i.valueField]};t.prototype.lookupIsDataItemHighlighted=function(n,t){return t.highlightedItemValue===n};t.prototype.cancelLookupValidation=function(n){n.focusedElement&&(clearTimeout(n.focusedElement),n.focusedElement=null)};t.prototype.cancelFormsControlLookupValidation=function(n){n.focusedElement&&(clearTimeout(n.focusedElement),n.focusedElement=null)};t.prototype.validateLookup=function(n){r.logInformation("lookup validation fired");skelta.forms.utilities.abortRequest(n);skelta.forms.utilities.disposeLookup(n);n.showClear=!1;n.showLoader=!1;var t=$(n.targetElement).val();(t===""||n.isItemSelected===!1&&n.selectedItem===undefined)&&(n.selectedItem=undefined,n.isItemSelected===!1,n.displayValue="",n.value="");n.isMobileMode||(n.lostFocus=!1)};t.prototype.validateFormsControlLookup=function(n){skelta.forms.utilities.disposeFormsControlLookup(n);var t=$(n.targetElement).val();t===""&&n.value===""&&(n.displayValue="",n.value="");n.lostFocus=!1};t.prototype.onDropdownClick=function(n,t,i){i.showItemsByDefault===!0&&i.enable===!0&&i.readOnly===!1&&(skelta.forms.utilities.cancelLookupValidation(i),skelta.forms.utilities.isWorkTasksPro()&&(i.lostFocus=!0),setTimeout(function(){i.targetElement=$(t.currentTarget).parent().find("input")[0];i.pageNumber=1;i.showLoader=!0;skelta.forms.utilities.getLookupData(i);skelta.forms.utilities.isWorkTasksPro()===!1&&(i.lostFocus=!0)},skelta.forms.constants.lookupDefaults.dropDownOpenTimeout))};t.prototype.onFormsControlLookupClick=function(n,t,i){if(i.enable===!0&&i.readOnly===!1){if(i.targetElement=$(t.currentTarget).parent().find("input")[0],skelta.forms.utilities.cancelFormsControlLookupValidation(i),i.displayField="optionText",i.valueField="optionValue",i.lookupItems.length>0){if(i.templateDivBinded===!1){var r=skelta.forms.constants.formsControlLookupSystemDefaults.dropdownHeight;i.listingMaxHeight=i.listingMaxHeight>r?i.listingMaxHeight:r;this.dataBindFormsControlLookupTemplateDiv(i);i.templateDivBinded=!0}this.showFormsControlLookupListing(i.targetElement,i)}i.lostFocus=!0}};t.prototype.onFormsControlLookupClickForPassword=function(n,t,i,r){if(i.enable===!0&&i.readOnly===!1){if(i.targetElement=$(t.currentTarget).parent().find("input")[r],skelta.forms.utilities.cancelFormsControlLookupValidation(i),i.displayField="optionText",i.valueField="optionValue",i.lookupItems.length>0){if(i.templateDivBinded===!1){var u=skelta.forms.constants.formsControlLookupSystemDefaults.dropdownHeight;i.listingMaxHeight=i.listingMaxHeight>u?i.listingMaxHeight:u;this.dataBindFormsControlLookupTemplateDiv(i);i.templateDivBinded=!0}this.showFormsControlLookupListing(i.targetElement,i)}i.lostFocus=!0}};t.prototype.onSearchClick=function(n,t,i){if(i.showItemsByDefault===!1&&i.enable===!0&&i.readOnly===!1&&i.filterText&&i.filterText.length>0){i.targetElement=$(t.currentTarget).parent().find("input")[0];skelta.forms.utilities.cancelLookupValidation(i);this.onFilterChanged(i.filterText,i);i.isMobileMode||(i.lostFocus=!0)}};t.prototype.onLookupErrorResponse=function(t,i,u){if(i!==null)switch(i){case"abort":r.logInformation(skelta.localize.getString("lookupReqCancelled"));break;case"timeout":r.logInformation(skelta.localize.getString("lookupReqTimedout"));n.showError(document.title,skelta.localize.getString("lookupReqTimedout"));break;case"error":r.logInformation(skelta.localize.getString("lookupReqError"));break;default:r.logInformation(skelta.localize.getString("lookupReqError"))}(u.selectedItem||u.filterText&&u.filterText.length>0)&&(u.showClear=!0);u.showLoader=!1};t.prototype.onLookupResponseComplete=function(n,t,i){i.showLoader=!1;i.isMobileMode||(i.lostFocus=!0)};t.prototype.injectLookupSchema=function(t){st(t.findById("LookupName"),null,!0);var i=t.findById("LookupName").schema,r=[];return n.isUndefined(i)||ko.utils.arrayForEach(i,function(n){r.push({optiontext:n,optionvalue:n})}),r};t.prototype.injectLookupSchemaForSecondSource=function(t){st(t.findById("LookupNameForSecondSource"),null,!0);var i=t.findById("LookupNameForSecondSource").schema,r=[];return n.isUndefined(i)||ko.utils.arrayForEach(i,function(n){r.push({optiontext:n,optionvalue:n})}),r};t.prototype.injectLookupColumns=function(t,i,r){var e,f,o,u,s;if(t.topLevelForm.onFormLoad===!0){window.setTimeout(function(){skelta.forms.utilities.injectLookupColumns(t.findById("LookupName"),null,!0)},100);return}if(e=$("[controlid= 'HierarchicalListControl']"),f=t.findById("ColumnMapping"),n.isUndefined(i)&&(i=t.value),this.isUndefinedNullOrEmpty(i)){t.findById("DraggableListItemsForLevel1")._listItems([]);t.findById("DraggableListItemsForLevel2")._listItems([]);t.findById("DraggableListItemsForLevel3")._listItems([]);e.find(".level2").hide();e.find(".level3").hide();t.findById("RepeatingNodeLevel1").value="";t.findById("RepeatingNodeLevel2").value="";o=f.records.peek();o.length===0?(u=f.addRecord(),u.findById("ColumnKey").value="Title01",u.findById("ColumnName").value="",u=f.addRecord(),u.findById("ColumnKey").value="Content01",u.findById("ColumnName").value="",u=f.addRecord(),u.findById("ColumnKey").value="Content02",u.findById("ColumnName").value="",u=f.addRecord(),u.findById("ColumnKey").value="Content03",u.findById("ColumnName").value="",u=f.addRecord(),u.findById("ColumnKey").value="Content04",u.findById("ColumnName").value="",u=f.addRecord(),u.findById("ColumnKey").value="Content05",u.findById("ColumnName").value="",u=f.addRecord(),u.findById("ColumnKey").value="Title02",u.findById("ColumnName").value="",u=f.addRecord(),u.findById("ColumnKey").value="Title03",u.findById("ColumnName").value="",u=f.addRecord(),u.findById("ColumnKey").value="Content06",u.findById("ColumnName").value=""):ko.utils.arrayForEach(o,function(n){n.findById("ColumnName").value=""});s=e.find("[data-columnkey]");ko.utils.arrayForEach(s,function(n){$(n)[0].innerText=$(n).attr("data-columnkey")});return}this.showLoader();window.setTimeout(function(){var y=[],h=[],c=[],o=SFU.getWebAPILookupSchemaAndData(i,null,!0,!1),l,s,u,a,v;if(!n.isUndefined(o)&&o.Columns&&o.Columns.length>0)for(l=o.Columns,s=0;s<l.length;s++){u=l[s].split("//");switch(u.length){case 1:y.push(u[0]);break;case 2:a=t.findById("RepeatingNodeLevel1").value;(a===""||a===u[0])&&(h.push(u[1]),t.findById("RepeatingNodeLevel1").value=u[0]);break;case 3:v=t.findById("RepeatingNodeLevel2").value;(v===""||v===u[1])&&(c.push(u[2]),t.findById("RepeatingNodeLevel2").value=u[1])}}ko.utils.arrayForEach(f.records.peek(),function(n){var t=n.findById("ColumnKey").value,i=n.findById("ColumnName").value;r?t!==""&&i!==""&&(e.find("[data-columnkey='"+t+"']")[0].innerText=i):(e.find("[data-columnkey='"+t+"']")[0].innerText=t,n.findById("ColumnName").value="")});h.length>0?(t.findById("LookupColumnsForLevel2").visible=!0,e.find(".level2").show()):(t.findById("LookupColumnsForLevel2").visible=!1,e.find(".level2").hide(),t.findById("RepeatingNodeLevel1").value="");c.length>0?(t.findById("LookupColumnsForLevel3").visible=!0,e.find(".level3").show()):(t.findById("LookupColumnsForLevel3").visible=!1,e.find(".level3").hide(),t.findById("RepeatingNodeLevel2").value="");t.findById("DraggableListItemsForLevel1")._listItems(y);t.findById("DraggableListItemsForLevel2")._listItems(h);t.findById("DraggableListItemsForLevel3")._listItems(c);skelta.forms.utilities.hideLoader()},100)};t.prototype.clearDataLookupPropertyConfigurationForHierarchicalList=function(n){var i=n.findById("ColumnMapping"),r=i.records.peek(),t;ko.utils.arrayForEach(r,function(n){n.findById("ColumnName").value=""});t=$("[controlid= 'HierarchicalListControl']").find("[data-columnkey]");ko.utils.arrayForEach(t,function(n){$(n)[0].innerText=$(n).attr("data-columnkey")})};t.prototype.getLookupItems=function(t,i){var f=window.parent.skeltaUserContext.getUserContextFor("appN"),e=window.parent.skeltaUserContext.getUserContextFor("uId"),u=[],o=n.createJsonRequestHelper({appName:f,uId:e,lp:i});return $.ajax({type:"GET",async:!1,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/LookupNames"),data:o.getValueForGetRequest(),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(t){if(!n.isUndefined(t)){var r=t.d,i=[];ko.utils.arrayForEach(r,function(n){i.push({optiontext:n,optionvalue:n})});u=i}},error:function(t){r.logError(skelta.localize.getString("FormNGFLookupNamesError")+"\n"+n.getAjaxErrorDetailsMessage(t,"\n"))}}),u};t.prototype.clearDataLookupParameterDictionary=function(n){n.findById("LookupName").value="";n.findById("ParameterDictionary").visible=!1;n.findById("ParameterDictionary").removeAll()};t.prototype.getDataLookupParameterDictionary=function(t,i){var r=n.createJsonRequestHelper({appName:window.parent.skeltaUserContext.getUserContextFor("appN"),uId:window.parent.skeltaUserContext.getUserContextFor("uId"),source:i});n.callServerMethod("GET",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/LookupParameters"),"application/json; charset=utf-8",r,"json",function(n){if(n.d){var i=n.d;t.findById("ParameterDictionary").visible=i&&i.length>0;t.findById("ParameterDictionary").removeAll();ko.utils.arrayForEach(i,function(n){var i=t.findById("ParameterDictionary").addRecord();i.findById("ParameterControl").tagName=n;i.findById("ParameterName").value=n})}},function(){},null)};t.prototype.getDataLookupParameterDictionaryForSankeyLinks=function(t,i){var r=n.createJsonRequestHelper({appName:window.parent.skeltaUserContext.getUserContextFor("appN"),uId:window.parent.skeltaUserContext.getUserContextFor("uId"),source:i});n.callServerMethod("GET",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/LookupParameters"),"application/json; charset=utf-8",r,"json",function(n){if(n.d){var i=n.d;t.findById("ParameterDictionaryForSankeyLinks").visible=i&&i.length>0;t.findById("ParameterDictionaryForSankeyLinks").removeAll();ko.utils.arrayForEach(i,function(n){var i=t.findById("ParameterDictionaryForSankeyLinks").addRecord();i.findById("ParameterControlForSankeyLinks").tagName=n;i.findById("ParameterNameForSankeyLinks").value=n})}},function(){},null)};t.prototype.clearPopupFormParameterDictionary=function(n){n.findById("ParamtereForm").visible=!1;n.findById("ParamtereForm").removeAll()};t.prototype.lookupParameters=function(n){return this.getLookupParameterValues(n,n.parameterCollection)};t.prototype.getPopupFormParametersForDesignTime=function(t,i,u){var f=n.createJsonRequestHelper({applicationName:window.parent.skeltaUserContext.getUserContextFor("appN"),form:i,version:u});n.callServerMethod("GET",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetPopupFormParametersForDesignTime"),"application/json; charset=utf-8",f,"json",function(n){var u=JSON.parse(n.d),i,f,r;if(u.FP){i=u.FP;f=u.FPT;t.findById("ParamtereForm").visible=Object.keys(i).length>0;t.findById("ParamtereForm").removeAll();for(parameter in i)r=t.findById("ParamtereForm").addRecord(),r.findById("ParameterControl").tagName=i[parameter].Name+" ("+f[i[parameter].Type]+")",r.findById("ParameterName").value=i[parameter].Name,r.findById("ParameterType").value=i[parameter].Type}},function(t){n.showError(document.title,skelta.localize.getString("FormNGFErrorInGetFormParameters"));r.logError(skelta.localize.getString("FormNGFErrorInGetFormParameters")+" - "+t.status+" "+t.statusText+" "+t.responseText)},null)};t.prototype.getTypeCastedParameterValue=function(t,i,u){var f,e,o;switch(i.toLowerCase()){case"number":f=Number(u);isNaN(f)===!0&&r.logError(skelta.localize.getString("FormNGFNumConFailed").replace("@@parameter@@",t).replace("@@value@@",u));break;case"string":f=u;break;case"date":e=Date.parse(u);isNaN(e)!==!1||n.isUndefined(e)?r.logError(skelta.localize.getString("FormNGFDateConFailed").replace("@@parameter@@",t).replace("@@value@@",u)):f=new Date(e);break;case"object":try{f=JSON.parse(u)}catch(s){r.logError(skelta.localize.getString("FormNGFObjConFailed").replace("@@parameter@@",t).replace("@@value@@",u))}break;case"array":o=u;try{n.isUndefined(u)||u.toString().startsWithString("[")||u.toString().endsWithString("]")||(o="["+u+"]");f=JSON.parse(o)}catch(s){try{f=u.split(",")}catch(h){r.logError(skelta.localize.getString("FormNGFArrConFailed").replace("@@parameter@@",t).replace("@@value@@",u))}}}return f};t.prototype.getValueFromMultiValueLookup=function(n,t){if(!skelta.utilities.isUndefinedNullOrEmpty(n)&&!skelta.utilities.isUndefinedNullOrEmpty(t)){var r=skelta.utilities.getJSONObjectFromXml("<Data>"+n+"<\/Data>"),i=r.Data[t];return skelta.utilities.isUndefinedNullOrEmpty(i)?"":i}return""};t.prototype.isDisplayValuePresent=function(n,t){return n&&typeof n=="object"&&n.hasOwnProperty(skelta.forms.constants.lookupDefaults.persistDisplayValueAttribute+t)};t.prototype.createExpressionEditorFrame=function(n,t,i,r,u){var e=window.location.href;if(e.indexOf("DataGridEditOperations.htm")!==-1||e.indexOf("DataGridColumnSettings.htm")!==-1){var h=e.indexOf("DataGridEditOperations.htm")!==-1?"DataGridEditOperations":"DataGridColumnSettingsWindow",s="../../NextGenForms/ExpressionEditor.htm?id="+n+"&evtlkpName="+t+"&ctrlId="+i+"&ctrlTagName="+encodeURIComponent(r)+"&scriptType=EditOperations&pageName="+h,f=$(parent.parent.document).find("#scriptFrameDiv"),o=f.find(".skpopup_maindivPopupForm").find("iframe");o.attr("src",s);f.show()}else{var s="ExpressionEditor.htm?id="+n+"&evtlkpName="+t+"&ctrlId="+i+"&ctrlTagName="+encodeURIComponent(r),f=$(parent.document).find("#scriptFrameDiv"),o=f.find(".skpopup_maindivPopupForm").find("iframe");o.attr("src",s);o[0].controlObj=u;f.show()}};t.prototype.invokeWorkflowSourcePropertyClick=function(){createFrame("WorkflowConfiguration.htm","LookupSource")};t.prototype.popupFormSourcePropertyClick=function(){createFrame("PopupFormChooseForm.htm","LookupSource")};t.prototype.attachmentPersistContorlIDPropertyClick=function(){createFrame("PesistControlIDConfiguation.htm","LookupSource")};t.prototype.formConfigurationPropertyClick=function(t,i,r){var u=window.parent.skelta.userContext.getUserContextFor("fName");n.isUndefined(u)&&(u="");createFrame("FormConfiguration.htm?fName="+u+"&xmlNode="+r.xmlNodeBoundTo,"LookupSource")};t.prototype.embeddedFormSourcePropertyClick=function(){var t=window.parent.skelta.userContext.getUserContextFor("fName");n.isUndefined(t)&&(t="");createFrame("EmbeddedFormChooseSource.htm?fName="+t,"LookupSource")};t.prototype.mqttTopicConfigurationPropertyClick=function(n,t,i){var r=i.dataContainerForm.records().indexOf(i.associatedForm);createFrame("MqttTopicConfiguration.htm?&rowIndex="+r,"LookupSource")};t.prototype.reportViewerConfigurationPropertyClick=function(n,t,i){var r=this.getUrlPath("<bpmuitemplates>/SkeltaForms/SSRSReportConfiguration.aspx?sfdcontainer="+i.parentForm.parentForm.id+"&controlid="+sfdcontainer+"&mappedparentid="+i.id+"&cachekey="+cacheKey+"&listname1=Forms List&versionstamp="+versionstamp+"&reportTemplateTitle="+bi()+"&reportViewOption="+this.getReportViewOption()+"&hiddenControlId=hdnReportConfiguration&fromNGF=1");createFrame(r,"ReportViewer")};t.prototype.getReportViewOption=function(){return lt(0)};t.prototype.dataLookupPropertyClick=function(n,t,i){createFrame("DataLookupPropertyConfiguration.htm?caller="+i.xmlNodeBoundTo+"&id="+i.findByXmlNode("Id").value,"LookupSource")};t.prototype.dataLookupPropertyChartClick=function(n,t,i){var r,u;skelta.utilities.isUndefined(i.isSankeyChart)?i.defaultValue===""&&i.value===""?r=!1:(u=i.value,xmlIsSankeyChart=$(u).find("IsSankeyChart").text(),r=xmlIsSankeyChart===""?!1:xmlIsSankeyChart):r=i.isSankeyChart;createFrame("DataLookupPropertyChartConfiguration.htm?caller="+i.xmlNodeBoundTo+"&id="+i.findByXmlNode("Id").value+"&isSankeyChart="+r,"LookupSource")};t.prototype.dataLookupPropertyClickForHierarchicalList=function(n,t,i){var u="DataLookupPropertyConfigurationForHierarchicalList.htm?caller="+i.xmlNodeBoundTo,r=$(parent.document).find("#gridConfigFrameDiv"),f=r.find(".skpopup_maindivPopupForm").find("iframe");f.attr("src",u);r.show()};t.prototype.gridSourcePropertyClick=function(n,t,i){var u="GridSourceConfiguration.htm?id="+i.findByXmlNode("Id").value,r=$(parent.document).find("#gridConfigFrameDiv"),f=r.find(".skpopup_maindivPopupForm").find("iframe");f.attr("src",u);r.show()};t.prototype.getGridParameters=function(t,i){var o,f,s;skelta.forms.utilities.showLoader();var e=t.findById("NF1defaultButton"),r=t.findByXmlNode("cancelButton"),u=t.findByXmlNode("clearButton");if(e.enable=!1,r.enable=!1,u.enable=!1,i===""){t.findById("ParamtereForm").visible=!1;o=t.findById("GC");o.visible=!1;f=$(o.domElement);s=f.data("kendoGrid");s&&(f.data("kendoGrid").destroy(),f.empty());ko.cleanNode(f[0].parentNode);skelta.forms.utilities.hideLoader();e.enable=!0;r.enable=!0;u.enable=!0;return}setTimeout(function(){var f=n.createJsonRequestHelper({appName:window.parent.skeltaUserContext.getUserContextFor("appN"),uId:window.parent.skeltaUserContext.getUserContextFor("uId"),configName:i});n.callServerMethod("GET",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetGridParameters"),"application/json; charset=utf-8",f,"json",function(n){var o,f,s;n.d?(o=$.parseJSON(n.d),o.IsSuccess?(f=o.Parameters,t.findById("ParamtereForm").visible=f&&f.length>0,t.findById("ParamtereForm").removeAll(),ko.utils.arrayForEach(f.reverse(),function(n){var i=t.findById("ParamtereForm").addRecordToTop();i.findById("ParameterControl").tagName=n;i.findById("ParameterName").value=n}),s=t.findById("GC"),s.gridOptions=undefined,skelta.grid.initializeGrid(s,i),e.enable=!0,r.enable=!0,u.enable=!0):(r.enable=!0,u.enable=!0)):(r.enable=!0,u.enable=!0)},function(){r.enable=!0;u.enable=!0},skelta.forms.utilities.hideLoader,!1)},0)};t.prototype.getFormDefinitionForSourceForm=function(t,i,u){(i===""||u==="")&&(t.findByXmlNode("FormDefinition").value="");var e=window.parent.skeltaUserContext.getUserContextFor("appN"),f="",o=n.createJsonRequestHelper({appName:e,formName:i,formVersion:u});$.ajax({type:"GET",async:!1,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetFormDefinitionForSourceForm"),data:o.getValueForGetRequest(),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){f=n.d},error:function(t){r.logError(skelta.localize.getString("EmbeddedFormDefinitionNotFound").replace("<@formName@>",i).replace("<@version@>",u)+"\n"+n.getAjaxErrorDetailsMessage(t,"\n"))}});t.findByXmlNode("FormDefinition").value=f};t.prototype.getFormVersions=function(t,i){if(t==="")return[];i.value="";var f=window.parent.skeltaUserContext.getUserContextFor("appN"),u=[],e=n.createJsonRequestHelper({appName:f,formName:t});return $.ajax({type:"GET",async:!1,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetFormVersions"),data:e.getValueForGetRequest(),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){if(!n.isUndefined(t)){var r=t.d,i=[];i.push({optiontext:skelta.localize.getString("Latest"),optionvalue:"0"});ko.utils.arrayForEach(r,function(n){i.push({optiontext:n,optionvalue:n})});u=i}},error:function(i){r.logError(skelta.localize.getString("FormNGFFormVersionsError").replace("<@formname@>",t)+"\n"+n.getAjaxErrorDetailsMessage(i,"\n"))}}),u};t.prototype.getMappingFormVersions=function(t,i,u,f){if(t===""||i==="")return[];f.value="";var o=window.applicationName,e=[],s=n.createJsonRequestHelper({appName:o,formName:t,workflowName:i,workflowVersion:u});return $.ajax({type:"GET",async:!1,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetFormVersionsWithAssociation"),data:s.getValueForGetRequest(),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){if(!n.isUndefined(t)){var r=t.d,i=[];ko.utils.arrayForEach(r,function(n){i.push({optiontext:n.Key,optionvalue:n.Value})});e=i}},error:function(u){r.logError(skelta.localize.getString("FormNGFFormVersionsAssociatedWithWorkflowError").replace("<@formname@>",t).replace("<@workflowname@>",i)+"\n"+n.getAjaxErrorDetailsMessage(u,"\n"))}}),e};t.prototype.getEmbeddedFormVersions=function(t,i){if(t==="")return[];i.value="";var f=window.parent.skeltaUserContext.getUserContextFor("appN"),u=[],e=n.createJsonRequestHelper({appName:f,formName:t});return $.ajax({type:"GET",async:!1,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetFormVersions"),data:e.getValueForGetRequest(),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){if(!n.isUndefined(t)){var r=t.d,i=[];i.push({optiontext:skelta.localize.getString("Latest"),optionvalue:"0"});ko.utils.arrayForEach(r,function(n){i.push({optiontext:n,optionvalue:n})});u=i}},error:function(i){r.logError(skelta.localize.getString("FormNGFFormVersionsError").replace("<@formname@>",t)+"\n"+n.getAjaxErrorDetailsMessage(i,"\n"))}}),u};t.prototype.getWorkflowVersions=function(t){if(t==="")return[];var u=window.parent.skeltaUserContext.getUserContextFor("appN"),i=[],f=n.createJsonRequestHelper({appName:u,workflowName:t});return $.ajax({type:"GET",async:!1,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetWorkflowVersions"),data:f.getValueForGetRequest(),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){if(!n.isUndefined(t)){var u=t.d,r=[];r.push({optiontext:skelta.localize.getString("Latest"),optionvalue:"0"});ko.utils.arrayForEach(u,function(n){r.push({optiontext:n,optionvalue:n})});i=r}},error:function(i){r.logError(skelta.localize.getString("FormNGFWorkflowVersionsError").replace("<@name@>",t)+"\n"+n.getAjaxErrorDetailsMessage(i,"\n"))}}),i};t.prototype.isItemQuickflow=function(t){if(t==="")return[];var u=window.parent.skeltaUserContext.getUserContextFor("appN"),i=[],f=n.createJsonRequestHelper({appName:u,workflowName:t});return $.ajax({type:"GET",async:!1,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/IsItemQuickflow"),data:f.getValueForGetRequest(),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){n.isUndefined(t)||(i=t.d)},error:function(i){r.logError(skelta.localize.getString("FormNGFQuickflowCheckError").replace("<@name@>",t)+"\n"+n.getAjaxErrorDetailsMessage(i,"\n"))}}),i};t.prototype.getMultiValueSeperator=function(n){return n===!0?skelta.forms.constants.multiValueSeperator.forms2011:skelta.forms.constants.multiValueSeperator.forms};t.prototype.isFormInEditMode=function(){var n=skelta.userContext.getUserContextFor("appN"),t=skelta.userContext.getUserContextFor("itemId"),i=skelta.userContext.getUserContextFor("vStamp"),r=skelta.forms.utilities.getFormUniqueKey(n,t,i),u=skelta.forms.utilities.getDataModelObject(r);return skelta.utilities.isUndefined(u)?!1:!0};t.prototype.getCssColors=function(t){if(n.isUndefined(t)||Object.prototype.toString.call(t)==="[object Array]"&&t.length<1)return"skddforeColor skddbackColor";var i="";return(n.isUndefined(t.foreColor)||t.foreColor==""||t.foreColor==skelta.forms.constants.colorCode.none)&&(i="skddforeColor"),(n.isUndefined(t.backColor)||t.backColor==""||t.backColor==skelta.forms.constants.colorCode.none)&&(i.length>0&&(i+=" "),i+="skddbackColor"),i};t.prototype.getFormLinkParameters=function(t,i,u,f){var e=n.createJsonRequestHelper({fl:t,app:i,fn:u,fv:f});n.callServerMethod("GET","NextGenFormService.aspx/GetFormLinkFormParameters","application/json; charset=utf-8",e,"json",function(n){var t=JSON.parse(n.d);v(t)},function(){r.logError(skelta.localize.getString("FormNGFErrorFormLinkParams"))},null,!1)};t.prototype.getDateTimeInStringFormat=function(n,t){if(n instanceof Date&&t)return kendo.toString(n,t)};t.prototype.getGridValue=function(n){return n.controlType=="Grid"?skelta.grid.getGridValue(n):null};t.prototype.printForm=function(t,i){var e;if(n.isUndefined(skelta.DeviceOS)||skelta.DeviceOS==="Web"){var o=i.printableSourceForm,r,u,f,s=skelta.userContext.getUserContextFor("fName"),h=skelta.userContext.getUserContextFor("vStamp"),c=skelta.userContext.getUserContextFor("itemId");o!==""?(e=o.split("~"),r=e[0],u=e[1],f=""):(r=s,u=h,f=c);var v=n.getUriObjectFromWindow(),y=v.getPageNameWithoutExtension(),l=screen.width,a=screen.height,p=screen.width/2-l/2,w=screen.height/2-a/2,b=skelta.userContext.getUserContextFor("appN"),k=skelta.userContext.getUserContextFor("uId"),d="PrintForm.htm?appN="+b+"&uId="+encodeURIComponent(k)+"&parentFName="+s+"&parentVStamp="+h+"&printFName="+r+"&printVStamp="+u+"&pageName="+y+"&parentItemId="+c+"&printItemId="+f;window.open(d,"frame","resizable=yes,directories=no,titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=1,height="+a+",width="+l+", top="+w+", left="+p+"")}else n.showAlert("",skelta.localize.getString("FormNGFPrintFormNotSupportedOnDevicesMsg"))};t.prototype.subscribeToControlParameters=function(n,t,i,r){ko.computed(function(){var e,l,v,y;if(n.topLevelForm.isFormLoaded()===!0){if(n.subscribeToControlParametersComplete===!0)return;var s=!1,f="",h={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm};for(skelta.utilities.isObject(r)&&(h=r),e=0;e<t.length;e++){var o=t[e].value,a=t[e].xmlNode,c,u;o.indexOf(",")>-1?(l=o.split(","),u=n.findById(l[0],h),skelta.forms.utilities.isUndefined(u)?(s=!0,f+=f===""?l[0]:", "+l[0]):u.controlType==="Grid"?c=u._selectedValue:u.controlType==="LookupInput"&&(c=u._value)):(u=skelta.utilities.isUndefined(a)?n.findById(o,h):n.findByXmlNode(a,h),skelta.forms.utilities.isUndefined(u)?(s=!0,f+=f===""?o:", "+o):c=u._value);s===!1&&c.subscribe(function(){i.call()})}n.subscribeToControlParametersComplete=!0;s&&(v=n.tagName!==""?n.tagName+" ("+n.id+")":n.id,y=skelta.localize.getString("FormsNGFErrorGridParameterNotFound").replace("<@GridControl@>",v).replace("<@ParamControl@>",f),skelta.forms.utilities.logErrorWithAlert(y))}})};t.prototype.getLookupSchemaAndData=function(t,i,u,f){var o={},l,a,e,h,s,v,y,c;if(this.isWorkTasksPro()&&(skelta.utilities.isUndefined(i)||i.length===0)&&(l=window.top.formLookupDataFromAppCache,l!=null&&(a=l.filter(function(n){return n.Name===t}),e=a[0],!n.isUndefinedNullOrEmpty(e)&&!n.isUndefinedNullOrEmpty(e.Data)))){if(h=[],s=$.parseJSON(e.Data),s.length>1e3)for(v=s.length,y=v/1e3,c=0;c<1e3;c++)h.push(s[parseInt(y*c)]);else h=s;return o={DisplayColumn:e.DisplayColumn,ValueColumn:e.ValueColumn,Data:e.Data?h:[]}}if(this.isUndefined(t)||t==="")return null;(this.isUndefined(f)||typeof f!="boolean")&&(f=!0);var u=!this.isUndefined(u)&&typeof u=="boolean"?u:!1,p=this.isUndefined(i)?[]:i,w=this.createJsonRequestHelper({app:skelta.userContext.getUserContextFor("appN"),userId:skelta.userContext.getUserContextFor("uId"),source:t,parameters:p,allColumnsRequired:u,isDataRequired:f});return $.ajax({type:"POST",async:!1,contentType:"application/json; charset=utf-8",data:w.getValueForPostRequest(),url:this.getServerUrl("NextGenFormService.aspx/GetLookupSchemaAndData"),dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(i){var r=$.parseJSON(i.d),u;r.IsSuccess?o={DisplayColumn:r.DisplayColumn,ValueColumn:r.ValueColumn,Data:r.Data,Columns:r.Columns}:(o={DisplayColumn:"",ValueColumn:"",Data:[],Columns:[]},u=skelta.localize.getString("FormNGFGetLookupSchemaAndDataError").replaceString("<@lookupname@>",t),n.showError(document.title,u))},error:function(i){o={DisplayColumn:"",ValueColumn:"",Data:[],Columns:[]};var u=skelta.localize.getString("FormNGFGetLookupSchemaAndDataError").replaceString("<@lookupname@>",t);n.showError(document.title,u);r.logError(u+"\n"+i.status+"\n"+i.statusText+"\n"+i.responseText)}}),o};t.prototype.getWebAPILookupSchemaAndData=function(t,i,u,f){var e={},c,y,p,o,s,h,l,a,v,w;if(this.isWorkTasksPro()&&(skelta.utilities.isUndefined(i)||i.length===0)){if(c=window.top.formLookupDataFromAppCache,y=/\[\r\n/,c!=null&&(p=c.filter(function(n){return n.Name===t}),o=p[0],!n.isUndefinedNullOrEmpty(o.Data))){for(s=$.parseJSON(o.Data),h=0;h<s.length;h++){l=s[h];for(a in l)v=l[a],w=y.test(v),w===!0&&(s[h][a]=$.parseJSON(v))}e={DisplayColumn:o.DisplayColumn,ValueColumn:o.ValueColumn,Data:s}}}else{if(this.isUndefined(t)||t==="")return null;(this.isUndefined(f)||typeof f!="boolean")&&(f=!0);var u=!this.isUndefined(u)&&typeof u=="boolean"?u:!1,b=this.isUndefined(i)?[]:i,k=this.createJsonRequestHelper({app:skelta.userContext.getUserContextFor("appN"),userId:skelta.userContext.getUserContextFor("uId"),source:t,parameters:b,allColumnsRequired:u,isDataRequired:f});$.ajax({type:"POST",async:!1,contentType:"application/json; charset=utf-8",data:k.getValueForPostRequest(),url:this.getServerUrl("NextGenFormService.aspx/GetWebAPILookupSchemaAndData"),dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(i){var r=$.parseJSON(i.d),u;r.IsSuccess?e={DisplayColumn:r.DisplayColumn,ValueColumn:r.ValueColumn,Data:r.Data,Columns:r.Columns}:(e={DisplayColumn:"",ValueColumn:"",Data:[],Columns:[]},u=skelta.localize.getString("FormNGFGetLookupSchemaAndDataError").replaceString("<@lookupname@>",t),n.showError(document.title,u))},error:function(i){e={DisplayColumn:"",ValueColumn:"",Data:[],Columns:[]};var u=skelta.localize.getString("FormNGFGetLookupSchemaAndDataError").replaceString("<@lookupname@>",t);n.showError(document.title,u);r.logError(u+"\n"+i.status+"\n"+i.statusText+"\n"+i.responseText)}})}return e};t.prototype.getLookupParameterValues=function(t,i){if(n.isUndefined(i)||i===[])return[];var f=[],e,u,r,o={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm};return ko.utils.arrayForEach(i,function(n){u="";n.value.indexOf(",")>-1?(r=t.findById(n.value.split(",")[0],o),skelta.utilities.isUndefined(r)||(r.controlType=="LookupInput"?u=skelta.forms.utilities.getValueFromMultiValueLookup(r.value,n.value.split(",")[1]):r.controlType==="Grid"&&r.selectedValue&&(u=r.selectedValue[n.value.split(",")[1]]))):(r=t.findById(n.value,o),u=skelta.utilities.isUndefined(r)?"":r.value);e=n.key;skelta.utilities.isUndefined(u)&&(u="");f.push({Name:e,Value:u})}),f};t.prototype.getUserRoles=function(t){var i="",u=skelta.userContext.getUserContextFor("uId"),o=skelta.userContext.getUserContextFor("appN"),f=!1,e;return skelta.forms.utilities.isWorkTasksPro()&&(f=!0),e=this.createJsonRequestHelper({userId:u,app:o,uIdForRole:this.isUndefined(t)?"":t,isWorkTasksPro:f}),$.ajax({type:"GET",async:!1,contentType:"application/json; charset=utf-8",data:e.getValueForGetRequest(),url:this.getServerUrl("NextGenFormService.aspx/GetUserRoles"),dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(t){var r=$.parseJSON(t.d);r.IsSuccess?i=r.Roles:r.ErrorMessage==="FormNGFInvalidLoggedInUserId"?n.showError(document.title,skelta.localize.getString("FormNGFInvalidLoggedInUserId"),function(){skelta.forms.utilities.callFormCloseEvent()}):n.showError(document.title,r.ErrorMessage)},error:function(i){var f=skelta.localize.getString("FormNGFGetUserRolesError").replaceString("<@userid@>",n.isUndefined(t)||t===""?u:t);n.showError(document.title,f);r.logError(f+"\n"+n.getAjaxErrorDetailsMessage(i,"\n"))}}),i};t.prototype.getUserMemberOf=function(t){var i="",u=skelta.userContext.getUserContextFor("uId"),o=skelta.userContext.getUserContextFor("appN"),f=!1,e;return skelta.forms.utilities.isWorkTasksPro()&&(f=!0),e=this.createJsonRequestHelper({userId:u,app:o,uIdForRole:this.isUndefined(t)?"":t,isWorkTasksPro:f}),$.ajax({type:"GET",async:!1,contentType:"application/json; charset=utf-8",data:e.getValueForGetRequest(),url:this.getServerUrl("NextGenFormService.aspx/GetUserMemberOf"),dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(t){var r=$.parseJSON(t.d);r.IsSuccess?i=r.Roles:r.ErrorMessage==="FormNGFInvalidLoggedInUserId"?n.showError(document.title,skelta.localize.getString("FormNGFInvalidLoggedInUserId"),function(){skelta.forms.utilities.callFormCloseEvent()}):n.showError(document.title,r.ErrorMessage)},error:function(i){var f=skelta.localize.getString("FormNGFGetUserRolesError").replaceString("<@userid@>",n.isUndefined(t)||t===""?u:t);n.showError(document.title,f);r.logError(f+"\n"+n.getAjaxErrorDetailsMessage(i,"\n"))}}),i};t.prototype.getValueForRightCode=function(t,i){var e=!1,u=skelta.userContext.getUserContextFor("uId"),f,o,s,h;return n.isArray(t)?(skelta.forms.utilities.isWorkTasksPro()&&(e=!0),s=skelta.userContext.getUserContextFor("appN"),h=this.createJsonRequestHelper({userId:u,app:s,rightsCollection:t,uIdForRights:this.isUndefined(i)?"":i,isWorkTasksPro:e}),$.ajax({type:"POST",async:!1,contentType:"application/json; charset=utf-8",data:h.getValueForPostRequest(),url:this.getServerUrl("NextGenFormService.aspx/GetValueForRightCode"),dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(t){var i=$.parseJSON(t.d);i.IsSuccess?o=i.RightCodes:i.ErrorMessage==="FormNGFInvalidLoggedInUserId"?n.showError(document.title,skelta.localize.getString("FormNGFInvalidLoggedInUserId"),function(){skelta.forms.utilities.callFormCloseEvent()}):n.showError(document.title,i.ErrorMessage)},error:function(t){var f=skelta.localize.getString("FormNGFGetValueForRightCodeError").replaceString("<@userid@>",n.isUndefined(i)||i===""?u:i);n.showError(document.title,f);r.logError(f+"\n"+n.getAjaxErrorDetailsMessage(t,"\n"))}}),o):(f=skelta.localize.getString("FormNGFGetValueForRightCodeErrorInvalidInput").replaceString("<@userid@>",n.isUndefined(i)||i===""?u:i),n.showError(document.title,f),r.logError(f),"")};t.prototype.getUserSecurityGroup=function(t){var i="",u=skelta.userContext.getUserContextFor("uId"),o=skelta.userContext.getUserContextFor("appN"),f=!1,e;return skelta.forms.utilities.isWorkTasksPro()&&(f=!0),e=this.createJsonRequestHelper({userId:u,app:o,uIdForSecurityGroup:this.isUndefined(t)?"":t,isWorkTasksPro:f}),$.ajax({type:"GET",async:!1,contentType:"application/json; charset=utf-8",data:e.getValueForGetRequest(),url:this.getServerUrl("NextGenFormService.aspx/GetUserSecurityGroup"),dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(t){var r=$.parseJSON(t.d);r.IsSuccess?i=r.SecurityGroup:r.ErrorMessage==="FormNGFInvalidLoggedInUserId"?n.showError(document.title,skelta.localize.getString("FormNGFInvalidLoggedInUserId"),function(){skelta.forms.utilities.callFormCloseEvent()}):n.showError(document.title,r.ErrorMessage)},error:function(i){var f=skelta.localize.getString("FormNGFGetUserSecurityGroupError").replaceString("<@userid@>",n.isUndefined(t)||t===""?u:t);n.showError(document.title,f);r.logError(f+"\n"+n.getAjaxErrorDetailsMessage(i,"\n"))}}),i};t.prototype.callFormCloseEvent=function(){var n=skelta.userContext.getUserContextFor("appN"),t=skelta.userContext.getUserContextFor("vStamp"),i=skelta.userContext.getUserContextFor("itemId"),r=skelta.forms.utilities.getFormUniqueKey(n,i,t),u=skelta.forms.utilities.getViewModelObject(r);u.topLevelForm.cancelButtonClick()};t.prototype.expressionEditorDelete=function(n,t,i){if(i.enable===!0&&i.readOnly===!1){i.value="";i.isExpression=!1;var r=$(t.currentTarget).closest(".skel");r.next().find("input").focus()}};t.prototype.expressionEditorClick=function(t,i,r){var y;if(r.enable===!0&&r.readOnly===!1){expressionEditorControl=r;var p=skelta.userContext.getUserContextFor("appN"),u=n.getUrlParameterValue(window,"WorkflowName"),f=n.getUrlParameterValue(window,"FileName"),e=n.getUrlParameterValue(window,"TemplateName"),o=n.getUrlParameterValue(window,"Cul"),s=n.getUrlParameterValue(window,"pdsuri"),h=n.getUrlParameterValue(window,"SkDii"),c=n.getUrlParameterValue(window,"selectedaction"),l=n.getUrlParameterValue(window,"selectedProperty"),a=n.getUrlParameterValue(window,"controlName"),v=n.getUrlParameterValue(window,"IsQuickflow");if(u===undefined||f===undefined||e===undefined||o===undefined||s===undefined||h===undefined||c===undefined||l===undefined||a===undefined||v==undefined){n.showError(document.title,skelta.localize.getString("FormNGFExpressionEditorError"));return}y="../ProcessDesigner/ExpressionEditor.aspx?ApplicationName="+p+"&WorkflowName="+u+"&FileName="+f+"&TemplateName="+e+"&Cul="+o+"&pdsuri="+s+"&SkDii="+h+"&selectedAction="+c+"&selectedProperty="+l+"&controlName="+a+"&IsQuickflow="+v;window.open(y,"Expression Editor","width=840px,height=490px,resizable=yes,scrollbars=no,toolbars=0")}};t.prototype.setExpressionEditor=function(n){expressionEditorControl.isExpression=!0;expressionEditorControl.value=JSON.stringify(n);expressionEditorControl=undefined};t.prototype.getExpressionEditor=function(){if(expressionEditorControl.isExpression){var n=expressionEditorControl.value;if(n)return JSON.parse(n)}};t.prototype.getWidgetFormUrl=function(t,i,r,u){var f="",e;if(WW_isWorkTasksPro()){r===""&&(r="0");e=SFU.getGuId();$(window).one("beforeunload."+e,function(){e=""});window.top.getFormByTitleAndVersion(i+"~"+r,function(i){e!==""&&skelta!==undefined&&skelta!==null&&skelta.userContext!==undefined&&skelta.userContext!==null&&(f=n.isUndefinedNullOrEmpty(i)||n.isUndefinedNullOrEmpty(i.Id)?"":SFU.getWidgetFormUrlForMobile(t),u(f))})}else f=SFU.getFormUrl(i,r),u(f)};t.prototype.getWidgetFormUrlForMobile=function(t){var o,s,i,r,u,f;if(!skelta.forms.utilities.isWorkTasksPro())return"";var l=skelta.utilities.getUriObjectFromWindow(),s=l.getPageNameWithoutExtension(),a=skelta.DeviceOS,v=skelta.userContext.getUserContextFor("appN"),y=skelta.userContext.getUserContextFor("uId"),p=skelta.userContext.getUserContextFor("fName"),w=t.id,e=t.widgetFormSource,h="",c="";return skelta.utilities.isUndefined(e)||e===""||(o=e.split("~"),h=o[0],c=o[1]),s="WidgetForm_2023.htm",i=n.getUrlParameterValue(window,"urlPath"),n.isUndefinedNullOrEmpty(i)&&(i=n.getUrlParameterValue(window.parent,"urlPath")),r=skelta.forms.constants.popupFormContants.HtmRelativePath+s+"?dType="+a+"&appN="+v+"&uId="+encodeURIComponent(y)+"&fName="+h+"&vStamp="+c+"&parentfName="+p+"&controlid="+w+"&urlPath="+encodeURIComponent(i),u=skelta.userContext.getUserContextFor("skSasToken"),skelta.utilities.isUndefined(u)||u===""||(r+="&skSasToken="+encodeURIComponent(u)),f=skelta.userContext.getUserContextFor("deviceId"),skelta.utilities.isUndefined(f)||f===""||(r+="&deviceId="+encodeURIComponent(f)),r};t.prototype.getFormUrl=function(t,i){var f,e,o,u,s;if(this.isWorkTasksPro())return"";if(typeof i=="number")i=i.toString();else if(!(typeof i=="string"||this.isUndefined(i)))return r.logError(skelta.localize.getString("FormNGFInvalidVersionType")),"";if(t){if(s=this.createJsonRequestHelper({app:skelta.userContext.getUserContextFor("appN"),uId:skelta.userContext.getUserContextFor("uId"),form:t,version:i?i:""}),n.callServerMethod("GET",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetFormsUri"),"application/json; charset=utf-8",s,"json",function(n){u=n.d;u&&(f=u.uri,e=u.id,o=u.ver)},function(t){r.logError(skelta.localize.getString("FormNGFAjaxFailFormsURI")+"\n"+n.getAjaxErrorDetailsMessage(t,"\n"))},null,!1),u){var h="BPMUITemplates/Default/",c=window.location.href,a=c.toLowerCase().indexOf(h.toLowerCase()),l=c.substring(0,a+h.length)+"NextGenForms/";if(f)return l+"InstanceForm.htm?"+f;if(e&&o){var v=n.getUrlParameterValue(window,"appN"),y=n.getUrlParameterValue(window,"uId"),p=n.getUrlParameterValue(window,"v"),w=n.getUrlParameterValue(window,"dType"),b=n.getUrlParameterValue(window,"listName")?n.getUrlParameterValue(window,"listName"):"Forms List",k=n.getUrlParameterValue(window,"urlPath");return l+"InstanceForm.htm?appN="+v+"&uId="+y+"&fName="+t+"&vStamp="+o+"&listName="+b+"&itemId="+e+"&v="+p+"&dType="+w+"&urlPath="+k+queryString}}}else r.logError(skelta.localize.getString("FormNGFFormURLAPIEmptyForm"));return""};t.prototype.navigateTo=function(t,i){var h=i.skException,c,e,f,u,l,o;if(h){i.skException=undefined;r.logError(skelta.localize.getString("FormNGFNavigationCancelled").replaceString("<@emessage@>",h.message));return}if(u=skelta.utilities.getUriObjectFromWindow(),c=u.getPageNameWithoutExtension(),!skelta.utilities.isUndefinedNullOrEmpty(u.getParameterValue(WW_IFRAME_PARAMETERNAME_FORMUNIQUEID))||c.toLowerCase().indexOf("popupform")>-1&&(this.isWorkTasksPro()||u.getParameterValue("isNewWindow")==="0")){e=skelta.localize.getString("FormNGFNavigationCannotBePerformed");r.logWarning(e);SFU.showAlert(document.title,e);return}if(this.isWorkTasksPro())f=skelta.utilities.createMessageObjectForWorkTasks(),f.msgType="navigateToForm",f.msgData=i.navigateToForm,window.top.postMessage(JSON.stringify(f),"*");else if(t)skelta.DeviceOS==="WorkTasksPreview"&&(t+="&dType="+skelta.DeviceOS),u=skelta.utilities.getUriObjectFromWindow(window),l=skelta.utilities.getUriObjectFromString(t),$.each(l.parameters,function(n,t){u.removeParameter(t.key)}),u.parameters.length>0&&(o=u.joinParameters("&"),o.length>0&&(t+="&"+o)),window.location.href=t;else{var s=i.navigateToForm.split("~"),v=s[1]==="0"?skelta.localize.getString("Latest"):s[1],a=skelta.localize.getString("FormNGFNavigateBtnUrlEmpty").replaceString("<@title@>",s[0]).replaceString("<@version@>",v);r.logError(a);n.showError(document.title,a)}};t.prototype.getContainerMembers=function(n){var t=[],u,e,f,i,r;if(n==="topLevelForm")return u=$.grep(skelta.forms.constants.controlsCollection,function(n){return n.controlType==="TopLevelForm"}),u.length>0&&($.each(u[0].functions,function(i,r){r.name!==n&&t.push(r.name)}),$.each(u[0].properties,function(n,i){t.push(i.propertyName)})),t;if(e=n==="associatedForm"?"dataContainerForm":"associatedForm",(n==="associatedForm"||n==="dataContainerForm")&&(f=$.grep(skelta.forms.constants.controlsCollection,function(n){return n.controlType==="BaseForm"}),f.length>0)){if(i=$.grep(f[0].functions,function(n){return n.applicableTo!==e}),i.length>0)for(r=0;r<i.length;r++)i[r].name!==n&&t.push(i[r].name);$.each(f[0].properties,function(n,i){t.push(i.propertyName)})}return t};t.prototype.padZeroes=function(n,t){return this.padString(n,t,"0",!0)};t.prototype.padString=function(n,t,i,r){try{var u=String(n)||"";if(i=String(i)||"",r=this.isBoolean(r)?r:!1,t=parseInt(t),t<1||i.length<1)return n;for(i.length>1&&(i=i.substr(0,1));u.length<t;)u=r?i+u:u+i;return u}catch(f){this.getLogger().logError("The pad string could not be done.")}return str};t.prototype.getGuId=function(){for(var t,n="",r="0123456789abcdef".split(""),i=0;i<32;i++){t=Math.floor(Math.random()*16);switch(i){case 8:n+="-";break;case 12:t=4;n+="-";break;case 16:t=t&3|8;n+="-";break;case 20:n+="-"}n+=r[t]}return n};t.prototype.toTitleCase=function(n){return n.replace(/\w\S*/g,function(n){return n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()})};t.prototype.actionItemEditClick=function(n,t){var r=$(t.currentTarget).closest(".skActionBar_mainBox").find("[ActionBarTree='ActionItems']").data("kendoTreeView"),i=r.select();i&&i.length>0?createFrame("EditActionItem.htm","LookupSource"):SFU.showAlert(document.title,skelta.localize.getString("skAtionItem_noItemSelected"))};t.prototype.getActionBarItems=function(n){var r="<ActionBarItems>"+$("<div><\/div>").html(n).text()+"<\/ActionBarItems>",t=SFU.getJSONObjectFromXml(r),i=$.isArray(t.ActionBarItems.ActionBarItem)?t.ActionBarItems.ActionBarItem:[t.ActionBarItems.ActionBarItem];return $.each(i,function(n,t){var i=t.items.ActionBarItem;t.items=$.isArray(i)?i:i?[i]:[]}),i};t.prototype.actionItemDeleteClick=function(n,t){var i=$(t.currentTarget).closest(".skActionBar_mainBox").find("[ActionBarTree='ActionItems']").data("kendoTreeView"),r=i.select();r.length>0&&SFU.showConfirmation(document.title,skelta.localize.getString("skActionItem_delete_confirmation"),function(n){var f,t,u;n&&(i.remove(r),f=i.dataSource.data(),f.length===0?(skelta.actionbar.itemNumber=0,u=skelta.actionbar.defaultNode(SFU.getGuId()),i.append(u),t=i.dataSource.get(u.id).uid):(skelta.actionbar.itemNumber=skelta.actionbar.itemNumber-1,t=i.dataSource.data()[0].uid),i.select(i.findByUid(t)))})};t.prototype.actionItemAddClick=function(n,t){var r=$(t.currentTarget).closest(".skActionBar_mainBox").find("[ActionBarTree='ActionItems']").data("kendoTreeView"),s=r.select(),u=skelta.actionbar.defaultNode(this.getGuId()),f,e,o;for(i=1;i<1e4;i++)if(f=skelta.localize.getString("skNewActionItem")+i,e=r.findByText(f),e.length===0){u.text=f;break}r.insertAfter(u,s);o=r.dataSource.get(u.id).uid;r.select(r.findByUid(o))};t.prototype.getActionItemHoverImage=function(n,t){var i=n.split(".").pop(),r=n.slice(0,-(i.length+1));return r+t+"."+i};t.prototype.actionBarItems=function(t){function i(t,r,u){var f={},s=["parameterControl","script","_enable","_visible","hoverImage"],e,h,o;u===!0&&s.push("visible");for(e in t)$.inArray(e,s)===-1&&(e==="openMode"?f.OpenMode=n.isUndefinedNullOrEmpty(t[e])?"Popup":t[e]:e==="actionType"?!t.items.length>0&&(h=t.actionType==="2"?t.script:null,f.Action="",f.OnClick=u===!0?"":"skelta.actionbar.performAction('"+t.actionType+"', '"+t.parameterControl+"',"+h+", "+r+");"):e==="items"?$.isArray(t[e])&&t[e].length>0?(f.Action="",f.OnClick="",o=[],$.each(t[e],function(n,t){var f=i(t,r,u);o.push(f)}),f.SubItems=o):f.SubItems=[]:f[skelta.forms.utilities.toTitleCase(e)]=t[e]);return n.isUndefinedNullOrEmpty(f.Image)||(f.Image=skelta.forms.utilities.getImagePath(f.Image),f.HoverImage=skelta.forms.utilities.getActionItemHoverImage(f.Image,"-Hover")),f}var u=t.isDesignMode===!0?t.items:t.vm.actionbar.items,r=[];return $.each(u,function(n,u){var f={};f[u.text]=i(u,t.vmString,t.isDesignMode);r.push(f)}),r};t.prototype.loadDesignTimeActionBar=function(n){if(n.enableActionBar===!1){$(".actionBarWrapper").hide();return}n.isDesignMode=!0;var t=skelta.forms.utilities.actionBarItems(n);if(t.length===0){$(".actionBarWrapper").hide();return}ActionBarDesigner.init(t,"DivActionBar",!1)};t.prototype.getActionBarItemByName=function(n,t){var r,i=[];return $.each(n,function(n,u){t===u.text&&(r=u,i.push(u));$.isArray(u.items)&&u.items.length>0&&$.each(u.items,function(n,u){t===u.text&&(r=u,i.push(u))})}),i.length>1?i:r};t.prototype.initializePopupform=function(){var t;n.isUndefined(window.opener)||(t=window.opener.document.getElementById("skloader"),n.isUndefined(t)||($(t).attr("data-skloader","1"),$(t).empty()));skelta.DeviceOS=n.getUrlParameterValue(window,"dType");n.isUndefined(skelta.DeviceOS)&&(skelta.DeviceOS="Web");var i=n.getUrlParameterValue(window,"fName"),r=n.getUrlParameterValue(window,"vStamp"),u=n.createJsonRequestHelper({lastModifiedLocaleTime:skelta.userContext.getUserContextFor("lastModifiedLocaleTime"),userId:decodeURIComponent(n.getUrlParameterValue(window,"uId")),appName:n.getUrlParameterValue(window,"appN"),formName:i,version:r,listName:"Forms List"});n.callServerMethod("POST","NextGenFormService.aspx/InitializePopupForm","application/json; charset=utf-8",u,"json",ki,e,null,!1)};t.prototype.initializePreviewForm=function(){skelta.DeviceOS=n.getUrlParameterValue(window,"dType");n.isUndefined(skelta.DeviceOS)&&(skelta.DeviceOS="Web");skelta.DeviceOS==="WorkTasksPreview"&&$("html").addClass("skep skdroid");var t=n.createJsonRequestHelper({secUri:n.getUrlParameterValue(window,"lcsuri"),rightCodes:["ActionViewItemDetails"],deviceType:skelta.DeviceOS,lastModifiedLocaleTime:skelta.userContext.getUserContextFor("lastModifiedLocaleTime")});n.callServerMethod("GET","NextGenFormService.aspx/InitializePreviewForm","application/json; charset=utf-8",t,"json",tr,e,this.hideLoader,!1)};t.prototype.initializeInstanceForm=function(){var t,i,r,f;skelta.DeviceOS=n.getUrlParameterValue(window,"dType");n.isUndefined(skelta.DeviceOS)&&(skelta.DeviceOS="Web");skelta.DeviceOS==="WorkTasksPreview"&&$("html").addClass("skep skdroid");var o=n.getUrlParameterValue(window,"lcsuri"),s=n.getUrlParameterValue(window,"FromIntouch")==="True",u=n.getUrlParameterValue(window,"GKey");(s===!1||n.isUndefined(u))&&(u="");t=n.getUrlParameterValue(window,"FormLink");(n.getUrlParameterValue(window,"IsFormLink")!=="true"||n.isUndefined(t))&&(t="");i=n.getUrlParameterValue(window,"DashboardLink");n.isUndefined(i)&&(i="");r=n.getUrlParameterValue(window,"TabId");n.isUndefined(r)&&(r="");f=n.createJsonRequestHelper({secUri:o,rightCodes:["CanConsumeItem","ActionFillForm"],deviceType:skelta.DeviceOS,lastModifiedLocaleTime:skelta.userContext.getUserContextFor("lastModifiedLocaleTime"),guidKey:u,formLink:t,dashboardLink:[i,r]});n.callServerMethod("GET","NextGenFormService.aspx/InitializeInstanceForm","application/json; charset=utf-8",f,"json",rr,e,null,!1)};t.prototype.initializeFormForMobile=function(){var u,f,e,i,r,s,h,t,c;skelta.DeviceOS=n.getUrlParameterValue(window,"dType");skelta.userContext.setUserContextFor("appN",n.getUrlParameterValue(window,"appN"));skelta.userContext.setUserContextFor("uId",n.getUrlParameterValue(window,"uId"));skelta.userContext.setUserContextFor("fName",n.getUrlParameterValue(window,"fName"));skelta.userContext.setUserContextFor("vStamp",n.getUrlParameterValue(window,"vStamp"));skelta.userContext.setUserContextFor("itemId",n.getUrlParameterValue(window,"itemId"));skelta.userContext.setUserContextFor("listName","Forms List");skelta.serverUrl=n.getUrlParameterValue(window,"urlPath");u=n.getUrlParameterValue(window,"skSasToken");n.isUndefinedNullOrEmpty(u)||skelta.userContext.setUserContextFor("skSasToken",u);f=n.getUrlParameterValue(window,"deviceId");n.isUndefinedNullOrEmpty(f)||skelta.userContext.setUserContextFor("deviceId",f);e=window.parent.authenticationToken;n.isUndefinedNullOrEmpty(e)||skelta.userContext.setUserContextFor("authenticationToken",e);i=window.parent.formPageDefaults;skelta.forms.utilities.savePageDefaultsInLocalStotage(i);skelta.userContext.setUserContextFor("culture",i.Culture);skelta.userContext.setUserContextFor("themePath",i.ThemePath);skelta.userContext.setUserContextFor("customThemePathForNextGenForm",i.CustomThemePathForNextGenForm);skelta.forms.utilities.saveLocalesInLocalStotage(i,i.Culture);skelta.userContext.setUserContextFor("vId",i.VirtualActorId);skelta.userContext.setUserContextFor("lookupTimeout",i.LookupTimeout);n.loadCulture(skelta.userContext.getUserContextFor("culture"));skelta.userContext.setUserContextFor("serverUtcOffset",n.parseNumberValue(i.ServerTimeOffset));document.title=skelta.localize.getString("FormNGFInstanceFormTitle");var a=skelta.userContext.getUserContextFor("appN"),y=skelta.userContext.getUserContextFor("itemId"),p=skelta.userContext.getUserContextFor("vStamp"),o=skelta.forms.utilities.getFormUniqueKey(a,y,p),l=window.parent.instanceXml;n.isUndefinedNullOrEmpty(l)||(skelta.forms.utilities.createDataModelObject(o),skelta.forms.utilities.setDataModelObject(o,n.getJSONObjectFromXml(l)));r=window.top.invokeFormWorkItemData;n.isUndefinedNullOrEmpty(r)?(h=window.parent.formParameters,n.isUndefinedNullOrEmpty(h)||v(h)):(skelta.userContext.setUserContextFor("wfName",r.WorkflowName),skelta.userContext.setUserContextFor("workitemId",r.Id),skelta.userContext.setUserContextFor("closeOnSaveAsDraft",r.CloseOnSaveAsDraft),window.paramExeDetailId=r.ExecutionDetailsId,skelta.userContext.setUserContextFor("channel","WebWorkList"),skelta.userContext.setUserContextFor("fType","Invoke Form"),window.paramGroupMode=!1,window.paramEnableHold=!1,window.paramEnableMoveNextPreviousWorkItem=!1,window.paramEnableAutoMoveWorkItem=!1,s=window.parent.formParameters,n.isUndefinedNullOrEmpty(s)||(window.extFormParam=s));$("#viewModel").html(window.parent.viewAndViewModel);t=skelta.forms.utilities.getViewModelObject(o);n.isUndefinedNullOrEmpty(r)?t.onSave.subscribeEvent(pt):t.onSave.subscribeEvent(bt);t.onCancel.subscribeEvent(n.closeForm);skelta.localize.divTextLocalize();skelta.localize.divTitleLocalize();$("."+cssClasses.sfHeader).hide();c=n.getUrlParameterValue(window,"isWorkTasksViewForm");n.isUndefinedNullOrEmpty(c)||c!=="1"||(t.NF1._readEditAddBehaviour(1),$("."+cssClasses.sfHeader).hide(),$("."+cssClasses.sfFooter).hide());$("."+cssClasses.firstForm).hasClass(cssClasses.adaptUIEnabled)&&$("html").addClass(cssClasses.adaptUIEnabled);window.addEventListener("message",function(n){var r=JSON.parse(n.data);if(r.data==="getSubmittedXml"){skelta.attachment.isValidAttachmentStatus(t.topLevelForm);function i(n){var i=n.topLevelForm.records()[0].getFormSubmissionData(),r=skelta.forms.utilities.getXmlFromJSONObject(i),t=skelta.utilities.createMessageObjectForWorkTasks();t.msgType="submittedXml";t.instanceXml=r;window.top.postMessage(JSON.stringify(t),"*")}skelta.forms.utilities.isUndefined(t.topLevelForm.validationPromises)===!1&&t.topLevelForm.validationPromises.length>0?Promise.all(t.topLevelForm.validationPromises).then(function(){i(t)}):i(t)}});setTimeout(function(){$("#viewModel")[0].style.display="";t.topLevelForm.initializeFocus(0);skelta.forms.utilities.hideLoader()},0)};t.prototype.initializePopupFormForMobile=function(){var t=skelta.forms.utilities;isOpenedInNewWindow=!1;var u=n.getUrlParameterValue(window,"fName"),s=n.getUrlParameterValue(window,"vStamp"),i=n.getUrlParameterValue(window,"appN"),r=n.getUrlParameterValue(window,"parentItemId"),e=n.getUrlParameterValue(window,"parentVstamp"),h=t.getFormUniqueKey(i,r,e),o=window.parent["viewModelObject_"+h];popupObjectInstance=o.topLevelForm.popupObjectItem;window.top.getFormByTitleAndVersion(u+"~"+s,function(s){var k,d,g,h,p,v,nt,l,a,it,y,tt,c;if(n.isUndefinedNullOrEmpty(s)||n.isUndefinedNullOrEmpty(s.Id))n.showAlert("",skelta.localize.getString("FormNGFPopupFormUnavailable")),f();else{window.isPopupForm=!0;var w=s.Id,rt=s.ViewAndViewModel,b=s.Version;skelta.userContext.setUserContextFor("itemId",w);skelta.userContext.setUserContextFor("vStamp",b);skelta.userContext.setUserContextFor("appN",i);skelta.userContext.setUserContextFor("fName",u);skelta.userContext.setUserContextFor("listName","Forms List");skelta.userContext.setUserContextFor("parentItemId",r);skelta.userContext.setUserContextFor("parentVstamp",e);skelta.userContext.setUserContextFor("pageName",n.getUrlParameterValue(window,"pageName"));skelta.userContext.setUserContextFor("controlid",n.getUrlParameterValue(window,"controlid"));skelta.userContext.setUserContextFor("parentfName",n.getUrlParameterValue(window,"parentfName"));skelta.userContext.setUserContextFor("uId",n.getUrlParameterValue(window,"uId"));skelta.serverUrl=n.getUrlParameterValue(window.parent,"urlPath");k=n.getUrlParameterValue(window,"skSasToken");n.isUndefinedNullOrEmpty(k)||skelta.userContext.setUserContextFor("skSasToken",k);d=n.getUrlParameterValue(window,"deviceId");n.isUndefinedNullOrEmpty(d)||skelta.userContext.setUserContextFor("deviceId",d);g=window.top.authenticationToken;n.isUndefinedNullOrEmpty(g)||skelta.userContext.setUserContextFor("authenticationToken",g);h=window.top.formPageDefaults;t.savePageDefaultsInLocalStotage(h);skelta.userContext.setUserContextFor("culture",h.Culture);skelta.userContext.setUserContextFor("themePath",h.ThemePath);skelta.userContext.setUserContextFor("customThemePathForNextGenForm",h.CustomThemePathForNextGenForm);skelta.forms.utilities.saveLocalesInLocalStotage(h,h.Culture);skelta.userContext.setUserContextFor("vId",h.VirtualActorId);skelta.userContext.setUserContextFor("lookupTimeout",h.LookupTimeout);n.loadCulture(skelta.userContext.getUserContextFor("culture"));skelta.userContext.setUserContextFor("serverUtcOffset",n.parseNumberValue(h.ServerTimeOffset));document.title=skelta.localize.getString("FormPopupFormTitle");p=s.FormParameters;t.isUndefined(p)||p==="{}"||ht(JSON.parse(p),o);v="";v=w==""&&n.getUrlParameterValue(window,"fName")===""&&b===""?t.getFormUniqueKey(i,r+"_"+popupControlId,popupControlId):t.getFormUniqueKey(i,w,b);c=popupObjectInstance.controlSender;t.isUndefined(c)||(nt=c.persistValue,t.isUndefined(nt)||nt!==!0||(l="",l=t.isUndefined(c.value)||t.isUndefined(c.value.__text)?c.value:c.value.__text,t.isUndefinedNullOrEmpty(l)||(l.DoesNotBeginsWith("<")&&(l=t.decodeXmlValue(l)),a=t.getJSONObjectFromXml(l),it=t.isUndefined(a)?a:a[Object.keys(a)[0]],t.isUndefinedNullOrEmpty(it)||(t.createDataModelObject(v),t.setDataModelObject(v,a)))));$("#viewModel").html(rt);y=t.getViewModelObject(v);y.onSave.subscribeEvent(yt);y.onCancel.subscribeEvent(f);skelta.localize.divTextLocalize();skelta.localize.divTitleLocalize();tt=n.getUrlParameterValue(window,"isWorkTasksViewForm");n.isUndefinedNullOrEmpty(tt)||tt!=="1"||(y.NF1._readEditAddBehaviour(1),$("."+cssClasses.sfHeader).hide(),$("."+cssClasses.sfFooter).hide());$("."+cssClasses.firstForm).hasClass(cssClasses.adaptUIEnabled)&&$("html").addClass(cssClasses.adaptUIEnabled);setTimeout(function(){$("#viewModel")[0].style.display="";y.topLevelForm.initializeFocus(0);skelta.forms.utilities.hideLoader()},0);n.isUndefined(popupObjectInstance.controlSender)||(c=popupObjectInstance.controlSender,c.loaderIconState("0"))}})};t.prototype.initializeWidgetFormForMobile=function(){var t=skelta.forms.utilities,i=t.getGuId(),r=n.getUrlParameterValue(window,"fName"),f=n.getUrlParameterValue(window,"vStamp"),u=n.getUrlParameterValue(window,"appN"),e=n.getUrlParameterValue(window,"parentfName"),o=n.getUrlParameterValue(window,"controlid");$(window).one("beforeunload."+i,function(){i=""});window.top.getFormByTitleAndVersion(r+"~"+f,function(f){var c,l,a,s,w,h,v;if(i!==""&&skelta!==undefined&&skelta!==null&&skelta.userContext!==undefined&&skelta.userContext!==null)if(n.isUndefinedNullOrEmpty(f)||n.isUndefinedNullOrEmpty(f.Id))skelta.logger.logError(skelta.localize.getString("WidgetFormNotAvailableErrorForLogs").replaceString("<@formname@>",r).replaceString("<@controlid@>",o).replaceString("<@form@>",e));else{var y=f.Id,b=f.ViewAndViewModel,p=f.Version;skelta.userContext.setUserContextFor("itemId",y);skelta.userContext.setUserContextFor("vStamp",p);skelta.userContext.setUserContextFor("appN",u);skelta.userContext.setUserContextFor("fName",r);skelta.userContext.setUserContextFor("listName","Forms List");skelta.userContext.setUserContextFor("uId",n.getUrlParameterValue(window,"uId"));skelta.serverUrl=n.getUrlParameterValue(window.parent,"urlPath");c=n.getUrlParameterValue(window,"skSasToken");n.isUndefinedNullOrEmpty(c)||skelta.userContext.setUserContextFor("skSasToken",c);l=n.getUrlParameterValue(window,"deviceId");n.isUndefinedNullOrEmpty(l)||skelta.userContext.setUserContextFor("deviceId",l);a=window.top.authenticationToken;n.isUndefinedNullOrEmpty(a)||skelta.userContext.setUserContextFor("authenticationToken",a);s=window.top.formPageDefaults;t.savePageDefaultsInLocalStotage(s);skelta.userContext.setUserContextFor("culture",s.Culture);skelta.userContext.setUserContextFor("themePath",s.ThemePath);skelta.userContext.setUserContextFor("customThemePathForNextGenForm",s.CustomThemePathForNextGenForm);skelta.forms.utilities.saveLocalesInLocalStotage(s,s.Culture);skelta.userContext.setUserContextFor("vId",s.VirtualActorId);skelta.userContext.setUserContextFor("lookupTimeout",s.LookupTimeout);n.loadCulture(skelta.userContext.getUserContextFor("culture"));skelta.userContext.setUserContextFor("serverUtcOffset",n.parseNumberValue(s.ServerTimeOffset));w=t.getFormUniqueKey(u,y,p);$("#viewModel").html(b);h=t.getViewModelObject(w);h.onSave.subscribeEvent(function(){});h.onCancel.subscribeEvent(function(){});skelta.localize.divTextLocalize();skelta.localize.divTitleLocalize();v=n.getUrlParameterValue(window,"isWorkTasksViewForm");n.isUndefinedNullOrEmpty(v)||v!=="1"||(h.NF1._readEditAddBehaviour(1),$("."+cssClasses.sfHeader).hide(),$("."+cssClasses.sfFooter).hide());$("."+cssClasses.firstForm).hasClass(cssClasses.adaptUIEnabled)&&$("html").addClass(cssClasses.adaptUIEnabled);setTimeout(function(){i!==""&&skelta!==undefined&&skelta!==null&&skelta.userContext!==undefined&&skelta.userContext!==null&&($("#viewModel")[0].style.display="",h.topLevelForm.initializeFocus(0),skelta.forms.utilities.hideLoader())},0)}})};t.prototype.initializeWorkItemInvokeForm=function(){if(skelta.DeviceOS=n.getUrlParameterValue(window,"dType"),n.isUndefined(skelta.DeviceOS)&&(skelta.DeviceOS="Web"),skelta.DeviceOS==="Web"){var t=n.getUrlParameterValue(window,"winuri"),i=n.getUrlParameterValue(window,"wisuri"),r=n.createJsonRequestHelper({secUri:t,wisuri:i,deviceType:skelta.DeviceOS,lastModifiedLocaleTime:skelta.userContext.getUserContextFor("lastModifiedLocaleTime"),type:n.getUrlParameterValue(window,"type")});n.callServerMethod("GET","NextGenFormService.aspx/InitializeWorkItemInvokeForm","application/json; charset=utf-8",r,"json",sr,e,null,!1)}};t.prototype.initializeViewForm=function(){skelta.DeviceOS=n.getUrlParameterValue(window,"dType");n.isUndefined(skelta.DeviceOS)&&(skelta.DeviceOS="Web");var t=n.getUrlParameterValue(window,"winuri"),i=n.createJsonRequestHelper({secUri:t,deviceType:skelta.DeviceOS,lastModifiedLocaleTime:skelta.userContext.getUserContextFor("lastModifiedLocaleTime")});n.callServerMethod("GET","NextGenFormService.aspx/InitializeViewForm","application/json; charset=utf-8",i,"json",wr,e,null,!1)};t.prototype.initializeDynamicListForm=function(){var t,i;skelta.DeviceOS=n.getUrlParameterValue(window,"dType");n.isUndefined(skelta.DeviceOS)&&(skelta.DeviceOS="Web");window.paramlcsuri=n.getUrlParameterValue(window,"lcsuri");window.mode=n.getUrlParameterValue(window,"mode");t="ActionCreate";window.location.href.containsString("mode=Edit")?t="ActionEdit":window.location.href.containsString("mode=View")&&(t="ActionViewItemDetails");i=n.createJsonRequestHelper({secUri:window.paramlcsuri,rightCodes:[t],forList:!0,mode:window.mode,lastModifiedLocaleTime:skelta.userContext.getUserContextFor("lastModifiedLocaleTime")});n.callServerMethod("GET","NextGenFormService.aspx/InitializeDynamicListForm","application/json; charset=utf-8",i,"json",kr,e,null,!1)};t.prototype.readRFID=function(n){function t(t){n.value=skelta.forms.utilities.isUndefinedNullOrEmpty(t)===!1?t:""}skelta.forms.utilities.isWorkTasksPro()!==!1&&window.top.readRFIDTag(t)};t.prototype.scanQRCode=function(n){function t(t){n.value=skelta.forms.utilities.isUndefinedNullOrEmpty(t)===!1?t:""}skelta.forms.utilities.isWorkTasksPro()!==!1&&window.top.scanQRCodeFn(t)};t.prototype.getGeolocation=function(t){function i(n){t.latitude=n.latitude;t.longitude=n.longitude;skelta.utilities.isUndefined(t.onGeolocationLoadedScript)||t.onGeolocationLoadedScript.call(this,t)}function r(n){i({latitude:n.coords.latitude,longitude:n.coords.longitude})}if(skelta.forms.utilities.isWorkTasksPro())window.top.getGeolocation(i);else{var u=function(t){switch(t.code){case t.PERMISSION_DENIED:n.showError(document.title,skelta.localize.getString("FormLocationControlErrorPermissionDenied"));break;case t.POSITION_UNAVAILABLE:n.showError(document.title,skelta.localize.getString("FormLocationControlErrorPositionUnavailable"));break;case t.TIMEOUT:n.showError(document.title,skelta.localize.getString("FormLocationControlErrorTimeout"));break;case t.UNKNOWN_ERROR:n.showError(document.title,skelta.localize.getString("FormLocationControlErrorUnknown"))}};navigator.geolocation?navigator.geolocation.getCurrentPosition(r,u,{enableHighAccuracy:!1,timeout:5e3,maximumAge:0}):n.showError(document.title,skelta.localize.getString("FormLocationControlErrorNotSupported"))}};t.prototype.initializeDropZoneForHierarchicalList=function(n){function i(n){for(var r,u,f=t.findById("ColumnMapping"),e=f.records(),o=!1,i=0;i<e.length;i++)if(r=e[i],r.findById("ColumnKey").value===n.dropTarget.attr("data-columnkey")){r.findById("ColumnName").value=n.draggable.element.text();o=!0;break}o===!1&&(u=f.addRecord(),u.findById("ColumnKey").value=n.dropTarget.attr("data-columnkey"),u.findById("ColumnName").value=n.draggable.element.text());n.dropTarget[0].innerText=n.draggable.element.text();$(this.element).attr("data-dropzonehover","0")}var t=n;t.topLevelForm.isFormLoaded.subscribe(function(n){n&&($("[controlid="+t.id+"] .level1 .dropzone").kendoDropTarget({group:"Level1",dragenter:function(){$(this.element).attr("data-dropzonehover","1")},dragleave:function(){$(this.element).attr("data-dropzonehover","0")},drop:i}),$("[controlid="+t.id+"] .level2 .dropzone").kendoDropTarget({group:"Level2",dragenter:function(){$(this.element).attr("data-dropzonehover","1")},dragleave:function(){$(this.element).attr("data-dropzonehover","0")},drop:i}),$("[controlid="+t.id+"] .level3 .dropzone").kendoDropTarget({group:"Level3",dragenter:function(){$(this.element).attr("data-dropzonehover","1")},dragleave:function(){$(this.element).attr("data-dropzonehover","0")},drop:i}))})};t.prototype.initializeDraggableListItems=function(n){n._listItems.subscribe(function(){window.setTimeout(function(){var t=$("[controlid="+n.id+"] .sk_draggable_container > .sk_draggable_items").kendoDraggable({group:n.groupName,hint:function(n){var t=$(n).clone();return t.css("width","190px"),t.css("pointer-events","none"),t},autoScroll:!0,dragstart:function(n){$("html").addClass("se_ondrag_"+n.target.parentElement.getAttribute("data-groupname"))},dragend:function(){var n=$("html").attr("class").split(/\s+/);$.each(n,function(n,t){t.indexOf("se_ondrag_")===0&&$("html").removeClass(t)})}})},50)})};t.prototype.validateChartTypeProperty=function(n,t){var i,r,u;return(t==="PieChart"||t==="DonutChart")&&(i=n.findByXmlNode("DataSourceDetails").value,!skelta.utilities.isUndefinedNullOrEmpty(i)&&(r=skelta.utilities.getJSONObjectFromXml(i),u=r.DataLookupProperty.VerticalAxis,u.split(";#").length>1))?new ValidationOptions(!1,skelta.localize.getString("@@ChartTypeError@@")):new ValidationOptions(!0,"")};t.prototype.getUniqueControlId=function(n){for(var i=n.id,t=n.dataContainerForm;t.parentForm!=null;)i=t.id+i,t=t.parentForm.dataContainerForm;return n.topLevelForm.id+i};t.prototype.getClientCredentialToken=function(){var i=skelta.userContext.getUserContextFor("appN"),t,r=n.createJsonRequestHelper({appName:i});return $.ajax({type:"GET",async:!1,contentType:"application/json; charset=utf-8",data:r.getValueForGetRequest(),url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetClientCredentialToken"),dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(n){t=n.d},error:function(n){n=n}}),t};t.prototype.getUserAccessToken=function(){var i=skelta.userContext.getUserContextFor("appN"),t,r=n.createJsonRequestHelper({appName:i});return $.ajax({type:"GET",async:!1,contentType:"application/json; charset=utf-8",data:r.getValueForGetRequest(),url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetUserAccessToken"),dataType:"json",beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(n){t=n.d},error:function(n){n=n}}),t};u.prototype.isPanelForm=function(n){return n.getAttribute(dataAttributes.containerType)==="PanelForm"};u.prototype.isBaseForm=function(t){return n.isUndefined(t)?!1:t.getAttribute(dataAttributes.containerType)==="BaseForm"};u.prototype.isTab=function(t){return n.isUndefined(t)?!1:t.getAttribute(dataAttributes.containerType)==="Tab"};u.prototype.isTabs=function(t){return n.isUndefined(t)?!1:t.getAttribute(dataAttributes.containerType)==="Tabs"};u.prototype.isTopLevelForm=function(t){try{if(!n.isUndefined(t))return t.getAttribute(dataAttributes.isMainForm)==="1"}catch(i){}return!1};u.prototype.isViewModeGrid=function(n){return this.isBaseForm(n)&&n.getAttribute(dataAttributes.viewMode)==="1"?!0:!1};u.prototype.getShowGridHeaderAttribute=function(n){return $(n).find(">."+cssClasses.containerFormWrapper+">."+cssClasses.containerBodyDivWrapper+">."+cssClasses.containerBodyDiv+">."+cssClasses.gridView).attr(dataAttributes.showGridHeader)==="0"?!1:!0};u.prototype.getParentContainerForm=function(t){try{if(n.isUndefined(t))return;var i=t.parentNode;if(n.isUndefined(i)||i.getAttribute("class")==="sfd-ddbox")return;if(!n.isUndefined(i.getAttribute("class")))while(!n.isUndefined(i.getAttribute("class"))&&i.getAttribute("class").indexOf(cssClasses.container)<0)i=i.parentNode;return i}catch(r){return}};u.prototype.getBodyDivForForm=function(n){this.isPanelForm(n)||(n=this.getParentContainerForm(n));return $(n).find("."+cssClasses.containerBodyDiv)[0]};u.prototype.getStylesForGridView=function(t){var l=$(t).find("."+cssClasses.containerBodyDiv)[0],f=parseInt(l.getAttribute(dataAttributes.gridViewColumnCount)),v,s,h,u,c,e;if(f!=0){var y=$(l).find(">."+cssClasses.gridView)[0],i=y.getAttribute(dataAttributes.columnWidths),r,o=idValues.stylePrefix,a=t.getAttribute("controlid");if(o+=n.isUndefinedNullOrEmpty(a)?f+"_"+i.replaceString(",","_",!1,!0):a,$("#"+o)&&$("#"+o).remove(),i==="none")v=100/f,s="."+cssClasses.containerBodyDiv+"["+dataAttributes.gridViewColumnCount+'="'+f+'"]>.'+cssClasses.gridView+">",r=s+"."+cssClasses.gridViewTBody+">div>div:not(."+cssClasses.columnOptions+"),"+s+"."+cssClasses.gridViewTHead+">div:not(."+cssClasses.columnOptions+"){width:"+v+"% !important;}";else{for(h="."+cssClasses.containerBodyDiv+">."+cssClasses.gridView+"["+dataAttributes.columnWidths+'="'+i+'"]',i=i.split(","),r=[],u=1;u<=f;u++)c=":nth-child("+f+"n+"+u.toString()+"):not(."+cssClasses.columnOptions+")",r.push(h+">."+cssClasses.gridViewTBody+">div>div:not(."+cssClasses.columnOptions+")"+c+", "+h+">."+cssClasses.gridViewTHead+">div:not(."+cssClasses.columnOptions+")"+c),i[u-1]==="0"?r.push("{ width: "+i[u-1]+"% !important; padding: 0px; }"):r.push("{ width: "+i[u-1]+"% !important; }");r=r.join(" ")}e=document.createElement("style");e.id=o;e.type="text/css";e.appendChild(document.createTextNode(r));document.getElementsByTagName("head")[0].appendChild(e)}};u.prototype.getTabbingForPanelForm=function(t){this.isPanelForm(t)||(t=this.getParentContainerForm(t));var i=this.getBodyDivForForm(t);return n.isUndefined(i)?"":i.getAttribute(dataAttributes.tabbing)==="1"?"vertical":"horizontal"};u.prototype.reArrangePanelForm=function(n,t){var i=this.getRearrangedColumnsCollection(n),r;i=this.getSortedColumnCollection(i,t);r=this.recreateControlCollection(n,i);this.getRearrangedPanelView(r,this.getBodyDivForForm(n))};u.prototype.getRearrangedColumnsCollection=function(n){for(var t,o,f=this.getBodyDivForForm(n),s=parseInt(f.getAttribute(dataAttributes.numberOfColumns)),e=[],r=[],i=$(f).find(">."+cssClasses.control+",>."+cssClasses.container),u=0;u<s;u++){for(r=[],t=0;t<i.length;t++)$(i[t]).attr("class").indexOf(cssClasses.blankControl)===-1&&(o=i[t].getAttribute(dataAttributes.controlPositionInPanel).split(","),parseInt(o[0])===u&&r.push(i[t]));e.push(r)}return e};u.prototype.getBlankControl=function(n){var t="";return n||(t='style="display:none;"'),'<div class="'+cssClasses.blankControl+" "+cssClasses.control+'"'+t+"><\/div>"};u.prototype.getSortedColumnCollection=function(n,t){for(var r=0,s=0,f=[],h=0,e,o,u,i,r=0;r<n.length;r++){for(e=[],o=[],u=0;u<n[r].length;u++)t.indexOf(n[r][u])>-1?e.push(n[r][u]):o.push(n[r][u]);n[r]=[];n[r]=this.sortControlCollection(o);o.length>s&&(s=o.length);f.push(e);e.length>h&&(h=e.length)}for(i=0;i<=s;i++)for(k=0;k<n.length;k++)n[k].length<i&&n[k].push($(this.getBlankControl(!0))[0]);for(i=0;i<=h;i++)for(k=0;k<f.length;k++)f[k].length<i&&f[k].push($(this.getBlankControl(!1))[0]);for(i=0;i<n.length;i++)n[i].push.apply(n[i],f[i]);return n};u.prototype.sortControlCollection=function(n){return n.sort(function(n,t){var i=parseInt(n.getAttribute(dataAttributes.controlPositionInPanel).split(",")[1]),r=parseInt(t.getAttribute(dataAttributes.controlPositionInPanel).split(",")[1]);return i<r?-1:i>r?1:0}),n};u.prototype.getColumnsCollection=function(n,t){var e=this.getBodyDivForForm(n),h=parseInt(e.getAttribute(dataAttributes.numberOfColumns)),u,o=[],r=[],f,s,i;if(t==="horizontal")for(u=$(e).find(">."+cssClasses.control+", >."+cssClasses.container),f=0;f<h;f++){for(r=[],i=0;i<u.length;i++)i%h===f&&u[i].getAttribute("class").indexOf(cssClasses.blankControl)<0&&r.push(u[i]);o.push(r)}else for(s=$(e).find(">."+cssClasses.panelColumnVertical),i=0;i<s.length;i++)r=[],r=$(s[i]).children(),o.push(r);return o};u.prototype.getRearrangedPanelView=function(n,t){for(var i=$(t).children().length-1;i>-1;)$(t).children()[i].getAttribute("class").indexOf(cssClasses.blankControl)>=0&&$($(t).children()[i]).remove(),i--;$(t).append(n).fadeIn()};u.prototype.recreatePanelView=function(n,t,i){var e,r=$(i).children().length-1,h,s,o,u,f;if(n=="horizontal"){while(r>-1&&($(i).children()[r].getAttribute("class").indexOf(cssClasses.control)>=0||$(i).children()[r].getAttribute("class").indexOf(cssClasses.container)>=0||$(i).children()[r].getAttribute("class").indexOf(cssClasses.blankControl)>=0))$($(i).children()[r]).remove(),r--;for(e=[],u=0;u<t.length;u++)e.push(t[u])}else{while($(i).children()[r].getAttribute("class").indexOf(cssClasses.panelColumnVertical)>=0)$($(i).children()[r]).remove(),r--;for(h=parseInt(i.getAttribute(dataAttributes.numberOfColumns)),s="",e=[],o=i.parentNode.getAttribute("skheight"),o=o?"min-height: "+o+'px !important;"':"",u=0;u<h;u++){for(s=$("<div class='"+cssClasses.panelColumnVertical+"' style=\""+o+'" onmouseover="sfd.ddm.notifyHover(this, event);" onmouseout="sfd.ddm.notifyOutOfHover(this);" onmouseup="sfd.ddm.getColumnIndex(this, event);" '+dataAttributes.controlType+'="formColumn" '+dataAttributes.columnIndex+'="'+u+'" '+dataAttributes.senderType+'="PanelColumn" '+dataAttributes.selected+'="0"><\/div>'),f=0;f<t.length;f++)f%h==u&&t[f].getAttribute("class").indexOf(cssClasses.blankControl)<0&&s.append(t[f]);e.push(s[0])}}$(i).append(e).fadeIn()};u.prototype.recreateControlCollection=function(n,t){for(var i=0,u=0,f=[],o=this.getBodyDivForForm(n),e=parseInt(o.getAttribute(dataAttributes.numberOfColumns)),r,i=0;i<e;i++)u<t[i].length&&(u=t[i].length);for(r=0;r<u;r++)for(i=0;i<e;i++)r<t[i].length?f.push(t[i][r]):f.push($(this.getBlankControl(!0))[0]);return f};skelta.forms.ui=new u}()}(),function(){skelta.utilities.isUndefined(skelta.userContext)&&function(){function t(){var r=skelta.forms.utilities.getStorageItem(ngfLocalStorageKeys.nGFPageDefaults),t,i,u;r!=null&&(t=JSON.parse(r),n.culture=t.Culture,n.themePath=t.ThemePath,n.customThemePathForNextGenForm=t.CustomThemePathForNextGenForm);i=skelta.forms.utilities.getStorageItem(ngfLocalStorageKeys.nGFLocales);i!=null&&(u=JSON.parse(i),n.lastModifiedLocaleTime=u.LastModifiedLocaleTime)}var n={culture:"",themePath:"",customThemePathForNextGenForm:"",lastModifiedLocaleTime:""};t.prototype.setUserContextFor=function(t,i){n[t]=i};t.prototype.getUserContextFor=function(t){return n[t]};t.prototype.getUserContext=function(){return n};t.prototype.getBPMUITemplatesPath=function(){var t=n.themePath,i;try{i=t.toLowerCase().lastIndexOf("/themes/");i>0&&(t=t.substr(0,i+1))}catch(r){logger.logError(r.message)}return t};t.prototype.getThemeName=function(){var t,i;try{if(t=n.themePath,t.endsWithString("/")&&(t=t.substr(0,t.length-1)),i=t.toLowerCase().lastIndexOf("/themes/"),i>=0)return t.substr(i+8)}catch(r){skelta.logger.logError(r.message)}return""};t.prototype.getUniqueInformation=function(){var t=[];return skelta.utilities.isUndefinedNullOrEmpty(n.PageInstanceID)||t.push("PageInstanceID: "+n.PageInstanceID),t.push("DateTime: "+skelta.forms.utilities.getDateTimeInStringFormat(new Date,"MM/dd/yyyy HH:mm:ss.fff")),t.join(", ")};t.prototype.getAllInformation=function(){var i=this.getUniqueInformation(!0)+"\n\tUser Context Information:\n",r=0,u=["authenticationToken","PageInstanceID","skSasToken","debugMode","lastModifiedLocaleTime","lookupTimeout"];for(var t in n)$.inArray(t,u)<0&&n.hasOwnProperty(t)&&(r++,i+="\t\t("+r.toString()+") "+t+" = "+n[t]+"\n");return i};skelta.userContext=new t}()}(),function(){skelta.utilities.isUndefined(skelta.localize)&&function(){function n(){}function t(n){var i=skelta.forms.utilities.getStorageItem(ngfLocalStorageKeys.nGFLocales),r,t;return i==null?n:(r=JSON.parse(i),globals=r.Locales,t=globals[n],skelta.utilities.isUndefined(t))?n:t}var i=this;n.prototype.getString=function(n){return t(n)};n.prototype.getDesignerString=function(n){return t(n)};n.prototype.localizeMessageDialog=function(){var n=this;se.ui.messageDialog.setGlobalOptions({localization:{closeButtonCaption:n.getString("se_ui_messagedialog_close_caption"),okButtonCaption:n.getString("se_ui_messagedialog_ok_caption"),cancelButtonCaption:n.getString("se_ui_messagedialog_cancel_caption"),showDetailsCaption:n.getString("se_ui_messagedialog_showdetails_caption"),hideDetailsCaption:n.getString("se_ui_messagedialog_hidedetails_caption")}})};n.prototype.divTextLocalize=function(){$("div[data-sktextlocalize], span[data-sktextlocalize]").each(function(){var n=$(this).data("sktextlocalize"),t=skelta.localize.getDesignerString(n);t==n&&(t=skelta.localize.getString(n));$(this).text(t)})};n.prototype.inputValueLocalize=function(){$("input[data-skvaluelocalize]").each(function(){var n=$(this).data("skvaluelocalize"),t=skelta.localize.getDesignerString(n);t==n&&(t=skelta.localize.getString(n));$(this).attr("value",t)})};n.prototype.divTitleLocalize=function(){$("div[data-sktitlelocalize], li[data-sktitlelocalize], span[data-sktitlelocalize]").each(function(){var n=$(this).data("sktitlelocalize"),t=skelta.localize.getDesignerString(n);t==n&&(t=skelta.localize.getString(n));$(this).attr("title",t)})};skelta.localize=new n}()}(),function(){if(skelta.utilities.isUndefined(skelta.forms.delay)&&skelta.createNamespace("skelta.forms.delay"),skelta.forms.utilities.isUndefined(skelta.forms.delay.loader)){var t=skelta.forms.utilities,r=t.getLogger(),n=[];(function(){function r(){skelta.BaseClass.call(this,skelta.forms.delay,"Loader")}var e=$(window),u,f;r.prototype.visible=function(n){return visible.call(n,!0)};r.prototype.scrollEventHandler=function(n){scrollEventHandler(n)};r.prototype.addToDelayWatcher=function(t,i){var r={element:$(t),viewModel:i};n.length==0&&(f(),document.addEventListener("scroll",scrollEventHandler,!0),window.addEventListener("resize",scrollEventHandler));skelta.forms.utilities.isObjectPresentInArray(r,n)||(n.push(r),r.viewModel.visible||(r.visibleSubscription=r.viewModel._visible.subscribe(function(n){n!=!0||r.viewModel._isLoaded()||scrollEventHandler()})))};u=function(n,t){var r,i;for(r in n)i=n[r],i.type==="attributes"&&$(i.target).is(":visible")&&setTimeout(function(){scrollEventHandler();t.disconnect()},0)};f=function(){var n=skelta.DeviceOS,i,r,f;((t.isUndefined(n)||n==="Web")&&(n="Web"),n==="WorkTasks")&&((i=document.getElementById("viewModel"),t.isUndefined(i)||$(i).is(":visible"))||(r={attributes:!0},f=new MutationObserver(u),f.observe(i,r)))};scrollEventHandler=function(){for(i=n.length-1;i>=0;i--){var t=n[i];$(t.element).is(":visible")&&visible.call(t.element,!0)&&t.viewModel._isReadyToLoad()&&(skelta.forms.utilities.isUndefined(t.visibleSubscription)||(t.visibleSubscription.dispose(),delete t.visibleSubscription),n.splice(i,1),t.viewModel._isLoaded(!0))}n.length==0&&(document.removeEventListener("scroll",scrollEventHandler,!0),window.removeEventListener("resize",scrollEventHandler))};visible=function(n,t,i,r){if(!(this.length<1)){i=i||"both";var l=this.length>1?this.eq(0):this,o=typeof r!="undefined"&&r!==null,a=o?$(r):e,f=o?a.position():0,v=l.get(0),s=a.outerWidth(),h=a.outerHeight(),c=t===!0?v.offsetWidth*v.offsetHeight:!0;if(typeof v.getBoundingClientRect=="function"){var u=v.getBoundingClientRect(),g=o?u.top-f.top>=0&&u.top<h+f.top:u.top>=0&&u.top<h,nt=o?u.bottom-f.top>0&&u.bottom<=h+f.top:u.bottom>0&&u.bottom<=h,tt=o?u.left-f.left>=0&&u.left<s+f.left:u.left>=0&&u.left<s,it=o?u.right-f.left>0&&u.right<s+f.left:u.right>0&&u.right<=s,y=n?g||nt:g&&nt,p=n?tt||it:tt&&it,y=u.top<0&&u.bottom>h?!0:y,p=u.left<0&&u.right>s?!0:p;if(i==="both")return c&&y&&p;if(i==="vertical")return c&&y;if(i==="horizontal")return c&&p}else{var w=o?0:f,rt=w+h,b=a.scrollLeft(),ut=b+s,ft=l.position(),k=ft.top,et=k+l.height(),d=ft.left,ot=d+l.width(),st=n===!0?et:k,ht=n===!0?k:et,ct=n===!0?ot:d,lt=n===!0?d:ot;if(i==="both")return!!c&&ht<=rt&&st>=w&&lt<=ut&&ct>=b;if(i==="vertical")return!!c&&ht<=rt&&st>=w;if(i==="horizontal")return!!c&&lt<=ut&&ct>=b}}};skelta.forms.delay.loader=new r})()}}(),function(){skelta.utilities.isUndefined(skelta.grid)&&function(){function r(){}var n=skelta.forms.utilities,i=skelta.forms.constants,t=n.getLogger();r.prototype=function(){function hi(){skelta.utilities.isUndefined(k)&&(k={operators:{string:{contains:skelta.localize.getString("sk_filter_oper_string_contains"),doesnotcontain:skelta.localize.getString("sk_filter_oper_string_doesnotcontain"),eq:skelta.localize.getString("sk_filter_oper_string_eq"),neq:skelta.localize.getString("sk_filter_oper_string_neq"),startswith:skelta.localize.getString("sk_filter_oper_string_startswith"),endswith:skelta.localize.getString("sk_filter_oper_string_endswith"),isnull:skelta.localize.getString("sk_filter_oper_string_isnull"),isnotnull:skelta.localize.getString("sk_filter_oper_string_isnotnull"),isempty:skelta.localize.getString("sk_filter_oper_string_isempty"),isnotempty:skelta.localize.getString("sk_filter_oper_string_isnotempty")},number:{eq:skelta.localize.getString("sk_filter_oper_number_eq"),neq:skelta.localize.getString("sk_filter_oper_number_neq"),gte:skelta.localize.getString("sk_filter_oper_number_gte"),gt:skelta.localize.getString("sk_filter_oper_number_gt"),lte:skelta.localize.getString("sk_filter_oper_number_lte"),lt:skelta.localize.getString("sk_filter_oper_number_lt"),isnull:skelta.localize.getString("sk_filter_oper_number_isnull"),isnotnull:skelta.localize.getString("sk_filter_oper_number_isnotnull")},date:{eq:skelta.localize.getString("sk_filter_oper_date_eq"),neq:skelta.localize.getString("sk_filter_oper_date_neq"),gte:skelta.localize.getString("sk_filter_oper_date_gte"),gt:skelta.localize.getString("sk_filter_oper_date_gt"),lte:skelta.localize.getString("sk_filter_oper_date_lte"),lt:skelta.localize.getString("sk_filter_oper_date_lt"),isnull:skelta.localize.getString("sk_filter_oper_date_isnull"),isnotnull:skelta.localize.getString("sk_filter_oper_date_isnotnull")},enums:{eq:skelta.localize.getString("sk_filter_oper_enums_eq"),neq:skelta.localize.getString("sk_filter_oper_enums_neq"),isnull:skelta.localize.getString("sk_filter_oper_enums_isnull"),isnotnull:skelta.localize.getString("sk_filter_oper_enums_isnotnull")}},messages:{info:skelta.localize.getString("sk_filter_message_info"),isTrue:skelta.localize.getString("sk_filter_message_isTrue"),isFalse:skelta.localize.getString("sk_filter_message_isFalse"),filter:skelta.localize.getString("sk_filter_message_filter"),clear:skelta.localize.getString("sk_filter_message_clear"),and:skelta.localize.getString("sk_filter_message_and"),or:skelta.localize.getString("sk_filter_message_or"),selectValue:skelta.localize.getString("sk_filter_message_selectValue"),operator:skelta.localize.getString("sk_filter_message_operator"),value:skelta.localize.getString("sk_filter_message_value"),cancel:skelta.localize.getString("sk_filter_message_cancel")}})}function d(n,t){return JSON.stringify(n)===JSON.stringify(t)}function ci(t){var s=t.autoLoadGrid,r,f,o;s===u.OnFormLoadAndParameterChange&&(i.dataGridConstants.enableThrottle?(throttleGridFunc=typeof throttleGridFunc=="undefined"||throttleGridFunc===null?{}:throttleGridFunc,r="",f=i.dataGridConstants.throttleTime,r=n.getControlUniqueKey(t),n.isUndefined(throttleGridFunc[r])&&(o=n.throttle(e,f,{leading:!1}),throttleGridFunc[r]=o),throttleGridFunc[r](t)):e(t))}function et(t){var r,i,u;n.isUndefined(t.resizable)||(t.resizable.bind("start",function(n){i=$(n.currentTarget).data("th");u=i.index();i.data("field")===undefined&&(n.preventDefault(),setTimeout(function(){t.wrapper.removeClass("k-grid-column-resizing");$(document.body).add(".k-grid th").css("cursor","")}))}),t.resizable.bind("resize",function(){i.width()>=l&&(r=t.tbody.closest("table").width());i.width()<l&&(t.thead.closest("table").width(r).children("colgroup").find("col").eq(u).width(l),t.tbody.closest("table").width(r).children("colgroup").find("col").eq(u).width(l))}))}function ot(t){t.subscribeToGridParamsComputedFn=ko.computed(function(){var s,r,p,h,c,i,a,v;if(t.topLevelForm.isFormLoaded()===!0){if(t.subscriptionToGridParamsComplete===!0)return;var y=t.autoLoadGrid,f=!1,o="",l={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm};for(s=0;s<t._parameterControlId.length;s++)r=t._parameterControlId[s].value,p="",r.indexOf(",")>-1?(c=r.split(","),i=t.findById(c[0],l),n.isUndefined(i)?(f=!0,o+=o===""?c[0]:", "+c[0]):i.controlType==="Grid"?h=i._selectedValue:i.controlType==="LookupInput"&&(h=i._value)):(i=t.findById(r,l),n.isUndefined(i)?(f=!0,o+=o===""?r:", "+r):h=i._value),f===!1&&h.subscribe(function(){ci(t)});t.subscriptionToGridParamsComplete=!0;f&&(a=t.tagName!==""?t.tagName+" ("+t.id+")":t.id,v=skelta.localize.getString("FormsNGFErrorGridParameterNotFound").replaceString("<@GridControl@>",a).replace("<@ParamControl@>",o),n.logErrorWithAlert(v));y!==u.Never&&f===!1?e(t):st(t)}});t.subscribeToGridParamsComputedFn&&t.subscriptionToGridParamsComplete===!0&&(t.subscribeToGridParamsComputedFn.dispose(),delete t.subscribeToGridParamsComputedFn)}function st(n){n.getGridDataIsCalled!==!0&&(n.suppressInitialDuplicateDataBounds=!0,r(n),delete n.suppressInitialDuplicateDataBounds)}function li(n){for(var u,f=[],e={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm},t=0;t<n._parameterControlId.length;t++){var s=n._parameterControlId[t],o=n._parameterControlId[t].key,i=n._parameterControlId[t].value,r="";i.indexOf(",")>-1?(u=i.split(","),r=gi(u[0],u[1],n)):r=n.findById(i,e)._value.peek();f.push({Name:o,Value:r})}return f}function r(t,i,u){var e,c,o,f,s,h,l;try{if(t.renderAsDataSource===1)return;if(t.topLevelForm.isFormLoaded.peek()===!0){if(n.isUndefined(i)&&(i=$(t.domElement)),e=!n.isUndefined(i)&&i.length===1,!e&&skelta.forms.utilities.isMobileDisplayMode(t)===!1||n.isUndefined(t.schemaInfo)){c=this;setTimeout(function(){r.apply(c,[t,i,u])},0);return}e&&(o="detailInit: detailInit",f=i.attr("data-bind"),n.isUndefined(t.hierarchicalInformation)||t.hierarchicalInformation.length!==1||f.indexOf(o)===-1||i.attr("data-bind",f.replace(", detailInit: detailInit","")),!n.isUndefined(t.hierarchicalInformation)&&t.hierarchicalInformation.length>1&&f.indexOf(o)===-1&&(f=f.substring(0,f.length-1)+", "+o+"}",i.attr("data-bind",f)),i.attr("data-source",t.sourceName),s=i[0].parentNode,ko.cleanNode(s),hi(),t._filterableOptions=k,ko.applyBindingsToNode(s,null,t.parentForm,"kendoGrid"),et($(s).find("[data-role='grid']").data("kendoGrid")));n.isUndefined(t.defaultPageSize)&&(t.defaultPageSize=t.pageSize);e&&g(t);window.addEventListener("resize",ai.bind(t));u===!0&&(n.isUndefined(t.value)||t.value===""||(ii(t,t.value),ri(t,t.value)),h=t.enableResponsiveView,n.isUndefined(h)||h!=="True"||t._source().bind("change",function(n){wi(n,t)}))}else l=vi(this,r,[t,i,u]),t.topLevelForm.functionQueueToBeTriggeredAfterFormLoad.push(l)}catch(a){}}function ai(){g(this)}function g(t){function i(t){var r,e,u,f,i;r=skelta.forms.utilities.isMobileDisplayMode(t)?$(".skgmvtc > div")[0]:t.domElement;e=$(r).data("kendoGrid");t._dynamicPageSize&&(u=$(r).find(".k-grid-content tr").innerHeight(),n.isUndefined(u)||($(r).find(".k-grid-content table").css("display","none"),$(r).find(".k-grid-pager").css("display","none"),f=$(r).find(".k-grid-content").innerHeight(),i=Math.floor(f/u),t.sourceData.length>i&&($(r).find(".k-grid-pager").css("display","flex"),f=$(r).find(".k-grid-content").innerHeight(),i=Math.floor(f/u)),$(r).find(".k-grid-content table").css("display","table"),!isNaN(i)&&i>0&&i!=t.pageSize&&(i<t.defaultPageSize&&(i=t.defaultPageSize),i!=t.pageSize&&(t.firstRowSelectFired=!1,t.pageSize=i,e.dataSource.pageSize(t.pageSize)))))}window.setTimeout(function(){i(t)},0)}function vi(n,t,i){return function(){i.length>0&&i[0].autoLoadGrid===u.Never?(i[0].suppressInitialDuplicateDataBounds=!0,t.apply(n,i),delete i[0].suppressInitialDuplicateDataBounds):t.apply(n,i)}}function ht(n){if(n.configName===si)return!1;var t=n.isParameterizedGrid;return n.renderAsDataSource===1?(n.configName!==""&&(t?ot(n):n.autoLoadGrid!==u.Never&&e(n)),!1):!0}function y(t,i){if(t.setGridSchemaComplete!==!0&&t.modeOfExecution=="Asynchronous"&&(t.topLevelForm.isFormLoaded()===!1||t.topLevelForm.OnFormLoad!==!0)){t.setGridSchemaComplete=!1;SFU.isUndefined(t.setGridSchemaComputedFn)&&(t.setGridSchemaComputedFn=ko.computed(function(){if(t.topLevelForm.isFormLoaded()===!0&&t.dataContainerForm._isLoaded()&&(skeltaUtils.isUndefined(t.associatedForm._isBindedToUI)||t.associatedForm._isBindedToUI())){if(t.setGridSchemaComplete===!0)return;t.setGridSchemaComplete=!0;setTimeout(function(){y(t,i)},0);SFU.isUndefined(t.setGridSchemaComputedFn)||t.setGridSchemaComplete!==!0||(t.setGridSchemaComputedFn.dispose(),delete t.setGridSchemaComputedFn)}}));return}if(t.renderAsDataSource===0&&t.doneUIBinding!==!0&&!skeltaUtils.isUndefined(t.associatedForm._isBindedToUI)&&!t.associatedForm._isBindedToUI()){t.doneUIBinding=!1;SFU.isUndefined(t.uiBindingComputedFn)&&(t.uiBindingComputedFn=ko.computed(function(){if(skeltaUtils.isUndefined(t.associatedForm._isBindedToUI)||t.associatedForm._isBindedToUI()){if(t.doneUIBinding===!0)return;t.doneUIBinding=!0;y(t,i);SFU.isUndefined(t.uiBindingComputedFn)||t.doneUIBinding!==!0||(t.uiBindingComputedFn.dispose(),delete t.uiBindingComputedFn)}}));return}t.gridInformationReceived=!0;t.configName!=="@!WebAPIPreview!@"&&(ct(t,i),t.isParameterizedGrid?ot(t):t.autoLoadGrid!==u.Never?e(t):st(t));n.isUndefined(t.isGridDataCallQueued)||t.isGridDataCallQueued!==!0||(e(t),t.isGridDataCallQueued=!1)}function ct(n,t){var o,i,r,e,h;if(!skelta.utilities.isUndefined(t)&&n.schemaSet!==!0){if(n.schemaSet=!0,o=$.parseJSON(t),n.hierarchicalInformation=skelta.grid.getHierarchicalGridInformation(o),n.gridOptions)for(i=0;i<n.gridOptions.length;i++){var u=[],f=n.gridOptions[i].columns,s=n.hierarchicalInformation[i].HeaderColumns;for(r=0;r<f.length;r++)e=s.filter(function(n){return n.field==f[r].field}),e.length>0&&u.push(e[0]);h=f.map(function(n){return n.field});$.each(s,function(n,t){$.inArray(t.field,h)===-1&&u.push(t)});n.hierarchicalInformation[i].HeaderColumns=u}$.each(n.hierarchicalInformation,function(n,t){skeltaUtils.isUndefined(t.HeaderColumns)||$.each(t.HeaderColumns,function(n){skelta.utilities.isUndefinedNullOrEmpty(t.HeaderColumns[n].title)||(t.HeaderColumns[n].title=t.HeaderColumns[n].title.startsWithString("@@")&&t.HeaderColumns[n].title.endsWithString("@@")?skelta.localize.getString(t.HeaderColumns[n].title):skelta.localize.getString(t.HeaderColumns[n].title))})});lt(n,n.hierarchicalInformation[0])}}function lt(n,t){var r=ui(t.SourceName,n.hierarchicalInformation),e=r.index+1!==n.hierarchicalInformation.length,i,u,f;n.isHierarchy=e;n.sourceName=t.SourceName;n.selection=n.viewSettingsMode===!0?!1:t.AllowSelection;n.selectionEnabled=t.SelectionEnabled;r.index==0&&(n.persistCols=t.PersistColumns);n.dc=n.displayCols=t.ViewColumns;i=t.HeaderColumns;skeltaUtils.isUndefined(i)||skeltaUtils.isUndefinedNullOrEmpty(n.gridOptions)||(u=o(n.gridOptions,n.sourceName),wt(i,u));n.colorExpression=t.ColorExpression;n.selection&&n.viewSettingsMode!==!0?(f={headerTemplate:" ",width:"35px",reorderable:!1},n.header=[f].concat(i)):n.header=i}function yi(n,t,i){if(n.renderAsDataSource!==1&&n.configName===""){n.setGridInformationComputedFn=ko.computed(function(){if(n.topLevelForm.isFormLoaded()===!0&&n.dataContainerForm._isLoaded()){if(n.setGridInformationComplete===!0)return;r(n);n.setGridInformationComplete=!0;n.setGridInformationComputedFn&&n.setGridInformationComplete===!0&&(n.setGridInformationComputedFn.dispose(),delete n.setGridInformationComputedFn)}});return}n.setGridInformationComputedFn=n.modeOfExecution===a.Synchronous?ko.computed(function(){if(n.renderAsDataSource==1||n.dataContainerForm._isLoaded()){if(n.setGridInformationComplete===!0)return;at(n,t,i);n.setGridInformationComplete=!0;n.setGridInformationComputedFn&&n.setGridInformationComplete===!0&&(n.setGridInformationComputedFn.dispose(),delete n.setGridInformationComputedFn)}}):ko.computed(function(){if(n.topLevelForm.isFormLoaded()===!0&&(n.renderAsDataSource==1||n.dataContainerForm._isLoaded())){if(n.setGridInformationComplete===!0)return;at(n,t,i);n.setGridInformationComplete=!0;n.setGridInformationComputedFn&&n.setGridInformationComplete===!0&&(n.setGridInformationComputedFn.dispose(),delete n.setGridInformationComputedFn)}})}function at(n,t,i){ht(n)&&(skeltaUtils.isString(i)&&vt(n,i),y(n,t))}function vt(i,u){r(i);n.showError(document.title,skelta.localize.getString("Form_DataGrid_ConfigurationError").replace("<@id@>",i.id));t.logError(skelta.localize.getString("Form_DataGrid_ConfigurationError").replace("<@id@>",i.id)+"\n"+u)}function pi(t){if(t.renderAsDataSource!==1&&t.configName===""){t.getGridInformationComputedFn=ko.computed(function(){if(t.topLevelForm.isFormLoaded()===!0&&t.dataContainerForm._isLoaded()){if(t.getGridInformationComplete===!0)return;r(t);t.getGridInformationComplete=!0;t.getGridInformationComputedFn&&t.getGridInformationComplete===!0&&(t.getGridInformationComputedFn.dispose(),delete t.getGridInformationComputedFn)}});return}if(ht(t)){var u=skelta.userContext.getUserContextFor("appN"),f=skelta.userContext.getUserContextFor("uId"),i=skelta.userContext.getUserContextFor("lookupTimeout"),e=isNaN(i)?50:i,o=n.isUndefined(skelta.DeviceOS)||skelta.DeviceOS===""?"Web":skelta.DeviceOS,s=t.modeOfExecution,h=s===a.Synchronous?!1:!0,c=n.createJsonRequestHelper({gridConfigName:t.configName,appName:u,userId:f,deviceType:o});$.ajax({type:"GET",async:h,cache:!0,contentType:"application/json; charset=utf-8",data:c.getValueForGetRequest(),url:n.getServerUrl("NextGenFormService.aspx/GetGridInformation"),dataType:"json",timeout:1e3*e,beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(n){y(t,n.d)},error:function(n){vt(t,n.responseJSON.Message)}})}}function wi(n,t){if(skelta.utilities.isMobileDisplayMode(t)&&t.mobileView)if(t.mobileViewLoading)t.mobileViewLoading=!1;else{var i=n.sender;(i.page()!==t.selectedRowPage||i.sort()!==t.currentSort)&&(t.previousSelection=!1)}}function bi(t,i){var f,r,u;if(!i.readOnly&&(f=n.isControlInNewMode(i),!n.isUndefined(t)&&f===!0&&i.selectFirstRecord===!0&&(n.isUndefined(i.firstRowSelectFired)||i.firstRowSelectFired===!1))){if(r=t.sender,u=r.tbody.find("tr").eq(0),u.length===0){i.firstRowSelectFired=!0;return}r.dataSource.page()===1&&u.length>0&&(!i.selectionEnabled&&i.isHierarchy?r.expandRow(u):i.readOnly||(r.select(u),i.firstRowSelectFired=!0,i.hierarchicalInformation[0].SelectionEnabled&&(i.previousSelection=!0,h(i,0,1,undefined,undefined))))}}function nt(n){var i=n.ViewColumns.concat(n.PersistColumns),t=[];return $.each(i,function(n,i){$.inArray(i,t)===-1&&t.push(i)}),t}function h(n,t,i,r,u){n.selectedRowIndex=t;n.selectedRowPage=i;n.currentSort=r;n.currentFilter=u}function ki(n,t){$.each(n,function(n,i){i!==undefined&&di(i,t)})}function di(n,t){var a=t.element.attr("data-source"),h,o,u,c,r,i,e,l,s;if(a===n.LookupName)for(h=t.dataSource.view(),o="MM/dd/yyyy",u=0;u<h.length;u++)if(c=h[u],r=c[n.ColumnName],!skelta.utilities.isUndefined(r)){i=n.Value;e=n.Operator;switch(e){case"Equals":if(typeof r=="number"&&(i=Number(i),isNaN(i)))continue;r[e](i)&&f(n,t,u);break;case"NotEquals":case"Contains":case"NotContains":case"BeginsWith":case"DoesNotBeginsWith":case"EndsWith":case"DoesNotEndWith":r[e](i)&&f(n,t,u);break;case"ContainsData":case"DoesNotContainsData":r[e]()&&f(n,t,u);break;case"DoesNotEquals":case"GreaterThan":case"GreaterThanOrEqualTo":case"LesserThan":case"LesserThanOrEqualTo":if(r=Number(r),i=Number(i),isNaN(r)||isNaN(i))continue;r[e](i)&&f(n,t,u);break;case"True":case"False":r[e]()&&f(n,t,u);break;case"On":case"OnOrAfter":case"OnOrBefore":case"After":case"Before":try{s=new Date.parse(r,o).clearTime();l=new Date.parse(i,o).clearTime();s[e](l)&&f(n,t,u)}catch(v){continue}break;case"Today":case"Yesterday":case"Tomorrow":case"ThisWeek":case"ThisMonth":case"NextMonth":case"LastMonth":case"ThisYear":case"NextYear":case"LastYear":try{s=new Date.parse(r,o).clearTime();s[e](o)&&f(n,t,u)}catch(v){continue}break;case"NextXYears":case"LastXYears":try{if(i=Number(i),isNaN(i))continue;s=new Date.parse(r,o).clearTime();s[e](i,o)&&f(n,t,u)}catch(v){continue}}}}function f(n,t,i){var r;switch(n.ApplyTo){case"RowBackColor":t.table.find("tr:eq("+i+")").css("background-color",n.Color.Name);break;case"RowForeColor":t.table.find("tr:eq("+i+")").css("color",n.Color.Name);break;case"CellBackColor":r=yt(n,t);t.table.find("tr:eq("+i+")").find("td:eq("+r+")").css("background-color",n.Color.Name);break;case"CellForeColor":r=yt(n,t);t.table.find("tr:eq("+i+")").find("td:eq("+r+")").css("color",n.Color.Name)}}function yt(n,t){for(var i,r=0;r<t.columns.length;r++)if(t.columns[r].field===n.ColumnName){i=r;break}return i+=1,t.table.find("tr:eq(0)").find("td:eq(1)").css("display")==="none"&&(i+=1),i}function gi(t,i,r){var f="",e={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm},u=r.findById(t,e);return u.controlType==="LookupInput"?f=n.getValueFromMultiValueLookup(u.value,i):u.controlType==="Grid"&&u.selectedValue!==undefined&&(f=u.selectedValue[i]),f}function p(n,t,i){var u=i[t].PersistColumns,f=i[t].Schema,r;return $.each(u,function(t,i){var r=n[i];r instanceof Date&&(n[i]=skelta.grid.parseDateToInvariant(r,f[i]))}),t=t+1,i.length>t&&(r=i[t].SourceName,n.hasOwnProperty(r)&&($.isPlainObject(n[r])?n[r]=p(n[r],t,i):$.isArray(n[r])&&$.each(n[r],function(u){n[r][u]=p(n[r][u],t,i)}))),n}function nr(t){var i=t._value.peek();return!n.isUndefined(i)&&i!==""?t.uiValue:null}function pt(n,t){for(var e,i,c=n.sourceName,o=[],s=0;s<t.length;s++){var f=t[s][c],h=n.persistCols,r=n.sourceData,u=!1;if(f.length===undefined){for(i=0;i<r.length;i++)if($.each(h,function(t,e){return typeof r[i][e]==typeof f[e]?u=r[i][e]==f[e]:r[i][e]instanceof Date&&(u=f[e]==ut(r[i][e],n.schemaInfo[e])),u}),u){o.push(r[i]);break}}else for(e=0;e<f.length;e++)for(i=0;i<r.length;i++)if($.each(h,function(n,t){return u=r[i][t]==f[e][t]}),u){o.push(r[i]);break}}return o}function tr(n){var f=$("#MobileGridTemplate"),t=f.html(),i,r="detailInit: detailInit,";n.hierarchicalInformation.length===1&&t.indexOf(r)!==-1&&(i=t.replace(r,""),t=i);n.hierarchicalInformation.length>1&&t.indexOf(r)===-1&&(i=t.replace("kendoGrid: {","kendoGrid: {"+r),t=i);var u=t.indexOf("kendoGrid:"),o=t.substring(u).indexOf('}"')+2,e=t.substring(u,u+o);i=t.replace(e,e.concat(' data-source="'+n.sourceName+'"'));f.html(i)}function ir(n){n.hierarchicalInformation&&tr(n);var t=$("#mobilegridTemplateDiv");ko.cleanNode(t[0]);t.attr("class",cssClasses.flexContainer+" "+cssClasses.container+" "+cssClasses.flexDirectionColumn+" "+cssClasses.flexAlignStretch+" "+cssClasses.formMainDiv+" "+cssClasses.gridMobileViewTemplate);t.attr("data-bind","template: { name: 'MobileGridTemplate', data:"+n.id+"}");ko.applyBindings(n.parentForm,t[0]);g(n)}function rr(){var n=$("#mobilegridTemplateDiv");ko.cleanNode(n[0]);n.attr("class",cssClasses.gridMobileViewTemplateHidden);n.text("")}function ur(t){t.topLevelForm.isFormLoaded()===!0&&t.value!==""&&t.uiValue.length==0&&n.updateUIValue(t,t.value)}function fr(n,i){var u,r,f;try{n.sender&&(u=n.sender.element.attr("data-source"),u&&(r=this.getSourceDetails(u,i.hierarchicalInformation),i.isHierarchy=r.index+1<i.hierarchicalInformation.length,f=n.sender.columns.map(function(n){return n.field}),i.dc=f.filter(function(n){return n!==undefined}),i.selection=i.viewSettingsMode===!0?!1:r.detail.AllowSelection,i.selectionEnabled=r.detail.SelectionEnabled),ko.skUnapplyBindings(n.sender.items()))}catch(e){t.logError(e.message)}}function er(n,t){n.pageSize>=t.dataSource._data.length&&!t.options.toolbar&&n.viewSettingsMode!==!0?t.pager.element.hide():t.pager.element.show()}function or(n){var i=$(n.wrapper),t;n.options.toolbar&&(t=i.children(".k-toolbar.k-grid-toolbar"),t.children("a").empty(),t.children("a").addClass("gridExport"),i.children("[data-role='pager']").children(".k-pager-info").before(t))}function o(n,t){var i;return n.length===1?n[0]:($.each(n,function(n,r){if(r.lookup===t)return i=r,!1}),i)}function wt(t,i){n.isUndefined(i)||$.each(t,function(t,r){$.each(i.columns,function(t,i){r.field===i.field&&(n.isUndefinedNullOrEmpty(i.width)||(r.width=i.width))})})}function bt(n){var t={};return $.each(n,function(n,i){switch(i.type){case"number":t[n]=Math.floor(Math.random()*10+1);break;case"date":t[n]=new Date;break;case"boolean":t[n]=!0;break;default:t[n]="Dummy"+Math.floor(Math.random()*10+1)}}),[t]}function sr(t,i){if(!n.isUndefinedNullOrEmpty(i.gridOptions)){var r=o(i.gridOptions,c(t));n.isUndefined(r)||n.isUndefinedNullOrEmpty(r.width)||(t.thead.closest("table").width(r.width),t.table.width(r.width))}}function hr(n,t){try{var i=kt(n,t);return i&&skelta.utilities.isUndefinedNullOrEmpty(i.attr("controlid"))?!0:!1}catch(r){return!1}}function kt(n,t){try{for(var i=n.element;i;){if(i.attr("data-source")===t.hierarchicalInformation[0].SourceName)break;i=i.parent()}return i}catch(r){return null}}function cr(t,i){var r;if(t.sender.options.autoBind=!1,r=t.sender,i.viewSettingsMode===!0){r.expandRow($(r.element).find(".k-master-row"));r.tbody.on("click",".k-hierarchy-cell .k-minus",function(n){n.stopPropagation()})}if(sr(r,i),or(r),er(i,r),i.eventRaiseByRow=!1,i.colorExpression!==undefined&&i.colorExpression!==""&&ki(i.colorExpression,r),i.hierarchicalInformation[0].SelectionEnabled&&skelta.utilities.isMobileDisplayMode(i)&&i.mobileView&&i.mobileViewLoading&&hr(t.sender,i))i.previousSelection?(i.selectedRowIndex!==-1&&r.dataSource.page()===i.selectedRowPage&&r.table.find("tr:eq("+i.selectedRowIndex+")").addClass("k-state-selected"),i.mobileViewLoading=!1):(i.selectedValue=undefined,h(i,-1,0,undefined,undefined));else if(!n.isUndefinedNullOrEmpty(i.hierarchicalInformation)&&i.hierarchicalInformation.length>1){var f=!1,e="",o=c(t.sender);$.each(i.hierarchicalInformation,function(n,t){return f=t.SelectionEnabled===!0,e=t.SourceName,!f});f||o!==e?i.selectionEnabled&&!i.isExpanding?i.selectedValue=undefined:i.isExpanding=!1:i.selectedValue=undefined}else i.selectedValue=undefined;if(i.onCheckSelect&&i.selection&&r.table.find("tr").find("td:nth-child(2) input").click(function(n){var f,u,t,e;i.eventRaiseByRow?i.eventRaiseByRow=!1:(f=n.currentTarget.checked,u=$(n.currentTarget).closest("tr"),r.clearSelection(),i.eventRaiseByRow=!1,f?(u.addClass("k-state-selected"),t=r.dataItem(u),t&&(e=nt(i.hierarchicalInformation[0]),t=i.hierarchicalInformation.length>1?skelta.grid.getRowData(i,r.element,u):skelta.grid.getDataForPersistance(t,e,i.hierarchicalInformation[0].Schema,i.persistCultureSpecificValues)),i.hierarchicalInformation[0].SelectionEnabled&&skelta.utilities.isMobileDisplayMode(i)&&i.mobileView&&i.mobileViewLoading&&(h(i,u.index(),r.dataSource.page(),r.dataSource.sort(),r.dataSource.filter()),i.previousSelection=!0),t&&!d(t,i._selectedValue.peek())&&(i.selectedValue=t)):(u.removeClass("k-state-selected"),i.selectedValue=undefined,h(i,-1,0,undefined,undefined),i.previousSelection=!1))}),i.autoLoadGrid!==u.Never||i.suppressInitialDuplicateDataBounds!==!0){if(i.onDataBoundScript)i.onDataBoundScript(t,i);bi(t,i)}}function tt(t,i){var r,u;i.onDataBoundScript&&(r={event:t,control:i},i.topLevelForm.isFormLoaded.peek()===!0?dt(r):(u=n.wrapFunction(this,dt,[r]),i.topLevelForm.functionQueueToBeTriggeredAfterFormLoad.push(u)))}function dt(n){n.control.onDataBoundScript(n.event,n.control)}function gt(t){var u,i;try{var f=t.event,e=t.recordNumber,r=Number(e);if(isNaN(r)||r<=0)return;u=f.sender;i=u.tbody.find("tr").eq(r-1);!n.isUndefined(i)&&i.length>0&&u.select(i)}catch(o){}}function lr(t,i,r){var u,f;t.sender.options.selectable!==!1&&(u={event:t,recordNumber:i},r.topLevelForm.isFormLoaded.peek()===!0?gt(u):(f=n.wrapFunction(this,gt,[u]),r.topLevelForm.functionQueueToBeTriggeredAfterFormLoad.push(f)))}function ar(n,t,i){i.mobileView=!0;i.mobileViewLoading=!0;ir(i)}function vr(n,t,i){i.mobileView=!1;i.mobileViewLoading=!1;i.previousSelection=!1;i.selectedRowIndex>-1&&(i.previousSelection=!0);rr(i)}function yr(n,t){var r=n.sender,u=r.select(),i=r.dataItem(u),e,o,f;i&&(e=nt(t.hierarchicalInformation[0]),i=t.hierarchicalInformation.length>1?skelta.grid.getRowData(t,r.element,u):skelta.grid.getDataForPersistance(i,e,t.hierarchicalInformation[0].Schema,t.persistCultureSpecificValues));o=kt(n.sender,t);$(o).find(".k-state-selected").not(u).not("span").removeClass("k-state-selected");t.hierarchicalInformation[0].SelectionEnabled&&skelta.utilities.isMobileDisplayMode(t)&&t.mobileView&&u.index()>-1&&(h(t,u.index(),r.dataSource.page(),r.dataSource.sort(),r.dataSource.filter()),t.previousSelection=!0);t.onCheckSelect&&i?(f=u.find("td:nth-child(2) input"),d(i,t._selectedValue.peek())||(t.selectedValue=i),!f.prop("checked")&&t.selection&&(t.eventRaiseByRow=!0,f.prop("type")==="radio"&&(f.prop("checked",!0),t.eventRaiseByRow=!1),f.click())):i&&!d(i,t._selectedValue.peek())&&(t.selectedValue=i)}function pr(t,i){var r,u,f;t.sender&&(r=t.sender,u=t.sender.element.attr("data-source"),(typeof t.column.reorderable=="undefined"||t.column.reorderable)&&(typeof t.sender.columns[t.newIndex].reorderable=="undefined"||t.sender.columns[t.newIndex].reorderable)?u&&(f=this.getSourceDetails(u,i.hierarchicalInformation),f.detail.Order==1&&n.moveItemInArray(i.header,t.oldIndex,t.newIndex)):setTimeout(function(){r.reorderColumn(t.oldIndex,r.columns[t.newIndex])},0))}function e(t,i){var s,f,e,r,h,l;if(t.getGridDataIsCalled=!0,i===!0&&t.renderAsDataSource===0&&!skelta.utilities.isUndefined(t.hierarchicalInformation)&&(lt(t,t.hierarchicalInformation[0]),s=$(t.domElement),f=s.data("kendoGrid"),f!==undefined))for(e=t.header,r=0;r<e.length;r++)h=e[r].field,$(f.columns).each(function(){this.field===h&&f.reorderColumn(r,this)});t.sourceData!=undefined&&t.sourceData.length<1&&(t.schemaInfo=undefined);var v=skelta.userContext.getUserContextFor("appN"),y=skelta.userContext.getUserContextFor("uId"),c=skelta.userContext.getUserContextFor("lookupTimeout"),p=isNaN(c)?50:c,w=li(t),o=t.renderAsDataSource,b=t.schemaInfo===undefined&&o!==1?!0:!1,k=t.modeOfExecution,d=k===a.Synchronous?!1:!0,g=t.isExtendedInfo&&o!==1?!0:!1;if(o===0&&t.gridInformationReceived!==!0){t.autoLoadGrid===u.Never&&(t.isGridDataCallQueued=!0);return}n.isWorkTasksPro()&&t.isParameterizedGrid===!1?i===!0?n.isWorkTasksProConnectedToInternet()?window.top.updateFormGridData(t,ni):n.showWorkTasksProAccountErrorMessage():ni(t):(l=n.createJsonRequestHelper({appName:v,userId:y,config:t.configName,source:t.sourceName,parameters:w,schemaRequired:b,jsonSchemaRequired:t.schemaSet!==!0,extendedInfoRequired:g,getCultureSpecificValues:t.persistCultureSpecificValues}),skelta.forms.utilities.abortRequest(t),t.xhr=$.ajax({type:"POST",async:d,contentType:"application/json; charset=utf-8",data:l.getValueForPostRequest(),url:n.getServerUrl("NextGenFormService.aspx/GetGridConfigData"),dataType:"json",timeout:1e3*p,beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(n){t.firstRowSelectFired=!1;n.d?it(t,$.parseJSON(n.d)):rt(t)},error:function(i){i.statusText==="abort"?skeltaUtils.getLogger().logInformation(skelta.localize.getString("AjaxReqCancelled").replaceString("<@ajaxrequestname@>","GetGridConfigData").replaceString("<@controlid@>",t.id)):(n.showError(document.title,skelta.localize.getString("Form_DataGrid_DataError").replace("<@id@>",t.id)),skeltaUtils.getLogger().logError(skelta.localize.getString("Form_DataGrid_DataError").replace("<@id@>",t.id)+"\n"+i.responseText))}}))}function ni(n){var i=window.top.formGridsDataFromAppCache,t=i.filter(function(t){return t.Name===n.configName});if(!skeltaUtils.isUndefinedNullOrEmpty(t)&&t.length>0&&!skeltaUtils.isUndefinedNullOrEmpty(t[0].Data))try{it(n,$.parseJSON(t[0].Data))}catch(r){rt(n)}else rt(n)}function it(i,u){var s=i.renderAsDataSource,a=i.schemaInfo===undefined&&s!==1?!0:!1,f,c,l,h,e;if(i.schemaSet!==!0){if(skelta.utilities.isUndefinedNullOrEmpty(u.jsonSchema)){i.onDataBound=function(){};r(i);t.logError("Error while getting grid information for grid "+i.id);return}ct(i,u.jsonSchema)}if(u.gridData)if(f=u.gridData,s===1)i._source(f),tt(null,i);else{if(i.sourceData=f,i.schemaInfo===undefined&&a&&(c=u.gridSchema,i.schemaInfo=c,oi(i.header,i.schemaInfo)),i.viewSettingsMode===!0){if(n.isUndefinedNullOrEmpty(i.schemaInfo)){i.findById("GN").isValid(i.configName);return}if(Object.keys(i.schemaInfo).length>0)f=bt(i.schemaInfo),i.findById("GN").isValid("");else{i.findById("GN").isValid(i.configName);return}}l={model:{fields:i.schemaInfo}};h=new kendo.data.DataSource({transport:{read:function(n){n.success(f)}},schema:l,pageSize:i.pageSize});i.hierarchicalInformation[0].Schema=i.schemaInfo;n.isUndefinedNullOrEmpty(i.gridOptions)||(e=o(i.gridOptions,i.hierarchicalInformation[0].SourceName),n.isUndefined(e)||n.isUndefinedNullOrEmpty(e.sort)||h.sort(e.sort));i.mobileView=!1;i.mobileViewLoading=!1;i.previousSelection=!1;i.currentSort=undefined;i.currentFilter=undefined;i.selectedRowIndex=-1;i.selectedRowPage=0;i.selectedValue=undefined;i._source(h);r(i,null,!0)}else i._source([]),s===1?tt(null,i):(i.selectedValue=undefined,r(i))}function rt(n){n._source([]);n.renderAsDataSource===1?tt(null,n):(n.selectedValue=undefined,r(n))}function wr(n){return n&&typeof n=="object"&&Object.keys(n).length===2&&n.hasOwnProperty(s)}function ti(t,i,r,u){r[i]=t?t[i].type==="boolean"&&n.isNullOrEmpty(u)?u:t[i].type==="number"?eu(u):t[i].type==="date"?u:t[i].parse(u):u}function w(n,t,i,r){var e=i[t].PersistColumns,f=i[t].Schema,u;return $.each(e,function(t,i){if(r){var u=n[i];n[i]={};n[i][s]=u}else wr(n[i])?ti(f,i,n,n[i][s]):ti(f,i,n,n[i])}),t=t+1,i.length>t&&(u=i[t].SourceName,n.hasOwnProperty(u)&&($.isPlainObject(n[u])?n[u]=w(n[u],t,i,r):$.isArray(n[u])&&$.each(n[u],function(f,e){n[u][f]=w(e,t,i,r)}))),n}function br(t,i){var r=t[0].SourceName,u={Grid:{Data:{}}};return $.each(i,function(n,f){if(i[n][r]=w(f[r],0,t,!0),$.isEmptyObject(u.Grid.Data))u.Grid.Data=i[n];else if($.isArray(u.Grid.Data[r]))u.Grid.Data[r].push(i[n][r]);else{var e=u.Grid.Data[r];u.Grid.Data[r]=[];u.Grid.Data[r].push(e);u.Grid.Data[r].push(i[n][r])}}),n.getXmlFromJSONObject(u)}function kr(n,t){var i=$.extend(!0,{},t),u,f,r;$.isArray(t)||(i=[],u={},u[n.sourceName]=$.extend(!0,{},t),i.push(u));f=n.hierarchicalInformation[0].SourceName;$.each(i,function(t,r){i[t][f]=p(r[f],0,n.hierarchicalInformation)});r=br(n.hierarchicalInformation,i);"<Grid><Data/><\/Grid>"===r&&(r="");n.isExtendedInfo&&n.hierarchicalInformation.length===1&&(n.extendedInformation=pt(n,t));n.value=encodeURIComponent(r)}function ii(i,r){var o,e,f;if(n.isUndefined(r)||typeof r!="string")t.logInformation(skelta.localize.getString("FormGridObjectcheck"));else if(r!==""){if(o=decodeURIComponent(r),e=i.schemaInfo,e!==undefined){i.hierarchicalInformation[0].Schema=e;var s=n.getJSONObjectFromXml(o),c=s?s.Grid.Data:[],h=i.sourceName,u=c[h];u=u.length?u:[u];f=[];$.each(u,function(n,t){var r={};r[h]=w(t,0,i.hierarchicalInformation,!1);f.push(r)});i.uiValue=f;i.extendedInformation=pt(i,f)}}else i.uiValue=[],i.extendedInformation=[]}function ri(t,i){var a,nt,u,w,d,e,r,y,p;if(n.isUndefined(i)||i==="")t.displayValue="";else if(t.svCols==="")t.displayValue="";else if(a=t.schemaInfo,a!==undefined){nt=decodeURIComponent(i);t.hierarchicalInformation[0].Schema=a;var tt=n.getJSONObjectFromXml(nt),it=tt?tt.Grid.Data:[],rt=t.sourceName,o=it[rt];if(o){o=o.length?o:[o];u=t.persistCols;w=t.svCols;w=w.replace(/ /g,"");var g=w.split(","),c=t.sourceData,v=[],l=!1,f=0,h="",b,k;if(o.length===undefined)for(e=0;e<c.length;e++){for(r=0;r<u.length;r++)if(b=c[e][u[r]],k=a[u[r]].parse(o[u[r]][s]),ft(b,k))l=!0,f++;else{f--;break}if(f===u.length&&l){v.push(c[e]);l=!1;f=0;break}f=0}else for(d=0;d<o.length;d++)for(e=0;e<c.length;e++){for(r=0;r<u.length;r++)if(b=c[e][u[r]],k=a[u[r]].parse(o[d][u[r]][s]),ft(b,k))l=!0,f++;else{f--;break}if(f===u.length&&l){v.push(c[e]);l=!1;f=0;break}f=0}for(y=0;y<v.length;y++){for(p=0;p<g.length;p++)h=h+v[y][g[p]],p!==g.length-1&&(h=h+", ");y!==v.length-1&&(h=h+" | ")}t.displayValue=h}else t.displayvalue=""}}function dr(n,t){var i=[];return $.each(t,function(t,r){i.push({Name:r.Name,Value:n[r.Value]})}),i}function gr(i,r){var u=r.hierarchicalInformation,h,l,a;if(u.length!==1){var v=$(i.masterRow).closest("[data-role='grid']").attr("data-source"),y=this.getSourceDetails(v,r.hierarchicalInformation),f=y.index+1,s=u[f].SourceName;if(s){var c=f+1!==u.length,p=u[f].ParameterMappings,w=dr(i.data,p),e=!1;if(!r.readOnly&&(e=u[f].SelectionEnabled,!e&&!c))for(e=!0,h=0;h<f;h++)if(u[h].SelectionEnabled){e=!1;break}l=n.createJsonRequestHelper({appName:skelta.userContext.getUserContextFor("appN"),userId:skelta.userContext.getUserContextFor("uId"),config:r.configName,source:s,parameters:w,schemaRequired:!0,jsonSchemaRequired:r.schemaSet!==!0,extendedInfoRequired:r.isExtendedInfo,getCultureSpecificValues:r.persistCultureSpecificValues});$("<div style='position:relative;height:50px;' class='k-loading-image'><\/div>").appendTo(i.detailCell);a=skelta.utilities.getPromise(skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetGridConfigData"),l,"POST");a.done(function(t){var y,a,h,l,v,p;if(!t.d){i.detailCell.empty();return}y=$.parseJSON(t.d);u[f].Schema=y.gridSchema;oi(u[f].HeaderColumns,u[f].Schema);var w={model:{fields:u[f].Schema}},k=r.viewSettingsMode===!0?bt(w.model.fields):y.gridData,b=new kendo.data.DataSource({data:k,schema:w,pageSize:r.pageSize});skeltaUtils.isUndefinedNullOrEmpty(r.gridOptions)||(a=o(r.gridOptions,s),wt(u[f].HeaderColumns,a),n.isUndefined(a)||n.isUndefinedNullOrEmpty(a.sort)||b.sort(a.sort));h=i.sender.options;l={data:b,useKOTemplates:!0,scrollable:h.scrollable,filterable:h.filterable,sortable:h.sortable,reorderable:h.reorderable,resizable:h.resizable,groupable:h.groupable,mobile:h.mobile,pageable:h.pageable,selectable:e,dataBinding:h.dataBinding,dataBound:h.dataBound,columnReorder:h.columnReorder,change:h.change,rowTemplate:r._enableMultiSelect?"Sk_Grid":"Sk_Grid_Radio",altRowTemplate:r._enableMultiSelect?"Alt_Sk_Grid":"Alt_Sk_Grid_Radio",columns:u[f].HeaderColumns};h.toolbar&&(l.toolbar=h.toolbar,h.excel&&(l.excel=h.excel),h.pdf&&(l.pdf=h.pdf));h.columnMenu&&(l.columnMenu=h.columnMenu);c&&(l.detailInit=h.detailInit);r.isHierarchy=c;r.dc=u[f].ViewColumns;r.selection=r.viewSettingsMode===!0?!1:u[f].AllowSelection;r.selectionEnabled=u[f].SelectionEnabled;r.selection&&(l.columns=[{headerTemplate:" ",width:"35px",reorderable:!1}].concat(u[f].HeaderColumns));r.isExpanding=!0;i.detailCell.empty();v="options"+f;r[v]=l;p=$("<div data-source='"+s+"' data-bind='kendoGrid: "+v+"'><\/div>").appendTo(i.detailCell);ko.applyBindingsToNode(p[0],null,r);et(p.data("kendoGrid"));delete r[v]}).fail(function(u){i.detailCell.empty();n.showError(document.title,skelta.localize.getString("Form_DataGrid_DataError").replace("<@id@>",r.id));t.logError(skelta.localize.getString("Form_DataGrid_DataError").replace("<@id@>",r.id)+"\n"+u.responseText)})}}}function ui(n,t){var i,r;return $.each(t,function(t,u){return u.SourceName===n&&(i=u,r=t),i?!1:!0}),{detail:i,index:r}}function nu(n,t,i,r){var u={};return $.each(t,function(t,f){n.hasOwnProperty(f)&&(u[f]=n[f]instanceof Date&&r?ut(n[f],i[f]):n[f])}),u}function tu(n){var u=[],r,t,i;for(r in n)n.hasOwnProperty(r)&&(t=$.parseJSON(n[r]),t.PersistColumns=$.parseJSON(t.PersistColumns),t.ViewColumns=$.parseJSON(t.ViewColumns),t.HeaderColumns=$.parseJSON(t.HeaderColumns),t.ColorExpression=$.parseJSON(t.ColorExpression),i=$.parseJSON(t.ParameterMapping),t.ParameterMappings=i.length?i:[i],u.splice(t.Order,0,t));return u}function fi(n,t){var r,i,u;for(i in n)if(n.hasOwnProperty(i))if(i===t){r=n[i];break}else if(u=n[i],typeof u=="object"&&(r=fi(n[i],t),r))break;return r}function iu(n,t,i,r){for(var f=!0,l=!0,e=0,u=n,s=t,a,c,h,o;l;){if(c=r[e],h=r[e].SourceName,u=u[h],s=s[h],$.isPlainObject(u))$.each(c.PersistColumns,function(n,t){return f=u[t]===s[t]});else for(o=0;o<u.length;o++)if($.each(c.PersistColumns,function(n,t){return f=u[o][t]===s[t]}),f){u=u[o];break}f&&(a=h);e=e+1;l=f&&r[e].SourceName!==i}return a}function ru(n,t,i){var r={},u;return r.ModelValueIndex=-1,r.HierarchicalInformationIndex=-1,$.each(i,function(n,t){t.AllowSelection===!0&&(u=t.SourceName)}),$.each(n,function(n,f){var o=iu(f,t,u,i),e;o&&(e=skelta.grid.getSourceDetails(o,i),e.index>r.HierarchicalInformationIndex&&(r.HierarchicalInformationIndex=e.index,r.ModelValueIndex=n))}),r}function uu(n,t,i){var u=null,s,h,l,a,c;if(i.length>0){var v=t.attr("data-source"),e=skelta.grid.getSourceDetails(v,n.hierarchicalInformation),f=i,r=e.index,o;for(s=0;s<=e.index;s++)h=n.hierarchicalInformation[r].SourceName,l=$(t).data("kendoGrid").dataItem(f),u={},a=nt(n.hierarchicalInformation[r]),u[h]=skelta.grid.getDataForPersistance(l,a,n.hierarchicalInformation[r].Schema,n.persistCultureSpecificValues),r>=0&&(o&&r<e.index&&(c=n.hierarchicalInformation[r+1].SourceName,u[h][c]=o[c]),o=u,r--,f=f.closest(".k-detail-row").prev(),t=f.closest("[data-role='grid']"))}return u}function ei(n,t,i,r,u){var e=i[u].SourceName,f=i[u+1].SourceName,o=u===0?n[e][f]:n[f],h,s;if(u===r)o.length?u===0?n[e][f].push(t[e][f]):n[f].push(t[e][f]):u===0?(n[e][f]=[],n[e][f].push(o),n[e][f].push(t[e][f])):(n[f]=[],n[f].push(o),n[f].push(t[e][f]));else{if(u=u+1,$.isArray(o))for(h=i[u].PersistColumns,s=0;s<o.length;s++)if($.each(h,function(n,i){return match=o[s][i]==t[e][f][i]}),match){o=o[s];break}ei(o,t[e],i,r,u)}}function c(n){return n?n.element.attr("data-source"):""}function fu(n,t,i){var r=n[t],f,u;return skeltaUtils.isUndefined(r)?r:(f=$(i).closest("[data-role='grid']").data("kendoGrid").dataSource.options.schema.model.fields,u=f[t],skeltaUtils.isUndefined(u))?r:(u.type==="number"?r=kendo.toString(n[t],b.format):u.type==="date"&&u.ShowOnlyTime===!0?r=kendo.toString(n[t],v.timeFormat):u.type==="date"&&(r=kendo.toString(n[t],v.generalFormatSpecifier)),r)}function oi(n,t){$.each(n,function(n,i){var r=t[i.field];r&&(r.type==="number"?i.filterable={ui:function(n){n.kendoNumericTextBox({format:b.format,decimals:b.decimals})}}:r.type==="date"&&r.ShowOnlyTime===!0?i.filterable={ui:function(n){n.kendoTimePicker({format:v.timeFormat})}}:r.type==="date"&&(i.filterable={ui:function(n){n.kendoDateTimePicker({format:v.generalFormatSpecifier})}}))})}function eu(n){return kendo.parseFloat(n,"en-US")}function ut(n,t){if(t.ShowOnlyTime===!0)return kendo.toString(n,skelta.forms.constants.dateFormats.timeFormatForCoreValue);var i=new Date(n.getTime()),r=skelta.forms.utilities.getDateTimeInServerUTCFormat(i,!1);return kendo.toString(r,skelta.forms.constants.dateFormats.dateTimeFormatForCoreValue)}function ft(n,t){return skelta.utilities.isNullOrEmpty(n)&&skelta.utilities.isNullOrEmpty(t)?!0:(typeof n!="boolean"||typeof t!="string"||skelta.utilities.isNullOrEmpty(t)||(t=$.parseJSON(t)),typeof t!="string"||skelta.utilities.isNullOrEmpty(t)||(t=skeltaUtils.decodeXmlValue(t)),n==t)}function ou(n,t){var i=$(n.domElement),r=i.data("kendoGrid");r&&r.destroy();ko.skUnapplyBindings($(i[0].parentNode));i.empty();n.schemaInfo=undefined;n.getGridInformationComplete=!1;n.setGridInformationComplete=!1;n.schemaSet=!1;n.gridInformationReceived=!1;n.setGridSchemaComplete=!1;n.subscriptionToGridParamsComplete=!1;n.doneUIBinding=!1;n.isGridDataCallQueued=!1;n.getGridDataIsCalled=!1;n.selection=!1;n.configName=t;n.autoLoadGrid="True";n.renderAsDataSource=0;n.viewSettingsMode=!0;n.modeOfExecution=a.Synchronous;n.visible=!0;skelta.grid.getGridInformation(n)}var si="A59E16BD-ED1E-471F-BB20-44755342578E",l=50,a={Synchronous:"Synchronous",Asynchronous:"Asynchronous"},u={OnFormLoadAndParameterChange:"True",OnFormLoad:"False",Never:"Never"},b={format:"#.####################",decimals:20},v={generalFormatSpecifier:"G",timeFormat:"T"},s="__cdata",k;return{processResponseForGetGridData:it,getFormatedText:fu,getGridInformation:pi,setGridInformation:yi,onGridParamValueChange:ur,onDataBinding:fr,onDataBoundChange:cr,showGridPopupDiv:ar,closeGridPopupView:vr,onSelectionChange:yr,onColumnReorder:pr,getGridData:e,updateGridCoreValue:kr,updateGridUiValue:ii,updateGridDisplayValue:ri,selectRecord:lr,getGridValue:nr,autoLoadGrid:u,detailInit:gr,getHierarchicalGridInformation:tu,getSourceDetails:ui,getDataForPersistance:nu,getGridSource:fi,getParentInformation:ru,updateModelData:ei,getDataSource:c,getRowData:uu,applyBindingsToGridControl:r,isValueMatching:ft,parseDateToInvariant:ut,initializeGrid:ou,gridValueConvertDateTimeToString:p}}();skelta.grid=new r}()}(),function(){skelta.utilities.isUndefined(skelta.attachment)&&function(){function n(){}n.prototype=function(){function r(t){var e=t.controlObject,r=t.file,u=t.fileName,f=t.filePath,i=this;i.controlObject=e;i.name=ko.observable(skelta.utilities.isUndefinedNullOrEmpty(u)?"":u);Object.defineProperty(i,"fileNameReadOnly",{get:function(){return i.name()},set:function(){},enumerable:!0,configurable:!0});i.path=ko.observable(skelta.utilities.isUndefinedNullOrEmpty(f)?"":f);i.fileObject=ko.observable(skelta.utilities.isUndefinedNullOrEmpty(r)?null:r);i.size=ko.observable(0);skelta.utilities.isUndefinedNullOrEmpty(u)&&(skelta.utilities.isUndefinedNullOrEmpty(r)||(i.name(r.name),i.size(r.size),i.path("")));i.enable=ko.computed(function(){return i.controlObject.enable});i.getHRefValue=ko.computed(function(){return n(i.controlObject)&&skelta.utilities.isUndefinedNullOrEmpty(i.path())?!1:"#"});i.delete=function(){i.controlObject._fileList.remove(i);i.controlObject=null;delete i.controlObject;skelta.forms.utilities.disposeAndDelete(i)};i.displayName=ko.computed(function(){var t=parseInt(i.controlObject.displayTextLength),n=i.name();return t!==0&&(n=n.substr(0,t)),n})}function n(n){return!skelta.utilities.isUndefined(n)&&(n.attachmentStorageType===1||n.attachmentStorageType===2)?!0:!1}function a(n){var t,i;try{t=$(n.currentTarget).siblings();t.length>0&&(i=t[0],i.click&&i.click())}catch(r){}}function v(n,t,i){i.validationError(!1);i.validationErrorMessage("");y(t.currentTarget.files,i,function(n,t,i,r){p(n,t,i,r);t._fileList.peek().length>0&&nt(t);w(t)})}function y(n,t,i){var r=0,u=0,e=t.fileList,f=[];$.each(n,function(n,i){skelta.utilities.doesArrayContainString(e,"fileNameReadOnly",i.name)?r++:d(t,i.name)===!1?u++:f.push(i)});i(f,t,r,u)}function p(n,t,i,u){if(i=skelta.utilities.isNumber(i)?i:0,u=skelta.utilities.isNumber(u)?u:0,skelta.utilities.isUndefined(n)||n.length===0){t.attachmentStorageType===1&&t.allowMultipleAttachments===!0&&(i>0||u>0)?skelta.utilities.showAlert(document.title,skelta.localize.getString("FormNGFAttachmentDuplicateAndOrInvalidFileExtnDiscardMsg")):u>0&&skelta.utilities.showAlert(document.title,skelta.localize.getString("FormNGFAttachmentInvalidFileExtnNotSupportedMsg").replaceString("<@fileTypes@>",skelta.utilities.getCommaSeparatedStringFromArray(t.fileExtensions().split(";"),"and")));return}if(t.attachmentStorageType===0||t.attachmentStorageType===2||t.allowMultipleAttachments===!1)t._fileList.push(new r({controlObject:t,file:n[0]}));else if(t.attachmentStorageType===1){var e=n.length,o=t.maximumAttachments-t.fileList.length,f=0;$.each(n,function(n,i){return f++,t._fileList.push(new r({controlObject:t,file:i})),f===o?!1:void 0});f!==e?i>0||u>0?skelta.utilities.showAlert(document.title,skelta.localize.getString("FormNGFAttachmentDuplicateAndOrInvalidFileExtnDiscardWithMaximumLimitExceededMsg").replace("<@maximumlimit@>",t.maximumAttachments.toString()).replace("<@filesuploaded@>",f.toString())):skelta.utilities.showAlert(document.title,skelta.localize.getString("FormNGFAttachmentMaximumLimitExceededMsg").replace("<@maximumlimit@>",t.maximumAttachments.toString()).replace("<@filesuploaded@>",f.toString())):(i>0||u>0)&&skelta.utilities.showAlert(document.title,skelta.localize.getString("FormNGFAttachmentDuplicateAndOrInvalidFileExtnDiscardMsg"))}}function f(n){for(var i=n.fileList.length,t=i-1;t>=0;t--)n.fileList[t].delete()}function w(n){var t=$("input[type='file'][controlid="+n.id+"]");t.children().remove();document.documentMode>=10?(t.wrap("<form>").closest("form").get(0).reset(),t.unwrap()):t.val("")}function b(n){var t="";return $.each(n.fileList,function(n,i){t+=i.name()+"|"}),t.length>0&&(t=t.substr(0,t.length-1)),t}function k(n){var t="";return n.attachmentStorageType===0?"":($.each(n.fileList,function(n,i){t+=i.path()+"|"}),t.length>0&&(t=t.substr(0,t.length-1)),t)}function d(n,t){var i=n.fileExtensions(),r;return skelta.utilities.isUndefinedNullOrEmpty(i)?!0:(r=i.split(";"),skelta.utilities.isUndefinedNullOrEmpty(t))?!1:skelta.utilities.doesArrayContainString(r,null,t.substring(t.lastIndexOf(".")).trim())}function g(n){return n.confirmAttachmentQuestion.trim()===""?skelta.localize.getString("FormNGFAttachmentConfirmDeletionDefault"):n.confirmAttachmentQuestion}function u(n){var t=n.persistIdOfBoundControl,r={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm},i=n.findById(t,r);return skelta.utilities.isUndefined(i)?skelta.utilities.showError(doument.title,skelta.localize.getString("FormNGFPesistFileNameControlNotFound").replaceString("<@CId@>",t),function(){return}):i.controlType!="TextInput"&&skelta.utilities.showError(doument.title,skelta.localize.getString("FormNGFPesistFileNameControlNotTextInput").replaceString("<@CId@>",t),function(){return}),i}function s(n){var t,i;try{n.attachmentStorageType===0&&(n.topLevelForm.isFormLoaded.peek()===!0?(t=u(n),skelta.utilities.isUndefined(t)||skelta.utilities.isUndefined(t._value)||t._value.subscribe(function(t){n.showDownload()&&(t.trim()===""?n.fileList[0].name(skelta.localize.getString("FormNGFAttachmentNoFileName")):n.fileList[0].name(t))})):(i=skelta.utilities.wrapFunction(this,s,[n]),n.topLevelForm.functionQueueToBeTriggeredAfterFormLoad.push(i)))}catch(r){}}function nt(n){var o,s,h,r,c;if(n.attachmentStorageType===0){if(skelta.forms.utilities.isWorkTasksPro()&&skelta.forms.utilities.isWorkTasksProConnectedToInternet()===!1){tt(n);return}o=!1;skelta.forms.utilities.showLoader();s=skelta.userContext.getUserContextFor("appN");h=new FormData;h.append("fileToUpload",n.fileList[0].fileObject());r=new XMLHttpRequest;r.addEventListener("load",function(e){var s,c,h;if(r.readyState==4)if(r.status==200)try{s=$.parseJSON(e.target.responseText);s.IsSuccess==!0?(c=n.fileList[0].name(),n.fileList[0].path(""),i(n,t("",s.Result)),n.persistHeader||(h=u(n),skelta.utilities.isUndefined(h)||(h.value=c)),o=!0):skelta.utilities.getLogger().logError(skelta.localize.getString("FormNGFFileUploadResponseError").replace("<@msg@>",s.ErrorMessage))}catch(l){skelta.utilities.getLogger().logError(skelta.localize.getString("FormNGFFileUploadResponseError").replace("<@msg@>",l.toString()))}else skelta.utilities.getLogger().logError(skelta.localize.getString("FormNGFFileUploadError"));skelta.forms.utilities.hideLoader();o===!1&&(skelta.utilities.showError(document.title,skelta.localize.getString("FormNGFAttachmentUploadUnsuccessfulMsg")),f(n),i(n,t()))},!1);r.addEventListener("error",function(){skelta.forms.utilities.hideLoader();skelta.utilities.getLogger().logError(skelta.localize.getString("FormNGFFileUploadError"));skelta.utilities.showError(document.title,skelta.localize.getString("FormNGFAttachmentUploadUnsuccessfulMsg"));f(n);i(n,t())},!1);r.open("POST",skelta.forms.utilities.getServerUrl("Upload.aspx"),!0);c=encodeURI(n.renderDetailsInternalValue);r.setRequestHeader("applicationName",s);r.setRequestHeader("renderDetailsInternalValue",c);r.setRequestHeader("cs",skelta.utilities.getCRC16BitChecksum(s+c));skelta.forms.utilities.addRequestHeaders(r);r.send(h)}else i(n,e(n))}function tt(n){if(!(n.fileList.length<0))if(skelta.forms.utilities.isWorkTasksProOfflineSupportEnabled()===!1)skelta.forms.utilities.showWorkTasksProAccountErrorMessage();else{var t=n.fileList[0],i=window.top.writeAttachmentToSQLite;n.topLevelForm.validationPromises=[];n.topLevelForm.validationPromises.push(new Promise(function(r){(function(t){var u,f;try{u=new FileReader;u.readAsDataURL(t.fileObject());f={columnName:n.securityMode==1?"Data":"Base64EncodedData",securityMode:n.securityMode,identifierColumn:"Id",tableName:"SKEListItemDataTemp",identifier:skeltaUtils.getGuId(),persistHeader:n.persistHeader};u.onload=function(){i({fileName:t.name(),fileData:u.result,filePath:"",StorageType:n.attachmentStorageType,Settings:JSON.stringify(f)});skelta.forms.utilities.showLoader();it(f,t.name(),n);r()};u.error=function(){r()}}catch(e){}})(t)}))}}function it(n,r,f){var o=n.identifier+"@$@"+n.identifierColumn+"@$@"+n.tableName+"@$@"+n.columnName+"@$@"+r+"@$@"+(f.persistHeader?"True":"False"),e;if(f.fileList[0].path(""),n.securityMode==0)f.value=o,f.persistHeader||(e=u(f),skelta.utilities.isUndefined(e)||(e.value=r)),skelta.forms.utilities.hideLoader();else{function s(n){if(f.value=skelta.forms.utilities.isUndefinedNullOrEmpty(n)===!1?n:"",i(f,t("",n)),!f.persistHeader){var e=u(f);skelta.utilities.isUndefined(e)||(e.value=r)}skelta.forms.utilities.hideLoader()}window.top.secureValueEncryptFn(s,o)}}function o(n){return skelta.utilities.isUndefined(n)?skelta.forms.constants.defaultFilePathTemplate:n.attachmentStorageType===2?skelta.forms.constants.cloudFilePathTemplate:n.filePathTemplate}function rt(n){var t={uploadStatus:!1,errorMessage:""},y,u,r,f,p,w,b,e,s,l,i,a,v;if(n.fileList.length<0)return t.uploadStatus=!0,t;for(y in n.fileList){if(u=!1,r=n.fileList[y],!skelta.utilities.isUndefined(r.fileObject())&&skelta.utilities.isUndefinedNullOrEmpty(r.path())){if(f=h(o(n)),f.length>0)return t.errorMessage=skelta.localize.getString("Attachment_Error_FilePathTemplate_InvalidTags"),skelta.utilities.getLogger().logError(t.errorMessage+" - "+f.join(", ")),t;if(n.attachmentStorageType===2&&(p=new RegExp(/^[^|\/]{0,987}[^.|\/]$/),w=p.test(r.name()),!w))return t.uploadStatus=!1,t.errorMessage=skelta.localize.getString("FormNGFFileNameValidationUploadForCloudError"),t;if(skelta.forms.utilities.isWorkTasksPro()&&skelta.forms.utilities.isWorkTasksProConnectedToInternet()===!1)if(skelta.forms.utilities.isWorkTasksProOfflineSupportEnabled()===!1)skelta.forms.utilities.showWorkTasksProAccountErrorMessage();else{if(n.attachmentStorageType===2)return t.uploadStatus=!1,t.errorMessage=skelta.localize.getString("FormNGFFileUploadForCloudErrorSendData"),t;b=window.top.writeAttachmentToSQLite;e=c(o(n),r.name());n.topLevelForm.validationPromises.push(new Promise(function(t){(function(i,r){try{var u=new FileReader;u.readAsDataURL(i.fileObject());u.onload=function(){b({fileName:i.name(),fileData:u.result,filePath:r,StorageType:n.attachmentStorageType});t()};u.error=function(){t()}}catch(f){}})(r,e)}));r.path(e);u=!0}else{s=skelta.userContext.getUserContextFor("appN");l=new FormData;l.append("fileToUpload",r.fileObject());i=new XMLHttpRequest;i.addEventListener("load",function(n){if(i.readyState==4)if(i.status==200)try{var f=$.parseJSON(n.target.responseText);f.IsSuccess==!0?(r.path(f.Result),u=!0):t.errorMessage=skelta.localize.getString("FormNGFFileUploadResponseError").replace("<@msg@>",f.ErrorMessage)}catch(e){t.errorMessage=skelta.localize.getString("FormNGFFileUploadResponseError").replace("<@msg@>",e.toString())}else t.errorMessage=skelta.localize.getString("FormNGFFileUploadError")},!1);i.addEventListener("error",function(){t.errorMessage=skelta.localize.getString("FormNGFFileUploadError")},!1);i.open("POST",skelta.forms.utilities.getServerUrl("Upload.aspx"),!1);a=encodeURI(c(o(n),r.name()));v=encodeURI(n.renderDetailsInternalValue);i.setRequestHeader("applicationName",s);i.setRequestHeader("renderDetailsInternalValue",v);i.setRequestHeader("filePath",a);i.setRequestHeader("cs",skelta.utilities.getCRC16BitChecksum(s+a+v));skelta.forms.utilities.addRequestHeaders(i);try{i.send(l)}catch(k){u=!1;t.errorMessage=skelta.localize.getString("FormNGFFileUploadErrorSendData")}}}else u=!0;if(!u)return t.uploadStatus=!1,t}return t.uploadStatus=!0,t}function ut(n,t){var r=h(t),i;return r.length>0?(i=skelta.localize.getString("Attachment_Error_FilePathTemplate_InvalidTags"),skelta.utilities.getLogger().logError(i+" - "+r.join(", ")),new ValidationOptions(!1,i)):new ValidationOptions(!0,"")}function h(n,t){var f=skelta.forms.constants.filePathTemplateConstants,i,r,o,e,u;if(((skelta.utilities.isUndefined(t)||!skelta.utilities.isBoolean(t))&&(t=!1),i=[],skelta.utilities.isUndefinedNullOrEmpty(n))||(r=n.match(/(<([^>]+)>)/ig),r.length<1))return i;for(o=Object.values(f),e=r.find(function(n){return n.toLowerCase()==f.storagePath.toLowerCase()}),skelta.utilities.isUndefinedNullOrEmpty(e)||n.trim().startsWithString(f.storagePath)||i.push(e),u=0;u<r.length;u++)if(!o.some(function(n){return n.toLowerCase()===r[u].toLowerCase()})&&(i.push(r[u]),t))return i;return i}function c(n,t){var u=new Date,r,i;return(skelta.utilities.isUndefined(n)||skelta.utilities.isEmpty(n.trim()))&&(n=skelta.forms.constants.defaultFilePathTemplate),r=skelta.forms.constants.filePathTemplateConstants,i=n.replaceString(r.year,skelta.forms.utilities.padZeroes(u.getUTCFullYear().toString(),4),!1,!0),i=i.replaceString(r.month,skelta.forms.utilities.padZeroes(u.getUTCMonth()+1,2),!1,!0),i=i.replaceString(r.date,skelta.forms.utilities.padZeroes(u.getUTCDate(),2),!1,!0),i=i.replaceString(r.hours,skelta.forms.utilities.padZeroes(u.getUTCHours(),2),!1,!0),i=i.replaceString(r.minutes,skelta.forms.utilities.padZeroes(u.getUTCMinutes(),2),!1,!0),i=i.replaceString(r.seconds,skelta.forms.utilities.padZeroes(u.getUTCSeconds(),2),!1,!0),i=i.replaceString(r.milliseconds,skelta.forms.utilities.padZeroes(u.getUTCMilliseconds(),3),!1,!0),i=i.replaceString(r.guid,skelta.forms.utilities.getGuId(),!1,!0),i=i.replaceString(r.fileName,ft(t),!1,!0),i.replaceString(r.fileExtension,l(t),!1,!0)}function l(n){try{var t=/(?:\.([^.]+))?$/.exec(n)[1];return skelta.utilities.isUndefinedNullOrEmpty(t)?"":t}catch(i){return""}}function ft(n){try{var t=l(n);return n.substr(0,n.length-t.length-1)}catch(i){return logger.logError("Error while fetching the file name without extension. "+i.message),""}}function et(t,i,r){var o=skelta.userContext.getUserContextFor("appN"),e="",u={},s,f;if(skelta.forms.utilities.isWorkTasksPro()){if(skelta.forms.utilities.isWorkTasksProConnectedToInternet()===!1){r.controlObject.attachmentStorageType===1&&window.top.window.isOutboxForm===!0?window.top.viewAttachment(r.name()):window.top.window.isInboxForm===!0&&r.controlObject.attachmentStorageType!==2?window.top.viewAttachment(r.name()):skelta.forms.utilities.showWorkTasksProAccountErrorMessage();return}if(n(r.controlObject)){if(r.controlObject.attachmentStorageType===2){var h=!1,c=skelta.userContext.getUserContextFor("appN"),l=skelta.userContext.getUserContextFor("uId"),a=skeltaUtils.createJsonRequestHelper({applicationName:c,userId:l});if($.ajax({type:"GET",async:!1,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/UserHasReadWritePermission"),data:a.getValueForGetRequest(),contentType:"application/json; charset=utf-8",beforeSend:skelta.forms.utilities.addRequestHeaders,dataType:"json",success:function(n){h=n.d},error:function(){skelta.utilities.showError(document.title,skelta.localize.getString("AttachmentDownloadNoPermission"));logger.logError(skelta.localize.getString("AttachmentDownloadNoPermission"))}}),!h){skelta.utilities.showError(document.title,skelta.localize.getString("AttachmentDownloadNoPermission"));return}}skelta.utilities.isUndefinedNullOrEmpty(r.path())||(u={filePath:r.path(),applicationName:o,fileName:r.name(),storageType:r.controlObject.attachmentStorageType},u.cs=skelta.utilities.getCRC16BitChecksum(u.filePath+u.applicationName+u.fileName+u.storageType),e=skelta.forms.utilities.getServerUrl(skelta.utilities.getUrlString("Download.aspx",u)))}else u={securedValue:r.controlObject.value,applicationName:o,fileName:r.name(),storageType:r.controlObject.attachmentStorageType},u.cs=skelta.utilities.getCRC16BitChecksum(u.securedValue+u.applicationName+u.fileName+u.storageType),u.securityMode=r.controlObject.securityMode,e=skelta.forms.utilities.getServerUrl(skelta.utilities.getUrlString("Download.aspx",u));skelta.utilities.isUndefinedNullOrEmpty(e)||(s=skelta.userContext.getUserContextFor("authenticationToken"),skeltaUtils.isUndefinedNullOrEmpty(s)||(e+="&Authentication="+encodeURIComponent(s)),window.open(e))}else n(r.controlObject)?skelta.utilities.isUndefinedNullOrEmpty(r.path())||(f=$("input[type='file'][controlid="+r.controlObject.id+"]"),f.children().length===0&&f.append('<iframe id="'+r.controlObject.id+'_downloadFrame"><\/iframe>'),u={filePath:r.path(),applicationName:o,fileName:r.name(),storageType:r.controlObject.attachmentStorageType},u.cs=skelta.utilities.getCRC16BitChecksum(u.filePath+u.applicationName+u.fileName+u.storageType),document.getElementById(r.controlObject.id+"_downloadFrame").setAttribute("src",skelta.forms.utilities.getServerUrl(skelta.utilities.getUrlString("Download.aspx",u)))):(f=$("input[type='file'][controlid="+r.controlObject.id+"]"),f.children().length===0&&f.append('<iframe id="'+r.controlObject.id+'_downloadFrame"><\/iframe>'),u={securedValue:r.controlObject.value,applicationName:o,fileName:r.name(),storageType:r.controlObject.attachmentStorageType},u.cs=skelta.utilities.getCRC16BitChecksum(u.securedValue+u.applicationName+u.fileName+u.storageType),u.securityMode=r.controlObject.securityMode,document.getElementById(r.controlObject.id+"_downloadFrame").setAttribute("src",skelta.forms.utilities.getServerUrl(skelta.utilities.getUrlString("Download.aspx",u))))}function ot(n,t,r){var f=r.controlObject,o=function(){if(f.validationError(!1),f.validationErrorMessage(""),r.delete(),i(f,e(f)),f.fileList.length<1&&f.attachmentStorageType===0&&!f.persistHeader){var n=u(f);skelta.utilities.isUndefined(n)||(n.value="")}};f.confirmAttachmentDeletion?skelta.utilities.showConfirmation("",g(f),function(n){n&&o()}):o()}function st(t,r,u){if(!t||n(r)){var f=ht(r);n(r)&&!skelta.utilities.isUndefined(f)&&f.uploadStatus&&i(r,e(r));r.attachmentStorageType!==0||f?n(r)&&!f.uploadStatus&&(u=f.uploadStatus,r.validationError(!0),r.validationErrorMessage(f.errorMessage),r.validationErrorCode(errorConstants.controlSpecificValidation)):(u=f,r.validationError(!0),r.validationErrorMessage(skelta.localize.getString("FormNGFAttachment")),r.validationErrorCode(errorConstants.controlSpecificValidation))}return u}function ht(n){return n.attachmentStorageType===0?ct(n):rt(n)}function ct(n){if(skelta.forms.utilities.isWorkTasksPro()&&skelta.forms.utilities.isWorkTasksProConnectedToInternet()===!1)return!0;var i=skelta.userContext.getUserContextFor("appN"),t,r=skelta.utilities.createJsonRequestHelper({securedValue:n.value,applicationName:i,userId:skelta.userContext.getUserContextFor("uId"),securityMode:n.securityMode});return $.ajax({type:"POST",async:!1,url:skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/UpdateAttachedFileStatus"),dataType:"json",contentType:"application/json; charset=utf-8",data:r.getValueForPostRequest(),beforeSend:skelta.forms.utilities.addRequestHeaders,success:function(n){t=n},error:function(){skelta.utilities.showError(document.title,skelta.localize.getString("FormNGFUpdateAttachedFileStatus"));logger.logError(skelta.localize.getString("FormNGFUpdateAttachedFileStatus"))}}),$.parseJSON(t.d).statusChanged}function lt(n,e){var a,v,s,c,h,l,o;if(e.attachmentStorageType===0)e.persistHeader?skelta.forms.utilities.isWorkTasksPro()?(skelta.forms.utilities.showLoader(),a=function(n){if(skelta.forms.utilities.isUndefinedNullOrEmpty(n)===!1){var t=n.split("@$@");skeltaUtils.isUndefinedNullOrEmpty(t[4])||(e.fileList.length<1?e._fileList.push(new r({fileName:t[4],controlObject:e})):e.fileList[0].name(t[4]))}skelta.forms.utilities.hideLoader()},window.top.secureValueDecryptFn(a,n.value)):(v=skelta.utilities.createJsonRequestHelper({securedValue:n.value,userId:skelta.userContext.getUserContextFor("uId")}),skelta.utilities.callServerMethod("POST",skelta.forms.utilities.getServerUrl("NextGenFormService.aspx/GetAttachedFileInfo"),"application/json; charset=utf-8",v,"json",function(n){e.fileList.length<1?e._fileList.push(new r({fileName:$.parseJSON(n.d).fileName,controlObject:e})):e.fileList[0].name($.parseJSON(n.d).fileName)},function(){skelta.utilities.showError(document.title,skelta.localize.getString("FormNGFGetAttachedFileName"));logger.logError(skelta.localize.getString("FormNGFGetAttachedFileName"));f(e);i(e,t())},null)):(s=u(e),c=skelta.utilities.isUndefined(s)||s.value.trim()===""?skelta.localize.getString("FormNGFAttachmentNoFileName"):s.value,e.fileList.length<1?e._fileList.push(new r({fileName:c,controlObject:e})):e.fileList[0].name(c));else for(h=n.value.split("|"),l=n.skFilePath.split("|"),o=0;o<h.length;o++)if(e.fileList.length<o+1?e._fileList.push(new r({fileName:h[o],filePath:l[o],controlObject:e})):(e.fileList[o].name(h[o]),e.fileList[o].path(l[o])),e.allowMultipleAttachments===!1||e.attachmentStorageType===0||e.attachmentStorageType===2)break}function at(n){return skelta.forms.utilities.isWorkTasksPro()&&(n.topLevelForm.validationPromises=[]),window.location.href.containsString("PopupForm.htm",!1)?n.updateAttachmentUploadStatus(!0,!1,!0):n.updateAttachmentUploadStatus(!0,!1,!1)}function t(n,t){return{skFilePath:skelta.utilities.isUndefined(n)?"":n,value:skelta.utilities.isUndefined(t)?"":t}}function e(n){return t(k(n),b(n))}function i(n,t){(t.skFilePath!=n.uiValue.skFilePath||t.value!=n.uiValue.value)&&(n.uiValue=t)}function vt(n,t){if(skelta.utilities.isUndefinedNullOrEmpty(t)){f(n);return}var i=e(n);(t.skFilePath!=i.skFilePath||t.value!=i.value)&&(skelta.utilities.isUndefinedNullOrEmpty(t.value)?f(n):lt(t,n))}function yt(t){if(n(t)){var i={};return i.__text=t.value,i._skFilePath=t.skFilePath,i}return skelta.utilities.isUndefined(t.value)?"":t.value}function pt(n,t){t?(n.skFilePath=t.skFilePath,n.value=t.value):(n.skFilePath="",n.value="")}function wt(n,i){i.uiValue=t(i.skFilePath,n)}function bt(n,t){vt(n,t)}function kt(n,t){n.displayValue=t?n.attachmentStorageType==0?n._fileList.peek().length>0?n._fileList.peek()[0].name.peek():"":t.replaceString("|",", ",!1,!0):""}function dt(t,i){n(t)&&!skelta.utilities.isUndefined(i)&&typeof i=="object"?skelta.utilities.isUndefinedNullOrEmpty(i._skFilePath)?(t.skFilePath="",i.__text="",i=""):(t.skFilePath=i._skFilePath,i=i.__text):t.skFilePath=""}function gt(){var n=skelta.userContext.getUserContextFor("attachmentMaximumLimit");return skelta.utilities.isUndefinedNullOrEmpty(n)&&(n=skelta.forms.constants.attachmentMaximumLimit),(isNaN(n)||n<2)&&(n=skelta.forms.constants.attachmentMaximumLimit),n}function ni(n,t,i,r){if(n.showDownload=ko.computed(function(){return n.value.length>1}),n.skFilePath="",n.renderDetailsInternalValue=r,n._fileList=ko.observableArray([]),skelta.forms.utilities.defineSetterAndGetter(n,"fileList",!0),n.fileExtensions=ko.observable(t),n.isUploadButtonEnabled=ko.computed(function(){return n.fileList.length>0&&n.enable}),n.attachmentStorageType!=0||n.persistHeader||s(n),n.attachmentStorageType===1&&n.allowMultipleAttachments){var u=gt();n.maximumAttachments>u&&(n.maximumAttachments=u)}else n.maximumAttachments=1;n.showBrowseUI=ko.computed(function(){return n.enable&&n.fileList.length<n.maximumAttachments});n.buttonText=skelta.localize.getString(i)}return{validateAttachmentFilePathTemplateProperty:ut,performBrowseFile:a,attachmentOnDataChange:v,attachmentDownload:et,attachmentDelete:ot,validateAttachmentControl:st,isValidAttachmentStatus:at,getValueForInstanceXml:yt,getUIValueObject:t,updateUIValueViaSubscription:bt,updateCoreValue:pt,updateUIValue:wt,updateDisplayValue:kt,skValueExtendRead:dt,initializeControl:ni}}();skelta.attachment=new n}()}();
/*!
 * START - MQTT Keep Alive Interval - To setup the MQTT's keepAliveInterval value in the connection
 */
window.AvevaMqttKeepAliveInterval=30;
/*!
 * END - MQTT Keep Alive Interval
 */
(function(){function n(n){return typeof n=="undefined"||n===null}n(skelta.Mqtt)&&(function(){function r(n,t){t&&(n.prototype=new t,n.prototype.constructor=n)}function n(n){skelta.BaseClass.call(this,skelta,"Mqtt");var t=this;t.client=null;n.runTimeReconnectAttemptCount=0;n.runTimeIsForceDisconnect=!1;n.runTimeIsConnected=!1;t.ConnectionDetail=n;skelta.utilities.isUndefined(n.source)||n.source!=="CreateMqttConnection"&&n.source!=="MQTTTopicPageConfiguration"?(t.onConnect=u.bind(t),t.onFailure=f.bind(t),t.onConnectionLost=e.bind(t),t.onMessageArrived=o.bind(t)):(t.onConnect=n.onConnect.bind(t),t.onFailure=n.onFailure.bind(t),t.onConnectionLost=n.onConnectionLost.bind(t),t.onMessageArrived=n.onMessageArrived.bind(t))}function u(){var i=this,n=i.ConnectionDetail;t.logInformation(skelta.localize.getString("FormsNGF_MqttRuntime_Connectionsuccessful").replace("<@connectionname@>",n.connectionName),!0);n.runTimeIsConnected=!0;n.runTimeReconnectAttemptCount=0;$.each(n.topics,function(t,r){i.subscribe(i.getTopicPath(r.topicName),n.qualityOfService)})}function f(n){var i=this,r=i.ConnectionDetail;t.logError(skelta.localize.getString("FormsNGF_MqttRuntime_ConnectionFailed").replace("<@connectionname@>",r.connectionName)+" - "+n.errorMessage);i.reconnect()}function e(n){var r=this,i=r.ConnectionDetail;i.runTimeIsForceDisconnect===!0?t.logInformation(skelta.localize.getString("FormsNGF_MqttRuntime_ConnectionLost").replace("<@connectionname@>",i.connectionName),!0):(t.logError(skelta.localize.getString("FormsNGF_MqttRuntime_ConnectionLost").replace("<@connectionname@>",i.connectionName)+" - "+n.errorMessage),r.reconnect())}function o(n){var t=this,i=t.ConnectionDetail;$.each(i.topics,function(i,r){if(t.getTopicPath(r.topicName)===n.destinationName){var u=n.payloadString.replace(/\0/g,"");r.value(u)}})}var i=skelta.forms.utilities,t=i.getLogger();r(n,skelta.BaseClass);n.prototype.connect=function(){var n=this,i=n.ConnectionDetail,f,u,r;t.logInformation(skelta.localize.getString("FormsNGF_MqttRuntime_Connect").replace("<@connectionname@>",i.connectionName),!0);f="/"+i.webSocketEndPath;n.client=new Paho.Client(i.host,skelta.utilities.parseNumberValue(i.port),f,i.clientId);n.client.onConnectionLost=n.onConnectionLost;n.client.onMessageArrived=n.onMessageArrived;try{u=skelta.utilities.parseNumberValue(n.ConnectionDetail.mqttVersion);r={onSuccess:n.onConnect,onFailure:n.onFailure,useSSL:n.ConnectionDetail.connectionSecured};u!==1&&(r.mqttVersion=u,r.mqttVersionExplicit=!0);skelta.utilities.isUndefinedNullOrEmpty(i.userId)||skelta.utilities.isUndefinedNullOrEmpty(i.password)||(r.userName=i.userId,r.password=i.password);r.keepAliveInterval=window.AvevaMqttKeepAliveInterval;n.client.connect(r)}catch(e){t.logError(skelta.localize.getString("FormsNGF_MqttRuntime_ConnectionFailed").replace("<@connectionname@>",i.connectionName)+" - "+e.message);throw e.message;}};n.prototype.send=function(n,t,i){var u=this,r=new Paho.Message(t);r.destinationName=n;r.qos=i;r.retained=!1;u.client.send(r)};n.prototype.subscribe=function(n,t){var i=this,r={qos:t};i.client.subscribe(n,r)};n.prototype.unsubscribe=function(n){var t=this;t.client.unsubscribe(n)};n.prototype.disconnect=function(){var n=this,t=n.ConnectionDetail;t.runTimeIsForceDisconnect=!0;n.clearTimer();t.runTimeIsConnected===!0&&n.client.disconnect()};n.prototype.getTopicPath=function(n){var t=this;return n};n.prototype.reconnect=function(){var i=this,n=i.ConnectionDetail,r;n.runTimeIsConnected=!1;i.clearTimer();r=n.reconnectAttempts===-1||n.reconnectAttempts>n.runTimeReconnectAttemptCount;n.runTimeIsForceDisconnect===!1&&r===!0&&(n.runtimeReconnectTimer=window.setTimeout(function(){n.runTimeReconnectAttemptCount++;t.logInformation(skelta.localize.getString("FormsNGF_MqttRuntime_ReConnect").replace("<@connectionname@>",n.connectionName).replace("<@attempt@>",n.runTimeReconnectAttemptCount),!0);i.connect()},n.reconnectPeriod))};n.prototype.clearTimer=function(){var t=this,n=t.ConnectionDetail;skelta.utilities.isUndefined(n.runtimeReconnectTimer)||(window.clearTimeout(n.runtimeReconnectTimer),n.runtimeReconnectTimer=null)};skelta.Mqtt=n}(),function(){function f(n,t){t&&(n.prototype=new t,n.prototype.constructor=n)}function t(t,i){skelta.BaseClass.call(this,skelta,"MqttConnectionTopicDetails");var r=this;r.topLevelForm=i;r.MqttConnections=[];skelta.forms.utilities.isWorkTasksPro()!==!1||n(t)||e($.parseJSON(t),i,r)}function e(n,t,i){skelta.utilities.isArray(n)||(n=[n]);$.each(n,function(n,r){var u=skelta.forms.utilities.getGuId(),f;skelta.utilities.isUndefinedNullOrEmpty(r.clientIdPrefix)||(u=r.clientIdPrefix+u);r.clientId=u;skelta.utilities.isUndefinedNullOrEmpty(r.password)||skelta.utilities.isUndefinedNullOrEmpty(r.passkey)||skelta.utilities.isUndefinedNullOrEmpty(r.vectorKey)||(r.password=i.getDecryptedstring(r.password,r.passkey,r.vectorKey,r.salt));$.each(r.topics,function(n,t){t.value=r.updateRate>0?ko.observable("").extend({rateLimit:{timeout:r.updateRate,method:"notifyAtFixedRate"}}):ko.observable("")});f=new skelta.Mqtt(r);f.connect();i.MqttConnections.push({key:r.connectionName,value:f});o(r,t)});$(window).one("beforeunload.mqtt",function(){i.disconnectConnection()})}function o(n,t){$.each(n.topics,function(i,r){r.value.subscribe(function(i){var u=skelta.MqttConnectionTopicDetails.prototype.getExtractedSpecificValue(i,r);r.actionType==="1"?h(t,u,r):r.actionType==="2"&&s(t,u,r,n)})})}function s(n,t,i,r){var u=p(i.actionScript,i.topicName,r.connectionName);$.isFunction(u)&&u(n,t)}function h(n,t,i){var u={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm},r=n.findById(i.controlName,u);skelta.utilities.isUndefinedNullOrEmpty(r)||(r.value=skelta.MqttConnectionTopicDetails.prototype.getValueForControl(r.controlType,t,i))}function c(n,t){var i="";return skelta.utilities.isUndefined(n)||typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"&&typeof n!="object"?(logger.logError(skelta.localize.getString("FormsNGF_Error_Format_String_Datatype").replace("<@topicname@>",t.topicName)),i=""):i=n.toString(),i}function l(n,t){var i,r;try{i="";skelta.utilities.isUndefined(n)?(logger.logError(skelta.localize.getString("FormsNGF_Error_Format_Datetime_Datatype").replace("<@topicname@>",t.topicName)),i=""):(r=n,typeof n=="string"&&(r=kendo.parseDate(n,["MM/dd/yyyy hh:mm:ss.fff tt","MM/dd/yyyy hh:mm:ss tt"],"en-US")),skelta.utilities.isDate(r)&&r.toDateString()!=="Invalid Date"?i=SFU.getDateTimeInStringFormat(r,skelta.forms.constants.dateFormats.dateTimeFormatForCoreValue):(logger.logError(skelta.localize.getString("FormsNGF_Error_Format_Datetime_Datatype").replace("<@topicname@>",t.topicName)),i=""))}catch(u){logger.logError(skelta.localize.getString("FormsNGF_Error_Format_Datetime_Datatype").replace("<@topicname@>",t.topicName));i=""}return i}function a(n,t){var r="",i;return typeof n=="number"?r=n.toString():skelta.utilities.isNumber(n,!1)?(i=Number(n.toString()),i=isNaN(i)?"":i,r=i.toString()):(logger.logError(skelta.localize.getString("FormsNGF_Error_Format_Number_Datatype").replace("<@topicname@>",t.topicName)),r=""),r}function v(n,t){var u="",f,i;return typeof n=="boolean"?u=n?"True":"False":r(n.toString())?(f=!1,i=n.toString().toLowerCase(),(i==="true"||i==="1"||i==="yes"||i==="y")&&(f=!0),u=f?"True":"False"):(logger.logError(skelta.localize.getString("FormsNGF_Error_Format_Boolean_Datatype").replace("<@topicname@>",t.topicName)),u=""),u}function i(n,t,i){var r="";return $.isArray(n)&&n.length>t?r=n[t]:(logger.logError(skelta.localize.getString("FormsNGF_Error_Element_Not_Found").replace("<@topicname@>",i.topicName).replace("<@elementposition@>",i.elementPosition)),r=i.actionType==="1"?"":[]),r}function y(n){var u,i;if(!skelta.utilities.isNumber(n))return"";if(u=0,n.Contains(".")&&(u=n.split(".")[1],isNaN(u)))throw"Not a number";if(i=parseInt(n,10),isNaN(i))throw"Not a number";var t=Math.floor(i/3600),r=Math.floor((i-t*3600)/60),f=i-t*3600-r*60;return t<10&&(t=skelta.forms.utilities.padZeroes(t,2)),r<10&&(r=skelta.forms.utilities.padZeroes(r,2)),f<10&&(f=skelta.forms.utilities.padZeroes(f,2)),t+":"+r+":"+f+"."+u}function r(n){var t=n.toString().toLowerCase();return t==="true"||t==="1"||t==="yes"||t==="false"||t==="0"||t==="no"||t==="y"||t==="n"?!0:!1}function p(n,t,i){var u,f,r;try{return typeof n=="string"&&!skeltaUtils.isUndefinedNullOrEmpty(n)?(u="try { "+skelta.utilities.removeCdataSection(n)+' } catch (exception) { var res = skelta.localize.getString("FormNGFErrorMqttTopicScript").replace("<@topicname@>", "'+t+'").replace("<@connectionname@>", "'+i+'"); SFU.showError(skelta.localize.getString("FormNGFErrorRunningScript_title"), res, null, exception.message); console.error(res); console.error(exception.message); }',f=new Function("control","currentValue",""+u+""),f):""}catch(e){r=skelta.localize.getString("FormNGFErrorMqttTopicScript").replace("<@topicName@>",t).replace("<@connectionName@>",i);SFU.showError(skelta.localize.getString("FormNGFErrorRunningScript_title"),r,null,e.message);console.error(r);console.error(e.message)}}function w(n,t){var i=n,r;if(!skelta.utilities.isUndefinedNullOrEmpty(t.jsonPath))try{r=JSON.parse(i);i=skelta.utilities.getJsonPathValue(r,t.jsonPath);skelta.utilities.isUndefined(i)&&(i="")}catch(u){return logger.logError(skelta.localize.getString("FormsNGF_Json_Parse_Failed").replace("<@topicname@>",t.topicName)+" - "+u.message),""}return i}function b(n,t){var r,f,u,e;return t.isArray===!1?n:(r="",f=skelta.utilities.removeCdataSection(t.arraySeparator),skelta.utilities.isUndefinedNullOrEmpty(f)||(u=[],skelta.utilities.isUndefinedNullOrEmpty(n)||(u=n.split(f)),skelta.utilities.isUndefinedNullOrEmpty(t.elementPosition)?t.actionType==="1"?r=i(u,0,t):t.actionType==="2"&&(r=u):(e=Number(t.elementPosition)-1,r=i(u,e,t))),r)}function k(n,t){var i=n,r;return $.isArray(i)?(r=[],$.each(i,function(n,i){r.push(u(i,t))}),i=r):i=u(i,t),i}function u(n,t){if(skelta.utilities.isUndefinedNullOrEmpty(n)||(n=n.toString().trim()),t.topicDataType==="IntegerType")return skelta.utilities.isNumber(n,!1)?parseInt(n,10):(logger.logError(skelta.localize.getString("FormsNGF_Error_Format_Integer_Datatype").replace("<@topicname@>",t.topicName)),"");if(t.topicDataType==="FloatType"||t.topicDataType==="DoubleType")return skelta.utilities.isNumber(n,!1)?Number(n):(logger.logError(skelta.localize.getString("FormsNGF_Error_Format_Decimal_Datatype").replace("<@topicname@>",t.topicName)),"");if(t.topicDataType==="BooleanType"){if(r(n)){var i=n.toLowerCase();return i==="true"||i==="1"||i==="yes"||i==="y"?!0:!1}return logger.logError(skelta.localize.getString("FormsNGF_Error_Format_Boolean_Datatype").replace("<@topicname@>",t.topicName)),""}if(t.topicDataType==="DateTimeType")try{return kendo.parseDate(n,["MM/dd/yyyy hh:mm:ss.fff tt","MM/dd/yyyy hh:mm:ss tt"],"en-US")}catch(u){return logger.logError(skelta.localize.getString("FormsNGF_Error_Format_Datetime_Datatype").replace("<@topicname@>",t.topicName)),""}else if(t.topicDataType==="ElapsedTimeType")try{return y(n)}catch(u){return logger.logError(skelta.localize.getString("FormsNGF_Error_Format_ElapsedTime_Datatype").replace("<@topicname@>",t.topicName)),""}else return n.toString()}f(t,skelta.BaseClass);t.prototype.disconnectConnection=function(){var n=this;$.each(n.MqttConnections,function(n,t){t.value.disconnect()})};t.prototype.getExtractedSpecificValue=function(n,t){var i=w(n,t),r=b(i,t);return k(r,t)};t.prototype.getValueForControl=function(n,t,i){var r="";switch(n){case"BooleanInput":r=v(t,i);break;case"Number":r=a(t,i);break;case"DateTimeInput":r=l(t,i);break;case"TextInput":r=c(t,i);break;default:r=t.toString()}return r};t.prototype.getDecryptedstring=function(n,t,i,r){try{var u=CryptoJS.enc.Hex.parse(i),f=CryptoJS.enc.Utf8.parse(t),e=CryptoJS.enc.Utf8.parse(r),o=CryptoJS.PBKDF2(f.toString(CryptoJS.enc.Utf8),e,{keySize:4,iterations:1e3}),s=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.enc.Base64.parse(n)}),h=CryptoJS.AES.decrypt(s,o,{mode:CryptoJS.mode.CBC,iv:u,padding:CryptoJS.pad.Pkcs7});return h.toString(CryptoJS.enc.Utf8)}catch(c){logger.logError(c.message)}};skelta.MqttConnectionTopicDetails=t}())})();skelta.forms.utilities.isUndefined(ko.observable.fn.getComputedV3)&&function(){function f(n,t){ko.expressionRewriting.twoWayBindings?ko.expressionRewriting.twoWayBindings[n]=t:ko.expressionRewriting._twoWayBindings[n]=t}function t(n){var t=n.parentForm;if("_value"in n&&!skelta.utilities.isUndefined(n.visible)&&n.visible===!1)return!1;while(t.isTopLevelForm===!1)if(t=t.isRecordRow?t.dataContainerForm:t.parentForm,!skelta.utilities.isUndefined(t.visible)&&t.visible===!1)return!1;return!0}function u(n,t,i){var f=!1,o=n.topLevelForm,e=4,u,r;for(i==="Value"&&(e=5),u=jQuery.grep(o.formLevelControlRules,function(t){return t.ruleObject.controlType===n.controlType&&t.ruleFor==i}),r=0;r<u.length;r++)if(ruleItem=u[r],!skelta.utilities.isUndefined(n.topLevelForm.onFormLoad)&&n.topLevelForm.onFormLoad===!0||n.associatedForm.parentForm.isAddingNewRecord===!0||ruleItem.ruleObject.ruleName(t,n,ruleItem.ruleObject,ruleItem.ruleFor),!skelta.forms.utilities.isUndefined(n.validationErrorCode)&&n.validationErrorCode.peek()===e){f=!0;break}return f}var n=skelta.forms.utilities,r=n.getLogger(),e;ko.bindingHandlers.stopBinding={init:function(){return{controlsDescendantBindings:!0}}};ko.virtualElements.allowedBindings.stopBinding=!0;skelta.utilities.isUndefined(ko.utils.stringStartsWith)&&(ko.utils.stringStartsWith=function(n,t){return(n=n||"",t.length>n.length)?!1:n.substring(0,t.length)===t});skelta.utilities.isUndefined(ko.utils.tagNameLower)&&(ko.utils.tagNameLower=function(n){return n&&n.tagName&&n.tagName.toLowerCase()});skelta.utilities.isUndefined(ko.expressionRewriting.writeValueToProperty)&&(ko.expressionRewriting.writeValueToProperty=function(n,t,i,r,u){if(n&&ko.isObservable(n))ko.isWriteableObservable(n)&&(!u||n.peek()!==r)&&n(r);else{var f=t.get("_ko_property_writers");f&&f[i]&&f[i](r)}});ko.skUnapplyBindings=function(n,t){if(!(n.length<1)){n.off();n.find("*").each(function(){$(this).off()});var i=t===!0?ko.removeNode:ko.cleanNode;n.each(function(){i(this)})}};ko.bindingHandlers.visible={update:function(n,t,i,r,u){var s=ko.utils.unwrapObservable(t()),h=!(n.style.display=="none"||n.style.visibility=="hidden"),e=$(n).attr("controlid")||$(n).find("[controlid]").attr("controlid"),c={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm,parentContainerTraversalValidation:skelta.forms.controls.findFunctions.isNotEmbeddedForm},f,o;skelta.utilities.isUndefined(e)||(f=skelta.utilities.isUndefined(u.$data.id)||u.$data.id!==e?u.$data.findById(e,c):u.$data,!skelta.utilities.isUndefined(f)&&skelta.utilities.isUndefined(f.domElement)&&(f.domElement=f instanceof skelta.forms.controls.BaseForm?skelta.utilities.isUndefined($(n).attr("controlid"))?$(n).find("[controlid]")[0]:n:$(n).find("[controlid]")[0]));s&&!h?(n.style.removeProperty("display"),n.style.removeProperty("visibility")):!s&&h&&(o=n.getAttribute(dataAttributes.retainSpace),!skelta.utilities.isUndefined(o)&&skelta.forms.ui.isPanelForm(skelta.forms.ui.getParentContainerForm(n))&&o==="1"?(n.style.display="block",n.style.visibility="hidden"):n.style.display="none")}};ko.bindingHandlers[customBindings.tabsBodyVisibility]={update:function(n,t,i,r){for(var f=r.Tabs(),o=f.length,e=0,u=0;u<o;u++)if(!skelta.utilities.isUndefined(f[u]._visible)&&f[u]._visible()===!0){e+=1;break}e>0?$(n).hasClass("skfclc")?(n.style.removeProperty("display"),n.style.removeProperty("visibility")):n.style.display="block":n.style.display="none"}};ko.observable.fn.getComputedV3=function(t,i,r,u){return ko.computed({read:function(){var f=t.executeScriptWithoutEval(this,i);return this(f),n.isUndefined(r)||n.isUndefined(u)||(f=u(f,r.apply(t))),f},write:function(n){this(n)}},this)};ko.observable.fn.getComputedEmailMaxLength=function(){return ko.computed({read:function(){return this()<1?"":this()}},this)};ko.observable.fn.getComputedDateTimeUIValue=function(){return ko.computed({read:function(){return skeltaUtils.GetDateTimeInServerUTCFormat(this(),!0)}},this)};ko.computed.fn.getComputedEmbedPageUrl=function(n){return ko.computed({read:function(){if(n.topLevelForm.isFormLoaded()&&this()!==""){var t=skeltaUtils.getUrlPath(this()),i=!0;return skeltaUtils.isUndefinedNullOrEmpty(n.oldUrlValue)||skeltaUtils.getUriObjectFromString(n.oldUrlValue).isEqualExceptforHashPart(skeltaUtils.getUriObjectFromString(t))&&(i=!1),i&&n.loaderIconState("1"),n.oldUrlValue=t,t}return n.loaderIconState("0"),""}},this)};ko.computed.fn.getComputedReportUrl=function(n,t,i){return ko.computed({read:function(){if(n.topLevelForm.isFormLoaded()&&this()!==""){if(t=="2")return skeltaUtils.getDownloadReportUrl(n,i);if(t=="0"||t=="1")return skeltaUtils.getReportUrlPath(n,this())}else return""}},this)};ko.observable.fn.getComputedPopupFormUrl=function(n){return ko.computed({read:function(){var e,h,t,i,r,u;if(n.topLevelForm.isFormLoaded()){var c=skelta.utilities.getUriObjectFromWindow(),t=c.getPageNameWithoutExtension(),l=skelta.DeviceOS,a=skelta.userContext.getUserContextFor("appN"),v=skelta.userContext.getUserContextFor("uId"),y=skelta.userContext.getUserContextFor("fName"),p=skelta.userContext.getUserContextFor("vStamp"),w=skelta.userContext.getUserContextFor("itemId"),b=n.id,f=n._formWithVersion(),o="",s="";return skelta.utilities.isUndefined(f)||f===""||(e=f.split("~"),o=e[0],s=e[1]),h=!skelta.forms.utilities.isUndefined(n.openNewWindow)&&n.openNewWindow===!0?"1":"0",t="PopupForm.htm",skelta.forms.utilities.isWorkTasksPro()&&(t=skelta.forms.utilities.isUndefinedNullOrEmpty(window.top.ServerVersion)||window.top.ServerVersion===window.top.ServerVersionEnum.Version2017||window.top.ServerVersion===window.top.ServerVersionEnum.Version2019or2020?"PopupForm.htm":window.top.ServerVersion===window.top.ServerVersionEnum.Version2020U1?"PopupForm_2020U1.htm":"PopupForm_2020U2.htm"),i=skelta.forms.constants.popupFormContants.HtmRelativePath+t+"?dType="+l+"&appN="+a+"&uId="+encodeURIComponent(v)+"&fName="+o+"&vStamp="+s+"&parentfName="+y+"&parentVstamp="+p+"&parentItemId="+w+"&pageName="+t+"&isNewWindow="+h+"&controlid="+b,r=skelta.userContext.getUserContextFor("skSasToken"),skelta.utilities.isUndefined(r)||r===""||(i+="&skSasToken="+encodeURIComponent(r)),u=skelta.userContext.getUserContextFor("deviceId"),skelta.utilities.isUndefined(u)||u===""||(i+="&deviceId="+encodeURIComponent(u)),i}return""}},this)};ko.observableArray.fn.getComputedButtonTextForAttr=function(n){return ko.computed({read:function(){if(n.topLevelForm.isFormLoaded()===!0){var t=n._buttonText();return t.replace(/\&at;/g,"@")}return""}},this)};ko.observableArray.fn.getComputedToolbarButtonArray=function(n){return ko.computed({read:function(){for(var i=[],t=n.length-1;t>=0&&i.length<4;t--)skeltaUtils.isUndefined(n[t].visible)||n[t].visible!==!0||i.push(n[t]);return i.reverse(),i}},this)};ko.observableArray.fn.getComputedExtraButtonArray=function(n){return ko.computed({read:function(){var r,u,t,i;if(n.length<5)return[];for(r=[],u=0,t=n.length-1;t>=0&&u<4;t--)skeltaUtils.isUndefined(n[t].visible)||n[t].visible!==!0||u++;for(i=t;i>=0;i--)skeltaUtils.isUndefined(n[i].visible)||n[i].visible!==!0||r.push(n[i]);return r.reverse(),r}},this)};ko.observableArray.fn.getComputedVisibleButtonArray=function(n){return ko.computed({read:function(){for(var i=[],t=n.length-1;t>=0;t--)skeltaUtils.isUndefined(n[t].visible)||n[t].visible!==!0||i.push(n[t]);return i}},this)};ko.observableArray.fn.getComputedObservableStringArray=function(n,t){return ko.computed({read:function(){var i=this();return n.topLevelForm.isFormLoaded()&&(i=n.executeScriptWithoutEval(this,t),options=[],this(i)),i},write:function(n){this(n)}},this)};ko.observableArray.fn.getComputedObservableArray=function(n,t){return ko.computed({read:function(){var i=this(),e,f,u;if(n.topLevelForm.isFormLoaded()){if(i=n.executeScriptWithoutEval(this,t),options=[],i&&i.length>0&&!skelta.utilities.isUndefined(t))try{for(e=typeof i=="string"?$.parseJSON(i):i,f=0;f<e.length;f++){if(u={},u.optiontext=e[f][n.optionText],u.optiontext==undefined){r.logInformation(n.id+"- Unable to bind the Text from script ");break}if(u.optionvalue=e[f][n.optionValue],u.optionvalue==undefined){r.logInformation(n.id+"- Unable to bind the Value from script ");break}else u.optionvalue=u.optionvalue.toString();options.push(u)}i=options}catch(o){r.logError(n.id+"- Unable to bind the script :"+o.message)}this(i)}return i},write:function(n){this(n)}},this)};ko.computed.fn.getComputedV3=ko.observable.fn.getComputedV3;ko.observable.fn.getComputedV3REAB=function(t){return ko.computed({read:function(){var i=this(),r=t.onControlReadEditAddBehaviour;return t.topLevelForm.isFormLoaded()&&(i=t.executeScriptWithoutEval(this,r),this(i)),n.isUndefined(t.parentForm)||n.isUndefined(t.parentForm.parentForm)||n.isUndefined(t.parentForm.parentForm._readEditAddBehaviour)||(i=n.readEditAddBehaviourAndOperation(i,t.parentForm.parentForm._readEditAddBehaviour(),t.parentForm.isNewRecord)),i},write:function(n){this(n)}},this)};ko.computed.fn.getComputedV3REAB=ko.observable.fn.getComputedV3REAB;ko.observable.fn.getNumberValue=ko.computed.fn.getNumberValue=function(n){try{n=skelta.utilities.isNumber(n)?parseInt(n):kendo.culture().numberFormat.decimals}catch(t){}return skelta.utilities.isNumber(n)||(n=2),ko.computed({read:function(){var n=this(),t="";return skelta.utilities.isNumber(n)&&(t=parseFloat(n)),t},write:function(t){var i="";skelta.utilities.isNumber(t)&&(i=parseFloat(t).toFixed(n));this(i)}},this)};ko.observableArray.fn.subscribeEvent=function(n){var t=this;return t.push(n),t};ko.observableArray.fn.unSubscribeEvent=function(n){var t=this();for(i=0;i<t.length;i++)if(t[i]==n){t.splice(i,1);break}};ko.bindingHandlers.spanClass={init:function(t,i){var r=n.getClassForTag(i());$(t).attr("class",r)},update:function(t,i){var r=n.getClassForTag(i());$(t).attr("class",r)}};ko.bindingHandlers.skOnLoad={init:function(n,t){$(n).on("load",t())}};ko.bindingHandlers[customBindings.embedPageLoader]={update:function(n,t){var u=ko.utils.unwrapObservable(t()),i=$(n),r;i.find(">div").length===0&&(r=skelta.utilities.getLoaderObject(),i[0].appendChild(r))}};ko.bindingHandlers.executeOnFocus={init:function(n,t,i,r){var u=i();$(n).focus(function(){return u.executeOnFocus.call(r),!1})}};ko.bindingHandlers.readOnly={update:function(n,t){var i=ko.utils.unwrapObservable(t());i?n.setAttribute("readOnly",!0):n.removeAttribute("readOnly")}};ko.bindingHandlers.mandatory={update:function(n,t){var i=ko.utils.unwrapObservable(t());i?n.setAttribute("required",!0):n.removeAttribute("required")}};ko.bindingHandlers[customBindings.setFocusOnNewRecord]={update:function(n,t){var i=ko.utils.unwrapObservable(t());i&&($($(n).find("[controlid]")[0]).focus(),t(!1))}};ko.bindingHandlers[customBindings.initGridStyles]={init:function(n,t){var i=ko.utils.unwrapObservable(t());skelta.forms.ui.getStylesForGridView(n)}};ko.bindingHandlers[customBindings.isLoaded]={init:function(n,t,i,r){i().skcontainerdata._isLoaded()||(skelta.forms.delay.loader.addToDelayWatcher(n,i().skcontainerdata),r.topLevelForm.isFormLoaded()&&skelta.forms.delay.loader.scrollEventHandler())}};ko.bindingHandlers[customBindings.panelRearrangeElements]={update:function(n,t,i,r,u){function e(){var i,n;if(o==="horizontal"&&(i=u.$data.dataContainerForm,!skelta.utilities.isUndefined(i)&&i.records().length>0)){var t=i.records()[0].controls,h=t.length,r=[];for(n=0;n<h;n++){var e=$(f).find("[controlid='"+t[n].id+"']"),s=e.attr(dataAttributes.retainSpace),c=!skelta.utilities.isUndefined(t[n].visible)&&t[n].visible===!1,l=!skelta.utilities.isUndefined(s)&&s==="0",a=!skelta.utilities.isUndefined(t[n].controlType)&&t[n].controlType==="HiddenFieldControl";(c&&l||a)&&r.push(e[0])}skelta.forms.ui.reArrangePanelForm(f,r)}}var f=skelta.forms.ui.getParentContainerForm(n),o=skelta.forms.ui.getTabbingForPanelForm(f);u.$data.dataContainerForm._isLoaded()===!0&&(u.$data._isBindedToUI.peek()===!0?setTimeout(function(){e()},0):e())}};ko.bindingHandlers[customBindings.keyDownEvent]={init:function(n,t,i,r){var u=t(),f=n.getAttribute("controlid");ko.utils.registerEventHandler(n,"keydown",function(){u(arguments[0],f,r)})}};ko.bindingHandlers[customBindings.attrItemHighlighted]={init:function(n,t){$(n).attr("skhighlighted",t())},update:function(n,t){var f=$(n),i=f.parent(),e;if(f.attr("skhighlighted",t()),e=parseFloat(i.prop("clientHeight")),t()===!0&&e<parseFloat(i.prop("scrollHeight"))){var r=i.scrollTop(),u=parseFloat(f.prop("offsetTop")),o=parseFloat(f.prop("offsetHeight"));r>u?i.scrollTop(u):r<u&&r+e<u+o&&i.scrollTop(r+(u+o)-(r+e))}}};ko.bindingHandlers[customBindings.autoAppendForGrid]={init:function(n,t,i,r){var u=n,o,f;n.tagName==="DIV"&&(f=$(n).find("input"),u=f[f.length-1]);skelta.utilities.isUndefined(u)||(o=u.getAttribute("controlid"),ko.utils.registerEventHandler(u,"keydown",function(){e(arguments[0],o,r)}))}};e=function(t,i,r){var o={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm},f=r.findById(i,o),u,e;n.isMobileDisplayMode(f)||(t.which===9||t.keyCode===9)&&t.shiftKey===!1&&(u=f.getDataContainerGrid(),skelta.utilities.isUndefined(u)||skelta.utilities.isUndefined(u.readEditAddBehaviour)||u.readEditAddBehaviour===1||skelta.utilities.isUndefined(u.autoAppend)||u.autoAppend!==1||(e=f.getAssociatedRecordOfGrid(),!skelta.utilities.isUndefined(e)&&e.isRecordRow===!0&&f.checkIfLastFocussableControl()&&(skelta.utilities.isUndefined(f.autoAppendRecordInGrid(u,e))||(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0))));return};ko.bindingHandlers[customBindings.multipleAttribute]={update:function(n,t){var i=ko.utils.unwrapObservable(t());i?n.multiple=!0:!i&&n.multiple&&n.removeAttribute("multiple")}};ko.bindingHandlers.kendoHasFocus={init:function(n,t){var i=$(n).parent().find("input"),r=t();i.focus(function(){ko.utils.domData.set(n,"focusChange",!0);r(!0);ko.utils.domData.set(n,"focusChange",!1)});i.blur(function(){ko.utils.domData.set(n,"focusChange",!0);var t=i.not(this).is(":focus");r(t);ko.utils.domData.set(n,"focusChange",!1)})},update:function(n,t){var i=$(n).parent().find("input"),r=ko.utils.unwrapObservable(t());ko.utils.domData.get(n,"focusChange")||i.filter(":visible")[r?"focus":"blur"]()}};ko.bindingHandlers.kendoNumberFocus={init:function(n,t,i,r,u){var f=$(n).parent().find("input"),c=t(),s,h=f.filter("input[controlid]").attr("controlid"),l={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm,parentContainerTraversalValidation:skelta.forms.controls.findFunctions.isNotEmbeddedForm},e,o;if(skelta.utilities.isUndefined(h)||(s=skelta.utilities.isUndefined(u.$data.id)||u.$data.id!==h?u.$data.findById(h,l):u.$data),!f.filter("input[data-skrl='skNumPkr']").attr("title")){for(e=f.index(f.filter("input[data-skrl='skNumPkr']")),o=0;o<f.length;o++)if(o!=e){e=o;break}$(f[e]).attr("title",f.filter("input[data-skrl='skNumPkr']").attr("title"));skelta.utilities.isUndefined(s)||(s.domElement=$(f[e])[0])}if(f.filter("input[controlid]")){for(e=f.index(f.filter("input[controlid]")),o=0;o<f.length;o++)if(o!=e){e=o;break}$(f[e]).attr("controlid",f.filter("input[data-skrl='skNumPkr']").attr("controlid"));$(f[e]).attr("id",f.filter("input[data-skrl='skNumPkr']").attr("controlid"))}$(n).blur(function(){ko.utils.domData.set(n,"focusChange",!0);var t=f.not(this).is(":focus");c(t);ko.utils.domData.set(n,"focusChange",!1)});$(n).focus(function(){ko.utils.domData.set(n,"focusChange",!0);c(!0);ko.utils.domData.set(n,"focusChange",!1);var t=$(this);setTimeout(function(){t.select()})})},update:function(n,t){var i=$(n).parent().find("input"),r=ko.utils.unwrapObservable(t());ko.utils.domData.get(n,"focusChange")||i.filter(":visible")[r?"focus":"blur"]()}};ko.bindingHandlers[customBindings.WidgetInstanceId]={init:function(n,t,i,r,u){var e=t(),o=$(n).attr("controlid"),f;$(n).attr(customBindings.WidgetInstanceId,e);setTimeout(function(){var t={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm,parentContainerTraversalValidation:skelta.forms.controls.findFunctions.isNotEmbeddedForm};f=u.$data.findById(o,t);skelta.utilities.isUndefined(f.widgetDestroyEvent)&&(f.widgetDestroyEvent=ko.observable(""));ko.utils.domNodeDisposal.addDisposeCallback(n,function(){f.widgetDestroyEvent(e)});window.lastSkeltaControl=f;f.currentUniqueId=e;f.initialize(f)},0)}};ko.bindingHandlers[customBindings.AngularInstanceId]={init:function(n,t,i,r,u){var o=t(),e=customBindings.AngularInstanceId+o,s=$(n).attr("controlid"),f;$(n).addClass(e);setTimeout(function(){var t={childContainerValidator:skelta.forms.controls.findFunctions.isNotEmbeddedForm,parentContainerTraversalValidation:skelta.forms.controls.findFunctions.isNotEmbeddedForm};if(f=u.$data.findById(s,t),skelta.utilities.isUndefined(f.angularDestroyEvent)&&(f.angularDestroyEvent=ko.observable("")),ko.utils.domNodeDisposal.addDisposeCallback(n,function(){f.angularDestroyEvent(e)}),window.controlInstance=f,f.currentUniqueClassName=e,f.initialize(),f.onInit)f.onInit(f)},0)}};ko.extenders.skValueExtend=function(n,i){var r=i.control,e=i.updateUIValue,f=i.dm,o;return r.validationError=ko.observable(!1),r.validationErrorMessage=ko.observable(""),r.validationErrorCode=ko.observable(errorConstants.none),r.isValidValue=!0,r.isThroughUI=!1,r.isThroughCore=!1,r.isThroughWrite=!1,o=ko.computed({read:function(){var c="",b=!1,v=n.peek(),o=ko.observable(""),g,s,i,h,l,p,w,a;if(r.isThroughUI===!1&&r.isThroughCore===!1&&(r.isThroughUI=!1,r.isThroughCore=!0),skelta.utilities.isUndefined(r.topLevelForm.isFormLoaded)||r.topLevelForm.isFormLoaded()!==!0||skelta.utilities.isUndefined(r.topLevelForm.onFormLoad)||r.topLevelForm.onFormLoad!==!0){if(!skelta.utilities.isUndefined(r.topLevelForm.onFormLoad)&&r.topLevelForm.onFormLoad===!1&&r.isThroughWrite===!1){if(b=!1,o(n.peek()),r.associatedForm.parentForm.isAddingNewRecord===!0)if(typeof r.onControlValue=="function")c=r.onControlValue(r,n.peek()),o(c);else if(f){if(s=r.xmlNodeBoundTo,i=f[s],s.containsString("/")){var y=r.xmlNodeBoundTo.split("/"),k=y[0],d=y[1];i=f[k][d]}else s&&r.xmlNodeBoundTo.startsWithString("@")?(s=s.replace("@","_"),r.controlType==="LookupInput"&&r.persistDisplayValue===!0&&skelta.forms.utilities.isDisplayValuePresent(f,s.replace("_",""))&&(h={},r.displayField=r.displayField?r.displayField:skelta.forms.constants.lookupDefaults.persistValueDisplayColumn,r.valueField=r.valueField?r.valueField:skelta.forms.constants.lookupDefaults.persistValueValueColumn,h[r.displayField]=f[skelta.forms.constants.lookupDefaults.persistDisplayValueAttribute+s.replace("_","")],h[r.valueField]=f[s],r.selectedItem=h,r.isItemSelected=!0),i=f[s]):r.controlType==="LookupInput"&&r.persistDisplayValue===!0&&skelta.forms.utilities.isDisplayValuePresent(i,r.xmlNodeBoundTo)?(h={},r.displayField=r.displayField?r.displayField:skelta.forms.constants.lookupDefaults.persistValueDisplayColumn,r.valueField=r.valueField?r.valueField:skelta.forms.constants.lookupDefaults.persistValueValueColumn,h[r.displayField]=i[skelta.forms.constants.lookupDefaults.persistDisplayValueAttribute+r.xmlNodeBoundTo],h[r.valueField]=i[skelta.forms.constants.lookupDefaults.nodeAttributeName],r.selectedItem=h,r.isItemSelected=!0,i=i[skelta.forms.constants.lookupDefaults.nodeAttributeName]):r.controlType==="ExpressionEditor"&&(skelta.utilities.isString(i)?r.isExpression=!1:(r.isExpression=i[skelta.forms.constants.expressionEditorDefaults.isExpressionAttribute]==="true",i=i[skelta.forms.constants.lookupDefaults.nodeAttributeName]));r.controlType==="Attachment"?skelta.attachment.skValueExtendRead(r,i):r.controlType==="DropDownTree"&&(l=!1,skelta.utilities.isUndefined(r._dataSource())||(p=r._dataSource(),w=skelta.forms.validations.ParentNodeValidationsCheck(i,p),w.length>0&&(l=!0)),l||(i=""));i&&typeof i=="object"&&i.__text&&(i=i.__text);i&&typeof i!="object"?o(i):o(v)}else typeof r.onControlDefaultValue=="function"?(a="",a=r.onControlDefaultValue(r,o.peek()),o(a)):r.setValueHandler&&!r.defaultValue?o(r.setValueHandler(r,v)):r.defaultValue&&o(r.defaultValue);else typeof r.onControlValue=="function"&&(c=r.onControlValue(r,n.peek()),o(c)),skelta.forms.utilities.isUndefined(r.validationErrorCode)||r.validationErrorCode.peek()!==errorConstants.valueValidationRules||(r.validationError(!1),r.validationErrorMessage(""),r.validationErrorCode(errorConstants.none)),t(r)&&(b=u(r,c,"Value",!0)),r.isValidValue===!1?o(""):!skelta.forms.utilities.isUndefined(r.validationErrorCode)&&r.validationErrorCode.peek()===errorConstants.mandatory&&o()&&(r.validationError(!1),r.validationErrorMessage(""),r.validationErrorCode(errorConstants.none)),!b&&typeof r.onControlValidate=="function"&&t(r)&&(skelta.forms.utilities.isUndefined(r.validationErrorCode)||r.validationErrorCode.peek()!==errorConstants.validationScript||(r.validationError(!1),r.validationErrorMessage(""),r.validationErrorCode(errorConstants.none)),validateObject=r.onControlValidate(r,c),validateObject&&validateObject.isValid===!1?(r.validationError(!0),r.validationErrorMessage(validateObject.message),r.validationErrorCode(errorConstants.validationScript)):(skelta.utilities.isUndefined(validateObject)||validateObject.isValid===!0)&&!skelta.forms.utilities.isUndefined(r.validationErrorCode)&&r.validationErrorCode.peek()===errorConstants.validationScript&&(r.validationError(!1),r.validationErrorMessage(""),r.validationErrorCode(errorConstants.none)));n(o())}}else{if(f){if(s=r.xmlNodeBoundTo,i=f[s],s.containsString("/")){var y=r.xmlNodeBoundTo.split("/"),k=y[0],d=y[1];i=f[k][d]}else s&&r.xmlNodeBoundTo.startsWithString("@")?(s=s.replace("@","_"),r.controlType==="LookupInput"&&r.persistDisplayValue===!0&&skelta.forms.utilities.isDisplayValuePresent(f,s.replace("_",""))&&(h={},r.displayField=r.displayField?r.displayField:skelta.forms.constants.lookupDefaults.persistValueDisplayColumn,r.valueField=r.valueField?r.valueField:skelta.forms.constants.lookupDefaults.persistValueValueColumn,h[r.displayField]=f[skelta.forms.constants.lookupDefaults.persistDisplayValueAttribute+s.replace("_","")],h[r.valueField]=f[s],r.selectedItem=h,r.isItemSelected=!0),i=f[s]):r.controlType==="LookupInput"&&r.persistDisplayValue===!0&&skelta.forms.utilities.isDisplayValuePresent(i,r.xmlNodeBoundTo)?(h={},r.displayField=r.displayField?r.displayField:skelta.forms.constants.lookupDefaults.persistValueDisplayColumn,r.valueField=r.valueField?r.valueField:skelta.forms.constants.lookupDefaults.persistValueValueColumn,h[r.displayField]=i[skelta.forms.constants.lookupDefaults.persistDisplayValueAttribute+r.xmlNodeBoundTo],h[r.valueField]=i[skelta.forms.constants.lookupDefaults.nodeAttributeName],r.selectedItem=h,r.isItemSelected=!0,i=i[skelta.forms.constants.lookupDefaults.nodeAttributeName]):r.controlType==="ExpressionEditor"&&(skelta.utilities.isString(i)?r.isExpression=!1:(r.isExpression=i[skelta.forms.constants.expressionEditorDefaults.isExpressionAttribute]==="true",i=i[skelta.forms.constants.lookupDefaults.nodeAttributeName]));r.controlType==="Attachment"?skelta.attachment.skValueExtendRead(r,i):r.controlType==="DropDownTree"&&(l=!1,skelta.utilities.isUndefined(r._dataSource())||(p=r._dataSource(),w=skelta.forms.validations.ParentNodeValidationsCheck(i,p),w.length>0&&(l=!0)),l||(i=""));r.controlType==="Grid"&&(g=skelta.utilities.getXmlFromJSONObject(i),i=g);i&&typeof i=="object"&&i.__text&&(i=i.__text);i&&typeof i!="object"&&o(i)}else o(v);typeof r.onControlValue=="function"?(c=r.onControlValue(r,o.peek()),o(c)):f||typeof r.onControlDefaultValue!="function"?!r.setValueHandler||f||r.defaultValue?!f&&r.defaultValue&&o(r.defaultValue):o(r.setValueHandler(r,v)):(a="",a=r.onControlDefaultValue(r,o.peek()),o(a));n(o())}return typeof e!="function"||(r.isThroughUI!==!1||r.isThroughCore!==!0)&&(skelta.utilities.isUndefined(r.topLevelForm.isFormLoaded)||r.topLevelForm.isFormLoaded()!==!0||skelta.utilities.isUndefined(r.topLevelForm.onFormLoad)||r.topLevelForm.onFormLoad!==!0)||e(r,n.peek(),f),r.isValidValue=!0,r.isThroughCore=!1,r.isThroughUI=!1,r.isThroughWrite=!1,skelta.utilities.isUndefined(r.setDisplayValueHandler)||typeof r.setDisplayValueHandler!="function"||r.setDisplayValueHandler(r,n.peek()),n()},write:function(i){typeof i=="string"&&i.trim()===""&&(i=i.trim());var h=!1,s=i;skelta.forms.utilities.isUndefined(r.validationErrorCode)||r.validationErrorCode.peek()!==errorConstants.valueValidationRules||(r.validationError(!1),r.validationErrorMessage(""),r.validationErrorCode(errorConstants.none));r.isThroughUI===!1&&r.isThroughCore===!1&&(r.isThroughCore=!0,r.isThroughUI=!1);r.isThroughWrite===!1&&(r.isThroughWrite=!0);typeof r.onControlValue=="function"&&(s=r.onControlValue(r,i));t(r)&&(h=u(r,s,"Value",!0));r.isValidValue===!1?s="":!skelta.forms.utilities.isUndefined(r.validationErrorCode)&&r.validationErrorCode.peek()===errorConstants.mandatory&&s&&(r.validationError(!1),r.validationErrorMessage(""),r.validationErrorCode(errorConstants.none));!h&&typeof r.onControlValidate=="function"&&t(r)&&(skelta.forms.utilities.isUndefined(r.validationErrorCode)||r.validationErrorCode.peek()!==errorConstants.validationScript||(r.validationError(!1),r.validationErrorMessage(""),r.validationErrorCode(errorConstants.none)),validateObject=r.onControlValidate(r,s),validateObject&&validateObject.isValid===!1?(r.validationError(!0),r.validationErrorMessage(validateObject.message),r.validationErrorCode(errorConstants.validationScript)):(skelta.utilities.isUndefined(validateObject)||validateObject.isValid===!0)&&!skelta.forms.utilities.isUndefined(r.validationErrorCode)&&r.validationErrorCode.peek()===errorConstants.validationScript&&(r.validationError(!1),r.validationErrorMessage(""),r.validationErrorCode(errorConstants.none)));typeof r.onControlValue=="function"&&i!==s&&(r.uiValue||o.notifySubscribers(s),typeof e=="function"&&e(r,s,f));n(s);n.peek()===s&&(r.isValidValue=!0,r.isThroughCore=!1,r.isThroughUI=!1,r.isThroughWrite=!1)}})};ko.extenders.skVisibleExtend=function(n,t){var i=!1;return ko.computed({read:function(){var r,u;return t.topLevelForm.isFormLoaded()&&!i&&(r=ko.observable(n()),typeof t.onControlVisible=="function"&&(u=t.onControlVisible(t,r.peek()),typeof u!="boolean"&&(u=n.peek()),r(u)),n(r())),i=!1,skelta.forms.utilities.triggerResizeEvent(t),n()},write:function(r){var u=r,f;i===!1&&(i=!0);typeof t.onControlVisible=="function"&&(f=t.onControlVisible(t,u),typeof f!="boolean"&&(f=n.peek()),u=f);n(u);n.peek()===u&&(i=!1);skelta.forms.utilities.triggerResizeEvent(t)}})};ko.extenders.skRowVisibleExtend=function(n,t){var i=!1;return ko.computed({read:function(){var r,u;return t.topLevelForm.isFormLoaded()&&!i&&(r=ko.observable(n()),typeof t.onControlRowVisible=="function"&&(u=t.onControlRowVisible(t,r.peek()),typeof u!="boolean"&&(u=n.peek()),r(u)),n(r())),i=!1,n()},write:function(r){var u=r,f;i===!1&&(i=!0);typeof t.onControlRowVisible=="function"&&(f=t.onControlRowVisible(t,u),typeof f!="boolean"&&(f=n.peek()),u=f);n(u);n.peek()===u&&(i=!1)}})};ko.extenders.skColumnHeaderExtend=function(n,t){return ko.computed({read:function(){var u,i,r,n,f;if(t.topLevelForm.isFormLoaded()){if(u=[],i=t.records(),!skelta.utilities.isUndefined(i)&&i.length>0)for(r=i[0].controls,n=0;n<r.length;n++)f=skelta.utilities.isUndefined(r[n]._tagName())?"":r[n]._tagName(),u.push(f);return u}}})};ko.extenders.skIsMandatoryExtend=function(n,t){var i=!1;return ko.computed({read:function(){var r,u;return t.topLevelForm.isFormLoaded()&&!i&&(r=ko.observable(n()),typeof t.onControlIsMandatory=="function"&&(u=t.onControlIsMandatory(t,r.peek()),typeof u!="boolean"&&(u=n.peek()),r(u)),n(r()),r.peek()===!1&&t.validationErrorCode&&t.validationErrorCode.peek()===errorConstants.mandatory&&(t.validationError(!1),t.validationErrorMessage(""),t.validationErrorCode(errorConstants.none))),i=!1,n()},write:function(r){var u=r,f;i=!0;typeof t.onControlIsMandatory=="function"&&(f=t.onControlIsMandatory(t,u),typeof f!="boolean"&&(f=n.peek()),u=f);u!==!1||skelta.forms.utilities.isUndefined(t.validationErrorCode)||t.validationErrorCode.peek()!==errorConstants.mandatory||(t.validationError(!1),t.validationErrorMessage(""),t.validationErrorCode(errorConstants.none));n(u)}})};ko.extenders.skReadOnlyExtend=function(n,t){var i=!1;return ko.computed({read:function(){var r=ko.observable(n()),u;return t.topLevelForm.isFormLoaded()&&!i&&(typeof t.onControlReadOnly=="function"&&(u=t.onControlReadOnly(t,r.peek()),typeof u!="boolean"&&(u=n.peek()),r(u)),n(r()),r(SFU.boolOrOperation(r(),t.readEditAddBehaviourReadOnlyDependencyFunction()))),i=!1,r()},write:function(r){var f=r,u;i=!0;typeof t.onControlReadOnly=="function"&&(u=t.onControlReadOnly(t,f),typeof u!="boolean"&&(u=n.peek()),f=u);n(f)}})};ko.extenders.skEnableExtend=function(n,t){var i=!1;return ko.computed({read:function(){var r=ko.observable(n()),u;return t.topLevelForm.isFormLoaded()&&!i&&(typeof t.onControlEnable=="function"&&(u=t.onControlEnable(t,r.peek()),typeof u!="boolean"&&(u=n.peek()),r(u)),t.readOnly||(n(r()),r(SFU.boolAndOperation(r(),t.readEditAddBehaviourEnableDependencyFunction())))),i=!1,r()},write:function(r){var f=r,u;i=!0;typeof t.onControlEnable=="function"&&(u=t.onControlEnable(t,f),typeof u!="boolean"&&(u=n.peek()),f=u);n(f)}})};ko.extenders.skTagNameExtend=function(n,t){var i=!1;return ko.computed({read:function(){var r,u;return t.topLevelForm.isFormLoaded()&&!i&&(r=ko.observable(n()),typeof t.onControlTagName=="function"&&(u=t.onControlTagName(t,r.peek()),u!==undefined&&r(u)),n(r())),i=!1,n()},write:function(r){var u=r,f;i=!0;typeof t.onControlTagName=="function"&&(f=t.onControlTagName(t,u),f!==undefined&&(u=f));n(u)}})};ko.extenders.skDataSourceExtend=function(n,t){var i=!1;return ko.computed({read:function(){var r,u;return t.topLevelForm.isFormLoaded()&&!i&&(r=ko.observable(n()),typeof t.onControlDataSource=="function"&&(u=t.onControlDataSource(t,r.peek()),u!==undefined&&r(u)),n(r())),i=!1,n()},write:function(r){var u=r,f;i=!0;typeof t.onControlDataSource=="function"&&(f=t.onControlDataSource(t,u),f!==undefined&&(u=f));n(u)}})};ko.extenders.skDescriptionExtend=function(n,t){var i=!1;return ko.computed({read:function(){var r,u;return t.topLevelForm.isFormLoaded()&&!i&&(r=ko.observable(n()),typeof t.onControlDescription=="function"&&(u=t.onControlDescription(t,r.peek()),u!==undefined&&r(u)),n(r())),i=!1,n()},write:function(r){var u=r,f;i=!0;typeof t.onControlDescription=="function"&&(f=t.onControlDescription(t,u),f!==undefined&&(u=f));n(u)}})};ko.extenders.skFilePathTemplateExtend=function(n,t){var i=!1;return ko.computed({read:function(){var r,u;return t.topLevelForm.isFormLoaded()&&!i&&(r=ko.observable(n()),t.attachmentStorageType===2?r(skelta.forms.constants.cloudFilePathTemplate):typeof t.onControlFilePathTemplate=="function"&&(u=t.onControlFilePathTemplate(t,r.peek()),u!==undefined&&r(u)),n(r())),i=!1,n()},write:function(r){var u=r,f;i=!0;t.attachmentStorageType===2?u=skelta.forms.constants.cloudFilePathTemplate:typeof t.onControlFilePathTemplate=="function"&&(f=t.onControlFilePathTemplate(t,u),f!==undefined&&(u=f));n(u)}})};ko.extenders.skurlExtend=function(n,t){var i=!1;return ko.computed({read:function(){var r,u;return t.topLevelForm.isFormLoaded()&&!i&&(r=ko.observable(n()),typeof t.onControlUrl=="function"&&(u=t.onControlUrl(t,r.peek()),u!==undefined&&r(u)),n(r())),i=!1,n()},write:function(r){var u=r,f;i=!0;typeof t.onControlUrl=="function"&&(f=t.onControlUrl(t,u),f!==undefined&&(u=f));n(u)}})};ko.extenders.skUIValueExtend=function(n,i){var r=i.control,f=i.updateCoreValue;return n.subscribe(function(n){r.isThroughUI===!1&&r.isThroughCore===!1&&(r.isThroughUI=!0,r.isThroughCore=!1);skelta.forms.utilities.isUndefined(r.validationErrorCode)||r.validationErrorCode.peek()!==errorConstants.uiValidationRules||(r.validationError(!1),r.validationErrorMessage(""),r.validationErrorCode(errorConstants.none));(t(r)||r.controlType=="HiddenFieldControl")&&u(r,n,"UIValue",!1);typeof f=="function"&&r.isThroughUI===!0&&r.isThroughCore===!1&&f(r,n)}),n};ko.extenders.skLostFocusExtend=function(n,t){return ko.computed({read:n,write:function(i){var f,e,r,u;if(!i&&(skelta.forms.utilities.isUndefined(t.validationErrorCode)||t.validationErrorCode.peek()!==errorConstants.mandatory||(t.validationError(!1),t.validationErrorMessage(""),t.validationErrorCode(errorConstants.none)),f=t.topLevelForm,f.formLevelControlRules.length>0&&(t.visible&&t.visible===!0||t.controlType=="HiddenFieldControl")))for(e=jQuery.grep(f.formLevelControlRules,function(n){return n.ruleObject.controlType==="All_Mandatory"&&n.ruleFor=="lostFocus"}),r=0;r<e.length;r++)if(ruleItem=e[r],u=t.value,t._uiValue&&(u=t._uiValue.isObservableArray?t.uiValue[0]:t.uiValue),t.controlType==="LookupInput"&&t._displayValue&&(u=t.displayValue),!skelta.utilities.isUndefined(t.topLevelForm.onFormLoad)&&t.topLevelForm.onFormLoad===!0||t.associatedForm.parentForm.isAddingNewRecord===!0||ruleItem.ruleObject.ruleName(u,t,ruleItem.ruleObject,ruleItem.ruleFor),!skelta.forms.utilities.isUndefined(t.validationErrorCode)&&t.validationErrorCode.peek()===errorConstants.lostFocusRules)break;n(i)}})};ko.bindingHandlers.dataGridChecked={after:["value","attr"],init:function(n,t,i,r,u){function h(){var e=$(n).closest("[data-role='grid']").data("kendoGrid").dataSource.options.schema.model.fields,u={},r=i.has("checkedValue")?ko.utils.unwrapObservable(i.get("checkedValue")):n.value,t,f;for(t in r)f=e[t],u[t]=r[t]instanceof Date?skelta.grid.parseDateToInvariant(r[t],f):r[t];return u}function f(n,t,i,r,u,e,o){var h=!1,l=n[e].SourceName,s=t[l],c;if(s)if(l===r){if($.isPlainObject(s))$.each(i,function(n,t){return h=skelta.grid.isValueMatching(u[t],s[t])});else for(c=0;c<s.length;c++)if($.each(i,function(n,t){return h=skelta.grid.isValueMatching(u[t],s[c][t])}),h){o&&(s.splice(c,1),s.length>0&&(h=!1));break}}else if(e=e+1,$.isPlainObject(s))h=f(n,s,i,r,u,e,o);else for(c=0;c<s.length;c++)if(h=f(n,s[c],i,r,u,e,o),h){o&&(s.splice(c,1),s.length>0&&(h=!1));break}return h}function l(n,t,i,r,u,f){for(var l,a,v,y,s,e={},o={},h=i.isExtendedInfo&&i.hierarchicalInformation.length>1,p=0;p<=u.index;p++){var w=$(t).data("kendoGrid").dataItem(f),b=i.hierarchicalInformation[r].PersistColumns,c=i.hierarchicalInformation[r].SourceName,k=skelta.grid.getDataForPersistance(w,b,i.hierarchicalInformation[r].Schema,i.persistCultureSpecificValues);e={};e[c]=k;h&&(o={},o[c]=JSON.parse(JSON.stringify(w)));r>=0&&(v&&r<u.index&&(s=i.hierarchicalInformation[r+1].SourceName,e[c][s]=v[s]),h&&y&&r<u.index&&(s=i.hierarchicalInformation[r+1].SourceName,o[c][s]=y[s]),h&&(y=o),v=e,r--,f=f.closest(".k-detail-row").prev(),t=f.closest("[data-role='grid']"))}h&&(i.extendedInformation||(i.extendedInformation=[]),l=skelta.grid.getParentInformation(i.extendedInformation,o,i.hierarchicalInformation),l.ModelValueIndex===-1?i.extendedInformation.push(o):skelta.grid.updateModelData(i.extendedInformation[l.ModelValueIndex],o,i.hierarchicalInformation,l.HierarchicalInformationIndex,0));a=skelta.grid.getParentInformation(n,e,i.hierarchicalInformation);a.ModelValueIndex===-1?n.push(e):skelta.grid.updateModelData(n[a.ModelValueIndex],e,i.hierarchicalInformation,a.HierarchicalInformationIndex,0)}function a(){var c,it,tt,k,v,p,u,ot,w,r;if(!ko.computedContext.isInitial()&&(c=n.checked,it=y?h():c,!e||c)){var d=$(n).closest("[data-role='grid']"),g=d.attr("data-source"),i=s.$parent,b=skelta.grid.getSourceDetails(g,i.hierarchicalInformation),rt=b.detail,ut=$(n).closest(".k-master-row"),ft=b.index,et=s.$parent,a=rt?rt.PersistColumns:et.persistCols,nt=ko.ignoreDependencies(t);if(o){if(r=nt(),c===!1){for(tt=i.hierarchicalInformation[0].SourceName,$.each(r,function(n,t){r[n][tt]=skelta.grid.gridValueConvertDateTimeToString(t[tt],0,i.hierarchicalInformation)}),k={},v=!1,p=0;p<a.length;p++)k[a[p]]=it[a[p]];for(u=0;u<r.length;u++)if(ot=r[u],v=f(i.hierarchicalInformation,r[u],a,g,k,0,!0),v){r.splice(u,1);break}if(i.extendedInformation&&i.extendedInformation.length&&i.hierarchicalInformation.length>1)for(w=0;w<i.extendedInformation.length;w++)if(v=f(i.hierarchicalInformation,i.extendedInformation[w],a,g,k,0,!0),v){i.extendedInformation.splice(w,1);break}}else l(r,d,i,ft,b,ut);nt(r)}else r=[],c&&l(r,d,i,ft,b,ut),nt(r)}}function v(){var a=$(n).closest("[data-role='grid']").attr("data-source"),p=s.$parent,w=p.hierarchicalInformation,b=skelta.grid.getSourceDetails(a,w),k=b.detail,g=$(p.domElement).attr("data-source"),nt=ko.utils.unwrapObservable(t()),r=$.extend(!0,[],nt),g=w[0].SourceName,v,i,l,d,u,e,y;if($.each(r,function(n,t){r[n][g]=skelta.grid.gridValueConvertDateTimeToString(t[g],0,p.hierarchicalInformation)}),i=!1,l=h(),o){for(u=k?k.PersistColumns:p.persistCols,d=0;d<r.length;d++)if(e=r[d],b.index===0?(v=e[a],$.each(u,function(n,t){return i=skelta.grid.isValueMatching(l[t],v[t])})):(y=0,i=f(w,e,u,a,l,y,!1)),i)break;n.checked=i}else c?(r.length>0&&(e=r[0],b.index===0?(v=e[a],$.each(u,function(n,t){return i=skelta.grid.isValueMatching(l[t],v[t])})):(y=0,i=f(w,e,u,a,l,y,!1))),n.checked=i):(u=k?k.PersistColumns:p.persistCols,typeof r!==undefined&&r.length===undefined?$.each(u,function(n,t){return i=skelta.grid.isValueMatching(l[t],r[t])}):typeof r!==undefined&&r.length>0&&(e=r[0],b.index===0?(v=e[a],$.each(u,function(n,t){return i=skelta.grid.isValueMatching(l[t],v[t])})):(y=0,i=f(w,e,u,a,l,y,!1))),n.checked=i)}var s=u,c=n.type=="checkbox",e=n.type=="radio";if(c||e){var o=c&&ko.utils.unwrapObservable(t())instanceof Array,p=o?h():undefined,y=e||o;e&&!n.name&&ko.bindingHandlers.uniqueName.init(n,function(){return!0});ko.computed(a,null,{disposeWhenNodeIsRemoved:n});ko.utils.registerEventHandler(n,"click",a);ko.computed(v,null,{disposeWhenNodeIsRemoved:n})}}};f("checked",!0);ko.bindingHandlers.skValue={after:["options","foreach"],init:function(n,t,i){var r=["change"],u=i.get("valueUpdate"),e=!1,f,o;u&&(typeof u=="string"&&(u=[u]),ko.utils.arrayPushAll(r,u),r=ko.utils.arrayGetDistinctValues(r));f=function(){e=!1;var r=t(),u=ko.selectExtensions.readValue(n);ko.expressionRewriting.writeValueToProperty(r,i,"value",u)};o=ko.utils.ieVersion&&n.tagName.toLowerCase()=="input"&&n.type=="text"&&n.autocomplete!="off"&&(!n.form||n.form.autocomplete!="off");o&&ko.utils.arrayIndexOf(r,"propertychange")==-1&&(ko.utils.registerEventHandler(n,"propertychange",function(){e=!0}),ko.utils.registerEventHandler(n,"blur",function(){e&&f()}));ko.utils.arrayForEach(r,function(t){var i=f;ko.utils.stringStartsWith(t,"after")&&(i=function(){setTimeout(f,0)},t=t.substring(5));ko.utils.registerEventHandler(n,t,i)})},update:function(n,t){var u=ko.utils.tagNameLower(n)==="select",i=ko.utils.unwrapObservable(t()),f=ko.selectExtensions.readValue(n),e=i!==f,r;e&&(r=function(){ko.selectExtensions.writeValue(n,i)},r(),u&&(i!==ko.selectExtensions.readValue(n)?ko.ignoreDependencies(ko.utils.triggerEvent,null,[n,"change"]):setTimeout(r,0)))}};f("skValue",!0);ko.observableArray.fn.isObservableArray=!0;ko.bindingHandlers.richTextInputReadOnly={update:function(n,t){var i=ko.utils.unwrapObservable(t()),r=$(n).parent().find("iframe")[0].contentDocument.body;$(r).attr("contenteditable",!i);i===!0?$(n).parent().parent().parent().find(".k-editor-toolbar").hide():$(n).parent().parent().parent().find(".k-editor-toolbar").show()}};ko.bindingHandlers.richTextInputHeight={update:function(n,t){var i=ko.utils.unwrapObservable(t()),r=$(n).parent().find("iframe")[0].contentDocument.body;i>0&&($(n).parent().find("iframe")[0].style.height=i-14+"px")}};ko.bindingHandlers.richTextInputWidth={update:function(n,t){var i=ko.utils.unwrapObservable(t()),r=$(n).parent().find("iframe")[0].contentDocument.body;i>0&&($(n).parent().find("iframe")[0].style.width=i-14+"px")}};ko.bindingHandlers.richTextInputToolBar={update:function(n,t,i){var u=ko.utils.unwrapObservable(t()),r=$(n).parent().parent().parent().find(".k-editor-toolbar");skelta.utilities.isUndefined(skelta.DeviceOS)||skelta.DeviceOS!=="Web"?r.hide():u===!0&&i().richTextInputReadOnly()===!1?r.show():r.hide()}}}();skelta.utilities.isUndefined(skelta.forms.controls)&&skelta.createNamespace("skelta.forms.controls");skelta.utilities.isUndefined(skelta.forms.controls.BaseControl)&&(function(){var n=skelta.forms.utilities,t=skelta.forms.controls,u=n.getLogger(),c=function(n,t,i){var r=!1;switch(t){case"id":case"xmlNodeBoundTo":case"tagName":(skelta.utilities.isUndefined(n["_"+t])||n["_"+t].peek()===i)&&n[t]===i&&(r=!0)}return r},f=function(i,u,e,o){var h,s,c;if(n.isUndefinedNullOrEmpty(u))return null;if(n.isUndefined(o)&&(o=[]),h=null,s=this.associatedForm,s!=null&&(s==null||s.isRecordRow)||this instanceof t.BaseForm&&(c=this,!n.isUndefined(c.records)&&c.records.peek().length>0?s=c.records.peek()[0]:c.isTopLevelForm==!1&&(s=c.dataContainerForm.parentForm)),h=r.call(s,i,u,e,o),n.isUndefined(h))while(h===null&&s!==null)s=s.dataContainerForm,s!=null&&p(s,e)?(s=s.parentForm,s!==null&&(h=f.call(s,i,u,e,o))):s=null;return o=[],h},p=function(n,t){var i=!0;return skeltaUtils.isObject(t)&&!skeltaUtils.isUndefined(n)&&$.isFunction(t.parentContainerTraversalValidation)&&(i=t.parentContainerTraversalValidation(n)),i},w=function(n,t){var i=!0;return skeltaUtils.isObject(t)&&!skeltaUtils.isUndefined(n)&&$.isFunction(t.childContainerValidator)&&(i=t.childContainerValidator(n)),i},o=function(t,i,r){for(var f,s=e.call(this,t,i,r),u=0,o=0;o<s.length;o++)f=n.parseNumberValue(s[o].value),n.isUndefined(f)||typeof f!="number"||(u+=f);return typeof u!="number"||isNaN(u)?0:u},e=function(t,i,r){var u=[],o=this.dataContainerForm,e,f,s;if(n.isUndefinedNullOrEmpty(i))return u;for(e=n.isUndefined(r)||r===1?o.topLevelForm:o,f=0;f<e.records().length;f++)s=y.call(e.records()[f],t,i,r),u=u.concat(s);return u},b=function(i){var r=[],o,f,u,e;if(n.isRecordRow(this))for(o=this.controls,f=0;f<o.length;f++)u=o[f],u instanceof t.BaseForm?r=r.concat(u.findAllByType(i)):u.controlType===i&&r.push(u);else for(e=0;e<this.records().length;e++)r=r.concat(this.records()[e].findAllByType(i));return r},k=function(){if(this.isTopLevelForm)return!1;for(var t=this.parentForm;!n.isUndefined(t);){if(t.dataContainerForm.initFocus)return!1;t=t.dataContainerForm.parentForm}return!0},l=function(n,i){for(var r=0;r<n.length;r++)if(n[r].xmlNodeBoundTo===i)return n[r]instanceof t.BaseForm?!1:!0;return!1},a=function(t,i){var r;if(!n.isUndefined(t.readEditAddBehaviour)&&t.readEditAddBehaviour===1)return!0;i=typeof i=="boolean"?i:!0;var e=!1,h=t.records()[0].controls[0],u=h.records()[0].controls,o,f;for(r=0;r<u.length;r++)u[r].id.containsString("gridESUserID")&&(o=u[r]),u[r].id.containsString("gridESPassword")&&(f=u[r]);if(!n.isUndefined(o)&&!n.isUndefined(f)){if(i){var c=o.value,l=f.value,s=n.validateUserInESignature(c,l);s!==null&&(e=s.isValid==="True"?!0:!1);e===!1?(t.validationError(!0),t.validationErrorMessage(skelta.localize.getString("FormNGFInvalidESign")),t.validationErrorCode(errorConstants.controlSpecificValidation)):(t.validationError(!1),t.validationErrorMessage(""),t.validationErrorCode(errorConstants.none))}f.value=""}return e},v=function(n,t){t=typeof t=="boolean"?t:!0;for(var i=0;i<n.length;i++)control=n[i],t=control.validateControl(t);return t},s=function(n,i,r){var f,u;for(i=typeof i=="boolean"?i:!0,r=typeof r=="boolean"?r:!1,f=0;f<n.length;f++){if(u=n[f],u instanceof t.BaseForm)for(var o=u.records(),e=0,h=null,e=0;e<o.length;e++)h=o[e].controls,i=s(h,i,r);u.controlType==="Attachment"&&u.value.length>0&&(i=skelta.attachment.validateAttachmentControl(r,u,i))}return i},h=function(t,r,u){if(n.isUndefinedNullOrEmpty(r))return null;var f=this.associatedForm;return n.isRecordRow(f)?i.call(f,t,r,null,u):null},y=function(i,r,u){var e=[],h=this.controls,o,f,s;if(n.isUndefinedNullOrEmpty(r))return e;for(o=0;o<h.length;o++)if(f=h[o],f instanceof t.BaseForm&&u!==2)for(s=0;s<f.records().length;s++)e=e.concat(y.call(f.records()[s],i,r));else c(f,i,r)&&e.push(f);return e},i=function(i,r,u,f){var o=this.controls,s=null,e=0,h=!n.isUndefined(u)&&n.isArray(u);if(n.isUndefinedNullOrEmpty(r))return s;for(e=0;e<o.length;e=e+1){if(c(o[e],i,r,f)){s=o[e];break}h&&o[e]instanceof t.BaseForm&&w(o[e],f)&&u.push(o[e])}return s},r=function(t,u,f,e){if(n.isUndefinedNullOrEmpty(u))return null;var o=null,s=null,c=[],h=0;if(n.isUndefined(e)&&(e=[]),n.isUndefined(this.records))n.isRecordRow(this)?o=this:!n.isUndefined(this.parentForm)&&n.isRecordRow(this.parentForm)&&(o=this.parentForm);else if(this.records.peek().length>0)o=this.records.peek()[0];else return null;if(o===null)return null;if(!n.isObjectPresentInArray(o,e)){if(s=i.call(o,t,u,c,f),n.isUndefined(s)&&c.length>0)for(h=0;h<c.length;h=h+1)if(s=r.call(c[h],t,u,f,e),!n.isUndefined(s))break;e.push(o)}return s};t.BaseControl=function(n,i){if(arguments.length!==0){var r=this;skelta.BaseClass.call(r,t,"BaseControl");r.parentForm=n;r.controlType=i;r["_"+customBindings.setFocusOnNewRecord]=ko.observable(!1);Object.defineProperty(r,"associatedForm",{get:function(){return r._associatedForm()},enumerable:!0,configurable:!0});Object.defineProperty(r,"dataContainerForm",{get:function(){return r._dataContainerForm()},enumerable:!0,configurable:!0});Object.defineProperty(r,"isTopLevelForm",{get:function(){return r._isTopLevelForm()},enumerable:!0,configurable:!0});Object.defineProperty(r,"topLevelForm",{get:function(){return r._topLevelForm()},enumerable:!0,configurable:!0})}};n.inheritClass(t.BaseControl,skelta.BaseClass);t.BaseControl.prototype.viewModelInstance=function(){return this.records._latestValue[0]};t.BaseControl.prototype.submitForm=function(n){this.topLevelForm.records()[0].submitClick(n)};t.BaseControl.prototype._associatedForm=function(){return this instanceof t.BaseForm?this:this.parentForm};t.BaseControl.prototype._dataContainerForm=function(){var n=this.associatedForm;return n.isRecordRow==!0&&(n=n.parentForm),n};t.BaseControl.prototype._isTopLevelForm=function(){return this instanceof t.BaseForm&&n.isUndefined(this.parentForm)==!0?!0:!1};t.BaseControl.prototype._topLevelForm=function(){var i=null;return this instanceof t.BaseForm?(i=this,this.parentForm!=null&&(i=i.parentForm._topLevelForm()),i):n.isUndefined(this.parentForm)?null:this.parentForm._topLevelForm()};t.BaseControl.prototype.getType=function(){return this.controlType};t.BaseControl.prototype.findById=function(n,t){return f.call(this,"id",n,t)};t.BaseControl.prototype.findByName=function(n,t){return f.call(this,"tagName",n,t)};t.BaseControl.prototype.findByXmlNode=function(n,t){return f.call(this,"xmlNodeBoundTo",n,t)};t.BaseControl.prototype.findByXPath=function(t){var u=null,i=t.split("."),r,f;if(i.length===0||i.length===1)return u;if(i.length===2){if(r=this.findByXmlNode(i[i.length-1]),n.isUndefined(r))return u;u=r}else if(i.length>2){if(r=this.findAllByXmlNode(i[1],2),n.isUndefined(r)||!n.isUndefined(r)&&r.length===0)return u;for(f=0;f<r.length;f++)if(i.splice(0,1),u=r[f].findByXPath(i.join(".")),!n.isUndefined(u))break}return u};t.BaseControl.prototype.findAllById=function(n,t){return e.call(this,"id",n,t)};t.BaseControl.prototype.findAllByName=function(n,t){return e.call(this,"tagName",n,t)};t.BaseControl.prototype.findAllByXmlNode=function(n,t){return e.call(this,"xmlNodeBoundTo",n,t)};t.BaseControl.prototype.sumById=function(n,t){return o.call(this,"id",n,t)};t.BaseControl.prototype.sumByName=function(n,t){return o.call(this,"tagName",n,t)};t.BaseControl.prototype.sumByXmlNode=function(n,t){return o.call(this,"xmlNodeBoundTo",n,t)};t.BaseControl.prototype.setFocus=function(){try{if(n.isUndefined(this["_"+customBindings.setFocusOnNewRecord])||!n.isUndefined(this.enable)&&this.enable===!1||!n.isUndefined(this.readOnly)&&this.readOnly===!0||!n.isUndefined(this.visible)&&this.visible===!1)return!1;if(this.controlType==="LookupInput"&&this.showItemsByDefault===!0)return!0;var t=this["_"+customBindings.setFocusOnNewRecord];return t()&&t(!1),t(!0),!0}catch(i){return!1}};t.BaseControl.prototype.executeScriptWithoutEval=function(t,i){var r="",f,e;if(t!=null&&(r=t()),f=this,!n.isUndefined(i)&&i!="")try{e=t();r=i(f,e,arguments[2])}catch(o){n.showError(skelta.localize.getString("FormNGFScriptExecutionErrorTitle"),skelta.localize.getString("FormNGFScriptExecutionErrorMsg"),null,o.message);u.logError(skelta.localize.getString("FormNGFScriptExecutionErrorMsg")+"\n"+o.message)}return r};t.BaseControl.prototype.readEditAddBehaviourEnableDependencyFunction=function(){return n.isUndefined(this.parentForm.parentForm)||n.isUndefined(this.parentForm.parentForm._readEditAddBehaviour)||this.parentForm.parentForm._readEditAddBehaviour()===2&&this.parentForm.isNewRecord||this.parentForm.parentForm._readEditAddBehaviour()===0};t.BaseControl.prototype.readEditAddBehaviourReadOnlyDependencyFunction=function(){return!this.readEditAddBehaviourEnableDependencyFunction()};t.BaseControl.prototype.autoAppendRecordInGrid=function(t,i){var r=t.addPosition,u;return!n.isUndefined(r)&&(u=r===0?t.records().indexOf(i)===0:t.records().indexOf(i)===t.records().length-1,u)?t.addRecord(null):null};t.BaseControl.prototype.checkIfLastFocussableControl=function(){for(var t,f=this.associatedForm,u=f.controls,i=null,r=u.length-1;r>=0;r--)if(t=u[r],!n.isUndefined(t.visible)&&t.visible){if(t.controlType==="BaseForm"){i=null;break}else t.controlType==="PanelForm"&&(i=t.isControlFocussableAndEnabled());if(skelta.utilities.isUndefined(i)&&t.isControlFocussableAndEnabled()){i=t;break}}return this===i?!0:!1};t.BaseControl.prototype.isControlFocussableAndEnabled=function(){return!n.isUndefined(this["_"+customBindings.setFocusOnNewRecord])&&(!n.isUndefined(this.enable)&&this.enable===!0||this.controlType==="HyperLinkText")&&(n.isUndefined(this.options)||this.options.length>0)?!0:!1};t.BaseControl.prototype.getDataContainerGrid=function(){for(var n=this.dataContainerForm;!n.isTopLevelForm;){if(n.controlType==="BaseForm")return n.viewMode===1?n:null;(n.controlType==="PanelForm"||n.controlType==="ElectronicSignatureForm")&&(n=n.parentForm.dataContainerForm)}return null};t.BaseControl.prototype.getAssociatedRecordOfGrid=function(){for(var t=this.associatedForm,n=this.dataContainerForm;!n.isTopLevelForm;){if(n.controlType==="BaseForm")return n.viewMode===1?t:null;(n.controlType==="PanelForm"||n.controlType==="ElectronicSignatureForm")&&(t=t.parentForm,n=t.dataContainerForm)}return null};t.BaseControl.prototype.validateControl=function(i){var r,e,o,s,f,u;if(i=typeof i=="boolean"?i:!0,r=this,e=skelta.forms.utilities.isUndefined(this.domElement)?$("[controlid ="+r.id+"]"):this.domElement,"_value"in r){if(r.validationError(!1),r.validationErrorMessage(""),r.validationErrorCode(errorConstants.None),o=r.topLevelForm,o.formLevelControlRules.length>0&&r.visible&&r.visible===!0)for(s=jQuery.grep(o.formLevelControlRules,function(n){return n.ruleObject.controlType===r.controlType||n.ruleObject.controlType==="All_Mandatory"}),f=0;f<s.length;f++)if(ruleRecord=s[f],ruleRecord.ruleFor==="UIValue"?ruleRecord.ruleObject.ruleName(r.uiValue,r,ruleRecord.ruleObject,ruleRecord.ruleFor):ruleRecord.ruleObject.ruleName(r.value,r,ruleRecord.ruleObject,ruleRecord.ruleFor),r.validationErrorCode.peek())break;(r.validationError()!==!1||r.validationErrorMessage()!=="")&&(r.controlType!=="Signature"||r.isMandatory!==!0||r.sign.isEmpty()?(i===!0&&e.focus(),i=!1):(i=i&&!0,r.validationError(!1),r.validationErrorMessage("")));r.controlType==="LookupInput"&&skeltaUtils.validateLookup(r)}else r instanceof t.BaseForm&&!skelta.utilities.isUndefined(r.visible)&&r.visible===!0&&(i=r.validateForm(i,!1));return typeof r.onControlValidate!="function"||r.validationError()!==!1||skelta.utilities.isUndefined(r.visible)||r.visible!==!0||(u=r.onControlValidate(r,r.value),n.isUndefined(u)&&(u=new ValidationOptions(!0,"")),u.isValid===!1?(i===!0&&e.focus(),i=!1,r.validationError(!0),r.validationErrorMessage(u.message),r.validationErrorCode(errorConstants.validationScript)):(r.validationError(!1),r.validationErrorMessage(""),r.validationErrorCode(errorConstants.none))),i};t.BaseForm=function(i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){if(arguments.length!==0){var k=this;i==null&&(k.functionQueueToBeTriggeredAfterFormLoad=[],k.dataModel=skelta.forms.utilities.getDataModelObject(skelta.forms.utilities.getFormUniqueKey(skelta.userContext.getUserContextFor("appN"),skelta.userContext.getUserContextFor("itemId"),skelta.userContext.getUserContextFor("vStamp"))),k.isFormLoaded=ko.observable(!1),k.desktopViewOnly=b,k.isFormLoaded.subscribe(function(t){if(t===!0){if(k.functionQueueToBeTriggeredAfterFormLoad)while(k.functionQueueToBeTriggeredAfterFormLoad.length>0)k.functionQueueToBeTriggeredAfterFormLoad.shift()();if(n.isUndefined(k.onFormLoadedScript)||k.onFormLoadedScript.call(),n.isWorkTasksPro())if(window.isPopupForm===!0)delete window.isPopupForm;else if(window.isWidgetForm!==!0){var i=k.records()[0]._tagName;n.updateFormHeaderForWorkTasksPro(i)}}}));n.isUndefined(y)||(k._isLoaded=ko.observable(y),k._isReadyToLoad=ko.observable(w),k.getTemplateName=ko.computed(function(){return k._isLoaded&&k._isReadyToLoad&&k._isLoaded()&&k._isReadyToLoad()?p:"Empty"}));t.BaseControl.call(k,i,e);skelta.BaseClass.call(k,t,"BaseForm");k.defaultRows=s;k.isRepeating=f;k.formLevelControlRules=v;k.onFormLoad=!0;k.viewMode=n.isUndefined(o)?baseFormViewMode.Default:o;k.controls=[];k.minimumRows=h;k.maximumRows=c;k.addPosition=l;k.Data=u;k.signatureMode=a;k.disableEvents=!1;k.initFocus=!1;k.records=ko.observableArray([]);k.OnControlReadEditAddBehaviour=ko.observable(null);k._readEditAddBehaviour=ko.observable(0).getComputedV3REAB(k);Object.defineProperty(k,"readEditAddBehaviour",{get:function(){return k._readEditAddBehaviour()},set:function(n){k._readEditAddBehaviour(n)},enumerable:!0,configurable:!0});k.addRecordFn=r;k.beforeAddRecord=null;k.afterAddRecord=null;k.beforeRemoveRecord=null;k.afterRemoveRecord=null;k.isAddingNewRecord=!1;k.isDeleteDisabled=ko.computed(function(){return k.isRecordRow?!k.isNewRecord&&k.parentForm._readEditAddBehaviour()===2:!1});k.records([]);(n.isUndefined(k.isRecordRow)||!k.isRecordRow)&&(k.initializeData(u,!0),k.initialiseDefaultRecords())}};n.inheritClass(t.BaseForm,t.BaseControl);t.BaseForm.prototype.addControl=function(n,i,r){var u=new t.BaseControl(this,r);return u.id=n,u.xmlNodeBoundTo=i,this.controls.push(u),u};t.BaseForm.prototype.addContainerControl=function(i){var f=0,e=0,o=0,s=0,h=0,c=0,r=null;n.isUndefined(i.vm)||(f=i.vm);n.isUndefined(i.ap)||(h=i.ap);n.isUndefined(i.dr)||(e=i.dr);n.isUndefined(i.mnr)||(o=i.mnr);n.isUndefined(i.mxr)||(s=i.mxr);n.isUndefined(i.sm)||(c=i.sm);n.isUndefined(i.dm)||(r=i.dm,n.isUndefined(r)||typeof r!="object"||n.isUndefined(r.__text)||(r=r.__text),i.ctn==="EmbeddedForm"&&typeof r=="string"&&(r===""?r=null:(r=n.getJSONObjectFromXml(r),r=n.isUndefined(r)?r:r[Object.keys(r)[0]])));var l=i.islded,a=i.tmltnm,v=i.isrdld,y=i.deskvwonly,u=new t.BaseForm(this,i.fn,r,i.ir,i.ctn,f,e,o,s,h,c,null,l,a,v,y);return u.id=i.id,u.xmlNodeBoundTo=i.xn,this.controls.push(u),u};t.BaseForm.prototype.addTabsContainerControl=function(n){var r=n.id,u=n.arf,f=n.dm,e=n.ct,o=n.sti,s=n.islded,h=n.tmltnm,c=n.isrdld,l=n.deskvwonly,i=new t.TabsContainerControl(this,u,f,e,o,s,h,c,l);return i.id=r,i.xmlNodeBoundTo="",this.controls.push(i),i};t.BaseForm.prototype.addTabControl=function(n,i,r,u,f,e,o,s){var h=new t.TabControl(this,i,r,u,f,e,o,s);return h.id=n,h.xmlNodeBoundTo="",this.controls.push(h),h};t.BaseForm.prototype.findImmediateChildRecordControlById=function(n){return h.call(this,"id",n)};t.BaseForm.prototype.findImmediateChildRecordControlByName=function(n){return h.call(this,"tagName",n)};t.BaseForm.prototype.findImmediateChildRecordControlByXmlNode=function(n){return h.call(this,"xmlNodeBoundTo",n)};t.BaseForm.prototype.findImmediateChildControlById=function(n,t){return i.call(this,"id",n,t)};t.BaseForm.prototype.findImmediateChildControlByName=function(n,t){return i.call(this,"tagName",n,t)};t.BaseForm.prototype.findImmediateChildControlByXmlNode=function(n,t){return i.call(this,"xmlNodeBoundTo",n,t)};t.BaseForm.prototype.findChildRecordControlById=function(n){return r.call(this,"id",n)};t.BaseForm.prototype.findChildRecordControlByName=function(n){return r.call(this,"tagName",n)};t.BaseForm.prototype.findChildRecordControlByXmlNode=function(n){return r.call(this,"xmlNodeBoundTo",n)};t.BaseForm.prototype.findAllByType=function(n){return b.call(this,n)};t.BaseForm.prototype.addRecordInWebUX=function(){this.addRecord(null)};t.BaseForm.prototype.addRecord=function(t){return t===undefined&&(t=null),n.isUndefined(this.addPosition)||this.addPosition!==1?this.addRecordToTop(t):this.addRecordToBottom(t)};t.BaseForm.prototype.addRecordToTop=function(n){return n===undefined&&(n=null),this.addRecordToPosition(-1,n)};t.BaseForm.prototype.addRecordToBottom=function(n){return n===undefined&&(n=null),this.addRecordToPosition(this.records().length+1,n)};t.BaseForm.prototype.addRecordToPosition=function(t,i){var r,u;if(typeof t!="number"){n.showError(document.title,skelta.localize.getString("FormNGFAddRecordInvalidInput"));return}if(this.controlType==="PanelForm"&&this.records().length===1){n.showError(document.title,skelta.localize.getString("FormNGFAddRecordToPanelError"));return}if(n.isUndefined(this.isRecordRow)||!this.isRecordRow)return r=null,i==undefined&&(i=null),t=t-1,k.call(this)&&(this.initFocus=!0),this.isAddingNewRecord=!0,n.isUndefined(this.beforeAddRecord)||this.disableEvents||this.beforeAddRecord(this),n.isUndefined(this.addRecordFn)||(u=this.records().length,t<=0?t=0:t>u&&(t=u),this.records.splice(t,0,new this.addRecordFn(this,i,n.isUndefined(i))),r=this.records()[t],n.setAttributesToForm(r,i)),n.isUndefined(this.afterAddRecord)||this.disableEvents||this.afterAddRecord(this),this.checkMinMaxRows(),this.isAddingNewRecord=!1,this.initFocus&&this.initializeFocus(t),this.initFocus=!1,r};t.BaseForm.prototype.initializeFocus=function(n){if(this.topLevelForm.isFormLoaded()&&(skelta.utilities.isUndefined(skelta.DeviceOS)||skelta.DeviceOS==="Web")&&skelta.utilities.isUndefined(skelta.initializeFocusContext)){if(!skelta.utilities.isUndefinedNullOrEmpty(skelta.utilities.getUrlParameterValue(window,WW_IFRAME_PARAMETERNAME_FORMUNIQUEID))&&!skelta.utilities.isUndefinedNullOrEmpty(window.WW_SKINIT_FOCUS_DUMMY)){setTimeout(function(){delete window.WW_SKINIT_FOCUS_DUMMY},0);return}skelta.initializeFocusContext=function(n){var t=this.records.peek(),r,i;if(t.length>0&&t[0].controls.length>0)for(n<0&&(n=t.length-1),r=t[n].controls,i=0;i<r.length;i++)if(r[i].setFocus())break;delete skelta.initializeFocusContext}.bind(this);setTimeout(function(){skelta.initializeFocusContext&&skelta.initializeFocusContext(n)},0)}};t.BaseForm.prototype.addRecordInMobileUX=function(){this.addRecord(null);n.isUndefined(this.addPosition)||this.addPosition!==1?this.records()[0].openDetailView.call():this.records()[this.records().length-1].openDetailView.call()};t.BaseForm.prototype.clearContent=function(){try{if(this.controlType==="PanelForm")this.dataContainerForm.records()[0].remove(),this.dataContainerForm.addRecordToPosition(0);else if(this.isTopLevelForm)this.removeAll(),this.addRecord();else if(this.isRecordRow){var n=this.dataContainerForm,t=n.records().indexOf(this);n.removeAt(t+1);n.addRecordToPosition(t+1)}else this.removeAll(),this.initialiseDefaultRecords();return!0}catch(i){return!1}};t.BaseForm.prototype.removeAll=function(){var t,u;if(!n.isUndefined(this.controlType)&&this.controlType==="PanelForm"){n.showError(document.title,skelta.localize.getString("FormNGFDeleteRecordToPanelError"));return}var i=this.records(),r=i.length;if(r>0)for(t=r-1;t>=0;t--)u=i[t],this.records.remove(i[t]),skelta.forms.utilities.disposeAndDelete(u);this.checkMinMaxRows()};t.BaseForm.prototype.dispose=function(){skeltaUtils.dispose(this);return};t.BaseForm.prototype.removeAt=function(t){var i,r,u;if(typeof t!="number")return n.showError(document.title,skelta.localize.getString("FormNGFDeleteRecordInvalidInput")),null;if(!n.isUndefined(this.controlType)&&this.controlType==="PanelForm")return n.showError(document.title,skelta.localize.getString("FormNGFDeleteRecordToPanelError")),null;if(this.isRecordRow)return null;if(i=t-1,r=this.records(),i>=0&&i<r.length)u=r[i],this.records.remove(r[i]),skelta.forms.utilities.disposeAndDelete(u);else return n.showError(document.title,skelta.localize.getString("FormNGFDeleteRecordInvalidIndex")),null};t.BaseForm.prototype.removeRecord=function(t){n.isUndefined(this.beforeRemoveRecord)||this.disableEvents||this.beforeRemoveRecord(this);this.records.remove(t);skelta.forms.utilities.disposeAndDelete(t);n.isUndefined(this.afterRemoveRecord)||this.disableEvents||this.afterRemoveRecord(this);this.checkMinMaxRows()};t.BaseForm.prototype.removeSelection=function(){var t=ko.utils.arrayFirst(this.records(),function(n){return n.isRowHighlighted()===!0});if(skelta.utilities.isUndefined(t)){n.showAlert(document.title,skelta.localize.getString("FormNGFRemoveSelection"));return}this.removeRecord(t)};t.BaseForm.prototype.remove=function(){this.isRecordRow&&this.dataContainerForm.removeRecord(this)};t.BaseForm.prototype.removeFromWebUI=function(){this.isRecordRow&&!this.isDeleteDisabled()&&this.dataContainerForm.removeRecord(this)};t.BaseForm.prototype.removeFromMobileUI=function(){this.isRecordRow&&!this.isDeleteDisabled()&&(this.parentForm.openRecordListing.call(),this.dataContainerForm.removeRecord(this))};t.BaseForm.prototype.recreatePanel=function(){this.dataContainerForm[customBindings.panelRearrangeElements]()==="1"?this.dataContainerForm[customBindings.panelRearrangeElements]("0"):this.dataContainerForm[customBindings.panelRearrangeElements]("1")};t.BaseForm.prototype.setFocus=function(){var i,r,u,t;try{if(!n.isUndefined(this.visible)&&!this.visible||(i=this.records(),i.length===0)||(r=i[0].controls,u=r.length,u===0))return!1;for(t=0;t<u;t++)if(r[t].setFocus())return!0;return!1}catch(f){return!1}};t.BaseForm.prototype.initializeData=function(t,i){var r=0;if(this.disableEvents=i,n.isUndefinedNullOrEmpty(t)||n.isString(t))n.isUndefined(this.isRepeating)!=!0&&(n.isUndefined(this.isRepeating)||this.isRepeating!=!1)||this.addRecord();else if(this.controlType!=="ElectronicSignatureForm"||n.isUndefined(t)||this.signatureMode!==2||n.isUndefined(t.ElectronicSignatureSignedOn)||t.ElectronicSignatureSignedOn===""||(t=null),n.isUndefined(t)||n.isUndefined(t.length))this.addRecordToBottom(t);else for(r=0;r<t.length;r=r+1)this.addRecordToBottom(t[r]);this.subscribeToControls();this.disableEvents=!1;this.controlType!=="ElectronicSignatureForm"||n.isUndefined(t)||this.signatureMode===2||t.ElectronicSignatureSignedOn!==""&&(this.readEditAddBehaviour=1)};t.BaseForm.prototype.initialiseDefaultRecords=function(){var t,i;if(!n.isUndefined(this.defaultRows)&&n.isUndefined(this.Data))for(t=this.defaultRows,this.isRepeating||(t-=1),i=0;i<t;i++)this.addRecord()};t.BaseForm.prototype.subscribeToControls=function(){var f,t,r,e,i,u,o;if(!this.isTopLevelForm&&!n.isUndefined(this.controlType)&&this.controlType==="PanelForm"&&n.isUndefined(this.isRecordRow)&&!n.isUndefined(this.records))for(f=this.records.peek().length,t=0;t<f;t++)for(r=this.records.peek()[t],e=r.controls.length,i=0;i<e;i++)u=r.controls[i],n.isUndefined(u._visible)||(o=this,u._visible.subscribe(function(){o.recreatePanel()}))};t.BaseForm.prototype.saveAsDraftClick=function(t){var l=skelta.forms.utilities.getFormUniqueKey(skelta.userContext.getUserContextFor("appN"),skelta.userContext.getUserContextFor("itemId"),skelta.userContext.getUserContextFor("vStamp")),i,r,h,e;skelta.forms.utilities.showLoader();i=!0;try{i=this.dataContainerForm.validateOnlyESignatureForSaveAsDraft(i)}catch(t){n.showError(document.title,t.message);skelta.forms.utilities.hideLoader();return}if(i&&(i=this.dataContainerForm.updateAttachmentUploadStatus(!0,!1,!0)),i)try{var o=this.getFormSubmissionData(t),f=new InputParameterObject,s=new submitClickEvent("skelta");for(f.InstanceJSON=ko.toJSON(o),f.instanceXml=o,r=0;r<this.topLevelForm.onSaveAsDraft().length;r++)h=this.topLevelForm.onSaveAsDraft()[r],s.subscribe(h);s.raise(f,t)}catch(c){e=skelta.localize.getString("FormNGFSaveAsDraftFailure");n.showError(document.title,e,null,c.message);u.logError(e+"\n"+c.message)}else n.showError(document.title,skelta.localize.getString("FormNGFSaveAsDraftError")),u.logError(skelta.localize.getString("FormNGFSaveAsDraftError"));skelta.forms.utilities.hideLoader()};t.BaseForm.prototype.submitClick=function(t){function r(i,r){var o,s,f,l;if(r){var h=i.getFormSubmissionData(t),e=new InputParameterObject,c=new buttonClickEventArgs;for(skelta.utilities.isUndefined(t)||(o=skelta.forms.utilities.getButtonTextFromEvent(t),c.buttonText=skelta.utilities.isUndefined(o)?"":o),s=new submitClickEvent("skelta"),e.InstanceJSON=ko.toJSON(h),e.instanceXml=h,f=0;f<i.topLevelForm.onSave().length;f++)l=i.topLevelForm.onSave()[f],s.subscribe(l);s.raise(e,c);skelta.forms.utilities.isWorkTasksPro()&&skelta.forms.utilities.hideLoader()}else u.logError(skelta.localize.getString("FormNGFSaveError")),skelta.forms.utilities.hideLoader(),n.showError(document.title,skelta.localize.getString("FormNGFSaveError"))}function f(t,i){var u=!0;try{if(skelta.forms.utilities.isWorkTasksPro()&&skelta.forms.utilities.isWorkTasksProConnectedToInternet()===!1&&skelta.forms.utilities.isWorkTasksProOfflineSupportEnabled()===!1){skelta.forms.utilities.showWorkTasksProAccountErrorMessage();skelta.forms.utilities.hideLoader();return}u=t.dataContainerForm.validateForm(!0,!1)}catch(i){n.showError(document.title,i.message);skelta.forms.utilities.hideLoader();return}u&&(u=skelta.attachment.isValidAttachmentStatus(t.dataContainerForm));skelta.forms.utilities.isUndefined(control.topLevelForm.validationPromises)===!1&&control.topLevelForm.validationPromises.length>0?Promise.all(control.topLevelForm.validationPromises).then(function(){r(t,u)}):r(t,u)}skelta.forms.utilities.showLoader();var i=this;skelta.forms.utilities.isWorkTasksPro()?setTimeout(function(){window.top.clearIntervalForAutomaticSaveAsDraft();f(i,t)},50):f(i,t)};t.BaseForm.prototype.checkMinMaxRows=function(){var t=this,r=t.records(),i=!0;n.isUndefined(t.validationError)||(t.minimumRows!==0&&r.length<t.minimumRows&&(i=!1),t.maximumRows!==0&&r.length>t.maximumRows&&(i=!1),i&&(t.validationError(!1),t.validationErrorMessage(""),t.validationErrorCode(errorConstants.controlSpecificValidation)))};t.BaseForm.prototype.cancelButtonClick=function(n){for(var r,i=new submitClickEvent("skelta"),t=0;t<this.topLevelForm.onCancel().length;t++)r=this.topLevelForm.onCancel()[t],i.subscribe(r);i.raise(n)};t.BaseForm.prototype.validateRecord=function(){return this.validateForm(!0,!0)};t.BaseForm.prototype.validateOnlyESignatureForSaveAsDraft=function(i){var r=typeof i=="boolean"?i:!0,u=this.records(),f,o,e,s;if(!n.isUndefined(u)&&u.length>0)for(f=0;f<u.length;f++)for(o=u[f].controls,e=0;e<o.length;e++)s=o[e],s instanceof t.BaseForm&&(r=s.validateOnlyESignatureForSaveAsDraft(r));return this.controlType==="ElectronicSignatureForm"&&(r=a(this,r)),r};t.BaseForm.prototype.updateAttachmentUploadStatus=function(t,i,r){var u=this,e,f=typeof t=="boolean"?t:!0,o=null,h=null;if(n.isUndefined(i)||!i)for(u.isRecordRow&&(u=u.dataContainerForm),o=u.records(),e=0;e<o.length;e++)h=o[e].controls,f=s(h,f,r);else f=s(u.controls,f,r);return f};t.BaseForm.prototype.validateForm=function(t,i){var r=this,u=typeof t=="boolean"?t:!0,e,f=null,s=null,o;if(n.isUndefined(i)||!i)for(r.isRecordRow&&(r=r.dataContainerForm),f=r.records(),n.isUndefined(r._tagName)||n.isUndefined(r.validationError)||(r.minimumRows>0&&f.length<r.minimumRows&&(o=skelta.localize.getString("FormNGFMinRowValidation").replace("<@Name@>",r._tagName()).replace("<@MinimumRows@>",r.minimumRows),r.validationError(!0),r.validationErrorMessage(o),r.validationErrorCode(errorConstants.controlSpecificValidation),u=!1),r.maximumRows>0&&f.length>r.maximumRows&&(o=skelta.localize.getString("FormNGFMaximumRowsValidation").replace("<@Name@>",r._tagName()).replace("<@MaximumRows@>",r.maximumRows),r.validationError(!0),r.validationErrorMessage(o),r.validationErrorCode(errorConstants.controlSpecificValidation),u=!1)),e=0;e<f.length;e++)s=f[e].controls,u=v(s,u);else u=v(r.controls,u);return this.controlType==="ElectronicSignatureForm"&&(u=a(this,u)),u};t.BaseForm.prototype.getFormSubmissionData=function(n,i){function s(n,i,r){var c,u,y,l,p,e,w,f,a,h;if(skelta.utilities.isUndefinedNullOrEmpty(i)||skelta.utilities.isString(i)||!skelta.utilities.isUndefined(skelta.updateNonBindedData)&&skelta.updateNonBindedData===!1)return n;for(c=0;c<r.length;c++)if(u=r[c],u instanceof t.BaseForm&&u[customProperties.isValueInXmlEncoded]!==!0)if(u.isRecordRow||u.records().length!==1)if(i[u.xmlNodeBoundTo]!==undefined&&n[u.xmlNodeBoundTo]!==undefined)for(p=u.records(),v(u.xmlNodeBoundTo,i,n),e=0;e<p.length;e++)i[u.xmlNodeBoundTo][e]=s(n[u.xmlNodeBoundTo][e],i[u.xmlNodeBoundTo][e],p[e].controls);else skelta.utilities.isUndefined(i[u.xmlNodeBoundTo])&&!skelta.utilities.isUndefined(n[u.xmlNodeBoundTo])?i[u.xmlNodeBoundTo]=n[u.xmlNodeBoundTo]:!skelta.utilities.isUndefined(i[u.xmlNodeBoundTo])&&skelta.utilities.isUndefined(n[u.xmlNodeBoundTo])&&delete i[u.xmlNodeBoundTo];else if(skelta.utilities.isUndefinedNullOrEmpty(u.xmlNodeBoundTo))for(y=u.records(),l=0;l<y.length;l++)i=s(n,i,y[l].controls);else v(u.xmlNodeBoundTo,i,n),i[u.xmlNodeBoundTo][0]=s(n[u.xmlNodeBoundTo][0],i[u.xmlNodeBoundTo][0],u.records()[0].controls);else if(!skelta.utilities.isUndefinedNullOrEmpty(u.xmlNodeBoundTo))if(u.xmlNodeBoundTo.indexOf("@")===0)w=u.xmlNodeBoundTo.replace("@","_"),!skelta.utilities.isUndefined(i)&&skelta.utilities.isString(i)&&(i.__text=i),i[w]=n[w];else if(u.xmlNodeBoundTo.containsString("/"))f=u.xmlNodeBoundTo.split("/"),f.length===2&&(skelta.utilities.isUndefined(i[f[0]])?skelta.utilities.isString(i[f[0]])&&(i[f[0]].__text=i[f[0]]):i[f[0]]={},i[f[0]][f[1]]=n[f[0]].length===undefined?n[f[0]][f[1]]:n[f[0]][0][f[1]]);else if(skelta.utilities.isUndefined(i[u.xmlNodeBoundTo])||typeof i[u.xmlNodeBoundTo]!="object")i[u.xmlNodeBoundTo]=n[u.xmlNodeBoundTo];else{var o=n[u.xmlNodeBoundTo],k=!1,b=i[u.xmlNodeBoundTo];for(a in b)if(b.hasOwnProperty(a)&&typeof b[a]!="function"&&!a.startsWithString("_")){k=!0;break}if(k)i[u.xmlNodeBoundTo]=n[u.xmlNodeBoundTo];else if(typeof o=="object")for(h in o)o.hasOwnProperty(h)&&typeof o[h]!="function"&&(i[u.xmlNodeBoundTo][h]=o[h]);else i[u.xmlNodeBoundTo].__text=o}return i}function a(n,t){var i=t[n];skelta.utilities.isUndefinedNullOrEmpty(i)?t[n]=[]:skelta.utilities.isArray(i)||(t[n]=[t[n]])}function v(n,t,i){try{a(n,t);a(n,i);var u=t[n],f=i[n],e=u.length,r=f.length;e>r&&(t[n]=t[n].splice(0,r))}catch(o){}}var u=null,c=!1,r,f,e,h,o;if(SFU.isUndefined(this.parentForm)||this.parentForm[customProperties.isValueInXmlEncoded]!==!0||(c=!0),this.topLevelForm.isInPrintMode!==!0&&(u=this.topLevelForm.dataModel),r={},f=skelta.forms.utilities.getButtonTextFromEvent(n),this.isRecordRow)if(this.parentForm.xmlNodeBoundTo.containsString("/")){if(e=this.parentForm.xmlNodeBoundTo.split("/"),e.length!==2)return;var y=e[0],p=e[1],l={};l[p]=this.getFormInstanceXML(n,i,{},f);r[y]=[l]}else r[this.parentForm.xmlNodeBoundTo]=this.getFormInstanceXML(n,i,{},f);else{for(h=[],o=0;o<this.records().length;o++)h.push(this.records()[o].getFormInstanceXML(n,i,{},f));r[this.xmlNodeBoundTo]=h}return c||(r[this.topLevelForm.xmlNodeBoundTo]=s(r[this.topLevelForm.xmlNodeBoundTo],u===undefined||u===null?u:u[this.topLevelForm.xmlNodeBoundTo],this.controls)),r};t.BaseForm.prototype.isControlFocussableAndEnabled=function(){for(var t,i=this.records()[0].controls,n=i.length-1;n>=0;n--)if(t=i[n],t.isControlFocussableAndEnabled())return t;return null};t.BaseForm.prototype.getFormInstanceXML=function(t,i,r,u){var h,o,w,c,a,f,b,k,g,tt,it,rt,ut,e,y,p;if(this.records&&(this.records().length>1||this.xmlNodeBoundTo!=="")&&(h=[]),this.records&&this.records().length>0)for(o=0,w=this.records().length,o=0;o<w;o++)n.isUndefined(i)||this.xmlNodeBoundTo!==""?h.push(this.records()[o].getFormInstanceXML(t,undefined,{},u)):(r=i,this.records()[o].getFormInstanceXML(t,r,{},u));else{for(c=this.controls,i&&(r=i),a=0;a<c.length;a++)if(f=c[a],f.records&&f.records().length>0)if(f.xmlNodeBoundTo&&f.xmlNodeBoundTo!=="")if(r.hasOwnProperty(f.xmlNodeBoundTo)){b=f.getFormInstanceXML(t,undefined,r[f.xmlNodeBoundTo][0],u)[0];for(k in b)r[f.xmlNodeBoundTo][0][k]=b[k]}else if(f.xmlNodeBoundTo.containsString("/"))if(e=f.xmlNodeBoundTo.split("/"),e.length!==2)continue;else{var s=e[0],d=e[1],v={},nt=l(c,s);if(nt)continue;v[d]=f.getFormInstanceXML(t,undefined,{},u);r[s].push(v)}else f[customProperties.isValueInXmlEncoded]?(skelta.utilities.isUndefined(f[customProperties.embedFormTopLevelXmlNode])?g=f.getFormInstanceXML(t,undefined,{},u)[0]:(tt=f[customProperties.embedFormTopLevelXmlNode],it='{"'+tt+'":'+JSON.stringify(f.getFormInstanceXML(t,undefined,{},u)[0])+"}",g=JSON.parse(it)),r[f.xmlNodeBoundTo]=skelta.utilities.getXmlFromJSONObject(g)):r[f.xmlNodeBoundTo]=f.getFormInstanceXML(t,undefined,{},u);else f.getFormInstanceXML(t,r,{},u);else if(f.xmlNodeBoundTo&&f.xmlNodeBoundTo!==""&&"_value"in f){if(f.controlType==="Password"&&f.persistPassword===!1)f.xmlNodeBoundTo.startsWithString("@")?r[f.xmlNodeBoundTo.replace("@","_")]="":r[f.xmlNodeBoundTo]="";else if(f.controlType==="ActionBarItemCollection")rt=skelta.actionbar.getActionItemsFromWidget(),ut={ActionItems:{ActionItem:rt}},r[f.xmlNodeBoundTo]=SFU.getXmlFromJSONObject(ut);else if(f.xmlNodeBoundTo.containsString("/"))if(e=f.xmlNodeBoundTo.split("/"),e.length!==2)continue;else{var s=e[0],d=e[1],v={},nt=l(c,s);if(nt)continue;v[d]=f.value!=null?f.value:"";skelta.forms.utilities.isUndefined(r[s])?r[s]=[v]:r[s][0][d]=f.value!=null?f.value:""}else f.xmlNodeBoundTo.startsWithString("@")?f.controlType==="LookupInput"&&f.persistDisplayValue===!0?(r[f.xmlNodeBoundTo.replace("@","_")]=f.value!=null?f.value:"",r[skelta.forms.constants.lookupDefaults.persistDisplayValueAttribute+f.xmlNodeBoundTo.replace("@","")]=f.displayValue):r[f.xmlNodeBoundTo.replace("@","_")]=f.controlType==="Attachment"?skelta.attachment.getValueForInstanceXml(f):f.value!=null?f.value:"":f.controlType==="LookupInput"&&f.persistDisplayValue===!0?(y={},y[skelta.forms.constants.lookupDefaults.nodeAttributeName]=f.value!=null?f.value:"",y[skelta.forms.constants.lookupDefaults.persistDisplayValueAttribute+f.xmlNodeBoundTo]=f.displayValue,r[f.xmlNodeBoundTo]=y):f.controlType==="ExpressionEditor"?(p={},p[skelta.forms.constants.lookupDefaults.nodeAttributeName]=f.value!=null?f.value:"",p[skelta.forms.constants.expressionEditorDefaults.isExpressionAttribute]=f.isExpression,r[f.xmlNodeBoundTo]=p):r[f.xmlNodeBoundTo]=f.controlType==="Attachment"?skelta.attachment.getValueForInstanceXml(f):f.controlType==="Signature"?f.value===""?f.signature!=""?f.signature:"":f.value:f.value!=null?f.value:"";if(f.controlType==="DateTimeInput"&&f.id.containsString("gridESSignedOn")&&f.value===""&&u!=="@@FormNGFSaveAsDraft@@"){var ft=n.GetDateTimeInServerUTCFormat(new Date,!1),et=kendo.toString(ft,"MM/dd/yyyy HH:mm:ss");r[f.xmlNodeBoundTo]=et}}w>1?h.push(r):h=r}return h};t.BaseForm.prototype.makeReadOnlyForCollaborationMode=function(i){for(var r,u,e=this.records()[0].controls,f=0;f<e.length;f++)r=e[f],r instanceof t.BaseForm?r._readEditAddBehaviour(readEditBehaviourEnum.readOnly):r.dataContainerForm.isTopLevelForm===!0&&r.controlType==="FormButton"&&r.showAsFormLevelButton===!0||(n.isUndefined(r._readOnly)?n.isUndefined(r._enable)||r._enable(!1):r._readOnly(!0));u=this.findByXPath(i);!n.isUndefined(u)&&u instanceof t.BaseForm&&u._readEditAddBehaviour(readEditBehaviourEnum.editableWithoutParentPrecedence);this.initializeFocus(0)};t.TabControl=function(i,r,u,f,e,o,s,h){if(arguments.length!==0){var c=this;t.BaseForm.call(c,i,null,null,!1,f,baseFormViewMode.Default,null,null,null,null,null,null,e,o,s,h);skelta.BaseClass.call(c,t,"TabControl");c.isSelected=ko.observable(!1);c.tabIndex=ko.computed(function(){return c.isSelected()?"0":"-1"});n.isUndefined(c._isLoaded)||c._isLoaded()||(c.isSelectedSubscription=c.isSelected.subscribe(function(){n.isMobileDisplayMode(c)||setTimeout(function(){skelta.utilities.isUndefined(c.isSelectedSubscription)||(c._isReadyToLoad(!0),skelta.forms.delay.loader.scrollEventHandler(),c.isSelectedSubscription.dispose(),delete c.isSelectedSubscription)},0)}));c.addRecordFn=r;c.records([]);c.addRecord(u)}};n.inheritClass(t.TabControl,t.BaseForm);t.TabControl.prototype.getParentTabsContainerControl=function(){return n.isUndefined(this.parentForm)||n.isUndefined(this.parentForm.parentForm)?null:this.parentForm.parentForm};t.TabsContainerControl=function(n,i,r,u,f,e,o,s,h){if(arguments.length!==0){var c=this;c.selectedTabIndex=null;c.defaultTabIndex=skelta.utilities.isUndefined(f)?0:f;t.BaseForm.call(c,n,null,null,!1,u,baseFormViewMode.Default,null,null,null,null,null,null,e,o,s,h);skelta.BaseClass.call(c,t,"TabsContainerControl");c.Tabs=ko.computed(function(){return c.records().length>0?c.records()[0].controls:[]},c);c.addRecordFn=i;c.records([]);c.addRecord(r);c.selectDefaultTabIndex();c.subscribeToControls()}};n.inheritClass(t.TabsContainerControl,t.BaseForm);t.TabsContainerControl.prototype.selectTab=function(t){if(this.isValidTabIndex(t)){var i=this.selectedTabIndex;if(i!==null&&this.Tabs()[i].isSelected(!1),this.Tabs()[t].isSelected(!0),this.selectedTabIndex=t,!skelta.utilities.isUndefined(this.topLevelForm.onFormLoad)&&this.topLevelForm.onFormLoad===!1&&t!==i&&!n.isUndefined(this.onTabIndexChanged)&&this.onTabIndexChanged!=="")this.onTabIndexChanged(this)}skelta.forms.utilities.triggerResizeEvent(this)};t.TabsContainerControl.prototype.TraverseTab=function(n,t){var r,f,u,i;if(this.isValidTabIndex(n)){if(r=t.which||t.keyCode,f=0,t.shiftKey||t.ctrlKey||t.altKey)return!0;if(r==39||r==37)if(n=r==39?n+1:r==37?n-1:n,f=$(t.target).parent().parent()[0].childNodes.length,r==39&&f>n||r==37&&n>=0){if(u=!1,r==39){for(i=n;i<f;i++)if(skelta.utilities.isUndefined($($(t.target).parent().parent()[0].childNodes[i].childNodes[0]).parent()[0].attributes.style)||$($(t.target).parent().parent()[0].childNodes[i].childNodes[0]).parent().css("display")!=="none"){u=!0;n=i;break}if(!u)return!0}if(r==37){for(i=n;i>=0;i--)if(skelta.utilities.isUndefined($($(t.target).parent().parent()[0].childNodes[i].childNodes[0]).parent()[0].attributes.style)||$($(t.target).parent().parent()[0].childNodes[i].childNodes[0]).parent().css("display")!=="none"){u=!0;n=i;break}if(!u)return!0}$($(t.target).parent().parent()[0].childNodes[n].childNodes[0]).focus()}else return!0}this.selectTab(n)};t.TabsContainerControl.prototype.getIndexOfTabControl=function(t){var i=-1;return n.isUndefined(t)||(i=this.Tabs().indexOf(t)),i};t.TabsContainerControl.prototype.isValidTabIndex=function(t){return!n.isUndefined(t)&&t>=0&&t<this.Tabs().length?!0:!1};t.TabsContainerControl.prototype.getNextSelectableTabIndex=function(n){var i=null,r=this.Tabs(),u=r.length,t;if(n+1<u)for(t=n+1;t<u;t++)if(r[t]._visible()===!0){i=t;break}return i};t.TabsContainerControl.prototype.selectDefaultTabIndex=function(){ko.computed(function(){var i,t,r;this.topLevelForm.isFormLoaded()===!0&&this.isRecordRow!==!0&&(i=this.Tabs(),t=this.defaultTabIndex,i.length>0&&(r=-1,r=n.isUndefined(i[t])||i[t]._visible.peek()!==!0?t+1<i.length?this.getNextSelectableTabIndex(t):this.getNextSelectableTabIndex(-1):t,this.selectTab(r)))},this)};t.TabsContainerControl.prototype.subscribeToControls=function(){var i,t,r;if(!n.isUndefined(this.Tabs)&&this.Tabs().length>0)for(i=this.Tabs().length,t=0;t<i;t++)r=this,this.Tabs()[t]._visible.subscribe(function(){r.resetTabSelection()})};t.TabsContainerControl.prototype.resetTabSelection=function(){var i=this.Tabs(),n=this.selectedTabIndex,t;(skelta.utilities.isUndefined(n)&&(n=0),i[n]._visible()!==!0)&&(t=-1,t=n+1<i.length?this.getNextSelectableTabIndex(n):this.getNextSelectableTabIndex(-1),this.selectTab(t))}}(),skelta.forms.controls.findFunctions={isNotEmbeddedForm:function(n){return skelta.utilities.isObject(n)&&n.controlType!=="EmbeddedForm"?!0:!1}});$(document).ready(function(){var n=skelta.utilities;document.documentMode===11&&$("html").addClass("skie11");n.getCssCompatibility("webkitFlex")||n.getCssCompatibility("msFlex")||n.getCssCompatibility("flex")||$("html").addClass("skub");n.getCssCompatibility("MozBoxFlex")&&$("html").addClass("skum")});submitClickEvent.prototype.raise=function(n,t){for(var i=0,i=0;i<this.fn.length;i++)this.fn[i](n,t)};submitClickEvent.prototype.subscribe=function(n){this.fn[this.fn.length]=n};submitClickEvent.prototype.unsubscribe=function(n){for(var t=0,t=0;t<this.fn.length;t++)if(this.fn[t]==n){this.fn.splice(t,1);break}},function(){skelta.utilities.isUndefined(skelta.forms)&&skelta.createNamespace("skelta.forms");skelta.forms.validations=function(){function n(n,t,i,r,u){n.validationError(i);n.validationErrorMessage(skelta.localize.getString(r).replace("$$Name$$",t));n.validationErrorCode(u)}function h(n,t){var r="!#$%^&*()+={}[]|\\\"'<>?:;.,~`".split(""),i,u;if((t==="PanelForm"||t==="BaseForm"||t==="EmbeddedForm"||t==="PopupForm"||t==="ElectronicSignatureForm")&&(r.push("@"),r.push("/")),i=new ValidationOptions,i.isValid="",i.message="",n.indexOf("_")===0||n.indexOf("-")===0)return i.isValid=!1,i.message=skelta.localize.getString("FormNGFCannotStartsWithUnderScoreOrHyphen"),i;for(u=0;u<r.length;u++)if(n.indexOf(r[u])>=0){i.isValid=!1;i.message=skelta.localize.getString("FormNGFSpecialCharctersValidateXML");break}else i.isValid=!0,i.message="";return i}function c(n){var r="&<>".split(""),t=new ValidationOptions,i;for(t.isValid="",t.message="",i=0;i<r.length;i++)if(n.indexOf(r[i])>=0){t.isValid=!1;t.message=skelta.localize.getString("FormNGFSpecialCharctersValidateDisplayText");break}else t.isValid=!0,t.message="";return t}function l(n){var t=new ValidationOptions;return t.isValid="",t.message="",n.indexOf(" ")>=0?(t.isValid=!1,t.message=skelta.localize.getString("FormNGFNoSpaceValidateXML")):(t.isValid=!0,t.message=""),t}function a(n){var t=new ValidationOptions;return t.isValid="",t.message="",n.indexOf("@")>=1||!(n.indexOf("@")===n.lastIndexOf("@"))?(t.isValid=!1,t.message=skelta.localize.getString("FormNGFNoAtInMiddleValidateXML")):(t.isValid=!0,t.message=""),t}function v(n){var t=new ValidationOptions;return t.isValid="",t.message="",n.indexOf("0")==0||n.indexOf("1")==0||n.indexOf("2")==0||n.indexOf("3")==0||n.indexOf("4")==0||n.indexOf("5")==0||n.indexOf("6")==0||n.indexOf("7")==0||n.indexOf("8")==0||n.indexOf("9")==0?(t.isValid=!1,t.message=skelta.localize.getString("FormNGFCannotStartsWithDigitsXML")):(t.isValid=!0,t.message=""),t}function y(n){var t=new ValidationOptions;return t.isValid="",t.message="",n.length==0?(t.isValid=!0,t.message=""):n.indexOf("/")==0||n.indexOf("/")!=n.lastIndexOf("/")||n.lastIndexOf("/")===n.length-1?(t.isValid=!1,t.message=skelta.localize.getString("FormNGFNoDoubleFrontSlashXML")):n.indexOf("@")===0&&n.indexOf("/")>0?(t.isValid=!1,t.message=skelta.localize.getString("FormNGFAtTheRateInTheFrontWithSlash")):(t.isValid=!0,t.message=""),t}function p(n){var t=new ValidationOptions;return t.isValid="",n.indexOf("@")===0&&n.length===1||n.indexOf("@")===0&&n.length>1&&(n.indexOf("1")===1||n.indexOf("2")===1||n.indexOf("3")===1||n.indexOf("4")===1||n.indexOf("5")===1||n.indexOf("6")===1||n.indexOf("7")===1||n.indexOf("8")===1||n.indexOf("9")===1||n.indexOf("0")===1)?(t.isValid=!1,t.message=skelta.localize.getString("FormNGFInValidXmlNodeXML")):(t.isValid=!0,t.message=""),t}function w(n,t,i){var r=ko.utils.arrayFirst(t.records(),function(t){return t.findById(i).value===n});return skelta.utilities.isUndefined(r)?!1:!0}function b(n,t,i,r){var f=n.split(";#"),u=!0;return(u=k(f),f.length>1&&r=="Single")?!1:(u&&ko.utils.arrayForEach(f,function(n){var r=ko.utils.arrayFirst(t.records(),function(t){return t.findById(i).value===n});skelta.utilities.isUndefined(r)&&(u=!1)}),u)}function k(n){if(n.length>1){var t=ko.utils.arrayFilter(n,function(t){return n.indexOf(t)!==n.lastIndexOf(t)});if(t.length>0)return!1}return!0}function e(n,t,i,r){var u=new ValidationOptions,f;if(u.isValid=!0,u.message="",i!=null&&n!="")for(f=0;f<i.records().length;f++)if(i.records()[f]==t==!1&&i.records()[f].findById(r).value.trim()===n.trim()){u.isValid=!1;u.message=skelta.localize.getString("FormNGFEditControlRecordValidation");break}return u}function d(n,i,u,f,o){var s=new ValidationOptions,c,h;if(s=e(n,i,u,f,o),s.isValid){var y=i.WorkflowXmlLHS.dataSource,p=i.FormXmlRHS.dataSource,a=$(i.FormXmlRHS)[0].value,l=!1,v=!1;if(a!=""){if(c=t(a,p),c.length>0&&(v=c[0].type==""?!0:!1),h=t(n,y),v)h.length>0&&(l=h[0].type==""?!0:!1);else if(h.length>0&&(l=h[0].type!=""?!0:!1,l&&a!=""&&c.length>0&&c[0].type.trim()!=h[0].type.trim()&&!(r(c[0].type.trim())&&r(h[0].type.trim()))))return s.isValid=!1,s.message=skelta.localize.getString("FormNGFAddControlParentDataTypeValidation"),s;l||(s.isValid=!1,s.message=skelta.localize.getString("FormNGFAddControlParentValidation"))}}return s}function g(n,i){var u=new ValidationOptions,e,f;u.isValid=!0;u.message="";var c=i.WorkflowXmlLHS.dataSource,l=i.FormXmlRHS.dataSource,h=!1,o=!1,s=$(i.WorkflowXmlLHS)[0].value;if(s!=""){if(e=t(s,c),e.length>0&&(h=e[0].type==""?!0:!1),f=t(n,l),h)f.length>0&&(o=f[0].type==""?!0:!1);else if(f.length>0&&(o=f[0].type!=""?!0:!1,o&&s!=""&&e.length>0&&f[0].type.trim()!=e[0].type.trim()&&!(r(f[0].type.trim())&&r(e[0].type.trim()))))return u.isValid=!1,u.message=skelta.localize.getString("FormNGFAddControlParentDataTypeValidation"),u;o||(u.isValid=!1,u.message=skelta.localize.getString("FormNGFAddControlParentValidation"))}return u}function r(n){return!skelta.utilities.isUndefinedNullOrEmpty(n)&&(n=n.toLowerCase(),n==="[double]"||n==="[integer]"||n==="[int]"||n==="[long]"||n==="[decimal]")?!0:!1}function t(n,t){var i=n.replace("!",".").split("."),e=n.split("."),f,u,r;if(i.length>0)for(f=i[0],u=t.filter(function(n){return n.text==i[0]}),r=1;r<i.length;r++)f+=e.length!=i.length?r<e.length?"."+i[r]:"!"+i[r]:"."+i[r],u=u.length>0?u[0].items.filter(function(n){return n.value==f}):u;return u}function nt(n){var r="@!#%^&*()+={}[]|\\\"'<>?:;.,~`_ //".split(""),t=new ValidationOptions,i;for(t.isValid="",t.message="",i=0;i<r.length;i++)if(n.indexOf(r[i])>=0){t.isValid=!1;t.message=skelta.localize.getString("FormNGFSpecialCharactersFormParameterValidate");break}else t.isValid=!0,t.message="";return t}function u(n,t,i){var r=new ValidationOptions;if(r.isValid=!0,r.message="",n==="")return r;if(typeof n=="string"){var f=skelta.utilities.isUndefined(n)?n:n.replace("AM","").replace("PM",""),e=new RegExp(t),u=e.test(f);u||(r.isValid=u,r.message=skelta.localize.getString(i))}return r}function tt(n){var i=c(n),t=new ValidationOptions;return t.isValid=i.isValid,t.message="",i.isValid||(t.message=skelta.localize.getString("specialCharcters_Space_Validation_Widget")),t}function it(n,t,r){var s,u,h,e,o;if(n)if(s=t.isMultipleEmail,u=n,s===!1)u=u.trim(),u!==""&&u!==null&&(e=new RegExp(f),o=e.test(u),o||(t.validationError(!0),t.validationErrorMessage(skelta.localize.getString(r.errorMessage).replace("<@Name@>",t._tagName.peek())),t.validationErrorCode(errorConstants.valueValidationRules)));else if(s===!0&&(h=u.split(";"),u!==""&&u!==null))for(i=0;i<h.length;i++)if(e=new RegExp(f),o=e.test(h[i].trim()),!o){t.validationError(!0);t.validationErrorMessage(skelta.localize.getString(r.errorMessage).replace("<@Name@>",t._tagName.peek()));t.validationErrorCode(errorConstants.valueValidationRules);break}}function rt(n,t,i){if(n){var r=i.errorMessage.split("#");t.maxLength>0&&n.length>t.maxLength&&(t.validationError(!0),t.validationErrorMessage(skelta.localize.getString(r[0]).replace("<@MaxLength@>",t.maxLength.toString())),t.validationErrorCode(errorConstants.valueValidationRules))}}function ut(n,t,i){if(n&&t.attachmentStorageType!=0&&t.allowMultipleAttachments){var r=i.errorMessage.split("#");t._fileList.peek().length>t.maximumAttachments&&(t.validationError(!0),t.validationErrorMessage(skelta.localize.getString(r[0]).replace("<@value@>",t.maximumAttachments.toString())),t.validationErrorCode(errorConstants.valueValidationRules))}}function ft(n,t,i){if(n&&(t.controlType!=="Password"||t.securityMode===0)){var r=i.errorMessage.split("#");t.maxLength>0&&n.length>t.maxLength?(t.validationError(!0),t.validationErrorMessage(skelta.localize.getString(r[0]).replace("<@MaxLength@>",t.maxLength.toString())),t.validationErrorCode(errorConstants.valueValidationRules)):n.length<t.minLength&&(t.validationError(!0),t.validationErrorMessage(skelta.localize.getString(r[1]).replace("<@MinLength@>",t.minLength.toString())),t.validationErrorCode(errorConstants.valueValidationRules))}}function et(t,i,r){if(i.controlType!=="Password"||i.securityMode===0)if(t){var u=new RegExp(i.pattern),f=u.test(t);f?n(i,"",!1,"",errorConstants.None):n(i,i._tagName.peek(),!0,r.errorMessage,errorConstants.controlSpecificValidation)}else i.validationErrorMessage().toString()==skelta.localize.getString(r.errorMessage)&&n(i,"",!1,"",errorConstants.None)}function ot(t,i,r){if(i.renderMode==="NonHtml5"){var u=parseFloat(t),f=i._tagName.peek(),e=i.xmlNodeBoundTo;isNaN(u)||(e==="MaxValue"||e==="MinValue"?u>=numberRange.minimumValue&&u<=numberRange.maximumValue||n(i,f,!0,r.errorMessage,errorConstants.valueValidationRules):u>=i.min&&u<=i.max||n(i,f,!0,r.errorMessage,errorConstants.valueValidationRules))}}function st(n,t){if(n){var i=skelta.utilities.isNumber(n,!0);i||(t.isValidValue=!1,t.validationErrorCode(errorConstants.valueValidationRules))}}function ht(n){var t=new ValidationOptions;return t.isValid=!0,t.message="",n.indexOf('"')>=0||n.indexOf("'")>=0?(t.isValid=!1,t.message=skelta.localize.getString("FormNGFTagNameNoQuotes")):(t.isValid=!0,t.message=""),t}function ct(n,t){var r=h(n,t),u=l(n),f=a(n),e=v(n),o=y(n),s=p(n),i=new ValidationOptions;return i.isValid=!0,i.message="",r.isValid&&u.isValid&&f.isValid&&e.isValid&&o.isValid&&s.isValid?(i.isValid=!0,i.message=""):(r.isValid?u.isValid?f.isValid?e.isValid?o.isValid?s.isValid||(i.message=s.message):i.message=o.message:i.message=e.message:i.message=f.message:i.message=u.message:i.message=r.message,i.isValid=!1),i}function lt(n){var t=new ValidationOptions;return t.isValid=!0,t.message="",n.length>50&&(t.isValid=!1,t.message=skelta.localize.getString("FormNGFTitleForAddDelete")),t}function at(n){var t=new ValidationOptions;return t.isValid=!0,t.message="",n=parseInt(n),n>100&&(t.isValid=!1,t.message=skelta.localize.getString("FormNGFPopupDimensionMessage")),t}function vt(n,t,i){var r=new ValidationOptions;return r.isValid=!0,r.message="",n>t&&(r.isValid=!1,r.message=skelta.localize.getString("FormNGFIsMinRowGreaterThanMaxRow")),n<t&&viewModelObject&&(viewModelObject.findById(i).validationErrorMessage(""),viewModelObject.findById(i).validationError(!1)),r}function yt(n,t,i){var e=i.split(","),r=new ValidationOptions,o,s,f,u;if(r.isValid=!0,r.message="",n!==""){if(o=new RegExp("^[^!=|~\\s@#$%^&*()+`\\-\\\\{}:\\\"<>?\\[\\];',./_\\d][^!=|~\\s@#$%^&*()+`\\-\\\\{}:\\\"<>?\\[\\];',./]+$"),s=o.test(n),!s)return r.isValid=!1,r.message=skelta.localize.getString("Form_IW_XmlVariable_ValidationError"),r;if(n.toUpperCase()==="SFFORMDATA"||n.toUpperCase()==="SKEVENTDATA")return r.isValid=!1,r.message=skelta.localize.getString("Form_IW_XmlVariable_NotAllowed_Error"),r;if(!skelta.utilities.isUndefined(t)&&(f=t.options,f.length>0))for(u=0;u<f.length;u++)if(f[u].optionvalue===n)return r.isValid=!1,r.message=skelta.localize.getString("Form_IW_XmlVariable_AlreadyInDropDown_Error"),r;for(u=0;u<e.length;u++)if(e[u]===n)return r.isValid=!1,r.message=skelta.localize.getString("Form_IW_XmlVariable_AlreadyInDropDown_Error"),r}return r}function pt(n,t,i){var r=new ValidationOptions;return r.isValid=!0,r.message="",t<n&&(r.isValid=!1,r.message=skelta.localize.getString("FormNGFIsMaxRowLessThanMinRow")),t>n&&viewModelObject&&(viewModelObject.findById(i).validationErrorMessage(""),viewModelObject.findById(i).validationError(!1)),r}function wt(n){var t=new ValidationOptions;return t.isValid=!0,t.message="",(n<0||n>10)&&(t.isValid=!1,t.message=skelta.localize.getString("FormNGFOptionCountValidation")),t}function bt(n,t,i){var r=new ValidationOptions;return r.isValid=!0,r.message="",n!=""&&t.records().length>0&&(w(n,t,i)||(r.isValid=!1,r.message=skelta.localize.getString("FormNGFEditControlDefaultValueValidation"))),r}function kt(n,t,i,r){var u=new ValidationOptions;return u.isValid=!0,u.message="",n!=""&&t.records().length>0&&(b(n,t,i,r)||(u.isValid=!1,u.message=skelta.localize.getString("FormNGFInputNotInValue"))),u}function o(n,t,i,r){var u=new ValidationOptions;return u.isValid=!0,u.message="",e(n,t,i,r,!0)}function dt(n,t,i,r){var u=new ValidationOptions;return u.isValid=!0,u.message="",d(n,t,i,r,!0)}function gt(n,t){for(var u,i,f=$("<div/>").html(n),r=0;r<t.length;r++)for(u=f[0].querySelectorAll(t[r]),i=0;i<u.length;i++)$(u[i]).remove();return f.html()}function ni(n,t,i,r){var u=new ValidationOptions;return u.isValid=!0,u.message="",g(n,t,i,r,!0)}function ti(n){var t=new ValidationOptions;return t.isValid=!0,t.message="",n<4&&(t.isValid=!1,t.message=skelta.localize.getString("FormNGFMinRowsNotZero")),t}function ii(n,t,i){var r=new ValidationOptions,u,f;return r.isValid=!0,r.message="",u=Number(t),f=Number(n),u<f&&(r.isValid=!1,r.message=skelta.localize.getString("FormNGFIsMaxLessThanMinNumber")),u>=f&&viewModelObject&&(viewModelObject.findById(i).validationErrorMessage(""),viewModelObject.findById(i).validationError(!1),viewModelObject.findById(i).validationErrorCode(errorConstants.validationScript)),r}function ri(n,t,i){var r=new ValidationOptions;return r.isValid=!0,r.message="",n=parseInt(n),t=parseInt(t),t<n&&(r.isValid=!1,r.message=skelta.localize.getString("FormNGFIsMaxLengthLessThanMinLength")),t>=n&&viewModelObject&&(viewModelObject.findById(i).validationErrorMessage(""),viewModelObject.findById(i).validationError(!1),viewModelObject.findById(i).validationErrorCode(errorConstants.validationScript)),r}function ui(n,t,i){var r=new ValidationOptions;return r.isValid=!0,r.message="",n=parseInt(n),t=parseInt(t),n>t&&(r.isValid=!1,r.message=skelta.localize.getString("FormNGFIsMinLengthGreaterThanMaxLength")),n<=t&&viewModelObject&&(viewModelObject.findById(i).validationErrorMessage(""),viewModelObject.findById(i).validationError(!1),viewModelObject.findById(i).validationErrorCode(errorConstants.validationScript)),r}function fi(n,t,i){var r=new ValidationOptions;return r.isValid=!0,r.message="",n instanceof Date||(n=new Date(n)),t instanceof Date||(t=new Date(t)),t<n&&(r.isValid=!1,r.message=skelta.localize.getString("FormNGFIsMaxLessThanMin")),t>=n&&viewModelObject&&(viewModelObject.findById(i).validationErrorMessage(""),viewModelObject.findById(i).validationError(!1),viewModelObject.findById(i).validationErrorCode(errorConstants.validationScript)),r}function ei(n,t,i){var r=new ValidationOptions;return r.isValid=!0,r.message="",n instanceof Date||(n=new Date(n)),t instanceof Date||(t=new Date(t)),n>t&&(r.isValid=!1,r.message=skelta.localize.getString("FormNGFIsMinGreaterThanMax")),n<=t&&viewModelObject&&(viewModelObject.findById(i).validationErrorMessage(""),viewModelObject.findById(i).validationError(!1),viewModelObject.findById(i).validationErrorCode(errorConstants.validationScript)),r}function oi(t,i,r){var f,e;if(t){var o=i.dateFormat===""?kendo.culture().calendar.patterns.d:i.dateFormat,s=kendo.culture().calendar.patterns.d,u=[];i.dateFormat||u.push(s);i.renderMode==="NonHtml5"&&i.dateFormat&&u.push(i.dateFormat);date=kendo.parseDate(t,u);date==null&&(f=i._tagName.peek(),e=skelta.localize.getString(r.errorMessage).replace("$$Name$$",i._tagName.peek()).replace("$$Format$$",o),n(i,f,!0,e,errorConstants.uiValidationRules))}}function si(n,t){if(n){var i=kendo.parseDate(n,"MM/dd/yyyy 00:00:00");i==null&&(t.isValidValue=!1,t.validationErrorCode(errorConstants.valueValidationRules))}}function hi(t,i,r){if(t){var e=i._tagName.peek(),f=i.xmlNodeBoundTo,u=t;typeof u=="string"&&u&&(u=kendo.parseDate(u,"MM/dd/yyyy 00:00:00","en-US"));f==="MinDate"||f==="MaxDate"?u>=skelta.forms.constants.dateRange.minimumValue&&u<=skelta.forms.constants.dateRange.maximumValue||n(i,e,!0,r.errorMessage,errorConstants.valueValidationRules):u<=i.max&&u>=i.min||(i.validationError(!0),i.validationErrorMessage(skelta.localize.getString(r.errorMessage).replace("$$Name$$",i._tagName.peek())),i.validationErrorCode(errorConstants.valueValidationRules))}}function ci(n,t,i){skelta.utilities.isUndefined(t.isMandatory)||t.isMandatory===!1||(skelta.utilities.isUndefined(n)||n==="")&&(t.validationError(!0),t.validationErrorMessage(skelta.localize.getString(i.errorMessage).replace("$$Name$$",t._tagName.peek())),t.validationErrorCode(errorConstants.mandatory))}function li(n){var i=SFU.getDateForTime(n,":"),t=new ValidationOptions;return t.isValid=!0,t.message="",t.isValid&&(t=u(n,"^[01]?[0-9]$|^2[0-3]$|^[01]?[0-9]:[0-5]?[0-9]$|^2[0-3]:[0-5]?[0-9]$|^[01]?[0-9]:[0-5]?[0-9]:[0-5]?[0-9]$|^2[0-3]:[0-5]?[0-9]:[0-5]?[0-9]$","FormNGFInvalidIntervalValue")),i!==null&&i.getHours()+i.getMinutes()+i.getSeconds()===0&&(t.isValid=!1,t.message=skelta.localize.getString("FormNGFZeroIntervalValue")),t}function ai(t,i,r){var f,e;if(t!==""){var o=i.timeFormat===""?kendo.culture().calendar.patterns.t:i.timeFormat,s=kendo.culture().calendar.patterns.t,u=[];i.timeFormat||u.push(s);i.renderMode==="NonHtml5"&&i.timeFormat&&u.push(i.timeFormat);date=kendo.parseDate(t,u);date==null&&(f=i._tagName.peek(),e=skelta.localize.getString(r.errorMessage).replace("$$Name$$",i._tagName.peek()).replace("$$Format$$",o),n(i,f,!0,e,errorConstants.uiValidationRules))}}function vi(n,t){if(n!==""){var i="HH:mm:ss",r=kendo.parseDate(n,i);r==null?(t.isValidValue=!1,t.validationErrorCode(errorConstants.valueValidationRules)):s(n,i)===!1&&(t.isValidValue=!1,t.validationErrorCode(errorConstants.valueValidationRules))}}function s(n){var t=u(n,"^[01]?[0-9]$|^2[0-3]$|^[01]?[0-9]:[0-5]?[0-9]$|^2[0-3]:[0-5]?[0-9]$|^[01]?[0-9]:[0-5]?[0-9]:[0-5]?[0-9]$|^2[0-3]:[0-5]?[0-9]:[0-5]?[0-9]$","FormNGFInvalidIntervalValue");return t.isValid}function u(n,t,i){var r=new ValidationOptions,f,u;return(r.isValid=!0,r.message="",n==="")?r:(typeof n=="string"&&(n=n.trim(),f=new RegExp(t),u=f.test(n),u||(r.isValid=u,r.message=skelta.localize.getString(i))),r)}function yi(n,t){var i=new ValidationOptions;i.isValid=!0;i.message="";var r=n.split(":"),f=new Date(0001,1,1,r[0],r[1],r[2],0),u=t.split(":"),e=new Date(0001,1,1,u[0],u[1],u[2],0);return f>e?(i.isValid=!1,i.message=skelta.localize.getString("FormNGFIsMinGreaterThanMaxNumber")):e<f&&(i.isValid=!1,i.message=skelta.localize.getString("FormNGFIsMaxLessThanMinNumber")),i}function pi(t,i,r){var e;if(t){var f="HH:mm:ss",o=kendo.parseDate(i.min,f,"en-US"),s=kendo.parseDate(i.max,f,"en-US"),u=t;u=typeof t=="string"?kendo.parseDate(t,f,"en-US"):new Date(1,1,1,u.getHours(),u.getMinutes(),u.getSeconds());u<=s&&u>=o||(e=i._tagName.peek(),n(i,e,!0,r.errorMessage,errorConstants.valueValidationRules))}}function wi(n,t,i,r){var u=new ValidationOptions,f,e;return(u.isValid=!0,u.message="",f=nt(n),f.isValid===!1)?(u.isValid=!1,u.message=skelta.localize.getString("FormNGFSpecialCharactersFormParameterValidate"),u):(e=o(n,t,i,r),e.isValid===!1?(u.isValid=!1,u.message=skelta.localize.getString("FormNGFEditControlDuplicateFormParamValidation")):u.isValid=!0,u)}function bi(t,i,r){var u,f,e,o;t!==""&&(u=skeltaUtils.GetDateTimeFormat(i),f=kendo.parseDate(t,u),f==null&&(e=i._tagName.peek(),o=skelta.localize.getString(r.errorMessage).replace("$$Name$$",i._tagName.peek()).replace("$$Format$$",u),n(i,e,!0,o,errorConstants.uiValidationRules)))}function ki(n,t){var r,u,i;n!==""&&(r="MM/dd/yyyy HH:mm:ss",u=kendo.parseDate(n,r),u==null?(t.isValidValue=!1,t.validationErrorCode(errorConstants.valueValidationRules)):(i=n.split(" "),(i.length>2||i.length>1&&s(i[1],r)===!1)&&(t.isValidValue=!1,t.validationErrorCode(errorConstants.valueValidationRules))))}function di(n,t,i){if(n){var r=n;typeof r=="string"&&r&&(r=kendo.parseDate(r,skelta.forms.constants.dateFormats.dateTimeFormatForCoreValue,"en-US"));(t.max!==""&&r>kendo.parseDate(t.max,skelta.forms.constants.dateFormats.dateTimeFormatForCoreValue,"en-US")||t.min!==""&&r<kendo.parseDate(t.min,skelta.forms.constants.dateFormats.dateTimeFormatForCoreValue,"en-US"))&&(t.validationError(!0),t.validationErrorMessage(skelta.localize.getString(i.errorMessage).replace("$$Name$$",t._tagName.peek())),t.validationErrorCode(errorConstants.valueValidationRules))}}function gi(n){var t=new ValidationOptions;return t.isValid=!0,t.message="",t.isValid&&(t=u(n,"^(http://|https://|\\<BPMUITemplates\\>)","FormNGFInvalidURLValue")),t}function nr(n){var t=new ValidationOptions;return t.isValid=!0,t.message="",t.isValid&&(t=u(n,"^[A-Za-z][A-Za-z0-9]*$","FormNGFInvalidIdentifierValue")),t}var f="^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$";return{emailValidator:it,emailMaxLengthValidator:rt,attachmentMaximumValidator:ut,minMaxLengthValidator:ft,patternValidator:et,minMaxNumberValidator:ot,numberInvalidValueValidator:st,tagNameValidator:ht,xmlNodeBoundToValidator:ct,addDeleteTitleValidator:lt,popupDimensionValidator:at,baseFormMinMaxValidator:vt,ValidateXmlVariable:yt,baseFormMaxMinValidator:pt,optionCountValidator:wt,editControlDefaultValueValidator:bt,editControlDefaultValueMultipleEntryValidator:kt,editControlGridValidator:o,addControlParentValidation:ni,addControlParentLHSValidation:dt,removeTags:gt,ParentNodeValidationsCheck:t,editMinimumRowsValidator:ti,numberMinMaxValidator:ii,textInputMaxLengthValidator:ri,textInputMinLengthValidator:ui,dateInputMaxDateValidator:fi,dateInputMinDateValidator:ei,dateUIValueValidator:oi,dateCoreValueValidator:si,dateInputMinMaxValidator:hi,mandatoryValidator:ci,timeInputIntervalValdiator:li,timeInputMinMaxValidator:yi,timeInputUIValueValidator:ai,timeInputCoreValueValidator:vi,timeInputMinMaxRangeValidator:pi,formParamterValidator:wi,dateTimeUIValueValidator:bi,dateTimeCoreValueValidator:ki,dateInputTimeMinMaxValidator:di,urlValdiator:gi,cssIdentifierValidation:nr,widgetStylePropertiesValidation:tt}}();SFV=skelta.forms.validations}();skeltaUtils=skelta.forms.utilities;logger=skeltaUtils.getLogger();PopupCollection=function(){var n=this;n.currentPopupItem;n.zIndex=3e5;n.show=function(t,i,r,u,f,e,o){var h,s,c="",l=null,w=function(){var a,l,y,r,o;if(s.templateDivObj.attr("class",c),s.templateDivObj.attr("style",v),s.templateDivObj.attr("data-bind","template: { name: '"+f+"'}"),ko.applyBindings(h,s.templateDivObj[0]),t==="BaseForm"||i.controlType==="Tab"){for(a=h.findAllByType("Grid"),r=0;r<a.length;r++)o=a[r],o.enableResponsiveView==="False"&&(l=$(s.templateDivObj[0]).find(":not(."+cssClasses.control+")[controlid='"+o.id+"']"),!skeltaUtils.isUndefined(l)&&l.length>0&&skelta.grid.applyBindingsToGridControl(o,l));for(y=i.controlType==="Tab"?i.records()[0].controls:i.controls,r=0;r<y.length;r++)o=y[r],o.controlType==="Signature"&&skelta.signature.initializeSignature(o)}if(h.isRecordRow?h.parentForm.visible=!0:t!=="PopupForm"&&(h.visible=!0),t==="UserLookup"||t==="RoleLookup"){try{s.templateDivObj.find("#pageSearch").attr("data-skpop","1")}catch(p){logger.logError(p.message)}h.selectedControlName(i._tagName())}s.templateControlName(t);s.eventType("");s.data=e;s.state("open");n.currentPopupItem=s;(t==="UserLookup"||t==="RoleLookup")&&$("#NF1ULSearchBox").focus();(t==="PopupForm"||t==="ReportViewer")&&(u.topLevelForm.popupObjectItem=null,u.topLevelForm.popupObjectItem=n.currentPopupItem)},v,y,a,p;if(n.zIndex++,v="z-index: "+n.zIndex.toString(),t==="BaseForm")for(l=$("#templateDiv_"+o),c="skbft",y=!1,a=i.parentForm;!skeltaUtils.isUndefined(a);){if(!skeltaUtils.isUndefined(a.controlType)&&a.controlType==="Tab"){y=!0;break}a=a.parentForm}else if(t==="Tabs")l=$("#tabTemplateDiv_"+o),c="skbft";else if(t==="ReportViewer"){if(u._reportUrlValue().containsString("showError(")||u._reportUrlValue().containsString("alert(")){p=new Function("SFU","control",u._reportUrlValue());p(skelta.forms.utilities,u);return}l=$("#popuptemplate_"+o);c="popuptemplate"}else if(t==="PopupForm"){if(!skeltaUtils.isUndefined(i.enable)&&i.enable===!1)return;i.loaderIconState("1");l=$("#popupFormTemplate_"+o);c="popuptemplate"}else{if(!skeltaUtils.isUndefined(i.enable)&&i.enable===!1||!skeltaUtils.isUndefined(i.readOnly)&&i.readOnly===!0)return;l=$("#popuptemplate_"+o);c="popuptemplate"}s=addPopup(f,null,r,i);s.templateDivObj=l;h=t==="BaseForm"||t==="Tabs"||t==="ReportViewer"||t==="PopupForm"?u:u(s);s.templateObject=h;(t==="UserLookup"||t==="RoleLookup")&&(h.value="");ko.cleanNode(s.templateDivObj[0]);skelta.forms.utilities.resetIframeControls(s.templateDivObj,function(){w()})};addPopup=function(n,t,i,r){var u=new popupObject(n,t);return u.subscriberFn=i,u.controlSender=r,u}},function(){if(skelta.utilities.isUndefined(skelta.tree)){var i={noData:skelta.localize.getString("FormNGFTreeContainsNoData")},t={none:0,single:1},n={listSeparator:skelta.forms.utilities.getMultiValueSeperator()},r=function(){function e(n){var i=n.lookupName,t=n.parameterCollection;if(n.bound=!1,i===""){n._source(null);return}t.length>0?SFU.subscribeToControlParameters(n,t,function(){f(n)}):f(n);n.refreshTree=function(){f(this)}}function o(n,r){if((n.node&&r._checkBehavior!==t.none&&u(r,n.sender,n.node),r.bound!==!0)&&(r.bound=!0,n.sender.options.checkboxes&&(n.sender.options.checkboxes.template=function(n){var t=!skelta.utilities.isUndefined(n.item.id)&&r._internal.indexOf(n.item.id.toString())>=0;return n.item.checked=t,"<input type='checkbox' "+(n.item.hideCheckbox!==undefined&&n.item.hideCheckbox!==!1?"style='visibility:hidden;'":"")+(n.item.enabled===!1?"disabled":"")+" "+(t?"checked":"")+" />"}),r._source().length===0)){var f={enabled:!1};f.text=i.noData;f.hideCheckbox=!0;r._source().push(f);return}}function s(n,t){if(t.onSelectHandler!==undefined)t.onSelectHandler(n.sender.dataItem(n.node)._data,t)}function h(n,i){if(i.onCheckHandler){var r=n.sender.dataItem(n.node);i.onCheckHandler(r._data,i,r.checked)}i._checkBehavior===t.single?a(i,n.sender,n.sender.dataItem(n.node)):i.childrenInheritCheckedState&&v(n.sender,i,n.sender.dataItem(n.node));y(n.sender,i);u(i,n.sender,n.sender.parent(n.node))}function c(t,i){t.uiValue=i;t._internal=i.split(n.listSeparator)}function l(t,i){t.value=i;t._internal=i.split(n.listSeparator)}function a(n,t,i){var f=t.dataSource.data();r(f,function(r){var e=r.checked,f;if(r!==i){if(f=r.get("checked"),r.set("checked",!1),n.onCheckHandler&&f!==!1)n.onCheckHandler(r._data,n,!1);e&&u(n,t,t.findByUid(r.uid))}})}function v(n,t,i){var u=i.hasChildren&&i.children.data();r(u,function(n){var r=n.get("checked");if(n.set("checked",i.checked),t.onCheckHandler&&r!==i.checked)t.onCheckHandler(n._data,t,i.checked)})}function y(t,i){var f=t.dataSource.data(),u=[];r(f,function(n){n.checked&&u.push(n.id)});i.uiValue=u.join(n.listSeparator)}function f(n){var r=n.lookupName,u=SFU.getLookupParameterValues(n,n.parameterCollection),t=SFU.getLookupSchemaAndData(r,u,!0),i;if(SFU.isUndefinedNullOrEmpty(t.Data)&&(t.Data=[]),i=p(t.Data,n,n._nodeIdColumnName(),n._nodeParentColumnName(),n._nodeDisplayColumn(),n._nodeCheckedColumnName(),n._expandNodes()),n.onDataBoundHandler)n.onDataBoundHandler(i,n);SFU.isUndefined(t)||n._source(i)}function p(t,i,r,u,f,e,o){r||(r="id");u||(u="parent");var h=[],c=[],s={};return t.forEach(function(n){var t={_data:n,expanded:o};t.id=n[r];t.text=n[f];t.imageUrl=null;n[e]&&c.push(t.id);t._parentId=n[u];s[n[r]]=t}),t.forEach(function(n){var i=s[n[r]],t=s[n[u]];t?(t.items===undefined&&(t.items=[]),t.items.push(i)):h.push(i)}),i.value=c.join(n.listSeparator),h}function r(n,t){for(var u,f,i=0;i<n.length;i++)u=n[i],f=u.hasChildren&&u.children.data(),t(u),f&&r(f,t)}function u(n,t,i){var f;if(i!==undefined&&i!==null&&i.length!==0){var r=i.children("div").find(".k-checkbox :checkbox"),o=i.children("ul").find(".k-checkbox :checkbox"),e=0;o.each(function(n,t){t.checked&&e++});f=t.dataItem(i).checked;e===0?(r.prop("indeterminate",!1),r.data("indeterminate",!1),r.prop("checked",f)):e===o.length?f?(r.prop("indeterminate",!1),r.data("indeterminate",!1),r.prop("checked",!0)):(r.prop("indeterminate",!0),r.data("indeterminate",!0)):f||(r.prop("indeterminate",!0),r.data("indeterminate",!0),r.prop("checked",!1));u(n,t,t.parent(i))}}return{initialize:e,onDataBound:o,onNodeSelect:s,onNodeChecked:h,updateCoreValue:l,updateUIValue:c}}();skelta.tree=r}}(),function(){if(skelta.utilities.isUndefined(skelta.gauge)){var n=function(){function t(t){if(Array.isArray(t.ranges)||(t.ranges=[]),t.onInit!==undefined)t.onInit(t);t.ranges.length===0&&(t.ranges=[{from:t.scaleMin,to:t.scaleMax,color:"#dedede",colorIndicator:!1}]);t.locale=skelta.userContext.getUserContextFor("culture");t.widget=ko.observable();t.labelUnitOfMeasure&&t.labelUnitOfMeasure.slice(0,2)=="@@"&&(t.labelUnitOfMeasure=skelta.localize.getString(t.labelUnitOfMeasure));var i=t._value;t._value=ko.computed({read:function(){return i()},write:function(n){n<t.scaleMin?i(t.scaleMin):n>t.scaleMax?i(t.scaleMax):i(n)}});t._value.subscribe(function(i){n(t,i)}.bind(t));n(t,t.value);t.pointerConfig=ko.computed(function(){var i=t.showTargetIndicator,n=[];return n.push({color:t.pointerColor,value:t._value.peek(),cap:{size:.075}}),i?n.push({value:t.targetValue,color:"red",cap:{size:.002}}):t.widget()!==undefined&&t.widget().options.pointer.length>1&&t.widget().options.pointer.splice(1,1),n});t.gaugeConfig=ko.computed(function(){var n=parseInt(t.width),i=parseInt(t.height);return n=n>0?n:250,i=i>0?i:250,{width:n,height:i,margin:0}});t.scaleConfig=ko.computed(function(){return{ranges:t.ranges,startAngle:parseInt(t.scaleAngleStart),endAngle:parseInt(t.scaleAngleEnd),max:parseInt(t.scaleMax),min:parseInt(t.scaleMin),minorUnit:parseInt(t.minorUnit),majorUnit:parseInt(t.majorUnit)}});t.displayLabel=ko.computed(function(){var n=parseFloat(t.value),i;return isNaN(n)&&(n=0),i=parseInt(t.valuePrecision),n=kendo.toString(n,"n"+i,kendo.cultures[t.locale]),t.labelUnitOfMeasure&&(n+=" "+t.labelUnitOfMeasure),n})}function i(n,t){return n=Number(n),t=Number(t),n<t?new ValidationOptions(!1,strings.FormNGFGaugeMaxMustBeGtMin.replace("$$min$$",t)):void 0}function r(n,t){return n=Number(n),t=Number(t),n>=t?new ValidationOptions(!1,strings.FormNGFGaugeMinMustBeLtMax.replace("$$max$$",t)):void 0}function u(n,t){return n=Number(n),t=Number(t),n<t?new ValidationOptions(!1,strings.FormNGFGaugeAngleEndMustBeGtAngleStart.replace("$$min$$",t)):void 0}function f(n,t){return n=Number(n),t=Number(t),n>=t?new ValidationOptions(!1,strings.FormNGFGaugeAngleStartMustBeLtAngleEnd.replace("$$max$$",t)):void 0}function e(n,t,i,r){if(n=Number(n),r=Number(r),t=Number(t),i=Number(i),n<r)return new ValidationOptions(!1,strings.FormNGFGaugeMajorUnitMustBeGtMinorUnit.replace("$$min$$",r));var u=(t-i)/n;if(u>100)return new ValidationOptions(!1,strings.FormNGFGaugeMajorTicksExceedsLimit.replace("$$limit$$",100))}function o(n,t,i,r){if(n=Number(n),r=Number(r),t=Number(t),i=Number(i),n>r)return new ValidationOptions(!1,strings.FormNGFGaugeMinorUnitMustBeLtMajorUnit.replace("$$max$$",r));var u=(t-i)/n;if(u>200)return new ValidationOptions(!1,strings.FormNGFGaugeMinorTicksExceedsLimit.replace("$$limit$$",200))}function n(n,t){var i,f,u,r;skelta.utilities.isUndefinedNullOrEmpty(n.widget())||n.value==""||n.widget().value(n.value);i="black";f=n.ranges.some(function(n){if(n.from<=t&&n.to>=t)return n.colorIndicator!==undefined&&n.colorIndicator===!1?!1:(i=n.color,!0)});i!=n.pointerColor&&(u=n.widget(),u===undefined?n.pointerColor=i:(r=u.pointers[0],r.elements.children[0].fill(i,1),r.elements.children[0].stroke(i,1),r.elements.children[1].fill(i,1),r.elements.children[1].stroke(i,1),n.pointerColor=i))}strings={FormNGFGaugeMaxMustBeGtMin:skelta.localize.getString("FormNGFGaugeMaxMustBeGtMin"),FormNGFGaugeAngleEndMustBeGtAngleStart:skelta.localize.getString("FormNGFGaugeAngleEndMustBeGtAngleStart"),FormNGFGaugeMinorUnitMustBeLtMajorUnit:skelta.localize.getString("FormNGFGaugeMinorUnitMustBeLtMajorUnit"),FormNGFGaugeMinMustBeLtMax:skelta.localize.getString("FormNGFGaugeMinMustBeLtMax"),FormNGFGaugeMajorUnitMustBeGtMinorUnit:skelta.localize.getString("FormNGFGaugeMajorUnitMustBeGtMinorUnit"),FormNGFGaugeAngleStartMustBeLtAngleEnd:skelta.localize.getString("FormNGFGaugeAngleStartMustBeLtAngleEnd"),FormNGFGaugeMajorTicksExceedsLimit:skelta.localize.getString("FormNGFGaugeMajorTicksExceedsLimit"),FormNGFGaugeMinorTicksExceedsLimit:skelta.localize.getString("FormNGFGaugeMinorTicksExceedsLimit")};return{initialize:t,validateScaleMin:r,validateScaleMax:i,validateScaleAngleStart:f,validateScaleAngleEnd:u,validateScaleMajorUnit:e,validateScaleMinorUnit:o}}();skelta.gauge=n}}(),function(){if(skelta.utilities.isUndefined(skelta.actionbar)){var t={onlyOneLevel:skelta.localize.getString("FormsNGFActionBarTreeNodeValidation")},n=function(){function r(n){if(n._actionItems.length===0){this.itemNumber=0;var t=this.defaultNode(SFU.getGuId());n._actionItems.push(t);setTimeout(function(){var n=$("[data-role='treeview']").data("kendoTreeView");n.select(".k-first")},1e3)}}function u(n){if(n.valid){var t=n.sender.dataItem(n.sourceNode),i=n.sender.dataItem(n.dropTarget);!SFU.isUndefined(t.items)&&t.items.length>0&&(n.dropPosition==="over"||!SFU.isUndefined(i.parentNode()))?n.setValid(!1):SFU.isUndefined(t.items)||t.items.length!==0||n.dropPosition!=="over"||SFU.isUndefined(i.parentNode())||n.setValid(!1)}}function f(){var n=[],u=t(0),i=$("[data-role='treeview']").data("kendoTreeView"),r;return i&&(r=i.dataSource.data(),$.each(r,function(t,i){var r=e(i,u);n.push(r)})),n}function e(n,t){var r={},i,u,f;for(i in t)i!=="items"?r[i]=n[i]:(u=[],f=n[i],$.each(f,function(n,i){var r={};for(var f in t)r[f]=i[f];u.push(r)}),r[i]=u);return r}function o(n,t,i){var r=i?i:0;setTimeout(function(){if(t){var i=n.dataSource.get(t).uid;n.select(n.findByUid(i))}else n.select(".k-first")},r)}function s(n){var t=skelta.DeviceOS?skelta.DeviceOS:"Web";t!=="WorkTasksPreview"&&setTimeout(function(){c(n.vm,n)},0)}function h(n,t){$.each(n,function(n,r){i(r,t);$.isArray(r.items)&&r.items.length>0&&$.each(r.items,function(n,r){i(r,t)})})}function i(t,i){skeltaUtils.isUndefinedNullOrEmpty(t.image)||(t.image=skelta.forms.utilities.getImagePath(t.image),t.hoverImage=skelta.forms.utilities.getActionItemHoverImage(t.image,"-Hover"));t.textScript=n(t.textScript);t.visibleScript=n(t.visibleScript);t.enableScript=n(t.enableScript);t.tagName=t.text;t._actionName=ko.observable(t.tagName);Object.defineProperty(t,"tagName",{get:function(){return t._actionName()},set:function(n){t._actionName(n)}});t._visible=ko.observable(t.visible);Object.defineProperty(t,"visible",{get:function(){return t._visible()},set:function(n){t._visible(n)}});t._enable=ko.observable(t.enable);Object.defineProperty(t,"enable",{get:function(){return t._enable()},set:function(n){t._enable(n)}});t._actionName=t._actionName.extend({skActionItemTextExtend:{control:i,actionItem:t}});t._enable=t._enable.extend({skActionItemEnableExtend:{control:i,actionItem:t}});t._visible=t._visible.extend({skActionItemVisibleExtend:{control:i,actionItem:t}});t._actionName.subscribe(function(n){ActionBar.setTextToActionItem(t,n)});t._visible.subscribe(function(n){ActionBar.setVisibilityToActionItem(t,n)});t._enable.subscribe(function(n){ActionBar.setDisableToActionItem(t,n)})}function c(n,t){if(n.topLevelForm.actionbar.items=$.parseJSON(n.topLevelForm.actionbar.items),n.readEditAddBehaviour===1){n.isFormLoaded(!0);n.onFormLoad=!1;$(".actionBarWrapper").hide();return}h(n.topLevelForm.actionbar.items,n);var i=skelta.forms.utilities.actionBarItems(t);if(i.length===0){n.isFormLoaded(!0);n.onFormLoad=!1;$(".actionBarWrapper").hide();return}ActionBar.init(i,"DivActionBar",!1);n.isFormLoaded(!0);n.onFormLoad=!1}function l(n,t,i,r){var u,e,o,f;n==="1"?(u=skelta.forms.utilities.getControlFromMultimodeControlIdString(r.topLevelForm,t),skeltaUtils.isUndefined(u)?(f=skelta.localize.getString("skAtionItemClick_ControlNotFound").replace("<@control@>",skelta.forms.utilities.getIdDisplayValueFromMultimodeControlIdString(t)),skeltaUtils.showError(document.title,f),logger.logError(f)):u.controlType==="InvokeWorkflow"?skelta.forms.utilities.invokeWorkflow(u):u.controlType==="PopupForm"?skelta.forms.utilities.showPopupControl(u):u.controlType==="FormButton"?skeltaUtils.isUndefined(u.domElement)?(e=$("<button />"),e.attr(dataAttributes.buttonText,u.buttonText),o={target:e[0]},u.clickEvent(o),e.remove()):$(u.domElement).click():(f=skelta.localize.getString("skAtionItemClick_NotSupportedControl"),skeltaUtils.showError(document.title,f),logger.logError(f))):n==="2"&&i(r)}function n(n,t){var r,i;try{return typeof n=="string"&&!skeltaUtils.isUndefinedNullOrEmpty(n)?(r=new Function("control","currentValue","return "+n+";"),r()):""}catch(u){i=skelta.localize.getString("FormNGFErrorActionItemScript").replace("<@actionitem@>",t);SFU.showError(skelta.localize.getString("FormNGFErrorRunningScript_title"),i,null,u.message);console.error(i);console.error(u.message)}}var t=function(n){return this.itemNumber=this.itemNumber+1,{id:n,text:skelta.localize.getString("skNewActionItem")+this.itemNumber,image:"",hoverImage:"",css:"",tooltip:"",script:"",openMode:"",items:[],enable:"True",visible:"True",parameterControl:"",actionType:"",expanded:!0,textScript:"",enableScript:"",visibleScript:""}};return ko.extenders.skActionItemTextExtend=function(n,t){var r=!1,u=t.control,i=t.actionItem;return ko.computed({read:function(){var t,f;return u.topLevelForm.isFormLoaded()&&!r&&(t=ko.observable(n()),typeof i.textScript=="function"&&(f=i.textScript(u,t.peek()),f!==undefined&&t(f)),n(t())),r=!1,n()},write:function(t){var f=t,e;r=!0;typeof i.textScript=="function"&&(e=i.textScript(u,f),e!==undefined&&(f=e));n(f)}})},ko.extenders.skActionItemEnableExtend=function(n,t){var r=t.control,i=t.actionItem,u=!1;return ko.computed({read:function(){var t,f;return r.topLevelForm.isFormLoaded()&&!u&&(t=ko.observable(n()),typeof i.enableScript=="function"&&(f=i.enableScript(r,t.peek()),f!==undefined&&t(f)),n(t())),u=!1,n()},write:function(t){var f=t,e;u=!0;typeof i.enableScript=="function"&&(e=i.enableScript(r,f),e!==undefined&&(f=e));n(f)}})},ko.extenders.skActionItemVisibleExtend=function(n,t){var r=!1,u=t.control,i=t.actionItem;return ko.computed({read:function(){var t,f;return u.topLevelForm.isFormLoaded()&&!r&&(t=ko.observable(n()),typeof i.visibleScript=="function"&&(f=i.visibleScript(u,t.peek()),f!==undefined&&t(f)),n(t())),r=!1,n()},write:function(t){var f=t,e;r=!0;typeof i.visibleScript=="function"&&(e=i.visibleScript(u,f),e!==undefined&&(f=e));n(f)}})},{initialize:r,onNodeDrop:u,defaultNode:t,itemNumber:0,selectTreeNode:o,getActionItemsFromWidget:f,loadActionBar:s,performAction:l}}();skelta.actionbar=n}}(),function(){if(skelta.utilities.isUndefined(skelta.signature)){var n=function(){function r(i){ko.computed(function(){i.topLevelForm.isFormLoaded()===!0&&i.dataContainerForm._isLoaded()&&i.value===""&&setTimeout(function(){var r,u;skelta.utilities.isUndefined(i.domElement)||(i.domElement.height=i.domElement.offsetHeight,i.domElement.width=i.domElement.offsetWidth,i.domElement.offsetHeight===0&&i.domElement.offsetWidth===0?(skelta.utilities.isUndefined(i.signature)||i.signature===""||(i.value=i.signature,i._isImageEditable(!0)),skelta.utilities.isUndefined(i.signature)||(i.signature=""),r=document.querySelector("canvas[controlId="+i.id+"]"),i.dom=r,i._isSignatureWithinContainer(!0),i.enable===!0?(i.enable=!1,i.sign=new SignaturePad(i.dom,{backgroundColor:"rgb(255, 255, 255)",onEnd:function(){i.signature=n(i,i.sign.toDataURL());i._isClearEnabled(!0);i._isUndoEnabled(!0)}}),setTimeout(function(){i.enable=!0;t(i)},400)):i.sign=new SignaturePad(i.dom,{backgroundColor:"rgb(255, 255, 255)",onEnd:function(){i.signature=n(i,i.sign.toDataURL());i._isClearEnabled(!0);i._isUndoEnabled(!0)}})):(i.signature="",i.sign=new SignaturePad(i.domElement,{backgroundColor:"rgb(255, 255, 255)",onEnd:function(){i.signature=n(i,i.sign.toDataURL());i._isClearEnabled(!0);i._isUndoEnabled(!0)}}),i._isSignatureWithinContainer(!1)),i._isResizeEventHandlerAttached()===!1&&(i._isResizeEventHandlerAttached(!0),window.addEventListener("resize",function(){i._imageSource()===""&&(clearTimeout(u),u=setTimeout(f.bind(i),500))})))},100);i._value.subscribe(function(n){i._imageSource(u(i,n))})})}function n(n,t){return n.securityMode===i.Encryption?btoa(t):t}function u(n,t){return n.securityMode===i.Encryption?atob(t):t}function f(){t(this)}function t(t){var i;t.domElement.offsetHeight!==0&&t.domElement.offsetWidth!==0?(t._isSignatureWithinContainer()===!0&&(t.sign=new SignaturePad(t.domElement,{backgroundColor:"rgb(255, 255, 255)",onEnd:function(){t.signature=n(t,t.sign.toDataURL());t._isClearEnabled(!0);t._isUndoEnabled(!0)}}),t._isSignatureWithinContainer(!1),skelta.utilities.isUndefined(t.signature)||t.signature===""||(t.value=t.signature,t._isImageEditable(!0))),t.sign.isEmpty()||(t.tempResult=t.sign.toDataURL()),t.sign.clear(),i=Math.max(window.devicePixelRatio||1,1),t.domElement.width=t.domElement.offsetWidth*i,t.domElement.height=t.domElement.offsetHeight*i,t.domElement.getContext("2d").scale(i,i),skelta.utilities.isUndefined(t.tempResult)||t.tempResult===""||(t.sign.fromDataURL(t.tempResult),t.tempResult="")):skelta.utilities.isUndefined(t.dom)||(t.sign.isEmpty()||(t.tempResult=t.sign.toDataURL()),t._isSignatureWithinContainer()!==!1||skelta.utilities.isUndefined(t.signature)||t.signature===""||(t.value=t.signature,t._isImageEditable(!0)),t._isSignatureWithinContainer(!0),t.sign.clear(),i=Math.max(window.devicePixelRatio||1,1),t.dom.width=t.dom.offsetWidth*i,t.dom.height=t.dom.offsetHeight*i,t.dom.getContext("2d").scale(i,i),skelta.utilities.isUndefined(t.tempResult)||t.tempResult===""||(t.sign.fromDataURL(t.tempResult),t.tempResult=""))}function e(n,t,i){i.sign.isEmpty()||(i.sign.clear(),i.signature="",i.value="",i._isClearEnabled(!1),i._isUndoEnabled(!1))}function o(t,i,r){var t=r.sign.toData();t.length!==0?(t.pop(),r.sign.fromData(t),r.signature=n(r,r.sign.toDataURL()),t.length===0&&(r._isClearEnabled(!1),r._isUndoEnabled(!1),r.signature="",r.value="")):(r.sign.clear(),r._isClearEnabled(!1),r._isUndoEnabled(!1),r.signature="",r.value="")}function s(n,t,i){i._isImageEditable(!1);i.value="";i.signature="";i._isClearEnabled(!1);i._isUndoEnabled(!1)}var i={None:0,Encryption:1};return{initializeSignature:r,clearSignature:e,undoSignature:o,resize:t,editImage:s}}();skelta.signature=n}}()