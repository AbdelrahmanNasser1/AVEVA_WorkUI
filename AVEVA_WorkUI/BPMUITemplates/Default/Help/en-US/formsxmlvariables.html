<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title> Forms XmlVariables </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1, user-scalable=no">

<link rel="stylesheet" type="text/css" href="stylesheet.css" />
<link rel="stylesheet" type="text/css" href="plain.css" />

</head>

<body>
<p id="BetaStatement" class="heading1" style="color:red;background-color:#FFFFFF;border-bottom:none;"></p>
<script type="text/javascript">
var elem = document.getElementById("BetaStatement");
if(elem.innerHTML == "") {
	elem.parentNode.removeChild(elem);
}
</script>
<p id="IncludeRelatedTopics" class="paragraph" style="color: teal; font-weight: bolder;">No</p>
  
<h4 id="t601986" class="heading4">Forms XmlVariables</h4>
<p class="subheading">Updating the list item that alerted the workflow</p>
<p class="paragraph">AVEVA Work Tasks allows you to update the list item that alerted the workflow using XML List type XML variable. Update Variable activity can be used to add or update an item to the list. To update an item you need to select the scope as Current from Choose the List Item to Work on options. You can also use <b class="uicontrol">List Navigator Activity</b> to set the scope. </p>
<p class="paragraph">Assume that you have created a list called<b class="uicontrol"> Purchase Orders</b> with the following fields and alerted the workflow.</p>
<ul class="ulitem"><li class="ulitem">Reference Number </li><li class="ulitem">Purchase Order Date </li><li class="ulitem">Raised By User </li><li class="ulitem">Deliver To User </li><li class="ulitem">Status </li><li class="ulitem">Purchase Order Details <ul class="ulsubitem"><li class="ulsubitem">Item Name </li><li class="ulsubitem">Quantity </li><li class="ulsubitem">Unit Price </li><li class="ulsubitem">Item Total </li></ul></li><li class="ulitem">Total Purchase amount </li></ul><p class="paragraph">Now you want to update an item in the same list. Follow the procedure.</p>
<ol class="step"><li class="step">Log on to the <b class="uicontrol">Enterprise Console</b> and go to workflow designer page. <br>You need to create an <b class="uicontrol">XML List</b> type XML variable for the <b class="uicontrol">Purchase Orders</b> list. If the variable is not created, follow the below mentioned procedure to create. </li><li class="step">Click the edit icon in the<b class="uicontrol"> XMLVariables</b> property from the <b class="uicontrol">Start Activity</b> Properties. The following screen appears.<p class="stepinfo"></p>
<p class="stepinfo"><img id="f187101" src="187101.png" alt="" height="437" width="550" vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="stepinfo"></p>
</li><li class="step">Click <b class="uicontrol">New Variable</b> to add a new variable. </li><li class="step">Enter the variable name as<b class="uicontrol"> PurchaseOrder</b>. </li><li class="step">Select<b class="uicontrol"> XML List</b> as <b class="uicontrol">Type</b> from the drop-down list. </li><li class="step">Enter the List name or click the icon to select the list. In this case select <b class="uicontrol">Purchase Order List</b>. </li><li class="step">Select the scope <b class="uicontrol">Current</b> option from the <b class="uicontrol">Choose the ListItem to work on</b> options to point to an item in the <b class="uicontrol">Purchase Order List</b>.<p class="stepinfo"></p>
<p class="stepinfo"><br><img id="f187102" src="187102.png" alt="" height="495" width="550" vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="stepinfo"></p>
</li><li class="step">Now you can see the XML nodes in a tree-view that are mapped to the controls while creating the list. </li><li class="step">Click <b class="uicontrol">Save Variable</b>. A message is displayed saying 'Variable Updated'. Close the window. <p class="stepinfo"><strong class="notelabel">Note:</strong> If you set the scope as New while creating the XML List type XML variable, you can change it in to Current using List Navigator activity.</p>
</li><li class="step">Drag and drop the<b class="uicontrol"> Update Variable</b> activity to update an item in the list.<p class="stepinfo"></p>
<p class="stepinfo"><img id="f187103" src="187103.png" alt="" height="351" width="550" vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="stepinfo"></p>
<p class="stepinfo"></p>
</li><li class="step">Click the edit icon in the <b class="uicontrol">Set Variables</b> property. </li><li class="step">Click the <b class="uicontrol">Select</b> link and select the respective field of the <b class="uicontrol">XML List</b> type XML Variable created for the list (in this case <b class="uicontrol">PurchaseOrder</b>). The fields displayed in the tree-view are representing the XML nodes of the controls in the list.</li><li class="step">Select a field for that you want set the value from the tree-view. Then enter the value for the field in the right-hand side text box or click to set the value. </li><li class="step">If you want to set the value, select <b class="uicontrol">enter a value</b> from the tree-view, and then enter the value. Also you can select variables or contents or any XMLvariables nodes directly by selecting the respective node from the tree-view. If you want to combine multiple node values, you can build an expression by selecting <b class="uicontrol">Build Expression</b>.<p class="stepinfo"></p>
<p class="stepinfo"><img id="f187104" src="187104.png" alt="" height="155" width="535" vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="stepinfo"></p>
</li><li class="step">The same way you can set the value for other fields that you want to update. In this case, you are only updating the field 'Title' which has the value 'Order for Illustrator'. </li><li class="step">Click <b class="uicontrol">OK</b>. When you execute this workflow, the item get updated based on the value that you have set. <p class="note"><strong class="notelabel">Note:</strong> For number data types, the minimum and maximum values are not validated. Enter only valid numeric values for number data types. For numeric, DateTime, Date, or Time data types, ensure that the respective value is based on the culture set. <br>You can enter the input or use the Date and Time picker to enter the required date and time. <br>Date.CurrentDate is not supported. Use the tree view option to pick the required date and time. <br>The time format supports long data type to enable you to enter seconds. </p>
</li></ol><p class="paragraph"></p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">Related Topics</p><p class="relateditem"><a href="updatevariablevalueaction.html" target="_self">Update Variable Activity</a></p></td>
</tr>
</table>



<script type="text/javascript">
// Get value of the <IncludeRelatedTopics> variable from AIT
	var IncludeRelTopics = document.getElementById("IncludeRelatedTopics");
//Get all table elements in book and then get all table of the specified class. If you're using IE 9 or later, use following line instead of this code block. 
//	var RelTopics = document.getElementsByClassName("relatedtopics belowtopictext");
    var TableClass = "relatedtopics belowtopictext";
	var arrElements = document.getElementsByTagName("table");
	var RelTopics = new Array();
	for(var i=0; i < arrElements.length; i++){
		if(arrElements[i].className == TableClass){
			RelTopics.push(arrElements[i]);
		}
	}


// Remove Related Topics sections if the <IncludeRelatedTopics> variable is No and the Related Topics section appears in the topic.
	if (IncludeRelTopics.innerHTML == "No" && RelTopics.length != 0) {
		for (var j=0; j < RelTopics.length; j++) {
			RelTopics[j].parentNode.removeChild(RelTopics[j]);
		}
	}
// Remove paragraph used to hold the value of the <IncludeRelatedTopics> variable.
	IncludeRelTopics.parentNode.removeChild(IncludeRelTopics); 
 </script>	
 </body>
 </html>
