function isUndefined(n){return typeof n=="undefined"||n==null}var actionBarCollection=[],sourceSwap=function(){if($(this).attr("disabled")!=="disabled"){var n=$(".icon",$(this)),t=n.data("alt-src");n.data("alt-src",n.attr("src"));n.attr("src",t)}},ActionBar={skActionItemIdAttribute:"data-SKActionID",init:function(n,t,i){$.inArray(this,actionBarCollection)===-1&&actionBarCollection.push(this);var r=this;this._parent=$("#"+t);this._parent.closest(".actionBarWrapper").is(":visible")===!1&&this._parent.closest(".actionBarWrapper").show();$(".actionBar",this._parent).length>0&&($(".actionBar",this._parent).html(""),$(".actionBar",this._parent).remove());this._allowMobileUX=i===!1?!1:!0;this.isMobile=!1;this._actionBar=$("<div/>");this._actionBar.addClass("actionBar");this._parent.width()!=null&&this._parent.width()<=320&&this._allowMobileUX?(this.isMobile=!0,this._actionBar.addClass("mobile"),$("body").append(this._actionBar)):(this._actionBar.removeClass("mobile"),this._parent.append(this._actionBar));this._json=n;this._mainMenuItems=[];this._rightMenuItems=[];this._mainMenuItemsJson=[];this._rightMenuItemsJson=[];this.MoreItems=[];this.MoreItems.SubItems=[];this.SubMenu=[];this._selectedMenuItem=[];this._leftMenu=$("<div/>");this._leftMenu.addClass("leftMenu");this._leftMenu.attr("id","leftMenu");this._actionBar.append(this._leftMenu);$.each(this._json,function(n,t){$.each(t,function(n,t){var i,u;r._mainMenuItemsJson.push([]);i=!1;$.each(t.SubItems,function(n,t){r._mainMenuItemsJson[r._mainMenuItemsJson.length-1].SubItems||(r._mainMenuItemsJson[r._mainMenuItemsJson.length-1].SubItems=[]);var u=r.createMenuItem(t,"SubItemLeft"+(r._mainMenuItemsJson.length-1)+r._mainMenuItemsJson[r._mainMenuItemsJson.length-1].SubItems.length);r._mainMenuItemsJson[r._mainMenuItemsJson.length-1].SubItems.push(u);t.Visible===!0&&(i=!0)});u=r.createMenuItem(t,"Left"+r._mainMenuItems.length);!isUndefined(t.Visible)&&i===!1&&t.SubItems.length>0&&u.hide();r._mainMenuItems.push(u)})});r.layoutMainMenu()},layoutMainMenu:function(){var r=this,t,i,n;for(this._leftMenu.html(""),this.MoreItems.SubItems=[],t=0,itemIndex=0,i=!1;(this._actionBar.width()>t||this.isMobile)&&itemIndex<this._mainMenuItems.length;){this._leftMenu.append(this._mainMenuItems[itemIndex]);this._mainMenuItems[itemIndex].is(":visible")===!0&&(i=!0);$(this._mainMenuItems[itemIndex]).on("click",function(){r.menuItemClick(this)});if(this._leftMenu.width()<this._actionBar.width()||this.isMobile)n=$("<div/>"),n.addClass("separator"),this._leftMenu.append(n),this._mainMenuItems[itemIndex].is(":visible")===!1&&n.hide(),t=this._leftMenu.width(),itemIndex++;else{this._mainMenuItems[itemIndex].remove();break}}i===!1&&this._parent.closest(".actionBarWrapper").hide()},layoutRightMenu:function(){var o=this,u,t,i,r,f,e,n;if(this._rightMenu.html(""),u=this._leftMenu.width(),itemIndex=0,this.MoreItems.SubItems.length==0)while((this._actionBar.width()>u||this.isMobile)&&itemIndex<this._rightMenuItems.length)if(this._rightMenu.append(this._rightMenuItems[itemIndex]),u+this._rightMenu.width()+20<this._actionBar.width()||this.isMobile){this._rightMenuItems[itemIndex].remove();n=$("<div/>");n.addClass("separator");this._rightMenu.append(n);$(this._rightMenuItems[itemIndex]).on("click",function(){o.menuItemClick(this)});this._rightMenu.append(this._rightMenuItems[itemIndex]);$(".icon",this._rightMenuItems[itemIndex]).attr("data-alt-src")&&$(".icon",this._rightMenuItems[itemIndex]).attr("data-alt-src")!=""&&($(this._rightMenuItems[itemIndex]).off("mouseenter mouseleave"),$(this._rightMenuItems[itemIndex]).hover(sourceSwap,sourceSwap));u=this._leftMenu.width()+this._rightMenu.width();itemIndex++}else{this._rightMenuItems[itemIndex].remove();break}if(itemIndex<this._rightMenuItems.length){if($("#More",this._actionBar).length==0){n=$("<div/>");n.addClass("separator");this._rightMenu.append(n);t=$("<div/>");t.addClass("menuItem");t.attr("id","More");i=$("<div/>");i.addClass("content");r=$("<img/>");r.attr("src","images/more-icon.png");r.addClass("icon");r.attr("data-alt-src","images/more-icon-hover.png");$(t).hover(sourceSwap,sourceSwap);i.append(r);f=$("<div/>");f.html("More");f.addClass("name");i.append(f);t.append(i);e=$("<div/>");e.addClass("downArrow");t.append(e);$(t).on("click",function(){o.menuItemClick(this)});this._rightMenu.append(t);n=$("<div/>");n.addClass("separator");this._rightMenu.append(n);$(".menuItem",this._rightMenu).length==1&&$(".separator",this._rightMenu).first().remove()}while(itemIndex<this._rightMenuItems.length)this.MoreItems.SubItems.push(this._rightMenuItems[itemIndex]),itemIndex++}else n=$("<div/>"),n.addClass("separator"),this._rightMenu.append(n)},showRightMenu:function(n){var t=this;if(this._rightMenu){this._rightMenu.remove();this._rightMenuItems=[];this._rightMenuItemsJson=[];this._rightMenu=null;this.MoreItems=[];this.MoreItems.SubItems=[];return}this._rightMenu=$("<div/>");this._rightMenu.addClass("rightMenu");this._rightMenu.attr("id","rightMenu");this._actionBar.append(this._rightMenu);this._rightJson=n;$.each(this._rightJson,function(n,i){$.each(i,function(n,i){var r;t._rightMenuItemsJson.push([]);$.each(i.SubItems,function(n,i){t._rightMenuItemsJson[t._rightMenuItemsJson.length-1].SubItems||(t._rightMenuItemsJson[t._rightMenuItemsJson.length-1].SubItems=[]);var r=t.createMenuItem(i,"SubItemRight"+(t._rightMenuItemsJson.length-1)+t._rightMenuItemsJson[t._rightMenuItemsJson.length-1].SubItems.length);t._rightMenuItemsJson[t._rightMenuItemsJson.length-1].SubItems.push(r)});r=t.createMenuItem(i,"Right"+t._rightMenuItems.length);t._rightMenuItems.push(r)})});this.layoutRightMenu()},hideRightMenu:function(){this.hideSubMenus();this._rightMenu&&(this._rightMenu.remove(),this._rightMenuItems=[],this._rightMenuItemsJson=[],this._rightMenu=null,this.MoreItems=[],this.MoreItems.SubItems=[])},menuItemClick:function(n){var u,i,t,o,r,f,s,a,h;if($(n).attr("disabled")!=="disabled"){var c=this,l=$(n).parent().attr("id").replace("subMenu",""),e=0;for(isNaN(l)||(e=parseInt(l));this.SubMenu.length-1>=e;)u=this.SubMenu.length-1,this.SubMenu[u].remove(),this.SubMenu.pop(this.SubMenu[u]);while(this._selectedMenuItem.length>0&&this._selectedMenuItem.length>e){if(u=this._selectedMenuItem.length-1,this._selectedMenuItem[u].removeClass("selected").removeClass("subSelected"),this._selectedMenuItem.length==1&&(this._selectedMenuItem[u].prev().removeClass("selectedPrev"),this._selectedMenuItem[u].next().removeClass("selectedNext"),$(".menuItem",this._rightMenu).length==1&&$(".separator",this._leftMenu).last().removeClass("selectedPrev")),this._selectedMenuItem[u].attr("id")==$(n).attr("id")){this._selectedMenuItem.pop(this._selectedMenuItem[u]);return}this._selectedMenuItem.pop(this._selectedMenuItem[u])}if(i=$("<div/>"),this.SubMenu.length==0?(i.addClass("subMenu"),$(n).addClass("selected"),$(n).prev().addClass("selectedPrev"),$(n).next().addClass("selectedNext"),$(".menuItem",this._rightMenu).length==1&&$(".separator",this._leftMenu).last().addClass("selectedPrev")):(i.addClass("subSubMenu"),$(n).addClass("subSelected")),i.attr("id","subMenu"+(this.SubMenu.length+1)),this.isMobile?i.css({bottom:parseInt($(n).parent().height()-1)*(this.SubMenu.length+1)+"px"}):i.css({top:parseInt($(n).parent().height()-1)*(this.SubMenu.length+1)+"px"}),this.SubMenu.push(i),t=[],$(n).attr("id")=="More"?t=this.MoreItems.SubItems:$(n).attr("id").substring(0,4)=="Left"?(o=parseInt($(n).attr("id").replace("Left","")),t=this._mainMenuItemsJson[o].SubItems):$(n).attr("id").substring(0,5)=="Right"&&(o=parseInt($(n).attr("id").replace("Right","")),t=this._rightMenuItemsJson[o].SubItems),t&&typeof t!="undefined"&&t.length>0){for(r=0;r<t.length;r++){$(t[r]).on("click",function(){c.menuItemClick(this)});$(t[r]).removeClass("subSelected");$(n).outerWidth()>=parseInt($(n).css("max-width"))&&$(t[r]).width($(n).width());i.append(t[r]);$(".icon",t[r]).attr("data-alt-src")&&$(".icon",t[r]).attr("data-alt-src")!=""&&($(t[r]).off("mouseenter mouseleave"),$(t[r]).hover(sourceSwap,sourceSwap))}this._actionBar.append(i);f=$(n).offset().left-$(n).parent().parent().offset().left+$(n).outerWidth()/2-i.outerWidth()/2;f<0?f=0:f+i.outerWidth()>$(n).parent().parent().outerWidth()&&(f=$(n).parent().parent().outerWidth()-i.outerWidth()-(this.isMobile?0:1));i.css({left:f+"px"});this._selectedMenuItem.push($(n))}else{if(s=$(n).attr("skonclick"),isUndefined(s)||s==="")h=$(n).attr("action"),isUndefined(h)||h===""||(window.location.href=$(n).attr("action"));else try{a=new Function(s);retVal=a()}catch(v){}$(n).removeClass("selected");$(n).prev().removeClass("selectedPrev");$(n).next().removeClass("selectedNext");e>0&&setTimeout(function(){c.hideSubMenus()},200)}}},createMenuItem:function(n,t){var i=$("<div/>"),u,r,f,e;return i.addClass("menuItem"),i.attr("id",t),i.attr(this.skActionItemIdAttribute,n.Id),i.attr("action",n.Action),isUndefined(n.OnClick)||i.attr("skonclick",n.OnClick),typeof n.Tooltip!="undefined"&&i.attr("title",n.Tooltip),u=$("<div/>"),u.addClass("content"),isUndefined(n.Css)||n.Css===""?(r=$("<img/>"),r.attr("src",n.Image),r.addClass("icon"),u.append(r),typeof n.HoverImage!="undefined"&&(r.attr("data-alt-src",n.HoverImage),$(i).hover(sourceSwap,sourceSwap))):(r=$("<div/>"),i.addClass(n.Css),r.addClass("icon"),u.append(r)),f=$("<div/>"),f.text(n.Text),f.addClass("name"),u.append(f),i.append(u),n.SubItems.length>0&&(e=$("<div/>"),e.addClass("downArrow"),i.append(e)),isUndefined(n.Visible)||n.Visible!==!1||i.hide(),isUndefined(n.Enable)||n.Enable!==!1||(i.addClass("menuItemDisabled"),i.attr("disabled","disabled")),i},resize:function(){this.hideSubMenus();this._parent.width()<=320&&this._allowMobileUX?(this.isMobile=!0,this._actionBar.html(""),this._actionBar.remove(),this._actionBar=null,this.init(this._json,this._parent.attr("id"),this._allowMobileUX)):(this.isMobile=!1,this._actionBar.html(""),this._actionBar.remove(),this._actionBar=null,this.init(this._json,this._parent.attr("id"),this._allowMobileUX));this._rightMenu&&(this._rightMenu.remove(),this._rightMenuItems=[],this._rightMenuItemsJson=[],this._rightMenu=null,this.MoreItems=[],this.MoreItems.SubItems=[],this.showRightMenu(this._rightJson))},checkClick:function(n){var t=$(n.target);t.closest(".actionBar").length==0&&this.hideSubMenus()},hideSubMenus:function(){for(var t=0,n;this.SubMenu.length-1>=t;)n=this.SubMenu.length-1,this.SubMenu[n].remove(),this.SubMenu.pop(this.SubMenu[n]);while(this._selectedMenuItem.length>0&&this._selectedMenuItem.length>t)n=this._selectedMenuItem.length-1,this._selectedMenuItem[n].removeClass("selected").removeClass("subSelected"),this._selectedMenuItem.length==1&&(this._selectedMenuItem[n].prev().removeClass("selectedPrev"),this._selectedMenuItem[n].next().removeClass("selectedNext"),$(".menuItem",this._rightMenu).length==1&&$(".separator",this._leftMenu).last().removeClass("selectedPrev")),this._selectedMenuItem.pop(this._selectedMenuItem[n])},getMenuItem:function(n){var i=this,t;return $.each(this._mainMenuItems,function(r,u){if(u.attr(i.skActionItemIdAttribute)===n.id)return t=u,!1}),isUndefined(t)&&$.each(this._mainMenuItemsJson,function(r,u){var f;return u.SubItems&&$.isArray([u.SubItems])&&$.each(u.SubItems,function(r,u){if(u.attr(i.skActionItemIdAttribute)===n.id)return t=u,f=!1,!1}),f===!1?!1:void 0}),t},updateJSONData:function(n,t,i){$.each(this._json,function(r,u){var f=u[Object.keys(u)[0]],e=!0;return f.Id===n?(f[i]=t,!1):($.each(f.SubItems,function(r,u){if(u.Id===n)return u[i]=t,e=!1,!1}),e===!1?!1:void 0)})},setVisibilityToActionItem:function(n,t){this.updateJSONData(n.id,t,"Visible");this.resize()},setDisableToActionItem:function(n,t){var i=this.getMenuItem(n);isUndefined(i)||(this.updateJSONData(n.id,t,"Enable"),t===!0&&(i.removeAttr("disabled"),i.removeClass("menuItemDisabled"),i.removeClass("selected").removeClass("subSelected")),t===!1&&(i.addClass("menuItemDisabled"),i.attr("disabled","disabled")))},setTextToActionItem:function(n,t){var i=this.getMenuItem(n);isUndefined(i)||(this.updateJSONData(n.id,t,"Text"),i.find(".name").text(t))}};$(function(){$(window).resize(function(){$.each(actionBarCollection,function(n,t){t.resize()})});$(window).on("click",function(n){$.each(actionBarCollection,function(t,i){i.checkClick(n)})})})