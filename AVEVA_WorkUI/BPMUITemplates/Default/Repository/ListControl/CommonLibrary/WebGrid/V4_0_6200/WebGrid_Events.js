
// Generated by Intersoft Script Optimizer V1.5 + Intersoft JS Engine MaxObfuscate(tm) V1.0 
// Generated Datetime : 12/7/2005 1:44:22 PM
// Copyright (c) 2005 Intersoft Solutions.
// Unauthorized decryption/reproduction of any codes contained herein is strictly prohibited and will result in severe civil and criminal penalties .
//**Start Encode**
function SelectedObject(v97347,vdbd13,vbf197 ){ this.tblName =v97347; this.gridId =vdbd13; this.element =vbf197; this.rowIndex =0; this.cellIndex =0; this.type =""; this.getRowElement =this.GetRowElement =function(){ if (this.element){ if (this.element.tagName =="TR")return this.element; else return this.element.parentElement; } return null; }; this.GetRowObject =this.ToRowObject =function() { var vdad3 =wgGetRootRow(this.GetRowElement()); if (vdad3) { var v99d84 =ISGetObject(this.gridId); var v4a999 =v99d84.Tables[this.tblName]; return v4a999.ToRowObject(vdad3); } }; this.getColSetRowElement =this.GetColSetRowElement =function(){ var vdbd13 =wgGetGridById(this.gridId); var v4a999 =vdbd13.Tables[this.tblName]; if (v4a999.IsUseColumnSet) return wgGetColumnSetRow(this.element); return null; }; this.getColSetRowsElement =this.GetColSetRowsElement =function(){ var vdbd13 =wgGetGridById(this.gridId); var v4a999 =vdbd13.Tables[this.tblName]; if (v4a999.IsUseColumnSet) return wgGetColumnSetRows(this.element); return null; }; return this;}function wgGetLastSelectedObject(){ return wg_Global.LastSelObj;}function wgGetRowHeader(v30815){ if (!v30815)return null; var v30415 =wg38213.m88693(v30815); if (!v30415)return null;  var v9da51 =ISGetObject(v30415.gridId); if (!v9da51)return null;  for (var v05994=0; v05994<v30815.cells.length; v05994++) { var v51080 =v30815.cells[v05994]; wg38213.m79d94(v51080); if (v51080.type =="RowSelector" ||v51080.type =="RowHeader") return v51080; } return null;}function wgGetValidActiveCell(vfb815){ if (vfb815.type !="Cell") return vfb815.parentElement.cells[wgGetFirstEditableCell(vfb815.parentElement)]; else return vfb815;}function wgGetLastVisibleRow(vc7637){ var v6c215 =null; try  { v6c215 =vc7637.rows[vc7637.rows.length-1]; }catch(e){v6c215 =null; } if (v6c215 ==null) { var v85351 =ISGetObject(vc7637.gridId).Tables[vc7637.tblName]; if (v85351.Get("AllowAddNew")=="Yes") { v6c215 =vc7637.parentElement.previousSibling.childNodes[0].rows[0]; v6c215 =v85351.GetNewRow(v6c215); var v09194 =new SelectedObject(vc7637.tblName,vc7637.gridId,v6c215); return v09194; } } if (v6c215) wg38213.m79d94(v6c215); if (v6c215 &&(v6c215.style.display =="none" ||v6c215.type =="GroupTotalRow" ||v6c215.type =="PR" ||v6c215.type =="CSRecord")) { return wgGetPrevVisibleRow(vc7637,v6c215); } else  { var v4dc80 =ISGetObject(vc7637.gridId); var v85351 =v4dc80.Tables[vc7637.tblName]; if (v4dc80.LastSelObj.element.type =="NewRow") { v6c215 =vc7637.rows[vc7637.rows.length-1]; wg38213.m79d94(v6c215); if (v6c215.style.display =="none" ||v6c215.type =="GroupTotalRow" ||v6c215.type =="PR" ||v6c215.type =="CSRecord") { return wgGetPrevVisibleRow(vc7637,v6c215); } } var v09194 =new SelectedObject(vc7637.tblName,vc7637.gridId,v6c215); return v09194; } return null;}function wgGetLastChildVisibleRow(vf8037){ if (vf8037.style.display =="none") vf8037 =wgGetPreviousRow(tb,vf8037); else  { var v2a037 =vf8037.cells[vf8037.cells.length-1]; var v07845 =v2a037.childNodes[v2a037.childNodes.length-1]; wg38213.m79d94(v07845); var v9be93 =document.getElementById("dvTB_" +v07845.gridId +"_" +v07845.tblName +"_" +v07845.subId).childNodes[0]; var v76494 =wgGetLastVisibleRow(v9be93); if (v76494) { if (v76494.type =="HierRecord") v76494 =wgGetLastChildVisibleRow(v76494.element); if (v76494)return v76494; } else vf8037 =wgGetPreviousRow(tb,vf8037); } return vf8037;}function wgGetPrevVisibleRow(v71e24,v88a35){ var v0e537 =ISGetObject(v71e24.gridId); var v02d45 =v0e537.Tables[v71e24.tblName]; var v0c193 =wgGetPreviousRow(v71e24,v88a35);  wg38213.m79d94(v88a35);  if (v88a35.type =="NewRow") { if (v02d45.Get("AllowFilter")=="Yes" &&v02d45.IsFilterRowVisible()) { var v11794 =v02d45.GetFilterRow(v88a35); if (v11794) { v0c193 =v11794; var vf3246 =new SelectedObject(v71e24.tblName,v71e24.gridId,v0c193); return vf3246; } }else v0c193 =null; } else if (v88a35.type =="FilterRow")v0c193 =null;  while (v0c193 !=null) { if (v0c193.type =="HierRecord") { if (v0c193.style.display =="none") v0c193 =wgGetPreviousRow(v71e24,v0c193); else  { var vf0370 =v0c193.cells[v0c193.cells.length-1]; var vfd473 =vf0370.childNodes[vf0370.childNodes.length-1]; wg38213.m79d94(vfd473); var vef60 =document.getElementById("dvTB_" +vfd473.gridId +"_" +vfd473.tblName +"_" +vfd473.subId).childNodes[0]; var vab157 =wgGetLastVisibleRow(vef60); if (vab157) { if (vab157.element.type =="HierRecord") vab157 =wgGetLastChildVisibleRow(vab157.element); if (vab157)return vab157; } else v0c193 =wgGetPreviousRow(v71e24,v0c193); } } else  { if (v0c193.style.display =="none" ||v0c193.type =="GroupTotalRow" ||v0c193.type =="PR" ||v0c193.type =="CSRecord") v0c193 =wgGetPreviousRow(v71e24,v0c193); else  { var vf3246 =new SelectedObject(v71e24.tblName,v71e24.gridId,v0c193); return vf3246; } } }  if (v0c193 ==null &&v88a35.type !="NewRow") { var vf5e44 =v02d45.Get("AllowAddNew"); if (vf5e44 =="Yes") { var v6cf80 =v02d45.GetNewRow(v88a35); if (v6cf80) { v0c193 =v6cf80; var vf3246 =new SelectedObject(v71e24.tblName,v71e24.gridId,v0c193); return vf3246; } }  if (v02d45.Get("AllowFilter")=="Yes") { var v11794 =v02d45.GetFilterRow(v88a35); if (v11794) { v0c193 =v11794; var vf3246 =new SelectedObject(v71e24.tblName,v71e24.gridId,v0c193); return vf3246; } } }  if (v0c193 ==null) { var v0e537 =ISGetObject(v71e24.gridId); var v02d45 =v0e537.Tables[v71e24.tblName]; if (!v02d45.IsRootTable) {  var v26c76 =v02d45.GetElement(WG40.COLHEADER,WG40.HTMLDIV,v88a35).parentElement; if (v26c76) { if (v26c76.previousSibling) { v26c76 =v26c76.previousSibling.previousSibling; wg38213.m79d94(v26c76); var v59928 =document.getElementById("dvTB_" +v26c76.gridId +"_" +v26c76.tblName +"_" +v26c76.subId).childNodes[0]; return wgGetLastVisibleRow(v59928); } }  var vefd85 =v02d45.GetParentRow(v88a35); if (vefd85) { var v4e35 =wg38213.m88693(vefd85); return new SelectedObject(v4e35.tblName,v4e35.gridId,vefd85);  } } } return null;}function wgGetPrevSiblingRow(v8f869,ve8b21){ var va8a46; wg38213.m79d94(ve8b21); if (ve8b21.type =="NewRow")return null; else if (ve8b21.type =="Record") { va8a46 =wgGetPreviousRow(v8f869,ve8b21); if (va8a46) { if (va8a46.type =="HierRecord") va8a46 =wgGetPreviousRow(v8f869,va8a46); else if (va8a46.type =="NewRow") va8a46 =null; } } else if (ve8b21.type =="GroupHeader") { va8a46 =wgGetPreviousRow(v8f869,ve8b21); if (va8a46) va8a46 =wg85027.mc8988(va8a46,ve8b21.groupIndex,"previous"); if (va8a46) if (va8a46.parentIndex !=ve8b21.parentIndex)va8a46 =null; } if (va8a46 ==null)return null;  var v22e28 =new SelectedObject(v8f869.tblName,v8f869.gridId,va8a46); return v22e28;}function wgGetFirstVisibleRow(v69091){ var v8a269 =null; try  { v8a269 =v69091.rows[0]; } catch(e){v8a269 =null; }  if (v8a269) wg38213.m79d94(v8a269); if (v8a269 &&(v8a269.style.display =="none" ||v8a269.type =="GroupTotalRow" ||v8a269.type =="PR" ||v8a269.type =="CSRecord")) { return wgGetNextVisibleRow(v69091,v8a269); } else  { wg38213.m79d94(v69091); var v49a21 =ISGetObject(v69091.gridId).Tables[v69091.tblName]; if (v49a21.Get("AllowAddNew")=="Yes") { if (!v8a269)v8a269 =v69091.parentElement.previousSibling.childNodes[0].rows[0]; v8a269 =v49a21.GetNewRow(v8a269); } var v53254 =new SelectedObject(v69091.tblName,v69091.gridId,v8a269); return v53254; } return null;}function wgGetNextSiblingRow(v37036,v1e52){ var v60791; wg38213.m79d94(v1e52); if (v1e52.type =="NewRow") return null; else if (v1e52.type =="Record") { var v93015 =wgGetGridById(v37036.gridId); var v9c253 =v93015.Tables[v37036.tblName]; if (v9c253.IsUseColumnSet) { v60791 =wgGetLowestColumnSetRow(v1e52); v60791 =wgGetNextRow(v37036,v60791); } else v60791 =wgGetNextRow(v37036,v1e52);  if (v60791) { if (v60791.type =="PR") v60791 =wgGetNextRow(v37036,v60791); if (v60791 &&v60791.type =="HierRecord") v60791 =wgGetNextRow(v37036,v60791); else if (v60791.type =="NewRow" ||v60791.type =="GroupTotalRow") v60791 =null; } } else if (v1e52.type =="GroupHeader") { v60791 =wgGetNextRow(v37036,v1e52); if (v60791) v60791 =wg85027.mc8988(v60791,v1e52.groupIndex,"next"); if (v60791) if (v60791.parentIndex !=v1e52.parentIndex)v60791 =null; } if (v60791 ==null)return null;  var vac536 =new SelectedObject(v37036.tblName,v37036.gridId,v60791); return vac536;}function wgGetNextVisibleRow(v79e95,v9ce96){ var vb3336 =ISGetObject(v79e95.gridId); var vee42 =vb3336.Tables[v79e95.tblName]; var vaf351 =wgGetNextRow(v79e95,v9ce96); var v46163 =false;  if (v9ce96.type =="NewRow") v46163 =true; else if (wgIsFilterRow(v9ce96)&&vee42.Get("AllowAddNew")=="No") v46163 =true;  if (v46163) { var vb3336 =ISGetObject(v79e95.gridId); var vee42 =vb3336.Tables[v79e95.tblName]; tbl =vee42.GetElement(WG40.BODY,WG40.HTMLTABLE,v9ce96); if (tbl.rows.length >0) vaf351 =tbl.rows[0]; else vaf351 =null; } while (vaf351 !=null) { if (vaf351.type =="HierRecord") { if (vaf351.style.display =="none") vaf351 =wgGetNextRow(v79e95,vaf351); else  { var va3f47 =vaf351.cells[vaf351.cells.length-1]; var vb6b69 =va3f47.childNodes[0]; wg38213.m79d94(vb6b69); var v01b30 =document.getElementById("dvTB_" +vb6b69.gridId +"_" +vb6b69.tblName +"_" +vb6b69.subId).childNodes[0]; var va9877 =wgGetFirstVisibleRow(v01b30); if (va9877)return va9877; else  vaf351 =wgGetNextRow(v79e95,vaf351);  } } else  { if (vaf351.style.display =="none" ||vaf351.type =="GroupTotalRow" ||vaf351.type =="PR" ||vaf351.type =="CSRecord" ||!vaf351.type) vaf351 =wgGetNextRow(v79e95,vaf351); else  { var v9e422 =new SelectedObject(v79e95.tblName,v79e95.gridId,vaf351); return v9e422; } } }  if (vaf351 ==null) { if (!vee42.IsRootTable) { var vfd046 =vee42.GetElement(WG40.COLHEADER,WG40.HTMLDIV,v9ce96).parentElement; if (vfd046) { if (vfd046.nextSibling) { vfd046 =vfd046.nextSibling.nextSibling; wg38213.m79d94(vfd046); var v19167 =document.getElementById("dvTB_" +vfd046.gridId +"_" +vfd046.tblName +"_" +vfd046.subId).childNodes[0]; return wgGetFirstVisibleRow(v19167); } } var vec083 =vee42.GetParentRow(v9ce96); if (vec083) { var v95983 =wg38213.m88693(vec083); vec083 =wgGetNextSiblingRow(v95983,vec083); if (!vec083) return null;  vec083 =wgGetPreviousRow(v95983,vec083.element); return wgGetNextVisibleRow(v95983,vec083); } } } return null;}var wg60540 ={ medb21:function(v16876,ve8887,v6b350) {  var v9c726; if (!v16876)return;  if (v16876.tagName !="TD") { v9c726 =v16876; v16876 =wg38213.mb6c95(v16876); } if (!v16876)return; if (v16876.tagName =="TD") { var v50e21 =v16876.parentElement; var vad321;  wg38213.m79d94(v16876); wg38213.m79d94(v50e21); if (!v16876.type)return; if (wgIsValidClickableCell(v16876)||wgIsValidRow(v50e21)) { if (v16876.type =="RowSelector")ve8887 =true; var va5c78 =wg38213.m88693(v50e21); var v1ba13 =ISGetObject(va5c78.gridId); if (!v1ba13.Enabled)return; var v2e71 =v1ba13.Tables[va5c78.tblName];  var va2477 =v2e71.Get("CellClickAction"); var va8330 =v2e71.GetSelRowStyle(); var v7e47 =v2e71.GetFocusCellStyle();  var vb3485 =v1ba13.LayoutSettings.ImageSettings.Folder +v1ba13.LayoutSettings.ImageSettings.CurrentRowImage; var v0aa58 =false; if (!v6b350) if (!ISEvent.Raise(v1ba13.LayoutSettings.ClientSideEvents.OnCellClick,v1ba13.Id,v2e71.Id,v50e21.rowIndex,v16876.cellIndex,v16876)) return; if (va2477 =="RowSelect" ||va2477 =="CellSelect" ||wgIsValidRow(v50e21)) { var v8a853 =v2e71.Get("AllowEdit")=="Yes"; if (v1ba13.LastSelObj &&(v1ba13.ActiveEditCell ||v1ba13.LastEditObj)) { vad321 =v1ba13.LastSelObj.element; if (vad321.tagName =="TD")vad321 =vad321.parentElement;  if (!wgIsSameRow(vad321,v50e21)||ve8887) { var v52547 =v1ba13.ExitEdit(1)[0]; if (!v52547)return; } else  { if (((v8a853 ||(v50e21.type =="NewRow"))||v50e21.type =="FilterRow")&&!ve8887 &&v50e21.type !="GroupHeader") { if (v9c726) { if (v9c726.rowChecker) wg85027.m71b81(v9c726,event.shiftKey); else wg9c911.mde08(v9c726,v16876); } wg60540.mef56(v1ba13,v2e71,v9c726,v16876); v0aa58 =true; if (v1ba13.LastEditObj) { var v52547 =v1ba13.ExitEditMode(); if (v52547 &&(va2477 !="CellSelect" ||v50e21.type =="NewRow" ||v50e21.type =="FilterRow")) { wg9c911.m96a77(v16876); var v72782 =v1ba13.LayoutSettings.EditOnClick; if (v72782 ||v50e21.type =="NewRow" ||v50e21.type =="FilterRow") { if (wgIsFilterRow(v50e21)&&v9c726 &&v9c726.tagName =="IMG")return; if (!v6b350 &&event.button !=2)v1ba13.ActivateEditMode(); if (v50e21.type =="NewRow" ||wgIsFilterRow(v50e21)||v72782)return; } else  { v16876.setActive(); return; } } else  return; } else  { if (va2477 !="CellSelect") { wg9c911.m96a77(v16876); if (v1ba13.LayoutSettings.EditOnClick ||v50e21.type =="NewRow" ||v50e21.type =="FilterRow") { if (wgIsFilterRow(v50e21)&&v9c726 &&v9c726.tagName =="IMG")return; if (!v6b350 &&event.button !=2)v1ba13.ActivateEditMode(); } return; } } } } } }  var v86b89 =false; if ((va2477 =="RowSelect" ||v16876.type =="RowSelector" ||v50e21.type =="GroupHeader" ||v50e21.type =="NewRow" ||v50e21.type =="FilterRow")) { v86b89 =true; } if (v86b89) { if (v16876.type =="RowSelector") { if (!ISEvent.Raise(v1ba13.LayoutSettings.ClientSideEvents.OnRowSelectorClick,v1ba13.Id,v2e71.Id,v50e21.rowIndex,v50e21)) return;  ve8887 =true; } if (v50e21.type =="NewRow") wg60540.mec16(v1ba13,v50e21); wg60540.me2c56(v50e21,vb3485);  if (wgIsColumnSetRow(v50e21)&&v16876.type =="RowSelector" &&va2477 =="CellSelect") { wg9c911.m8c187(v16876); wg60540.ma5e17(v50e21,va8330,v7e47,"Forcedraw",true); } else wg60540.ma5e17(v50e21,va8330,v7e47,"",v6b350);  if (((v8a853 &&(v50e21.type =="Record" ||v50e21.type =="CSRecord"))||v50e21.type =="FilterRow")&&!ve8887) { if (v1ba13.HasFocus()) { wg9c911.m96a77(v16876); if (wgIsFilterRow(v50e21)&&v9c726 &&v9c726.tagName =="IMG")return; if (v1ba13.LayoutSettings.EditOnClick)v1ba13.ActivateEditMode(); } else  { wg9c911.m96a77(v16876,"Nodraw"); } } else if (wgIsRecordRow(v50e21)&&!v8a853) v1ba13.ActiveEditCell =null;  if (ve8887 &&v8a853) { if (v1ba13.HasFocus()) v16876.setActive(); }  if ((v50e21.type =="GroupHeader" ||!v8a853)&&v1ba13.ActiveEditCell &&v1ba13.ActiveEditCell.rowElement.type =="NewRow") { wg9c911.m41d61(v1ba13.ActiveEditCell.rowElement); v1ba13.ActiveEditCell =null; } else if (v50e21.type =="NewRow") { wg9c911.m15b94(v50e21); if (!v6b350) v1ba13.ActivateEditMode(); } else if (v50e21.type =="FilterRow") v1ba13.ActivateEditMode(); else if (v50e21.type =="GroupHeader" &&v1ba13.ActiveEditCell) v1ba13.ActiveEditCell =null; } else if (va2477 =="CellSelect" &&v50e21.type !="PR") { if (vad321) { if (!wgIsSameRow(vad321,v50e21)) wg60540.me2c56(v50e21,vb3485); } else wg60540.me2c56(v50e21,vb3485);  wg60540.mf6937(v16876,va8330,v7e47,"",v6b350);  if (v1ba13.LayoutSettings.EditOnClick) v1ba13.ActivateEditMode(); } }  if (v9c726 &&v9c726.type =="checkbox") { wg38213.m79d94(v9c726); if (v9c726.rowChecker) wg85027.m71b81(v9c726,event.shiftKey); else  { if (typeof(wg9c911)!="undefined") { if (typeof(wg9c911.mde08)=="function") wg9c911.mde08(v9c726,v16876); } } }  if (!v0aa58) wg60540.mef56(v1ba13,v2e71,v9c726,v16876); } },  mef56:function(vf7c67,vb901,v18637,v72111) { if (v18637 &&v18637.tagName =="BUTTON") { wg38213.m79d94(v18637); var v9e933 =wgGetColNameByCell(v72111); var ve9d41 =ISEvent.Raise(vf7c67.LayoutSettings.ClientSideEvents.OnButtonClick,vf7c67.Id,vb901.Id,v9e933,v18637.keyValue);  if (ve9d41) { if (IS.moz) { event.cancelBubble =true; event.returnValue =false; }  var vf5d43 =vb901.Columns.GetNamedItem(v9e933); if (vf5d43.ButtonAutoPostback) { var vdea31 =vf5d43.ButtonPostbackMode; if (vdea31 =="OnTheFly") { wg38213.mc2b9(vf7c67.Name,"ButtonClick",v18637); } else  { var vc6a78 =vf7c67.Name +"\03" +vb901.Id +"\03" +v9e933 +"\03" +v18637.keyValue; __doPostBack(vf7c67.ServerUniqueID,"ButtonClick:" +vc6a78); } } } } }, mec16:function(v6b136,v8d622) { var vc1a12; var va1d88 =v8d622.cells;  for (var v4d935=0; v4d935<va1d88.length; v4d935++) { if (va1d88[v4d935].type =="NewRowInfoCell") { vc1a12 =va1d88[v4d935]; break; } }  if (vc1a12) { var v3a538 =v6b136.Tables[wg38213.m92e89(v8d622)]; if (v3a538.IsUseColumnSet) { wg11388.m2c088(v6b136,v3a538,v8d622,vc1a12); return; }  v8d622.origColSpan =vc1a12.colSpan; v8d622.infoText =vc1a12.innerText; vc1a12.colSpan =1; vc1a12.innerText =" "; vc1a12.type ="Cell"; v8d622.oldClassName =vc1a12.className; vc1a12.className =v6b136.RowClass; for (var v4d935=0; v4d935<v8d622.origColSpan-1; v4d935++) { var vf0253 =v8d622.insertCell(-1); vf0253.type ="Cell"; vf0253.className =v6b136.RowClass; } wg9c911.mf1882(v6b136,v8d622); } }, m5e484:function(v2ef93) { var vb1359; var va4916 =v2ef93.cells; var vc5724 =wg38213.m88693(v2ef93); var v99b86 =wgGetGridById(vc5724.gridId); var v1ef56 =v99b86.Tables[vc5724.tblName];  if (v1ef56.IsUseColumnSet) { wg11388.mbc983(v99b86,v1ef56,v2ef93); return; } for (var vb0166=0; vb0166<va4916.length; vb0166++) { if (va4916[vb0166].type =="Cell") { vb1359 =va4916[vb0166]; break; } }  if (vb1359) { var v68193 =0; for (var vb0166=0; vb0166<v2ef93.origColSpan-1; vb0166++) { v2ef93.deleteCell(vb1359.cellIndex+1); v68193++; } vb1359.colSpan =v2ef93.origColSpan; vb1359.innerText =v2ef93.infoText; vb1359.type ="NewRowInfoCell"; vb1359.style.cssText =""; vb1359.className =v2ef93.oldClassName; } }, m31885:function(v8bd93) { for (var v54e93=0; v54e93<v8bd93.childNodes.length; v54e93++) { if (v8bd93.childNodes[v54e93].tagName =="SPAN" &&v8bd93.childNodes[v54e93].getAttribute("content")=="") return v8bd93.childNodes[v54e93]; else if (v8bd93.childNodes[v54e93].childNodes.length >0) { var v19076 =wg60540.m31885(v8bd93.childNodes[v54e93]); if (v19076)return v19076; } } return null; }, m37291:function(vb2f94,v2cb74,vb4d68) { var v32993 =wgGetCellCount(vb2f94); var vc0c76 =wg38213.m88693(vb2f94); if (!vb2f94 ||!vc0c76)return;  var v4dd18 =ISGetObject(vc0c76.gridId); var v20f67 =v4dd18.Tables[vc0c76.tblName]; var v99465 =v20f67.GetSelRowStyle(); var v0369 =v20f67.GetFocusCellStyle(); var v30481 =false; var ve0d2;  if (v0369 !="") v0369 =v0369.substring(v0369.indexOf(":")+1);  if (wgGetActiveGrid()!=v4dd18.Name)vb4d68 =true; if (vb4d68) { v99465 =v4dd18.GetBlurRowStyle(); v0369 ="0px"; } else  { if (v2cb74 =="CheckedRow") { v99465 =v20f67.GetCheckedRowStyle(); if (v99465 =="")return; v0369 =""; } } if (wgIsColumnSetRow(vb2f94)||(v20f67.PreviewRowVisible &&vb2f94.type !="GroupHeader" &&vb2f94.type !="NewRow")) { wg11388.m36e9(vb2f94,v2cb74,vb4d68); return; } if (v20f67.SelfReferencingSettings.Enabled &&v20f67.SelfReferencingSettings.IsTreeViewSelectionMode &&vb2f94.type !="GroupHeader") { var v36027 =v20f67.SelfReferencingSettings.ExpandColumnMember; var vc3272 =wgGetCellByName(vb2f94,v36027); var v1c977 =wg60540.m31885(vc3272);  if (v2cb74 =="Clear") v1c977.runtimeStyle.cssText =""; else { if (v2cb74 !="Redraw") v1c977.runtimeStyle.cssText =v99465; v1c977.runtimeStyle.border =v0369; }  return; } for (var v5aa42=0; v5aa42<vb2f94.cells.length; v5aa42++) { var v8d812 =vb2f94.cells[v5aa42]; wg38213.m79d94(v8d812); if (v8d812.type =="Cell" ||v8d812.type =="GroupCell" ||v8d812.type =="FilterColumn") { if (v2cb74 =="Clear") { with (v8d812.runtimeStyle) { cssText =""; } } else  { if (v2cb74 !="Redraw") { v8d812.runtimeStyle.cssText =v99465; } if (!v30481) { v30481 =true; v8d812.runtimeStyle.borderLeft =v0369; v8d812.runtimeStyle.borderTop =v0369; v8d812.runtimeStyle.borderBottom =v0369; if (v32993 >1 ||v8d812.type =="GroupCell") v8d812.runtimeStyle.borderRightWidth ="0"; else v8d812.runtimeStyle.borderRight =v0369; } else  { ve0d2 =v8d812; v8d812.runtimeStyle.borderTop =v0369; v8d812.runtimeStyle.borderBottom =v0369; v8d812.runtimeStyle.borderLeftWidth ="0"; v8d812.runtimeStyle.borderRightWidth ="0"; } } } } if (ve0d2) { with (ve0d2.runtimeStyle) { borderRight =v0369; borderTop =v0369; borderBottom =v0369; borderLeftWidth ="0"; } } if (v2cb74 =="Clear" &&vb2f94.isRowChecked &&!vb4d68)wg60540.m37291(vb2f94,"CheckedRow"); },  ma5e17:function(v36873,v78e21,v07f60,v88565,v22d52) { if (!v36873)return; if (v88565 =="Clear" &&v36873.tagName =="TD") { wg60540.mf6937(v36873,v78e21,v07f60,"Clear"); return; } if (v88565 =="Clear") { var vcba28 =wg38213.m88693(v36873); if (!vcba28)return; var v5a735 =ISGetObject(vcba28.gridId); if (!wg38213.md7a39(v5a735.LastSelObj))return; } else  { var vcba28 =wg38213.m88693(v36873); var v5a735 =ISGetObject(vcba28.gridId); if (v36873.type =="PR")v36873 =wgGetPreviousRow(vcba28,v36873); if (v5a735.LastSelObj &&!wgIsSameRow(v5a735.LastSelObj.element,v36873)) { wg60540.ma5e17(v5a735.LastSelObj.element,"","","Clear"); if (v5a735.LastSelObj.element.type =="NewRow") { wg60540.m5e484(v5a735.LastSelObj.element); } } else  { if (v5a735.LastSelObj &&wgIsSameRow(v5a735.LastSelObj.element,v36873)&&v88565 !="Forcedraw" ) return; }  if (!v22d52) { if (!ISEvent.Raise(v5a735.LayoutSettings.ClientSideEvents.OnBeforeRowSelect,v5a735.Id,vcba28.tblName,v5a735.LastSelObj)) return; }  var v59749 =new SelectedObject(vcba28.tblName,vcba28.gridId,v36873); v59749.type ="Row"; v59749.rowIndex =v36873.rowIndex; v5a735.LastSelObj =v59749; if (!v22d52) { if (!ISEvent.Raise(v5a735.LayoutSettings.ClientSideEvents.OnRowSelect,v5a735.Id,vcba28.tblName,v36873.rowIndex,v36873)) return; } }  wg60540.m37291(v36873,v88565); },  mf6937:function(v55a75,v8b762,vb9250,v9e186,v5dc16) { if (!v55a75.origStyle)v55a75.origStyle =v55a75.style.cssText; if (vb9250 !="") vb9250 =vb9250.substring(vb9250.indexOf(":")+1);  if (v9e186 =="Clear" &&v55a75.tagName =="TR") { wg60540.ma5e17(v55a75,v8b762,vb9250,"Clear"); return; }  if (v9e186 =="Clear") { } else  { var v26b63 =wg38213.m88693(v55a75.parentElement); var v3b595 =ISGetObject(v26b63.gridId);  if (v3b595.LastSelObj &&v3b595.LastSelObj.element !=v55a75) { wg60540.mf6937(v3b595.LastSelObj.element,"","","Clear"); } if (v3b595.LastSelObj &&v3b595.LastSelObj.GetRowElement()!=v55a75.parentElement) { var va8056 =v3b595.LastSelObj.GetRowElement(); if (va8056 &&va8056.type =="NewRow") { wg60540.ma5e17(va8056,"","","Clear"); wg60540.m5e484(va8056); } }  var v45f18 =new SelectedObject(v26b63.tblName,v26b63.gridId,v55a75); var v46058 =v3b595.Tables[v26b63.tblName];  v45f18.type ="Cell"; v45f18.rowIndex =v55a75.parentElement.rowIndex; v45f18.cellIndex =wgGetCellPosByName(v55a75.parentElement,v55a75); v46058.LastAECIndex =v55a75.cellIndex; v3b595.LastSelObj =v45f18; if (!v5dc16) if (!ISEvent.Raise(v3b595.LayoutSettings.ClientSideEvents.OnCellSelect,v26b63.gridId,v26b63.tblName,v45f18.rowIndex,v45f18.cellIndex,v55a75)) return;  var v53e61 =v46058.Get("AllowEdit")=="Yes"; if (v53e61) { v3b595.ActiveEditCell =new wgActiveCell(v26b63.gridId,v26b63.tblName,v55a75); v3b595.ActiveEditCell.rowElement =v55a75.parentElement; }  } if (v9e186 =="Clear") { v55a75.runtimeStyle.cssText =""; if (v55a75.stripedClass) { v55a75.className +=v55a75.stripedClass; v55a75.stripedClass =""; } } else  { with (v55a75.runtimeStyle) { cssText =v8b762; borderLeft =borderRight =borderBottom =borderTop =vb9250; }  if (v55a75.className.indexOf("DefNoBrdBottom")>=0) { v55a75.className =v55a75.className.replace(/DefNoBrdBottom/g,""); v55a75.stripedClass ="DefNoBrdBottom "; }  if (v55a75.className.indexOf("DefNoBrdRight")>=0) { v55a75.className =v55a75.className.replace(/DefNoBrdRight/g,""); v55a75.stripedClass +="DefNoBrdRight "; } } }, me2c56:function(ved387,v80d29) { if (!ved387)return; var v50b65 =wg38213.m88693(ved387); if (!v50b65)return;  var v0b436 =ISGetObject(v50b65.gridId); if(v0b436.LastSelObj &&v80d29 !=null) { obj =v0b436.LastSelObj.element; if (obj.tagName =="TR") wg60540.me2c56(obj,null); else wg60540.me2c56(obj.parentElement,null); } if (!v0b436)return;  if (wgIsColumnSetRow(ved387)) ved387 =wgGetColumnSetRow(ved387); else if (ved387.type =="PR") ved387 =wgGetPreviewRowParent(ved387); var v86146 =wgGetRowHeader(ved387); if (!v86146)return;  if (v80d29) { v86146.innerHTML ="<img src='" +v80d29 +"' align='absmiddle'>"; } else  { if (ved387.type =="NewRow") { v80d29 =v0b436.LayoutSettings.ImageSettings.Folder +v0b436.LayoutSettings.ImageSettings.NewRowImage; v86146.innerHTML ="<img src='" +v80d29 +"' align='absmiddle'>"; } else v86146.innerHTML ="&nbsp;"; } ved387.markedEdit =false; }, m98b12:function(v64022) { var v3aa32 =event.srcElement; var v21716; if (v3aa32.tagName !="TD")v3aa32 =wg38213.mb6c95(v3aa32); if (!v3aa32 ||v3aa32.tagName !="TD")return; if (v3aa32.tagName =="TD")v21716 =wg38213.m88693(v3aa32.parentElement); else if (v3aa32.tagName =="TR")v21716 =wg38213.m88693(v3aa32); if (!v21716)return; if (v21716.tagName !="TABLE" ||!v21716.gridId)return; if (v21716.tblName !=v64022)return;  var va1443 =ISGetObject(v21716.gridId); var vac880 =va1443.Tables[v21716.tblName]; var v02776 =v3aa32.parentElement; if (!ISEvent.Raise(va1443.LayoutSettings.ClientSideEvents.OnCellDblClick,v21716.gridId,v21716.tblName,v02776.rowIndex,v3aa32.cellIndex,v3aa32)) return; if (v02776.type =="GroupHeader") { wg85027.mb1082(va1443,wgGetCellByPosition(v02776,0).childNodes[0],v02776.expanded); wg85027.m22c96(null,v02776); } else if (wgIsRecordRow(v02776)) { if (!va1443.LayoutSettings.EditOnClick) { if (vac880.Get("AllowEdit")=="Yes") va1443.ActivateEditMode(); else  { if (typeof(v02776.srLevel)!="undefined") wgToggleSelfRefRow(v02776); } } } event.cancelBubble =true; event.returnValue =false; },  m04c65:function() { if (IS.moz &&wg_Global.LastKeyDownProcessed) { event.cancelBubble =true; event.returnValue =false; } }, m4145:function(vae243) { var vfc244 =(vae243 ? vae243 : event); var v08e83 =vfc244.srcElement; if (!v08e83)v08e83 =vfc244._srcElement; var tbl,vcfc69;  if (v08e83.tagName =="TD") { tbl =wg38213.m88693(v08e83.parentElement); vcfc69 =v08e83.parentElement; } else if (v08e83.tagName =="TR") { tbl =wg38213.m88693(v08e83); vcfc69 =v08e83; } else if (v08e83.tagName =="SPAN" ||v08e83.tagName =="NOBR") { v08e83 =wg38213.mb6c95(v08e83); vcfc69 =v08e83.parentElement; tbl =wg38213.m88693(v08e83); } if (!tbl)return; if (tbl.tagName !="TABLE" ||!tbl.gridId)return;  var vbac38 =ISGetObject(tbl.gridId); var v8eb47 =vbac38.Tables[tbl.tblName]; var v8d033 =false; var vf0f18 =false; var vde581 =false; var vf1435 =true; var v96e2 =false; var v62b78 =vbac38.LastSelObj; var v09750 =false; var vb5975 =null;  if (IS.moz) { if (v62b78) { v08e83 =v62b78.element; tbl =wg38213.m88693(v08e83); } }  if (tbl !=v8eb47.GetElement(WG40.BODY,WG40.HTMLTABLE,vcfc69)) { if (!v62b78)return; v08e83 =v62b78.element; tbl =wg38213.m88693(v08e83); } try  { if (!ISEvent.Raise(vbac38.LayoutSettings.ClientSideEvents.OnKeyDown,vbac38.Name,tbl.tblName,v08e83.parentElement.rowIndex,v08e83.cellIndex)) return; }catch (e){return;} var v9f966 =v8eb47.Get("CellClickAction"); if (v9f966 =="None")vf0f18 =true; if (vf0f18) { event.cancelBubble =true; return; } var vc4e70 =new SelectedObject(tbl.tblName,tbl.gridId,null); var v68f19 =false; var v2c981 =false; if (vfc244.keyCode ==187 &&vfc244.ctrlKey)v68f19 =true; if (vfc244.keyCode ==189 &&vfc244.ctrlKey)v2c981 =true; switch(vfc244.keyCode) { case 35: var vcfc69 =v62b78.element; if (v62b78.type =="Cell")vcfc69 =vcfc69.parentElement; if (v9f966 =="RowSelect" ||vcfc69.type =="GroupHeader") { try  { vc4e70 =wgGetLastVisibleRow(tbl); } catch(e){} } else  { if (vcfc69.type !="NewRow") { vc4e70.cellIndex =wgGetCellCount(v62b78.element.parentElement)-1; vc4e70.element =wgGetCellByPosition(v62b78.element.parentElement,vc4e70.cellIndex ); } }  if (vc4e70) { var v85b81 =vbac38.Tables[vc4e70.tblName].Get("CellClickAction"); if (v85b81 =="RowSelect" ||vcfc69.type =="GroupHeader") vc4e70.type ="Row"; else if (v85b81 =="CellSelect") vc4e70.type ="Cell"; vde581 =true; v8d033 =true; }  if (!vfc244.ctrlKey &&v9f966 !="CellSelect") { if (vcfc69.type =="NewRow" ||wgIsFilterRow(vcfc69)||(wgIsRecordRow(vcfc69)&&v8eb47.Get("AllowEdit")=="Yes" )) { var vb795 =wgGetLastEditableCell(vcfc69); if (vb795)wg9c911.m96a77(vb795); vde581 =false; } } break; case 36: var vcfc69 =v62b78.element; if (v62b78.type =="Cell")vcfc69 =vcfc69.parentElement;  if (v9f966 =="RowSelect" ||vcfc69.type =="GroupHeader") vc4e70 =wgGetFirstVisibleRow(tbl); else  { if (vcfc69.type !="NewRow") { vc4e70.element =wgGetCellByPosition(v62b78.element.parentElement,0); vc4e70.cellIndex =0; } }  if (vc4e70) { var v85b81 =vbac38.Tables[vc4e70.tblName].Get("CellClickAction"); if (v85b81 =="RowSelect" ||vcfc69.type =="GroupHeader") vc4e70.type ="Row"; else if (v85b81 =="CellSelect") { vc4e70.type ="Cell"; } vde581 =true; v8d033 =true; }  if (!vfc244.ctrlKey &&v9f966 !="CellSelect") { if (vcfc69.type =="NewRow" ||wgIsFilterRow(vcfc69)||(wgIsRecordRow(vcfc69)&&v8eb47.Get("AllowEdit")=="Yes" )) { wg9c911.m15b94(vcfc69); vde581 =false; } } break; case 9: if (vfc244.ctrlKey) { while (true) { var v2e431; if (!vfc244.shiftKey) v2e431 =wgGetNextFocusableElement(vbac38,null,v2e431); else v2e431 =wgGetPrevFocusableElement(vbac38,null,v2e431); if (v2e431) { if (vbac38.LastEditObj) vbac38.ExitEditMode(); try  { v2e431.focus(); break; }catch(e){} }else break; } vde581 =false; v8d033 =true; break; } case 37: if (vfc244.keyCode ==37 ||(vfc244.keyCode ==9 &&vfc244.shiftKey)) { var vcfc69 =v62b78.element; if (v9f966 =="RowSelect" ||vcfc69.type =="GroupHeader" ||vcfc69.type =="NewRow" ||wgIsFilterRow(vcfc69)) { if (v62b78.type =="Cell")vcfc69 =vcfc69.parentElement; if (vcfc69.type =="GroupHeader" &&vcfc69.expanded =="True") { wg85027.mb1082(vbac38,wgGetCellByPosition(vcfc69,0).childNodes[0],vcfc69.expanded); wg85027.m22c96(null,vcfc69); } else if (typeof(vcfc69.srLevel)!="undefined" &&!v8eb47.Get("AllowEdit")=="Yes") { if (v9f966 !="CellSelect") { var v9d046 =wg85027.m61352(v8eb47,vcfc69); wg85027.mb1082(vbac38,v9d046,vcfc69.srExpanded); wg85027.m40476(v9d046); } } else if (vcfc69.type =="NewRow" ||wgIsFilterRow(vcfc69)||(wgIsRecordRow(vcfc69)&&v8eb47.Get("AllowEdit")=="Yes" )) { if (!wgActiveCellValid(vbac38,vcfc69)) { wg9c911.m15b94(vcfc69); } else  { var v53210 =wgGetPrevEditableCell(vbac38.ActiveEditCell.element,vcfc69); if (v53210) { if (!v53210.rowChanged) { wg9c911.m96a77(v53210.element); if (wgIsColumnSetRow(vcfc69))v53210.element.setActive(); }  if (v53210.rowChanged) { vcfc69 =v53210.rowElement; vc4e70.type ="Row"; vc4e70.element =vcfc69; vde581 =true; if (v53210.element) { v09750 =true; vb5975 =v53210.element; } } if (wgIsColumnSetRow(vcfc69))vf1435 =false; } } } } else if (v9f966 =="CellSelect") { if (v62b78.cellIndex-1 >=0){ vc4e70 =new SelectedObject(v62b78.tblName,v62b78.gridId,null); vc4e70.cellIndex =v62b78.cellIndex -1; vc4e70.rowIndex =v62b78.rowIndex; vc4e70.type ="Cell"; vc4e70.element =wgGetCellByPosition(v62b78.element.parentElement,vc4e70.cellIndex); vde581 =true; } }  v8d033 =true; break; } case 9: if (vfc244.shiftKey)break; case 39: var vcfc69 =v62b78.element;  if (v9f966 =="RowSelect" ||v62b78.element.type =="GroupHeader" ||vcfc69.type =="NewRow" ||wgIsFilterRow(vcfc69)) { if (v62b78.type =="Cell")vcfc69 =vcfc69.parentElement; if (vcfc69.type =="GroupHeader" &&vcfc69.expanded =="False") { wg85027.mb1082(vbac38,wgGetCellByPosition(vcfc69,0).childNodes[0],vcfc69.expanded); wg85027.m22c96(null,vcfc69); } else if (typeof(vcfc69.srLevel)!="undefined" &&!v8eb47.Get("AllowEdit")=="Yes") { if (v9f966 !="CellSelect") { var v9d046 =wg85027.m61352(v8eb47,vcfc69); wg85027.mb1082(vbac38,v9d046,vcfc69.srExpanded); wg85027.m40476(v9d046); } } else if (vcfc69.type =="NewRow" ||wgIsFilterRow(vcfc69)||(wgIsRecordRow(vcfc69)&&v8eb47.Get("AllowEdit")=="Yes" )) { if (!wgActiveCellValid(vbac38,vcfc69)){ wg9c911.m15b94(vcfc69); } else  { var v96983 =wgGetNextEditableCell(vbac38.ActiveEditCell.element,vcfc69); if (v96983){ if (!v96983.rowChanged) { wg9c911.m96a77(v96983.element); if (wgIsFilterRow(vcfc69)) { wg60540.m7794(vbac38,v96983.element); } if (wgIsColumnSetRow(vcfc69))v96983.element.setActive(); }  if (v96983.rowChanged) { vcfc69 =v96983.rowElement; vc4e70.type ="Row"; vc4e70.element =vcfc69; vde581 =true; if (v96983.element) { v09750 =true; vb5975 =v96983.element; } } if (wgIsColumnSetRow(vcfc69))vf1435 =false; } } } } else if (v9f966 =="CellSelect") { var v8c790 =(v62b78.element.tagName =="TR" ? v62b78.element : v62b78.element.parentElement); if (!vbac38.LastEditObj) { if (v62b78.cellIndex+1 <wgGetCellCount(v8c790)) { vc4e70 =new SelectedObject(v62b78.tblName,v62b78.gridId,null); vc4e70.cellIndex =v62b78.cellIndex +1; vc4e70.rowIndex =v62b78.rowIndex; vc4e70.type ="Cell"; vc4e70.element =wgGetCellByPosition(v8c790,vc4e70.cellIndex); vde581 =true; } } else  { var v7f370 =v62b78.GetRowElement(); if (wgIsRecordRow(v7f370)&&v8eb47.Get("AllowEdit")=="Yes") { var v96983 =wgGetNextEditableCell(vbac38.ActiveEditCell.element,v7f370); if (v96983) { vc4e70 =new SelectedObject(v62b78.tblName,v62b78.gridId,null); vc4e70.cellIndex =v96983.element.cellIndex; vc4e70.rowIndex =v7f370.rowIndex; vc4e70.type ="Cell"; vc4e70.element =v96983.element; } vde581 =true; } } } v8d033 =true; break;  case 38: var vafd52;  var vcfc69 =v62b78.element; if (v62b78.type =="Cell")vcfc69 =vcfc69.parentElement; if (vfc244.ctrlKey) { vc4e70 =wgGetPrevSiblingRow(tbl,vcfc69); if (!vc4e70)vc4e70 =wgGetPrevVisibleRow(tbl,vcfc69); } else vc4e70 =wgGetPrevVisibleRow(tbl,vcfc69); if (v8eb47.Get("AllowEdit")=="Yes" &&!wgActiveCellValid(vbac38,vcfc69)) { if (!wgIsColumnSetRow(vcfc69)) wg9c911.m15b94(vcfc69); else vf1435 =false; } else  { if (wgIsColumnSetRow(vcfc69)&&(v8eb47.Get("AllowEdit")=="Yes" ||wgIsFilterRow(vcfc69))) { var v08e83 =vbac38.ActiveEditCell.element; var v21b64 =wgGetCSPrevEditableRow(tbl,v08e83,v08e83.cs,v08e83.c,true);  if (v21b64 &&v21b64.element &&v21b64.element.type !="GroupHeader" &&v21b64.element.type !="NewRow") { if (v21b64 &&v8eb47.Id ==v21b64.tblName) { if (wgIsSameRow(v21b64.rowElement,vcfc69)) { v96e2 =true; v09750 =true; vf1435 =false; vb5975 =v21b64.element; vc4e70 =new SelectedObject(v62b78.tblName,v62b78.gridId,null); vc4e70.type ="Row"; vc4e70.element =v21b64.rowElement; } else  { vf1435 =false; vc4e70 =new SelectedObject(v62b78.tblName,v62b78.gridId,null); vc4e70.type ="Row"; vc4e70.element =v21b64.rowElement; if (v21b64.element) { v09750 =true; vb5975 =v21b64.element; } } } } else  { if (!event.ctrlKey) vc4e70 =wgGetPrevVisibleRow(tbl,v08e83.parentElement); } } }  if (vc4e70) { var v85b81 =vbac38.Tables[vc4e70.tblName].Get("CellClickAction");  if (v85b81 =="RowSelect" ||vc4e70.element.type =="GroupHeader" ||vc4e70.element.type =="NewRow" ||vc4e70.element.type =="FilterRow") vc4e70.type ="Row"; else if (v85b81 =="CellSelect") { vc4e70.type ="Cell"; if (v62b78.tblName ==vc4e70.tblName) { vc4e70.cellIndex =v62b78.cellIndex; vc4e70.element =wgGetCellByPosition(vc4e70.element,vc4e70.cellIndex); } else  { if (vbac38.Tables[vc4e70.tblName].LastAECIndex !=-1) { vc4e70.cellIndex =vbac38.Tables[vc4e70.tblName].LastAECIndex; vc4e70.element =wgGetValidActiveCell(vc4e70.element.cells[vc4e70.cellIndex]); } else vc4e70.element =wgGetCellByPosition(vc4e70.element,vc4e70.cellIndex); } } vde581 =true; v8d033 =true; } break; case 40: var vafd52; var vcfc69 =v62b78.element; if (v62b78.type =="Cell")vcfc69 =vcfc69.parentElement; if (v62b78.tblName !=tbl.tblName)tbl =wg38213.m88693(vcfc69); if (vfc244.ctrlKey) { vc4e70 =wgGetNextSiblingRow(tbl,vcfc69); if (!vc4e70)vc4e70 =wgGetNextVisibleRow(tbl,vcfc69); } else vc4e70 =wgGetNextVisibleRow(tbl,vcfc69); if (v8eb47.Get("AllowEdit")=="Yes" &&!wgActiveCellValid(vbac38,vcfc69)) { if (!wgIsColumnSetRow(vcfc69)) wg9c911.m15b94(vcfc69); else vf1435 =false; } else  { if (wgIsColumnSetRow(vcfc69)&&(v8eb47.Get("AllowEdit")=="Yes" ||wgIsFilterRow(vcfc69))) { var v08e83 =vbac38.ActiveEditCell.element; var v21b64 =wgGetCSNextEditableRow(tbl,v08e83,v08e83.cs,v08e83.c,true); if (v21b64 &&v21b64.element &&v21b64.element.type !="GroupHeader" &&v21b64.element.type !="NewRow") { if (v21b64 &&v8eb47.Id ==v21b64.tblName) { if (wgIsSameRow(v21b64.rowElement,vcfc69)) { v96e2 =true; v09750 =true; vf1435 =false; vb5975 =v21b64.element; vc4e70 =new SelectedObject(v62b78.tblName,v62b78.gridId,null); vc4e70.type ="Row"; vc4e70.element =v21b64.rowElement;  } else  { vf1435 =false; vc4e70 =new SelectedObject(v62b78.tblName,v62b78.gridId,null); vc4e70.type ="Row"; vc4e70.element =v21b64.rowElement; if (v21b64.element) { v09750 =true; vb5975 =v21b64.element; } } } } else  { if (!event.ctrlKey) vc4e70 =wgGetNextVisibleRow(tbl,v08e83.parentElement); } } }  if (vc4e70) { var v85b81 =vbac38.Tables[vc4e70.tblName].Get("CellClickAction"); if (v85b81 =="RowSelect" ||vc4e70.element.type =="GroupHeader" ||vc4e70.element.type =="NewRow") vc4e70.type ="Row"; else if (v85b81 =="CellSelect") { vc4e70.type ="Cell"; if (v62b78.tblName ==vc4e70.tblName) { vc4e70.cellIndex =v62b78.cellIndex; vc4e70.element =wgGetCellByPosition(vc4e70.element,vc4e70.cellIndex); } else  { if (vbac38.Tables[vc4e70.tblName].LastAECIndex !=-1) { vc4e70.cellIndex =vbac38.Tables[vc4e70.tblName].LastAECIndex; vc4e70.element =wgGetValidActiveCell(vc4e70.element.cells[vc4e70.cellIndex]); } else  { vc4e70.element =wgGetCellByPosition(vc4e70.element,vc4e70.cellIndex); } } } vde581 =true; v8d033 =true; } break; case 46: var vcfc69 =v62b78.element; if (v62b78.type =="Cell")vcfc69 =vcfc69.parentElement; if (v8eb47.Get("AllowDelete")=="Yes" &&wgIsRecordRow(vcfc69)) { var v04823 =true; if (vbac38.LayoutSettings.PromptBeforeDelete) v04823 =confirm(vbac38.GetString("MessageBoxText/DeleteRow"));  if (v04823) { wg9c911.m4ef32(vbac38,vcfc69); v8d033 =true; } else { event.cancelBubble =true; } } break; case 107: if (v9f966 =="RowSelect") { var v7f370 =v62b78.element; if (v62b78.type =="Cell")v7f370 =v7f370.parentElement; if (wgIsRecordRow(v7f370)) { var v2cf24; v7f370 =wgGetRootRow(v7f370); for (var v2c495=0; v2c495<v7f370.cells.length;v2c495++) { if (v7f370.cells[v2c495].type =="CellExpander") { v2cf24 =v7f370.cells[v2c495]; break; } } if (v2cf24 &&(v7f370.childExpanded =="True")){ wgec043.m51c36(vbac38,v2cf24,"True"); wgec043.m3c399(null,v7f370); } } } v8d033 =true; break; case 109: if (v9f966 =="RowSelect") { var v7f370 =v62b78.element; if (v62b78.type =="Cell")v7f370 =v7f370.parentElement; if (wgIsRecordRow(v7f370)) { var v2cf24; for (var v2c495=0; v2c495<v7f370.cells.length;v2c495++){ if (v7f370.cells[v2c495].type =="CellExpander"){ v2cf24 =v7f370.cells[v2c495]; break; } } if (v2cf24 &&(v7f370.childExpanded =="False" ||!v7f370.childExpanded)) { wgec043.m51c36(vbac38,v2cf24,"False"); wgec043.m3c399(null,v7f370); } } } v8d033 =true; break; case 27: if (v8eb47.Get("AllowAddNew")=="Yes" ||v8eb47.Get("AllowEdit")=="Yes" ||wgIsFilterRow(vcfc69)) { var vac056 =vbac38.ExitEdit(-1)[0]; if (vac056) vbac38.IsInEditMode =false; } break; case 82: if (vfc244.ctrlKey) { vbac38.Refresh(); vfc244.keyCode =0; v8d033 =true; break; } case 76: if (vfc244.ctrlKey) { wgLoadMore(vbac38.Name); vfc244.keyCode =0; v8d033 =true; break; } case 69: if (vfc244.ctrlKey) { if (typeof(wg20949.mfe332)=="function" &&vbac38.LayoutSettings.AllowExport =="Yes") { wgExport(vbac38.Name); } vfc244.keyCode =0; v8d033 =true; break; } case 115: if (wgIsFilterRow(vcfc69)) { wg85027.mb3066(vbac38.ActiveEditCell.element.childNodes[0]); vfc244.keyCode =0; v8d033 =true; } else if (vbac38.ActiveEditCell) { var vd8f47 =v8eb47.Columns.GetNamedItem(wgGetColNameByCell(vbac38.ActiveEditCell.element)); if (vd8f47 &&vd8f47.EditType =="Custom") { var v9d975 =vbac38.CustomEditors[vd8f47.CustomEditorName]; if (v9d975.ImplementationObject) v9d975.ImplementationObject.OnDropdown(); vfc244.keyCode =0; v8d033 =true; } } default: if(vfc244.keyCode>=48 &&vfc244.keyCode<=57 ||vfc244.keyCode>=54 &&vfc244.keyCode<=90 ||vfc244.keyCode>=96 &&vfc244.keyCode<=111 ||vfc244.keyCode>=186 &&vfc244.keyCode<=192 ||vfc244.keyCode>=219 &&vfc244.keyCode<=222 ||vfc244.keyCode==113 ||vfc244.keyCode ==13 ||vfc244.keyCode ==32 ||vfc244.keyCode ==229) { if (!vfc244.ctrlKey) { var vcfc69 =v62b78.element; if (v62b78.type =="Cell")vcfc69 =vcfc69.parentElement; if ((v8eb47.Get("AllowAddNew")=="Yes" &&vcfc69.type =="NewRow")||(v8eb47.Get("AllowEdit")=="Yes" &&wgIsRecordRow(vcfc69))||wgIsFilterRow(vcfc69)) { if (vfc244.shiftKey &&vfc244.keyCode ==13) { vbac38.ExitEdit(0,false); v8d033 =true; } else  { var v47550 =wg9c911.m27a2(vbac38,true); if (vfc244.keyCode ==13)v8d033 =true; else if (v47550)wg9c911.m55a32(vbac38); } } else  { var v13d18 =v8eb47.GetRowCheckerColumn(); if (v13d18) { wg85027.mba847(vcfc69); v8d033 =true; } } } else  { if (vfc244.keyCode ==84) { if (v8eb47.Get("AllowFilter")=="Yes" &&v8eb47.IsFilterRowVisible()) { vc4e70 =new SelectedObject(v62b78.tblName,v62b78.gridId,v8eb47.GetFilterRow()); vc4e70.type ="Row"; vde581 =true; } v8d033 =true; } else if (vfc244.keyCode ==32) { var v13d18 =v8eb47.GetRowCheckerColumn(); if (v13d18) { wg85027.mba847(vcfc69); v8d033 =true; } } } } } if (v68f19) { var vcfc69 =v62b78.element; if (v9f966 =="RowSelect" ||v62b78.element.type =="GroupHeader" ||vcfc69.type =="NewRow") { if (v62b78.type =="Cell")vcfc69 =vcfc69.parentElement; if (vcfc69.type =="GroupHeader" &&vcfc69.expanded =="False") { wg85027.mb1082(vbac38,wgGetCellByPosition(vcfc69,0).childNodes[0],vcfc69.expanded); wg85027.m22c96(null,vcfc69); } else if (vcfc69.type =="Record") { var v2cf24; for (var v2c495=0; v2c495<vcfc69.cells.length;v2c495++) { if (vcfc69.cells[v2c495].type =="CellExpander") { v2cf24 =vcfc69.cells[v2c495]; break; } } if (v2cf24 &&(vcfc69.childExpanded =="False" ||!vcfc69.childExpanded)) { wgec043.m51c36(vbac38,v2cf24,"False"); wgec043.m3c399(null,vcfc69); } } } } else if (v2c981) { var vcfc69 =v62b78.element; if (v9f966 =="RowSelect" ||vcfc69.type =="GroupHeader" ||vcfc69.type =="NewRow") { if (v62b78.type =="Cell")vcfc69 =vcfc69.parentElement; if (vcfc69.type =="GroupHeader" &&vcfc69.expanded =="True") { wg85027.mb1082(vbac38,wgGetCellByPosition(vcfc69,0).childNodes[0],vcfc69.expanded); wg85027.m22c96(null,vcfc69); } else if (vcfc69.type =="Record") { var v2cf24; for (var v2c495=0; v2c495<vcfc69.cells.length;v2c495++) { if (vcfc69.cells[v2c495].type =="CellExpander") { v2cf24 =vcfc69.cells[v2c495]; break; } }  if (v2cf24 &&(vcfc69.childExpanded =="True")) { wgec043.m51c36(vbac38,v2cf24,"True"); wgec043.m3c399(null,vcfc69); } } } } if (vde581) { var v66044 =ISGetObject(vc4e70.gridId); var v9a331 =v66044.Tables[vc4e70.tblName]; var v84173 =v9a331.GetSelRowStyle(); var v80798 =v9a331.GetFocusCellStyle(); var v9d046 =v66044.LayoutSettings.ImageSettings.Folder +v66044.LayoutSettings.ImageSettings.CurrentRowImage; if (vbac38.ActiveEditCell ||vbac38.LastEditObj) {  if (!wgIsSameRow(v62b78.GetRowElement(),vc4e70.GetRowElement())) { var vac056 =vbac38.ExitEdit(2)[0]; if (!vac056)return; } } if (vc4e70.type =="Row") { if (vc4e70.element.type =="NewRow") wg60540.mec16(v66044,vc4e70.element);  if (!v96e2) { wg60540.me2c56(vc4e70.element,v9d046); wg60540.ma5e17(vc4e70.element,v84173,v80798); }  if (vf1435) { var v5c55 =wgGetCellByPosition(vc4e70.element,0); v5c55.setActive();  if (vc4e70.element.type =="NewRow" ||wgIsFilterRow(vc4e70.element)||(vc4e70.element.type =="Record" &&v9a331.Get("AllowEdit")=="Yes")) wgSetLastAEC(vc4e70.element); else  { wg60540.m7794(vbac38,v5c55); v66044.ActiveEditCell =null; } } else  { if (v09750) { if (vb5975.cellIndex ==-1) { if (vc4e70.element.type =="NewRow") vb5975 =wgGetCSFirstEditableCell(vc4e70.element); } wg60540.m7794(vbac38,vb5975); vb5975.setActive(); }  }  if (v09750) { wg9c911.m96a77(vb5975); }  } else if (vc4e70.type =="Cell") { if (!wgIsSameRow(v62b78.GetRowElement(),vc4e70.GetRowElement())) { wg60540.me2c56(vc4e70.element.parentElement,v9d046); } wg60540.mf6937(vc4e70.element,v84173,v80798); vc4e70.element.setActive(); wg60540.m7794(v66044,vc4e70.element); } } if (v8d033) { event.cancelBubble =true; event.returnValue =false; }  wg_Global.LastKeyDownProcessed =v8d033; }, m7794:function(v68d14,vba671) { var v5f010 =v68d14.GetRootTable().GetElement(WG40.BODY,WG40.HTMLDIV); var v97e89 =v5f010.scrollLeft; var v10236 =v5f010.scrollTop; var v64934 =vba671.parentElement; if (v64934.type =="NewRow" ||v64934.type =="FilterRow") { tblName =wg38213.m92e89(v64934); if (v68d14.Tables[tblName].IsRootTable) { if (v5f010.childNodes[0].rows.length ==0) v5f010 =wg38213.m88693(v64934).parentElement; } } var v4fb81 =ISPosLib.getClientLeft(vba671)+vba671.offsetWidth +v5f010.scrollLeft; var v95e98 =v5f010.offsetWidth +v5f010.scrollLeft +ISPosLib.getClientLeft(v5f010); var va107 =posLib2.getLeftAbs(v68d14.FrameObj,v68d14); if (v95e98 <v4fb81)v5f010.scrollLeft +=v4fb81 -v95e98 +20; if (va107 ==0)va107 =ISPosLib.getClientLeft(v5f010); var v43339 =ISPosLib.getClientLeft(vba671)-va107; if (v43339 <0)v5f010.scrollLeft +=v43339 -20; var v73520 =ISPosLib.getClientTop(vba671); var v95f26 =v73520 +vba671.offsetHeight +17; var v91484 =ISPosLib.getClientTop(v5f010); var vc3c60 =v91484 +v5f010.offsetHeight; if (v73520 <v91484 &&v5f010.contains(vba671))v5f010.scrollTop -=v91484 -v73520; if (v95f26 >vc3c60)v5f010.scrollTop +=v95f26 -vc3c60;  if (IS.moz &&(v97e89 !=v5f010.scrollLeft ||v10236 !=v5f010.scrollTop)) wg38213.mc4423(v68d14); }};function WebGridEventDestructor(){ var vaed17 =delete wg60540;}window.attachEvent("onunload",WebGridEventDestructor);