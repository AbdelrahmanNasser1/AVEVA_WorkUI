
// Generated by Intersoft Script Optimizer V1.5 + Intersoft JS Engine MaxObfuscate(tm) V1.0 
// Generated Datetime : 12/7/2005 1:44:24 PM
// Copyright (c) 2005 Intersoft Solutions.
// Unauthorized decryption/reproduction of any codes contained herein is strictly prohibited and will result in severe civil and criminal penalties .
//**Start Encode**
var WGUI ={ CM: function(){wg85027.m99325();}, MU: function(){wg85027.m81669();}, MM: function(){wg85027.m15d12();}, DBLCL: function(){wg85027.mc7915();}, CL: function(){wg85027.m04098();}, MD: function(){wg85027.m5d530();}, KD: function(){wg85027.m27992();},  GH: function(vc2d19){return wg85027.m56152(vc2d19);}, GW: function(va8a64){return wg85027.m39425(va8a64);},  GBBCL: function(v33264){wg85027.m04098(v33264);}, GBBMM: function(){wg85027.m15d12();},  TBGH: function(v55986){return wg85027.mc2a28(v55986);}, TBRS: function(v7f886){return wg38213.m53c67(v7f886);}, TBKD: function(){return wg60540.m4145();}, TBKP: function(){return wg60540.m04c65();}, TBDBLCL: function(v9d686){return wg60540.m98b12(v9d686);}, TBKDMZ: function(){return wg9d526.m2a075();}, TBKPMZ: function(){return wg9d526.md3f95();},  TGROW: function(v9f39){return wg85027.m22c96(v9f39); }, WCIS: function(va1031,vca425){return wg9c911.mca047(va1031,vca425); }, TGCALDD: function(v25f31,vf8225){return wg9c911.me6434(v25f31,vf8225); }, TGCEDD: function(v55b31,v4d925,vf2d52){return wg9c911.mfe039(v55b31,v4d925,vf2d52); }, TGPR: function(v70254){return wg85027.m25f72(v70254); }, TGHIER: function(v87354){return wgec043.m3c399(v87354); }, TGSRR: function(v2a554){return wg85027.m40476(v2a554); }};var wg85027 ={ ma1862:function(v6ce84) { var vd1c39 =ISGetObject(v6ce84); if (!vd1c39.Get("Visible"))return; for (tableName in vd1c39.Tables) { var va2620 =vd1c39.Tables[tableName]; if (va2620.IsRootTable) wg85027.mf6633(va2620); else  { if (va2620.SubTableIds.length ==0) { wg85027.mf6633(va2620); } else  { for (tableId in va2620.SubTableIds) wg85027.mf6633(va2620,"SubTable",null,null,null,va2620.SubTableIds[tableId]); } } } vd1c39.TempResizeID =0; },  mc2a28:function(vcb386) { var vff084; var v66b6 =ISGetObject(vcb386.childNodes[0].gridId); if (!v66b6)return;  if (v66b6.CacheTBodyHeight !=null) { if (v66b6.NeedHeightResize) { v66b6.CacheTBodyHeight =null; return; } vff084 =v66b6.CacheTBodyHeight; } else  { var ve8220 =false; if (vcb386.style.display =="none")vcb386.style.display ="block"; vff084 =parseFloat(v66b6.FrameObj.style.height); if (v66b6.FrameObj.style.height !="") { if (v66b6.FrameObj.style.height.indexOf("%")>0) { vcb386.style.height =vff084; vff084 =parseFloat(v66b6.FrameObj.offsetHeight); ve8220 =true; } } if (ISPosLib.getTop(vcb386)<0) return;  vff084 -=ISPosLib.getTop(vcb386)-ISPosLib.getTop(v66b6.FrameObj); if (v66b6.LayoutSettings.StatusBarVisible) vff084-=document.getElementById("dvStatus_" +v66b6.Name).offsetHeight; if (v66b6.GetRootTable().Get("ColumnFooters")=="Yes") vff084-=v66b6.GetRootTable().GetElement(WG40.COLFOOTER,WG40.HTMLDIV).offsetHeight;  v66b6.CacheTBodyHeight =vff084; v66b6.NeedHeightResize =false; }  if (isNaN(vff084)||vff084 <=0)v66b6.NeedHeightResize =true; if (ve8220 &&vff084>0)vcb386.style.height =vff084; return vff084;  },  m56152:function(v44895) { var vb2330; var v4fa34 =ISGetObject(v44895.id.substring(0,v44895.id.length-2)); if (!v4fa34)return;  if (v4fa34.CacheFrameHeight !=null) { if (v4fa34.NeedHeightResize) { v4fa34.CacheFrameHeight =null; return; } vb2330 =v4fa34.CacheFrameHeight; } else  { var va019 =Number(parseFloat(v44895.currentStyle.borderTopWidth)); if (isNaN(va019))va019 =0; vb2330 =document.body.clientHeight -ISPosLib.getTop(v44895)+v4fa34.LayoutSettings.SizeHeightBy -(va019*2); v4fa34.CacheFrameHeight =vb2330; } if (vb2330 <=0)v4fa34.NeedHeightResize =true; return vb2330;  },  m39425:function(vc9740) { var v3f617; var v87624 =ISGetObject(vc9740.id.substring(0,vc9740.id.length-2)); if (!v87624)return;  if (v87624.CacheFrameWidth !=null) { if (v87624.NeedWidthResize) { v87624.CacheFrameWidth =null; return; } v3f617 =v87624.CacheFrameWidth; } else  { v3f617 =document.body.clientWidth -ISPosLib.getLeft(vc9740)+v87624.LayoutSettings.SizeWidthBy -wg85027.m99174(); v87624.CacheFrameWidth =v3f617; v87624.NeedWidthResize =false; } return v3f617; },  m99174:function() { if (document.body.style.overflow =="hidden" ||document.body.scroll =="no" ||IS.moz)return 0; else return 0; },  mc1898:function(v67a29) { if (v67a29 &&(v67a29.tagName =="TD" ||v67a29.tagName =="SPAN" ||v67a29.tagName =="NOBR")&&!v67a29.hasTooltip) { if (v67a29.tagName =="NOBR") { v67a29 =v67a29.parentElement; if (!v67a29) { wg_Global.TTId =0; return; } }  if (v67a29.hasTooltip ||(IS.moz &&v67a29.attributes["hasTooltip"] !=null))return; var vf8540 =false; if (v67a29.innerText !="" &&v67a29.innerText !=" " &&v67a29.scrollWidth >v67a29.offsetWidth &&v67a29.childNodes.length <3) vf8540 =true; else if (v67a29.tagName =="SPAN" &&typeof(v67a29.content)!="undefined") { if (v67a29.scrollHeight >v67a29.offsetHeight) vf8540 =true; else  { var v8f017 =wg38213.mb6c95(v67a29); if (!v8f017)return; if (v8f017.innerText !="" &&v8f017.scrollWidth >v8f017.offsetWidth)vf8540 =true; } }  if (IS.moz)vf8540 =true; if (vf8540) v67a29.title =v67a29.innerText; else v67a29.title =""; } wg_Global.TTId =0;  },  m56c8:function(v2ac31) { var vbf852 =v2ac31.GetRootTable().GetElement(WG40.BODY,WG40.HTMLDIV); var v5a384 =document.getElementById(v2ac31.Name +"_ND"); if (!v5a384) { v5a384 =document.createElement("DIV"); v5a384.id =v2ac31.Name +"_ND"; v5a384.className =v2ac31.RowClass; v5a384.style.cssText ="position:relative; width:100%; text-align: center; background: transparent"; vbf852.insertAdjacentElement("beforeEnd",v5a384); }  var vde866 =vbf852.offsetHeight; if (vde866 ==0)vde866 =v2ac31.FrameObj.offsetHeight; if (vde866 ==0) { setTimeout(function(){wg85027.m56c8(v2ac31);},100); return; } var v45b22 =""; try  { v45b22 =v2ac31.GetString("CommonText/NoData"); }catch(e) { setTimeout(function(){wg85027.m56c8(v2ac31);},100); return; } v5a384.innerText =v45b22; v5a384.style.top =(vde866-20)/2; v5a384.style.display ="";  },  md3921:function(v47254) { var v0e731 =document.getElementById(v47254.Name +"_ND"); if (v0e731)v0e731.style.display ="none"; },  m83814:function(vef998) { var v58854 =vef998.childNodes[1]; v58854.innerHTML =""; wg85027.m8a489(vef998); },  m1476:function(v97866) { return v97866.parentElement.parentElement.parentElement.parentElement.removeNode(true); },  m3e055:function(v5b866) { return v5b866.parentElement.parentElement.parentElement.parentElement.previousSibling.removeNode(true); },  m52019:function(vb4e55,v3d066) { var vf1c66 =vb4e55.Grid; var v5fe92 =vf1c66.GetElement(WG40.GROUPBYBOX,WG40.HTMLTABLE);  if (!vb4e55.IsRootTable) { if (v3d066) tr =v5fe92.insertRow(v3d066); else tr =v5fe92.insertRow();  tr.id ="trGBBRowSep_" +vf1c66.Id +"_" +vb4e55.Name;  var v40b52 =tr.insertCell(-1); v40b52.innerHTML ="<table tblName='" +vb4e55.Name +"' gridId='" +vf1c66.Id +"' cellSpacing=0 cellPadding=1 border=0 style='cursor: default'" +(IS.moz ? ";table-layout:fixed" : "")+"><tbody><tr></tr></tbody></table>"; var v31310 =v40b52.childNodes[0].childNodes[0].childNodes[0]; var v1f362 =vb4e55.GetParentTreeStructure();  for (var v12017=1; v12017<=parseFloat(vb4e55.TableLevel); v12017++) { var vad61 =v31310.insertCell(-1); vad61.style.cssText ="width:25px; height: 3px; margin: 0; padding:0"; if (v12017 ==parseFloat(vb4e55.TableLevel)||v1f362[v12017] =="Continuos") { vad61.innerHTML =wgec043.m7cb23(vf1c66,"I"); } } } },  m4752:function(v4cf69,vf2974) { var va630 =v4cf69.Grid; var vb5353 =va630.GetElement(WG40.GROUPBYBOX,WG40.HTMLTABLE);  if (vf2974) tr =vb5353.insertRow(vf2974); else tr =vb5353.insertRow();  tr.id ="trGBB_" +va630.Id +"_" +v4cf69.Name;  var vaf746 =tr.insertCell(-1); vaf746.innerHTML ="<table tblName='" +v4cf69.Name +"' gridId='" +va630.Id +"' cellSpacing=0 cellPadding=1 border=0 style='cursor: default" +(IS.moz ? ";table-layout:fixed" : "")+"'><tbody><tr></tr></tbody></table>";  var v8a991 =vaf746.childNodes[0].childNodes[0].childNodes[0];  if (!v4cf69.IsRootTable) { var va9871 =v4cf69.GetParentTreeStructure(); for (var ve2660=1; ve2660<parseFloat(v4cf69.TableLevel); ve2660++) { var vaad89 =v8a991.insertCell(-1); vaad89.style.cssText ="width:25px; height: 15px; margin: 0; padding:0"; if (ve2660 ==parseFloat(v4cf69.TableLevel)||va9871[ve2660] =="Continuos") { vaad89.innerHTML =wgec043.m7cb23(va630,"I"); } }  var v5d351 =v4cf69.GetParentTables().length; var vaad89 =v8a991.insertCell(-1); vaad89.style.cssText ="width:25px; height: 100%; margin: 0; padding:0"; vaad89.align ="right"; vaad89.vAlign ="top"; if (v5d351 ==1 ||v5d351 >1 &&!v4cf69.HasNextSiblingGroupedColumns()) vaad89.innerHTML =wgec043.m7cb23(va630,"Last"); else vaad89.innerHTML =wgec043.m7cb23(va630,"Continous"); }  var v29e21 =v8a991.insertCell(-1); var vd6a16 =v4cf69.CaptionImage; v29e21.className =va630.GBBLabelClass;  if (vd6a16 !="") { var v40581 =""; if (vd6a16.substring(0,1)=="/" ||vd6a16.substring(0,1)==".") v40581 =vd6a16; else v40581 =va630.LayoutSettings.ImageSettings.Folder +vd6a16; v29e21.innerHTML ="<img align='absmiddle' src='" +v40581 +"'>&nbsp;"; }  v29e21.innerHTML +=v4cf69.Caption; return tr; },  med985:function(v43618,v9fa42) { var v47e92 =v9fa42.currentStyle.fontSize; if (v47e92 =="")v47e92 ="8pt"; var vc0867 =v9fa42.childNodes[1]; var vfab33 =v43618.LayoutSettings.ImageSettings.Folder; var vc1f66 ="5"; var v5f140 ="6"; wg85027.m8a489(v9fa42);  if (IS.moz) { vc1f66 ="<font face='Webdings'>5</font>"; v5f140 ="<font face='Webdings'>6</font>"; } if (v9fa42.sortOrder =="Ascending") { var vd8721 =v43618.LayoutSettings.ImageSettings.SortAscImage; if (vd8721 =="") vc0867.innerHTML ="<span class='DefSIcon' style='font-size:" +v47e92 +"; color: black'>" +vc1f66 +"</span>"; else vc0867.innerHTML ="<img align='absmiddle' src='" +vfab33 +vd8721 +"'>"; } else if (v9fa42.sortOrder =="Descending") { var v44814 =v43618.LayoutSettings.ImageSettings.SortDescImage; if (v44814 =="") vc0867.innerHTML ="<span class='DefSIcon' style='font-size:" +v47e92 +"; color: black'>" +v5f140 +"</span>"; else vc0867.innerHTML ="<img align='absmiddle' src='" +vfab33 +v44814 +"'>"; } else  { wg85027.m83814(v9fa42); } },  m88177:function(v71640) { var vc2140; var va8936 =ISGetObject(v71640.gridId); vc2140 =document.createElement("DIV"); vc2140.onselectstart =function(){return false;}; vc2140.style.cssText =va8936.DraggerStyle +"; width:" +v71640.offsetWidth +"; height:" +v71640.offsetHeight +";" ; vc2140.className =v71640.className; vc2140.innerHTML =v71640.innerHTML; if (va8936) va8936.FrameObj.appendChild(vc2140); else document.body.appendChild(vc2140); return vc2140;  },  mb8294:function(v18530) { var va6b8; va6b8 =document.createElement("IMG"); va6b8.src =v18530.LayoutSettings.ImageSettings.Folder +v18530.LayoutSettings.ImageSettings.ColumnPointerImage; va6b8.style.cssText ="position: absolute; display: none;"; if (v18530) v18530.FrameObj.appendChild(va6b8); else document.body.appendChild(va6b8); return va6b8;  },  mf3389:function(va3230) { var v57e30; v57e30 =document.createElement("DIV"); v57e30.onselectstart =function(){return false;}; v57e30.onmouseup =wg85027.m81669; v57e30.style.cssText =va3230.ResizerStyle; if (va3230) va3230.FrameObj.appendChild(v57e30); else document.body.appendChild(v57e30); return v57e30;  },  mcfb80:function(v23472,v35512) { var v53530 =new wgHeaderInfo(); var v0e09 =ISGetObject(v35512.gridId); var va699 =posLib2.getLeftAbs(v0e09.FrameObj,v0e09); var vd6b88 =posLib2.getTopAbs(v0e09.FrameObj,v0e09);  v53530.AllowRightInsert =true; v53530.PosLeft =ISPosLib.getLeft(v23472)-5 -va699; v53530.PosRight =v53530.PosLeft +v23472.offsetWidth; v53530.PosTop =ISPosLib.getTop(v23472)-11 -vd6b88; v53530.Type ="GroupInfo"; v53530.Element =v23472; v53530.ProperPosition =v53530.PosRight;  return v53530; },  mb9342:function(v9217) { var v8b462 =v9217.childNodes[0].childNodes[0].childNodes[0].childNodes[0]; return v8b462.cells[v8b462.cells.length-1]; },  mc3749:function(v23551) { var va207 =v23551.childNodes[0].childNodes[0].childNodes[0].childNodes[0]; for (var vcdd73=0; vcdd73<va207.cells.length; vcdd73++) { if (va207.cells[vcdd73].type =="GroupColumn") return va207.cells[vcdd73]; } return null; },  m69f26:function(va2d51,v0a560) { var v4ba51 =document.getElementById("trGBB_" +va2d51 +"_" +v0a560); return (v4ba51); },  ma5d85:function(vb4174,vd0053,vda265) { var v39074 =wg85027.m69f26(vb4174,vd0053); if (v39074) { var v03053 =v39074.childNodes[0].childNodes[0].childNodes[0].childNodes[0].cells; for (var v6e365=0; v6e365<v03053.length; v6e365++) { if (v03053[v6e365].type =="GroupColumn") { if (v03053[v6e365].colName ==vda265)return true; } } } return false; }, m44e78:function(vad631,v2e37,vd5658) { var vbf696 =new wgHeaderInfo(); var vd2847 =ISGetObject(vd5658.gridId); var v89c64 =posLib2.getLeftAbs(vd2847.FrameObj,vd2847); var v35798 =posLib2.getTopAbs(vd2847.FrameObj,vd2847);  vbf696.AllowRightInsert =true; vbf696.PosLeft =ISPosLib.getLeft(vad631)-v89c64; vbf696.PosRight =vbf696.PosLeft +vad631.offsetWidth; vbf696.PosTop =ISPosLib.getTop(vad631)-v35798; vbf696.Type ="Unknown"; vbf696.Element =vad631;  if (vad631.type =="Column" ||vad631.type =="GroupColumn") { vbf696.Type =vad631.type; if (vad631.type =="GroupColumn") { vbf696.PosLeft -=5; vbf696.PosRight -=5; vbf696.PosTop -=10; } var vf2242 =(vbf696.PosRight -vbf696.PosLeft)/2; if (v2e37 >=vbf696.PosLeft+v89c64 &&v2e37 <=vf2242 +vbf696.PosLeft+v89c64) vbf696.ProperPosition =vbf696.PosLeft; else vbf696.ProperPosition =vbf696.PosRight; } return vbf696; },  m83922:function(v25c48,v03e96,vdca26) { var vda865 =v03e96.getAttribute("elLeft"); var v43b68 =v03e96.getAttribute("elTop"); var vff052 =event.clientX; var v0d959 =event.clientY; var v35a59 =null; if (IS.ie) v35a59 =document.elementFromPoint(vff052,v0d959); else v35a59 =event.srcElement;  if (v35a59) { wg38213.m79d94(v35a59); if (v35a59.id.indexOf("GBB")>=0 ||v35a59.id.indexOf("GBB")>=0 ||(v35a59.tagName =="TD" &&v35a59.className.indexOf("Header")&&v35a59.type =="GroupColumn")||((v35a59.tagName =="SPAN" ||v35a59.tagName =="IMG")&&v35a59.parentElement.type =="GroupColumn")) { var v0b33 =ISGetObject(v03e96.gridId); var v36062 =v0b33.Tables[v03e96.tblName]; var v4c58 =v03e96.parentElement; var v23a89 =v0b33.GetElement(WG40.GROUPBYBOX,WG40.HTMLTABLE); var t,v2dc53; var v2a189 =v0b33.HasGroup(); v03e96.groupExist =false;  if (!v2a189) { if (v23a89.style.display =="")t =v23a89.rows[0].cells[0]; v2dc53 =wg85027.mcfb80(t,v03e96); } else { if (v35a59.tagName =="SPAN")v35a59 =v35a59.parentElement; if (v35a59.tagName =="DIV") { var v6ca3 =wg85027.m69f26(v0b33.Name,v36062.Id); v03e96.groupExist =(v6ca3 !=null); if (v6ca3) { var v9cb44 =wg85027.mb9342(v6ca3); t =v9cb44; v2dc53 =wg85027.mcfb80(t,v03e96); } else  { v6ca3 =wg85027.m69f26(v0b33.Name,v0b33.RootTable.Name); var v9cb44 =wg85027.mb9342(v6ca3); t =v9cb44; v2dc53 =wg85027.mcfb80(t,v03e96); } } else if (v35a59.tagName =="TD" &&v35a59.type =="GroupColumn") { if (v35a59.type =="GroupColumn" &&v03e96.type =="GroupColumn") { if (v35a59.tblName !=v03e96.tblName) { var vd5818 =new wgHeaderInfo(); vd5818.Type ="Unknown"; return vd5818; } } t =v35a59; v2dc53 =wg85027.m44e78(t,vff052,v03e96); } } return v2dc53; } else  { var v2dc53 =new wgHeaderInfo(); v2dc53.Type ="Unknown"; if ((v35a59.tagName =="SPAN" )||v35a59.tagName =="NOBR") v35a59 =wg38213.mb6c95(v35a59); if (v35a59 &&v35a59.tagName =="TD") { var v0b33 =ISGetObject(v03e96.gridId); var v36062 =v0b33.Tables[v03e96.tblName]; var v4c58 =v03e96.parentElement;  if (v36062.Id !=wg38213.m92e89(v35a59.parentElement)) return v2dc53; else  { if (v4c58 !=v35a59.parentElement &&v03e96.type !="GroupColumn" )return v2dc53; } return wg85027.m44e78(v35a59,vff052,v03e96); }else { if (!vdca26){ return v2dc53; }else return v2dc53; } } } return false;  },  mb5c23:function(v1b617,v53217,v2eb14) { var v6c050 =(v2eb14)? "afterEnd" : "beforeBegin"; v1b617.removeNode(true); v53217.insertAdjacentElement(v6c050,v1b617); },  m7841:function(v94f34) { var v5e372 =wg_Global.MoveColEventArgs; var v48288 =v5e372.table; var v5cd74 =ISGetObject(v48288.GridId); var v92012 =v5e372.tr; var ve9a24 =v48288.GetElement(WG40.BODY,WG40.HTMLTABLE,v92012); var v3a564 =v5e372.cdt; var v61465 =v5e372.th; var vd0837 =v5e372.c1; var v9ff16 =v5e372.c2; var vcba58 =v48288.GetElement(WG40.COLGROUP,null,v92012).childNodes[vd0837]; var vd9a3 =v48288.GetElement(WG40.COLGROUP,null,v92012).childNodes[v9ff16]; wg85027.mb5c23(v3a564,v61465.Element,vd0837 >v9ff16 );  if (v48288.IsRootTable &&v48288.Get("AllowFilter")=="Yes") { var v87a15 =v48288.GetFilterRow(v92012); wg85027.mb5c23(v87a15.cells[v9ff16],v87a15.cells[vd0837],vd0837 >v9ff16); }  if (v48288.Get("AllowAddNew")=="Yes") { var v45564 =v48288.GetNewRow(v92012); var vb1822 =false; var vde121 =v45564.cells;  for (var v2107=0; v2107<vde121.length; v2107++) { if (vde121[v2107].type =="NewRowInfoCell") { vb1822 =true; break; } } if (!vb1822) wg85027.mb5c23(v45564.cells[v9ff16],v45564.cells[vd0837],vd0837 >v9ff16); } wg85027.mb5c23(vd9a3,vcba58,vd0837 >v9ff16); var v55f47 =v48288.GetElement(WG40.BODY,WG40.HTMLTABLE,v92012).rows;  for (var v2107=0; v2107<v55f47.length; v2107++) { var v8df49 =v55f47[v2107]; wg38213.m79d94(v8df49); if (v8df49.type =="Record" ||v8df49.type =="GroupTotalRow") wg85027.mb5c23(v8df49.cells[v9ff16],v8df49.cells[vd0837],vd0837 >v9ff16); }  if (v48288.Get("ColumnFooters")=="Yes") { var v7852 =v48288.GetElement(WG40.COLFOOTERGROUP,null,v92012).childNodes[vd0837]; var v97364 =v48288.GetElement(WG40.COLFOOTERGROUP,null,v92012).childNodes[v9ff16]; wg85027.mb5c23(v97364,v7852,vd0837 >v9ff16); var vdc78 =v48288.GetElement(WG40.COLFOOTER,WG40.HTMLTABLE,v92012).rows[1]; wg85027.mb5c23(vdc78.cells[v9ff16],vdc78.cells[vd0837],vd0837 >v9ff16); }  if (!v94f34) { if (!v48288.IsRootTable)wgec043.m39b87(); wg85027.m38f29(v48288,v92012); if (v5cd74.LastSelObj) { var v58b49 =v5cd74.LastSelObj.element; if (v58b49) { if (v58b49.tagName =="TR") { wg60540.m37291(v58b49,"Redraw"); } else wg60540.medb21(v58b49); } } wg_Global.MoveColEventArgs =null; v5cd74.SetStatus1("","ready","CommonText/Ready"); } },  m38974:function(v86c18,vf3290,v01663,va2b9,vbbb88) { var v4121 =vf3290.parentElement; if (v86c18.IsUseColumnSet) { if (vf3290.type =="Column") { var v4fd44 =v86c18.GetElement(WG40.COLHEADERGROUP,null,v4121); var vc3637 =v86c18.GetColHeaderSpanCount()+v86c18.GetCSCellPosByIndex(vf3290.cs,vf3290.r,vf3290.c); var v31910 =v86c18.GetColHeaderSpanCount()+v86c18.GetCSCellPosByIndex(vf3290.cs,vf3290.r,vf3290.c,true); var vf4629 =v01663;  if (vc3637 !=v31910) { var v87b98 =0; for (var v53943=vc3637; v53943<v31910; v53943++) v87b98 +=parseFloat(v4fd44.childNodes[v53943].width);  vf4629 -=v87b98; }  if (vf4629 <20)vf4629 =20;  wg85027.mf3248(v86c18,v4121,v4fd44,v31910,vf4629);  if (!va2b9) { v86c18.UpdateRowLayoutWidth(vf3290.cs,parseFloat(vf3290.c)+(v31910-vc3637),vf4629); } vf3290.estWidth =v01663; } else if (vf3290.type =="CSHeader") { var v4fd44; if (v4121) v4fd44 =v86c18.GetElement(WG40.COLHEADERGROUP,null,v4121);  var vbfb94 =v86c18.GetColumnSetByPos(vf3290.pos); var vc3637 =v86c18.GetColHeaderSpanCount()+v86c18.GetCSHeaderCellPosByIndex(vf3290); var v31910 =vc3637 +parseInt(vbfb94.ColumnCount); var v0f52 =0;  if (v4121) v0f52 =wgGetCSHeaderWidth(v86c18,vf3290); else v0f52 =v86c18.GetCSHeaderWidth(vf3290.pos); var vdda0 =0;  for (var v53943=vc3637; v53943<v31910; v53943++) { var v98d20 =0; if (v4fd44) v98d20 =parseInt(v4fd44.childNodes[v53943].width); else v98d20 =parseInt(v86c18.GetRowLayoutByIndex(vf3290.pos,0,vdda0).Width);  var vf4214 =(v98d20/v0f52)*100; var vb751 =parseInt((vf4214/100)*v01663);  if (!isNaN(vb751)) { if (v4fd44) wg85027.mf3248(v86c18,v4121,v4fd44,v53943,vb751); if (!va2b9) v86c18.UpdateRowLayoutWidth(vf3290.pos,vdda0,vb751); } vdda0++; }  vf3290.estWidth =v01663; } } else  { vf3290.oldWidth =vf3290.offsetWidth; IS.SetWidth(vf3290,v01663); wg85027.m8a489(vf3290); v86c18.GetElement(WG40.COLGROUP,null,v4121).childNodes[vf3290.cellIndex].width =v01663;  if (IS.moz) { wg9d526.m6dd17(v86c18,vf3290,WG40.BODY); }  if (v86c18.Get("ColumnFooters")=="Yes") { var v8a490 =v86c18.GetElement(WG40.COLFOOTERGROUP,null,v4121); v8a490.childNodes[vf3290.cellIndex].width =v01663; if (IS.moz) wg9d526.m6dd17(v86c18,vf3290,WG40.COLFOOTER); }  wg85027.m7e070(v86c18,v4121,vf3290,v01663); }  wg_Global.ColSizeTarget =vf3290;  if (!va2b9) { if (!v86c18.IsRootTable) { if (!v86c18.IsUseColumnSet)wgec043.mf7d36(vf3290); wgec043.mdc68(); }  if (!v86c18.IsUseColumnSet &&!vbbb88) wg85027.m38f29(v86c18,v4121); if (!vbbb88) wg85027.mf6633(v86c18,"Resize",vf3290,v01663);  if (vf3290.type =="CSHeader") wgFlushUpdates();  } },  mf3248:function(vbec52,vfef51,v8b157,v55590,v82597) { v8b157.childNodes[v55590].oldWidth =v8b157.childNodes[v55590].width; v8b157.childNodes[v55590].width =v82597; vbec52.GetElement(WG40.COLGROUP,null,vfef51).childNodes[v55590].width =v82597;  if (vbec52.Get("ColumnFooters")=="Yes") vbec52.GetElement(WG40.COLFOOTERGROUP,null,vfef51).childNodes[v55590].width =v82597;  },  m7e070:function(v80020,vd5d31,v0d254,v72f30) { if (v80020.IsUseColumnSet) { if (v80020.Get("AllowFilter")=="Yes") { var vb8d20 =v80020.GetFilterRow(vd5d31); if (vb8d20) { try { var vffd31 =wgGetCSCellByPosition(vb8d20,v0d254.r,v0d254.c,v0d254.cs); var v35b54 =vffd31.childNodes[0];  if (v72f30 -18 >0) v35b54.style.width =v72f30 -18; else  v35b54.style.width =18;  if (IS.moz) wg9d526.m73a36(vffd31,v72f30);  }catch(e){} } } } else  { if (v80020.Get("AllowFilter")=="Yes"){ var vb8d20 =v80020.GetFilterRow(vd5d31); if (vb8d20) { try { var vffd31 =vb8d20.cells[v0d254.cellIndex]; var v35b54 =vffd31.childNodes[0]; if (v72f30 -16 >0) v35b54.style.width =v72f30 -16; else  v35b54.style.width =16; if (IS.moz) wg9d526.m73a36(vffd31,v72f30); }catch(e){} } } } },  m69b38:function(v50e35) { var ve5642 =v50e35; var vff825 =ve5642.parentElement; var v46553 =wg38213.m88693(vff825); var veb244 =ISGetObject(v46553.gridId); var v2b13 =veb244.Tables[v46553.tblName]; var v9ed2 =v2b13.GetElement(WG40.BODY,WG40.HTMLTABLE,vff825); var v69635 =ve5642.scrollWidth; var vf8139 =v69635; if (v2b13.IsUseColumnSet) { for (var v3d363=0; v3d363<v9ed2.rows.length; v3d363++) { var v15a82 =v9ed2.rows[v3d363]; wg38213.m79d94(v15a82); if (wgIsRecordRow(v15a82)) { var vb4b83 =wgGetCellByName(v15a82,v50e35.colName); var vef758 =vb4b83.scrollWidth; if (IS.moz)vef758 =vb4b83.childNodes[0].offsetWidth;  if (vb4b83 &&v15a82.csRowPos ==vff825.csRowPos &&vef758 >vf8139) vf8139 =vef758; } } } else  { for (var v3d363=0; v3d363<v9ed2.rows.length; v3d363++) { wg38213.m79d94(v9ed2.rows[v3d363]);  if (v9ed2.rows[v3d363].type =="Record") { var vef758 =v9ed2.rows[v3d363].cells[ve5642.cellIndex].scrollWidth; if (IS.moz)vef758 =v9ed2.rows[v3d363].cells[ve5642.cellIndex].childNodes[0].offsetWidth; if (vef758 >vf8139) vf8139 =vef758; } } }  if (IS.moz &&vf8139 !=v69635)vf8139 +=4; if (vf8139 -ve5642.offsetWidth ==4)return;  if (!ISEvent.Raise(veb244.LayoutSettings.ClientSideEvents.OnColumnResize,veb244.Name,v2b13.Id,ve5642,vf8139))return; wg85027.m38974(v2b13,ve5642,vf8139); if (v2b13.IsUseColumnSet) { if (!v2b13.IsRootTable) wgec043.maf056(ve5642,vf8139); } else  { if (!v2b13.IsRootTable) { wgec043.mf7d36(ve5642); wgec043.maf056(ve5642); } wg85027.m38f29(v2b13,vff825); wg85027.mf6633(v2b13,"Resize",ve5642,vf8139); } },  m8a489:function(v6d048,v7aa47) { if (v6d048.sortOrder =="None") { v6d048.childNodes[0].style.width ="100%"; } else  { var v8d535; if (v6d048.style.width =="")v6d048.style.width =v6d048.offsetWidth; if (v7aa47)v8d535 =v7aa47; else v8d535 =v6d048.style.width; var vee680 =parseInt(v8d535)-20; if (vee680 <0)vee680 =0; v6d048.childNodes[0].style.width =vee680; } },  m38f29:function(va1261,v50755) { var v02492 =ISGetObject(va1261.GridId); var v2af34; if (va1261.IsRootTable) v2af34 =va1261.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,v50755).childNodes[0].childNodes[0]; else  { try  { v2af34 =va1261.SubTableIds[0].GetElement(WG40.COLHEADER,WG40.HTMLTABLE).childNodes[0].childNodes[0]; } catch(e) { return ; } }  var vd8924 =0; var vbc434 =va1261.Get("HideColumnsWhenGrouped"); var vcd296 =new ISArray();  for (var v4c245=0; v4c245<v2af34.cells.length; v4c245++) { wg38213.m79d94(v2af34.cells[v4c245]); if (v2af34.cells[v4c245].type =="Column") { var v54429 =va1261.Columns.GetNamedItem(v2af34.cells[v4c245].colName); v54429.Position =vd8924; if (IS.ie) v54429.Width =v2af34.cells[v4c245].style.width; else v54429.Width =v2af34.cells[v4c245].offsetWidth; vcd296.Add(v54429); vd8924++; } }  if (vbc434 =="Yes") { for (var v4c245=0; v4c245<va1261.GroupedColumns.length; v4c245++) { var v54429 =va1261.Columns.GetNamedItem(va1261.GroupedColumns[v4c245].ColumnMember); v54429.Position =vd8924; v54429.Visible =false; v54429.IsGrouped =true; vcd296.Add(v54429); vd8924++; } }  for (var v4c245=0; v4c245<va1261.GroupedColumns.length; v4c245++) { var v1c348 =va1261.GroupedColumns[v4c245].ColumnMember; var v54429 =vcd296.GetNamedItem(v1c348); if (!v54429) { v54429 =va1261.GetColumn(v1c348); v54429.Position =vd8924; vcd296.Add(v54429); vd8924++; } }  for (var v4c245=0; v4c245<va1261.Columns.length; v4c245++) { var v54429 =va1261.Columns[v4c245]; var v0ab88 =false;  if (!v54429.Visible &&!v54429.IsGrouped) { v54429.Position =vd8924; v0ab88 =true; }  if (v54429.ForceVisible) { v54429.Visible =true; if (vcd296.IndexOf(v54429)==-1) { v54429.Position =vd8924; v0ab88 =true; } }  if (v0ab88) { vcd296.Add(v54429); vd8924++; } }  vcd296.InitializeFrom(va1261.Columns); va1261.Columns =vcd296; va1261.Columns.UpdateChanges(); v02492.UpdateState();  },  md3342:function(vf1e84) { wg85027.m9da6(vf1e84); wg85027.mb8075(vf1e84); wg85027.mf6c40(vf1e84); },  m9da6:function(v94738) { var v33284 =null; var vdde48 =v94738.Grid; if (vdde48.HeaderContext) v33284 =vdde48.HeaderContext.parentElement; for (var vdcc11=0; vdcc11<v94738.GroupedColumns.length; vdcc11++) { var v7eb8 =v94738.GroupedColumns[vdcc11]; var v3e666 =v94738.Columns.GetNamedItem(v7eb8.ColumnMember);  if (v7eb8._UIState =="Added") wg85027.m3e622(v3e666); else if (v7eb8._UIState =="PositionChanged") wg85027.m91617(v7eb8); else if (v7eb8._UIState =="Changed") { var vbca5 =v7eb8.GetElement(); vbca5.sortOrder =v3e666.SortOrder; wg85027.m83814(vbca5); wg85027.med985(vdde48,vbca5);  if (v94738.IsUseColumnSet ||vdde48.LayoutSettings.HideColumnsWhenGrouped =="No") { var v11853 =null; var vd8f10 =true;  try { v11853 =v3e666.GetElement(); } catch(e) { vd8f10 =false; }  if (vd8f10) { v11853.sortOrder =v3e666.SortOrder; wg85027.m83814(v11853); wg85027.med985(vdde48,v11853); } } } else if (v7eb8._UIState =="Removed") { v94738.GroupedColumns.Remove(v7eb8); wg85027.m4e11(v7eb8); vdcc11--; }  v7eb8._UIState ="Unchanged"; } if (!v94738.IsUseColumnSet) wg85027.m38f29(v94738,v33284);  if (!v94738.IsRootTable) wgec043.m26c31(vdde48);  v94738.GroupedColumns.UpdateChanges(); },  mb8075:function(vead83) { var vf3260 =null; var v0c612 =vead83.Grid; if (v0c612.HeaderContext) vf3260 =v0c612.HeaderContext.parentElement; for (var v64a71=0; v64a71<vead83.SortedColumns.length; v64a71++) { var v07464 =vead83.SortedColumns[v64a71]; var vd4b26 =vead83.Columns.GetNamedItem(v07464.ColumnMember);  var vde332 =vd4b26.GetElement(); if (vde332 ==null)vde332 =v07464.GetElement(); vd4b26.IsSorted =true; vd4b26.SortOrder =vde332.sortOrder =v07464.SortOrder;  if (v07464._UIState =="Added") { } else if (v07464._UIState =="Changed") { if (v07464.SortOrder =="None") vead83.SortedColumns.Remove(v07464,true); }  if (v07464._UIState =="Removed") { vead83.SortedColumns.Remove(v07464); vd4b26.IsSorted =false; vd4b26.SortOrder =vde332.sortOrder ="None"; v64a71--; } wg85027.med985(v0c612,vde332);  v07464._UIState ="Unchanged"; }  vead83.SortedColumns.UpdateChanges(); },  mf6c40:function(vc7562) { var vdd483 =null; var v1695 =vc7562.Grid; if (v1695.HeaderContext) vdd483 =v1695.HeaderContext.parentElement; for (var vfc070=0; vfc070<vc7562.FilteredColumns.length; vfc070++) { var vf8378 =vc7562.FilteredColumns[vfc070]; var v75d77 =vc7562.Columns.GetNamedItem(vf8378.ColumnMember);  var v4266 =v75d77.GetElement(); var v3cb27 =vf8378.GetElement();  if (vf8378._UIState =="Added" ||vf8378._UIState =="Changed") { v3cb27.oldCellValue =v3cb27.cellValue =v3cb27.childNodes[0].value =v3cb27.filterText =vf8378.FilterText; v3cb27.filterType =wg20949.m2dc42(vf8378.FilterType); if (v75d77.GetFilterEditType()=="Checkbox") wg9c911.mcf282(v3cb27).checked =v3cb27.cellValue; else if (v75d77.GetFilterEditType()=="WebComboNET" ||v75d77.GetFilterEditType()=="DropdownList") { } else v3cb27.childNodes[0].innerText =v3cb27.cellValue; }  if (vf8378._UIState =="Removed") { if (v3cb27) { v3cb27.oldCellValue =v3cb27.cellValue =v3cb27.childNodes[0].value =v3cb27.filterText =""; v3cb27.filterType ="0"; if (v75d77.GetFilterEditType()=="Checkbox") wg9c911.mcf282(v3cb27).checked =false; else v3cb27.childNodes[0].innerText =""; }  vc7562.FilteredColumns.Remove(vf8378); vfc070--; }  if (IS.moz &&v3cb27) wg9d526.m73a36(v3cb27,v3cb27.offsetWidth); vf8378._UIState ="Unchanged"; }  vc7562.FilteredColumns.UpdateChanges(); },  m8df82:function(v5a119,va606) { var vdb562 =wg85027.mc3749(v5a119); var v30a52 =-1;  if (!vdb562) v30a52 =wg85027.mb9342(v5a119); else v30a52 =vdb562.cellIndex +(va606*2);  return v30a52; },  m88b63:function(v47031,vb1273) { var va5264 =wg38213.m4f814(v47031); va5264.IsGrouped =true; if (va5264.SortOrder =="None") va5264.SortOrder ="Ascending";  var v66f93 =new WebGridGroup(); v66f93.ColumnMember =v66f93.Name =va5264.Name; v66f93.SortOrder =va5264.SortOrder;  if (typeof(vb1273)=="undefined") va5264.Table.GroupedColumns.Add(v66f93); else va5264.Table.GroupedColumns.InsertAt(v66f93,vb1273);  return v66f93; },  m3e622:function(v65660,v94287) { var vb0a21 =wg85027.m69f26(v65660.GetGrid().Id,v65660.Table.Id); var v8af47 =false; var vd9445 =false;  if (vb0a21) { if (!wg85027.ma5d85(v65660.GetGrid().Id,v65660.Table.Id,v65660.Name))vd9445 =true; } else  { v8af47 =true; vd9445 =true; }  if (!v8af47 &&!vd9445)return false;  var v7fa0 =v65660.GetGrid(); var v45d13 =v65660.Table; var v37e79 =v7fa0.FrameObj.style.posLeft;  if (v8af47) { var v7c480 =-1; if (!v45d13.IsRootTable) { wgec043.md7172(v65660); v7c480 =wgec043.mb1d65(v65660,v45d13.Parent.Name); wg85027.m52019(v45d13,v7c480+1); v7fa0.NeedHeightResize =true; } vb0a21 =wg85027.m4752(v45d13,v7c480+2); }  if (vd9445) { var v3c119 =vb0a21.childNodes[0].childNodes[0].childNodes[0].childNodes[0]; var vc972 =null; var v9be13 =null; var v47385 =null; var v36f51 =v7fa0.GetElement(WG40.GROUPBYBOXLABEL,WG40.HTMLROW); if (v36f51.style.display =="")v36f51.style.display ="none";  if (!v45d13.IsRootTable &&v7fa0.HeaderContext) v47385 =v7fa0.HeaderContext.parentElement;  v9be13 =v65660.GetElement(v47385); v9be13.tblName =v45d13.Id; var v44e6 =v45d13.GroupedColumns.GetNamedItem(v65660.Name); if (v44e6.Index <v45d13.GroupedColumns.length-1) { var v1269 =v44e6.Index; if (v1269 <0)v1269 =0;  vc972 =wg85027.m8df82(vb0a21,v1269)-1; }  if (vc972) { var v5a557 =wg85027.mc3749(vb0a21); if (v5a557) if (vc972 <v5a557.cellIndex)vc972 =v5a557.cellIndex-1; }  var v09127; if (vc972 &&!v8af47) v09127 =v3c119.insertCell(vc972); else v09127 =v3c119.insertCell(-1);  v09127.style.cssText ="width: 16px; padding: 0px";  var vfe032 =v7fa0.LayoutSettings.GroupByBox.ConnectorLineColor; v09127.innerHTML ="<hr size=1 style='border-color: " +vfe032 +" ; border-style: " +v7fa0.LayoutSettings.GroupByBox.ConnectorLineStyle +"' width='100%'>"; var v7ea14; if (vc972 &&!v8af47) v7ea14 =v3c119.insertCell(vc972+1); else v7ea14 =v3c119.insertCell(-1); v7ea14.innerHTML =v9be13.innerHTML; v7ea14.mergeAttributes(v9be13); if (IS.moz) v7ea14.style.cssText =v9be13.style.cssText; v7ea14.style.backgroundColor =""; v7ea14.style.color =""; v7ea14.style.width =v9be13.offsetWidth; v7ea14.type ="GroupColumn"; v7ea14.gridId =v7fa0.Id; v7ea14.tblName =v45d13.Id;  var v90275 =v45d13.SortedColumns.GetNamedItem(v65660.Name);  if (v90275) { v45d13.SortedColumns.Remove(v90275); v45d13.SortedColumns.UpdateChanges(); wg85027.m83814(v7ea14); } else { v7ea14.sortOrder ="Ascending"; v7ea14.innerHTML +="&nbsp;"; } wg85027.med985(v7fa0,v7ea14);  var vd4c43 =v45d13.Get("HideColumnsWhenGrouped")=="Yes"; if (vd4c43 &&!v45d13.IsUseColumnSet) { v9be13.removeNode(true); }  wg85027.mf6633(v45d13,"Group",v9be13); } },  m91617:function(v13c64) { var v28682 =v13c64.Table; var v85e80 =v28682.Grid; var vd5c70 =v28682.GroupedColumns[v13c64.Index+1]; var vf4f26 =false; var vc6575 =null; var v67192 =null;  vc6575 =v13c64.GetElement();  if (vd5c70) { v67192 =vd5c70.GetElement().previousSibling; } else { tr =wg85027.m69f26(v85e80.Id,v28682.Id); v67192 =wg85027.mb9342(tr); vf4f26 =true; }  if (vc6575 &&v67192) { var vcf487 =vc6575.previousSibling; wg85027.mb5c23(vcf487,v67192,vf4f26); wg85027.mb5c23(vc6575,vcf487,true); } },  m4e11:function(vfa10,vdb568,vcd337) { var v99086 =vfa10.Table; var v2ac62 =v99086.Grid; var v5be51 =v99086.Columns.GetNamedItem(vfa10.ColumnMember); var vdb568 =wg_Global.TargetHeader; var v2e72 =v2ac62.LayoutSettings.HideColumnsWhenGrouped;  var v49822 =vfa10.GetElement(); var v22452 =v49822.parentElement;  v22452.removeChild(v49822.previousSibling); v22452.removeChild(v49822);  v5be51.IsGrouped =false; v5be51.SortOrder ="None";  if (vcd337 &&v2e72 =="Yes") v5be51.Visible =false;  v99086.ColumnMenu =null; if (vdb568 &&vdb568.Type =="Column") { if (v2e72 =="Yes") { v5be51.Visible =true; vdb568.Element.insertAdjacentElement("beforeBegin",v49822); wg85027.m83814(v49822); v49822.sortOrder ="None"; v49822.type ="Column"; wg85027.mf6633(v99086,"UngroupRestore",v49822); } else wg85027.mf6633(v99086,"UngroupHide",vdb568.Element.parentElement);  } else if (vdb568 &&vdb568.Type =="Unknown") { if (v2e72 =="Yes") v5be51.Visible =false; } else { if (v2e72 =="Yes") v5be51.Visible =false; } var ve5475 =v99086.HasChildTableGroupedColumns(); if (!ve5475) { if (v99086.GroupedColumns.length ==0) { if (!v99086.IsRootTable) { wgec043.m0aa99(v99086); wg85027.m3e055(v22452); } wg85027.m1476(v22452); v2ac62.NeedHeightResize =true; } }  if (!v2ac62.HasGroup()) { var v4238 =v2ac62.GetElement(WG40.GROUPBYBOXLABEL,WG40.HTMLROW); v4238.style.display =""; } },  m55269:function(v88612,v52737) { var v45790; wg_Global.IsMouseDown =false;  if (v88612.tagName !="TD") { v45790 =v88612; v88612 =wg38213.mb6c95(v88612); } if (!v88612)return; if (v88612.tagName =="TD") { var vbce43 =v88612.parentElement; if ((v88612.type =="Cell" ||v88612.type =="GroupColumn" ||v88612.type =="Column" ||v88612.type =="GroupCell" ||v88612.type =="FilterColumn")) { var v21c33 =wg38213.m88693(vbce43); var v96b10 =ISGetObject(v21c33.gridId); if (!v96b10 ||!v96b10.Enabled)return; if (v45790 &&v45790.tagName =="IMG" &&vbce43.type =="FilterRow")return; var v43528 =v96b10.Tables[v21c33.tblName];  if (v96b10.LayoutSettings.AllowContextMenu) { event.cancelBubble =true; event.returnValue =false; wg20949.mdc492(v96b10,v88612,v52737,v88612.type); return false; } } } }, OnGBBMouseMove: function() { var v1ce35 =event.srcElement; if (wg_Global.IsHeaderDragged)return; if (v1ce35.tagName =="TD") { var v35530 =ISGetObject(wg38213.m76d80(v1ce35.parentElement)); if (!v35530)return; var v7f431 =v35530.Tables[wg38213.m92e89(v1ce35.parentElement)]; if (event.button ==1) { if (v1ce35.type =="GroupColumn") { v1ce35.tblName =v7f431.Id; v1ce35.gridId =v35530.Name; wg_Global.ColDragTarget =v1ce35; } } } },  m99325:function() { if (IS.ie) wg85027.m55269(event.srcElement,null); },  m81669:function(ve6314) { var v5d835 =wg_Global.ColSizeTarget; if (v5d835 &&v5d835.cellIndex ==-1) v5d835 =null;  if (v5d835 !=null) { var v46230 =v5d835.parentElement; var v50831 =0;  v50831 =ISPosLib.getLeft(v5d835);  var vc6737 =ISGetObject(v5d835.gridId); if (!vc6737)return;  if (typeof(ve6314)=="object")ve6314 =false;  var vfa831 =vc6737.Tables[v5d835.tblName]; if ((!vc6737.Resizer ||vc6737.Resizer.style.display =="none")&&!ve6314) return;  var v47a0 =wg38213.m4f814(v5d835);  if (!ve6314) { var v2ec14 =vc6737.Resizer.style.posLeft -v50831 +posLib2.getLeftAbs(vc6737.FrameObj,vc6737); if (!ISEvent.Raise(vc6737.LayoutSettings.ClientSideEvents.OnColumnResize,v5d835.gridId,v5d835.tblName,v47a0,v2ec14)) return;  if (v5d835.type =="CSHeader") wg_Global.NoDisplayUpdate =true; }  var vba79 =v5d835.style.width; wg85027.m38974(vfa831,v5d835,(ve6314 ? v5d835.EstWidth : v2ec14),ve6314); vc6737.Resizer.style.display ="none"; event.cancelBubble =true; event.returnValue =false;  wg_Global.ColSizeTarget =v5d835; }  if (wg_Global.ColSizeTarget) { wg_Global.ColSizeTarget.style.cursor =""; }  wg_Global.IsMouseDown =false; }, m15d12:function() { var vf3759 =event.srcElement; if (wg_Global.IsHeaderDragged)return;  if (vf3759.tagName !="TD")vf3759 =wg38213.mb6c95(vf3759); if (vf3759 &&vf3759.tagName =="TD") { var vef264 =vf3759.parentElement; var vf7221 =ISGetObject(wg38213.m76d80(vef264)); if (!vf7221)return; if (!vf7221.Enabled)return;  var v6a072 =vf7221.Tables[wg38213.m92e89(vef264)]; if (!v6a072)return;  if (((IS.moz &&!wg_Global.IsMouseDown)||IS.ie)&&(event.button ==0 ||event.button ==65535)) { if (IS.moz)wg9d526.mc0084(vf3759);  if (vf3759.type !="Column" &&vf3759.type !="CSHeader")return; var v4d446 =null;  if (vf3759.type =="Column") { v4d446 =wg38213.m4f814(vf3759); if (!v4d446 ||v4d446.IsAutoWidth)return; } else if (vf3759.type =="CSHeader") { v4d446 =v6a072.ColumnSets[vf3759.pos]; }  var v64939 =true; var v0d894 =ISPosLib.getLeft(vf3759)+vf3759.offsetWidth; if (plGetCurX()>=v0d894-5 &&plGetCurX()<=v0d894 +3) { if (v4d446.Get("AllowSizing")!="Yes" ||vf7221.IsInProgress)return;  if (wg_Global.ColSizeTarget &&wg_Global.ColSizeTarget !=vf3759 &&wg_Global.ColSizeTarget.style) wg_Global.ColSizeTarget.style.cursor ="";  vf3759.style.cursor ="e-resize"; vf3759.tblName =v6a072.Id; vf3759.gridId =vf7221.Name; wg_Global.ColSizeTarget =vf3759; } else  { if (wg_Global.ColSizeTarget) { if (wg_Global.ColSizeTarget.style) wg_Global.ColSizeTarget.style.cursor =""; wg_Global.ColSizeTarget =null; } } } else if (event.button ==ISEvent.LEFT ||wg_Global.IsMouseDown) { if (wg_Global.ColSizeTarget !=null) { if (v6a072.Id !=wg_Global.ColSizeTarget.tblName) { return; } else  { if (wg38213.m88693(vef264)!=wg38213.m88693(wg_Global.ColSizeTarget.parentElement)) { return; } } var vcf926 =vf7221.Resizer; if (vcf926 ==null) { vcf926 =wg85027.mf3389(vf7221); vf7221.Resizer =vcf926; } var vb9520 =ISPosLib.getLeft(wg_Global.ColSizeTarget); var vef264 =wg_Global.ColSizeTarget.parentElement;  if (plGetCurX()>vb9520+10) { if (vf7221.LastEditObj) vf7221.ExitEditMode(); vcf926.style.left =plGetCurX()-2-posLib2.getLeftAbs(vf7221.FrameObj,vf7221); if (vcf926.style.display !="") { vcf926.style.height =v6a072.GetElement(WG40.BODY,WG40.HTMLDIV,vef264).offsetHeight +v6a072.GetElement(WG40.COLHEADER,WG40.HTMLDIV,vef264).offsetHeight; vcf926.style.top =ISPosLib.getTop(vf3759)-posLib2.getTopAbs(vf7221.FrameObj,vf7221); } vcf926.style.display =""; vcf926.style.cursor ="e-resize"; } v64939 =true; } else  { if (vf3759.type =="Column" ||vf3759.type =="GroupColumn") { vf3759.tblName =v6a072.Id; vf3759.gridId =vf7221.Name; wg_Global.ColDragTarget =vf3759; } } } } }, mc7915:function() { var v9d370 =((event)? event.srcElement : wg_Global.EventContext); if (v9d370.tagName !="TD")v9d370 =wg38213.mb6c95(v9d370); if (!v9d370)return;  if (v9d370.type =="Column" &&v9d370.style.cursor =="e-resize") { wg85027.m69b38(v9d370); v9d370.style.cursor =""; } }, m04098:function(v25067,vff225,vc3434) { var v40d70 =((event)? event.srcElement : wg_Global.EventContext); if (vff225)v40d70 =vff225; if (v40d70.tagName !="TD")v40d70 =wg38213.mb6c95(v40d70); if (!v40d70)return;  if (v40d70.type =="Column" ||v40d70.type =="GroupColumn") { var v89888 =ISGetObject(wg38213.m76d80(v40d70.parentElement)); if (!v89888)return; var vf9975 =v89888.Tables[wg38213.m92e89(v40d70.parentElement)]; var v1518 =v40d70.parentElement; var v54c15 =ISPosLib.getLeft(v40d70)+v40d70.offsetWidth; if ((plGetCurX()>=v54c15-5 &&plGetCurX()<=v54c15)||(wg_Global.ColSizeTarget)) { if (wg_Global.ColSizeTarget)wg_Global.ColSizeTarget =null; return; } v40d70.tblName =vf9975.Id; v40d70.gridId =v89888.Name;  var v37e9 =vf9975.Columns.GetNamedItem(v40d70.colName);  if (v40d70.isGrouped =="True" &&v40d70.type =="Column") { var v6398 =vf9975.GroupedColumns.GetNamedItem(v37e9.Name); wg85027.m04098(true,v6398.GetElement(),v40d70); return;  } if (!v25067) { if (v37e9.Get("AllowSorting")!="Yes")return; }  if (v25067) { var v6398 =vf9975.GroupedColumns.GetNamedItem(v37e9.Name); if (v40d70.sortOrder =="None") v6398.SortOrder ="Ascending"; else { if (v40d70.sortOrder =="Ascending") v6398.SortOrder ="Descending"; else v6398.SortOrder ="Ascending"; } v37e9.SortOrder =v6398.SortOrder;  v6398._UIState ="Changed";  wg85027.m9da6(vf9975); wg38213.mc2b9(v89888.Name,"ChangeGroup",v40d70); return; } if ((v89888.LastEditObj ||v89888.ActiveEditCell)&&!v89888.IsExitingEdit) { var vdae11 =v89888.LastEditObj; var ve4f80 =v89888.ActiveEditCell; var v51f36 =v89888.Tables[ ((vdae11)? vdae11.tblName : ve4f80.tblName)]; var v9a35 =v51f36.Get("AllowEdit")=="Yes";  var v0f276;  if (vdae11) v0f276 =vdae11.cellElement.parentElement; else v0f276 =ve4f80.rowElement; if (v0f276 &&v9a35 &&(v0f276.type =="Record" ||v0f276.type =="NewRow")) { if (v0f276.markedEdit) { var v24821 =wg9c911.m5a567(v89888,1)[0]; return v24821; } else  { if (vdae11)wg9c911.m24018(vdae11); } } }  if (!event.shiftKey ||vf9975.Get("HeaderClickAction")=="SortSingle") { var vbc494 =v40d70.parentElement; var vb3c24 =new Array();  if (vf9975.IsUseColumnSet)vb3c24 =wgGetColumnSetRows(vbc494); else vb3c24[0] =vbc494;  for (var v5f235=0; v5f235<vb3c24.length; v5f235++) { var v1518 =vb3c24[v5f235]; for (var vec931=0; vec931<v1518.cells.length; vec931++) { var v90d26 =v1518.cells[vec931]; if (v90d26.colName ==v40d70.colName ||v90d26.isGrouped =="True") continue;  if (v90d26.type =="Column" &&v90d26.sortOrder !="None") { v90d26.sortOrder ="None"; var v16589 =vf9975.SortedColumns.GetNamedItem(v90d26.colName); if (v16589) vf9975.SortedColumns.Remove(v16589,true); } } }  }  var vaf419 =null; if (v40d70.sortOrder =="None") { vaf419 =new WebGridGroup(); vaf419.ColumnMember =v40d70.colName; vaf419.SortOrder ="Ascending"; vf9975.SortedColumns.Add(vaf419); } else  { vaf419 =vf9975.SortedColumns.GetNamedItem(v40d70.colName);  if (!vaf419) { var vaf419 =new WebGridGroup(); vaf419.ColumnMember =v40d70.colName; vf9975.SortedColumns.Add(vaf419); }  if (vaf419.SortOrder =="Ascending") vaf419.SortOrder ="Descending"; else vaf419.SortOrder ="None";  vaf419._UIState ="Changed"; }  if (ISEvent.Raise(v89888.LayoutSettings.ClientSideEvents.OnColumnSort,v89888.Id,vaf419)) { v89888.HeaderContext =v40d70; wg85027.mb8075(vf9975); wg38213.mc2b9(v89888.Name,"ColumnSort",v40d70); } } },  m5d530:function() { if ((event.button ==ISEvent.LEFT ||event.button ==65535)&&IS.moz) { wg_Global.IsMouseDown =true; var v3d079 =event.srcElement; if (v3d079.tagName =="SPAN" ||v3d079.tagName =="NOBR") v3d079 =wg38213.mb6c95(v3d079);  if (v3d079 &&v3d079.tagName =="TD" &&v3d079.getAttribute("type")=="Column") { event.cancelBubble =true; event.returnValue =false; } } }, m27992:function() { return wg60540.m4145(); },  mc850:function() { wg_Global.ButtonState =1; var v2191 =event.srcElement; if (IS.moz) { wg_Global.IsMouseDown =true;  if (v2191.tagName =="TEXTAREA" ||v2191.tagName =="SELECT") return; if (v2191.tagName =="INPUT" &&v2191.type =="checkbox" &&v2191.className !="DefChkBox") return;  var v5c486 =wgGetActiveGrid(); if (v5c486) { var v18d28 =ISGetObject(v5c486); if (v18d28) { if (v18d28.FrameObj.contains(v2191)) { event.returnValue =false; } } } } wg60540.medb21(v2191); if (event.button ==ISEvent.RIGHT) wg85027.m55269(v2191);  },  m80f32:function() { wg_Global.IsMouseDown =false;  if (wg_Global.ColSizeTarget !=null) { var vddc69 =ISGetObject(wg_Global.ColSizeTarget.gridId); if (vddc69 &&vddc69.Resizer) vddc69.Resizer.style.display ="none"; }  var va4466 =wg_Global.TargetHeader; if (va4466) { var v5e025 =wg_Global.ColDragTarget; var vddc69 =ISGetObject(v5e025.gridId); var v41338 =vddc69.Tables[v5e025.tblName]; var v56330 =v5e025.parentElement; var v4a663 =posLib2.getLeftAbs(vddc69.FrameObj,vddc69); var v9ba85 =posLib2.getTopAbs(vddc69.FrameObj,vddc69);  if (va4466.Type =="Column" &&v5e025.type =="Column") {  if (v41338.Get("AllowColumnMove")=="Yes" &&!v41338.IsUseColumnSet) { if (va4466.Element.cellIndex !=v5e025.cellIndex &&va4466.ProperPosition +v4a663 !=ISPosLib.getLeft(v5e025)) { var vc9074 =va4466.Element.cellIndex; var v64c49 =v5e025.cellIndex; if (!ISEvent.Raise(vddc69.LayoutSettings.ClientSideEvents.OnColumnMove,v5e025.gridId,v5e025.tblName,v64c49,vc9074,wg38213.m4f814(v5e025),wg38213.m4f814(va4466.Element))) return; vddc69.SetStatus1("","columnmove","CommonText/ColumnMove"); wg_Global.MoveColEventArgs =new wgMoveColArgs(v41338,vc9074,v64c49,v56330,v5e025,va4466); setTimeout("wg85027.m7841()",200); } } } else if(va4466.Type =="GroupColumn" ||va4466.Type =="GroupInfo") { var va1e35 =v41338.Columns.GetNamedItem(v5e025.colName); if (va1e35.Get("AllowGrouping")=="Yes") { var v0d960 =""; vddc69.HeaderContext =v5e025;  if (va4466.Type =="GroupInfo") { if (ISEvent.Raise(vddc69.LayoutSettings.ClientSideEvents.OnColumnGroup,vddc69.Id,va1e35)) { wg85027.m88b63(v5e025); v0d960 ="Group"; } } else  { if (v5e025.type =="Column") { var vc3661 =0; var v21014 =v41338.GroupedColumns.GetNamedItem(va4466.Element.colName);  if (v21014) { vc3661 =v21014.Index+1; if (va4466.ProperPosition ==va4466.PosLeft) vc3661--; }  if (ISEvent.Raise(vddc69.LayoutSettings.ClientSideEvents.OnColumnGroup,vddc69.Id,va1e35)) { wg85027.m88b63(v5e025,vc3661); v0d960 ="Group"; } } else  { if (v5e025 !=va4466.Element) { var v7f992 =v41338.GroupedColumns.GetNamedItem(v5e025.colName); var v21014 =v41338.GroupedColumns.GetNamedItem(va4466.Element.colName);  if (v7f992.Index !=v21014.Index) { if (ISEvent.Raise(vddc69.LayoutSettings.ClientSideEvents.OnColumnGroupChange,vddc69.Id,va1e35)) { v41338.GroupedColumns.Move(v7f992.Index,v21014.Index); v0d960 ="ChangeGroup"; } } } } }  if (v0d960 !="") { if (v0d960.indexOf("Group")!=-1) wg85027.m9da6(v41338);  wg38213.mc2b9(vddc69.Name,v0d960,v5e025); } } } else  { if (v5e025.type =="GroupColumn") { var va1e35 =v41338.Columns.GetNamedItem(v5e025.colName); if (va1e35.Get("AllowGrouping")=="Yes") { if (ISEvent.Raise(vddc69.LayoutSettings.ClientSideEvents.OnColumnUngroup,vddc69.Id,va1e35)) { v41338.GroupedColumns.Remove(v41338.GroupedColumns.GetNamedItem(v5e025.colName),true); wg85027.m9da6(v41338);  wg38213.mc2b9(vddc69.Name,"Ungroup",v5e025); } } } } }  if (wg_Global.IsHeaderDragged) { var vc5097 =wg_Global.Dragger; if (vc5097) { var v5e025 =wg_Global.ColDragTarget; if (!vddc69) vddc69 =ISGetObject(v5e025.gridId); vc5097.style.display ="none"; wg_Global.Dragger =null; v5e025.style.color =""; v5e025.style.backgroundColor =""; v5e025.removeAttribute("elLeft"); v5e025.removeAttribute("elTop"); v5e025 =null; wg_Global.ColDragTarget =null; wg_Global.TargetHeader =null;  if (vddc69.ColPointer) vddc69.ColPointer.style.display ="none"; if (vddc69.Resizer) vddc69.Resizer.style.display ="none";  } }  wg_Global.IsHeaderDragged =false; wg_Global.ButtonState =0; wg_Global.MouseCoord =null; wg_Global.MouseMoved =false; },  m2c498:function() { var ve4e28 =true; if (IS.moz) { if (!wg_Global.IsMouseDown)ve4e28 =false; } if (event.button ==ISEvent.LEFT &&ve4e28) { if (wg_Global.ColSizeTarget)return false; if (!wg_Global.MouseMoved) { var v22d58 =wg_Global.MouseCoord; if (!v22d58) { wg_Global.MouseCoord =new wgMouseCoord(event.x,event.y); wg_Global.MouseMoved =true; return; } else  { if (v22d58.x !=event.x &&v22d58.y !=event.y){ wg_Global.MouseMoved =true; } } return; } else  { if (wg_Global.ColDragTarget) wg_Global.IsHeaderDragged =true; }  if (wg_Global.IsHeaderDragged) { var v07e59 =wg_Global.ColDragTarget; var vf4572 =ISGetObject(v07e59.gridId); if (!vf4572.Enabled)return; if (v07e59) { v07e59.style.backgroundColor =vf4572.SelectedHeaderBackColor; v07e59.style.color =vf4572.SelectedHeaderForeColor; var v09437 =wg_Global.Dragger; if (v09437 ==null) { v09437 =wg85027.m88177(v07e59); wg_Global.Dragger =v09437; } var v52b78; var vee038; if (!v07e59.getAttribute("elLeft")) { v52b78 =plGetCurX()-ISPosLib.getLeft(v07e59); v07e59.setAttribute("elLeft",v52b78); } else v52b78 =v07e59.getAttribute("elLeft"); if (!v07e59.getAttribute("elTop")) { vee038 =(plGetCurY())-ISPosLib.getTop(v07e59); v07e59.setAttribute("elTop",vee038); } else vee038 =v07e59.getAttribute("elTop"); if (vf4572.LastEditObj)vf4572.ExitEditMode();  var v42596 =plGetCurX()-v52b78-posLib2.getLeftAbs(vf4572.FrameObj,vf4572); var v51540 =plGetCurY()-vee038-posLib2.getTopAbs(vf4572.FrameObj,vf4572)+v09437.offsetHeight; v09437.style.left =v42596; v09437.style.top =v51540; v09437.style.display =""; var v9cf61 =wg85027.m83922(v09437,v07e59); var v34931 =vf4572.Resizer;  if (v9cf61) { wg_Global.TargetHeader =v9cf61; var vf4572 =ISGetObject(v07e59.gridId); var vfea78 =vf4572.ColPointer; var v94b95 =vf4572.Tables[v07e59.tblName]; var vb8061 =v07e59.parentElement; var v8eb71 =v94b95.Columns.GetNamedItem(v07e59.colName);  if (v9cf61.Type =="Column") { if (v94b95.Get("AllowColumnMove")!="Yes" ||v94b95.IsUseColumnSet)return; if (v34931 ==null) { v34931 =wg85027.mf3389(vf4572); vf4572.Resizer =v34931; } v34931.style.left =v9cf61.ProperPosition; v34931.style.height =v09437.offsetHeight; v34931.style.top =v9cf61.PosTop; v34931.style.display =""; if (vfea78)vfea78.style.display ="none"; } else if (v9cf61.Type =="GroupInfo" ||v9cf61.Type =="GroupColumn") { if (v8eb71.Get("AllowGrouping")!="Yes")return; if (v07e59.groupExist &&v9cf61.Type =="GroupColumn" &&v07e59.tblName !=v9cf61.Element.tblName) return; if (vfea78 ==null) { vfea78 =wg85027.mb8294(vf4572); vf4572.ColPointer =vfea78; } vfea78.style.display =""; vfea78.style.left =v9cf61.ProperPosition; vfea78.style.top =v9cf61.PosTop; if (v34931)v34931.style.display ="none"; } else if (v9cf61.Type =="Unknown") { if (vfea78)vfea78.style.display ="none"; if (v34931)v34931.style.display ="none"; } } else  { if (vfea78)vfea78.style.display ="none"; if (v34931) { v34931.style.display ="none"; } }  } } } },  m19f51:function(v74259,v42013) { var v6145 =v74259; var ve6942 =""; var vc3a10 =new Array();  for (var v5f517=v6145.parentGroupIndex-1; v5f517>=0; v5f517--) { var v02a8 =wg85027.mc8988(v6145,v5f517,"previous"); vc3a10[vc3a10.length] =v02a8.position; }  vc3a10.reverse(); ve6942 =vc3a10.join(";");  if (!v42013) { if (ve6942 !="")ve6942 +=";"; if (typeof(v74259.parentIndex)!="undefined") ve6942 +=v74259.parentIndex; } return ve6942; }, m9ce46:function(v6e426) { var vebf4 =v6e426; var v2bc99 =""; var v6cf69 =new Array();  for (var v33287=vebf4.groupIndex-1; v33287>=0; v33287--) { var v7dd19 =wg85027.mc8988(vebf4,v33287,"previous"); v6cf69[v6cf69.length] =v7dd19.position; }  v6cf69.reverse(); v2bc99 =v6cf69.join(";");  return v2bc99; }, m00245:function(v3ff73,v24120,v64857,va3b48) { if (va3b48 !="") { var ve0a26; var v0c293 =0; var v2ca68 =0; if (v24120) { try  { ve0a26 =v24120.GetElement(WG40.COLFOOTER,WG40.HTMLDIV); var vb470 =v24120.GetElement(WG40.COLFOOTERGROUP); var vab871 =vb470.childNodes[vb470.childNodes.length-1]; v0c293 =vab871.width; v2ca68 =ve0a26.scrollLeft; }catch (e){}; } else  { ve0a26 =v64857.GetElement(WG40.COLFOOTER,WG40.HTMLDIV); }  if (ve0a26) { ve0a26.outerHTML =va3b48; if (v24120) { var vb470 =v24120.GetElement(WG40.COLFOOTERGROUP); var vab871 =vb470.childNodes[vb470.childNodes.length-1]; vab871.width =v0c293; ve0a26 =v24120.GetElement(WG40.COLFOOTER,WG40.HTMLDIV); if (v2ca68 !=0) { ve0a26.scrollLeft =v2ca68; } } } } },  m64b95:function(v3fc62,v79a94) { var vd9462 =wg38213.md7a39(v3fc62.LastSelObj); if ((vd9462 &&v3fc62.LastSelObj.GetRowElement().type !="NewRow" &&v3fc62.LastSelObj.GetRowElement().type !="FilterRow")||!vd9462) { if (vd9462 &&v3fc62.LastSelObj.tblName ==v79a94.Id ||!vd9462) v3fc62.ActiveEditCell =v3fc62.LastSelObj =null; } },  m15f64:function(v69185) { var v46362 =document.getElementById("wgTempCnt"); if (!v46362) { v46362 =document.createElement("div"); v46362.id ="wgTempCnt"; v46362.style.display ="none"; } v46362.innerHTML =v69185; document.body.appendChild(v46362); }, m8cf25:function() { var v62330 =document.getElementById("wgTempCnt"); if (v62330)v62330.innerHTML =""; }, md1593:function() { var va0752 =document.getElementById("wgTempCnt"); if (va0752)return va0752.childNodes[0]; return null; }, mc8988:function(v7cd97,vf4355,v59847) { if (v59847 =="previous") { var vb3152 =v7cd97; var vb8668 =wg38213.m88693(vb3152); while (vb3152) { wg38213.m79d94(vb3152); if (vb3152.groupIndex ==vf4355 &&vb3152.type =="GroupHeader")return vb3152; try  { vb3152 =wgGetPreviousRow(vb8668,vb3152); } catch(e){vb3152 =null; } } return null; } else if (v59847 =="next") { var vb3152 =v7cd97; var vb8668 =wg38213.m88693(vb3152); while (vb3152) { wg38213.m79d94(vb3152); if (vb3152.groupIndex ==vf4355 &&vb3152.type =="GroupHeader")return vb3152; try  { vb3152 =wgGetNextRow(vb8668,vb3152); } catch(e){vb3152 =null; } } return null; } }, m30e21:function(ve0b87) { var v7be64; for (var v48935=0; v48935<ve0b87.cells.length; v48935++) { if (ve0b87.cells[v48935].type =="Cell") v7be64 =ve0b87.cells[v48935]; } return v7be64; }, m4270:function(vb4966) { var v1b787 =vb4966.GetGrid(); var vbe028 =vb4966.Table; var v9b843 =vb4966.GetElement(); var vb0236 =v9b843.parentElement; var v8af58 =vbe028.GetElement(WG40.COLGROUP,null,vb0236); var vc6646 =vbe028.GetElement(WG40.BODY,WG40.HTMLTABLE,vb0236); var vcf367 =v9b843.cellIndex; if (!ISEvent.Raise(v1b787.LayoutSettings.ClientSideEvents.OnColumnChanged,v1b787.Id,vbe028.Id,vb4966.Name,"Removed")) return; v9b843.removeNode(true); v9b843.tblName =vbe028.Id;  if (vbe028.IsRootTable &&vbe028.Get("AllowFilter")=="Yes") { var v66089 =vbe028.GetFilterRow(vb0236); v66089.cells[vcf367].removeNode(true); v66089.nextSibling.cells[0].colSpan -=1; } vb4966.Visible =vb4966.ForceVisible =false; wg85027.mf6633(vbe028,"Remove",vb0236); wg85027.m38f29(vbe028,vb0236); vbe028.ColumnMenu =null;  var v19268 =vbe028.SortedColumns.GetNamedItem(vb4966.Name); if (v19268) vbe028.SortedColumns.Remove(v19268);  var va0d42 =vbe028.FilteredColumns.GetNamedItem(vb4966.Name); if (va0d42) { vbe028.FilteredColumns.Remove(va0d42,true); wg85027.mf6c40(vbe028); }  wg38213.mc2b9(v1b787.Name,"ColumnChange",v9b843); },  mb1082:function(vbba11,v38663,vc5832) { if (vc5832 =='False' ||!vc5832) v38663.src =vbba11.LayoutSettings.ImageSettings.Folder +vbba11.LayoutSettings.ImageSettings.CollapseImage; else v38663.src =vbba11.LayoutSettings.ImageSettings.Folder +vbba11.LayoutSettings.ImageSettings.ExpandImage; }, m22c96:function(v15f82,va0c24,v2e511) { var tr,gd; if (v15f82) { tr =v15f82.parentElement.parentElement; gd =ISGetObject(wg38213.m76d80(tr)); if (tr.expanded =='False') v15f82.src =gd.LayoutSettings.ImageSettings.Folder +gd.LayoutSettings.ImageSettings.CollapseImage; else v15f82.src =gd.LayoutSettings.ImageSettings.Folder +gd.LayoutSettings.ImageSettings.ExpandImage; } else  { tr =va0c24; gd =ISGetObject(wg38213.m76d80(tr)); }  var v5f833 =wg38213.m88693(tr); if (tr.expanded =='False') { var vf0a56; var v0e931; tr.expanded ='True'; if (!v2e511) { if (!ISEvent.Raise(gd.LayoutSettings.ClientSideEvents.OnGroupExpand,gd.Name,v5f833.tblName,tr.groupIndex,tr.position,tr.rowIndex,tr)) return; } vf0a56 =wgGetNextRow(v5f833,tr); if (vf0a56) v0e931 =vf0a56.type; else  v0e931 ="GroupHeader";  if (v0e931 =="GroupHeader" ||v0e931 =="GroupTotalRow") { var v36b84 =false; if (v0e931 =="GroupHeader") { while (vf0a56 &&(vf0a56.type =="GroupTotalRow" ||(vf0a56.hasParent =='True' &&(parseFloat(vf0a56.groupIndex)-1 ==parseFloat(tr.groupIndex))&&vf0a56.parentIndex ==tr.position))) { v36b84 =true; vf0a56.style.display =""; if (vf0a56 &&vf0a56.type =="GroupHeader" &&vf0a56.expanded =="True") { vf0a56.expanded ='False'; wg85027.m22c96(null,vf0a56); } vf0a56 =wgGetNextRow(v5f833,vf0a56);  while (vf0a56 &&(vf0a56.type =="Record" ||vf0a56.type =="PR" ||vf0a56.type =="CSRecord" ||(vf0a56.type =="GroupTotalRow" &&parseFloat(vf0a56.groupIndex)-1 >parseFloat(tr.groupIndex))||vf0a56.type =="HierRecord" ||(vf0a56.type =="GroupHeader" &&parseFloat(vf0a56.groupIndex)-1 >parseFloat(tr.groupIndex)))) vf0a56 =wgGetNextRow(v5f833,vf0a56); } } if (!v36b84) { if (tr.childrenLoaded =="False") { wg38213.mc2b9(gd.Name,"LoadGroup",tr); return; } } } else if (v0e931 =="Record") { while (vf0a56 &&(vf0a56.type =='Record' ||vf0a56.type =="PR" ||vf0a56.type =="CSRecord" ||vf0a56.type =='HierRecord')) { if (vf0a56.type =="Record" ||vf0a56.type =="PR" ||vf0a56.type =="CSRecord") { if (typeof(vf0a56.srLevel)!="undefined") { if (vf0a56.srLevel =="0") { vf0a56.style.display ="";  if (vf0a56.srExpanded =="True") { if (vf0a56.currentStyle.display !="none") { vf0a56.srExpanded ="False"; wg85027.m40476(null,vf0a56); } } else  { if (vf0a56.type !="CSRecord") { vf0a56.srExpanded ="True"; wg85027.m40476(null,vf0a56); } } } } else vf0a56.style.display ="";  if (vf0a56.currentStyle.display !="none") { if (vf0a56.childExpanded =="True") { vf0a56.childExpanded ="False"; wgec043.m3c399(null,vf0a56); } } } vf0a56 =wgGetNextRow(v5f833,vf0a56); } } } else  { var vf0a56; var v0e931; tr.expanded ='False'; if (!ISEvent.Raise(gd.LayoutSettings.ClientSideEvents.OnGroupCollapse,gd.Name,v5f833.tblName,tr.groupIndex,tr.position,tr.rowIndex,tr)) return; vf0a56 =wgGetNextRow(v5f833,tr); while (vf0a56) { if (vf0a56.type =="GroupTotalRow") { if (vf0a56.groupIndex ==tr.groupIndex)break; }  if (vf0a56.groupIndex ==tr.groupIndex &&vf0a56.position !=tr.position) break; else if (parseFloat(vf0a56.groupIndex)<parseFloat(tr.groupIndex)) break; else  { vf0a56.style.display ="none"; vf0a56 =wgGetNextRow(v5f833,vf0a56); } } } },  me1418:function(v8a027) { if (v8a027.getAttribute("filterType")=="7" &&v8a027.cellValue !="") { var vcb827 =v8a027.filterText.indexOf("and"); if (vcb827 <1) { alert("Incorrect Between parameters.\nBetween parameter formats: @Criteria1 and @Criteria2.\ne.g.1 and 10"); return false; } } return true; },  mb3066:function(vd7e16) { var vefa94 =wg38213.m76d80(vd7e16.parentElement.parentElement); var v9ab91 =wg38213.m92e89(vd7e16.parentElement.parentElement); var v14a6 =ISGetObject(vefa94); var v89e20 =v14a6.Tables[v9ab91]; var vf6511 =vd7e16.parentElement; var vcc27 =event; if (vcc27.keyCode ==115) { wg20949.m8d232(vd7e16.nextSibling); v89e20.FilterMenu.goToNextMenuItem(); vcc27.keyCode =0; vcc27.cancelBubble =true; vcc27.returnValue =false; } else { vf6511.setAttribute("changed","true"); vcc27.cancelBubble =true; } return false; }, m0b724:function(v61f15) { var v8cb91=v61f15.parentElement; var v99f8 =wg38213.m88693(v8cb91.parentElement); var v76374 =wgGetGridById(v99f8.gridId); var ve9968 =v76374.Tables[v99f8.tblName]; var vb1660 =ve9968.GetColumn(v8cb91.colName); var v26042 =vb1660.GetFilterEditType();  if (v8cb91.filterType =='0' &&v8cb91.cellValue !='') { if (v26042 =="Checkbox") { var v3d238 =wg9c911.mcf282(v8cb91); if (v3d238.checked) v8cb91.filterType ="3"; }else v8cb91.filterType ="6"; } if (v8cb91.filterType !='0') { v8cb91.filterText =v8cb91.cellValue; if (v26042 !="Checkbox") { if (v8cb91.filterText =='' &&!(parseFloat(v8cb91.filterType)>=12 &&parseFloat(v8cb91.filterType)<=15))v8cb91.filterType ='0'; } }  if (v8cb91.filterType !='0') { var v0834 =ve9968.FilteredColumns.GetNamedItem(vb1660.Name); if (!v0834) { v0834 =new WebGridFilter(); v0834.Name =v0834.ColumnMember =vb1660.Name; ve9968.FilteredColumns.Add(v0834); } else v0834._UIState ="Changed"; v0834.FilterText =v8cb91.filterText; v0834.FilterType =wg_Global.FilterTypeEnum[parseFloat(v8cb91.filterType)]; } else { var v0834 =ve9968.FilteredColumns.GetNamedItem(vb1660.Name); if (v0834) ve9968.FilteredColumns.Remove(v0834,true); } wg85027.me1418(v8cb91); },  m50a35:function() { var va3915 =document.createElement("DIV"); va3915.style.cssText ="display: none; POSITION: absolute; Z-INDEX: 9999; FILTER:progid:DXImageTransform.Microsoft.Shadow(color='#666666', Direction=135, Strength=4);BORDER-LEFT:darkgray 1px solid;BACKGROUND-COLOR:whitesmoke"; va3915.innerHTML ='<TABLE style="TABLE-LAYOUT: fixed; FONT-SIZE: 8pt; WIDTH: 100%; FONT-FAMILY: verdana; HEIGHT: 100%" cellSpacing="0" cellPadding="4" width="780" border="0"><TR><TD style="FONT-WEIGHT: bold; COLOR: white" bgColor="darkslateblue">WebGrid.NET Enterprise Version 4.0</TD></TR><TR><TD><TABLE id="Table2" style="TABLE-LAYOUT: fixed; FONT-SIZE: 8pt; BORDER-BOTTOM: darkgray 1px solid; FONT-FAMILY: verdana" cellSpacing="0" cellPadding="4" width="100%" border="0"><TR><TD style="WIDTH: 39px"><img id="img_wgError" src="wg_Error.gif" height="32"></TD><TD id="wg_uhemsg"></TD></TR></TABLE></TD></TR><tr height="100%"><td><div id="wg_ErrorMsg" style="OVERFLOW: auto; WIDTH: 100%; HEIGHT: 100%"></div></td></tr><tr><td align="right"><button style="BORDER-RIGHT: navy 1px solid; BORDER-TOP: navy 1px solid; FONT-SIZE: 8pt; BORDER-LEFT: navy 1px solid; BORDER-BOTTOM: navy 1px solid; FONT-FAMILY: verdana" type="button" onclick="wgCopyToCB(wg_ErrorMsg.innerText)" >Copy</button>&nbsp;<button onclick="wg85027.mbd736()" style="BORDER-RIGHT: navy 1px solid; BORDER-TOP: navy 1px solid; FONT-SIZE: 8pt; BORDER-LEFT: navy 1px solid; BORDER-BOTTOM: navy 1px solid; FONT-FAMILY: verdana" type="button">Close</button></td></tr></TABLE>'; document.body.appendChild(va3915); wg_Global.ErrorBox =va3915; }, mbd736:function() { wg_Global.ErrorBox.style.display ="none"; }, m3843:function(vb9d62,vdcb69,veb453) { if (!wg_Global.ErrorBox) wg85027.m50a35(); var v82f50 =wg_Global.ErrorBox; v82f50.style.width =document.body.offsetWidth -50; v82f50.style.height =document.body.offsetHeight -50; v82f50.style.left =v82f50.style.top =20;  var v3682 =document.getElementById("wg_ErrorMsg"); if (IS.moz) { v82f50.style.height =document.body.clientHeight -50; v82f50.style.border ="tan 1px solid"; v3682.style.height =document.body.clientHeight -150; }  v3682.innerHTML =vdcb69; document.getElementById("img_wgError").src =vb9d62.LayoutSettings.ImageSettings.Folder +"wg_Error.gif";  if (veb453) document.getElementById("wg_uhemsg").innerHTML =veb453;  wg_Global.ErrorBox.style.display =""; },  m6eb88:function(vffc64) { var v3a897 =vffc64.GetRootTable(); var vbaa30 =v3a897.GetElement(WG40.COLHEADER,WG40.HTMLTABLE); var v05e47 =new Array(); if (v3a897.IsUseColumnSet) { var v28631 =vbaa30.rows[0]; if (!v28631.csRowPos)v28631 =vbaa30.rows[1]; v05e47 =wgGetColumnSetRows(v28631); } else v05e47[0] =vbaa30.rows[0]; wg_Global.NoDisplayUpdate =true; wg_Global.IsResizing =true; for (var v9d350=0; v9d350<v05e47.length; v9d350++) { for (var v39737=0; v39737<v05e47[v9d350].cells.length; v39737++) { var v3ff36 =v05e47[v9d350].cells[v39737]; if (v3ff36.type =="Column") { wg85027.m8a489(v3ff36,v3ff36.offsetWidth); wg85027.m7e070(v3a897,v05e47[v9d350],v3ff36,v3ff36.offsetWidth,true); } } } wg_Global.NoDisplayUpdate =false; wg_Global.PendingUpdates =null; setTimeout("wg_Global.IsResizing=false",100); },  mf6633:function(v67e47,vf7712,vbe667,v77860,vbcc15,v98332) { var vedc86 =v67e47.GetGrid(); var v3184 =vedc86.FrameObj.offsetWidth; var v91243 =0; var v3d785 =0; var v41456 =0; var v33233 =0; var v41028 =0; var v6a656 =parseInt(v67e47.ColumnWidthDefault); if (!vedc86.LayoutSettings.AutoFitColumns)return; if (v3184 ==0 &&!vf7712) { if (vedc86.FrameObj.offsetWidth ==0 &&vedc86.FrameObj.offsetHeight ==0)return; setTimeout(function(){wg85027.mf6633(v67e47,vf7712,vbe667,v77860,vbcc15,v98332)},100); return; } if (!v67e47.IsUseColumnSet) { var v95717 =v67e47.Columns; var vd6923 =v67e47.GetAutoWidthColumn(); var v0d335 =vedc86.LayoutSettings.AutoColMinWidth; var vbe430 =false; if (vd6923 &&!vd6923.Visible)vd6923 =null;  for (var vd4483=0; vd4483<v95717.length; vd4483++) { var v5b518 =v95717[vd4483]; var va8d97 =false;  var v5f472 =v67e47.GroupedColumns.GetNamedItem(v5b518.Name); if (v5f472 &&v5f472._UIState =="Unchanged") va8d97 =true;  if (v5b518.ColumnType !="CheckBox" &&v5b518.Visible &&!(va8d97 &&v67e47.Get("HideColumnsWhenGrouped")=="Yes")) { if ((vf7712 =="Resize" ||vf7712 =="Group")&&v5b518.Name ==vbe667.colName) { v5b518.dontResizeTemp =true; } v5b518.dontResize =null; v33233++;  if (vd6923 &&vd6923.Name ==v5b518.Name) { v91243 +=v0d335; } else  { if (v5b518.Width !="") v91243 +=parseInt(v5b518.Width); else v91243 +=v6a656; } } else if (v5b518.ColumnType =="CheckBox") { v41028 +=parseInt(v5b518.Width); v5b518.dontResize =true; } else v5b518.dontResize =true; }  v3d785 =v3184 -v67e47.GetColumnGroupHeadersWidth()-v41028 -(!vedc86.HidePadColumn ? 16 : 0);  if (v67e47.SelfReferencingSettings.Enabled &&v67e47.SelfReferencingSettings.IsTreeViewSelectionMode) v3d785 +=16;  if (!v67e47.IsRootTable) v3d785 -=v67e47.GetParentHeadersWidth();  if (vf7712 =="Resize") { v3d785 -=parseInt(vbe667.style.width); v91243 -=parseInt(vbe667.style.width); } else if (vf7712 =="Group") { if (v67e47.Get("HideColumnsWhenGrouped")=="Yes") v91243 -=parseInt(vbe667.style.width); v3d785 -=16; } else if (vf7712 =="UngroupRestore" ||vf7712 =="UngroupHide") { v3d785 +=16; } else if (vf7712 =="UngroupRestoreContext") { v3d785 +=16; v91243 +=parseInt(vbe667.style.width); } else if (vf7712 =="ColumnChange") { if (vd6923) { for(xcol in vbcc15) { if (vbcc15[xcol] ==vd6923){ vbe430 =true; } } } }  if (v91243 ==v3d785-10 &&!vf7712)return;  if (vd6923) { if (v91243 <v3d785) { vd6923.fixedWidth =v3d785 -v91243 +v0d335; for (var vd4483=0; vd4483<v95717.length; vd4483++) { if (v95717[vd4483] !=vd6923 &&!v95717[vd4483].dontResize &&!v95717[vd4483].dontResizeTemp) { v95717[vd4483].dontResizeTemp =true; } } } else  { vd6923.fixedWidth =v0d335; if (!vbe430) { v3d785 -=parseInt(vd6923.Width); v91243 -=parseInt(vd6923.Width); } else  { v3d785 -=v0d335; v91243 -=v0d335; } } } var v5bb83 =null; var vc619 =0; if (v67e47.IsRootTable)v5bb83 =v67e47.GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0]; for (var vd4483=0; vd4483<v95717.length; vd4483++) { var v5b518 =v95717[vd4483]; var v44829 =0; var vd2a4 =0; if (!v5b518.dontResize &&!v5b518.dontResizeTemp) { var v8a421; if (v5b518.Width !="")v8a421 =parseInt(v5b518.Width); else v8a421 =v6a656;  if (v5b518.fixedWidth) { vd2a4 =parseInt(v5b518.fixedWidth); v5b518.fixedWidth =null; } else  { v44829 =(v8a421/v91243)*100; vd2a4 =parseInt((v44829/100)*v3d785); }  vc619 +=vd2a4;  if (vd4483 ==v95717.length-1) { var vdd425 =v3d785 -vc619; if (vd2a4+vdd425-2 >16) vd2a4 +=vdd425-2; }  var vfc132 =null; if (vf7712 &&!v67e47.IsRootTable) { var v0b515; if (vf7712 !="SubTable") { if (vf7712 =="Remove" ||vf7712 =="UngroupHide" ||vf7712 =="ColumnChange") v0b515 =vbe667; else v0b515 =vbe667.parentElement; v5bb83 =v67e47.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,v0b515).rows[0]; } else v5bb83 =v98332.GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0]; }  if (v5bb83)vfc132 =wgGetCellByName(v5bb83,v5b518.Name); if (vfc132) { wg85027.m38974(v67e47,vfc132,vd2a4,null,true); if (!v67e47.IsRootTable &&vf7712 =="Resize") wgec043.m67781(v67e47,vfc132,vd2a4); } else if (v5b518) v5b518.Set("Width",vd2a4,true);  } else if (v5b518.dontResizeTemp) v5b518.dontResizeTemp =null; }  if (vf7712 =="Resize" ||!vf7712) { wg85027.m38f29(v67e47); } } else  { var vb0821 =v67e47.ColumnSets; var vc619 =0;  for (var vd4483=0; vd4483<vb0821.length; vd4483++) { var vd3a92 =vb0821[vd4483]; if (vd3a92.Visible) { if ((vf7712 =="Resize")&&vd3a92.Position ==vbe667.pos) { vd3a92.dontResizeTemp =true; } vd3a92.dontResize =null; v33233++; var v4c270 =v67e47.GetCSHeaderWidth(vd4483); v91243 +=v4c270; } }  v3d785 =v3184 -v67e47.GetColumnGroupHeadersWidth()-16; if (v91243 ==v3d785-6 &&!vf7712)return; if (!v67e47.IsRootTable) v3d785 -=v67e47.GetParentHeadersWidth(); if (vf7712 =="Resize") { v3d785 -=parseInt(vbe667.estWidth); v91243 -=parseInt(vbe667.estWidth); }  if (v67e47.IsRootTable)v5bb83 =v67e47.GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0];  for (var vd4483=0; vd4483<vb0821.length; vd4483++) { var vd3a92 =vb0821[vd4483]; var v44829 =0; var vd2a4 =0; if (!vd3a92.dontResize &&!vd3a92.dontResizeTemp) { var v4c270; v4c270 =v67e47.GetCSHeaderWidth(vd4483); if (vd3a92.fixedWidth) { vd2a4 =parseInt(vd3a92.fixedWidth); vd3a92.fixedWidth =null; } else  { v44829 =(v4c270/v91243)*100; vd2a4 =parseInt((v44829/100)*v3d785); }  vc619 +=vd2a4;  if (vd4483 ==vd3a92.length-1) { var vdd425 =v3d785 -vc619; if (vd2a4 +vdd425 -2>16) vd2a4 +=vdd425-2; }  var vfc132 =null; if (vf7712 &&!v67e47.IsRootTable) { var v0b515; if (vf7712 !="SubTable") { v0b515 =vbe667.parentElement; v5bb83 =v67e47.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,v0b515).rows[0]; } else v5bb83 =v98332.GetElement(WG40.COLHEADER,WG40.HTMLTABLE).rows[0]; }  if (!vfc132) { vfc132 =new Object(); vfc132.type ="CSHeader"; vfc132.pos =vd4483; vfc132.parentElement =v5bb83; } if (vfc132) { wg85027.m38974(v67e47,vfc132,vd2a4,null,true); if (!v67e47.IsRootTable &&vf7712 =="Resize") { for (tableId in v67e47.SubTableIds) wg85027.mf6633(v67e47,"SubTable",null,null,null,v67e47.SubTableIds[tableId]); } wg_Global.ColSizeTarget =null; }  } else if (vd3a92.dontResizeTemp) vd3a92.dontResizeTemp =null; } } },  m8fc98:function(va6f96) { for (var vaf296=0; vaf296<va6f96.length; vaf296++) { if (va6f96[vaf296].checked) return va6f96[vaf296]; } return null; },  mdcb3:function(v1e842) { var v50d8 =null; for (var vc7e47=0; vc7e47<v1e842.cells.length; vc7e47++){if (v1e842.cells[vc7e47].type =="PRExp"){v50d8 =v1e842.cells[vc7e47]; break; }} return v50d8; }, m25f72:function(v0c456) { var va5e42 =null; var v8408 =null; var vae936 =null;  if (v0c456.tagName =="IMG") { va5e42 =v0c456.parentElement; v8408 =va5e42.parentElement; vae936 =v0c456; } else { v8408 =v0c456; va5e42 =wg85027.mdcb3(v8408); vae936 =va5e42.childNodes[0]; if (vae936 &&vae936.tagName !="IMG") vae936 =null; }  var va8277 =wgGetPreviewRow(v8408); var v4f711 =wg38213.m88693(v8408); var v18723 =wgGetGridById(v4f711.gridId); var v41a86 =v18723.Tables[v4f711.tblName]; if (va5e42.expanded =="True") { var vd8e0 =wgGetPreviewRowCell(va8277); if (vd8e0)vd8e0.childNodes[0].style.display ="none"; if (vae936)vae936.src =v18723.LayoutSettings.ImageSettings.Folder +v18723.LayoutSettings.ImageSettings.PreviewRowCollapseImage; va5e42.expanded ="False"; vd8e0.style.height ="1px"; if (!v41a86.IsRootTable) { for (var v87c81=0; v87c81<va8277.cells.length; v87c81++) { if (va8277.cells[v87c81].style.height =="100%") va8277.cells[v87c81].style.height ="1px"; } } } else  { var vd8e0 =wgGetPreviewRowCell(va8277); if (vd8e0)vd8e0.childNodes[0].style.display =""; if (vae936)vae936.src =v18723.LayoutSettings.ImageSettings.Folder +v18723.LayoutSettings.ImageSettings.PreviewRowExpandImage; va5e42.expanded ="True"; if (va5e42.eHeight)vd8e0.style.height =va5e42.eHeight; else vd8e0.style.height =""; if (!v41a86.IsRootTable) { for (var v87c81=0; v87c81<va8277.cells.length; v87c81++) { if (va8277.cells[v87c81].style.height =="1px") va8277.cells[v87c81].style.height ="100%"; } } } }, m61352:function(vdf779,v6999) { var vc8756 =wgGetCellByName(v6999,vdf779.SelfReferencingSettings.ExpandColumnMember); return vc8756.childNodes[0].childNodes[0].childNodes[0]; },  mc7f63:function(v5e113,v9f470) { if (v9f470.srLevel =="0")return v9f470;  var v28e79 =parseFloat(v9f470.srLevel)-1; var vcf09 =wgGetPreviousRow(v5e113,v9f470);  while (vcf09) { if (vcf09.srLevel ==v28e79) return vcf09;  vcf09 =wgGetPreviousRow(v5e113,vcf09); }  return null;  }, m40476:function(v41249,vcaa28,vb8258) { var tr,gd,table; if (v41249) { tr =wg38213.m25474(v41249); gd =ISGetObject(wg38213.m76d80(tr)); if (!tr.srExpanded)tr.srExpanded ="False"; if (tr.srExpanded =='False') v41249.src =gd.LayoutSettings.ImageSettings.Folder +gd.LayoutSettings.ImageSettings.CollapseImage; else v41249.src =gd.LayoutSettings.ImageSettings.Folder +gd.LayoutSettings.ImageSettings.ExpandImage; } else  { tr =vcaa28; gd =ISGetObject(wg38213.m76d80(tr)); if (!tr.srExpanded)tr.srExpanded ="False"; }  var vc6613 =wg38213.m88693(tr); table =gd.Tables[vc6613.tblName]; var v12870 =table.SelfReferencingSettings.ExpandColumnMember; wg38213.m79d94(tr); if (tr.srExpanded =='False') { var v17414; var v2eb59 =parseFloat(tr.srLevel); if ((tr.srRC =="0" &&!table.SelfReferencingSettings.LoadOnDemand)||tr.srRC ==-1)return;  if (!ISEvent.Raise(table.Layout.ClientSideEvents.OnSelfRefRowExpand,gd.Id,table.Id,tr.rowIndex,tr)) return;  if (table.SelfReferencingSettings.LoadOnDemand &&v41249 &&tr.srRC =="0") { wg38213.mc2b9(gd.Name,"LoadSelfRefChild",tr); return; } tr.srExpanded ='True'; v17414 =wgGetNextRow(vc6613,tr); var v20593 =false; var v30774 =false; var vb5295 =false;  if (typeof(event)=="object" &&event &&event.shiftKey)vb5295 =true; while (v17414) { wg38213.m79d94(v17414); if (v17414.type =="GroupHeader" ||(v17414.srLevel ==v2eb59 &&(v17414.type !="HierRecord" &&v17414.type !="CSRecord" &&v17414.type !="PR" )))break; if ((!vb5295 &&v17414.srLevel ==v2eb59+1)||(vb5295 &&v17414.srLevel >=v2eb59+1)) { if (v17414.type =="HierRecord" &&v17414.expanded !="True") { } else  { v17414.style.display =""; if (vb5295 &&v17414.type =="Record") { var vfaf36 =wg85027.m61352(table,v17414); if (vfaf36) { vfaf36.src =gd.LayoutSettings.ImageSettings.Folder +gd.LayoutSettings.ImageSettings.CollapseImage; v17414.srExpanded ="True"; } } } if (!vb5295 &&v17414.srExpanded =="True") { v17414.srExpanded ="False"; wg85027.m40476(null,v17414); } v30774 =true;  } else if (v17414.srLevel ==v2eb59) { if (v30774)v20593 =true; }  if (v20593) break;  v17414 =wgGetNextRow(vc6613,v17414); }  if (table.SelfReferencingSettings.FitColumnOnExpand) { var v3ed79 =table.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,tr).rows[0]; var v4629 =wgGetCellByName(v3ed79,v12870); wg85027.m69b38(v4629); if (v41249)wg85027.ma1862(gd.Name); } } else  { var v17414; var v2eb59 =parseFloat(tr.srLevel); tr.srExpanded ='False'; if (!ISEvent.Raise(table.Layout.ClientSideEvents.OnSelfRefRowCollapse,gd.Id,table.Id,tr.rowIndex,tr)) return; v17414 =wgGetNextRow(vc6613,tr); while (v17414) { wg38213.m79d94(v17414); if (v17414.type =="GroupHeader" ||(v17414.srLevel ==v2eb59 &&v17414.type !="HierRecord" &&v17414.type !="CSRecord" &&v17414.type !="PR"))break; if (v17414.srLevel >=v2eb59+1) { v17414.style.display ="none"; } v17414 =wgGetNextRow(vc6613,v17414); } } }, m71b81:function(ve2d30,ve9916) { if (ve2d30.tagName =="INPUT" &&ve2d30.type =="checkbox" &&!ve2d30.chkHandler) { ve2d30.onclick =function(){wg85027.ma3e58(null,ve2d30);}; }  var v48471 =wg38213.mb6c95(ve2d30); var v18c21 =v48471.parentElement; var vb4557 =wg38213.m88693(v18c21); var v4c244 =wgGetGridById(vb4557.gridId); if (ve9916) { var vce328 =0; var v44857 =0; var vdb037 =v4c244.LastChkBox; var vc0931 =0; if (vdb037)vc0931 =wg38213.mb6c95(vdb037).parentElement.rowIndex; if (v18c21.rowIndex >vc0931) { vce328 =vc0931;  v44857 =v18c21.rowIndex; } else { vce328 =v18c21.rowIndex+1;  v44857 =vc0931; } wg85027.m99d25(vb4557,vce328,v44857,!ve2d30.checked); } v4c244.LastChkBox =ve2d30; }, mba847:function(v20011,v0fc4) { var vf9720 =wg38213.m88693(v20011); var v26190 =wgGetGridById(vf9720.gridId); var v1fd37 =v26190.Tables[vf9720.tblName]; var v03812 =v1fd37.GetRowCheckerColumn(); var v0fe58 =wgGetCellByName(v20011,v03812); var v8af35 =v0fe58.getElementsByTagName("INPUT")[0]; if (typeof(v0fc4)=="undefined") v0fc4 =!v8af35.checked; wg85027.m71b81(v8af35); var v04598 =v8af35.checked; v8af35.checked =v0fc4; wg85027.ma3e58(v26190,v8af35,v04598); }, ma3e58:function(vadf1,v52978,v2ab20) { var vac31 =wg38213.mb6c95(v52978); var v98e78 =vac31.parentElement; var va7420 =wg38213.m88693(v98e78); if (vadf1 ==null) vadf1 =wgGetGridById(va7420.gridId);  if (!v52978.disabled) v98e78.isRowChecked =v52978.checked;  if (vadf1.LastSelObj &&!wgIsSameRow(vadf1.LastSelObj.GetRowElement(),v98e78)) wg60540.m37291(v98e78,v52978.checked ? "CheckedRow" : "Clear"); vadf1.CheckedRowContext =v98e78;  if (!ISEvent.Raise(vadf1.LayoutSettings.ClientSideEvents.OnCheckBoxClick,va7420.gridId,va7420.tblName,wgGetColNameByCell(vac31),v52978.checked,v2ab20)) return; }, m2b986:function(v74023) { var v60823 =wg38213.mb6c95(v74023); var vc7571 =v60823.parentElement; var va1319 =wg38213.m88693(vc7571); var v9d554 =wgGetGridById(va1319.gridId); var v16484 =v9d554.Tables[va1319.tblName]; wg85027.m99d25(v16484.GetElement(WG40.BODY,WG40.HTMLTABLE,vc7571),0,null,v74023.checked); wg38213.mb0b27(v9d554); }, m99d25:function(v68d46,v8c365,v20b18,v3f068) { if (typeof(v8c365)=="undefined")v8c365 =0; var v96323 =wgGetGridById(v68d46.gridId); var v2b871 =v96323.Tables[v68d46.tblName]; var ve0b19 =v68d46.rows[v8c365]; var v12754 =v2b871.GetRowCheckerColumn(); while (ve0b19) { if (ve0b19.type =="Record") { wg85027.mba847(ve0b19,v3f068); } ve0b19 =wgGetNextRow(v68d46,ve0b19); if (ve0b19 &&v20b18 &&ve0b19.rowIndex ==v20b18)break; } },  m3be23:function(v78d70) { var vfdf48 =event.type; var vca65 =event.srcElement;  if (vca65.tagName =="IMG") { vca65 =vca65.parentElement; if (vfdf48 =="mouseover" ||vfdf48 =="mouseup") DynamicStyleEngine.SetToOverStyle(null,v78d70.LayoutSettings.StatusBarCommandStyle,vca65); else if (vfdf48 =="mouseout") DynamicStyleEngine.SetToStyle(null,v78d70.LayoutSettings.StatusBarCommandStyle,vca65);  else if (vfdf48 =="mousedown") DynamicStyleEngine.SetToActiveStyle(null,v78d70.LayoutSettings.StatusBarCommandStyle,vca65);  } },  m40661:function(va9737) { for (var v38715=0; v38715<va9737.WebCombos.length; v38715++) { if (typeof(wcGetComboById)!="function") break;  va9737.WebCombos[v38715].Id =va9737.WebCombos[v38715].Id.replace(/\$/g,"_"); var v23286 =wcGetComboById(va9737.WebCombos[v38715].Id ); if (v23286) { v23286.FrameObj.style.display ="none"; document.body.insertAdjacentElement("beforeEnd",v23286.FrameObj); } } },  mdd335:function(v68b2) { for (var v4df2=0; v4df2<v68b2.WebCombos.length; v4df2++) { if (typeof(wcGetComboById)!="function") break;  v68b2.WebCombos[v4df2].Id =v68b2.WebCombos[v4df2].Id.replace(/\$/g,"_"); var vdbf76 =wcGetComboById(v68b2.WebCombos[v4df2].Id ); if (vdbf76) { vdbf76.FrameObj.style.display ="none"; v68b2.FrameObj.insertAdjacentElement("beforeEnd",vdbf76.FrameObj); } } }};var wg48f64 ={ m6f834:function(v81551,v19245,vd4325,vfe615) { v19245.setAttribute("action","ColumnFilter"); v19245.setAttribute("tblName",vfe615); v81551.SetStatus1("","filtertext","CommonText/FilterText"); return true; }, m31219:function(ve7751,vd0b45,v67125) { vd0b45.setAttribute("action","Custom"); var v96b51 =true; try  { v96b51 =wgPrepareCustomAction(ve7751,vd0b45,v67125); } catch(e){} return v96b51; }, mc3522:function(v2bd18,v93f25,v75022,v32d56) { var v0c451 =wg38213.m88693(v32d56); var veb445;  v93f25.setAttribute("action","LoadSelfRefChild"); v93f25.setAttribute("tblName",v0c451.tblName); v93f25.setAttribute("parentValue",v32d56.parentValue); try  { var v02025 =v2bd18.Tables[v0c451.tblName].GetParentRow(v32d56); veb445 =wgec043.m6f684(v2bd18,v93f25,v02025); }catch(e){}; v2bd18.SetStatus1("","loadsrchild","CommonText/LoadSelfRefChild"); return true; }, mc2118:function(v5b841,va7419,v2ef21,vd6069) { var v7e818 =wg38213.mb6c95(vd6069); var vd9f25 =v7e818.parentElement; var v24a22 =wg38213.m88693(vd9f25); var vc5456 =wgGetColNameByCell(v7e818);  va7419.setAttribute("action","ButtonClick"); va7419.setAttribute("tblName",v24a22.tblName); va7419.setAttribute("colName",vc5456); va7419.setAttribute("keyValue",vd6069.keyValue); return true; }, mc8777:function(v1b441,va1b19,v9e621) { va1b19.setAttribute("action","Refresh"); va1b19.setAttribute("tblName",v1b441.GetRootTable().Id); v1b441.SetStatus1("","refresh","CommonText/Refresh"); return true; }, m7eb49:function(v85341,vd7e19,ve8b21) { vd7e19.setAttribute("action","RefreshAll"); vd7e19.setAttribute("tblName",v85341.GetRootTable().Id); v85341.SetStatus1("","refreshall","CommonText/RefreshAll"); return true; }, m91373:function(v01885,vd546,v6ed19,va4096,v8c221) { vd546.setAttribute("action",v8c221); vd546.setAttribute("columnName",va4096.colName); vd546.setAttribute("tblName",va4096.tblName); var v78441 =""; var v1f819 =true;  try  { if (!va4096.gridId)va4096.gridId =v01885.Id; v1f819 =wgec043.m89770(va4096,vd546); } catch(e){}; if (!v1f819)return false;  if (v8c221 =="Group")v78441 ="Grouping"; else if (v8c221 =="Ungroup")v78441 ="Ungrouping"; else if (v8c221 =="ChangeGroup")v78441 ="Changing group";  v01885.SetStatus1("",v8c221.toLowerCase(),"CommonText/" +v8c221); v01885.LastRequestObj =va4096; return true; }, mcc548:function(v83565,v94353,v9c011) { var v63053 =parseFloat(v83565.TotalRows); var vd6d86 =parseFloat(v83565.TotalLoadedRows); if (vd6d86 >=v63053)return false;  v94353.setAttribute("action","More"); v94353.setAttribute("startRow",vd6d86); v94353.setAttribute("count",v83565.LayoutSettings.VirtualPageSize); v83565.SetStatus1("","more","CommonText/More");  return true; }, m9a470:function(vb9787,vde746,v02610,v68117) { var vb9b65 =v68117; var vab153 ="";  vab153 =wg85027.m9ce46(v68117);  vde746.setAttribute("action","LoadGroup"); vde746.setAttribute("position",v68117.position); vde746.setAttribute("groupIndex",v68117.groupIndex); vde746.setAttribute("parentPos",vab153); vb9787.SetStatus1("","loadgroup","CommonText/LoadGroup");  return true; }, ma1732:function(v80e87,vfd446,v85710,vc0317) { vfd446.setAttribute("action","ColumnSort"); vfd446.setAttribute("columnName",vc0317.colName); vfd446.setAttribute("tblName",vc0317.tblName); var v76787 =true; try  { if (!vc0317.gridId)vc0317.gridId =v80e87.Id; v76787 =wgec043.m89770(vc0317,vfd446);  } catch(e){}; if (!v76787)return false;  v80e87.SetStatus1("","sort","CommonText/Sort"); return true; }, m4ef16:function(v4a484,va1963,v45378,v37265) { va1963.setAttribute("action","ColumnChange"); va1963.setAttribute("columnName",v37265.colName); va1963.setAttribute("tblName",v37265.tblName); var v98284 =true; try  { if (!v37265.gridId)v37265.gridId =v4a484.Id; v98284 =wgec043.m89770(v37265,va1963);  } catch(e){}; if (!v98284)return false;  v4a484.SetStatus1("","columnchange","CommonText/ColumnChange"); return true; }, m45925:function(v1b476,va4d77,v43b65,v82740) { va4d77.setAttribute("action","Export"); var vb6d7 =""; var v86d56 =""; var ve6777 =""; if (!v82740) { var vd6879 =wg_Global.ExportContext; var v54e84 =vd6879.getDocument(); var v98124 =wg85027.m8fc98(v54e84.getElementsByName("rdoTable")).value; try  { vb6d7 =wg85027.m8fc98(v54e84.getElementsByName("rdoExport")).value; } catch (e){} ve6777 =wg85027.m8fc98(v54e84.getElementsByName("rdoOrientation")).value; if (v98124 =="0") v86d56 =v1b476.GetRootTable().Id; else  { v86d56 =wg85027.m8fc98(v54e84.getElementsByName("rdoTable")).getAttribute("tblName"); var v98457 =v1b476.Tables[v86d56].GetParentRow(v1b476.LastSelObj.GetRowElement()); wgec043.m6f684(v1b476,va4d77,v98457); va4d77.setAttribute("IsChildTable","True"); } } else  { v86d56 =v82740[0]; vb6d7 =v82740[1]; ve6777 =v82740[2];  var v60334 =v1b476.Tables[v86d56]; if (!v60334.IsRootTable) { wg85027.wgec043.m6f684(v1b476,va4d77,v82740[3]); va4d77.setAttribute("IsChildTable","True"); } } va4d77.setAttribute("tblName",v86d56); va4d77.setAttribute("exportType",vb6d7); va4d77.setAttribute("exportOrientation",ve6777); v1b476.SetStatus1("","export","CommonText/ExportText"); return true; },  me5f12:function(v76688,vb1744) { v76688.SetStatus1("","ready","CommonText/Ready"); }, me1228:function(va7d47,v77639) { var v97310 =""; try  { v97310 =ISXml.GetNodeText(v77639,"//htmlString"); } catch(e){}  var vfcb37 =va7d47.Tables[ISXml.GetNodeText(v77639,"//tblName")]; var vb3159 =va7d47.LastRequestObj; var v1f821 =vfcb37.GetElement(WG40.BODY,WG40.HTMLTABLE,vb3159); var vcd111 =v1f821.tBodies[v1f821.tBodies.length-1]; if (v97310 !="") { var vb5154 =parseFloat(ISXml.GetNodeText(v77639,"//totalRows")); wg85027.m15f64("<table>" +v97310 +"</table>"); var v24122 =wg85027.md1593(); var v9da64 =0; if (vfcb37.PreviewRowVisible) vb3159 =wgGetPreviewRow(vb3159);  var v79679 =v24122.rows.length; var v81c5 =parseFloat(vb3159.srLevel); for (var v7346=0; v7346<v79679; v7346++) { var vf1c42 =vcd111.appendChild(v24122.rows[0]); v1f821.moveRow(vf1c42.rowIndex,vb3159.rowIndex+v7346+1); wg38213.m79d94(vf1c42); if (v81c5+1 ==vf1c42.srLevel) vf1c42.style.display =""; }  vb3159.srRC =vb5154; if (vfcb37.SelfReferencingSettings.FitColumnOnExpand) { var v18659 =vfcb37.GetElement(WG40.COLHEADER,WG40.HTMLTABLE,vb3159).rows[0]; var v38828 =wgGetCellByName(v18659,vfcb37.SelfReferencingSettings.ExpandColumnMember); wg85027.m69b38(v38828); } if (vfcb37.IsRootTable) { var v3db13 =parseFloat(va7d47.TotalLoadedRows); var vcb248 =parseFloat(va7d47.TotalRows); vcb248 +=vb5154; v3db13 +=vb5154;  va7d47.Set("TotalLoadedRows",v3db13,true); va7d47.Set("TotalRows",vcb248,true);  va7d47.SetStatus2("","loaded",v3db13,vcb248); } } else  { var v38c72 =wg85027.m61352(vfcb37,vb3159); v38c72.style.visibility ="hidden"; vb3159.srRC =0; } vb3159.srExpanded ="True"; va7d47.SetStatus1("","ready","CommonText/Ready"); wg85027.m8cf25(); }, m13796:function(v6fc36,vce512) { var v62647 =ISXml.GetNodeText(vce512,"//htmlString"); var v21639 =v6fc36.Tables[ISXml.GetNodeText(vce512,"//tblName")].GetElement(WG40.BODY,WG40.HTMLDIV);  if (ISXml.GetNodeText(vce512,"//isRootTable")=="True") { IS.SetOuterHTML(v21639,v62647); wg38213.m39854(v6fc36); var vdee44 =ISXml.GetNodeText(vce512,"//footerString"); if (vdee44 !="") { var vbe722 =v6fc36.Tables[ISXml.GetNodeText(vce512,"//tblName")]; wg85027.m00245(v6fc36,vbe722,null,vdee44); } }  var vf3c83 =0; var vadc62 =parseFloat(ISXml.GetNodeText(vce512,"//totalRows")); if (v6fc36.LayoutSettings.PagingMode =="None") vf3c83 =vadc62; else vf3c83 =parseFloat(v6fc36.LayoutSettings.VirtualPageSize); if (vadc62 <vf3c83)vf3c83 =vadc62; v6fc36.Set("TotalLoadedRows",vf3c83,true); v6fc36.Set("TotalRows",vadc62,true); v6fc36.ClearChildTables(); v6fc36.SetStatus2("","loaded",vf3c83,vadc62); v6fc36.SetStatus1("","ready","CommonText/Ready"); },  m36564:function(vbb316,vef260) { var v0c236 =vbb316.Tables[ISXml.GetNodeText(vef260,"//tblName")]; var v79f12 =ISXml.GetNodeText(vef260,"//action"); var v66240 =vbb316.LastRequestObj; if (ISXml.GetNodeText(vef260,"//isRootTable")=="True") { var v63076 =v0c236.GetElement(WG40.BODY,WG40.HTMLDIV); var v45189 =v0c236.GetElement(WG40.COLHEADER,WG40.HTMLDIV,vc2e11); var v9b958 =ISXml.GetNodeText(vef260,"//colHtmlString"); var v18135 =ISXml.GetNodeText(vef260,"//bodyHtmlString"); IS.SetOuterHTML(v63076,v18135); wg38213.m39854(vbb316); var v12896 =ISXml.GetNodeText(vef260,"//footHtmlString"); if (v12896 !="") { wg85027.m00245(vbb316,v0c236,null,v12896); }  var vcf630 =0; var vc2e11 =parseFloat(ISXml.GetNodeText(vef260,"//totalRows")); if (vbb316.LayoutSettings.PagingMode =="None") vcf630 =vc2e11; else vcf630 =parseFloat(vbb316.LayoutSettings.VirtualPageSize); if (vc2e11 <vcf630)vcf630 =vc2e11; vbb316.Set("TotalLoadedRows",vcf630,true); vbb316.Set("TotalRows",vc2e11,true); var v3c74 =wg38213.md7a39(vbb316.LastSelObj); if ((v3c74 &&vbb316.LastSelObj.GetRowElement().type !="NewRow")||!v3c74) vbb316.ActiveEditCell =vbb316.LastSelObj =null;  vbb316.ClearChildTables(); vbb316.SetStatus2("","loaded",vcf630,vc2e11); } vbb316.SetStatus1("","ready","CommonText/Ready"); }, m5e572:function(vd2042,vea635) { var vb7816 =ISXml.GetNodeText(vea635,"//tableXmlState"); var v2fb60 =vd2042.RootTable; var vd2b32 =new WebGridTable(); var vb3384 =ISXml.CreateXmlDocument(); vb7816 ="<RootTable" +vb7816.substring(13); vb7816 =vb7816.substring(0,vb7816.length-15)+"</RootTable>";  ISXml.LoadXml(vb3384,vb7816.replace(/\CD/g,"]]")); ISXml.RemoveNode(vd2042.XmlNode,"RootTable");  var ve561 =ISXml.GetNode(vb3384,"RootTable"); vd2042.XmlNode.appendChild(ve561); vd2042.Tables =[]; vd2b32.XmlNode =ve561; vd2b32.Parent =vd2042; IS.SetPropertiesRecursive(vd2b32,ve561); vd2042.RootTable =vd2b32;  vd2042.UpdateState(); wg85027.m40661(vd2042);  var v3db49 =ISXml.GetNodeText(vea635,"//gridHtmlString"); vd2042.FrameObj.outerHTML =v3db49; vd2042.FrameObj =document.getElementById(vd2042.Name +IS.FrameSuffix); wg_Global.Resizer =null; wg_Global.Dragger =null; wg_Global.ColPointer =null; vd2042.Resizer =null; vd2042.ColPointer =null; vd2042.TBObj =vd2042.TBMLObj =vd2042.LastEditObj =null; vd2042.ActiveEditCell =vd2042.LastSelObj =null; wg85027.mdd335(vd2042);  wg38213.m80a49(vd2042); wg38213.m39854(vd2042); if (IS.moz)wg9d526.m43c19(vd2042); var v72a19 =vd2042.Tables[ISXml.GetNodeText(vea635,"//tblName")]; var v3989 =ISXml.GetNodeText(vea635,"//action"); var ve8319 =vd2042.LastRequestObj; if (ISXml.GetNodeText(vea635,"//isRootTable")=="True") { var v8ab61 =0; var v1a297 =parseFloat(ISXml.GetNodeText(vea635,"//totalRows")); if (vd2042.LayoutSettings.PagingMode =="None") v8ab61 =v1a297; else v8ab61 =parseFloat(vd2042.LayoutSettings.VirtualPageSize); if (v1a297 <v8ab61)v8ab61 =v1a297; vd2042.Set("TotalLoadedRows",v8ab61,true); vd2042.Set("TotalRows",v1a297,true); vd2042.ClearChildTables(); vd2042.SetStatus2("","loaded",v8ab61,v1a297); } vd2042.NeedHeightResize =true; wg38213.m23215(); vd2042.SetStatus1("","ready","CommonText/Ready"); },  m67274:function(v94774,v56b11) { var ve2e42 =v94774.Tables[ISXml.GetNodeText(v56b11,"//tblName")]; var ve5c35 =ISXml.GetNodeText(v56b11,"//action"); var v8f612 =v94774.LastRequestObj;  if (ISXml.GetNodeText(v56b11,"//isRootTable")=="True") { var vaf739 =v8f612.parentElement; var v23979 =ve2e42.GetElement(WG40.BODY,WG40.HTMLDIV,vaf739); var v58d53 =ve2e42.GetElement(WG40.COLHEADER,WG40.HTMLDIV,vaf739); var vd8232 =ISXml.GetNodeText(v56b11,"//colHtmlString"); var v40841 =ISXml.GetNodeText(v56b11,"//bodyHtmlString"); var v62370 =ISXml.GetNodeText(v56b11,"//footHtmlString");  IS.SetOuterHTML(v23979,v40841); wg38213.m39854(v94774);  if (ve5c35 =="Group" ||ve5c35 =="Ungroup" ||ve5c35 =="ColumnChange") { v58d53.outerHTML =vd8232; if (IS.moz)wg9d526.m43c19(v94774); try  { var v72067 =ve2e42.GetElement(WG40.COLFOOTER,WG40.HTMLDIV,vaf739); } catch (e){};  if (v72067) { v72067.outerHTML =v62370; } }  var v52195 =0; var vaf739 =parseFloat(ISXml.GetNodeText(v56b11,"//totalRows")); if (v94774.LayoutSettings.PagingMode =="None") v52195 =vaf739; else v52195 =parseFloat(v94774.LayoutSettings.VirtualPageSize); if (vaf739 <v52195)v52195 =vaf739; v94774.Set("TotalLoadedRows",v52195,true); v94774.Set("TotalRows",vaf739,true); v94774.ClearChildTables(); v94774.SetStatus2("","loaded",v52195,vaf739); } else  { for (var vc0b82=0 ;vc0b82<ve2e42.SubTableIds.length; vc0b82++) { var v20360 =ve2e42.SubTableIds[vc0b82]; var vb4411 =ISXml.GetNodeText(v56b11,"//htmlString_" +v20360.SubId); var v4e376 =v20360.GetContainer(); v4e376.innerHTML =vb4411; if (IS.moz)wg9d526.m72531(v20360); } v94774.ClearChildTables(ve2e42.Id); }  if ((ve2e42.IsRootTable ||v94774.LastSelObj &&ve2e42.Id ==v94774.LastSelObj.tblName)&&ve5c35 !="ChangeGroup") v94774.ActiveEditCell =v94774.LastSelObj =null;  if (v94774.FromContextMenu) { v94774.FromContextMenu =false; wg85027.ma1862(v94774.Name); } v94774.SetStatus1("","ready","CommonText/Ready"); },  m1db82:function(v12496,vbcd5) { var v53c74 =v12496.Tables[ISXml.GetNodeText(vbcd5,"//tblName")]; if (v53c74.IsRootTable) { var v9cc11 =ISXml.GetNodeText(vbcd5,"//htmlString"); var v19b74 =v53c74.GetElement(WG40.BODY,WG40.HTMLDIV); if (ISXml.GetNodeText(vbcd5,"//isRootTable")=="True") { IS.SetOuterHTML(v19b74,v9cc11); wg38213.m39854(v12496); } var v1a468 =0; var vd6236 =parseFloat(ISXml.GetNodeText(vbcd5,"//totalRows")); if (v12496.LayoutSettings.PagingMode =="None") v1a468 =vd6236; else v1a468 =parseFloat(v12496.LayoutSettings.VirtualPageSize); if (vd6236 <v1a468)v1a468 =vd6236; v12496.Set("TotalLoadedRows",v1a468,true); v12496.Set("TotalRows",vd6236,true); v12496.SetStatus2("","loaded",v1a468,vd6236);  v12496.ClearChildTables(); }else {  for (var v9f832=0 ;v9f832<v53c74.SubTableIds.length; v9f832++){ var v65561 =v53c74.SubTableIds[v9f832]; var v9cc11 =ISXml.GetNodeText(vbcd5,"//htmlString_" +v65561.SubId); var vcbd72 =v65561.GetContainer(); vcbd72.innerHTML =v9cc11; if (IS.moz)wg9d526.m72531(v65561); } v12496.ClearChildTables(v53c74.Id); } wg85027.m64b95(v12496,v53c74); v12496.SetStatus1("","ready","CommonText/Ready"); }, m41b98:function(v0b518,v75a98) { var v95818 =ISXml.GetNodeText(v75a98,"//htmlString"); var vc4c98 =v0b518.Tables[ISXml.GetNodeText(v75a98,"//tblName")].GetElement(WG40.BODY,WG40.HTMLTABLE); wg85027.m15f64("<table>" +v95818 +"</table>"); var v42772 =wg85027.md1593(); var v3ef95 =0;  vc4c98.appendChild(v42772.tBodies[0] ); v0b518.Set("TotalLoadedRows",parseFloat(ISXml.GetNodeText(v75a98,"//endRow")),true); v0b518.SetStatus2("","loaded",ISXml.GetNodeText(v75a98,"//endRow"),ISXml.GetNodeText(v75a98,"//totalRows")); v0b518.SetStatus1("","ready","CommonText/Ready"); wg85027.m8cf25(); },  mc5393:function(v3e298,vcdd46) { var v47118 =ISXml.GetNodeText(vcdd46,"//htmlString"); var va5898 =v3e298.Tables[ISXml.GetNodeText(vcdd46,"//tblName")].GetElement(WG40.BODY,WG40.HTMLTABLE); wg85027.m15f64("<table>" +v47118 +"</table>"); var vd8172 =wg85027.md1593(); var vada95 =v3e298.LastRequestObj; var vce639 =vada95.fullPath; if (vce639 !="")vce639 +="_"; var v16280 =document.getElementById("ty_" +vce639 +vada95.position); v16280.appendChild(vd8172.tBodies[0]); v16280.childNodes[0].removeNode(false); vada95.childrenLoaded ="True"; vada95.expanded ="False"; wg85027.m22c96(null,vada95,true); var v65358 =parseFloat(ISXml.GetNodeText(vcdd46,"//count"))+parseFloat(v3e298.TotalLoadedRows); var vada95 =v3e298.TotalRows;  if (v65358 >vada95)v65358 =vada95; v3e298.Set("TotalLoadedRows",v65358,true);  v3e298.SetStatus2("","loaded",v65358,vada95); v3e298.SetStatus1("","ready","CommonText/Ready");  wg85027.m8cf25(); },  mb9a15:function(ve1467,v1a967) { var v20598 =ISXml.GetNodeText(v1a967,"//status"); if (v20598 =="Ok") { var vd8446 =ISXml.GetNodeText(v1a967,"//outputFile"); var vba564 =ISXml.GetNodeText(v1a967,"//htmlTitle"); if (vd8446.indexOf(".xls")>0 ||vd8446.indexOf(".tif")>0 ||vd8446.indexOf(".rtf")>0) { var vc182 =window.open(null,null,ve1467.ExportWndAttr); var vb7e51 =vc182.document; vb7e51.open("text/html","replace"); vb7e51.write("<html><title>" +(vba564 =="" ? "WebGrid.NET Enterprise Report" : vba564)+"</title><body style='margin:0' scroll='no'><iframe style='width:100%;height:100%' src='" +vd8446 +"'></iframe></body></html>"); vb7e51.close(); } else { var vc182 =window.open(vd8446,null ,ve1467.ExportWndAttr); if (!vc182) { alert("The report window is currently blocked by Internet Explorer's Pop-up Blocker feature.\nPlease click on the Information Bar and allow the file download."); } } } ve1467.SetStatus1("","ready","CommonText/Ready"); }};function wgGetNextRow(va6258,v22146){ return wg38213.mff917(va6258,v22146);}function wgGetPreviousRow(v52c58,v48c46){ return wg38213.m71270(v52c58,v48c46);}function wgAutoFitColumns(v50c80){ return wg85027.ma1862(v50c80);}function wgFlushUpdates(){ if (wg_Global.PendingUpdates ) { var v15e80 =wg_Global.PendingUpdates; for (var v7be39=0; v7be39<v15e80.length; v7be39++) { var v8c949 =v15e80[v7be39]; v8c949.style.width =v8c949.offsetWidth; wg85027.m8a489(v8c949); var v6ea87 =v8c949.parentElement; var v3ce56 =wg38213.m88693(v6ea87); var v58091 =wgGetGridById(v3ce56.gridId); var v4ab64 =v58091.Tables[v3ce56.tblName]; wg85027.m7e070(v4ab64,v6ea87,v8c949,v8c949.offsetWidth); } wg_Global.PendingUpdates =null; } wg_Global.NoDisplayUpdate =false;}function wgGetCSHeaderWidth(v32860,vfe586){ var vd7292 =vfe586.parentElement; var vfb16 =v32860.GetColumnSetByPos(vfe586.pos); var vb4544 =v32860.GetElement(WG40.COLHEADERGROUP,null,vd7292); var vc1955 =v32860.GetColHeaderSpanCount()+v32860.GetCSHeaderCellPosByIndex(vfe586); var v6bf14 =vc1955 +parseInt(vfb16.ColumnCount); var v6da60 =0;  for (var v20c5=vc1955; v20c5<v6bf14; v20c5++) { var v2f113 =vb4544.childNodes[v20c5].offsetWidth; if (v2f113 ==0)v2f113 =vb4544.childNodes[v20c5].width; if (isNaN(v2f113))v2f113 =0; v6da60 +=parseInt(v2f113); } return v6da60;}function plGetCurX(){if (event) return event.clientX +document.body.scrollLeft;}function plGetCurY(){if (event) return event.clientY +document.body.scrollTop;}function wgRefresh(v1ca60,v5b586){ var v26760 =ISGetObject(v1ca60); if (!v26760.Enabled)return; if (!v5b586)v5b586 =false; if (!v5b586) wg38213.mc2b9(v1ca60,"Refresh"); else wg38213.mc2b9(v1ca60,"RefreshAll");}function wgLoadMore(vc3494){ var vf8494 =ISGetObject(vc3494); if (!vf8494.Enabled)return; var vc0547 =vf8494.GetRootTable(); if (vc0547.GroupedColumns.length >0) { alert(vf8494.GetString("MessageBoxText/LoadMoreException")); return; } wg38213.mc2b9(vc3494,"More");}function wgExport(v9b194){ var vcd494 =ISGetObject(v9b194); wg20949.mfe332(vcd494);}function wgGetNextFocusableElement(vb1267,v39149,v0905){ var v84094 =vb1267.FrameObj; var v47e47; var v99c35 =false; var v9ac76 =false;  if (v39149){ if (!v0905) v47e47 =document.all[v84094.sourceIndex-1]; else v47e47 =document.all[v0905.sourceIndex-1]; }else { if (!v0905) v47e47 =v84094.nextSibling; else v47e47 =document.all[v0905.sourceIndex+1]; } while (v47e47){ if ((v47e47.tagName =="DIV" &&v47e47.id.substring(0,4)=="dvMF")||v47e47.tagName =="INPUT" ||v47e47.tagName =="SELECT" ||v47e47.tagName =="TEXTAREA" ||v47e47.tagName =="BUTTON"){ var v5cc77 =false; if (v47e47.tagName =="INPUT" &&v47e47.type =="hidden") v5cc77 =true;  if (v47e47.disabled ||v47e47.style.display =="none" ||v47e47.style.visible =="hidden") v5cc77 =true;  if (!v5cc77) return v47e47; } if (!v39149){ if (v47e47.sourceIndex <(v99c35 ? v84094.sourceIndex-1 : document.all.length-1 )) v47e47 =document.all[v47e47.sourceIndex+1]; else { if (!v99c35){ v99c35 =true; v47e47 =document.all[0]; }else v47e47 =null; } }else { if (v47e47.sourceIndex >(v9ac76 ? v84094.sourceIndex+1 : 1 )) v47e47 =document.all[v47e47.sourceIndex-1]; else { if (!v9ac76){ v9ac76 =true; v47e47 =document.all[document.all.length-1]; }else v47e47 =null; } } } return null;}function wgGetPrevFocusableElement(vc5669){ return wgGetNextFocusableElement(vc5669,true);}function wgCopyToCB(vbef69){ if (IS.ie) window.clipboardData.setData('Text',vbef69); else wg9d526.m6dc70(vbef69);}function wgDisplayErrorBox(v4af14,v57c77,v6eb94){ wg85027.m3843(v4af14,v57c77,v6eb94);}function wgCheckBoxHeaderClick(vc1314){ return wg85027.m2b986(vc1314);}function _wgCHResize(v30c0){ var v46714; if (v30c0)v46714 =v30c0; else v46714 =event.srcElement; if (wg_Global.NoDisplayUpdate) { if (v46714.tagName =="TD" &&v46714.type =="Column" &&v46714.isSorted =="False") { if (!wg_Global.PendingUpdates)wg_Global.PendingUpdates =new Array(); var v20b77 =wg_Global.PendingUpdates; var vd1894 =false; for (var v04227=0; v04227<v20b77.length; v04227++) { if (v20b77[v04227] ==v46714) { vd1894 =true; break; } } if (!vd1894) v20b77[v20b77.length] =v46714; return; } } if (v46714.tagName =="TD" &&v46714.type =="Column" &&!wg_Global.IsResizing) { v46714.style.width =v46714.offsetWidth; wg_Global.IsResizing =true; wg85027.m8a489(v46714); var v2a088 =v46714.parentElement; var v4c955 =wg_getTable(v2a088); var v5397 =wgGetGridById(v4c955.gridId); var v70297 =v5397.Tables[v4c955.tblName]; wg85027.m7e070(v70297,v2a088,v46714,v46714.offsetWidth); wg_Global.IsResizing =false; }}function WebGridUIDestructor(){ var v8c290 =delete wg85027; v8c290 =delete wg48f64;}window.attachEvent("onunload",WebGridUIDestructor);