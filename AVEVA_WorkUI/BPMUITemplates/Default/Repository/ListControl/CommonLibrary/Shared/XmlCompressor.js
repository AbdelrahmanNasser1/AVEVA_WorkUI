var XmlCompressorEngine={delimeter:"\03",subdelimeter:"\02",delimeters:new Array(":","-","."," ","$","/"),counterNode:0,counterAttr:0,counterVal:0,LoadXML:function(d){var c;var b=new CompressorMapping();var a=new CompressorMapping();a.arrNodes=new Array();a.arrAttrs=new Array();a.arrVals=new Array();XmlCompressorEngine.counterNode=0;XmlCompressorEngine.counterAttr=0;XmlCompressorEngine.counterVal=0;c=d.documentElement;b=XmlCompressorEngine.PopulateReservedKey(c,b);a=XmlCompressorEngine.PopulateNodes(c,a,b);return a},PopulateReservedKey:function(c,e){if(String(c.nodeName).length<=2){if(e.Nodes!=""){e.Nodes+=XmlCompressorEngine.delimeter}e.Nodes+=c.nodeName+XmlCompressorEngine.subdelimeter+" "+XmlCompressorEngine.subdelimeter+"0"}e=XmlCompressorEngine.ReservedAttrValKey(c,e);if(c.hasChildNodes()){var d=c.childNodes;for(var a=0;a<d.length;a++){var b=d.item(a);if(b.nodeTypeString=="cdatasection"){}else{e=XmlCompressorEngine.PopulateReservedKey(b,e)}}}return e},ReservedAttrValKey:function(c,d){if(c.attributes!=null){for(var a=0;a<c.attributes.length;a++){if(String(c.attributes[a].nodeName).length<=2){if(d.Attributes!=""){d.Attributes+=XmlCompressorEngine.delimeter}d.Attributes+=c.attributes[a].nodeName+XmlCompressorEngine.subdelimeter+" "+XmlCompressorEngine.subdelimeter+"0"}var e=XmlCompressorEngine.Split(c.attributes[a].nodeValue,XmlCompressorEngine.delimeters);for(var b=0;b<e.length;b++){if(String(e[b]).length<=2){if(d.Values!=""){d.Values+=XmlCompressorEngine.delimeter}d.Values+=e[b]+XmlCompressorEngine.subdelimeter+" "+XmlCompressorEngine.subdelimeter+"0"}}}}return d},PopulateNodes:function(g,f,k){var h=f.Nodes;var b=XmlCompressorEngine.Search(h,g.nodeName,"item");if(b==null){var a=XmlCompressorEngine.counterNode;do{if(a<26){if(h==""){nodekey="A"}else{nodekey=String.fromCharCode(a+65)}}else{nodekey=String.fromCharCode(a/26+64,a%26+65)}a++}while(XmlCompressorEngine.Search(k.nodes,nodekey,"item")!=null);XmlCompressorEngine.counterNode=a;if(h!=""){h+=XmlCompressorEngine.delimeter}h+=g.nodeName+XmlCompressorEngine.subdelimeter+nodekey+XmlCompressorEngine.subdelimeter+"1"}else{b.count++;if(b.count==2){f.arrNodes.push(b)}var m=new String(b.count);var e=(XmlCompressorEngine.Mod(b.count,10)==true)?m.length-1:m.length;h=XmlCompressorEngine.Replace(h,b.count,b.idxCount,e)}f=XmlCompressorEngine.PopulateAttributesValues(g,f,k);if(g.hasChildNodes()){var j=g.childNodes;var l=null;for(var c=0;c<j.length;c++){var d=j.item(c);if(d.nodeTypeString=="cdatasection"){}else{f.Nodes=h;l=XmlCompressorEngine.PopulateNodes(d,f,k);h=l.Nodes}}}f.Nodes=h;return f},PopulateAttributesValues:function(d,c,e){if(d.attributes!=null){for(var a=0;a<d.attributes.length;a++){c=XmlCompressorEngine.PopulateArrList("Attributes",c,d.attributes[a].nodeName,e.Attributes);var f=XmlCompressorEngine.Split(d.attributes[a].nodeValue,XmlCompressorEngine.delimeters);for(var b=0;b<f.length;b++){c=XmlCompressorEngine.PopulateArrList("Values",c,f[b],e.Values)}}}return c},PopulateArrList:function(k,f,i,j){var a;var g;var b;if(k=="Attributes"){a=f.Attributes;g=f.arrAttrs;b=XmlCompressorEngine.counterAttr}else{if(k=="Values"){a=f.Values;g=f.arrVals;b=XmlCompressorEngine.counterVal}}if(i!=""){var c=XmlCompressorEngine.Search(a,i,"item");if(c==null){var d="";do{if(b<26){if(a==""){d="a"}else{d=String.fromCharCode(b+97)}}else{d=String.fromCharCode(b/26+96,b%26+97)}b++}while(XmlCompressorEngine.Search(j,d,"item")!=null);if(a!=""){a+=XmlCompressorEngine.delimeter}a+=i+XmlCompressorEngine.subdelimeter+d+XmlCompressorEngine.subdelimeter+"1"}else{c.count++;if(c.count==2){g.push(c)}var h=new String(c.count);var e=(XmlCompressorEngine.Mod(c.count,10)==true)?h.length-1:h.length;a=XmlCompressorEngine.Replace(a,c.count,c.idxCount,e)}}if(k=="Attributes"){f.Attributes=a;XmlCompressorEngine.counterAttr=b}else{if(k=="Values"){f.Values=a;XmlCompressorEngine.counterVal=b}}return f},Search:function(a,e,g){var i=XmlCompressorEngine.delimeter+a;if(g=="item"){e=XmlCompressorEngine.delimeter+e+XmlCompressorEngine.subdelimeter}else{if(g=="keyitem"){e=XmlCompressorEngine.subdelimeter+e+XmlCompressorEngine.subdelimeter}}var d=i.indexOf(e);if(d>=0){var k=i.substr(0,d+1);var f=k.lastIndexOf(XmlCompressorEngine.delimeter);k=i.substr(d+1);var h=k.indexOf(XmlCompressorEngine.delimeter);var j="";if(h>=0){j=i.substring(f+1,f+h+1)}else{j=i.substr(f+1)}var b=j.split(XmlCompressorEngine.subdelimeter);var c=new Dictionary();c.item=b[0];c.keyitem=b[1];c.count=b[2];c.idxItem=(f+1)-1;c.idxKey=(f+1+c.item.length+1)-1;c.idxCount=(f+1+c.item.length+1+c.keyitem.length+1)-1;return c}else{return null}},Split:function(f,c){var a=new Array();var b=new Array();for(var d=0;d<c.length;d++){var e=-1;do{e=f.indexOf(c[d],e+1);if(e>=0){b.push(e)}}while(e>=0)}b=b.sort(XmlCompressorEngine.compareNum);for(var d=0;d<b.length;d++){if(d==0){a.push(f.substring(d,b[d]))}else{a.push(f.substring(b[d-1]+1,b[d]))}}a.push(f.substr(b[d-1]+1));return a},compareNum:function(c,d){return c-d},Replace:function(f,a,b,c){if(c==undefined){c=1}var d=f.substring(0,b);var e=f.substr(b+c);return d+a+e},Mod:function(a,b){var c=a;while(c>=b){c=c/b}if(c%b>1){return false}else{return true}},Compress:function(b,a){var d="<CompressedXml>";d=XmlCompressorEngine.IterateNodeCompress(b,a,d);d+="\n<ISXMLMapping>";d=XmlCompressorEngine.WriteMapping(a.arrNodes,"NodeKey","NodeValue",d);d=XmlCompressorEngine.WriteMapping(a.arrAttrs,"AttrKey","AttrValue",d);d=XmlCompressorEngine.WriteMapping(a.arrVals,"ValKey","ValValue",d);d+="</ISXMLMapping>\n";d+="</CompressedXml>\n";var c=ISXml.CreateXmlDocument();c.async=false;if(!c.loadXML(d)){d=XmlCompressorEngine.EncodeXml(d);c.loadXML(d)}return c},IterateNodeCompress:function(k,h,n){var m="";if(k.nodeTypeString=="cdatasection"||k.nodeType==4){m="<![CDATA["+k.nodeValue+"]]>"}else{var b=XmlCompressorEngine.Lookup(k.nodeName,h.arrNodes,"item");if(b!=null){m="<"+b.keyitem}else{m="<"+k.nodeName}if(k.attributes!=null){for(var e=0;e<k.attributes.length;e++){var c=XmlCompressorEngine.Lookup(k.attributes[e].nodeName,h.arrAttrs,"item");if(c!=null){m+=" "+c.keyitem+"="}else{m+=" "+k.attributes[e].nodeName+"="}var a=XmlCompressorEngine.ConstructValueDelimeter(k.attributes[e].nodeValue);var p=XmlCompressorEngine.Split(k.attributes[e].nodeValue,XmlCompressorEngine.delimeters);var o="";for(var g=0;g<p.length;g++){var d=XmlCompressorEngine.Lookup(p[g],h.arrVals,"item");var l=(d!=null)?d.keyitem:p[g];o+=l;if(g<p.length-1){o+=a[g]}}m+='"'+o+'"'}}if(!k.hasChildNodes()){m+="/"}m+=">";n+=m;if(k.hasChildNodes()){for(var e=0;e<k.childNodes.length;e++){var f=k.childNodes.item(e);n=XmlCompressorEngine.IterateNodeCompress(f,h,n)}}m="";if(b!=null){if(k.hasChildNodes()){m="</"+b.keyitem+">"}}else{if(k.hasChildNodes()){m="</"+k.nodeName+">"}}}n+=m;return n},Decompress:function(b,a){var d="<UncompressedXml>";d=XmlCompressorEngine.IterateNodeDecompress(b,a,d);d+="</UncompressedXml>\n";var c=ISXml.CreateXmlDocument();c.async=false;if(!c.loadXML(d)){d=XmlCompressorEngine.EncodeXml(d);c.loadXML(d)}return c},IterateNodeDecompress:function(k,h,n){if(k.nodeName!="ISXMLMapping"){var m="";if(k.nodeTypeString=="cdatasection"){m="<![CDATA["+k.nodeValue+"]]>"}else{var b=XmlCompressorEngine.Lookup(k.nodeName,h.arrNodes,"keyitem");if(b!=null){m="<"+b.item}else{m="<"+k.nodeName}for(var e=0;e<k.attributes.length;e++){var c=XmlCompressorEngine.Lookup(k.attributes[e].nodeName,h.arrAttrs,"keyitem");if(c!=null){m+=" "+c.item+"="}else{m+=" "+k.attributes[e].nodeName+"="}var a=XmlCompressorEngine.ConstructValueDelimeter(k.attributes[e].nodeValue);var p=XmlCompressorEngine.Split(k.attributes[e].nodeValue,XmlCompressorEngine.delimeters);var o="";for(var g=0;g<p.length;g++){var d=XmlCompressorEngine.Lookup(p[g],h.arrVals,"keyitem");var l=(d!=null)?d.item:p[g];o+=l;if(g<p.length-1){o+=a[g]}}m+='"'+o+'"'}if(!k.hasChildNodes()){m+="/"}m+=">";n+=m;if(k.hasChildNodes()){for(var e=0;e<k.childNodes.length;e++){var f=k.childNodes.item(e);n=XmlCompressorEngine.IterateNodeDecompress(f,h,n)}}m="";if(b!=null){if(k.hasChildNodes()){m="</"+b.item+">"}}else{if(k.hasChildNodes()){m="</"+k.nodeName+">"}}}n+=m}return n},Lookup:function(d,a,e){for(var c=0;c<a.length;c++){var b=a[c];var f=b[e];if(f==d){return b}}return null},ConstructValueDelimeter:function(f){var b=XmlCompressorEngine.delimeters;var c=new Array();for(var d=0;d<b.length;d++){var e=-1;do{e=f.indexOf(b[d],e+1);if(e>=0){c.push(e)}}while(e>=0)}c=c.sort(XmlCompressorEngine.compareNum);var a=new Array();for(var d=0;d<c.length;d++){a.push(f.substr(c[d],1))}return a},StringMapping:function(a){var f="";var e="";for(var d=0;d<a.length;d++){if(d>0){f+="\x7f"}if(d>0){e+="\x7f"}var b=a[d];f+=b.keyitem;e+=b.item}var c=new Dictionary();c.keyitem=f;c.item=e;return c},WriteMapping:function(a,d,e,c){var b=XmlCompressorEngine.StringMapping(a);c+="<"+d+">"+b.keyitem+"</"+d+">\n";c+="<"+e+">"+b.item+"</"+e+">\n";return c},EncodeXml:function(o){var l='(CDATA(?=\\[)).*\\"[^\\"]*&[^\\"]*[\\"]*.*\\]';var h=new RegExp(l,"g");var f=o.match(h);var k='(?:\\"|<ValValue>)[^\\"|^\\>]*\\&(?!amp;)[^\\"]*[\\"|</ValValue>]';var g=new RegExp(k,"g");var e=o.match(g);if(e!=null){for(var a=0;a<e.length;a++){var c=e[a];var m=false;if(f!=null){for(var b=0;b<f.length;b++){var d=f[b];if(String(d).indexOf(c)>=0){m=true;break}}}if(m==false){var n=new RegExp(k);o=o.replace(n,function(i,j,p){return replace(c)})}}}return o}};function replace(a){var b=String(a);return(b.replace(/\&(?!amp;)/g,"&amp;"))}function XmlCompressor(){this.Mapping=null;this.Compress=function(b){this.Mapping=XmlCompressorEngine.LoadXML(b);var a=b.documentElement;return XmlCompressorEngine.Compress(a,this.Mapping)};this.Decompress=function(c){var a=new CompressorMapping();a.arrNodes=new Array();a.arrAttrs=new Array();a.arrVals=new Array();GetMappingNode(c,"Node",a);GetMappingNode(c,"Attr",a);GetMappingNode(c,"Val",a);var b=c.documentElement;return XmlCompressorEngine.Decompress(b,a)}}function GetMappingNode(l,h,e){var f=l.selectSingleNode("//CompressedXml/ISXMLMapping/"+h+"Key");var g=l.selectSingleNode("//CompressedXml/ISXMLMapping/"+h+"Value");var j=new String(f.text);var k=new String(g.text);var a=j.split("\x7f");var b=k.split("\x7f");for(var d=0;d<a.length;d++){var c=new Dictionary();c.item=b[d];c.keyitem=a[d];if(h=="Node"){e.arrNodes.push(c)}else{if(h=="Attr"){e.arrAttrs.push(c)}else{if(h=="Val"){e.arrVals.push(c)}}}}}function CompressorMapping(){this.Nodes="";this.Attributes="";this.Values="";this.arrNodes=null;this.arrAttrs=null;this.arrVals=null}function Dictionary(){this.item="";this.keyitem="";this.count=0;this.idxItem=0;this.idxKey=0;this.idxCount=0}if(typeof(Sys)!="undefined"){Sys.Application.notifyScriptLoaded()};